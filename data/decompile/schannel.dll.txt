Function at address: 0x180001010
Called functions addresses: 0x18002a960 0x180016e98 0x180028838


void FUN_180001010(void)

{
FUN_180016e98();
atexit(FUN_18002a960);
return;
}
=========================================
Function at address: 0x180001040
Called functions addresses: 0x18002a980 0x180027bd4 0x180028838


void FUN_180001040(void)

{
FUN_180027bd4();
atexit(FUN_18002a980);
return;
}
=========================================
Function at address: 0x180001060
Called functions addresses: 0xEXTERNAL:000000f3 0x18005b470 0x18002a7c0 0xEXTERNAL:0000011c 0x180028070


void FUN_180001060(longlong *param_1,undefined8 param_2)

{
longlong *plVar1;
longlong *plVar2;
int iVar3;
undefined8 uVar4;
undefined auStack_c8 [32];
undefined4 *local_a8;
ulonglong local_a0;
undefined4 local_88 [2];
undefined4 local_80;
undefined4 local_7c;
undefined *local_78;
undefined local_68 [64];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_c8;
local_88[0] = 0;
plVar1 = param_1 + 0x14;
if (*plVar1 != 0) {
SslFreeObject(*plVar1,0);
*plVar1 = 0;
}
plVar2 = param_1 + 0x15;
if (*plVar2 != 0) {
SslFreeObject(*plVar2,0);
*plVar2 = 0;
}
if ((((*(byte *)(param_1 + 4) & 1) != 0) && (param_1[1] != 0)) &&
(*(int *)(param_1[1] + 0x1c) != 0)) {
local_80 = 0;
local_78 = local_68;
local_7c = 4;
local_a0 = 0;
local_a8 = (undefined4 *)0x0;

if (iVar3 == 0) {
if ((undefined8 *)param_1[1] == (undefined8 *)0x0) {
uVar4 = 0;
}
else {
uVar4 = *(undefined8 *)param_1[1];
}
local_a0 = local_a0 & 0xffffffff00000000;
local_a8 = &local_80;
iVar3 = SslGenerateSessionKeys(uVar4,param_2,plVar1,plVar2);
if (iVar3 != 0) {
FUN_18005b470(param_1,600,iVar3,0x33);
}
}
else {
FUN_18005b470(param_1,0x259,iVar3,0x33);
}
}
FUN_180028070(local_28 ^ (ulonglong)auStack_c8);
return;
}
=========================================
Function at address: 0x1800011a0
Called functions addresses: 0x1800090d0 0x180009e8c


void FUN_1800011a0(longlong *param_1,uint *param_2)

{
undefined8 uVar1;
uint uVar2;
int iVar3;
uint uVar4;
int iVar5;

iVar5 = 1;
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar2 = *(uint *)((longlong)param_1 + 0x34);
uVar4 = *(int *)(param_1 + 6) + 1;
if (uVar2 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar2 = uVar2 - uVar4 % uVar2;
}
uVar4 = uVar4 + uVar2;
}
iVar5 = uVar4 + *(int *)((longlong)param_1 + 0x2c);
}
if ((*(byte *)(param_1 + 8) & 0x30) == 0) {
iVar3 = (-(uint)(*(char *)((longlong)param_1 + 0xe9) != '\0') & 8) + 0x10;
}
else {
iVar3 = (-(uint)(*(char *)((longlong)param_1 + 0xe9) != '\0') & 8) + 0x28;
}
if ((*(byte *)(param_1 + 4) & 1) != 0) {
uVar4 = iVar3 + *(int *)(param_1 + 6);
uVar2 = *(uint *)((longlong)param_1 + 0x34);
if (uVar2 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar2 = uVar2 - uVar4 % uVar2;
}
uVar4 = uVar4 + uVar2;
}
iVar3 = uVar4 + *(int *)((longlong)param_1 + 0x2c);
}
uVar1 = FUN_180009e8c((longlong)param_1,param_2,
iVar3 + *(int *)((longlong)param_1 + 0x3c) * 2 + iVar5);
if ((int)uVar1 == 0) {
FUN_1800090d0(param_1,param_2);
}
return;
}
=========================================
Function at address: 0x180001268
Called functions addresses: 0xEXTERNAL:00000145 0x180028d90 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0x180054f60 0x180044a44 0x18002a7c0 0x180028070 0xEXTERNAL:00000146 0xEXTERNAL:00000041 0x18000f5c0 0x180041cdc 0xEXTERNAL:0000013b 0xEXTERNAL:0000014c 0x180001674 0xEXTERNAL:00000047 0x18005b470 0x180001604 0xEXTERNAL:000000a3 0xEXTERNAL:0000012b


void FUN_180001268(longlong *param_1,DWORD param_2,uint param_3,undefined8 *param_4)

{
ulonglong uVar1;
longlong lVar2;
DWORD DVar3;
BOOL BVar4;
int iVar5;
uint uVar6;
longlong lVar7;
LPCWSTR pWVar8;
undefined8 uVar9;
undefined4 uVar10;
LPCWSTR lpString;
PCCERT_CONTEXT pCertContext;
PCERT_CHAIN_POLICY_PARA pPolicyPara;
_EVENT_DATA_DESCRIPTOR *p_Var11;
undefined uVar12;
char cVar13;
HCERTSTORE hAdditionalStore;
PCERT_CHAIN_POLICY_STATUS pPolicyStatus;
undefined auStackY_188 [32];
char local_148 [8];
longlong local_140;
int local_138 [2];
PCCERT_CHAIN_CONTEXT local_130;
uint local_128;
undefined8 local_120;
longlong lStack_118;
undefined8 local_110;
undefined8 uStack_108;
LPCWSTR local_100;
_CERT_CHAIN_POLICY_PARA local_f8;
_CERT_CHAIN_POLICY_STATUS local_e8;
_CERT_CHAIN_PARA local_c8 [3];
_EVENT_DATA_DESCRIPTOR local_68;
char *local_58;
char *local_50;
char *local_48;
ulonglong local_40;

local_40 = DAT_180091970 ^ (ulonglong)auStackY_188;
local_100 = (LPCWSTR)0x0;
local_e8.pvExtraPolicyStatus = (void *)0x0;
local_110 = 0;
uStack_108 = 0;
local_f8.cbSize = 0;
local_f8.dwFlags = 0;
local_f8.pvExtraPolicyPara = (undefined8 *)0x0;
local_e8.cbSize = 0;
local_e8.dwError = 0;
local_e8.lChainIndex = 0;
local_e8.lElementIndex = 0;
local_128 = param_3;
memset(local_c8,0,0x60);
uVar1 = param_1[0x11];
lVar2 = param_1[10];
lpString = (LPCWSTR)0x0;
local_58 = "1.3.6.1.5.5.7.3.1";
local_130 = (PCCERT_CHAIN_CONTEXT)0x0;
local_50 = "1.3.6.1.4.1.311.10.3.3";
local_140 = 0;
local_48 = "2.16.840.1.113730.4.1";
pCertContext = (PCCERT_CONTEXT)0x0;
local_68.Ptr = 0;
local_138[0] = 0;
local_148[0] = '\0';
local_120 = 0;
lStack_118 = 0;
if (lVar2 == 0) goto LAB_1800015d2;

if (local_140 != 0) {
RtlAcquireResourceExclusive(local_140 + 0x48,1);
p_Var11 = &local_68;
DVar3 = FUN_18000f5c0(*(uint **)(local_140 + 0x18),*(DWORD *)(local_140 + 0x20),&p_Var11->Ptr);
pCertContext = (PCCERT_CONTEXT)local_68.Ptr;
if (DVar3 == 0) {
lStack_118 = *(undefined8 *)(local_140 + 0x150);
if (*(int *)(local_140 + 0x158) != 0) {
p_Var11 = (_EVENT_DATA_DESCRIPTOR *)0x0;
param_4 = &local_120;
local_120._0_4_ = *(int *)(local_140 + 0x158);
BVar4 = CertSetCertificateContextProperty((PCCERT_CONTEXT)local_68.Ptr,0x46,0,param_4);
if (((BVar4 == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
DVar3 = GetLastError();
p_Var11 = (_EVENT_DATA_DESCRIPTOR *)&DAT_1800854d0;
param_4 = (undefined8 *)(ulonglong)DVar3;
FUN_180041cdc(DAT_180091000[2],0x15,&DAT_1800854d0,DVar3);
}
}
lStack_118 = *(longlong *)(local_140 + 0x160);
local_120 = CONCAT44(local_120._4_4_,*(int *)(local_140 + 0x168));
if ((*(int *)(local_140 + 0x168) != 0) && (lStack_118 != 0)) {
p_Var11 = (_EVENT_DATA_DESCRIPTOR *)0x0;
param_4 = &local_120;
BVar4 = CertSetCertificateContextProperty(pCertContext,0x77,0,param_4);
if ((BVar4 == 0) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)))) {
DVar3 = GetLastError();
p_Var11 = (_EVENT_DATA_DESCRIPTOR *)&DAT_1800854d0;
param_4 = (undefined8 *)(ulonglong)DVar3;
FUN_180041cdc(DAT_180091000[2],0x16,&DAT_1800854d0,DVar3);
}
}
lVar7 = *(longlong *)(param_1[10] + 0x2f0);
iVar5 = FUN_180001604(lVar7,local_138);
if (iVar5 == 0) {
local_c8[0].cbSize = 0x60;
local_c8[0].RequestedUsage.Usage.rgpszUsageIdentifier = &local_58;
local_c8[0].RequestedUsage.dwType = 1;
local_c8[0].RequestedUsage.Usage.cUsageIdentifier = 3;
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(lVar7,(PCEVENT_DESCRIPTOR)&DAT_180084c90,p_Var11,param_4,&local_68);
}
hAdditionalStore = *(HCERTSTORE *)((longlong)pCertContext + 0x20);
uVar9 = 0;
pWVar8 = (LPCWSTR)0x0;
BVar4 = CertGetCertificateChain
((HCERTCHAINENGINE)0x0,pCertContext,(LPFILETIME)0x0,hAdditionalStore,
local_c8,param_2,(LPVOID)0x0,&local_130);
if (BVar4 == 0) {
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(pWVar8,(PCEVENT_DESCRIPTOR)&DAT_180084c80,uVar9,hAdditionalStore,&local_68
);
}
DVar3 = GetLastError();
uVar12 = 0x50;
uVar10 = 0x227;
}
else {
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(pWVar8,(PCEVENT_DESCRIPTOR)&DAT_180084c80,uVar9,hAdditionalStore,&local_68
);
}
if (((*(byte *)(lVar2 + 0x9c) & 2) == 0) &&
((lpString = *(LPCWSTR *)(local_140 + 0x170), lpString == (LPCWSTR)0x0 ||
(pWVar8 = lpString, iVar5 = lstrlenW(lpString), iVar5 == 0)))) {
uVar10 = 0x229;
uVar12 = 0x50;
DVar3 = 0x80090322;
}
else {
local_f8.pvExtraPolicyPara = &local_110;
uStack_108 = 0;
local_110 = 0x200000018;
local_f8.cbSize = 0x10;
local_f8.dwFlags = 0;
local_e8.cbSize = 0x18;
local_100 = lpString;
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(pWVar8,(PCEVENT_DESCRIPTOR)&DAT_180084c70,uVar9,hAdditionalStore,
&local_68);
}
pPolicyStatus = &local_e8;
pPolicyPara = &local_f8;
uVar9 = 4;
BVar4 = CertVerifyCertificateChainPolicy
((LPCSTR)0x4,local_130,pPolicyPara,pPolicyStatus);
if (BVar4 != 0) {
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar9,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,
&local_68);
}
DVar3 = (local_130->TrustStatus).dwErrorStatus;
*(DWORD *)(local_140 + 0xd8) = local_e8.dwError;
*(DWORD *)(local_140 + 0xdc) = DVar3;
if (((uVar1 & 0x200000000) == 0) &&
(uVar6 = FUN_180001674(local_e8.dwError,0,local_128,local_148), uVar6 != 0)) {
cVar13 = local_148[0];
if (local_148[0] == '\0') {
cVar13 = 'P';
}
FUN_18005b470(param_1,0x228,uVar6,cVar13);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x18,&DAT_1800854d0,uVar6);
}
FUN_180044a44(*(uint *)(lVar2 + 0xd4),lVar2 + 0xd8,pCertContext,lpString,uVar6);
}
goto LAB_18000157b;
}
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar9,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,
&local_68);
}
DVar3 = GetLastError();
uVar12 = 0x50;
uVar10 = 0x228;
}
}
goto LAB_18002b74f;
}
}
else {
uVar12 = 0x2a;
uVar10 = 0x226;
LAB_18002b74f:
FUN_18005b470(param_1,uVar10,DVar3,uVar12);
}
LAB_18000157b:
if (local_140 != 0) {
RtlReleaseResource(local_140 + 0x48);
}
}
if (local_130 != (PCCERT_CHAIN_CONTEXT)0x0) {
CertFreeCertificateChain(local_130);
}
if (pCertContext != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(pCertContext);
}
if (local_138[0] != 0) {
RevertToSelf();
}
LAB_1800015d2:
FUN_180028070(local_40 ^ (ulonglong)auStackY_188);
return;
}
=========================================
Function at address: 0x180001604
Called functions addresses: 0xEXTERNAL:000000c7 0x18002a7c0 0xEXTERNAL:000000dc


void FUN_180001604(longlong param_1,undefined4 *param_2)

{
int iVar1;
longlong local_res8 [4];

*param_2 = 0;
if (DAT_180092620 != 0) {
local_res8[0] = param_1;
if (param_1 == 0) {

}
else {
iVar1 = NtSetInformationThread(0xfffffffffffffffe,5,local_res8);
}
if (-1 < iVar1) {
*param_2 = 1;
}
RtlNtStatusToDosError(iVar1);
}
return;
}
=========================================
Function at address: 0x180001674
Called functions addresses: 0x180041cb0


uint FUN_180001674(uint param_1,uint param_2,uint param_3,undefined *param_4)

{
undefined2 uVar1;
undefined uVar2;

uVar2 = 0;
if (param_1 == 0x80092012) {
if ((param_3 >> 0xb & 1) == 0) {
LAB_18002b9dd:
uVar2 = 0x2b;
goto LAB_1800016ff;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
uVar1 = 0x11;
LAB_18002b9a6:
FUN_180041cb0(DAT_180091000[2],uVar1,&DAT_1800854d0);
}
}
else {
if (param_1 != 0x80092013) {
if ((param_1 & 0x1fff0000) == 0x90000) {
if (param_1 == 0x80092010) {
LAB_18002b9e9:
uVar2 = 0x2c;
goto LAB_1800016ff;
}
if (param_1 + 0x7ff6dfee < 2) goto LAB_18002b9dd;
}
else {
if (-0x7ff4ff00 < (int)param_1) {
if ((int)param_1 < -0x7ff4fefd) {
param_1 = 0x80090328;
uVar2 = 0x2d;
goto LAB_1800016ff;
}
if (param_1 == 0x800b0109) {
LAB_180001714:
param_1 = 0x80090325;
uVar2 = 0x30;
goto LAB_1800016ff;
}
if (param_1 == 0x800b010c) {
param_1 = 0x80092010;
goto LAB_18002b9e9;
}
if (param_1 == 0x800b010f) {
param_1 = 0x80090322;
}
else {
if (param_1 != 0x800b0110) {
if (param_1 != 0x800b0112) {
if (param_1 == 0) goto LAB_1800016fd;
goto LAB_18002b9f0;
}
goto LAB_180001714;
}
param_1 = 0x80090349;
}
goto LAB_18002b9dd;
}
LAB_18002b9f0:
param_1 = param_2;
if (param_2 == 0) {
param_1 = 0x80090327;
}
}
uVar2 = 0x2e;
goto LAB_1800016ff;
}
if ((param_3 >> 0xc & 1) == 0) goto LAB_18002b9dd;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
uVar1 = 0x12;
goto LAB_18002b9a6;
}
}
LAB_1800016fd:
param_1 = 0;
LAB_1800016ff:
if (param_4 != (undefined *)0x0) {
*param_4 = uVar2;
}
return param_1;
}
=========================================
Function at address: 0x18000172c
Called functions addresses: 0x1800432a8 0x180041cb0 0x1800432ec


undefined8 FUN_18000172c(byte *param_1,int param_2,byte *param_3,undefined *param_4)

{
byte bVar1;
undefined2 uVar2;
undefined8 uVar3;
undefined8 uVar4;

uVar3 = 0;
if (param_4 != (undefined *)0x0) {
*param_4 = 0;
}
if ((param_2 != 2) || (1 < (byte)(*param_1 - 1))) {
return 0x80090308;
}
if (param_3 == (byte *)0x0) {
return 0x8009035d;
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_1800432a8(DAT_180091000[2],0x47,&DAT_180085408,(uint)*param_1);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432a8(DAT_180091000[2],0x48,&DAT_180085408,(uint)param_1[1]);
}
}
bVar1 = param_1[1];
if (*param_1 == 1) {
if (bVar1 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x4a,&DAT_180085408);
}
uVar4 = 0x90317;
}
else {
uVar4 = uVar3;
if (bVar1 == 0x29) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x49,&DAT_180085408);
}
if (param_4 != (undefined *)0x0) {
*param_4 = 1;
}
}
else if (bVar1 == 100) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x4b,&DAT_180085408);
}
uVar4 = 0x90360;
}
else {
uVar4 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x4c,&DAT_180085408);
uVar4 = uVar3;
}
}
}
bVar1 = *param_3;
*param_3 = bVar1 + 1;
if (5 < (byte)(bVar1 + 1)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
*param_3 = bVar1;
FUN_1800432ec(DAT_180091000[2],0x4d,&DAT_180085408,(uint)bVar1);
}
return 0x90317;
}
return uVar4;
}
if (bVar1 < 0x30) {
if (bVar1 == 0x2f) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
uVar2 = 0x57;
goto LAB_18002bb79;
}
if (bVar1 < 0x29) {
if (bVar1 == 0x28) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
uVar2 = 0x51;
goto LAB_18002bb79;
}
if (bVar1 == 10) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
uVar2 = 0x4e;
goto LAB_18002bb79;
}
if (bVar1 == 0x14) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x4f,&DAT_180085408);
}
return 0x8009030f;
}
if (bVar1 == 0x15) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090330;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090330;
}
uVar2 = 0x50;
goto LAB_18002bba6;
}
if (bVar1 == 0x16) {
return 0x80090326;
}
if (bVar1 == 0x1e) {
return 0x8009030f;
}
}
else {
if (bVar1 == 0x2a) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090327;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090327;
}
uVar2 = 0x52;
LAB_18002bcb2:
FUN_180041cb0(DAT_180091000[2],uVar2,&DAT_180085408);
return 0x80090327;
}
if (bVar1 == 0x2b) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090327;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090327;
}
uVar2 = 0x53;
goto LAB_18002bcb2;
}
if (bVar1 == 0x2c) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x54,&DAT_180085408);
}
return 0x80092010;
}
if (bVar1 == 0x2d) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x55,&DAT_180085408);
}
return 0x80090328;
}
if (bVar1 == 0x2e) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090327;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090327;
}
uVar2 = 0x56;
goto LAB_18002bcb2;
}
}
}
else if (bVar1 < 0x47) {
if (bVar1 == 0x46) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x5d,&DAT_180085408);
}
return 0x80090302;
}
if (bVar1 == 0x30) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x58,&DAT_180085408);
}
return 0x80090325;
}
if (bVar1 == 0x31) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x59,&DAT_180085408);
}
return 0x8009030c;
}
if (bVar1 == 0x32) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
uVar2 = 0x5a;
goto LAB_18002bb79;
}
if (bVar1 == 0x33) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090330;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090330;
}
uVar2 = 0x5b;
LAB_18002bba6:
FUN_180041cb0(DAT_180091000[2],uVar2,&DAT_180085408);
return 0x80090330;
}
if (bVar1 == 0x3c) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
uVar2 = 0x5c;
goto LAB_18002bb79;
}
}
else {
if (bVar1 == 0x47) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x5e,&DAT_180085408);
}
return 0x80090331;
}
if (bVar1 == 0x50) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x5f,&DAT_180085408);
}
return 0x80090304;
}
if (bVar1 == 0x6e) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
uVar2 = 0x60;
goto LAB_18002bb79;
}
if (bVar1 == 0x73) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
uVar2 = 0x61;
goto LAB_18002bb79;
}
if (bVar1 == 0x78) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x62,&DAT_180085408);
}
return 0x80090367;
}
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
uVar2 = 99;
LAB_18002bb79:
FUN_180041cb0(DAT_180091000[2],uVar2,&DAT_180085408);
return 0x80090326;
}
=========================================
Function at address: 0x180001820
Called functions addresses: 0x18000187c 0x1800432ec 0x18000186f


ulonglong SpUserModeInitialize
(int param_1,undefined4 *param_2,undefined8 *param_3,undefined4 *param_4)

{
ulonglong uVar1;

/* 0x1820  24  SpUserModeInitialize */
if (((param_2 != (undefined4 *)0x0) && (param_3 != (undefined8 *)0x0)) &&
(param_4 != (undefined4 *)0x0)) {
if (param_1 == 0x10000) {
*param_2 = 0x10000;
*param_3 = &PTR_FUN_1800912a0;
*param_4 = 2;
uVar1 = FUN_18000187c();
return (ulonglong)(~-(uint)((int)uVar1 != 0) & 0xc000009a);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],10,&DAT_180082b10,param_1);
uVar1 = FUN_18000186f();
return uVar1;
}
}
return 0xc000000d;
}
=========================================
Function at address: 0x18000186f
Called functions addresses: None


undefined8 FUN_18000186f(void)

{
return 0xc000000d;
}
=========================================
Function at address: 0x18000187c
Called functions addresses: 0xEXTERNAL:0000004b 0xEXTERNAL:000000b3 0xEXTERNAL:0000004f 0x180041cb0 0x18000a1f4 0xEXTERNAL:00000050 0xEXTERNAL:000000b5 0x18000909c


/* WARNING: Removing unreachable block (ram,0x00018002b281) */
/* WARNING: Removing unreachable block (ram,0x00018002b294) */
/* WARNING: Removing unreachable block (ram,0x00018002b29a) */

ulonglong FUN_18000187c(void)

{
LSTATUS LVar1;
HLOCAL pvVar2;
ulonglong uVar3;
ulonglong uVar4;
uint uVar5;
DWORD local_res8 [2];
DWORD local_res10 [2];
uint local_res18 [2];
uint local_res20 [2];
DWORD local_28 [2];
HKEY local_20;

uVar3 = 0;
uVar5 = 0;
local_20 = (HKEY)0x0;
if (DAT_1800921c0 == 0) {
LVar1 = RegCreateKeyExW((HKEY)0xffffffff80000002,
L"System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel",0,L""
,0,0x20019,(LPSECURITY_ATTRIBUTES)0x0,&local_20,local_28);
if (LVar1 == 0) {
local_res8[0] = 4;
LVar1 = RegQueryValueExW(local_20,L"UserContextLockCount",(LPDWORD)0x0,local_res10,
(LPBYTE)local_res18,local_res8);
if ((((LVar1 == 0) && (local_res10[0] == 4)) && (local_res18[0] - 1 < 0x200)) &&
((local_res18[0] & local_res18[0] - 1) == 0)) {
DAT_1800919e4 = local_res18[0];
}
local_res8[0] = 4;
LVar1 = RegQueryValueExW(local_20,L"UserContextListCount",(LPDWORD)0x0,local_res10,
(LPBYTE)local_res20,local_res8);
if (((LVar1 == 0) && (local_res10[0] == 4)) &&
((local_res20[0] != 0 && ((local_res20[0] & local_res20[0] - 1) == 0)))) {
DAT_1800919e0 = local_res20[0];
}
RegCloseKey(local_20);
local_20 = (HKEY)0x0;
}
DAT_1800921d0 = (HLOCAL)FUN_18000a1f4((ulonglong)(DAT_1800919e4 * 0x60));
uVar4 = uVar3;
if (DAT_1800921d0 != (HLOCAL)0x0) {
while (uVar5 = (uint)uVar4, local_res8[0] = uVar5, uVar5 < DAT_1800919e4) {
RtlInitializeResource((HLOCAL)(uVar4 * 0x60 + (longlong)DAT_1800921d0));
uVar4 = (ulonglong)(uVar5 + 1);
}
DAT_1800921c8 = (HLOCAL)FUN_18000a1f4((ulonglong)(DAT_1800919e0 << 4));
if (DAT_1800921c8 != (HLOCAL)0x0) {
for (; (uint)uVar3 < DAT_1800919e0; uVar3 = (ulonglong)((uint)uVar3 + 1)) {
pvVar2 = (HLOCAL)(uVar3 * 0x10 + (longlong)DAT_1800921c8);
*(HLOCAL *)((longlong)pvVar2 + 8) = pvVar2;
*(HLOCAL *)pvVar2 = pvVar2;
}
DAT_1800921c0 = 1;
return 1;
}
}
if (DAT_1800921c8 != (HLOCAL)0x0) {
FUN_18000909c(DAT_1800921c8);
DAT_1800921c8 = (HLOCAL)0x0;
}
uVar4 = uVar3;
if (DAT_1800921d0 != (HLOCAL)0x0) {
for (; (uint)uVar4 < uVar5; uVar4 = (ulonglong)((uint)uVar4 + 1)) {
RtlDeleteResource((HLOCAL)(uVar4 * 0x60 + (longlong)DAT_1800921d0));
}
FUN_18000909c(DAT_1800921d0);
DAT_1800921d0 = (HLOCAL)0x0;
}
}
else {
uVar3 = 1;
}
return uVar3;
}
=========================================
Function at address: 0x180001a64
Called functions addresses: 0x180028d90 0xEXTERNAL:000000ac 0xEXTERNAL:00000053 0xEXTERNAL:00000058 0x180028070 0x18004d2f0


void FUN_180001a64(void)

{
undefined8 uVar1;
HMODULE hModule;
undefined8 *puVar2;
undefined8 *puVar3;
undefined auStack_298 [32];
undefined8 *local_278;
WCHAR *local_270;
wchar_t *local_268;
undefined8 *local_260;
undefined8 local_258;
undefined8 local_250;
wchar_t local_248 [2];
wchar_t awStack_244 [2];
wchar_t awStack_240 [2];
wchar_t awStack_23c [2];
wchar_t local_238;
WCHAR local_228 [259];
undefined2 local_22;
ulonglong local_18;

puVar2 = DAT_180091000;
local_18 = DAT_180091970 ^ (ulonglong)auStack_298;
puVar3 = &DAT_180092a88;
memset(local_228,0,0x208);
local_238 = u_schannel_1800820b8[8];
local_248[0] = u_schannel_1800820b8[0];
local_248[1] = u_schannel_1800820b8[1];
awStack_244[0] = u_schannel_1800820b8[2];
awStack_244[1] = u_schannel_1800820b8[3];
awStack_240[0] = u_schannel_1800820b8[4];
awStack_240[1] = u_schannel_1800820b8[5];
awStack_23c[0] = u_schannel_1800820b8[6];
awStack_23c[1] = u_schannel_1800820b8[7];
for (; puVar2 != (undefined8 *)0x0; puVar2 = (undefined8 *)*puVar2) {
uVar1 = *puVar3;
puVar3 = puVar3 + 1;
local_250 = 0;
puVar2[4] = uVar1;
local_258 = uVar1;
hModule = GetModuleHandleW(L"schannel");
if (hModule != (HMODULE)0x0) {
GetModuleFileNameW(hModule,local_228,0x104);
local_22 = 0;
}
local_260 = puVar2 + 1;
local_268 = local_248;
local_270 = local_228;
local_278 = &local_258;
EtwRegisterTraceGuidsW(FUN_18004d2f0,puVar2,uVar1,1);
}
FUN_180028070(local_18 ^ (ulonglong)auStack_298);
return;
}
=========================================
Function at address: 0x180001ba0
Called functions addresses: 0x180002c5c


undefined8 FUN_180001ba0(longlong param_1,int param_2)

{
if (0 < *(int *)(param_1 + 0x20)) {
FUN_180002c5c(param_1,'\x01',param_2 == DAT_1800919b8);
}
return 0;
}
=========================================
Function at address: 0x180001bcc
Called functions addresses: 0xEXTERNAL:000000c0 0x180001e7c 0xEXTERNAL:00000170 0x180004494 0x18000a1f4 0x180028070 0xEXTERNAL:00000041 0xEXTERNAL:0000014e 0x18000909c 0xEXTERNAL:00000168 0x18005b470 0xEXTERNAL:00000169 0xEXTERNAL:00000123 0xEXTERNAL:000000c2 0x18002a77b 0x18006a8f8


void FUN_180001bcc(longlong *param_1,PUCHAR param_2,ULONG param_3,int param_4,BYTE *param_5,
DWORD param_6)

{
BOOL BVar1;
DWORD DVar2;
int iVar3;
undefined4 uVar4;
uint uVar5;
uint *pvStructInfo;
undefined uVar6;
PUCHAR pbSignature;
undefined auStackY_f8 [32];
DWORD local_b8;
uint local_b4;
ULONG local_b0 [2];
BCRYPT_KEY_HANDLE local_a8;
ULONG local_a0;
ULONG local_9c;
PUCHAR local_98;
UCHAR local_88 [64];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_f8;
local_b0[0] = 0;
local_a8 = (BCRYPT_HANDLE)0x0;
pbSignature = (PUCHAR)0x0;
local_a0 = 0;
pvStructInfo = (uint *)0x0;
local_b4 = 0;
local_b8 = 0;
local_9c = param_3;
local_98 = param_2;
RtlAcquireResourceShared(param_1[0xb] + 0x48,1);
BVar1 = CryptImportPublicKeyInfoEx2
(**(DWORD **)(param_1[0xb] + 0x30),
(PCERT_PUBLIC_KEY_INFO)
(*(longlong *)(*(DWORD **)(param_1[0xb] + 0x30) + 6) + 0x60),0x80000000,
(void *)0x0,&local_a8);
if (BVar1 == 0) {
RtlReleaseResource(param_1[0xb] + 0x48);
DVar2 = GetLastError();
uVar6 = 0x2b;
LAB_18002bed2:
uVar4 = 0x453;
}
else {
RtlReleaseResource();
DVar2 = BCryptGetProperty(local_a8,L"KeyLength",(PUCHAR)&local_b4,4,&local_a0,0);
if (DVar2 != 0) {
uVar6 = 0x50;
goto LAB_18002bed2;
}
uVar5 = (uint)((local_b4 & 7) != 0) + (local_b4 >> 3);
pbSignature = (PUCHAR)FUN_18000a1f4((ulonglong)(uVar5 * 2));
if (pbSignature == (PUCHAR)0x0) goto LAB_180001e1a;
BVar1 = CryptDecodeObject(1,(LPCSTR)0x2f,param_5,param_6,0,(void *)0x0,&local_b8);
if (BVar1 == 0) {
DVar2 = GetLastError();
pvStructInfo = (uint *)0x0;
LAB_18002bf77:
uVar4 = 0x454;
uVar6 = 0x32;
}
else {
pvStructInfo = (uint *)FUN_18000a1f4((ulonglong)local_b8);
if (pvStructInfo == (uint *)0x0) goto LAB_180001e1a;
BVar1 = CryptDecodeObject(1,(LPCSTR)0x2f,param_5,param_6,0,pvStructInfo,&local_b8);
if (BVar1 == 0) {
GetLastError();
goto LAB_180001e1a;
}
if ((uVar5 < *pvStructInfo) || (uVar5 < pvStructInfo[4])) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_18006a8f8(DAT_180091000[2],10,&DAT_180086380,*pvStructInfo,(char)pvStructInfo[4],
(char)uVar5);
}
DVar2 = 0xd;
goto LAB_18002bf77;
}
memcpy(pbSignature,*(void **)(pvStructInfo + 2),(ulonglong)*pvStructInfo);
memcpy(pbSignature + uVar5,*(void **)(pvStructInfo + 6),(ulonglong)pvStructInfo[4]);
local_b8 = uVar5 * 2;
FUN_180001e7c(pbSignature,uVar5);
FUN_180001e7c(pbSignature + (local_b8 >> 1),local_b8 >> 1);
iVar3 = 2;
if (param_4 != 0) {
iVar3 = param_4;
}
DVar2 = FUN_180004494(iVar3,(longlong)param_1,local_98,local_9c,local_88,local_b0);
if (DVar2 == 0) {
DVar2 = BCryptVerifySignature
(local_a8,(void *)0x0,local_88,local_b0[0],pbSignature,local_b8,0);
if (DVar2 == 0) goto LAB_180001e1a;
uVar6 = 0x33;
uVar4 = 0x456;
}
else {
uVar6 = 0x50;
uVar4 = 0x455;
}
}
}
FUN_18005b470(param_1,uVar4,DVar2,uVar6);
LAB_180001e1a:
if (local_a8 != (BCRYPT_KEY_HANDLE)0x0) {
BCryptDestroyKey(local_a8);
}
if (pbSignature != (PUCHAR)0x0) {
FUN_18000909c(pbSignature);
}
if (pvStructInfo != (uint *)0x0) {
FUN_18000909c(pvStructInfo);
}
FUN_180028070(local_48 ^ (ulonglong)auStackY_f8);
return;
}
=========================================
Function at address: 0x180001e7c
Called functions addresses: None


void FUN_180001e7c(undefined *param_1,uint param_2)

{
undefined uVar1;
int iVar2;
uint uVar3;
uint uVar4;
undefined *puVar5;

uVar4 = 0;
puVar5 = param_1;
if (param_2 >> 1 != 0) {
do {
uVar1 = *puVar5;
iVar2 = param_2 - uVar4;
uVar4 = uVar4 + 1;
uVar3 = iVar2 - 1;
*puVar5 = param_1[uVar3];
param_1[uVar3] = uVar1;
puVar5 = puVar5 + 1;
} while (uVar4 < param_2 >> 1);
}
return;
}
=========================================
Function at address: 0x180001ed0
Called functions addresses: 0x180002040 0x18002a7c0 0x180002488 0x180041cb0 0x180001fc8 0x1800011a0 0x180075ef8 0x180053124


uint FUN_180001ed0(longlong *param_1,uint *param_2)

{
int iVar1;
uint uVar2;
ulonglong uVar3;
undefined2 uVar4;
char local_res8 [8];

iVar1 = *(int *)((longlong)param_1 + 0x44);
if (iVar1 == 4) {
if (DAT_1800927c4 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x25,&DAT_180085810);
}
FUN_180053124(param_1[0xf],0,param_1[0x11]);
uVar3 = FUN_180075ef8(param_1,param_2);
if (((uint)uVar3 == 0) &&
(*(undefined4 *)((longlong)param_1 + 0x44) = 0x28,
*(char *)((longlong)param_1 + 0xe9) != (char)uVar3)) {
*(int *)(param_1[0x49] + 0x24) = (int)*(short *)(*(longlong *)(param_1[0x49] + 0x28) + 0xc0)
;
}
param_1[0x11] = param_1[0x11] & 0xffffffffbfffffff;
return (uint)uVar3;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
uVar4 = 0x24;
}
else {
if (iVar1 == 0x5b) {
local_res8[0] = '\0';
uVar2 = FUN_180002488(param_1,local_res8);
if (local_res8[0] != '\0') {
return uVar2;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x22,&DAT_180085810);
}
uVar3 = FUN_180002040(param_1,param_2);
uVar2 = (uint)uVar3;
if (uVar2 != 0) {
if (uVar2 == 0x9035c) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x31;
return 0x9035c;
}
return uVar2;
}
uVar3 = FUN_180001fc8((longlong)param_1);
*(uint *)((longlong)param_1 + 0x44) = (-(uint)((char)uVar3 != '\0') & 5) + 0x2e;
return 0;
}
if (iVar1 == 0x5c) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x23,&DAT_180085810);
}
uVar2 = FUN_1800011a0(param_1,param_2);
if (uVar2 == 0) {

return 0;
}
return uVar2;
}
if (iVar1 != 0x61) {
return 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x26,&DAT_180085810);
}
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {

if (uVar2 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x28;
return 0;
}
return uVar2;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
uVar4 = 0x27;
}
FUN_180041cb0(DAT_180091000[2],uVar4,&DAT_180085810);
return 0x80090326;
}
=========================================
Function at address: 0x180001fc8
Called functions addresses: None


ulonglong FUN_180001fc8(longlong param_1)

{
uint uVar1;
ulonglong in_RAX;

if ((((((*(char *)(param_1 + 0x22c) != '\0') && (*(int *)(param_1 + 0x40) == 0x800)) &&
(*(char *)(param_1 + 0x523) == '\0')) &&
(((*(byte *)(param_1 + 0x20) & 8) != 0 && (in_RAX = *(ulonglong *)(param_1 + 8), in_RAX != 0)
))) && (uVar1 = *(uint *)(in_RAX + 0x1c), 0xc022 < uVar1)) &&
((uVar1 < 0xc025 ||
((0xc026 < uVar1 &&
((uVar1 < 0xc029 || ((0xc02a < uVar1 && ((uVar1 < 0xc02d || (uVar1 - 0xc02f < 2)))))))))))) {
return CONCAT71((int7)(in_RAX >> 8),1);
}
return in_RAX & 0xffffffffffffff00;
}
=========================================
Function at address: 0x180002040
Called functions addresses: 0x18002a7c0 0x1800758bc 0x180002410 0x1800090d0 0x180012184 0x180009e8c 0x1800024d0 0x180045408 0x180060b8c 0xEXTERNAL:000000c8 0x180076074 0x180009470 0x18000a534 0x18005b470 0x18002a77b


ulonglong FUN_180002040(longlong *param_1,uint *param_2)

{
ushort *puVar1;
char cVar2;
undefined2 uVar3;
ulonglong uVar4;
undefined8 uVar5;
undefined8 uVar6;
ulonglong uVar7;
longlong lVar8;
int iVar9;
uint uVar10;
undefined4 uVar11;
undefined uVar12;
uint uVar13;
undefined *puVar14;
uint uVar15;
int iVar16;
int iVar17;
ushort uVar18;
uint uVar19;
uint uVar20;
uint uVar21;
uint uVar22;
bool bVar23;
uint local_res8 [2];
uint local_res18;
int local_res20;
uint local_68;
uint local_64;
uint local_60;
void *local_58;
undefined local_50 [24];

uVar10 = 0;
local_res20 = 0;
uVar13 = 0;
local_68 = 0;
uVar15 = 0;
cVar2 = *(char *)((longlong)param_1 + 0xe9);
uVar22 = 0;
local_58 = (void *)0x0;
local_res18 = 0;
local_64 = 0;
local_res8[0] = 0;
uVar19 = (-(uint)(cVar2 != '\0') & 8) + 5;
uVar20 = -(uint)(cVar2 != '\0') & 8;
uVar21 = uVar20 + 4;
local_60 = uVar19;
if (*(int *)(param_1[1] + 0x30) == 4) {
if (param_1[0x6a] == 0) {
return 0x90320;
}
LAB_1800020c9:
uVar15 = uVar13;
uVar22 = uVar13;
if ((*(uint *)(param_1 + 8) & 0x80800) != 0) {
FUN_180002410((longlong)param_1);
}
}
else {
if (*(char *)((longlong)param_1 + 0x523) == '\0') goto LAB_1800020c9;

if (lVar8 == 0) {
uVar10 = *(uint *)(param_1[10] + 0xd4);
if ((DAT_1800919b0 & 2) != 0) {
RtlInitUnicodeString(local_50,param_1[10] + 0xd8);
FUN_180045408((ushort *)&DAT_180085060,0x180084eb4,(ulonglong)uVar10,local_50);
}
if ((*(byte *)(param_1 + 8) & 0x30) == 0) {
local_res8[0] = uVar20 + 7;
}
else {
iVar9 = 2;
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar15 = *(uint *)((longlong)param_1 + 0x34);
uVar22 = *(int *)(param_1 + 6) + 2;
if (uVar15 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar15 = uVar15 - uVar22 % uVar15;
}
uVar22 = uVar22 + uVar15;
}
iVar9 = uVar22 + *(int *)((longlong)param_1 + 0x2c);
}
uVar22 = *(int *)((longlong)param_1 + 0x3c) + iVar9;
uVar15 = 0;
}
}
else {
if (*(char *)((longlong)param_1 + 0x39a) != '\0') {
uVar10 = FUN_180076074((undefined *)0x0,0,*(LPCWSTR *)(param_1[10] + 0x368),
*(LPCWSTR *)(param_1[10] + 0x370));
if (uVar10 == 0) {
uVar7 = 0x54f;
uVar11 = 0x97;
uVar15 = 0x54f;
goto LAB_18002c65c;
}
uVar10 = uVar10 + uVar21;
local_64 = uVar10;
}
local_res18 = *(uint *)(lVar8 + 0x1c0);
local_58 = *(void **)(lVar8 + 0x1b8);
if (0x3fff < local_res18) {
uVar7 = 0x54f;
uVar11 = 0x96;
uVar15 = 0x54f;
goto LAB_18002c65c;
}
local_res8[0] = uVar20 + 7 + local_res18;
uVar15 = FUN_180060b8c(param_1,(ushort *)0x0,&local_68);
if (uVar15 != 0) {
return (ulonglong)uVar15;
}
local_res20 = local_68 + uVar21;
uVar15 = uVar10;
uVar22 = 0;
}
}
iVar16 = 1;
cVar2 = *(char *)((longlong)param_1 + 0xe9);
uVar18 = *(ushort *)(param_1 + 4);
iVar9 = *(int *)(param_1 + 0x78) + uVar21 + local_res8[0] + local_res20 + uVar15;
if (cVar2 == '\0') {
if ((uVar18 & 4) != 0) {
uVar10 = iVar9 + *(int *)(param_1 + 6);
uVar15 = *(uint *)((longlong)param_1 + 0x34);
if (uVar15 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar15 = uVar15 - uVar10 % uVar15;
}
uVar10 = uVar10 + uVar15;
}
iVar9 = uVar10 + *(int *)((longlong)param_1 + 0x2c);
}
iVar9 = iVar9 + *(int *)((longlong)param_1 + 0x3c);
}
else {
iVar9 = iVar9 + uVar19;
}
if ((uVar18 & 4) != 0) {
uVar15 = *(uint *)((longlong)param_1 + 0x34);
uVar10 = *(int *)(param_1 + 6) + 1;
if (uVar15 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar15 = uVar15 - uVar10 % uVar15;
}
uVar10 = uVar10 + uVar15;
}
iVar16 = uVar10 + *(int *)((longlong)param_1 + 0x2c);
}
if ((*(byte *)(param_1 + 8) & 0x30) == 0) {
iVar17 = (-(uint)(cVar2 != '\0') & 8) + 0x10;
}
else {
iVar17 = (-(uint)(cVar2 != '\0') & 8) + 0x28;
}
if ((uVar18 & 1) != 0) {
uVar10 = iVar17 + *(int *)(param_1 + 6);
uVar15 = *(uint *)((longlong)param_1 + 0x34);
if (uVar15 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar15 = uVar15 - uVar10 % uVar15;
}
uVar10 = uVar10 + uVar15;
}
iVar17 = uVar10 + *(int *)((longlong)param_1 + 0x2c);
}
uVar4 = FUN_180009e8c((longlong)param_1,param_2,
iVar16 + *(int *)((longlong)param_1 + 0x3c) * 2 + iVar17 + iVar9 + uVar22);
uVar7 = uVar4 & 0xffffffff;
if ((int)uVar4 != 0) {
return uVar7;
}
if (uVar22 != 0) {
if ((*(char *)((longlong)param_1 + 0xe9) == '\0') || ((*(byte *)(param_1 + 4) & 4) == 0)) {
uVar7 = 0;
}
else {
uVar7 = (ulonglong)*(uint *)((longlong)param_1 + 0x2c);
}
*(undefined2 *)(uVar7 + (ulonglong)param_2[1] + *(longlong *)(param_2 + 2) + (ulonglong)uVar19)
= 0x2901;
uVar4 = FUN_180009470(param_1,param_2,0x15,2);
uVar7 = uVar4 & 0xffffffff;
if ((int)uVar4 != 0) {
FUN_180012184((longlong)param_1,0x3b7,(int)uVar4);
return uVar7;
}
}
uVar22 = 0;
if ((*(char *)((longlong)param_1 + 0xe9) == '\0') && ((*(byte *)(param_1 + 4) & 4) != 0)) {
uVar15 = *(uint *)((longlong)param_1 + 0x2c);
}
else {
uVar15 = 0;
}
uVar18 = 0;
puVar14 = (undefined *)
((ulonglong)uVar15 + (ulonglong)param_2[1] + (ulonglong)uVar19 +
*(longlong *)(param_2 + 2));
if (local_64 != 0) {
uVar22 = FUN_180076074(puVar14 + uVar21,local_64,*(LPCWSTR *)(param_1[10] + 0x368),
*(LPCWSTR *)(param_1[10] + 0x370));
if (uVar22 == 0) {
return 0x54f;
}
FUN_18000a534(puVar14,0x17,(void *)0x0,uVar22,(uint)*(ushort *)((longlong)param_1 + 0xdc),
(uint)*(byte *)((longlong)param_1 + 0xe9));
bVar23 = *(char *)((longlong)param_1 + 0xe9) != '\0';
if (bVar23) {
*(short *)((longlong)param_1 + 0xdc) = *(short *)((longlong)param_1 + 0xdc) + 1;
}
uVar18 = (ushort)bVar23;
uVar22 = uVar22 + uVar21;
if (*(char *)(param_1 + 0x81) == '\0') {

uVar7 = (ulonglong)uVar15;
}
uVar15 = (uint)uVar7;
if (uVar15 != 0) {
uVar11 = 0x3e9;
goto LAB_18002c65c;
}
puVar14 = puVar14 + uVar22;
}
if (local_res8[0] != 0) {
local_res8[0] = local_res18 >> 8;
uVar12 = (undefined)(local_res18 >> 0x10);
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
memcpy(puVar14 + 7,local_58,(ulonglong)local_res18);
puVar14[5] = (char)local_res8[0];
puVar14[6] = (char)local_res18;
puVar14[4] = uVar12;
}
else {
memcpy(puVar14 + 0xf,local_58,(ulonglong)local_res18);
puVar14[0xd] = (char)local_res8[0];
puVar14[0xe] = (char)local_res18;
puVar14[0xc] = uVar12;
}
uVar10 = uVar20 + 7 + local_res18;
FUN_18000a534(puVar14,0xb,(void *)0x0,local_res18 + 3,
(uint)*(ushort *)((longlong)param_1 + 0xdc),
(uint)*(byte *)((longlong)param_1 + 0xe9));
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar18 = uVar18 + 1;
*(short *)((longlong)param_1 + 0xdc) = *(short *)((longlong)param_1 + 0xdc) + 1;
}
if (*(char *)(param_1 + 0x81) == '\0') {

uVar7 = (ulonglong)uVar15;
}
uVar15 = (uint)uVar7;
if (uVar15 != 0) {
uVar11 = 0x3ea;
goto LAB_18002c65c;
}
puVar14 = puVar14 + uVar10;
uVar22 = uVar22 + uVar10;
}
puVar1 = (ushort *)((longlong)param_1 + 0xdc);
local_res8[0] = *(uint *)(param_1 + 0x78) + uVar21;
FUN_18000a534(puVar14,0x10,(void *)param_1[0x77],*(uint *)(param_1 + 0x78),(uint)*puVar1,
(uint)*(byte *)((longlong)param_1 + 0xe9));
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar18 = uVar18 + 1;
*puVar1 = *puVar1 + 1;
}
if (*(char *)(param_1 + 0x81) == '\0') {

uVar7 = (ulonglong)uVar15;
}
uVar15 = (uint)uVar7;
if (uVar15 == 0) {
puVar14 = puVar14 + local_res8[0];
iVar9 = uVar22 + local_res8[0];
if (((*(uint *)(param_1 + 0x11) >> 0x1b & 1) != 0) && (*(char *)(param_1 + 0x81) == (char)uVar7)
) {
if (*(int *)(param_1[1] + 0x30) - 2U < 3) {


uVar15 = FUN_1800024d0(param_1,uVar6,uVar5,(ushort *)0x0);

}
else {

uVar15 = FUN_1800758bc(param_1,uVar5);
}

if (uVar15 != 0) {
return (ulonglong)uVar15;
}
}
if (local_res20 != 0) {
uVar22 = FUN_180060b8c(param_1,(ushort *)(puVar14 + uVar21),local_res8);
uVar15 = local_res8[0];
uVar7 = (ulonglong)uVar22;
if (uVar22 == 0x9035c) {
if (*param_2 < local_res8[0]) {
uVar7 = 0x54f;
}
else {
memcpy(*(void **)(param_2 + 2),puVar14,(ulonglong)local_res8[0]);
param_2[1] = uVar15;
}
LAB_18002c585:
*puVar1 = *puVar1 - uVar18;
return uVar7;
}
if (uVar22 != 0) goto LAB_18002c585;
FUN_18000a534(puVar14,0xf,(void *)0x0,local_res8[0],(uint)*puVar1,
(uint)*(byte *)((longlong)param_1 + 0xe9));
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
*puVar1 = *puVar1 + 1;
}
iVar16 = uVar15 + uVar21;

uVar7 = (ulonglong)uVar15;
if (uVar15 != 0) {
uVar11 = 0x3ec;
goto LAB_18002c65c;
}
iVar9 = iVar9 + iVar16;
}
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
uVar7 = FUN_180009470(param_1,param_2,0x16,iVar9);
uVar15 = (uint)uVar7;
uVar7 = uVar7 & 0xffffffff;
if (uVar15 != 0) {
uVar11 = 0x3b8;
goto LAB_18002c65c;
}
}
else {
uVar3 = *(undefined2 *)((longlong)param_1 + 0x22);
puVar14 = *(undefined **)(param_2 + 2);
puVar14[1] = (char)((ushort)uVar3 >> 8);
puVar14[0xb] = (char)((uint)iVar9 >> 8);
puVar14[2] = (char)uVar3;
*puVar14 = 0x16;
puVar14[0xc] = (char)iVar9;
param_2[1] = param_2[1] + local_60 + iVar9;
}
uVar7 = FUN_1800090d0(param_1,param_2);
uVar15 = (uint)uVar7;
uVar7 = uVar7 & 0xffffffff;
if (uVar15 == 0) {
return uVar7;
}
uVar11 = 0x98;
}
else {
uVar11 = 0x3eb;
}
LAB_18002c65c:
FUN_18005b470(param_1,uVar11,uVar15,0x50);
return uVar7;
}
=========================================
Function at address: 0x180002410
Called functions addresses: 0xEXTERNAL:0000011c


void FUN_180002410(longlong param_1)

{
longlong lVar1;
uint uVar2;
ulonglong uVar3;

*(undefined4 *)(param_1 + 0x2d0) = 0;
if (1 < *(uint *)(param_1 + 0x224)) {
uVar3 = 1;
do {
lVar1 = *(longlong *)(param_1 + 0x250 + uVar3 * 8);
if (lVar1 != 0) {
SslFreeObject(lVar1,0);
*(undefined8 *)(param_1 + 0x250 + uVar3 * 8) = 0;
}
uVar2 = (int)uVar3 + 1;
uVar3 = (ulonglong)uVar2;
} while (uVar2 < *(uint *)(param_1 + 0x224));
*(undefined4 *)(param_1 + 0x224) = 1;
}
return;
}
=========================================
Function at address: 0x180002488
Called functions addresses: 0x18006049c


uint FUN_180002488(longlong *param_1,undefined *param_2)

{
uint uVar1;

if (param_2 == (undefined *)0x0) {
uVar1 = 0x57;
}
else {
uVar1 = 0;
*param_2 = 0;
if (*(char *)((longlong)param_1 + 0x39b) != '\0') {
uVar1 = FUN_18006049c(param_1);
if (*(char *)((longlong)param_1 + 0x39b) == '\0') {
if ((*(char *)((longlong)param_1 + 0x39c) == '\0') && (uVar1 == 0x80090320)) {
uVar1 = 0x90320;
}
else {
if (uVar1 == 0) {
return 0;
}
if (uVar1 == 0x90320) {
return 0x90320;
}
if (uVar1 == 0x80090320) {
return 0x80090320;
}
}
}
else {
*(undefined4 *)(param_1 + 9) = *(undefined4 *)((longlong)param_1 + 0x44);
uVar1 = 0x90312;
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4d;
}
*param_2 = 1;
}
}
return uVar1;
}
=========================================
Function at address: 0x1800024d0
Called functions addresses: 0xEXTERNAL:000000c0 0x180028d90 0xEXTERNAL:000000bc 0x180054f60 0xEXTERNAL:00000102 0x18002a7c0 0xEXTERNAL:0000018b 0xEXTERNAL:00000114 0x18005b470 0xEXTERNAL:0000011c 0x180028070 0xEXTERNAL:000000f3


void FUN_1800024d0(longlong *param_1,undefined8 param_2,undefined8 param_3,ushort *param_4)

{
undefined2 uVar1;
int iVar2;
undefined8 uVar3;
ushort *puVar4;
ushort *puVar5;
undefined4 uVar6;
undefined8 *puVar7;
ulonglong uVar8;
ulonglong uVar9;
char cVar10;
undefined auStackY_188 [32];
undefined4 local_124;
undefined8 local_120;
undefined4 local_118;
uint local_114;
uint *local_110;
undefined local_108 [16];
uint local_f8 [2];
ushort *apuStack_f0 [5];
undefined local_c8 [64];
ushort local_88 [32];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_188;
puVar5 = (ushort *)0x0;
local_120 = 0;
local_114 = 0;
cVar10 = (char)param_4;
local_f8[0] = 0;
local_f8[1] = 0;
apuStack_f0[0] = (ushort *)0x0;
apuStack_f0[1] = (ushort *)0x0;
apuStack_f0[2] = (ushort *)0x0;
apuStack_f0[3] = (ushort *)0x0;
apuStack_f0[4] = (ushort *)0x0;
puVar4 = local_88;
memset(local_88,0,0x40);
if (param_1 == (longlong *)0x0) goto LAB_1800027de;
local_110 = local_f8;
local_118 = 0;
if ((*(uint *)(param_1 + 0x11) >> 0x1b & 1) == 0) {
apuStack_f0[0] = (ushort *)(param_1 + 0x22);
uVar8 = 2;
apuStack_f0[2] = (ushort *)(param_1 + 0x26);
local_f8[0] = 0x20;
local_f8[1] = 0x14;
apuStack_f0[1] = (ushort *)0x1500000020;
}
else {
uVar1 = *(undefined2 *)((longlong)param_1 + 0x22);

puVar4 = puVar5;
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
puVar4 = *(ushort **)param_1[1];
}
param_4 = local_88;
iVar2 = SslComputeSessionHash(puVar4,uVar3,uVar1);
if (iVar2 != 0) {
FUN_18005b470(param_1,0x25c,iVar2,0x33);
goto LAB_1800027de;
}
uVar8 = 1;
local_f8[0] = 0;
local_f8[1] = 0x19;
apuStack_f0[0] = local_88;
}
puVar7 = (undefined8 *)param_1[1];
local_114 = (uint)uVar8;
uVar9 = uVar8;
if (*(int *)(puVar7 + 6) == 4) {
param_4 = (ushort *)param_1[0x6a];
if (param_4 == (ushort *)0x0) goto LAB_1800027de;
if (*param_4 == 0) {
FUN_18005b470(param_1,0x25a,0x57,0x73);
goto LAB_1800027de;
}
puVar4 = (ushort *)(uVar8 * 2);
local_114 = local_114 + 1;
uVar9 = (ulonglong)local_114;
local_f8[uVar8 * 4 + 1] = 0x17;
local_f8[uVar8 * 4] = (uint)*param_4;
apuStack_f0[uVar8 * 2] = param_4 + 1;
}
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(puVar4,(PCEVENT_DESCRIPTOR)&DAT_180084bf0,uVar9,param_4,
(PEVENT_DATA_DESCRIPTOR)local_108);
puVar7 = (undefined8 *)param_1[1];
}
if ((((*(byte *)(param_1 + 4) & 1) != 0) &&
(puVar7 = (undefined8 *)param_1[1], puVar7 != (undefined8 *)0x0)) ||
(puVar4 = puVar5, puVar7 != (undefined8 *)0x0)) {
puVar4 = (ushort *)*puVar7;
}
puVar7 = &local_120;
iVar2 = SslGenerateMasterKey(puVar4,param_2);
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(puVar4,(PCEVENT_DESCRIPTOR)&DAT_180084be0,param_3,puVar7,
(PEVENT_DATA_DESCRIPTOR)local_108);
}
if (iVar2 != 0) {
FUN_18005b470(param_1,0x25a,iVar2,0x33);
goto LAB_1800027de;
}
RtlAcquireResourceExclusive(param_1[0xb] + 0x48,1);
uVar3 = local_120;
local_124 = 0;
*(undefined8 *)(param_1[0xb] + 0x10) = local_120;
if (param_1[0x14] != 0) {
SslFreeObject(param_1[0x14],0);
param_1[0x14] = 0;
}
if (param_1[0x15] != 0) {
SslFreeObject(param_1[0x15],0);
param_1[0x15] = 0;
}
if ((((*(byte *)(param_1 + 4) & 1) == 0) || (param_1[1] == 0)) ||
(*(int *)(param_1[1] + 0x1c) == 0)) {
LAB_180002797:
RtlReleaseResource(param_1[0xb] + 0x48);
uVar3 = 8;
if (cVar10 == '\0') {
uVar3 = 6;
}
LsaIModifyPerformanceCounter(uVar3,0,0);
}
else {
local_108._8_8_ = local_c8;
local_108._0_4_ = 0;
local_108._4_4_ = 4;

if (iVar2 == 0) {
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
puVar5 = *(ushort **)param_1[1];
}
iVar2 = SslGenerateSessionKeys(puVar5,uVar3,param_1 + 0x14,param_1 + 0x15);
if (iVar2 == 0) goto LAB_180002797;
uVar6 = 600;
}
else {
uVar6 = 0x259;
}
FUN_18005b470(param_1,uVar6,iVar2,0x33);
RtlReleaseResource(param_1[0xb] + 0x48);
}
LAB_1800027de:
FUN_180028070(local_48 ^ (ulonglong)auStackY_188);
return;
}
=========================================
Function at address: 0x180002858
Called functions addresses: 0x18000538c


int FUN_180002858(longlong param_1,longlong param_2,longlong *param_3)

{
int iVar1;
longlong local_res8;

local_res8 = 0;
iVar1 = FUN_18000538c(param_2,*(longlong *)(param_1 + 0x170),&local_res8);
if (iVar1 == 0) {
*(undefined4 *)(local_res8 + 0xa8) = *(undefined4 *)(param_1 + 0xa8);
*(undefined8 *)(local_res8 + 0xbc) = *(undefined8 *)(param_1 + 0xbc);
iVar1 = 0;
*(longlong *)(local_res8 + 0x180) = param_1;
*param_3 = local_res8;
}
return iVar1;
}
=========================================
Function at address: 0x1800028c8
Called functions addresses: 0x180002928 0x180002c5c


void FUN_1800028c8(longlong param_1,int param_2)

{
uint uVar1;

uVar1 = 0;
if (*(int *)(param_1 + 0x20) != 0) {
if (*(int *)(param_1 + 0x30) != 0) {
do {
FUN_180002928((ulonglong)uVar1 * 0x98 + *(longlong *)(param_1 + 0x28),param_2);
uVar1 = uVar1 + 1;
} while (uVar1 < *(uint *)(param_1 + 0x30));
}
FUN_180002c5c(param_1,'\0','\0');
}
return;
}
=========================================
Function at address: 0x180002928
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000c2 0xEXTERNAL:000000a8


void FUN_180002928(longlong param_1,int param_2)

{
undefined8 *puVar1;
undefined8 *puVar2;
undefined8 *puVar3;

RtlAcquireResourceShared(param_1 + 0x30,1);
puVar3 = *(undefined8 **)(param_1 + 0x10);
while (puVar3 != (undefined8 *)(param_1 + 0x10)) {
puVar2 = (undefined8 *)*puVar3;
puVar1 = puVar3 + -0x1d;
RtlAcquireResourceShared(puVar1,1);
if (*(int *)(puVar3 + -4) == param_2) {
RtlConvertSharedToExclusive(puVar1);
if (*(int *)(puVar3 + -4) == param_2) {
*(undefined4 *)(puVar3 + -4) = 0;
*(undefined2 *)((longlong)puVar3 + -0x44) = 0;
}
}
RtlReleaseResource(puVar1);
puVar3 = puVar2;
}
/* WARNING: Could not recover jumptable at 0x00018000297f. Too many branches */

RtlReleaseResource(param_1 + 0x30);
return;
}
=========================================
Function at address: 0x1800029e8
Called functions addresses: 0x18002a77b


undefined8 FUN_1800029e8(void *param_1,uint param_2,longlong param_3,uint param_4)

{
undefined8 uVar1;

uVar1 = 0;
if (((param_3 == 0) || (param_1 == (void *)0x0)) ||
((ulonglong)param_4 < (ulonglong)(param_2 * 2) + 8)) {
uVar1 = 0x80090308;
}
else {
memcpy((void *)(param_3 + 8),param_1,(ulonglong)param_2);
}
return uVar1;
}
=========================================
Function at address: 0x180002a40
Called functions addresses: 0x18002a77b


undefined8 FUN_180002a40(longlong param_1,void *param_2,byte *param_3)

{
byte bVar1;
byte bVar2;
undefined8 uVar3;

if (*(uint *)(param_1 + 4) < 0x100) {
bVar2 = *(byte *)(param_1 + 4);
uVar3 = 0;
if (param_2 == (void *)0x0) {
*param_3 = bVar2;
}
else {
bVar1 = *param_3;
*param_3 = bVar2;
if (bVar1 < bVar2) {
uVar3 = 0x80090321;
}
else {
memcpy(param_2,(void *)(param_1 + 8),(ulonglong)bVar2);
}
}
}
else {
uVar3 = 0x57;
}
return uVar3;
}
=========================================
Function at address: 0x180002a9c
Called functions addresses: 0x180002bf0 0xEXTERNAL:000000c0 0x180041cdc 0xEXTERNAL:000000bc 0x180041cb0 0x18000a1f4 0x18005b470 0x180041d20 0x18002a77b


undefined8 FUN_180002a9c(longlong *param_1,longlong param_2,uint param_3)

{
void *_Dst;
undefined4 uVar1;
uint uVar2;
undefined uVar3;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3d,&DAT_180085810);
}
if ((*(uint *)(param_1 + 0x11) >> 0x16 & 1) == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3e,&DAT_180085810);
}
uVar3 = 10;
uVar1 = 0x57a;
}
else {
if (param_3 < 6) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x3f,&DAT_180085810,param_3);
}
FUN_18005b470(param_1,0x578,0x80090326,0x32);
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090326;
}
FUN_180041d20(DAT_180091000[2],0x40,&DAT_180085810,0x80090326,0x26);
return 0x80090326;
}
if (param_3 < 0x10006) {
uVar2 = (uint)CONCAT11(*(undefined *)(param_2 + 4),*(undefined *)(param_2 + 5));
if (param_3 - 6 == uVar2) {
_Dst = (void *)FUN_18000a1f4((ulonglong)uVar2);
if (_Dst == (void *)0x0) {
return 0xe;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x42,&DAT_180085810,uVar2);
}
memcpy(_Dst,(void *)(param_2 + 6),(ulonglong)uVar2);
RtlAcquireResourceExclusive(param_1[0xa5] + 0x48,1);
FUN_180002bf0(param_1[0xa5],_Dst,uVar2,0,0,0,0,0,0);
RtlReleaseResource(param_1[0xa5] + 0x48);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041d20(DAT_180091000[2],0x43,&DAT_180085810,0,0);
}
return 0;
}
uVar3 = 0x32;
uVar1 = 0x579;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x41,&DAT_180085810,param_3);
}
uVar3 = 0x32;
uVar1 = 0x578;
}
}
FUN_18005b470(param_1,uVar1,0x80090326,uVar3);
return 0x80090326;
}
=========================================
Function at address: 0x180002bf0
Called functions addresses: 0xEXTERNAL:00000088 0x1800534ac 0x18000909c


void FUN_180002bf0(longlong param_1,undefined8 param_2,undefined4 param_3,undefined8 param_4,
undefined param_5,undefined4 param_6,undefined4 param_7,uint param_8,uint param_9)

{
uint uVar1;
int iVar2;
DWORD DVar3;
uint uVar4;
uint uVar5;

if (*(HLOCAL *)(param_1 + 0x1a8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x1a8));
}
*(undefined4 *)(param_1 + 0x1b0) = param_3;
*(undefined8 *)(param_1 + 0x1a8) = param_2;
if ((param_9 & 0x2000) != 0) {
if (*(HLOCAL *)(param_1 + 200) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 200));
}
*(undefined *)(param_1 + 0xd0) = param_5;
*(undefined4 *)(param_1 + 0xd4) = param_6;
*(undefined4 *)(param_1 + 0x19c) = param_7;
*(undefined8 *)(param_1 + 200) = param_4;
DVar3 = GetTickCount();
iVar2 = *(int *)(param_1 + 0x19c);
*(DWORD *)(param_1 + 0x1a0) = DVar3;
if (DAT_1800919d0 < param_8) {
param_8 = DAT_1800919d0;
}
uVar4 = FUN_1800534ac(*(uint *)(param_1 + 0x114));
uVar1 = iVar2 * 1000 + uVar4;
uVar5 = param_8;
if ((uVar4 < uVar1) && (uVar5 = uVar1, param_8 <= uVar1)) {
uVar5 = param_8;
}
*(uint *)(param_1 + 0x118) = uVar5;
}
return;
}
=========================================
Function at address: 0x180002c5c
Called functions addresses: 0x180002d50 0xEXTERNAL:000000e0 0xEXTERNAL:000000da


ulonglong FUN_180002c5c(longlong param_1,char param_2,char param_3)

{
int *piVar1;
ulonglong uVar2;
int iVar3;
uint uVar4;
char cVar6;
ulonglong uVar5;

LOCK();
piVar1 = (int *)(param_1 + 100);
iVar3 = *piVar1;
*piVar1 = *piVar1 + 1;
UNLOCK();
uVar2 = (ulonglong)(iVar3 + 1U);
uVar5 = 0;
if ((param_2 == '\0') || ((int)(iVar3 + 1U) < 2)) {
RtlEnterCriticalSection(param_1 + 0x38);
if (*(int *)(param_1 + 0x30) != 0) {
iVar3 = *(int *)(param_1 + 0x1c);
do {
if ((param_2 == '\0') || (cVar6 = '\x01', param_3 != '\0')) {
cVar6 = '\0';
}
FUN_180002d50(uVar5 * 0x98 + *(longlong *)(param_1 + 0x28),(int *)(param_1 + 0x20),iVar3,
cVar6);
iVar3 = *(int *)(param_1 + 0x1c);
} while ((((iVar3 <= *(int *)(param_1 + 0x20)) || (param_2 == '\0')) || (param_3 != '\0')) &&
(uVar4 = (int)uVar5 + 1, uVar5 = (ulonglong)uVar4, uVar4 < *(uint *)(param_1 + 0x30)))
;
}
uVar2 = RtlLeaveCriticalSection(param_1 + 0x38);
uVar5 = 1;
}
LOCK();
*(int *)(param_1 + 100) = *(int *)(param_1 + 100) + -1;
UNLOCK();
return CONCAT71((int7)(uVar2 >> 8),(char)uVar5);
}
=========================================
Function at address: 0x180002d50
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0xEXTERNAL:0000018b 0x18002a7c0 0xEXTERNAL:00000088 0x18002c9e0


undefined8 FUN_180002d50(longlong param_1,int *param_2,int param_3,char param_4)

{
longlong *******ppppppplVar1;
longlong *plVar2;
longlong lVar3;
longlong *plVar4;
longlong *****ppppplVar5;
longlong ******pppppplVar6;
code *pcVar7;
longlong *plVar8;
DWORD DVar9;
undefined8 uVar10;
longlong *******ppppppplVar11;
uint uVar12;
longlong *******ppppppplVar13;
longlong ******local_38;
longlong *******ppppppplVar14;

DVar9 = GetTickCount();
ppppppplVar13 = (longlong *******)(param_1 + 0x30);
ppppppplVar14 = &local_38;
local_38 = (longlong ******)&local_38;
ppppppplVar11 = ppppppplVar13;
RtlAcquireResourceExclusive(ppppppplVar13,1);
plVar2 = *(longlong **)(param_1 + 0x20);
joined_r0x000180002dbb:
do {
plVar8 = plVar2;
if (plVar8 == (longlong *)(param_1 + 0x20)) {
LAB_180002dbd:
RtlReleaseResource(ppppppplVar13);
ppppppplVar13 = (longlong *******)local_38;
if ((longlong *******)local_38 != &local_38) {
do {
ppppppplVar14 = (longlong *******)*ppppppplVar13;
if (((longlong *******)ppppppplVar14[1] != ppppppplVar13) ||
(pppppplVar6 = ppppppplVar13[1], (longlong *******)*pppppplVar6 != ppppppplVar13)) {
LAB_180002f81:
pcVar7 = (code *)swi(0x29);
(*pcVar7)(3);
pcVar7 = (code *)swi(3);
uVar10 = (*pcVar7)();
return uVar10;
}
*pppppplVar6 = (longlong *****)ppppppplVar14;
ppppppplVar14[1] = pppppplVar6;
if (ppppppplVar13 + -0x26 != (longlong *******)0x0) {

}
ppppppplVar13 = ppppppplVar14;
} while (ppppppplVar14 != &local_38);
}
return CONCAT71((int7)((ulonglong)&local_38 >> 8),1);
}
plVar2 = (longlong *)*plVar8;
} while (1 < *(int *)(plVar8 + -0xb));
uVar12 = DVar9 - *(int *)((longlong)plVar8 + -0x2c);
if (*(uint *)((longlong)plVar8 + -0x2c) < DVar9) {
if (uVar12 <= *(uint *)(plVar8 + -5)) goto LAB_180002e2a;
*(undefined2 *)((longlong)plVar8 + -0x54) = 0;
ppppppplVar11 = (longlong *******)((ulonglong)ppppppplVar11 & 0xffffffffffffff00);
}
else {
if (DVar9 < *(uint *)((longlong)plVar8 + -0x2c)) {
uVar10 = FUN_18002c9e0(ppppppplVar11,uVar12,*(uint *)(plVar8 + -5),plVar8,
(longlong *)ppppppplVar14);
return uVar10;
}
LAB_180002e2a:
ppppppplVar11 = (longlong *******)(ulonglong)*(byte *)((longlong)plVar8 + -0x54);
}
if (param_3 < *param_2) {
*(undefined2 *)((longlong)plVar8 + -0x54) = 0;
}
else if ((char)ppppppplVar11 == '\x01') goto joined_r0x000180002dbb;
if (*(char *)((longlong)plVar8 + -0x53) != '\x01') {
lVar3 = plVar8[-4];
if ((*(longlong **)(lVar3 + 8) != plVar8 + -4) ||
(plVar4 = (longlong *)plVar8[-3], (longlong *)*plVar4 != plVar8 + -4)) goto LAB_180002f81;
*plVar4 = lVar3;
ppppppplVar1 = (longlong *******)(plVar8 + -2);
*(longlong **)(lVar3 + 8) = plVar4;
pppppplVar6 = *ppppppplVar1;
if (((longlong *******)pppppplVar6[1] != ppppppplVar1) ||
(ppppplVar5 = (longlong *****)plVar8[-1], (longlong *******)*ppppplVar5 != ppppppplVar1))
goto LAB_180002f81;
*ppppplVar5 = (longlong ****)pppppplVar6;
pppppplVar6[1] = ppppplVar5;
lVar3 = *plVar8;
if ((*(longlong **)(lVar3 + 8) != plVar8) ||
(plVar4 = (longlong *)plVar8[1], (longlong *)*plVar4 != plVar8)) goto LAB_180002f81;
*plVar4 = lVar3;
*(longlong **)(lVar3 + 8) = plVar4;
LOCK();
*param_2 = *param_2 + -1;
UNLOCK();
LsaIModifyPerformanceCounter(4);
if ((longlong *******)*ppppppplVar14 != &local_38) goto LAB_180002f81;
plVar8[-1] = (longlong)ppppppplVar14;
ppppppplVar11 = &local_38;
*ppppppplVar1 = (longlong ******)ppppppplVar11;
*ppppppplVar14 = (longlong ******)ppppppplVar1;
ppppppplVar14 = ppppppplVar1;
if ((*param_2 < param_3) && (param_4 != '\0')) goto LAB_180002dbd;
}
goto joined_r0x000180002dbb;
}
=========================================
Function at address: 0x180002f90
Called functions addresses: 0x180003000 0x180002c5c


void FUN_180002f90(longlong param_1,longlong param_2)

{
uint uVar1;

uVar1 = 0;
if (*(int *)(param_1 + 0x20) != 0) {
if (*(int *)(param_1 + 0x30) != 0) {
do {
FUN_180003000((ulonglong)uVar1 * 0x98 + *(longlong *)(param_1 + 0x28),param_2);
uVar1 = uVar1 + 1;
} while (uVar1 < *(uint *)(param_1 + 0x30));
}
FUN_180002c5c(param_1,'\0','\0');
}
return;
}
=========================================
Function at address: 0x180003000
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000c2 0xEXTERNAL:000000a8


void FUN_180003000(longlong param_1,longlong param_2)

{
undefined8 uVar1;
undefined8 *puVar2;
undefined8 *puVar3;
int iVar4;
int iVar5;

RtlAcquireResourceShared(param_1 + 0x30,1);
puVar3 = *(undefined8 **)(param_1 + 0x10);
while (puVar3 != (undefined8 *)(param_1 + 0x10)) {
uVar1 = *(undefined8 *)(param_2 + 0x2f8);
puVar2 = (undefined8 *)*puVar3;
RtlAcquireResourceShared(puVar3 + -0x1d,1);
iVar4 = (int)uVar1;
if ((((iVar4 == *(int *)((longlong)puVar3 + -0x74)) &&
(iVar5 = (int)((ulonglong)uVar1 >> 0x20), iVar5 == *(int *)(puVar3 + -0xe))) &&
(RtlConvertSharedToExclusive(puVar3 + -0x1d), iVar4 == *(int *)((longlong)puVar3 + -0x74)))
&& (iVar5 == *(int *)(puVar3 + -0xe))) {
*(undefined2 *)((longlong)puVar3 + -0x44) = 0;
}
RtlReleaseResource(puVar3 + -0x1d);
puVar3 = puVar2;
}
/* WARNING: Could not recover jumptable at 0x00018000309d. Too many branches */

RtlReleaseResource(param_1 + 0x30);
return;
}
=========================================
Function at address: 0x1800030f0
Called functions addresses: 0x18004312c 0x180002f90 0x18002a7c0 0x18000329b 0x18002ca26 0x1800028c8 0x1800431f4 0x180003d4c 0x180041e9c


void FUN_1800030f0(longlong *param_1,undefined8 param_2,longlong *param_3)

{
char cVar1;
ulonglong uVar2;
longlong lVar3;
undefined8 *puVar4;
undefined uVar5;
undefined8 unaff_RBX;
undefined8 unaff_RSI;
undefined unaff_DIL;
char cVar6;
undefined in_R9B;
longlong *plVar7;
undefined auStack_78 [32];
undefined in_stack_ffffffffffffffb0;
char in_stack_ffffffffffffffb8;
undefined uVar8;
longlong in_stack_ffffffffffffffc0;
undefined in_stack_ffffffffffffffc8;
undefined uVar9;
uint in_stack_ffffffffffffffd0;
undefined in_stack_ffffffffffffffd8;
undefined in_stack_ffffffffffffffe0;

uVar2 = DAT_180091970 ^ (ulonglong)auStack_78;
if (((byte)DAT_180092f00 & 1) != 0) {
param_3 = param_1;
FUN_1800431f4(param_1,param_2,param_1);
}
puVar4 = DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_2 = 0x43;
param_3 = (longlong *)&DAT_180084ce0;
puVar4 = (undefined8 *)DAT_180091000[2];
plVar7 = param_1;
FUN_180041e9c(puVar4,0x43,&DAT_180084ce0,param_1);
in_R9B = SUB81(plVar7,0);
}
if (param_1 != (longlong *)0x0) {
FUN_180002f90(DAT_1800927f0,(longlong)param_1);

uVar9 = (undefined)in_stack_ffffffffffffffd0;
cVar6 = '\b';
if (cVar1 != '\0') {
if ((in_stack_ffffffffffffffd0 & 0x20) != 0) {
FUN_1800028c8(DAT_1800927f0,*(int *)((longlong)param_1 + 0xd4));
}
uVar9 = (undefined)in_stack_ffffffffffffffd0;
cVar6 = '\b';
if ((in_stack_ffffffffffffffd0 & 0x40) != 0) {
cVar6 = '\x04';
}
}
if (1 < *(uint *)(param_1 + 0x5c)) {
in_stack_ffffffffffffffb8 = (char)*(uint *)(param_1 + 0x5c) * cVar6 * '\x02';

if (in_stack_ffffffffffffffc0 != 0) {
in_R9B = SUB81(&stack0xffffffffffffffb8,0);
param_3 = (longlong *)0x0;

}
}
uVar8 = (undefined)in_stack_ffffffffffffffc0;
lVar3 = DAT_1800927e8;
FUN_180003d4c(DAT_1800927e8,param_1);
uVar5 = SUB81(param_1,0);
if (((byte)DAT_180092f00 & 1) != 0) {
in_R9B = 1;
uVar5 = 0xc0;
FUN_18004312c(lVar3,&DAT_180084bc0,param_3,1,(undefined8 *)&stack0xffffffffffffffe0);
}
FUN_18000329b((char)lVar3,uVar5,(char)param_3,in_R9B,in_stack_ffffffffffffffb0,
in_stack_ffffffffffffffb8,uVar8,in_stack_ffffffffffffffc8,uVar9,
in_stack_ffffffffffffffd8,uVar2,unaff_DIL,unaff_RBX,unaff_RSI);
return;
}
FUN_18002ca26(puVar4,param_2,param_3,in_R9B,in_stack_ffffffffffffffb0,in_stack_ffffffffffffffb8,
(char)in_stack_ffffffffffffffc0,in_stack_ffffffffffffffc8,
(char)in_stack_ffffffffffffffd0,in_stack_ffffffffffffffd8,in_stack_ffffffffffffffe0)
;
return;
}
=========================================
Function at address: 0x18000329b
Called functions addresses: 0x180028070


void FUN_18000329b(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
undefined param_5,undefined param_6,undefined param_7,undefined param_8,
undefined param_9,undefined param_10,ulonglong param_11,undefined1 param_12,
undefined8 param_13,undefined8 param_14)

{
FUN_180028070(param_11 ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x1800032c4
Called functions addresses: 0x18002ca56 0x1800032dc


undefined8 FUN_1800032c4(undefined8 param_1,undefined8 param_2,uint param_3)

{
undefined8 uVar1;
uint uVar2;
uint uVar3;

uVar3 = (uint)param_2;
uVar2 = (uint)param_1;
if (uVar2 < uVar3) {
if (param_3 < uVar3 - uVar2) {
return CONCAT71((uint7)(uint3)(uVar3 - uVar2 >> 8),1);
}
}
else if (uVar3 < uVar2) {
uVar1 = FUN_18002ca56(param_1,param_2,param_3);
return uVar1;
}
return 0;
}
=========================================
Function at address: 0x1800032dc
Called functions addresses: None


undefined FUN_1800032dc(void)

{
return 1;
}
=========================================
Function at address: 0x1800032f0
Called functions addresses: 0x180003328 0x18000909c


undefined8 * FUN_1800032f0(undefined8 *param_1,uint param_2)

{
FUN_180003328(param_1);
if ((param_2 & 1) != 0) {
FUN_18000909c(param_1);
}
return param_1;
}
=========================================
Function at address: 0x180003328
Called functions addresses: 0x180014550 0xEXTERNAL:0000014a 0x180004080 0x18000909c


void FUN_180003328(undefined8 *param_1)

{
longlong lVar1;

*param_1 = &PTR_FUN_18007c210;
if ((HLOCAL)param_1[0x2a] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x2a]);
}
if ((LPVOID)param_1[0x2c] != (LPVOID)0x0) {
CryptMemFree((LPVOID)param_1[0x2c]);
}
if ((HLOCAL)param_1[0x32] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x32]);
}
if ((HLOCAL)param_1[0x2e] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x2e]);
}
lVar1 = param_1[0x30];
if (lVar1 != 0) {
FUN_180014550(*(longlong *)(lVar1 + 0xe0),lVar1,'\x01','\0');
}
if ((HLOCAL)param_1[0x35] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x35]);
}
FUN_180004080(param_1);
return;
}
=========================================
Function at address: 0x1800033e0
Called functions addresses: 0x180003400


longlong * FUN_1800033e0(longlong *param_1,undefined8 param_2,uint param_3)

{
FUN_180003400(param_1,param_2,param_3);
return param_1;
}
=========================================
Function at address: 0x180003400
Called functions addresses: 0x180003df0 0x18002a7c0 0x180003ed0 0x1800726b8 0x180028a7c 0x18006fe4c 0x180003d20 0x180003d4c 0x18000909c 0x180003700 0x180014550 0x18005abd8 0x180003ce4 0x180003e7c 0x1800209bc 0xEXTERNAL:0000011c 0x180003ea4


void FUN_180003400(longlong *param_1,undefined8 param_2,uint param_3)

{
int *piVar1;
int iVar2;
HLOCAL pvVar3;
longlong *plVar4;
longlong lVar5;

*param_1 = (longlong)&PTR_FUN_18007c000;
FUN_180003ed0(param_1,param_2,param_3);
if ((HLOCAL)param_1[0xa6] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0xa6]);
}
if (((*(uint *)(param_1 + 0x11) >> 0x13 & 1) != 0) && (param_1[0x74] != 0)) {

}
if ((HLOCAL)param_1[0xa7] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0xa7]);
}
*param_1 = (longlong)&PTR_FUN_18007cba8;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
plVar4 = (longlong *)param_1[0x3a];
if (plVar4 != (longlong *)0x0) {
if ((*plVar4 != 0) && (plVar4[3] != 0)) {

plVar4[3] = 0;
*(undefined4 *)(plVar4 + 2) = 0;
plVar4 = (longlong *)param_1[0x3a];
}
FUN_180003700((longlong)param_1,plVar4);
}
}
else {
if ((HLOCAL)param_1[0x47] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x47]);
}
lVar5 = param_1[0x49];
if (lVar5 != 0) {
FUN_1800726b8(lVar5);
_o_free(lVar5);
param_1[0x49] = 0;
}
if (param_1[0x48] != 0) {
FUN_18005abd8(param_1[0x48]);
param_1[0x48] = 0;
}
FUN_18006fe4c((longlong)param_1);
}
if ((HLOCAL)param_1[0x62] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x62]);
}
if ((HLOCAL)param_1[99] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[99]);
}
if ((HLOCAL)param_1[100] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[100]);
}
FUN_180003ea4(param_1);
if ((HLOCAL)param_1[0x66] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x66]);
}
FUN_180003e7c(param_1);
lVar5 = param_1[0x68];
if (lVar5 != 0) {
if (*(longlong *)(lVar5 + 8) != 0) {

lVar5 = param_1[0x68];
}

param_1[0x68] = 0;
}
pvVar3 = (HLOCAL)param_1[0x69];
if (pvVar3 != (HLOCAL)0x0) {
if (*(HLOCAL *)((longlong)pvVar3 + 8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)pvVar3 + 8));
pvVar3 = (HLOCAL)param_1[0x69];
}
if (*(HLOCAL *)((longlong)pvVar3 + 0x18) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)pvVar3 + 0x18));
pvVar3 = (HLOCAL)param_1[0x69];
}
FUN_18000909c(pvVar3);
param_1[0x69] = 0;
}
if ((HLOCAL)param_1[0x6a] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6a]);
}
if ((HLOCAL)param_1[0x6b] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6b]);
}
if ((HLOCAL)param_1[0x6c] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6c]);
}
FUN_180003df0((longlong)param_1);
*param_1 = (longlong)&PTR_FUN_18007cdb8;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
if (param_1[0x13] != 0) {
SslFreeObject(param_1[0x13],0);
}
if (param_1[0x14] != 0) {
SslFreeObject(param_1[0x14],0);
}
if (param_1[0x15] != 0) {
SslFreeObject(param_1[0x15],0);
}
if (param_1[0xe] != 0) {
SslFreeObject(param_1[0xe],0);
}
lVar5 = param_1[1];
if (lVar5 != 0) {
if (*(longlong *)(lVar5 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar5 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar5 + 0x358));
}
if ((longlong *)param_1[3] != (longlong *)0x0) {
FUN_1800209bc((longlong *)param_1[3]);
}
if ((((1 < *(int *)((longlong)param_1 + 0x44) - 3U) &&
(*(int *)((longlong)param_1 + 0x44) != 0x4f)) &&
((*(uint *)(param_1 + 0x11) >> 0x12 & 1) == 0)) && (param_1[0xb] != 0)) {
*(undefined *)(param_1[0xb] + 0xec) = 0;
}
if ((longlong *)param_1[10] != (longlong *)0x0) {
FUN_180003d4c(DAT_1800927e8,(longlong *)param_1[10]);
}
lVar5 = param_1[0xb];
if (lVar5 != 0) {
FUN_180014550(*(longlong *)(lVar5 + 0xe0),lVar5,'\x01','\0');
}
lVar5 = param_1[0xf];
if (lVar5 != 0) {
LOCK();
piVar1 = (int *)(lVar5 + 0x14);
iVar2 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar2 == 1) {

}
}
*param_1 = (longlong)&PTR_FUN_18007cfb8;
return;
}
=========================================
Function at address: 0x180003700
Called functions addresses: 0x180003744 0x18002a7c0 0xEXTERNAL:00000040


void FUN_180003700(longlong param_1,HLOCAL param_2)

{
if (*(longlong *)(*(longlong *)(param_1 + 0x80) + 0x18) != 0) {

FUN_180003744();
return;
}
if (DAT_180092620 != 0) {

return;
}
LocalFree(param_2);
FUN_180003744();
return;
}
=========================================
Function at address: 0x180003744
Called functions addresses: None


void FUN_180003744(void)

{
return;
}
=========================================
Function at address: 0x180003750
Called functions addresses: 0x180028d90 0x18002a7c0 0x18000d31c 0x18000a1f4


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined8 * FUN_180003750(undefined8 *param_1,longlong param_2,uint param_3,undefined8 param_4)

{
char cVar1;
undefined2 uVar2;
undefined4 uVar3;
ulonglong uVar4;
undefined8 *puVar5;
undefined2 uVar6;
undefined8 *puVar7;
undefined local_28 [8];
byte local_20;

puVar7 = (undefined8 *)0x0;
*param_1 = &PTR_FUN_18007cdb8;
param_1[1] = 0;
param_1[2] = 0;
param_1[3] = 0;
uVar6 = 0;
*(undefined2 *)(param_1 + 4) = 0;
*(undefined4 *)((longlong)param_1 + 0x24) = 0;
param_1[5] = 0;
param_1[6] = 0;
*(undefined4 *)(param_1 + 7) = 0;
*(uint *)(param_1 + 8) = param_3;
*(undefined8 *)((longlong)param_1 + 0x44) = 0;
param_1[10] = 0;
param_1[0xb] = param_2;
*(undefined2 *)(param_1 + 0xc) = 0;
param_1[0xd] = 0;
param_1[0xe] = 0;
param_1[0xf] = 0;
param_1[0x10] = 0;
param_1[0x11] = 0;
param_1[0x12] = 0;
param_1[0x13] = 0;
param_1[0x14] = 0;
param_1[0x15] = 0;
param_1[0x16] = 0;
param_1[0x17] = 0;
*(undefined4 *)(param_1 + 0x18) = 0;
param_1[0x19] = 0;
param_1[0x1a] = 0;
*(undefined4 *)(param_1 + 0x1b) = 0;
*(undefined2 *)((longlong)param_1 + 0xdc) = 0;
param_1[0x1c] = 0;
*(undefined *)(param_1 + 0x1d) = 0;
*(undefined2 *)((longlong)param_1 + 0xea) = 0;
param_1[0x1e] = 0;
param_1[0x1f] = 0;
param_1[0x20] = 0;
*(undefined2 *)(param_1 + 0x21) = 0;
*(undefined *)((longlong)param_1 + 0x10a) = 0;
if (param_2 != 0) {
*(undefined4 *)(param_1 + 2) = *(undefined4 *)(param_2 + 0xb8);
}

if (cVar1 != '\0') {
if ((local_20 & 1) != 0) {
param_1[0x11] = param_1[0x11] | 0x20000000;
}
*(bool *)((longlong)param_1 + 0x10a) = (local_20 & 0x11) == 0;
}
uVar4 = FUN_18000d31c(*(uint *)(param_1 + 8));
*(short *)((longlong)param_1 + 0x22) = (short)uVar4;
if (((char)((uVar4 & 0xffff) >> 8) != -2) || (uVar3 = 0xd, 0xfeff < (uint)(uVar4 & 0xffff))) {
uVar3 = 5;
}
*(undefined4 *)((longlong)param_1 + 0x3c) = uVar3;
*(bool *)((longlong)param_1 + 0xe9) = (param_3 & 0xf0000) != 0;
if ((((DAT_180091480 != 0) && ((_DAT_180091490 & 0x400000000000) != 0)) &&
((DAT_180091498 & 0x400000000000) == DAT_180091498)) &&
(puVar5 = (undefined8 *)FUN_18000a1f4(0x700), puVar5 != (undefined8 *)0x0)) {
*(undefined4 *)(puVar5 + 1) = 0;
*puVar5 = &PTR_FUN_18007cf58;
*(undefined *)(puVar5 + 2) = 0;
*(undefined4 *)((longlong)puVar5 + 0x14) = 1;
memset(puVar5 + 3,0,0x6e8);
puVar7 = puVar5;
}
param_1[0xf] = puVar7;
memset(param_1 + 0x22,0,0x40);
*(undefined4 *)(param_1 + 0x2a) = 0;
*(undefined *)((longlong)param_1 + 0x154) = 0;
memset((void *)((longlong)param_1 + 0x155),0,0x48);
*(undefined4 *)(param_1 + 0x34) = 0;
*(undefined8 *)((longlong)param_1 + 0x1a4) = 0;
*(undefined8 *)((longlong)param_1 + 0x1ac) = 0;
*(undefined8 *)((longlong)param_1 + 0x1b4) = 0;
*(undefined8 *)((longlong)param_1 + 0x1bc) = 0;
*(undefined8 *)((longlong)param_1 + 0x1c4) = 0;
param_1[0x3a] = 0;
*(undefined4 *)(param_1 + 0x3b) = 0;
*(undefined8 *)((longlong)param_1 + 0x1dc) = 0;
*(undefined8 *)((longlong)param_1 + 0x1e4) = 0;
*(undefined8 *)((longlong)param_1 + 0x1ec) = 0;
*(undefined8 *)((longlong)param_1 + 500) = 0;
*(undefined4 *)((longlong)param_1 + 0x1fc) = 0;
param_1[0x40] = 0;
param_1[0x41] = 0;
param_1[0x42] = 0;
param_1[0x43] = 0;
*(undefined2 *)(param_1 + 0x44) = 0;
*(undefined8 *)((longlong)param_1 + 0x224) = 0;
*(undefined *)((longlong)param_1 + 0x22c) = 0;
param_1[0x46] = 0;
param_1[0x47] = 0;
memset(param_1 + 0x4a,0,0x80);
*(undefined4 *)(param_1 + 0x5a) = 0;
*(undefined8 *)((longlong)param_1 + 0x2d4) = 0;
*(undefined8 *)((longlong)param_1 + 0x2dc) = 0;
uVar2 = 0;
*(undefined8 *)((longlong)param_1 + 0x2e4) = 0;
*(undefined8 *)((longlong)param_1 + 0x2ec) = 0;
*(undefined8 *)((longlong)param_1 + 0x2f4) = 0;
*(undefined8 *)((longlong)param_1 + 0x2fc) = 0;
*(undefined8 *)((longlong)param_1 + 0x304) = 0;
*(undefined4 *)((longlong)param_1 + 0x30c) = 0;
param_1[0x62] = 0;
param_1[99] = 0;
param_1[100] = 0;
param_1[0x65] = 0;
param_1[0x66] = 0;
param_1[0x67] = 0;
param_1[0x68] = 0;
param_1[0x69] = 0;
param_1[0x6a] = 0;
param_1[0x6b] = 0;
param_1[0x6c] = 0;
*(undefined4 *)(param_1 + 0x6d) = 0;
param_1[0x6e] = 0;
*(undefined4 *)(param_1 + 0x6f) = 0;
param_1[0x70] = 0;
param_1[0x71] = 0;
param_1[0x72] = 0;
*(undefined4 *)(param_1 + 0x73) = 0;
*(undefined2 *)((longlong)param_1 + 0x39c) = 0;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
*(undefined4 *)(param_1 + 0x18) = 0xffffffff;
param_1[0x19] = 0;
param_1[0x1a] = 0;
}
else {
uVar2 = 0x43b;
uVar6 = 0x448;
}
*(undefined2 *)(param_1 + 0x1b) = uVar6;
*(undefined2 *)((longlong)param_1 + 0xda) = uVar2;
param_1[0x74] = 0;
*param_1 = &PTR_FUN_18007c000;
param_1[0x75] = 0;
*(undefined4 *)(param_1 + 0x76) = 0;
param_1[0x77] = 0;
*(undefined4 *)(param_1 + 0x78) = 0;
param_1[0x79] = 0;
*(undefined4 *)(param_1 + 0x7a) = 0;
*(undefined2 *)((longlong)param_1 + 0x3d4) = 0;
*(undefined8 *)((longlong)param_1 + 0x3d6) = 0;
*(undefined8 *)((longlong)param_1 + 0x3de) = 0;
*(undefined8 *)((longlong)param_1 + 0x3e6) = 0;
*(undefined8 *)((longlong)param_1 + 0x3ee) = 0;
param_1[0x7f] = 0;
param_1[0x80] = 0;
*(undefined *)(param_1 + 0x81) = 0;
param_1[0x82] = 0;
*(undefined4 *)(param_1 + 0x83) = 0;
memset((void *)((longlong)param_1 + 0x41c),0,0xff);
*(undefined8 *)((longlong)param_1 + 0x51c) = 0;
param_1[0xa5] = param_2;
param_1[0xa6] = param_4;
param_1[0xa7] = 0;
*(undefined *)(param_1 + 0xa8) = 0;
*(undefined2 *)((longlong)param_1 + 0x542) = 0;
*(undefined4 *)((longlong)param_1 + 0x544) = 0;
param_1[0xa9] = 0;
*(undefined4 *)(param_1 + 0xaa) = 0;
*(undefined4 *)((longlong)param_1 + 0x44) = 0x28;
param_1[0x49] = 0;
param_1[0x48] = 0;
return param_1;
}
=========================================
Function at address: 0x180003c24
Called functions addresses: 0x180003ce4 0xEXTERNAL:0000011c 0x180003d20 0x18000909c 0xEXTERNAL:0000012b


void FUN_180003c24(longlong param_1)

{
longlong lVar1;

if (*(longlong *)(param_1 + 0x10) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x10),0);
}
if (*(HLOCAL *)(param_1 + 0x18) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x18));
}
if (*(HLOCAL *)(param_1 + 0x28) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x28));
}
if (*(PCCERT_CONTEXT *)(param_1 + 0x30) != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(*(PCCERT_CONTEXT *)(param_1 + 0x30));
}
if (*(HLOCAL *)(param_1 + 0x38) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x38));
}
lVar1 = *(longlong *)(param_1 + 0xb0);
if (lVar1 != 0) {
if (*(longlong *)(lVar1 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar1 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar1 + 0x358));
}
if (*(HLOCAL *)(param_1 + 200) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 200));
}
return;
}
=========================================
Function at address: 0x180003ce4
Called functions addresses: 0x180026ce8


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

int FUN_180003ce4(longlong *param_1)

{
int *piVar1;
int iVar2;

LOCK();
piVar1 = (int *)((longlong)param_1 + 0xc);
iVar2 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar2 + -1 == 0) {
LOCK();
_DAT_180092d90 = _DAT_180092d90 + -1;
UNLOCK();
FUN_180026ce8(*(uint *)(param_1 + 1),*param_1,param_1);
}
return iVar2 + -1;
}
=========================================
Function at address: 0x180003d20
Called functions addresses: 0x18000909c


int FUN_180003d20(HLOCAL param_1)

{
int *piVar1;
int iVar2;

LOCK();
piVar1 = (int *)((longlong)param_1 + 0xc);
iVar2 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar2 + -1 == 0) {
FUN_18000909c(param_1);
}
return iVar2 + -1;
}
=========================================
Function at address: 0x180003d4c
Called functions addresses: 0x18002a7c0 0xEXTERNAL:000000e0 0xEXTERNAL:000000da


void FUN_180003d4c(longlong param_1,longlong *param_2)

{
longlong *plVar1;
int iVar2;
longlong lVar3;
longlong *plVar4;
code *pcVar5;

LOCK();
plVar1 = param_2 + 3;
iVar2 = *(int *)plVar1;
*(int *)plVar1 = *(int *)plVar1 + -1;
UNLOCK();
if (iVar2 == 1) {
RtlEnterCriticalSection(param_1 + 8);
plVar1 = param_2 + 1;
lVar3 = *plVar1;
if ((*(longlong **)(lVar3 + 8) != plVar1) ||
(plVar4 = (longlong *)param_2[2], (longlong *)*plVar4 != plVar1)) {
pcVar5 = (code *)swi(0x29);
(*pcVar5)(3);
pcVar5 = (code *)swi(3);
(*pcVar5)();
return;
}
*plVar4 = lVar3;
*(longlong **)(lVar3 + 8) = plVar4;
RtlLeaveCriticalSection(param_1 + 8);
if (param_2 != (longlong *)0x0) {

}
}
return;
}
=========================================
Function at address: 0x180003df0
Called functions addresses: 0xEXTERNAL:0000011c


void FUN_180003df0(longlong param_1)

{
longlong lVar1;
longlong lVar2;
ulonglong uVar3;
uint uVar4;

uVar3 = 0;
if (*(int *)(param_1 + 0x224) == 0) {
*(undefined4 *)(param_1 + 0x2d0) = 0;
*(undefined4 *)(param_1 + 0x224) = 0;
}
else {
do {
lVar1 = param_1 + uVar3 * 8;
lVar2 = *(longlong *)(lVar1 + 0x250);
if (lVar2 != 0) {
SslFreeObject(lVar2,0);
*(undefined8 *)(lVar1 + 0x250) = 0;
}
uVar4 = (int)uVar3 + 1;
uVar3 = (ulonglong)uVar4;
} while (uVar4 < *(uint *)(param_1 + 0x224));
*(undefined4 *)(param_1 + 0x2d0) = 0;
*(undefined4 *)(param_1 + 0x224) = 0;
}
return;
}
=========================================
Function at address: 0x180003e7c
Called functions addresses: 0x18002a7c0


void FUN_180003e7c(longlong *param_1)

{
longlong lVar1;

lVar1 = param_1[0x67];
if (lVar1 != 0) {
if (*(longlong *)(lVar1 + 8) != 0) {

lVar1 = param_1[0x67];
}

param_1[0x67] = 0;
}
return;
}
=========================================
Function at address: 0x180003ea4
Called functions addresses: 0x18002a7c0


void FUN_180003ea4(longlong *param_1)

{
longlong lVar1;

lVar1 = param_1[0x65];
if (lVar1 != 0) {
if (*(longlong *)(lVar1 + 8) != 0) {

lVar1 = param_1[0x65];
}

param_1[0x65] = 0;
}
return;
}
=========================================
Function at address: 0x180003ed0
Called functions addresses: 0x18002a7c0 0x18000404c 0x180003fb0 0x1800600f8 0xEXTERNAL:0000011c 0x18000909c


void FUN_180003ed0(longlong *param_1,undefined8 param_2,uint param_3)

{
longlong lVar1;
undefined8 uVar2;

if (param_1[0x80] != 0) {
SslFreeObject();
}
if (param_1[0x7f] != 0) {
SslFreeObject();
}
if ((HLOCAL)param_1[0x77] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x77]);
param_1[0x77] = 0;
}
if ((HLOCAL)param_1[0x79] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x79]);
param_1[0x79] = 0;
}
if ((HLOCAL)param_1[0x75] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x75]);
param_1[0x75] = 0;
}
uVar2 = 0;
*(undefined4 *)(param_1 + 0x76) = 0;
FUN_18000404c((longlong)param_1,0);
*(undefined *)(param_1 + 0x81) = 0;

if ((lVar1 != 0) && ((*(uint *)(param_1 + 0x11) >> 0x13 & 1) != 0)) {

FUN_1800600f8(lVar1,uVar2,param_3);
}
*(undefined2 *)((longlong)param_1 + 0x1fe) = 0;
*(undefined2 *)(param_1 + 0x44) = 0;
*(undefined *)((longlong)param_1 + 0x521) = 0;
FUN_180003fb0(param_1);
return;
}
=========================================
Function at address: 0x180003fb0
Called functions addresses: 0x18002a7c0 0x18000909c


void FUN_180003fb0(longlong *param_1)

{
longlong *plVar1;

if ((HLOCAL)param_1[0x70] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x70]);
param_1[0x70] = 0;
*(undefined4 *)(param_1 + 0x6f) = 0;
}
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(undefined4 *)(param_1 + 0x6d) = 0;
if (param_1[0x72] != 0) {

param_1[0x72] = 0;
*(undefined2 *)(param_1 + 0x73) = 0;
}
*(undefined2 *)((longlong)param_1 + 0x39b) = 0;
*(undefined *)(param_1 + 0x3b) = 0;
plVar1 = (longlong *)param_1[0x3a];
if (((plVar1 != (longlong *)0x0) && (*plVar1 != 0)) && (plVar1[3] != 0)) {

plVar1[3] = 0;
*(undefined4 *)(plVar1 + 2) = 0;
}
return;
}
=========================================
Function at address: 0x18000404c
Called functions addresses: 0xEXTERNAL:00000146


void FUN_18000404c(longlong param_1,undefined4 param_2)

{
*(undefined4 *)(param_1 + 0x418) = param_2;
if (*(PCCERT_CHAIN_CONTEXT *)(param_1 + 0x410) != (PCCERT_CHAIN_CONTEXT)0x0) {
CertFreeCertificateChain(*(PCCERT_CHAIN_CONTEXT *)(param_1 + 0x410));
}
*(undefined8 *)(param_1 + 0x410) = 0;
return;
}
=========================================
Function at address: 0x180004080
Called functions addresses: 0xEXTERNAL:000000b3 0x180003c24


void FUN_180004080(undefined8 *param_1)

{
*param_1 = &PTR_FUN_18007c2c0;
FUN_180003c24((longlong)param_1);
if (*(int *)((longlong)param_1 + 0x44) == 0) {
RtlDeleteResource(param_1 + 9);
}
*param_1 = &PTR_FUN_18007c298;
return;
}
=========================================
Function at address: 0x1800040c8
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0x18000a1f4 0x18005b470 0x18002a77b


undefined8 FUN_1800040c8(longlong *param_1,char *param_2,uint param_3)

{
longlong lVar1;
void *_Dst;
undefined4 uVar2;
uint uVar3;
undefined uVar4;

if ((*(uint *)(param_1 + 0x11) >> 0x11 & 1) == 0) {
uVar4 = 10;
uVar2 = 200;
}
else {
if (3 < param_3) {
if (*param_2 != '\x01') {
return 0;
}
uVar3 = (uint)(byte)param_2[2] * 0x100 + (uint)(byte)param_2[1] * 0x10000 +
(uint)(byte)param_2[3];
if (uVar3 <= param_3 - 4) {
_Dst = (void *)FUN_18000a1f4((ulonglong)uVar3);
if (_Dst != (void *)0x0) {
memcpy(_Dst,param_2 + 4,(ulonglong)uVar3);
RtlAcquireResourceExclusive(param_1[0xa5] + 0x48,1);
lVar1 = param_1[0xa5];
*(uint *)(lVar1 + 0x158) = uVar3;
*(void **)(lVar1 + 0x150) = _Dst;
RtlReleaseResource(param_1[0xa5] + 0x48);
return 0;
}
return 0xe;
}
}
uVar4 = 0x32;
uVar2 = 0xc9;
}
FUN_18005b470(param_1,uVar2,0x80090326,uVar4);
return 0x80090326;
}
=========================================
Function at address: 0x180004214
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0x18002a7c0


BADSPACEBASE * FUN_180004214(undefined8 param_1,longlong param_2)

{
uint uVar1;
longlong lVar2;
longlong lVar3;
undefined8 uVar4;

lVar2 = *(longlong *)(param_2 + 0x58);
if ((lVar2 != 0) && (lVar3 = *(longlong *)(param_2 + 0x50), lVar3 != 0)) {
RtlAcquireResourceExclusive(*(longlong *)(lVar2 + 0xe0) + 0x30,1);
RtlAcquireResourceExclusive(lVar2 + 0x48,1);
uVar1 = *(uint *)(lVar3 + 0xd0);
*(undefined *)(lVar2 + 0xec) = 1;
if (*(uint *)(lVar2 + 0x118) <= uVar1) {
uVar1 = *(uint *)(lVar2 + 0x118);
}
*(uint *)(lVar2 + 0x118) = uVar1;

RtlReleaseResource(lVar2 + 0x48);
uVar4 = RtlReleaseResource(*(longlong *)(lVar2 + 0xe0) + 0x30);
register0x00000020 = (BADSPACEBASE *)CONCAT71((int7)((ulonglong)uVar4 >> 8),1);
}
return register0x00000020;
}
=========================================
Function at address: 0x180004308
Called functions addresses: 0xEXTERNAL:000000c0 0x180028d90 0xEXTERNAL:00000168 0x18005b660 0xEXTERNAL:00000170 0x180004494 0x18005b470 0x180028070 0xEXTERNAL:00000123 0xEXTERNAL:000000c2 0xEXTERNAL:00000041


void FUN_180004308(longlong *param_1,PUCHAR param_2,ULONG param_3,undefined8 param_4,int param_5,
ULONG param_6,PUCHAR param_7,ULONG param_8)

{
DWORD DVar1;
BOOL BVar2;
undefined4 uVar3;
undefined8 *pPaddingInfo;
undefined uVar4;
ULONG cbHash;
undefined auStackY_f8 [32];
ULONG local_b8 [2];
BCRYPT_KEY_HANDLE local_b0;
undefined8 local_a8;
undefined8 local_a0;
undefined8 uStack_98;
UCHAR local_88 [64];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_f8;
local_b0 = (BCRYPT_KEY_HANDLE)0x0;
memset(local_88,0,0x40);
local_b8[0] = 0;
local_a8 = 0;
local_a0 = 0;
uStack_98 = 0;
if (param_5 == 0) {
cbHash = 0x24;
DVar1 = FUN_18005b660((longlong)param_1,param_2,param_3,local_88);
param_6 = 2;
}
else {
DVar1 = FUN_180004494(param_5,(longlong)param_1,param_2,param_3,local_88,local_b8);
cbHash = local_b8[0];
}
if (DVar1 == 0) {
RtlAcquireResourceShared(param_1[0xb] + 0x48,1);
BVar2 = CryptImportPublicKeyInfoEx2
(**(DWORD **)(param_1[0xb] + 0x30),
(PCERT_PUBLIC_KEY_INFO)
(*(longlong *)(*(DWORD **)(param_1[0xb] + 0x30) + 6) + 0x60),0x80000000,
(void *)0x0,&local_b0);
if (BVar2 == 0) {
RtlReleaseResource(param_1[0xb] + 0x48);
DVar1 = GetLastError();
uVar4 = 0x2b;
}
else {
RtlReleaseResource();
if (param_6 == 8) {
pPaddingInfo = &local_a0;
uStack_98 = CONCAT44(uStack_98._4_4_,cbHash);
local_a0 = param_4;
}
else {
if (param_6 != 2) goto LAB_180004442;
pPaddingInfo = &local_a8;
local_a8 = param_4;
}
DVar1 = BCryptVerifySignature(local_b0,pPaddingInfo,local_88,cbHash,param_7,param_8,param_6);
if (DVar1 == 0) goto LAB_180004442;
uVar4 = 0x33;
}
uVar3 = 0x452;
}
else {
uVar4 = 0x50;
uVar3 = 0x451;
}
FUN_18005b470(param_1,uVar3,DVar1,uVar4);
LAB_180004442:
if (local_b0 != (BCRYPT_KEY_HANDLE)0x0) {
BCryptDestroyKey(local_b0);
}
FUN_180028070(local_48 ^ (ulonglong)auStackY_f8);
return;
}
=========================================
Function at address: 0x180004494
Called functions addresses: 0x180004510 0x18000a230


void FUN_180004494(int param_1,longlong param_2,PUCHAR param_3,ULONG param_4,PUCHAR param_5,
ULONG *param_6)

{
NTSTATUS NVar1;
BCRYPT_HANDLE local_18 [2];

local_18[0] = (BCRYPT_HANDLE)0x0;
NVar1 = FUN_180004510(param_1,(longlong *)local_18,param_6);
if (NVar1 == 0) {
FUN_18000a230(local_18[0],param_2,param_3,param_4,param_5,*param_6);
}
return;
}
=========================================
Function at address: 0x180004510
Called functions addresses: 0xEXTERNAL:0000016d 0xEXTERNAL:0000016e


NTSTATUS FUN_180004510(int param_1,longlong *param_2,undefined4 *param_3)

{
undefined8 *puVar1;
NTSTATUS NVar2;
BCRYPT_ALG_HANDLE pvVar3;
uint uVar4;
longlong *plVar5;
uint uVar6;
bool bVar7;
undefined4 local_res10;
BCRYPT_ALG_HANDLE local_res18;
LPCWSTR local_res20;

uVar6 = 0;
uVar4 = DAT_180092324;
if (DAT_180092324 != 0) {
plVar5 = &DAT_180092330;
do {
if ((*plVar5 != 0) && (uVar4 = uVar6, *(int *)(*plVar5 + 0x14) == param_1)) break;
uVar6 = uVar6 + 1;
plVar5 = plVar5 + 1;
uVar4 = DAT_180092324;
} while (uVar6 < DAT_180092324);
}
if (((int)uVar4 < 0) || ((int)DAT_180092324 <= (int)uVar4)) {
uVar4 = 0;
LAB_180004586:
local_res18 = (BCRYPT_ALG_HANDLE)(&DAT_180092cf0)[(int)uVar4];
}
else {
local_res18 = DAT_180092a48;
if ((uVar4 != 1) && (local_res18 = DAT_180092a50, uVar4 != 2)) goto LAB_180004586;
}
local_res10 = 0;
if ((DAT_180092324 <= uVar4) ||
(puVar1 = (undefined8 *)(&DAT_180092330)[uVar4], puVar1 == (undefined8 *)0x0)) {
NVar2 = 0x490;
goto LAB_1800045ce;
}
local_res20 = (LPCWSTR)*puVar1;
local_res10 = *(undefined4 *)(puVar1 + 1);
if (local_res18 == (BCRYPT_ALG_HANDLE)0x0) {
if (local_res20 == (LPCWSTR)0x0) {
NVar2 = 0x54f;
goto LAB_1800045ce;
}
NVar2 = BCryptOpenAlgorithmProvider(&local_res18,local_res20,(LPCWSTR)0x0,0);
if (NVar2 != 0) goto LAB_1800045ce;
LOCK();
pvVar3 = (BCRYPT_ALG_HANDLE)(&DAT_180092cf0)[(int)uVar4];
bVar7 = pvVar3 == (BCRYPT_ALG_HANDLE)0x0;
if (bVar7) {
(&DAT_180092cf0)[(int)uVar4] = local_res18;
pvVar3 = (BCRYPT_ALG_HANDLE)0x0;
}
UNLOCK();
if (!bVar7) {
BCryptCloseAlgorithmProvider(local_res18,0);
local_res18 = pvVar3;
}
}
NVar2 = 0;
LAB_1800045ce:
*param_2 = (longlong)local_res18;
*param_3 = local_res10;
return NVar2;
}
=========================================
Function at address: 0x180004658
Called functions addresses: 0xEXTERNAL:000000c0 0x1800046cc 0xEXTERNAL:000000c2


ulonglong FUN_180004658(undefined8 param_1,int param_2,longlong *param_3)

{
ulonglong uVar1;
undefined4 in_register_00000014;

RtlAcquireResourceShared
(&DAT_180092428,CONCAT71((int7)(CONCAT44(in_register_00000014,param_2) >> 8),1));
if (((param_2 == 0) || (param_3 == (longlong *)0x0)) || (DAT_1800925c8 == (longlong *)0x0)) {
uVar1 = 0x57;
}
else {
uVar1 = FUN_1800046cc(DAT_1800925c8,param_2,param_3);
uVar1 = uVar1 & 0xffffffff;
}
RtlReleaseResource(&DAT_180092428);
return uVar1;
}
=========================================
Function at address: 0x1800046cc
Called functions addresses: 0x180004740 0x18002ce90


undefined8 FUN_1800046cc(longlong *param_1,int param_2,longlong *param_3)

{
longlong lVar1;
undefined8 uVar2;
uint uVar3;
ulonglong uVar4;
uint uVar5;
ulonglong uVar6;

uVar6 = 0;
if (*(uint *)(param_1 + 1) == 0) {
uVar2 = 0x490;
}
else {
while( true ) {
uVar4 = 0;
uVar5 = *(uint *)(uVar6 * 0x20 + 8 + *param_1);
if (uVar5 != 0) break;
uVar5 = (int)uVar6 + 1;
uVar6 = (ulonglong)uVar5;
if (*(uint *)(param_1 + 1) <= uVar5) {
uVar2 = FUN_180004740();
return uVar2;
}
}
while( true ) {
lVar1 = uVar4 * 0x30c + *(longlong *)(uVar6 * 0x20 + *param_1);
if (*(int *)(lVar1 + 0x304) == param_2) break;
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
if (uVar5 <= uVar3) {
uVar2 = FUN_18002ce90();
return uVar2;
}
}
*param_3 = lVar1;
uVar2 = 0;
}
return uVar2;
}
=========================================
Function at address: 0x180004740
Called functions addresses: None


undefined8 FUN_180004740(void)

{
return 0x490;
}
=========================================
Function at address: 0x180004750
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0xEXTERNAL:00000153 0x18002a7c0 0xEXTERNAL:0000014a


undefined8 FUN_180004750(longlong *param_1)

{
int iVar1;
longlong lVar2;
undefined8 uVar3;
int iVar4;
int local_res8 [2];
longlong local_res10;
undefined8 local_res18;

local_res10 = 0;
local_res18 = 0;
if ((param_1 != (longlong *)0x0) &&

RtlAcquireResourceExclusive(local_res10 + 0x48,1);
local_res8[0] = *(int *)(local_res10 + 0x168);
if ((*(int *)(local_res10 + 0x20) != 0) &&
((local_res8[0] == 0 &&
(iVar4 = I_CertProcessSslHandshake
(*(undefined8 *)(local_res10 + 0x18),*(int *)(local_res10 + 0x20),
*(undefined8 *)(local_res10 + 0x150),
*(undefined4 *)(local_res10 + 0x158),&local_res18,local_res8),
uVar3 = local_res18, lVar2 = local_res10, iVar1 = local_res8[0], iVar4 != 0)))) {
if (*(LPVOID *)(local_res10 + 0x160) != (LPVOID)0x0) {
CryptMemFree(*(LPVOID *)(local_res10 + 0x160));
}
*(int *)(lVar2 + 0x168) = iVar1;
*(undefined8 *)(lVar2 + 0x160) = uVar3;
}
RtlReleaseResource(local_res10 + 0x48);
return 0;
}
return 0x80090304;
}
=========================================
Function at address: 0x180004850
Called functions addresses: 0x180001268


undefined8 FUN_180004850(longlong *param_1)

{
uint uVar1;
uint uVar2;
undefined8 uVar3;
uint uVar4;
uint uVar5;

if (param_1 != (longlong *)0x0) {
if ((*(uint *)(param_1 + 0x11) >> 0xe & 1) != 0) {
return 0;
}
if (param_1[10] != 0) {
uVar1 = *(uint *)(param_1[10] + 0xa0);
uVar4 = (uVar1 & 0x100) << 0x14;
uVar2 = uVar4 | 0x20000000;
if ((uVar1 & 0x200) == 0) {
uVar2 = uVar4;
}
uVar4 = uVar2 | 0x40000000;
if ((uVar1 & 0x400) == 0) {
uVar4 = uVar2;
}
uVar2 = uVar4 | 4;
if ((uVar1 & 0x2000) == 0) {
uVar2 = uVar4;
}
uVar4 = uVar1 & 0x800 | 0x1000;
if ((uVar1 & 0x1000) == 0) {
uVar4 = uVar1 & 0x800;
}
uVar5 = uVar2 | 0x80000000;
if ((uVar1 & 0x4000) == 0) {
uVar5 = uVar2;
}
uVar3 = FUN_180001268(param_1,uVar5,uVar4,(undefined8 *)(ulonglong)uVar2);
return uVar3;
}
}
return 0x80090304;
}
=========================================
Function at address: 0x180004900
Called functions addresses: 0x180072378 0x1800049b0 0x18000a1f4 0x180076a84 0x1800745b4


undefined8 FUN_180004900(longlong *param_1,PUCHAR param_2,uint param_3)

{
uint *puVar1;
int iVar2;
undefined8 uVar3;
byte *pbVar4;

param_1[0x11] = param_1[0x11] | 0x8000;
puVar1 = (uint *)(param_1 + 0x78);
iVar2 = *(int *)(param_1[1] + 0x30);
if (iVar2 == 3) {
uVar3 = FUN_1800049b0(param_1,param_2,param_3,(byte *)0x0,puVar1);
}
else if (iVar2 == 2) {
uVar3 = FUN_1800745b4(param_1,param_2,param_3,(undefined *)0x0,puVar1);
}
else if (iVar2 == 4) {
uVar3 = FUN_180076a84(param_1,param_2,param_3,(undefined *)0x0,puVar1);
}
else {
uVar3 = FUN_180072378(param_1,(undefined *)0x0,puVar1);
}
if ((int)uVar3 == 0) {
pbVar4 = (byte *)FUN_18000a1f4((ulonglong)*puVar1);
param_1[0x77] = (longlong)pbVar4;
if (pbVar4 == (byte *)0x0) {
uVar3 = 0xe;
}
else {
iVar2 = *(int *)(param_1[1] + 0x30);
if (iVar2 == 3) {
uVar3 = FUN_1800049b0(param_1,param_2,param_3,pbVar4,puVar1);
}
else if (iVar2 == 2) {
uVar3 = FUN_1800745b4(param_1,param_2,param_3,pbVar4,puVar1);
}
else if (iVar2 == 4) {
uVar3 = FUN_180076a84(param_1,param_2,param_3,pbVar4,puVar1);
}
else {
uVar3 = FUN_180072378(param_1,pbVar4,puVar1);
}
}
}
return uVar3;
}
=========================================
Function at address: 0x1800049b0
Called functions addresses: 0x180028d90 0x180004f90 0x18000503c 0x180004658 0x1800079ec 0x1800051c0 0x18002a7c0 0x18002a700 0x180005298 0x180001bcc 0x18002cf90 0x180028070 0x180004308 0x180005324 0x18000909c 0xEXTERNAL:00000122 0x1800024d0 0x18000a418 0x18005b470 0x180004fc4 0x18002cfe8 0xEXTERNAL:0000011c 0x180009ed4


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_1800049b0(longlong *param_1,PUCHAR param_2,uint param_3,byte *param_4,uint *param_5)

{
byte *pbVar1;
byte bVar2;
ushort uVar3;
longlong lVar4;
longlong lVar5;
PUCHAR pUVar6;
byte *pbVar7;
ulonglong uVar8;
undefined8 uVar9;
undefined8 *puVar10;
uint *_Dst;
undefined8 *puVar11;
longlong *plVar12;
ulonglong uVar13;
uint *puVar14;
uint *puVar15;
uint uVar16;
undefined4 uVar17;
undefined *puVar18;
undefined *puVar19;
undefined *puVar20;
ULONG UVar21;
undefined uVar22;
undefined4 *puVar23;
uint uVar24;
ushort *puVar25;
ushort *puVar26;
int iVar27;
undefined auStackY_d8 [32];
uint local_98 [4];
longlong local_88;
longlong local_80;
int local_78;
ULONG local_74;
undefined4 local_70 [2];
wchar_t *local_68;
uint local_60;
uint local_5c;
undefined8 local_58;
undefined8 *local_50;
PUCHAR local_48;
byte *local_40;
ulonglong local_38;

puVar19 = auStackY_d8;
puVar18 = auStackY_d8;
local_38 = DAT_180091970 ^ (ulonglong)local_98;
_Dst = (uint *)0x0;
local_88 = 0;
local_80 = 0;
local_70[0] = 0;
local_50 = (undefined8 *)0x0;
local_58 = 0;
local_98[2] = 0;
local_74 = 0;
local_40 = param_4;
if (*(int *)(param_1[1] + 0x34) == 2) {
iVar27 = 1;
}
else {
puVar20 = auStackY_d8;
if (*(int *)(param_1[1] + 0x34) != 4) goto LAB_180004eb2;
iVar27 = 3;
}
puVar20 = auStackY_d8;
if (param_2 == (PUCHAR)0x0) goto LAB_180004eb2;
if (param_3 < 4) {
LAB_18002cf68:
uVar22 = 0x32;
uVar17 = 800;
}
else {
if (*param_2 == '\x03') {
uVar24 = (uint)CONCAT11(param_2[1],param_2[2]);
bVar2 = param_2[3];
local_5c = (uint)bVar2;
local_60 = uVar24;
if ((local_5c < 2) || (param_3 < bVar2 + 4)) goto LAB_18002cf68;
local_48 = param_2 + 4;
if (param_4 == (byte *)0x0) {
*param_5 = bVar2 + 6;
puVar20 = auStackY_d8;
goto LAB_180004eb2;
}
puVar20 = auStackY_d8;
if (*param_5 < bVar2 + 6) goto LAB_180004eb2;
uVar3 = *(ushort *)(param_1 + 0x73);
if (uVar3 == 0) {
LAB_180004ad3:
plVar12 = param_1;
FUN_180005324((longlong)param_1,uVar24);
if (*(int *)(param_1[10] + 0xc4) != 0) {
local_68 = (wchar_t *)0x0;
uVar8 = FUN_180004658(plVar12,uVar24,(longlong *)&local_68);
if ((int)uVar8 != 0) {
uVar22 = 0x50;
iVar27 = -0x7ff6fcfc;
uVar17 = 800;
goto LAB_18002cfcb;
}
uVar9 = FUN_1800079ec(*(uint **)(param_1[10] + 200),*(uint *)(param_1[10] + 0xc4),local_68
,0,'\x01');
if ((char)uVar9 != '\0') goto code_r0x00018002cf90;
}
puVar25 = (ushort *)(param_2 + (bVar2 + 4));
UVar21 = (int)puVar25 - (int)param_2;
local_68 = (wchar_t *)CONCAT44(local_68._4_4_,UVar21);
puVar26 = puVar25;
if ((*(uint *)(param_1 + 8) & 0x80800) != 0) {
puVar26 = puVar25 + 1;
if (param_2 + param_3 < puVar26) {
uVar22 = 0x32;
}
else {
puVar23 = (undefined4 *)0x0;
uVar3 = *puVar25;
uVar8 = FUN_180005298((longlong)param_1 + 0x1da,uVar3,*(uint *)(param_1 + 8),0);
if ((char)uVar8 == '\0') {
uVar22 = 0x2f;
uVar17 = 0x335;
goto LAB_18002cf73;
}
local_78 = 0;
FUN_1800051c0(uVar3,&local_78,local_98 + 2,puVar23,&local_58,(uint *)0x0,&local_74);
if (local_78 == iVar27) {
uVar24 = local_60;
UVar21 = (ULONG)local_68;
goto LAB_180004bc8;
}
uVar22 = 0x28;
}
iVar27 = -0x7ff6fcf8;
uVar17 = 0x335;
goto LAB_18002cfcb;
}
LAB_180004bc8:
puVar25 = puVar26 + 1;
if ((param_2 + param_3 < puVar25) ||
(uVar16 = (uint)CONCAT11(*(undefined *)puVar26,*(undefined *)((longlong)puVar26 + 1)),
param_2 + param_3 < (ushort *)((longlong)puVar26 + (ulonglong)uVar16 + 2)))
goto LAB_18002cf68;
if (iVar27 == 1) {
iVar27 = FUN_180004308(param_1,param_2,UVar21,local_58,local_98[2],local_74,
(PUCHAR)puVar25,uVar16);
if (iVar27 != 0) {
uVar22 = 0x33;
uVar17 = 0x322;
goto LAB_18002cfcb;
}
}
else if ((iVar27 == 3) &&
(iVar27 = FUN_180001bcc(param_1,param_2,UVar21,local_98[2],(BYTE *)puVar25,uVar16),
iVar27 != 0)) {
FUN_18002cfe8();
return;
}
puVar15 = (uint *)0x0;
uVar17 = 0;
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(puVar10 = (undefined8 *)param_1[1], puVar10 == (undefined8 *)0x0)) {
puVar10 = (undefined8 *)param_1[1];
puVar14 = puVar15;
if (puVar10 != (undefined8 *)0x0) goto LAB_180004c55;
}
else {
uVar17 = *(undefined4 *)((longlong)puVar10 + 0x1c);
LAB_180004c55:
puVar14 = (uint *)*puVar10;
}
uVar8 = FUN_18000503c(puVar14,uVar17,(uint)*(ushort *)((longlong)param_1 + 0x22),uVar24,
&local_80,local_70);
iVar27 = (int)uVar8;
if (iVar27 != 0) {
uVar22 = 0x33;
uVar17 = 0x325;
goto LAB_18002cfcb;
}
*(undefined4 *)(param_1[0xa5] + 8) = local_70[0];
puVar14 = puVar15;
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
puVar14 = *(uint **)param_1[1];
}
iVar27 = FUN_180009ed4(puVar14,local_80,L"ECCPUBLICBLOB",local_98 + 1,(longlong *)&local_50)
;
puVar10 = local_50;
if (iVar27 == 0) {
uVar8 = (ulonglong)local_98[1];
puVar18 = auStackY_d8;
_Dst = puVar15;
if ((((local_98[1] == 0) || (puVar18 = auStackY_d8, DAT_1800920e0 < uVar8)) ||
(uVar13 = DAT_1800920e8 + 8 + uVar8, puVar18 = auStackY_d8, uVar13 < uVar8)) ||
(uVar9 = FUN_18000a418(uVar13), puVar18 = auStackY_d8, (int)uVar9 == 0)) {
LAB_18002d030:
uVar16 = local_98[1] + 8;
if (uVar16 < local_98[1]) {
LAB_18002d065:
puVar19 = puVar18;
if (_Dst != (uint *)0x0) goto LAB_180004d4e;
}
else {
*(undefined8 *)(puVar18 + -8) = 0x18002d050;

if (_Dst != (uint *)0x0) {
*_Dst = 0x70616548;
_Dst = _Dst + 2;
goto LAB_18002d065;
}
}
}
else {
uVar8 = (ulonglong)(local_98[1] + 8) + 0xf;
if (uVar8 <= local_98[1] + 8) {
uVar8 = 0xffffffffffffff0;
}
lVar4 = -(uVar8 & 0xfffffffffffffff0);
_Dst = (uint *)((longlong)local_98 + lVar4);
puVar18 = auStackY_d8 + lVar4;
if (_Dst == (uint *)0x0) goto LAB_18002d030;
*_Dst = 0x6b637453;
_Dst = (uint *)((longlong)local_98 + lVar4 + 8);
puVar18 = auStackY_d8 + lVar4;
puVar19 = auStackY_d8 + lVar4;
if (_Dst == (uint *)0x0) goto LAB_18002d030;
LAB_180004d4e:
puVar18 = puVar19;
uVar8 = (ulonglong)local_98[1];
*(undefined8 *)(puVar18 + -8) = 0x180004d5b;
memset(_Dst,0,uVar8);
pUVar6 = local_48;
bVar2 = (byte)local_5c;
*(undefined8 *)_Dst = *puVar10;
uVar16 = *(uint *)((longlong)param_1 + 0x14);
*(uint *)(puVar18 + 0x20) = local_98[1];
*(undefined8 *)(puVar18 + -8) = 0x180004d7b;
uVar9 = FUN_180004fc4((ulonglong)uVar16,(char *)pUVar6,bVar2,(longlong)_Dst,
*(uint *)(puVar18 + 0x20));
if ((int)uVar9 == 0) {
puVar11 = (undefined8 *)param_1[1];
if ((puVar11[0x6a] == 0) || (*(char *)(puVar11[0x6a] + 0x18) == '\0')) {
LAB_18002d086:
if (puVar11 != (undefined8 *)0x0) {
puVar15 = (uint *)*puVar11;
}
*(undefined4 *)(puVar18 + 0x28) = 0;
*(uint *)(puVar18 + 0x20) = local_98[1];
*(undefined8 *)(puVar18 + -8) = 0x18002d0b0;
iVar27 = SslImportKey(puVar15,&local_88,L"ECCPUBLICBLOB",_Dst);
if (iVar27 != 0) {
uVar17 = 0x324;
goto LAB_18002d01c;
}
}
else {
uVar16 = *_Dst;
*_Dst = uVar24;
uVar24 = local_98[1];
puVar14 = puVar15;
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
puVar14 = *(uint **)param_1[1];
}
*(undefined4 *)(puVar18 + 0x28) = 0;
*(uint *)(puVar18 + 0x20) = uVar24;
*(undefined8 *)(puVar18 + -8) = 0x180004dd9;
iVar27 = SslImportKey(puVar14,&local_88,L"SSLECCPUBLICBLOB",_Dst);
if (iVar27 != 0) {
*_Dst = uVar16;
puVar11 = (undefined8 *)param_1[1];
goto LAB_18002d086;
}
}
pbVar7 = local_40;
uVar24 = *(uint *)((longlong)param_1 + 0x14);
local_98[0]._0_1_ = *(char *)param_5 - 1;
pbVar1 = local_40 + 1;
*(undefined8 *)(puVar18 + -8) = 0x180004e0b;
uVar9 = FUN_180004f90((ulonglong)uVar24,(longlong)puVar10,pbVar1,(byte *)local_98);
lVar5 = local_80;
lVar4 = local_88;
if ((int)uVar9 == 0) {
*pbVar7 = (byte)local_98[0];
*param_5 = (byte)local_98[0] + 1;
if ((*(uint *)(param_1 + 0x11) >> 0x1b & 1) == 0) {
*(undefined8 *)(puVar18 + -8) = 0x180004f10;
FUN_1800024d0(param_1,lVar5,lVar4,(ushort *)0x0);
}
else {
*(undefined8 *)(puVar18 + -8) = 0x180004e51;

lVar4 = local_80;
*(undefined8 *)(puVar18 + -8) = 0x180004e72;

local_88 = 0;
local_80 = 0;
}
}
}
}
}
else {
uVar17 = 0x326;
LAB_18002d01c:
*(undefined8 *)(puVar18 + -8) = 0x18002d027;
FUN_18005b470(param_1,uVar17,iVar27,0x33);
}
if (puVar10 != (undefined8 *)0x0) {
*(undefined8 *)(puVar18 + -8) = 0x180004e89;
FUN_18000909c(puVar10);
}
puVar19 = puVar18;
if ((_Dst != (uint *)0x0) && (_Dst[-2] == 0x70616548)) {
*(undefined8 *)(puVar18 + -8) = 0x18002d0e5;

}
}
else {
if (uVar3 != 0) {
puVar15 = _Dst;
while (*(ushort *)(param_1[0x72] + (longlong)puVar15 * 2) != uVar24) {
uVar16 = (int)puVar15 + 1;
puVar15 = (uint *)(ulonglong)uVar16;
if (uVar3 <= uVar16) {
FUN_18002cf90();
return;
}
}
goto LAB_180004ad3;
}
code_r0x00018002cf90:
uVar22 = 0x28;
iVar27 = -0x7ff6fcf8;
uVar17 = 0x321;
LAB_18002cfcb:
FUN_18005b470(param_1,uVar17,iVar27,uVar22);
}
lVar4 = local_80;
if (local_80 != 0) {
*(undefined8 *)(puVar19 + -8) = 0x180004f1e;
SslFreeObject(lVar4,0);
}
lVar4 = local_88;
puVar20 = puVar19;
if (local_88 != 0) {
*(undefined8 *)(puVar19 + -8) = 0x180004f2e;
SslFreeObject(lVar4,0);
}
goto LAB_180004eb2;
}
uVar22 = 0x2f;
uVar17 = 800;
}
LAB_18002cf73:
FUN_18005b470(param_1,uVar17,0x80090308,uVar22);
puVar20 = auStackY_d8;
LAB_180004eb2:
uVar8 = local_38 ^ (ulonglong)local_98;
*(undefined8 *)(puVar20 + -8) = 0x180004ebe;
FUN_180028070(uVar8);
return;
}
=========================================
Function at address: 0x180004f90
Called functions addresses: 0x180002a40 0x18002a77b


undefined8 FUN_180004f90(ulonglong param_1,longlong param_2,undefined *param_3,byte *param_4)

{
byte bVar1;
undefined8 uVar2;
byte bVar3;

if ((param_2 != 0) && (param_4 != (byte *)0x0)) {
if ((param_1 & 8) != 0) {
uVar2 = FUN_180002a40(param_2,param_3,param_4);
return uVar2;
}
if (*(uint *)(param_2 + 4) < 0x80) {
uVar2 = 0;
bVar3 = *(char *)(param_2 + 4) * '\x02' + 1;
if (param_3 == (undefined *)0x0) {
*param_4 = bVar3;
}
else {
bVar1 = *param_4;
*param_4 = bVar3;
if (bVar1 < bVar3) {
uVar2 = 0x80090321;
}
else {
*param_3 = 4;
memcpy(param_3 + 1,(void *)(param_2 + 8),(ulonglong)bVar3 - 1);
}
}
}
else {
uVar2 = 0x54f;
}
return uVar2;
}
return 0x57;
}
=========================================
Function at address: 0x180004fc4
Called functions addresses: 0x1800029e8 0x18002a77b


undefined8 FUN_180004fc4(ulonglong param_1,char *param_2,byte param_3,longlong param_4,uint param_5)

{
uint uVar1;
undefined8 uVar2;

uVar2 = 0;
if ((param_2 == (char *)0x0) || (param_4 == 0)) {
uVar2 = 0x57;
}
else {
uVar1 = (uint)param_3;
if ((param_1 & 8) != 0) {
uVar2 = FUN_1800029e8(param_2,uVar1,param_4,param_5);
return uVar2;
}
if ((*param_2 == '\x04') && (uVar1 + 7 <= param_5)) {
memcpy((void *)(param_4 + 8),param_2 + 1,(ulonglong)(uVar1 - 1));
}
else {
uVar2 = 0x80090308;
}
}
return uVar2;
}
=========================================
Function at address: 0x18000503c
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:00000117 0x180041cdc 0x180005130 0xEXTERNAL:000000c2


ulonglong FUN_18000503c(undefined8 param_1,undefined4 param_2,undefined4 param_3,int param_4,
undefined8 param_5,undefined4 *param_6)

{
uint uVar1;
ulonglong uVar2;
undefined4 in_register_00000014;
undefined4 uVar3;
undefined4 local_res20 [2];

uVar3 = 0;
local_res20[0] = 0;
RtlAcquireResourceShared
(&DAT_180092428,CONCAT71((int7)(CONCAT44(in_register_00000014,param_2) >> 8),1));
if ((param_4 == 0) || (DAT_1800925c8 == (longlong *)0x0)) {
uVar2 = 0x57;
}
else {
uVar2 = FUN_180005130(DAT_1800925c8,param_4,local_res20);
uVar2 = uVar2 & 0xffffffff;
uVar3 = local_res20[0];
}
RtlReleaseResource(&DAT_180092428);
if ((int)uVar2 == 0) {
uVar1 = SslCreateEphemeralKey(param_1,param_5,param_3,param_2,param_4,uVar3,0,0,0);
uVar2 = (ulonglong)uVar1;
if (((uVar1 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_180086380,uVar1);
}
if (param_6 != (undefined4 *)0x0) {
*param_6 = uVar3;
}
}
return uVar2;
}
=========================================
Function at address: 0x180005130
Called functions addresses: 0x18002d68a 0x1800051b3


undefined8 FUN_180005130(longlong *param_1,int param_2,undefined4 *param_3)

{
longlong lVar1;
undefined8 uVar2;
uint uVar3;
ulonglong uVar4;
uint uVar5;
ulonglong uVar6;

*param_3 = 0;
uVar6 = 0;
if (*(uint *)(param_1 + 1) == 0) {
uVar2 = 0x490;
}
else {
while( true ) {
uVar4 = 0;
uVar5 = *(uint *)(uVar6 * 0x20 + 8 + *param_1);
if (uVar5 != 0) break;
uVar5 = (int)uVar6 + 1;
uVar6 = (ulonglong)uVar5;
if (*(uint *)(param_1 + 1) <= uVar5) {
uVar2 = FUN_1800051b3();
return uVar2;
}
}
lVar1 = *(longlong *)(uVar6 * 0x20 + *param_1);
while (*(int *)(uVar4 * 0x30c + 0x304 + lVar1) != param_2) {
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
if (uVar5 <= uVar3) {
uVar2 = FUN_18002d68a();
return uVar2;
}
}
uVar2 = 0;
*param_3 = *(undefined4 *)(uVar4 * 0x30c + 0x300 + lVar1);
}
return uVar2;
}
=========================================
Function at address: 0x1800051b3
Called functions addresses: None


undefined8 FUN_1800051b3(void)

{
return 0x490;
}
=========================================
Function at address: 0x1800051c0
Called functions addresses: None


void FUN_1800051c0(ushort param_1,undefined4 *param_2,undefined4 *param_3,undefined4 *param_4,
undefined8 *param_5,uint *param_6,undefined4 *param_7)

{
undefined **ppuVar1;

if (param_2 != (undefined4 *)0x0) {
*param_2 = 0;
}
if (param_3 != (undefined4 *)0x0) {
*param_3 = 0;
}
if (param_5 != (undefined8 *)0x0) {
*param_5 = 0;
}
if (param_7 != (undefined4 *)0x0) {
*param_7 = 0;
}
if (param_6 != (uint *)0x0) {
*param_6 = 0;
}
if (param_4 != (undefined4 *)0x0) {
*param_4 = 0;
}
ppuVar1 = (undefined **)&DAT_18007c390;
while ((ushort)(param_1 >> 8 | param_1 << 8) != *(ushort *)ppuVar1) {
ppuVar1 = ppuVar1 + 9;
if (&PTR_FUN_18007c6f0 <= ppuVar1) {
return;
}
}
if (param_2 != (undefined4 *)0x0) {
*param_2 = *(undefined4 *)((longlong)ppuVar1 + 0x1c);
}
if (param_3 != (undefined4 *)0x0) {
*param_3 = *(undefined4 *)(ppuVar1 + 5);
}
if (param_5 != (undefined8 *)0x0) {
*param_5 = ppuVar1[6];
}
if (param_6 != (uint *)0x0) {
*param_6 = (uint)*(byte *)(ppuVar1 + 7);
}
if (param_7 != (undefined4 *)0x0) {
*param_7 = *(undefined4 *)((longlong)ppuVar1 + 0x3c);
}
if (param_4 == (undefined4 *)0x0) {
return;
}
*param_4 = *(undefined4 *)((longlong)ppuVar1 + 0x2c);
return;
}
=========================================
Function at address: 0x180005298
Called functions addresses: 0x1800052f0


ulonglong FUN_180005298(longlong param_1,ushort param_2,uint param_3,int param_4)

{
undefined2 *puVar1;
ulonglong uVar2;
ulonglong uVar3;

uVar3 = (ulonglong)param_3;
puVar1 = (undefined2 *)FUN_1800052f0(param_2);
if (((byte)puVar1 < 0xc) && ((*(ushort *)(param_1 + 0x22) >> ((uint)puVar1 & 0x1f) & 1) != 0)) {
uVar2 = (ulonglong)puVar1 & 0xff;
puVar1 = &DAT_18007c390;
if (((uVar3 & 0x3000) == 0) ||
(((&DAT_18007c3ac)[uVar2 * 0x12] != 3 || ((&DAT_18007c3d0)[uVar2 * 0x12] == param_4)))) {
return CONCAT71(0x18007c3,((&DAT_18007c3a8)[uVar2 * 0x12] & (uint)uVar3) != 0);
}
}
return (ulonglong)puVar1 & 0xffffffffffffff00;
}
=========================================
Function at address: 0x1800052f0
Called functions addresses: None


undefined8 FUN_1800052f0(ushort param_1)

{
undefined **ppuVar1;
char cVar2;

cVar2 = '\0';
ppuVar1 = (undefined **)&DAT_18007c390;
do {
if ((ushort)(param_1 >> 8 | param_1 << 8) == *(ushort *)ppuVar1) {
return CONCAT71((int7)((ulonglong)ppuVar1 >> 8),cVar2);
}
ppuVar1 = ppuVar1 + 9;
cVar2 = cVar2 + '\x01';
} while (ppuVar1 < &PTR_FUN_18007c6f0);
return CONCAT71((int7)((ulonglong)ppuVar1 >> 8),0xff);
}
=========================================
Function at address: 0x180005324
Called functions addresses: None


void FUN_180005324(longlong param_1,int param_2)

{
longlong lVar1;
longlong *plVar2;
uint uVar3;
ulonglong uVar4;

*(int *)(param_1 + 0x10) = param_2;
plVar2 = *(longlong **)(*(longlong *)(param_1 + 8) + 0x350);
if (plVar2 != (longlong *)0x0) {
uVar4 = 0;
if (*(uint *)(plVar2 + 1) != 0) {
do {
if (*(int *)(*plVar2 + 0x304 + uVar4 * 0x30c) == param_2) {
lVar1 = *plVar2 + uVar4 * 0x30c;
if (lVar1 == 0) {
return;
}
*(undefined4 *)(param_1 + 0x14) = *(undefined4 *)(lVar1 + 0x308);
return;
}
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
} while (uVar3 < *(uint *)(plVar2 + 1));
}
}
return;
}
=========================================
Function at address: 0x18000538c
Called functions addresses: 0x18000685c


int FUN_18000538c(longlong param_1,longlong param_2,longlong *param_3)

{
int iVar1;
longlong local_res20;

iVar1 = FUN_18000685c(param_1,'\0',param_2,(uint *)0x0,&local_res20);
if (iVar1 == 0) {
*param_3 = local_res20;
if (local_res20 == 0) {
iVar1 = 0x57;
}
}
return iVar1;
}
=========================================
Function at address: 0x1800053d0
Called functions addresses: 0xEXTERNAL:000000bc 0x18000629c 0x180006620 0x180028070 0x18000909c 0x180002a9c 0x180041cb0 0x180004214 0x180007fac 0xEXTERNAL:000000c2 0x18002a77b 0xEXTERNAL:000000c0 0x180002bf0 0x18000657c 0x18002a7c0 0x18006049c 0x18000a1f4 0x1800040c8 0x18005dabc 0x180004850 0x180006300 0x180041d70 0x18002d884 0x180005b10 0x180004900 0x180001060 0x1800607b4 0x18002da9a 0x180004750 0x1800609dc 0x180002858


void FUN_1800053d0(undefined ***param_1,undefined *param_2,uint param_3,undefined4 *param_4)

{
char cVar1;
ushort uVar2;
uint3 uVar3;
longlong lVar4;
int iVar5;
DWORD DVar6;
undefined **ppuVar7;
undefined8 uVar8;
undefined **ppuVar9;
undefined8 *puVar10;
undefined2 uVar11;
undefined4 uVar12;
uint uVar13;
undefined uVar14;
uint uVar15;
byte *_Src;
uint uVar16;
undefined auStackY_d8 [32];
undefined **local_88;
undefined4 *local_80;
undefined8 local_78;
undefined8 uStack_70;
undefined8 local_68;
undefined8 uStack_60;
ulonglong local_58;

local_58 = DAT_180091970 ^ (ulonglong)auStackY_d8;
cVar1 = *(char *)((longlong)param_1 + 0xe9);
*param_4 = 0;
uVar16 = 0x20;
local_88 = (undefined **)0x0;
uVar15 = (-(uint)(cVar1 != '\0') & 8) + 4;
uVar3 = CONCAT12(*param_2,*(undefined2 *)((longlong)param_1 + 0x44));
_Src = param_2 + uVar15;
uVar13 = param_3 - uVar15;
local_78 = 0;
uStack_70 = 0;
local_68 = 0;
uStack_60 = 0;
local_80 = param_4;
if (uVar3 < 0xc0047) {
if (uVar3 != 0xc0046) {
if (uVar3 == 0x20028) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xe,&DAT_180085810);
}
iVar5 = FUN_180005b10(param_1,_Src,uVar13,(undefined4 *)&local_88);
if (iVar5 != 0) goto LAB_180005686;
if ((int)local_88 == 0) {
uVar12 = 0x46;
}
else {
if (((ulonglong)param_1[0x11] >> 0x18 & 1) == 0) {
if (((ulonglong)param_1[0x11] >> 0x1b & 1) == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180085810);
}
uVar14 = 0x28;
uVar12 = 0x6a;
goto LAB_18002d8a1;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x10,&DAT_180085810);
}
ppuVar7 = param_1[0xf];
if ((ppuVar7 != (undefined **)0x0) && (DAT_1800927ac != '\0')) {
*(ushort *)(ppuVar7 + 8) = *(ushort *)(ppuVar7 + 8) | 4;
*(undefined4 *)(ppuVar7 + 3) = 1;
}
RtlAcquireResourceShared(param_1[0xa5] + 9,1);
iVar5 = FUN_180001060((longlong *)param_1,param_1[0xa5][2]);
RtlReleaseResource(param_1[0xa5] + 9);
if (iVar5 != 0) goto LAB_180005686;
}
uVar12 = 0x2f;
}
*(undefined4 *)((longlong)param_1 + 0x44) = uVar12;
*(undefined *)((longlong)param_1 + 0x523) = 0;
goto LAB_180005686;
}
if (uVar3 == 0x30028) {
uVar8 = FUN_1800609dc((longlong *)param_1,(char *)_Src,uVar13);
if ((int)uVar8 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x61;
}
goto LAB_180005686;
}
if (uVar3 != 0xb0046) {
if (uVar3 == 0x4002e) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180085810);
}
uVar8 = FUN_180002a9c((longlong *)param_1,(longlong)_Src,uVar13);
if ((int)uVar8 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x32;
}
goto LAB_180005686;
}
if (uVar3 != 0xb002f) {
if (uVar3 == 0x4002f) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1e,&DAT_180085810);
}
uVar8 = FUN_180002a9c((longlong *)param_1,(longlong)_Src,uVar13);
if ((int)uVar8 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x34;
}
goto LAB_180005686;
}
if ((uVar3 < 0xc0029) || (0xc002a < uVar3)) goto LAB_18002db57;
goto LAB_1800054c0;
}
ppuVar7 = param_1[0x11];
if (((ulonglong)ppuVar7 >> 0x18 & 1) == 0) goto LAB_1800057ff;
puVar10 = DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar10 = (undefined8 *)DAT_180091000[2];
FUN_180041d70(puVar10,0x11,&DAT_180085810,(wchar_t *)param_1[0xa5][0x2e]);
ppuVar7 = param_1[0x11];
}
param_1[0x11] = (undefined **)((ulonglong)ppuVar7 & 0xfffffffffeffffff);
FUN_18000629c(puVar10,param_1[0xa5][0x2e],(uint *)0x0);
RtlAcquireResourceExclusive(param_1[0xa5] + 9,1);
lVar4 = DAT_1800927f0;
*(undefined *)((longlong)param_1[0xa5] + 0xec) = 0;
iVar5 = FUN_180002858((longlong)param_1[0xa5],lVar4,(longlong *)&local_88);
ppuVar9 = param_1[0xa5] + 9;
RtlReleaseResource();
ppuVar7 = local_88;
if (iVar5 != 0) {
FUN_180006300(ppuVar9,param_1[0xa5][0x2e],(uint *)0x0);
goto LAB_180005686;
}
RtlAcquireResourceExclusive(local_88 + 9,1);
param_1[0xa5] = ppuVar7;
param_1[0xb] = ppuVar7;
*(undefined4 *)(ppuVar7 + 0x15) = *(undefined4 *)(param_1 + 8);
uVar2 = *(ushort *)((longlong)param_1 + 0x3d4);
if (uVar2 < 0x21) {
uVar16 = (uint)uVar2;
memcpy(&local_78,(void *)((longlong)param_1 + 0x3d6),(ulonglong)uVar16);
if (uVar2 != 0) goto LAB_1800057a9;
}
else {
LAB_1800057a9:
ppuVar7 = param_1[0xa5];
*(short *)((longlong)ppuVar7 + 0xee) = (short)uVar16;
memcpy(ppuVar7 + 0x1e,&local_78,(ulonglong)uVar16);
}
ppuVar7 = param_1[0xa5] + 9;
RtlReleaseResource();
FUN_180006300(ppuVar7,param_1[0xa5][0x2e],(uint *)0x0);
}
LAB_1800057ff:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x12,&DAT_180085810);
}
if (*(int *)(param_1[1] + 6) != 4) {
iVar5 = FUN_180007fac((longlong *)param_1,_Src,uVar13);
if (iVar5 == 0) {
if ((*(uint *)(param_1 + 0x11) >> 0x1d & 1) != 0) {
RtlAcquireResourceExclusive(param_1[0xa5] + 9,1);
DVar6 = FUN_18005dabc((longlong)param_1[0xa5]);
RtlReleaseResource(param_1[0xa5] + 9);
if (DVar6 != 0) goto LAB_180005686;
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x29;
}
goto LAB_180005686;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180085810);
}
uVar14 = 10;
uVar12 = 0xfa;
LAB_18002d8a1:
FUN_18005b470((longlong *)param_1,uVar12,0x80090326,uVar14);
goto LAB_180005686;
}
LAB_1800054c0:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180085810);
}
iVar5 = *(int *)(param_1[1] + 6);
if (iVar5 != 4) {
if (*(short *)((longlong)param_1 + 0x44) == 0x46) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar11 = 0x17;
goto LAB_18002db75;
}
goto LAB_18002db85;
}
if ((1 < iVar5 - 2U) && (*(char *)(param_1[1] + 9) == '\0')) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x18,&DAT_180085810);
}
uVar14 = 10;
uVar12 = 0x338;
goto LAB_18002d8a1;
}
}
*(uint *)(param_1 + 0x7a) = uVar13;
ppuVar7 = (undefined **)FUN_18000a1f4((ulonglong)uVar13);
param_1[0x79] = ppuVar7;
if (ppuVar7 != (undefined **)0x0) {
memcpy(ppuVar7,_Src,(ulonglong)*(uint *)(param_1 + 0x7a));
*(undefined4 *)((longlong)param_1 + 0x44) = 0x2b;
}
}
else {
if (0xd0028 < uVar3) {
if (uVar3 < 0xd002c) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x19,&DAT_180085810);
}
if (*(int *)(param_1[1] + 6) != 4) {
iVar5 = FUN_1800607b4((longlong *)param_1,_Src,uVar13);
if (iVar5 == 0) {
uVar16 = FUN_18006049c((longlong *)param_1);
if (uVar16 == 0x80090320) {
*(undefined *)((longlong)param_1 + 0x521) = 1;
}
else if ((uVar16 != 0x90320) && (uVar16 != 0)) goto LAB_180005686;
*(undefined *)((longlong)param_1 + 0x523) = 1;
*(undefined4 *)((longlong)param_1 + 0x44) = 0x2c;
}
goto LAB_180005686;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_18002d884((longlong)DAT_180091000);
return;
}
uVar14 = 10;
uVar12 = 400;
goto LAB_18002d8a1;
}
if (0xe0028 < uVar3) {
if (0xe002c < uVar3) {
if (uVar3 == 0x14002d) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x20,&DAT_180085810);
}
iVar5 = FUN_180006620((longlong *)param_1,_Src,uVar13);
ppuVar7 = param_1[0xa5] + 9;
if (iVar5 == 0) {
RtlAcquireResourceExclusive();
FUN_18000657c((longlong *)param_1,0);
RtlReleaseResource(param_1[0xa5] + 9);
*local_80 = 1;

if ((*(uint *)(param_1 + 0x11) >> 0x1b & 1) != 0) {
FUN_180004214(DAT_1800927f0,(longlong)param_1);
}
goto LAB_180005686;
}
}
else {
if (uVar3 != 0x140030) {
if (uVar3 != 0xe0046) {
if (uVar3 == 0x160029) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180085810);
}
if (*(int *)(param_1[1] + 6) != 4) {
uVar8 = FUN_1800040c8((longlong *)param_1,(char *)_Src,uVar13);
if ((int)uVar8 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x2a;
}
goto LAB_180005686;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180085810);
}
uVar14 = 10;
uVar12 = 200;
goto LAB_18002d8a1;
}
goto LAB_18002db57;
}
goto LAB_18000585e;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180085810);
}
iVar5 = FUN_180006620((longlong *)param_1,_Src,uVar13);
ppuVar7 = param_1[0xa5] + 9;
if (iVar5 == 0) {
RtlAcquireResourceExclusive(ppuVar7);
FUN_18000657c((longlong *)param_1,1);
RtlReleaseResource(param_1[0xa5] + 9);
*(undefined4 *)((longlong)param_1 + 0x44) = 0x5c;
goto LAB_180005686;
}
}
RtlAcquireResourceExclusive(ppuVar7);
FUN_180002bf0((longlong)param_1[0xa5],0,0,0,0,0,0,0,0);
RtlReleaseResource(param_1[0xa5] + 9);
goto LAB_180005686;
}
LAB_18000585e:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1b,&DAT_180085810);
}
if (uVar15 < param_3) goto LAB_180005686;
if (*(int *)(param_1[1] + 6) != 4) {
if (*(short *)((longlong)param_1 + 0x44) == 0x46) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar11 = 0x1c;
goto LAB_18002db75;
}
goto LAB_18002db85;
}
FUN_180004750((longlong *)param_1);
uVar8 = FUN_180004850((longlong *)param_1);
if ((int)uVar8 != 0) goto LAB_180005686;
}
uVar8 = FUN_180004900((longlong *)param_1,(PUCHAR)param_1[0x79],*(uint *)(param_1 + 0x7a));
if ((int)uVar8 == 0) {
if (param_1[0x79] != (undefined **)0x0) {
FUN_18000909c(param_1[0x79]);
param_1[0x79] = (undefined **)0x0;
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x5b;
*(undefined *)((longlong)param_1 + 0x39c) = 0;
if (*(char *)((longlong)param_1 + 0x522) != '\0') {
FUN_18006049c((longlong *)param_1);
*(undefined *)((longlong)param_1 + 0x522) = 0;
}
if (*(char *)((longlong)param_1 + 0x521) != '\0') {
FUN_18002da9a();
return;
}
}
goto LAB_180005686;
}
}
LAB_18002db57:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar11 = 0x21;
LAB_18002db75:
FUN_180041cb0(DAT_180091000[2],uVar11,&DAT_180085810);
}
LAB_18002db85:
if ((*(uint *)(param_1 + 8) & 0xf3fc0) != 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x60;
*(undefined2 *)(param_1 + 0xc) = 0xa02;
}
}
LAB_180005686:
FUN_180028070(local_58 ^ (ulonglong)auStackY_d8);
return;
}
=========================================
Function at address: 0x180005b10
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0x180006430 0x18002a7c0 0x18000d31c 0x18000629c 0x18002dd40 0x180028070 0x180008da0 0x180006300 0x18002a76f 0x1800087d0 0x180061134 0x180041cb0 0x18005b470 0x180005fc4 0x18002a77b 0x180002858


void FUN_180005b10(undefined ***param_1,undefined *param_2,uint param_3,undefined4 *param_4)

{
byte bVar1;
longlong lVar2;
uint uVar3;
uint uVar4;
int iVar5;
undefined8 uVar6;
undefined8 uVar7;
undefined ***pppuVar8;
undefined **ppuVar9;
undefined **ppuVar10;
undefined2 uVar11;
undefined *_Buf2;
undefined *puVar12;
uint uVar13;
undefined4 uVar14;
uint uVar15;
undefined uVar16;
uint uVar17;
uint uVar18;
ulonglong _Size;
undefined auStack_d8 [48];
undefined4 local_a8;
uint local_a4;
undefined **local_a0;
undefined4 *local_98;
undefined **local_88;
undefined ***local_80;
undefined8 local_78;
undefined4 local_70;
undefined local_68;
undefined8 local_60;
undefined4 local_58;
undefined local_54;
undefined ***local_50;
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStack_d8;
uVar7 = 0;
local_a8 = 0;
local_a0 = (undefined **)0x0;
uVar4 = 0x20;
*(undefined *)((longlong)param_1 + 0x22a) = 0;
local_98 = param_4;
if (param_3 < 0x23) {
LAB_18002dd88:
uVar14 = 100;
LAB_18002dd8d:
uVar16 = 0x32;
LAB_18002dd90:
iVar5 = -0x7ff6fcda;
}
else {
uVar17 = 2;
uVar15 = (uint)CONCAT11(*param_2,param_2[1]);
ppuVar9 = *(undefined ***)(param_2 + 10);
param_1[0x26] = *(undefined ***)(param_2 + 2);
param_1[0x27] = ppuVar9;
ppuVar9 = *(undefined ***)(param_2 + 0x1a);
param_1[0x28] = *(undefined ***)(param_2 + 0x12);
param_1[0x29] = ppuVar9;
bVar1 = param_2[0x22];
_Size = (ulonglong)bVar1;
_Buf2 = param_2 + 0x23;
if (0x20 < bVar1) {
uVar14 = 0x67;
goto LAB_18002dd8d;
}
if (param_3 - 0x23 < bVar1 + 3) goto LAB_18002dd88;
puVar12 = _Buf2 + _Size;
local_a4 = (uint)CONCAT11(*puVar12,puVar12[1]);
if (puVar12[2] != '\0') {
uVar16 = 0x1e;
uVar14 = 0x68;
goto LAB_18002dd90;
}
ppuVar9 = param_1[10];
uVar18 = (uint)bVar1;
uVar13 = (param_3 - 0x23) + (-3 - uVar18);
if (ppuVar9 == (undefined **)0x0) goto LAB_180005e38;
uVar6 = FUN_180005fc4(uVar15);
uVar3 = (uint)uVar6 & *(uint *)(ppuVar9 + 0x13) & 0xa2aa0;
if (uVar3 == 0) {
FUN_18005b470((longlong *)param_1,0x69,0x80090331,0x46);
goto LAB_180005e38;
}
pppuVar8 = (undefined ***)(ulonglong)uVar3;
*(uint *)(param_1 + 8) = uVar3;
uVar6 = FUN_18000d31c(uVar3);
*(short *)((longlong)param_1 + 0x22) = (short)uVar6;
uVar3 = *(uint *)((longlong)param_1 + 0x24);
if (*(char *)((longlong)param_1 + 0xe9) == (char)uVar7) {
if ((uVar15 < uVar3) && (0x302 < uVar3)) {
LAB_18002dc0a:
pppuVar8 = param_1;
uVar6 = FUN_180061134((longlong *)param_1);
uVar7 = 0;
if ((char)uVar6 != '\0') goto LAB_180005e38;
uVar17 = 2;
}
}
else if ((uVar3 < 0xfefe) && (uVar3 < uVar15)) goto LAB_18002dc0a;
uVar16 = (undefined)uVar7;
if (uVar17 < uVar13) {
local_78 = 0;
local_70 = 0;
local_88 = &PTR_FUN_18007d048;
local_58 = (undefined4)uVar7;
local_54 = *(undefined *)((longlong)param_1 + 0x39a);
local_80 = param_1;
local_68 = uVar16;
local_60 = uVar7;
local_50 = param_1;
if (uVar13 - 2 < (uint)CONCAT11(puVar12[3],puVar12[4])) {
*(undefined *)((longlong)param_1 + 0x39a) = uVar16;
}
else {
uVar7 = FUN_180006430((longlong *)&local_88,puVar12 + 5,
(uint)CONCAT11(puVar12[3],puVar12[4]),uVar17);
iVar5 = (int)uVar7;
if (iVar5 != 0) {
if (iVar5 != -0x7ff6fcba) {
FUN_18005b470((longlong *)param_1,0x6a,iVar5,10);
}
FUN_180008da0(&local_88);
goto LAB_180005e38;
}
}
pppuVar8 = &local_88;
FUN_180008da0(pppuVar8);
uVar7 = 0;
}
else {
*(undefined *)((longlong)param_1 + 0x39a) = uVar16;
}
if (*(char *)((longlong)param_1 + 0x22a) == (char)uVar7) {
if (*(char *)((longlong)param_1 + 0x229) == (char)uVar7) {
if (DAT_1800919a8 != (int)uVar7) goto LAB_180005cb5;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar11 = 0x34;
goto LAB_18002dcc7;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar11 = 0x33;
LAB_18002dcc7:
FUN_180041cb0(DAT_180091000[2],uVar11,&DAT_180085810);
}
FUN_18005b470((longlong *)param_1,0x4b7,0x80090346,0x28);
*(undefined4 *)((longlong)param_1 + 0x44) = 0x60;
*(undefined2 *)(param_1 + 0xc) = 0x2802;
goto LAB_180005e38;
}
LAB_180005cb5:
FUN_18000629c(pppuVar8,param_1[0xa5][0x2e],(uint *)0x0);
RtlAcquireResourceExclusive(param_1[0xa5] + 9,1);
ppuVar9 = param_1[0xa5];
if (*(ushort *)((longlong)ppuVar9 + 0xee) < 0x21) {
uVar4 = (uint)*(ushort *)((longlong)ppuVar9 + 0xee);
memcpy(&local_88,ppuVar9 + 0x1e,(ulonglong)uVar4);
}
puVar12 = ppuVar9[2];
if (puVar12 == (undefined *)0x0) {
LAB_180005d20:
*(undefined4 *)(ppuVar9 + 0x15) = *(undefined4 *)(param_1 + 8);
uVar14 = local_a8;
if (bVar1 != 0) {
ppuVar9 = param_1[0xa5];
*(ushort *)((longlong)ppuVar9 + 0xee) = (ushort)bVar1;
if (_Buf2 != (undefined *)0x0) {
memcpy(ppuVar9 + 0x1e,_Buf2,_Size);
uVar14 = local_a8;
}
}
}
else if (((uVar4 == 0) || (uVar4 != uVar18)) ||
(iVar5 = memcmp(&local_88,_Buf2,_Size), iVar5 != 0)) {
lVar2 = DAT_1800927f0;
ppuVar10 = param_1[0x11];
if (((ulonglong)ppuVar10 & 0xc00000) == 0) {
if (puVar12 != (undefined *)0x0) {
*(undefined *)((longlong)ppuVar9 + 0xec) = 0;
iVar5 = FUN_180002858((longlong)param_1[0xa5],lVar2,(longlong *)&local_a0);
ppuVar10 = param_1[0xa5] + 9;
RtlReleaseResource();
ppuVar9 = local_a0;
if (iVar5 != 0) {
FUN_180006300(ppuVar10,param_1[0xa5][0x2e],(uint *)0x0);
goto LAB_180005e38;
}
RtlAcquireResourceExclusive(local_a0 + 9,1);
param_1[0xa5] = ppuVar9;
param_1[0xb] = ppuVar9;
}
goto LAB_180005d20;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x36,&DAT_180085810);
ppuVar10 = param_1[0x11];
}
param_1[0x11] = (undefined **)((ulonglong)ppuVar10 | 0x1000000);
if ((uVar18 != 0) &&
(*(ushort *)((longlong)param_1 + 0x3d4) = (ushort)bVar1, _Buf2 != (undefined *)0x0)) {
memcpy((void *)((longlong)param_1 + 0x3d6),_Buf2,_Size);
}
uVar14 = 1;
if (param_1[0xf] != (undefined **)0x0) {
FUN_18002dd40();
return;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x35,&DAT_180085810);
}
ppuVar9 = param_1[0xf];
uVar14 = 1;
if ((ppuVar9 != (undefined **)0x0) && (DAT_1800927ac != '\0')) {
*(ushort *)(ppuVar9 + 8) = *(ushort *)(ppuVar9 + 8) | 1;
*(undefined4 *)(ppuVar9 + 3) = 1;
}
}
ppuVar9 = param_1[0xa5] + 9;
RtlReleaseResource();
FUN_180006300(ppuVar9,param_1[0xa5][0x2e],(uint *)0x0);
iVar5 = FUN_1800087d0(ppuVar9,(longlong *)param_1,local_a4);
if (iVar5 == 0) {

(param_1,(*(uint *)(param_1 + 8) & 0x80800) != 0);
if (iVar5 == 0) {
*(undefined *)((longlong)param_1 + 0x154) = 0;

(param_1,param_1[0x6e],*(undefined4 *)(param_1 + 0x6d),1);
if (param_1[0x6e] != (undefined **)0x0) {

param_1[0x6e] = (undefined **)0x0;
}
*(undefined4 *)(param_1 + 0x6d) = 0;
*local_98 = uVar14;
}
goto LAB_180005e38;
}
uVar16 = 0x28;
uVar14 = 0x6b;
}
FUN_18005b470((longlong *)param_1,uVar14,iVar5,uVar16);
LAB_180005e38:
FUN_180028070(local_48 ^ (ulonglong)auStack_d8);
return;
}
=========================================
Function at address: 0x180005fc4
Called functions addresses: None


undefined8 FUN_180005fc4(int param_1)

{
if (param_1 == 2) {
return 0xc;
}
if (param_1 == 0x300) {
return 0x30;
}
if (param_1 == 0x301) {
return 0xc0;
}
if (param_1 == 0x302) {
return 0x300;
}
if (param_1 == 0x303) {
return 0xc00;
}
if (param_1 == 0x304) {
return 0x3000;
}
if (param_1 == 0xfefd) {
return 0xc0000;
}
if (param_1 == 0xfeff) {
return 0x30000;
}
return 0;
}
=========================================
Function at address: 0x180006034
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0x180014550 0xEXTERNAL:0000018b 0x180016cd0 0x18002a7c0 0x1800032c4 0xEXTERNAL:00000088 0x1800069c4 0x180041e9c


bool FUN_180006034(longlong *param_1,ulonglong param_2,undefined8 param_3,longlong param_4,
undefined8 *param_5)

{
longlong *plVar1;
code *pcVar2;
longlong lVar3;
char cVar4;
undefined uVar5;
int iVar6;
undefined8 uVar7;
ulonglong uVar8;
longlong *plVar9;
longlong *plVar10;
longlong *plVar11;
longlong lVar12;
longlong *plVar13;
longlong local_res8;
DWORD local_res10;
undefined8 local_res18;
longlong local_res20;
longlong local_58;
longlong *local_50;

plVar11 = (longlong *)0x0;
iVar6 = 0;
local_res18 = param_3;
local_res20 = param_4;
local_res10 = GetTickCount();
local_58 = *(longlong *)(param_4 + 0x2e4);
local_50 = param_1 + 6;
RtlAcquireResourceExclusive(local_50,1);
lVar12 = (param_2 & 0xffffffff) * 0x10;
plVar9 = (longlong *)(*param_1 + lVar12);
plVar13 = (longlong *)*plVar9;
if (plVar13 != plVar9) {
do {
plVar9 = plVar13 + -0x24;
plVar1 = (longlong *)*plVar13;
RtlAcquireResourceExclusive(plVar13 + -0x1b,1);
if (*(char *)((longlong)plVar13 + -0x34) != '\0') {
uVar7 = FUN_1800032c4((ulonglong)*(uint *)((longlong)plVar13 + -0xc),(ulonglong)local_res10,
*(uint *)(plVar13 + -1));
lVar3 = local_res20;
if ((char)uVar7 == '\0') {
local_res8 = *(longlong *)(local_res20 + 0x2f8);

(plVar9,&local_58,local_res18,&local_res8,
*(undefined4 *)(local_res20 + 0x98));
if ((cVar4 != '\0') &&
(plVar10 = plVar9, uVar8 = FUN_180016cd0((longlong)plVar9,lVar3), (char)uVar8 != '\0'))
{
if (plVar11 == (longlong *)0x0) {
iVar6 = FUN_1800069c4(plVar10,(longlong)plVar9);
plVar11 = plVar9;
}
else if (*(uint *)((longlong)plVar11 + 0x114) < *(uint *)((longlong)plVar13 + -0xc)) {
iVar6 = FUN_1800069c4(plVar10,(longlong)plVar9);
RtlAcquireResourceExclusive(plVar11 + 9,1);
*(undefined *)((longlong)plVar11 + 0xec) = 0;
FUN_180014550((longlong)param_1,(longlong)plVar11,'\0','\0');
RtlReleaseResource(plVar11 + 9);
plVar11 = plVar9;
}
else {
*(undefined *)((longlong)plVar13 + -0x34) = 0;
}
}
}
}
RtlReleaseResource(plVar13 + -0x1b);
plVar13 = plVar1;
} while (plVar1 != (longlong *)(*param_1 + lVar12));
if (plVar11 != (longlong *)0x0) {
*param_5 = plVar11;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0xb,&DAT_180082b48,plVar11);
}
if (iVar6 == 2) {
plVar13 = plVar11 + 0x28;
lVar12 = *plVar13;
if ((*(longlong **)(lVar12 + 8) != plVar13) ||
(plVar9 = (longlong *)plVar11[0x29], (longlong *)*plVar9 != plVar13)) {
pcVar2 = (code *)swi(0x29);
(*pcVar2)(3);
pcVar2 = (code *)swi(3);
uVar5 = (*pcVar2)();
return (bool)uVar5;
}
*plVar9 = lVar12;
*(longlong **)(lVar12 + 8) = plVar9;
}
LsaIModifyPerformanceCounter(7,0,0);
}
}
RtlReleaseResource(local_50);
return plVar11 != (longlong *)0x0;
}
=========================================
Function at address: 0x18000629c
Called functions addresses: 0xEXTERNAL:000000bc 0x180006358


undefined8 FUN_18000629c(undefined8 param_1,byte *param_2,uint *param_3)

{
ulonglong uVar1;
ulonglong uVar2;
longlong lVar3;

lVar3 = DAT_1800927f0;
uVar2 = 0;
if (DAT_1800927f0 != 0) {
if (param_2 == (byte *)0x0) {
if (param_3 != (uint *)0x0) {
uVar2 = (ulonglong)*param_3 % (ulonglong)*(uint *)(DAT_1800927f0 + 0x10);
}
}
else {
uVar2 = FUN_180006358(DAT_1800927f0,param_2);
}
uVar1 = (ulonglong)*(uint *)(lVar3 + 0x34);
lVar3 = ((uVar2 & 0xffffffff) / uVar1) * 0x98 + *(longlong *)(lVar3 + 0x28);
if (lVar3 != 0) {
RtlAcquireResourceExclusive
(lVar3 + 0x30,CONCAT71((int7)((uVar2 & 0xffffffff) % uVar1 >> 8),1));
return 1;
}
}
return 0;
}
=========================================
Function at address: 0x180006300
Called functions addresses: 0xEXTERNAL:000000c0 0x180006358


void FUN_180006300(undefined8 param_1,byte *param_2,uint *param_3)

{
ulonglong uVar1;
ulonglong uVar2;
longlong lVar3;

lVar3 = DAT_1800927f0;
uVar2 = 0;
if (DAT_1800927f0 != 0) {
if (param_2 == (byte *)0x0) {
if (param_3 != (uint *)0x0) {
uVar2 = (ulonglong)*param_3 % (ulonglong)*(uint *)(DAT_1800927f0 + 0x10);
}
}
else {
uVar2 = FUN_180006358(DAT_1800927f0,param_2);
}
uVar1 = (ulonglong)*(uint *)(lVar3 + 0x34);
lVar3 = ((uVar2 & 0xffffffff) / uVar1) * 0x98 + *(longlong *)(lVar3 + 0x28);
if (lVar3 != 0) {
RtlReleaseResource(lVar3 + 0x30,(uVar2 & 0xffffffff) % uVar1);
}
}
return;
}
=========================================
Function at address: 0x180006358
Called functions addresses: 0x18002de02


ulonglong FUN_180006358(longlong param_1,byte *param_2)

{
byte *pbVar1;
uint uVar2;
longlong lVar3;
ulonglong uVar4;
ulonglong uVar5;
ulonglong uVar6;
ulonglong uVar7;

uVar4 = 0;
if (param_2 != (byte *)0x0) {
lVar3 = -1;
do {
lVar3 = lVar3 + 1;
} while (*(short *)(param_2 + lVar3 * 2) != 0);
uVar2 = (int)lVar3 * 2;
uVar6 = (ulonglong)uVar2;
uVar5 = 0x4cb2f;
lVar3 = param_1;
if (7 < uVar6) {
uVar7 = (ulonglong)(uVar2 >> 3);
uVar6 = uVar6 + uVar7 * -8;
do {
uVar4 = (((((uVar5 * 0x25 + (ulonglong)*param_2) * 0x25 + (ulonglong)param_2[1]) * 0x25 +
(ulonglong)param_2[2]) * 0x25 + (ulonglong)param_2[3]) * 0x25 +
(ulonglong)param_2[4]) * 0x25 + (ulonglong)param_2[5];
lVar3 = uVar4 * 0x25 + (ulonglong)param_2[6];
pbVar1 = param_2 + 7;
param_2 = param_2 + 8;
uVar5 = lVar3 * 0x25 + (ulonglong)*pbVar1;
uVar7 = uVar7 - 1;
} while (uVar7 != 0);
}
if ((0 < (longlong)uVar6) && ((longlong)uVar6 < 8)) {
uVar4 = FUN_18002de02(lVar3,uVar4,(uint)uVar5,param_2);
return uVar4;
}
uVar4 = (uVar5 & 0xffffffff) % (ulonglong)*(uint *)(param_1 + 0x10);
}
return uVar4;
}
=========================================
Function at address: 0x180006430
Called functions addresses: 0x180041cdc 0x18002a7c0 0x180041cb0


undefined8 FUN_180006430(longlong *param_1,undefined *param_2,uint param_3,undefined4 param_4)

{
byte bVar1;
undefined8 uVar2;
undefined8 *puVar3;
undefined uVar4;
undefined *puVar5;
uint uVar6;
ushort uVar7;

uVar4 = 0;
bVar1 = *(byte *)(param_1[1] + 0x40);
*(undefined4 *)(param_1 + 2) = param_4;
*(undefined *)(param_1[1] + 0x39a) = 0;
*(undefined *)((longlong)param_1 + 0x1b) = 0;
puVar3 = DAT_180091000;
if (param_3 != 0) {
do {
if (param_3 < 4) {
return 0x80090326;
}
uVar7 = CONCAT11(param_2[2],param_2[3]);
uVar6 = (uint)CONCAT11(*param_2,param_2[1]);
if (((undefined8 **)puVar3 != &DAT_180091000) &&
((*(byte *)((longlong)puVar3 + 0x1c) & 4) != 0)) {
FUN_180041cdc(puVar3[2],0x49,&DAT_180082c68,uVar6);
puVar3 = DAT_180091000;
}
puVar5 = param_2 + 4;
if (param_3 - 4 < (uint)uVar7) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 2) == 0) {
return 0x80090326;
}
FUN_180041cb0(puVar3[2],0x4a,&DAT_180082c68);
return 0x80090326;
}
param_2 = puVar5 + uVar7;
param_3 = (param_3 - 4) - (uint)uVar7;
if (((bVar1 & 0x30) == 0) || (uVar6 == 0xff01)) {

if ((int)uVar2 != 0) {
return uVar2;
}
puVar3 = DAT_180091000;
if (uVar6 == 0xff01) {
uVar4 = 1;
}
}
} while (param_3 != 0);
}

return 0;
}
=========================================
Function at address: 0x18000657c
Called functions addresses: 0x18002a7c0 0xEXTERNAL:00000154


undefined8 FUN_18000657c(longlong *param_1,undefined4 param_2)

{
longlong local_res8;

local_res8 = 0;

if (*(int *)(local_res8 + 0x168) != 0) {
I_CertFinishSslHandshake
(*(undefined8 *)(local_res8 + 0x160),*(int *)(local_res8 + 0x168),
CONCAT31(CONCAT21(CONCAT11(*(undefined *)(param_1 + 0x26),
*(undefined *)((longlong)param_1 + 0x131)),
*(undefined *)((longlong)param_1 + 0x132)),
*(undefined *)((longlong)param_1 + 0x133)),param_2);
}
return 0;
}
=========================================
Function at address: 0x180006620
Called functions addresses: 0xEXTERNAL:000000c0 0x180041cb0 0x18005b470 0x180028070 0xEXTERNAL:00000115 0x18006fe4c 0xEXTERNAL:000000c2 0x18002a77b 0x18002a76f 0x180006808


void FUN_180006620(longlong *param_1,void *param_2,uint param_3)

{
undefined8 *puVar1;
int iVar2;
ulonglong _Size;
uint uVar3;
undefined8 uVar4;
uint uVar5;
undefined auStack_98 [32];
uint local_78;
int local_70;
undefined local_68 [40];
ulonglong local_40;

local_40 = DAT_180091970 ^ (ulonglong)auStack_98;
uVar3 = 0x24;
if ((*(uint *)(param_1 + 8) & 0xf3fc0) != 0) {
uVar3 = 0xc;
}
if (param_3 == uVar3) {
uVar5 = *(uint *)(param_1 + 8) & 0xa2aa0;
uVar4 = 0;
RtlAcquireResourceShared(param_1[0xb] + 0x48,1);
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
uVar4 = *(undefined8 *)param_1[1];
}
local_78 = uVar3;
local_70 = (uVar5 != 0) + 1;
iVar2 = SslComputeFinishedHash
(uVar4,*(undefined8 *)(param_1[0xb] + 0x10),param_1[0x4a],local_68);
RtlReleaseResource(param_1[0xb] + 0x48);
if (iVar2 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3d,&DAT_180082c58);
}
puVar1 = DAT_180091000;
_Size = (ulonglong)uVar3;
iVar2 = memcmp(local_68,param_2,(ulonglong)uVar3);
if (iVar2 == 0) {
if (uVar5 == 0) {
if (((undefined8 **)puVar1 != &DAT_180091000) &&
((*(uint *)((longlong)puVar1 + 0x1c) & 0x800) != 0)) {
FUN_180041cb0(puVar1[2],0x40,&DAT_180082c58);
}
memcpy((void *)((longlong)param_1 + 0x179),param_2,_Size);
*(uint *)(param_1 + 0x34) = uVar3;
}
else {
if (((undefined8 **)puVar1 != &DAT_180091000) &&
((*(uint *)((longlong)puVar1 + 0x1c) & 0x800) != 0)) {
FUN_180041cb0(puVar1[2],0x3f,&DAT_180082c58);
}
memcpy((void *)((longlong)param_1 + 0x1a4),param_2,_Size);
*(uint *)(param_1 + 0x39) = uVar3;
}
if (*(char *)((longlong)param_1 + 0x154) == '\0') {
memcpy((void *)((longlong)param_1 + 0x155),local_68,_Size);
*(undefined *)((longlong)param_1 + 0x154) = 1;
FUN_180006808(param_1);
}
if ((*(char *)((longlong)param_1 + 0xe9) != '\0') &&
((*(uint *)(param_1 + 8) & 0xa0000) != 0)) {
FUN_18006fe4c((longlong)param_1);
}
}
else {
if (((undefined8 **)puVar1 != &DAT_180091000) &&
((*(byte *)((longlong)puVar1 + 0x1c) & 1) != 0)) {
FUN_180041cb0(puVar1[2],0x3e,&DAT_180082c58);
}
FUN_18005b470(param_1,900,0x80090308,0x33);
}
}
else {
FUN_18005b470(param_1,0x386,iVar2,0x33);
}
}
else {
FUN_18005b470(param_1,0x387,0x80090308,0x32);
}
FUN_180028070(local_40 ^ (ulonglong)auStack_98);
return;
}
=========================================
Function at address: 0x180006808
Called functions addresses: 0xEXTERNAL:000000c0 0x18002a7c0 0xEXTERNAL:000000c2 0xEXTERNAL:0000011a


int FUN_180006808(longlong *param_1)

{
int iVar1;
undefined *puVar2;
undefined4 *puVar3;
undefined8 uVar4;
longlong lVar5;
undefined *puVar6;

uVar4 = 0;
if (param_1[0x67] != 0) {
if (param_1[0xb] == 0) {
return 0x54f;
}
RtlAcquireResourceShared(param_1[0xb] + 0x48,1);
lVar5 = *(longlong *)(param_1[0xb] + 0x10);
if (lVar5 != 0) {

if (puVar2 == (undefined *)0x0) {
RtlReleaseResource(param_1[0xb] + 0x48);
return 0xe;
}
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
uVar4 = *(undefined8 *)param_1[1];
}
iVar1 = SslExportKeyingMaterial
(uVar4,lVar5,"EXPORTER-Token-Binding",param_1 + 0x22,0x40,0,0,puVar2,0x20,0)
;
RtlReleaseResource(param_1[0xb] + 0x48);
if (iVar1 == 0) {
puVar3 = (undefined4 *)param_1[0x68];
if (puVar3 == (undefined4 *)0x0) {

param_1[0x68] = (longlong)puVar3;
if (puVar3 == (undefined4 *)0x0) {
iVar1 = 0xe;
goto LAB_18002e10f;
}
}
else if (*(undefined **)(puVar3 + 2) != (undefined *)0x0) {
puVar6 = *(undefined **)(puVar3 + 2);
for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
*puVar6 = 0;
puVar6 = puVar6 + 1;
}

;
puVar3 = (undefined4 *)param_1[0x68];
}
*puVar3 = 0x20;
*(undefined **)(param_1[0x68] + 8) = puVar2;
return 0;
}
LAB_18002e10f:
puVar6 = puVar2;
for (lVar5 = 0x20; lVar5 != 0; lVar5 = lVar5 + -1) {
*puVar6 = 0;
puVar6 = puVar6 + 1;
}

return iVar1;
}
RtlReleaseResource(param_1[0xb] + 0x48);
}
return 6;
}
=========================================
Function at address: 0x18000685c
Called functions addresses: 0x180006358 0x180006b5c 0x180028d78 0xEXTERNAL:0000018b 0x18002a7c0 0x18000a1f4 0x1800069c4 0x180006a04


int FUN_18000685c(longlong param_1,char param_2,longlong param_3,uint *param_4,undefined8 *param_5)

{
longlong *plVar1;
uint uVar2;
ulonglong uVar3;
code *pcVar4;
byte *pbVar5;
ulonglong uVar6;
undefined8 *puVar7;
longlong *plVar8;
undefined8 *puVar9;
int iVar10;
longlong lVar11;
undefined *puVar12;
longlong *plVar13;
undefined auStack_58 [8];
undefined auStack_50 [24];
undefined4 local_38;
uint uStack_34;
uint uStack_30;
uint uStack_2c;
uint local_28;
uint uStack_24;
uint uStack_20;
uint uStack_1c;

puVar12 = auStack_58;
puVar7 = (undefined8 *)0x0;
if (param_2 == '\0') {
lVar11 = -1;
do {
lVar11 = lVar11 + 1;
} while (*(short *)(param_3 + lVar11 * 2) != 0);
iVar10 = (int)lVar11 + 1;
pbVar5 = (byte *)FUN_18000a1f4((ulonglong)(uint)(iVar10 * 2));
if (pbVar5 == (byte *)0x0) {
return 0xe;
}
_o_wcscpy_s(pbVar5,iVar10,param_3);
uVar6 = FUN_180006358(param_1,pbVar5);
uVar6 = uVar6 & 0xffffffff;
puVar7 = (undefined8 *)FUN_18000a1f4(0x1b8);
if (puVar7 == (undefined8 *)0x0) {
return 0xe;
}
puVar7 = FUN_180006a04(puVar7,param_1,*(undefined4 *)(param_1 + 0x14),pbVar5);
LAB_1800068ec:
puVar9 = puVar7;
if (puVar7 == (undefined8 *)0x0) {
return 0xe;
}
}
else {
uStack_30 = param_4[2];
uStack_2c = param_4[3];
local_28 = param_4[4];
uStack_24 = param_4[5];
uStack_20 = param_4[6];
uStack_1c = param_4[7];
uVar6 = (ulonglong)*param_4 % (ulonglong)*(uint *)(param_1 + 0x10);
local_38 = (undefined4)uVar6;
uStack_34 = param_4[1];
if (DAT_1800919f4 != 0xffffffff) {
uStack_34 = DAT_1800919f4;
}

if (puVar9 == (undefined8 *)0x0) goto LAB_1800068ec;
FUN_180006b5c(puVar9,*(undefined4 *)(param_1 + 0x18),&local_38);
puVar9[0x2a] = 0;
*puVar9 = &PTR_FUN_18007c330;
puVar9[0x2b] = 0;
*(undefined4 *)(puVar9 + 0x2c) = 0;
*(undefined4 *)(puVar9 + 0x1b) = 0x80090325;
}
iVar10 = *(int *)((longlong)puVar9 + 0x44);
if (iVar10 != 0) {

return iVar10;
}
uVar2 = *(uint *)(param_1 + 0x34);
uVar3 = uVar6 / uVar2;
*param_5 = puVar9;
plVar13 = (longlong *)(uVar3 * 0x98 + *(longlong *)(param_1 + 0x28));
FUN_1800069c4(uVar3,(longlong)puVar9);
puVar9[0x1c] = plVar13;
plVar1 = puVar9 + 0x24;
lVar11 = (uVar6 % (ulonglong)uVar2) * 0x10 + *plVar13;
plVar8 = *(longlong **)(lVar11 + 8);
if (*plVar8 == lVar11) {
puVar9[0x25] = plVar8;
puVar9 = puVar9 + 0x26;
*plVar1 = lVar11;
*plVar8 = (longlong)plVar1;
plVar8 = plVar13 + 2;
*(longlong **)(lVar11 + 8) = plVar1;
puVar7 = (undefined8 *)plVar13[3];
if ((longlong *)*puVar7 == plVar8) goto LAB_18000697b;
}
puVar7 = (undefined8 *)0x3;
pcVar4 = (code *)swi(0x29);
plVar8 = (longlong *)(*pcVar4)();
puVar12 = auStack_50;
LAB_18000697b:
*puVar9 = plVar8;
puVar9[1] = puVar7;
*puVar7 = puVar9;
plVar8[1] = (longlong)puVar9;
LOCK();
*(int *)(param_1 + 0x20) = *(int *)(param_1 + 0x20) + 1;
UNLOCK();
*(undefined8 *)(puVar12 + -8) = 0x18000699c;
LsaIModifyPerformanceCounter(4,0,0);
return 0;
}
=========================================
Function at address: 0x1800069c4
Called functions addresses: 0xEXTERNAL:0000018b


int FUN_1800069c4(undefined8 param_1,longlong param_2)

{
int *piVar1;
int iVar2;
int iVar3;

LOCK();
piVar1 = (int *)(param_2 + 0xe8);
iVar2 = *piVar1;
*piVar1 = *piVar1 + 1;
UNLOCK();
iVar3 = iVar2 + 1;
if (iVar3 == 2) {
LsaIModifyPerformanceCounter(iVar2 + 4,0,0);
}
return iVar3;
}
=========================================
Function at address: 0x180006a04
Called functions addresses: 0x180006b5c 0x180006aac


undefined8 *
FUN_180006a04(undefined8 *param_1,undefined8 param_2,undefined4 param_3,undefined8 param_4)

{
FUN_180006b5c(param_1,param_3,(undefined4 *)0x0);
param_1[0x2e] = param_4;
*param_1 = &PTR_FUN_18007c210;
param_1[0x31] = param_2;
param_1[0x2a] = 0;
*(undefined4 *)(param_1 + 0x2b) = 0;
param_1[0x2c] = 0;
*(undefined4 *)(param_1 + 0x2d) = 0;
param_1[0x30] = 0;
param_1[0x32] = 0;
param_1[0x33] = 0;
*(undefined4 *)(param_1 + 0x34) = 0;
param_1[0x35] = 0;
*(undefined4 *)(param_1 + 0x36) = 0;
FUN_180006aac(param_1 + 0x2f);
return param_1;
}
=========================================
Function at address: 0x180006aac
Called functions addresses: 0xEXTERNAL:000000c7 0x18002a7c0


void FUN_180006aac(undefined8 *param_1)

{
int iVar1;
undefined8 local_28 [4];

*param_1 = 0;

if (-1 < iVar1) {
*param_1 = local_28[0];
}
RtlNtStatusToDosError(iVar1);
return;
}
=========================================
Function at address: 0x180006b10
Called functions addresses: 0x18002a7c0 0xEXTERNAL:00000040


undefined8 * FUN_180006b10(undefined8 *param_1,byte param_2)

{
*param_1 = &PTR_FUN_18007c298;
if ((param_2 & 1) != 0) {
if (DAT_180092620 == 0) {
LocalFree(param_1);
}
else {

}
}
return param_1;
}
=========================================
Function at address: 0x180006b5c
Called functions addresses: 0x18002a7c0 0x18002a410 0xEXTERNAL:000000b5 0xEXTERNAL:00000088 0xEXTERNAL:0000007a


undefined8 * FUN_180006b5c(undefined8 *param_1,undefined4 param_2,undefined4 *param_3)

{
undefined4 uVar1;
undefined4 uVar2;
undefined8 uVar3;
char cVar4;
DWORD DVar5;
undefined4 uVar6;
undefined4 local_28;

FUN_18002a410(param_1);
*param_1 = &PTR_FUN_18007c2c0;
*(undefined4 *)(param_1 + 1) = 0;
param_1[2] = 0;
param_1[3] = 0;
*(undefined4 *)(param_1 + 4) = 0;
param_1[5] = 0;
param_1[6] = 0;
param_1[7] = 0;
*(undefined4 *)(param_1 + 8) = 0;
*(undefined4 *)(param_1 + 0x15) = 0;
param_1[0x16] = 0;
*(undefined4 *)(param_1 + 0x17) = 0;
param_1[0x19] = 0;
*(undefined *)(param_1 + 0x1a) = 0;
*(undefined4 *)((longlong)param_1 + 0xd4) = 0;
*(undefined4 *)(param_1 + 0x1b) = 0x8009030e;
*(undefined4 *)((longlong)param_1 + 0xdc) = 0;
*(undefined4 *)(param_1 + 0x1d) = 1;
*(undefined *)((longlong)param_1 + 0xec) = 0;
DVar5 = GetTickCount();
*(DWORD *)((longlong)param_1 + 0x114) = DVar5;
*(undefined4 *)(param_1 + 0x23) = param_2;
if (param_3 == (undefined4 *)0x0) {
param_1[0x1e] = 0;
param_1[0x1f] = 0;
param_1[0x20] = 0;
param_1[0x21] = 0;
}
else {
uVar6 = param_3[1];
uVar1 = param_3[2];
uVar2 = param_3[3];
*(undefined4 *)(param_1 + 0x1e) = *param_3;
*(undefined4 *)((longlong)param_1 + 0xf4) = uVar6;
*(undefined4 *)(param_1 + 0x1f) = uVar1;
*(undefined4 *)((longlong)param_1 + 0xfc) = uVar2;
uVar3 = *(undefined8 *)(param_3 + 6);
param_1[0x20] = *(undefined8 *)(param_3 + 4);
param_1[0x21] = uVar3;
}
if (DAT_180092620 == 0) {
DVar5 = GetCurrentProcessId();
*(DWORD *)(param_1 + 0x22) = DVar5;
}
else {

uVar6 = 0xffffffff;
if (cVar4 != '\0') {
uVar6 = local_28;
}
*(undefined4 *)(param_1 + 0x22) = uVar6;
}
*(undefined8 *)((longlong)param_1 + 0xbc) = 0;
RtlInitializeResource(param_1 + 9);
*(undefined4 *)((longlong)param_1 + 0x44) = 0;
return param_1;
}
=========================================
Function at address: 0x180006ccc
Called functions addresses: 0x180006da4 0x180028d30 0x180027150


byte FUN_180006ccc(ushort *param_1,undefined8 *param_2,uint param_3,char param_4)

{
int iVar1;
ulonglong uVar2;
undefined **ppuVar3;
byte bVar4;
undefined **ppuVar5;
byte bVar6;
ulonglong uVar7;

bVar6 = 0;
if (param_3 != 0) {
uVar7 = (ulonglong)param_3;
do {
bVar4 = 0;
ppuVar5 = &PTR_u_RSA_SHA256_18007c3a0;
do {
if ((bVar4 < 0xc) && ((param_1[0x11] >> (bVar4 & 0x1f) & 1) != 0)) {
bVar6 = 1;
}
else {
ppuVar3 = ppuVar5 + -1;
if (param_4 == '\0') {
ppuVar3 = ppuVar5;
}
iVar1 = _o__wcsicmp(*ppuVar3,*param_2);
if (iVar1 == 0) {
uVar2 = FUN_180006da4(param_1,bVar4);
bVar6 = bVar6 | (byte)uVar2;
if (param_4 != '\0') break;
}
}
bVar4 = bVar4 + 1;
ppuVar3 = ppuVar5 + 7;
ppuVar5 = ppuVar5 + 9;
} while (ppuVar3 < &PTR_FUN_18007c6f0);
param_2 = param_2 + 1;
uVar7 = uVar7 - 1;
} while (uVar7 != 0);
}
if (param_4 != '\0') {
FUN_180027150();
}
return bVar6;
}
=========================================
Function at address: 0x180006da4
Called functions addresses: None


ulonglong FUN_180006da4(ushort *param_1,byte param_2)

{
uint uVar1;
ulonglong in_RAX;

if (param_2 < 0xc) {
in_RAX = (ulonglong)param_1[0x11];
if ((param_1[0x11] >> (param_2 & 0x1f) & 1) == 0) {
if (0xf < *param_1) goto LAB_180006df6;
param_1[(ulonglong)*param_1 + 1] =
(ushort)(&DAT_18007c390)[(ulonglong)param_2 * 0x24] >> 8 |
(&DAT_18007c390)[(ulonglong)param_2 * 0x24] << 8;
*param_1 = *param_1 + 1;
uVar1 = (uint)param_1[0x11] | 1 << (param_2 & 0x1f);
in_RAX = (ulonglong)uVar1;
param_1[0x11] = (ushort)uVar1;
}
return CONCAT71((int7)(in_RAX >> 8),1);
}
LAB_180006df6:
return in_RAX & 0xffffffffffffff00;
}
=========================================
Function at address: 0x180006e00
Called functions addresses: 0x180007e50 0x180028d3c


ulonglong FUN_180006e00(longlong param_1,undefined8 param_2,uint param_3,undefined4 *param_4,
longlong *param_5,undefined4 *param_6)

{
int iVar1;
ulonglong uVar2;
uint *puVar3;
uint uVar4;
ulonglong uVar5;
uint uVar6;
ushort uVar7;
undefined4 *puVar8;
longlong lVar9;
undefined4 uVar10;
ulonglong uVar11;
undefined8 in_stack_ffffffffffffffb8;
undefined4 local_38 [2];
longlong local_30;

uVar4 = 0;
local_38[0] = 0;
local_30 = 0;
uVar5 = 0x80090331;
uVar10 = 0;
uVar6 = 4;
puVar8 = param_4;
if (4 < DAT_180092324) {
do {
uVar2 = FUN_180007e50(uVar6,&local_30,(undefined4 *)0x0,puVar8,in_stack_ffffffffffffffb8,
local_38);
lVar9 = local_30;
uVar5 = uVar2 & 0xffffffff;
if (((int)uVar2 == 0) && (iVar1 = _o__wcsnicmp(param_2,local_30), iVar1 == 0)) break;
uVar6 = uVar6 + 1;
} while ((int)uVar6 < DAT_180092324);
if (((int)uVar6 < DAT_180092324) && (lVar9 != 0)) {
puVar3 = &DAT_18007c3b8;
*param_4 = local_38[0];
uVar5 = 0;
uVar7 = 1 << ((byte)local_38[0] & 0x1f);
*param_5 = lVar9;
lVar9 = 0xc;
uVar2 = 1;
do {
uVar11 = uVar2;
if (((((byte)uVar4 < 0xc) && ((*(ushort *)(param_1 + 0x22) >> (uVar4 & 0x1f) & 1) != 0)) &&
((puVar3[-4] & param_3) != 0)) && (uVar6 = *puVar3, (uVar7 >> (uVar6 & 0x1f) & 1) == 0))
{
uVar7 = uVar7 | (ushort)(1 << (uVar6 & 0x1f));
uVar11 = (ulonglong)((int)uVar2 + 1);
param_4[uVar2] = uVar6;
param_5[uVar2] = *(longlong *)(puVar3 + 2);
}
uVar10 = (undefined4)uVar11;
puVar3 = puVar3 + 0x12;
uVar4 = (uint)(byte)((byte)uVar4 + 1);
lVar9 = lVar9 + -1;
uVar2 = uVar11;
} while (lVar9 != 0);
}
}
*param_6 = uVar10;
return uVar5;
}
=========================================
Function at address: 0x180006f5c
Called functions addresses: 0x1800077a0 0x180006da4


undefined8 FUN_180006f5c(ushort *param_1,uint *param_2,uint param_3)

{
undefined8 uVar1;
undefined8 uVar2;
byte bVar3;
uint uVar4;
longlong lVar5;
undefined **ppuVar6;

uVar2 = 0;
if ((param_2 == (uint *)0x0) || (param_3 == 0)) {
uVar2 = 0;
}
else {
*param_1 = 0;
ppuVar6 = &PTR_DAT_18007c3b0;
uVar4 = 0;
lVar5 = 0xc;
do {
bVar3 = (byte)uVar4;
if ((bVar3 < 0xc) && ((param_1[0x11] >> (uVar4 & 0x1f) & 1) != 0)) {
param_1[0x11] = param_1[0x11] & ~(ushort)(1 << (uVar4 & 0x1f));
uVar1 = FUN_1800077a0(param_2,param_3,4,(wchar_t *)ppuVar6[2],(wchar_t *)0x0,0,0,'\x01');
if (((char)uVar1 == '\0') &&
(uVar1 = FUN_1800077a0(param_2,param_3,4,(wchar_t *)*ppuVar6,(wchar_t *)0x0,0,0,'\x01'),
(char)uVar1 == '\0')) {
FUN_180006da4(param_1,bVar3);
}
}
ppuVar6 = ppuVar6 + 9;
uVar4 = (uint)(byte)(bVar3 + 1);
lVar5 = lVar5 + -1;
} while (lVar5 != 0);
if (*param_1 == 0) {
uVar2 = 0x80090331;
}
}
return uVar2;
}
=========================================
Function at address: 0x18000706c
Called functions addresses: 0x180007410 0xEXTERNAL:000000c0 0x1800079ec 0x180007c20 0x180044bcc 0x18000a1f4 0xEXTERNAL:000000c2


undefined8
FUN_18000706c(undefined8 param_1,int *param_2,uint param_3,uint param_4,longlong param_5,
uint param_6,longlong param_7,uint *param_8,longlong *param_9,undefined2 *param_10)

{
uint uVar1;
uint uVar2;
uint *puVar3;
longlong *plVar4;
bool bVar5;
bool bVar6;
longlong lVar7;
undefined8 uVar8;
undefined8 *puVar9;
ulonglong uVar10;
short *psVar11;
uint uVar12;
uint uVar13;
uint uVar14;
ulonglong uVar15;
wchar_t *pwVar16;
ulonglong uVar17;
longlong *plVar18;
undefined8 uVar19;
uint local_64;
longlong local_50;

uVar15 = 0;
bVar5 = false;
uVar19 = 0;
local_50 = 0;
if (param_5 == 0) goto LAB_18003368c;
puVar3 = *(uint **)(param_5 + 200);
uVar1 = *(uint *)(param_5 + 0xc4);
RtlAcquireResourceShared(&DAT_180092428,1);
if (param_9 == (longlong *)0x0) {
LAB_180007110:
if (uVar1 == 0) {
LAB_18000713e:
bVar6 = false;
}
else {
uVar8 = FUN_180007c20(puVar3,uVar1,(wchar_t *)0x0,0,0,0,'\x01');
bVar6 = true;
if ((char)uVar8 == '\0') goto LAB_18000713e;
}
puVar9 = DAT_1800925b0;
if (*(char *)(param_5 + 0xac) != '\0') {
puVar9 = DAT_1800925b8;
}
uVar17 = 0;
if (puVar9 != (undefined8 *)0x0) {
plVar18 = (longlong *)*puVar9;
uVar2 = *(uint *)(puVar9 + 1);
local_64 = 0;
if (uVar2 != 0) {
do {
uVar14 = (uint)uVar15;
if (*param_8 <= uVar14) break;
uVar10 = FUN_180007410(&DAT_180092420,param_2,(ulonglong)param_3,param_4,
*(uint *)(param_5 + 0x9c) >> 0xc & 1,
*(uint *)(param_5 + 0x9c) & 0x800,*(uint *)(param_5 + 0xa8),
*(uint *)(param_5 + 0xa4),param_6,(longlong)plVar18,0,puVar3,uVar1,
'\x01');
if ((char)uVar10 != '\0') {
if ((param_9 != (longlong *)0x0) &&
(((*(int *)(plVar18 + 6) == 3 || ((*(uint *)(plVar18 + 1) & 0x3000) != 0)) &&
(local_50 != *plVar18)))) {
plVar4 = (longlong *)plVar18[0x6a];
if (plVar4 == (longlong *)0x0) goto LAB_180007257;
if (bVar5) {
uVar10 = 0;
if ((uint)uVar17 != 0) {
do {
uVar12 = 0;
if (*(int *)(plVar4 + 1) == 0) goto LAB_180007257;
while ((uint)*(ushort *)(*param_9 + uVar10 * 2) !=
*(uint *)((ulonglong)uVar12 * 0x30c + 0x304 + *plVar4)) {
uVar12 = uVar12 + 1;
if (*(uint *)(plVar4 + 1) <= uVar12) goto LAB_180007257;
}
uVar12 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar12;
} while (uVar12 < (uint)uVar17);
}
}
else {
uVar10 = 0;
if (*(int *)(plVar4 + 1) != 0) {
do {
pwVar16 = (wchar_t *)(uVar10 * 0x30c + *plVar4);
psVar11 = (short *)*param_9;
uVar12 = (uint)uVar17;
if ((psVar11 != (short *)0x0) && (uVar13 = 0, uVar12 != 0)) {
do {
if ((short)*(undefined4 *)(pwVar16 + 0x182) == *psVar11) goto LAB_180007387;
uVar13 = uVar13 + 1;
psVar11 = psVar11 + 1;
} while (uVar13 < uVar12);
}
if (DAT_1800925d0 <= uVar12) {
uVar19 = 0x54f;
goto LAB_1800073d3;
}
if ((uVar1 == 0) ||
((uVar8 = FUN_1800079ec(puVar3,uVar1,pwVar16,0,'\x01'), (char)uVar8 == '\0'
&& ((bVar6 || (uVar8 = FUN_180007c20(puVar3,uVar1,pwVar16,
*(int *)(pwVar16 + 0x182),
*(uint *)(pwVar16 + 0x180),0,'\x01'),
(char)uVar8 == '\0')))))) {
*(wchar_t *)(*param_9 + uVar17 * 2) = pwVar16[0x182];
uVar17 = (ulonglong)(uVar12 + 1);
}
LAB_180007387:
uVar12 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar12;
} while (uVar12 < *(uint *)(plVar4 + 1));
}
local_50 = *plVar18;
bVar5 = true;
}
}
uVar10 = 0;
if (uVar14 != 0) {
do {
if (*(int *)((longlong)plVar18 + 0x1c) == *(int *)(param_7 + uVar10 * 4))
goto LAB_180007257;
uVar12 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar12;
} while (uVar12 < uVar14);
}
if (((*(int *)(plVar18 + 6) != 3) && ((*(uint *)(plVar18 + 1) & 0x3000) == 0)) ||
((int)uVar17 != 0)) {
*(undefined4 *)(param_7 + uVar15 * 4) = *(undefined4 *)((longlong)plVar18 + 0x1c);
uVar15 = (ulonglong)(uVar14 + 1);
}
}
LAB_180007257:
plVar18 = plVar18 + 0x6c;
local_64 = local_64 + 1;
} while (local_64 < uVar2);
}
}
*param_8 = (uint)uVar15;
if (param_10 != (undefined2 *)0x0) {
*param_10 = (short)uVar17;
}
}
else {
lVar7 = FUN_18000a1f4((ulonglong)((uint)DAT_1800925d0 * 2));
*param_9 = lVar7;
if (lVar7 != 0) goto LAB_180007110;
uVar19 = 0xe;
}
LAB_1800073d3:
RtlReleaseResource(&DAT_180092428);
if ((int)uVar15 != 0) {
return uVar19;
}
LAB_18003368c:
FUN_180044bcc(*(uint *)(param_5 + 0xd4),param_5 + 0xd8,param_6);
return 0x80090331;
}
=========================================
Function at address: 0x180007410
Called functions addresses: 0x180059c68 0x1800336c4 0x18003393b 0x1800336b4 0x1800077a0 0x1800076fb 0x180033741


ulonglong FUN_180007410(undefined8 param_1,int *param_2,undefined8 param_3,uint param_4,uint param_5
,int param_6,uint param_7,uint param_8,uint param_9,longlong param_10,
longlong param_11,uint *param_12,uint param_13,char param_14)

{
uint uVar1;
uint uVar2;
uint uVar3;
uint *in_RAX;
uint *puVar4;
uint *puVar5;
ulonglong uVar6;
undefined4 extraout_var;
uint uVar7;
uint *puVar8;
undefined8 uVar9;
undefined2 uVar10;
uint uVar11;
bool bVar12;
bool bVar13;

if (param_10 == 0) {
uVar6 = FUN_1800076fb();
return uVar6;
}
uVar3 = *(uint *)(param_10 + 8);
if ((param_9 & uVar3) == 0) {
if (((uint **)DAT_180091000 == &DAT_180091000) || ((*(byte *)(DAT_180091000 + 7) & 4) == 0))
goto LAB_180007718;
uVar10 = 10;
param_7 = param_9;
LAB_1800339e7:
uVar9 = *(undefined8 *)(DAT_180091000 + 4);
LAB_1800339eb:
in_RAX = (uint *)FUN_180041dd8(uVar9,uVar10,&DAT_180085700,(wchar_t *)(param_10 + 0x4a),
(char)param_7);
}
else {
puVar5 = (uint *)0x0;
in_RAX = (uint *)0x0;
if ((*(int *)(param_10 + 0x30) == 4) != param_5) goto LAB_180007718;
if (param_6 != 0) {
uVar11 = *(uint *)(param_10 + 0x28);
in_RAX = (uint *)(ulonglong)uVar11;
if ((uVar11 < 0x6604) || (0x6800 < uVar11)) {
in_RAX = (uint *)(ulonglong)(uVar11 - 0x6000);
if ((uVar11 - 0x6000 != 0) &&
((in_RAX = (uint *)(ulonglong)(uVar11 - 0x6601), uVar11 - 0x6601 != 0 &&
(in_RAX = (uint *)(ulonglong)(uVar11 - 0x6603), uVar11 - 0x6603 != 0)))) {
uVar6 = FUN_1800336b4(param_1,0,param_3,(ulonglong)uVar3);
return uVar6;
}
if (((uint **)DAT_180091000 != &DAT_180091000) && ((*(byte *)(DAT_180091000 + 7) & 4) != 0))
{
uVar6 = FUN_1800336c4((longlong)DAT_180091000);
return uVar6;
}
goto LAB_180007718;
}
if ((*(char *)(param_10 + 0x48) != '\0') || (*(int *)(param_10 + 0x2c) == 0x8003))
goto LAB_180007718;
}
in_RAX = (uint *)(ulonglong)param_8;
if (param_8 == 0) {
if (param_7 != 0) goto LAB_1800074a8;
if (*(int *)(param_10 + 0x28) == 0x6000) goto LAB_1800074be;
if (((uint **)DAT_180091000 == &DAT_180091000) || ((*(byte *)(DAT_180091000 + 7) & 4) == 0))
goto LAB_180007718;
uVar10 = 0xc;
}
else {
if (param_7 != 0) {
LAB_1800074a8:
if (*(uint *)(param_10 + 0x14) <= param_7) {
if (param_8 == 0) goto LAB_1800074be;
goto LAB_1800074b5;
}
in_RAX = DAT_180091000;
if (((uint **)DAT_180091000 == &DAT_180091000) || ((*(byte *)(DAT_180091000 + 7) & 4) == 0))
goto LAB_180007718;
uVar10 = 0xd;
uVar9 = *(undefined8 *)(DAT_180091000 + 4);
goto LAB_1800339eb;
}
LAB_1800074b5:
if (*(uint *)(param_10 + 0x14) < param_8) {
if (((uint **)DAT_180091000 != &DAT_180091000) && ((*(byte *)(DAT_180091000 + 7) & 4) != 0))
{
uVar3 = FUN_180033741((longlong)DAT_180091000);
return CONCAT44(extraout_var,uVar3);
}
goto LAB_180007718;
}
LAB_1800074be:
uVar11 = *(uint *)(param_10 + 0x20);
puVar4 = &DAT_1800914c0;
puVar8 = puVar5;
do {
if (*puVar4 == uVar11) {
in_RAX = &DAT_1800914c0 + (longlong)puVar8 * 0x10;
if ((in_RAX != (uint *)0x0) &&
(((&DAT_1800914c4)[(longlong)puVar8 * 0x10] & param_9) == 0)) {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar10 = 0xf;
goto LAB_1800339b8;
}
break;
}
uVar7 = (int)puVar8 + 1;
puVar8 = (uint *)(ulonglong)uVar7;
puVar4 = puVar4 + 0x10;
} while (uVar7 < 4);
param_7 = *(uint *)(param_10 + 0x2c);
puVar4 = &DAT_180091028;
puVar8 = puVar5;
do {
if (*puVar4 == param_7) {
in_RAX = (uint *)(&DAT_180091010 + (longlong)puVar8 * 5);
if ((in_RAX != (uint *)0x0) && ((*in_RAX & param_9) == 0)) {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar10 = 0x10;
goto LAB_1800339b8;
}
break;
}
uVar7 = (int)puVar8 + 1;
puVar8 = (uint *)(ulonglong)uVar7;
puVar4 = puVar4 + 10;
} while (uVar7 < 5);
uVar7 = *(uint *)(param_10 + 0x28);
puVar4 = &DAT_180091100;
puVar8 = puVar5;
do {
if (*puVar4 == uVar7) {
if ((&DAT_1800910e0 + (longlong)puVar8 * 0xe != (uint *)0x0) &&
(uVar1 = (param_9 & 0xf3fff) >> 1,
((&DAT_1800910e0)[(longlong)puVar8 * 0xe] & param_9 & 0xf3fff) <= uVar1)) {
in_RAX = (uint *)(ulonglong)uVar1;
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar10 = 0x11;
param_7 = param_9 & 0xf3fff;
goto LAB_1800339e7;
}
break;
}
uVar1 = (int)puVar8 + 1;
puVar8 = (uint *)(ulonglong)uVar1;
puVar4 = puVar4 + 0xe;
} while (uVar1 < 8);
uVar1 = *(uint *)(param_10 + 0x24);
puVar8 = &DAT_1800913ec;
do {
if (*puVar8 == uVar1) {
in_RAX = &DAT_1800913d0;
if ((&DAT_1800913d0 + (longlong)puVar5 * 8 != (uint *)0x0) &&
(((&DAT_1800913d0)[(longlong)puVar5 * 8] & param_9) == 0)) {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar10 = 0x12;
param_7 = param_9 & 0xf3fff;
goto LAB_1800339e7;
}
break;
}
uVar2 = (int)puVar5 + 1;
in_RAX = (uint *)(ulonglong)uVar2;
puVar8 = puVar8 + 8;
puVar5 = in_RAX;
} while (uVar2 < 5);
uVar2 = (uint)param_3;
if (uVar2 != 0) {
bVar12 = (uVar3 & 0x3000) != 0;
bVar13 = (param_4 & 4) != 0;
in_RAX = (uint *)CONCAT71((int7)((ulonglong)in_RAX >> 8),bVar13);
if ((bVar12 || !bVar13) ||
(in_RAX = (uint *)FUN_180059c68(param_2,uVar2,uVar11), (char)in_RAX != '\0')) {
bVar13 = (param_4 & 1) != 0;
in_RAX = (uint *)CONCAT71((int7)((ulonglong)in_RAX >> 8),bVar13);
if ((bVar12 || !bVar13) ||
(in_RAX = (uint *)FUN_180059c68(param_2,uVar2,uVar1), (char)in_RAX != '\0')) {
if (((param_4 & 8) == 0) ||
(in_RAX = (uint *)FUN_180059c68(param_2,uVar2,uVar7), (char)in_RAX != '\0')) {
if (((param_4 & 2) == 0) ||
(in_RAX = (uint *)FUN_180059c68(param_2,uVar2,param_7), (char)in_RAX != '\0'))
goto LAB_18000769f;
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar10 = 0x16;
}
else {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar10 = 0x15;
param_7 = uVar7;
}
}
else {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar10 = 0x14;
param_7 = uVar1;
}
}
else {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar10 = 0x13;
param_7 = uVar11;
}
goto LAB_1800339e7;
}
if (param_13 == 0) {
LAB_18000769f:
return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}
in_RAX = (uint *)FUN_1800077a0(param_12,param_13,0,(wchar_t *)(param_10 + 0x14a),
(wchar_t *)0x0,0,param_11,param_14);
if ((char)in_RAX != '\0') {
if (((uint **)DAT_180091000 != &DAT_180091000) && ((*(byte *)(DAT_180091000 + 7) & 4) != 0))
{
uVar6 = FUN_18003393b((longlong)DAT_180091000);
return uVar6;
}
goto LAB_180007718;
}
in_RAX = (uint *)FUN_1800077a0(param_12,param_13,1,(wchar_t *)(param_10 + 0x1ca),
(wchar_t *)0x0,0,param_11,param_14);
if ((char)in_RAX == '\0') {
in_RAX = (uint *)FUN_1800077a0(param_12,param_13,2,(wchar_t *)(param_10 + 0xca),
(wchar_t *)(param_10 + 0x2ca),*(uint *)(param_10 + 0x14),
param_11,param_14);
if ((char)in_RAX == '\0') {
in_RAX = (uint *)FUN_1800077a0(param_12,param_13,3,(wchar_t *)(param_10 + 0x24a),
(wchar_t *)0x0,0,param_11,param_14);
if ((char)in_RAX == '\0') goto LAB_18000769f;
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar10 = 0x1a;
}
else {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar10 = 0x19;
}
}
else {
if (((uint **)DAT_180091000 == &DAT_180091000) || ((*(byte *)(DAT_180091000 + 7) & 4) == 0))
goto LAB_180007718;
uVar10 = 0x18;
}
}
LAB_1800339b8:
in_RAX = (uint *)FUN_180041d70(*(undefined8 *)(DAT_180091000 + 4),uVar10,&DAT_180085700,
(wchar_t *)(param_10 + 0x4a));
}
LAB_180007718:
return (ulonglong)in_RAX & 0xffffffffffffff00;
}
=========================================
Function at address: 0x1800076fb
Called functions addresses: None


undefined FUN_1800076fb(void)

{
undefined1 in_R10B;
wchar_t *unaff_R13;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041dd8(DAT_180091000[2],10,&DAT_180085700,unaff_R13,in_R10B);
}
return 0;
}
=========================================
Function at address: 0x1800077a0
Called functions addresses: 0xEXTERNAL:0000003c 0x180033a0f 0xEXTERNAL:000000a7


ulonglong FUN_1800077a0(uint *param_1,uint param_2,int param_3,wchar_t *param_4,wchar_t *param_5,
uint param_6,longlong param_7,char param_8)

{
uint *puVar1;
int iVar2;
ulonglong in_RAX;
longlong lVar3;
undefined8 uVar4;
undefined8 *puVar5;
undefined uVar6;
undefined uVar7;
uint uVar9;
int *piVar10;
undefined uVar11;
ulonglong uVar12;
wchar_t *pwVar13;
ushort *puVar14;
undefined4 in_stack_ffffffffffffffd0;
wchar_t *_Str1;
wchar_t *pwVar8;

if (((param_2 != 0) && (param_1 != (uint *)0x0)) && (param_4 != (wchar_t *)0x0)) {
in_RAX = 0xffffffffffffffff;
do {
in_RAX = in_RAX + 1;
} while (param_4[in_RAX] != L'\0');
if (in_RAX != 0) {
in_RAX = (ulonglong)param_2;
puVar1 = param_1 + in_RAX * 10;
pwVar13 = param_4;
if (param_1 < puVar1) {
do {
if (param_1[5] != 0) {
if (*param_1 == 0) {
LAB_180007876:
if ((param_8 == '\0') || ((*(byte *)(param_1 + 8) & 1) == 0)) {
piVar10 = *(int **)(param_1 + 6);
in_RAX = (ulonglong)param_1[5];
if (piVar10 < piVar10 + in_RAX * 0xc) {
do {
if (*piVar10 == param_3) {
lVar3 = -1;
do {
lVar3 = lVar3 + 1;
} while (param_4[lVar3] != L'\0');
if (lVar3 * 2 == (ulonglong)*(ushort *)(piVar10 + 2)) {
_Str1 = *(wchar_t **)(piVar10 + 4);
uVar12 = (ulonglong)(*(ushort *)(piVar10 + 2) >> 1);
pwVar8 = param_4;
iVar2 = wcsncmp(_Str1,param_4,uVar12);
uVar11 = (undefined)uVar12;
uVar7 = SUB81(pwVar8,0);
uVar6 = SUB81(_Str1,0);
if (iVar2 == 0) {
if (((piVar10[6] == 0) && (piVar10[10] == 0)) && (piVar10[0xb] == 0)) {
puVar5 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar5 = (undefined8 *)
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,param_4,
(char)param_3);
}
LAB_1800079dd:
return CONCAT71((int7)((ulonglong)puVar5 >> 8),1);
}
if ((param_5 != (wchar_t *)0x0) &&
(puVar14 = *(ushort **)(piVar10 + 8),
puVar14 < puVar14 + (ulonglong)(uint)piVar10[6] * 8)) {
do {
uVar12 = (ulonglong)*puVar14;
lVar3 = -1;
do {
lVar3 = lVar3 + 1;
} while (param_5[lVar3] != L'\0');
if (lVar3 * 2 == uVar12) {
_Str1 = *(wchar_t **)(puVar14 + 4);
uVar12 = (ulonglong)(*puVar14 >> 1);
pwVar8 = param_5;
iVar2 = wcsncmp(_Str1,param_5,uVar12);
if (iVar2 == 0) {
puVar5 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar5 = (undefined8 *)
FUN_18005cb48(DAT_180091000[2],pwVar8,uVar12,param_4,
param_5);
}
goto LAB_1800079dd;
}
}
uVar11 = (undefined)uVar12;
uVar7 = SUB81(pwVar8,0);
uVar6 = SUB81(_Str1,0);
puVar14 = puVar14 + 8;
} while (puVar14 < (ushort *)
((ulonglong)(uint)piVar10[6] * 0x10 +
*(longlong *)(piVar10 + 8)));
}
if (param_6 != 0) {
if (piVar10[10] == 0) {
if (piVar10[0xb] != 0) {
uVar4 = FUN_180033a0f(uVar6,uVar7,uVar11,(char)pwVar13,
in_stack_ffffffffffffffd0);
return uVar4;
}
}
else {
if (param_6 < (uint)piVar10[10]) {
puVar5 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar5 = (undefined8 *)
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,param_4
,(char)param_6,(char)param_3);
}
goto LAB_1800079dd;
}
if (piVar10[0xb] != 0) {
uVar4 = FUN_180033a0f(uVar6,uVar7,uVar11,(char)pwVar13,
in_stack_ffffffffffffffd0);
return uVar4;
}
}
}
}
}
}
in_RAX = (ulonglong)param_1[5];
piVar10 = piVar10 + 0xc;
} while (piVar10 < (int *)(in_RAX * 0x30 + *(longlong *)(param_1 + 6)));
}
}
}
else if (param_7 != 0) {
uVar12 = 0;
do {
in_RAX = RtlCompareUnicodeString
(uVar12 * 0x10 + *(longlong *)(param_1 + 2),param_7,1);
if ((int)in_RAX == 0) goto LAB_180007876;
uVar9 = (int)uVar12 + 1;
uVar12 = (ulonglong)uVar9;
} while (uVar9 < *param_1);
}
}
param_1 = param_1 + 10;
} while (param_1 < puVar1);
}
}
}
return in_RAX & 0xffffffffffffff00;
}
=========================================
Function at address: 0x1800079ec
Called functions addresses: 0xEXTERNAL:0000003c 0x180007bdc 0x1800077a0 0x180033ad3 0xEXTERNAL:000000a7


ulonglong FUN_1800079ec(uint *param_1,uint param_2,wchar_t *param_3,longlong param_4,char param_5)

{
uint uVar1;
int iVar2;
undefined8 *in_RAX;
ulonglong uVar3;
undefined8 uVar4;
int *piVar5;
wchar_t *pwVar6;
uint uVar7;
int *piVar8;
uint *puVar9;
wchar_t *pwVar10;
longlong lVar11;
undefined4 in_stack_ffffffffffffffb0;

if (((param_2 == 0) || (param_1 == (uint *)0x0)) || (param_3 == (wchar_t *)0x0)) {
LAB_180007b12:
uVar3 = (ulonglong)in_RAX & 0xffffffffffffff00;
}
else {
uVar1 = *(uint *)(param_3 + 0x180);
puVar9 = param_1;
lVar11 = param_4;
if (param_1 < param_1 + (ulonglong)param_2 * 10) {
do {
uVar3 = 0;
if (puVar9[5] != 0) {
if (*puVar9 == 0) {
LAB_180007b45:
if ((param_5 == '\0') || ((*(byte *)(puVar9 + 8) & 1) == 0)) {
piVar8 = *(int **)(puVar9 + 6);
piVar5 = piVar8 + (ulonglong)puVar9[5] * 0xc;
for (; piVar8 < piVar5; piVar8 = piVar8 + 0xc) {
if ((*piVar8 == 0) && (*(short *)(piVar8 + 2) == 8)) {
pwVar10 = *(wchar_t **)(piVar8 + 4);
pwVar6 = L"ECDH";
iVar2 = wcsncmp(pwVar10,L"ECDH",4);
if (iVar2 == 0) {
if (((piVar8[6] == 0) && (piVar8[10] == 0)) && (piVar8[0xb] == 0)) {
in_RAX = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
in_RAX = (undefined8 *)
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDH",0);
}
goto LAB_180007c11;
}
if (uVar1 != 0) {
if (piVar8[10] == 0) {
if (piVar8[0xb] == 0) goto LAB_180007b70;
}
else if (uVar1 < (uint)piVar8[10]) {
in_RAX = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
in_RAX = (undefined8 *)
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDH",
(char)uVar1,0);
}
goto LAB_180007c11;
}
if (piVar8[0xb] != 0) {
uVar4 = FUN_180033ad3(pwVar10,pwVar6,0,(char)lVar11,
in_stack_ffffffffffffffb0);
return uVar4;
}
}
}
}
LAB_180007b70:
piVar5 = (int *)((ulonglong)puVar9[5] * 0x30 + *(longlong *)(puVar9 + 6));
}
}
}
else if (param_4 != 0) {
do {
iVar2 = RtlCompareUnicodeString(uVar3 * 0x10 + *(longlong *)(puVar9 + 2),param_4);
if (iVar2 == 0) goto LAB_180007b45;
uVar7 = (int)uVar3 + 1;
uVar3 = (ulonglong)uVar7;
} while (uVar7 < *puVar9);
}
}
puVar9 = puVar9 + 10;
} while (puVar9 < param_1 + (ulonglong)param_2 * 10);
}
in_RAX = (undefined8 *)FUN_1800077a0(param_1,param_2,0,param_3,(wchar_t *)0x0,0,param_4,param_5)
;
if ((char)in_RAX != '\0') {
LAB_180007c11:
return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}
iVar2 = *(int *)(param_3 + 0x182);
if (iVar2 == 0x17) {
pwVar10 = L"ECDH_P256";
}
else if (iVar2 == 0x18) {
pwVar10 = L"ECDH_P384";
}
else {
if (iVar2 != 0x19) goto LAB_180007b12;
pwVar10 = L"ECDH_P521";
}
uVar3 = FUN_1800077a0(param_1,param_2,0,pwVar10,(wchar_t *)0x0,0,param_4,param_5);
}
return uVar3;
}
=========================================
Function at address: 0x180007bdc
Called functions addresses: 0x180007bdc


/* WARNING: Variable defined which should be unmapped: param_6 */

undefined8
FUN_180007bdc(undefined8 param_1,undefined8 param_2,uint param_3,byte param_4,undefined param_5,
undefined param_6,undefined param_7,uint *param_8)

{
int iVar1;
undefined8 *puVar2;
undefined8 uVar3;
int *piVar4;
wchar_t *_Str1;
wchar_t *pwVar5;
uint uVar6;
ulonglong uVar7;
int *piVar8;
uint unaff_EBP;
wchar_t *unaff_RSI;
uint *puVar9;
uint *unaff_RDI;
wchar_t *pwVar10;
undefined4 in_register_00000084;
wchar_t *pwVar11;
ulonglong uVar12;
longlong unaff_R12;
char unaff_R13B;
uint *unaff_R14;
uint unaff_R15D;
undefined3 in_stack_00000029;

uVar12 = (ulonglong)param_4;
pwVar11 = (wchar_t *)CONCAT44(in_register_00000084,param_3);
LAB_180007a73:
do {
do {
puVar9 = unaff_RDI;
unaff_RDI = puVar9 + 10;
uVar6 = (uint)pwVar11;
if (param_8 <= unaff_RDI) {
puVar2 = (undefined8 *)
FUN_1800077a0(unaff_R14,unaff_EBP,0,unaff_RSI,pwVar11,uVar6,unaff_R12,unaff_R13B);
if ((char)puVar2 == '\0') {
iVar1 = *(int *)(unaff_RSI + 0x182);
if (iVar1 == 0x17) {
pwVar11 = L"ECDH_P256";
}
else if (iVar1 == 0x18) {
pwVar11 = L"ECDH_P384";
}
else {
if (iVar1 != 0x19) {
return (ulonglong)puVar2 & 0xffffffffffffff00;
}
pwVar11 = L"ECDH_P521";
}
uVar3 = FUN_1800077a0(unaff_R14,unaff_EBP,0,pwVar11,(wchar_t *)0x0,0,unaff_R12,unaff_R13B)
;
}
else {
LAB_180007c11:
uVar3 = CONCAT71((int7)((ulonglong)puVar2 >> 8),1);
}
return uVar3;
}
} while (puVar9[0xf] == uVar6);
if (*unaff_RDI <= uVar6) {
LAB_180007b45:
if ((unaff_R13B == '\0') || ((*(byte *)(puVar9 + 0x12) & 1) == 0)) {
piVar8 = *(int **)(puVar9 + 0x10);
piVar4 = piVar8 + (ulonglong)puVar9[0xf] * 0xc;
for (; piVar8 < piVar4; piVar8 = piVar8 + 0xc) {
if ((*piVar8 == (int)pwVar11) && (*(short *)(piVar8 + 2) == 8)) {
_Str1 = *(wchar_t **)(piVar8 + 4);
pwVar5 = L"ECDH";
iVar1 = wcsncmp(_Str1,L"ECDH",4);
pwVar10 = (wchar_t *)0x0;
pwVar11 = pwVar10;
if (iVar1 == 0) {
if (((piVar8[6] == 0) && (piVar8[10] == 0)) && (piVar8[0xb] == 0)) {
puVar2 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar2 = (undefined8 *)
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDH",0);
}
goto LAB_180007c11;
}
if (unaff_R15D != 0) {
if (piVar8[10] == 0) {
pwVar11 = (wchar_t *)0x0;
if (piVar8[0xb] == 0) goto LAB_180007b70;
}
else if (unaff_R15D < (uint)piVar8[10]) {
puVar2 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar2 = (undefined8 *)
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDH",
(char)unaff_R15D,0);
}
goto LAB_180007c11;
}
pwVar11 = pwVar10;
if (piVar8[0xb] != 0) {
uVar3 = FUN_180033ad3(_Str1,pwVar5,0,(char)uVar12,_param_5);
return uVar3;
}
}
}
}
LAB_180007b70:
piVar4 = (int *)((ulonglong)puVar9[0xf] * 0x30 + *(longlong *)(puVar9 + 0x10));
}
}
goto LAB_180007a73;
}
if (unaff_R12 != 0) {
uVar7 = (ulonglong)pwVar11 & 0xffffffff;
do {
iVar1 = RtlCompareUnicodeString(uVar7 * 0x10 + *(longlong *)(puVar9 + 0xc));
pwVar11 = (wchar_t *)0x0;
if (iVar1 == 0) goto LAB_180007b45;
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
} while (uVar6 < *unaff_RDI);
}
} while( true );
}
=========================================
Function at address: 0x180007c20
Called functions addresses: 0xEXTERNAL:0000003c 0x180007e0d 0x180033b6d 0x1800077a0 0xEXTERNAL:000000a7


ulonglong FUN_180007c20(uint *param_1,uint param_2,wchar_t *param_3,int param_4,uint param_5,
longlong param_6,char param_7)

{
int iVar1;
ulonglong uVar2;
undefined8 uVar3;
int *piVar4;
ulonglong uVar5;
uint uVar6;
int *piVar7;
uint *puVar8;
undefined uVar9;
wchar_t *pwVar10;
undefined4 in_stack_ffffffffffffffb0;

uVar2 = (ulonglong)(uint)param_4;
if ((param_2 == 0) || (param_1 == (uint *)0x0)) {
LAB_180007cf9:
uVar2 = (ulonglong)register0x00000020 & 0xffffffffffffff00;
}
else {
register0x00000020 = (BADSPACEBASE *)(param_1 + (ulonglong)param_2 * 10);
puVar8 = param_1;
if (param_1 < register0x00000020) {
do {
uVar5 = 0;
if (puVar8[5] != 0) {
if (*puVar8 == 0) {
LAB_180007d7d:
if ((param_7 == '\0') || ((*(byte *)(puVar8 + 8) & 1) == 0)) {
piVar7 = *(int **)(puVar8 + 6);
piVar4 = piVar7 + (ulonglong)puVar8[5] * 0xc;
for (; piVar7 < piVar4; piVar7 = piVar7 + 0xc) {
if ((*piVar7 == 1) && (*(short *)(piVar7 + 2) == 10)) {
pwVar10 = *(wchar_t **)(piVar7 + 4);
uVar9 = 5;
iVar1 = wcsncmp(pwVar10,L"ECDSA",5);
if (iVar1 == 0) {
if (((piVar7[6] == 0) && (piVar7[10] == 0)) && (piVar7[0xb] == 0)) {
register0x00000020 = (BADSPACEBASE *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
register0x00000020 =
(BADSPACEBASE *)
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDSA",1);
}
goto LAB_180007e40;
}
if (param_5 != 0) {
if (piVar7[10] == 0) {
if (piVar7[0xb] == 0) goto LAB_180007da8;
}
else if (param_5 < (uint)piVar7[10]) {
register0x00000020 = (BADSPACEBASE *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
register0x00000020 =
(BADSPACEBASE *)
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDSA",
(char)param_5,1);
}
goto LAB_180007e40;
}
if (piVar7[0xb] != 0) {
uVar3 = FUN_180033b6d(pwVar10,0,uVar9,(char)uVar2,in_stack_ffffffffffffffb0)
;
return uVar3;
}
}
}
}
LAB_180007da8:
piVar4 = (int *)((ulonglong)puVar8[5] * 0x30 + *(longlong *)(puVar8 + 6));
}
}
}
else if (param_6 != 0) {
do {
iVar1 = RtlCompareUnicodeString(uVar5 * 0x10 + *(longlong *)(puVar8 + 2),param_6,1);
if (iVar1 == 0) goto LAB_180007d7d;
uVar6 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar6;
} while (uVar6 < *puVar8);
}
}
puVar8 = puVar8 + 10;
} while (puVar8 < register0x00000020);
}
if ((param_3 != (wchar_t *)0x0) &&
(register0x00000020 =
(BADSPACEBASE *)
FUN_1800077a0(param_1,param_2,1,param_3,(wchar_t *)0x0,0,param_6,param_7),
(char)register0x00000020 != '\0')) {
LAB_180007e40:
return CONCAT71((int7)((ulonglong)register0x00000020 >> 8),1);
}
if (param_4 == 0x17) {
pwVar10 = L"ECDSA_P256";
}
else if (param_4 == 0x18) {
pwVar10 = L"ECDSA_P384";
}
else {
if (param_4 != 0x19) goto LAB_180007cf9;
pwVar10 = L"ECDSA_P521";
}
uVar2 = FUN_1800077a0(param_1,param_2,1,pwVar10,(wchar_t *)0x0,0,param_6,param_7);
}
return uVar2;
}
=========================================
Function at address: 0x180007e0d
Called functions addresses: 0x180007e0d


/* WARNING: Variable defined which should be unmapped: param_6 */

undefined8
FUN_180007e0d(undefined8 param_1,uint param_2,undefined param_3,byte param_4,undefined param_5,
undefined param_6,undefined param_7,uint *param_8)

{
int iVar1;
undefined8 uVar2;
int *piVar3;
wchar_t *pwVar4;
undefined4 in_register_00000014;
wchar_t *pwVar5;
uint uVar6;
ulonglong uVar7;
int *piVar8;
uint unaff_EBP;
int unaff_ESI;
uint *puVar9;
uint *unaff_RDI;
undefined uVar10;
ulonglong uVar11;
wchar_t *pwVar12;
longlong unaff_R12;
char unaff_R13B;
uint *unaff_R14;
uint unaff_R15D;
undefined3 in_stack_00000029;
wchar_t *in_stack_00000090;

uVar11 = (ulonglong)param_4;
pwVar5 = (wchar_t *)CONCAT44(in_register_00000014,param_2);
LAB_180007c9f:
do {
do {
puVar9 = unaff_RDI;
unaff_RDI = puVar9 + 10;
uVar6 = (uint)pwVar5;
if (param_8 <= unaff_RDI) {
if (in_stack_00000090 != (wchar_t *)0x0) {
param_8 = (uint *)FUN_1800077a0(unaff_R14,unaff_R15D,1,in_stack_00000090,pwVar5,uVar6,
unaff_R12,unaff_R13B);
pwVar5 = (wchar_t *)0x0;
if ((char)param_8 != '\0') {
LAB_180007e40:
return CONCAT71((int7)((ulonglong)param_8 >> 8),1);
}
}
if (unaff_ESI == 0x17) {
pwVar12 = L"ECDSA_P256";
}
else if (unaff_ESI == 0x18) {
pwVar12 = L"ECDSA_P384";
}
else {
if (unaff_ESI != 0x19) {
return (ulonglong)param_8 & 0xffffffffffffff00;
}
pwVar12 = L"ECDSA_P521";
}
uVar2 = FUN_1800077a0(unaff_R14,unaff_R15D,1,pwVar12,pwVar5,(uint)pwVar5,unaff_R12,
unaff_R13B);
return uVar2;
}
} while (puVar9[0xf] == uVar6);
if (*unaff_RDI <= uVar6) {
LAB_180007d7d:
if ((unaff_R13B == '\0') || ((*(byte *)(puVar9 + 0x12) & 1) == 0)) {
piVar8 = *(int **)(puVar9 + 0x10);
piVar3 = piVar8 + (ulonglong)puVar9[0xf] * 0xc;
for (; piVar8 < piVar3; piVar8 = piVar8 + 0xc) {
if ((*piVar8 == 1) && (*(short *)(piVar8 + 2) == 10)) {
pwVar12 = *(wchar_t **)(piVar8 + 4);
uVar10 = 5;
iVar1 = wcsncmp(pwVar12,L"ECDSA",5);
pwVar4 = (wchar_t *)0x0;
pwVar5 = pwVar4;
if (iVar1 == 0) {
if (((piVar8[6] == 0) && (piVar8[10] == 0)) && (piVar8[0xb] == 0)) {
param_8 = (uint *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_8 = (uint *)FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDSA",1);
}
goto LAB_180007e40;
}
if (unaff_EBP != 0) {
if (piVar8[10] == 0) {
pwVar5 = (wchar_t *)0x0;
if (piVar8[0xb] == 0) goto LAB_180007da8;
}
else if (unaff_EBP < (uint)piVar8[10]) {
param_8 = (uint *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_8 = (uint *)FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDSA",
(char)unaff_EBP,1);
}
goto LAB_180007e40;
}
pwVar5 = pwVar4;
if (piVar8[0xb] != 0) {
uVar2 = FUN_180033b6d(pwVar12,0,uVar10,(char)uVar11,_param_5);
return uVar2;
}
}
}
}
LAB_180007da8:
piVar3 = (int *)((ulonglong)puVar9[0xf] * 0x30 + *(longlong *)(puVar9 + 0x10));
}
}
goto LAB_180007c9f;
}
if (unaff_R12 != 0) {
uVar7 = (ulonglong)pwVar5 & 0xffffffff;
do {
iVar1 = RtlCompareUnicodeString(uVar7 * 0x10 + *(longlong *)(puVar9 + 0xc));
pwVar5 = (wchar_t *)0x0;
if (iVar1 == 0) goto LAB_180007d7d;
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
} while (uVar6 < *unaff_RDI);
}
} while( true );
}
=========================================
Function at address: 0x180007e50
Called functions addresses: 0x180007eb0


undefined8
FUN_180007e50(uint param_1,undefined8 *param_2,undefined4 *param_3,undefined8 param_4,
undefined8 param_5,undefined4 *param_6)

{
undefined8 uVar1;

if (param_3 != (undefined4 *)0x0) {
*param_3 = 0;
}
if (param_2 != (undefined8 *)0x0) {
*param_2 = 0;
}
if (param_6 != (undefined4 *)0x0) {
*param_6 = 0;
}
if ((param_1 < DAT_180092324) && ((undefined8 *)(&DAT_180092330)[param_1] != (undefined8 *)0x0)) {
uVar1 = FUN_180007eb0((undefined8 *)(&DAT_180092330)[param_1],param_2,param_3,param_2,
(undefined4 *)0x0,param_6);
return uVar1;
}
return 0x490;
}
=========================================
Function at address: 0x180007eb0
Called functions addresses: None


undefined8
FUN_180007eb0(undefined8 *param_1,undefined8 *param_2,undefined4 *param_3,undefined8 param_4,
undefined4 *param_5,undefined4 *param_6)

{
if (param_3 != (undefined4 *)0x0) {
*param_3 = *(undefined4 *)(param_1 + 1);
}
if (param_5 != (undefined4 *)0x0) {
*param_5 = *(undefined4 *)(param_1 + 2);
}
if (param_2 != (undefined8 *)0x0) {
*param_2 = *param_1;
}
if (param_6 != (undefined4 *)0x0) {
*param_6 = *(undefined4 *)((longlong)param_1 + 0x14);
}
return 0;
}
=========================================
Function at address: 0x180007ef4
Called functions addresses: 0xEXTERNAL:00000152 0x1800281b8 0x180028070 0x180006ccc


void FUN_180007ef4(ushort *param_1,PCCERT_CONTEXT param_2)

{
code *pcVar1;
BOOL BVar2;
ulonglong uVar3;
undefined auStack_c8 [32];
DWORD local_a8 [2];
undefined2 *local_a0;
undefined2 local_98 [64];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_c8;
local_a8[0] = 0x80;
local_a0 = local_98;
BVar2 = CertGetCertificateContextProperty(param_2,0x59,local_98,local_a8);
if ((BVar2 != 0) && ((local_a8[0] >> 1) - 1 < 0x40)) {
uVar3 = (ulonglong)((local_a8[0] >> 1) - 1);
if (0x7f < uVar3 * 2) {
FUN_1800281b8();
pcVar1 = (code *)swi(3);
(*pcVar1)();
return;
}
local_98[uVar3] = 0;
FUN_180006ccc(param_1,&local_a0,1,'\0');
}
FUN_180028070(local_18 ^ (ulonglong)auStack_c8);
return;
}
=========================================
Function at address: 0x180007fac
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0x180014db8 0x180007ef4 0x18002a7c0 0xEXTERNAL:00000137 0x18000a1f4 0x18001588c 0x180015828 0x180028070 0x18000909c 0x18005cc0c 0x180041cb0 0xEXTERNAL:00000147 0x18005b470 0x180053000 0x18002a77b 0x1800102dc 0xEXTERNAL:0000012b


void FUN_180007fac(longlong *param_1,byte *param_2,uint param_3)

{
char cVar1;
BOOL BVar2;
int iVar3;
longlong lVar4;
PCCERT_CONTEXT pCertContext;
ulonglong uVar5;
uint *puVar6;
int *piVar7;
wchar_t *pwVar8;
uint uVar9;
longlong lVar10;
undefined4 uVar11;
undefined4 uVar12;
uint uVar13;
DWORD cbCertEncoded;
undefined uVar14;
byte *pbVar15;
wchar_t *pwVar16;
uint uVar17;
uint *puVar18;
undefined auStackY_c8 [32];
int local_84;
longlong *local_80;
byte *local_78;
byte *local_70;
ushort local_68 [20];
ulonglong local_40;

local_40 = DAT_180091970 ^ (ulonglong)auStackY_c8;
local_68[0] = 0;
local_68[1] = 0;
local_68[2] = 0;
local_68[3] = 0;
local_68[4] = 0;
local_68[5] = 0;
local_68[6] = 0;
local_68[7] = 0;
local_68[8] = 0;
local_68[9] = 0;
local_68[10] = 0;
local_68[0xb] = 0;
local_68[0xc] = 0;
local_68[0xd] = 0;
local_68[0xe] = 0;
local_68[0xf] = 0;
local_68[0x10] = 0;
local_68[0x11] = 0;
if (2 < param_3) {
pbVar15 = param_2 + 3;
uVar13 = (uint)param_2[1] * 0x100 + (uint)*param_2 * 0x10000 + (uint)param_2[2];
local_70 = pbVar15;
if (param_3 == uVar13 + 3) {
if (uVar13 != 0) {
RtlAcquireResourceExclusive(param_1[0xb] + 0x48,1);
lVar4 = param_1[0xb];
if (*(HLOCAL *)(lVar4 + 0x18) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(lVar4 + 0x18));
lVar4 = param_1[0xb];
*(undefined4 *)(lVar4 + 0x20) = 0;
*(undefined8 *)(lVar4 + 0x18) = 0;
lVar4 = param_1[0xb];
}
if (*(HLOCAL *)(lVar4 + 0x28) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(lVar4 + 0x28));
*(undefined8 *)(param_1[0xb] + 0x28) = 0;
lVar4 = param_1[0xb];
}
if (*(PCCERT_CONTEXT *)(lVar4 + 0x30) != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(*(PCCERT_CONTEXT *)(lVar4 + 0x30));
*(undefined8 *)(param_1[0xb] + 0x30) = 0;
}
local_84 = 0;
uVar9 = uVar13;
do {
if (uVar9 < 4) {
LAB_180033e9f:
RtlReleaseResource(param_1[0xb] + 0x48);
goto LAB_180033eb6;
}
cbCertEncoded = (uint)pbVar15[1] * 0x100 + (uint)*pbVar15 * 0x10000 + (uint)pbVar15[2];
if (uVar9 < cbCertEncoded + 3) goto LAB_180033e9f;
local_78 = pbVar15 + (cbCertEncoded + 3);
uVar9 = uVar9 + (-3 - cbCertEncoded);
pCertContext = CertCreateCertificateContext(1,pbVar15 + 3,cbCertEncoded);
if (pCertContext == (PCCERT_CONTEXT)0x0) goto LAB_180033e9f;
if ((*(uint *)(param_1 + 8) & 0xc0c00) == 0) {
LAB_18000812d:
if (local_84 != 0) goto LAB_1800082e9;
local_80 = (longlong *)0x0;
uVar5 = FUN_180014db8((longlong)pCertContext,&local_80,(int *)0x0);
if ((int)uVar5 != 0) {
RtlReleaseResource(param_1[0xb] + 0x48);
uVar12 = 0x80090308;
LAB_180033ddc:
uVar11 = 0xfb;
uVar14 = 0x2b;
LAB_180033e1f:
FUN_18005b470(param_1,uVar11,uVar12,uVar14);
LAB_180033e27:
CertFreeCertificateContext(pCertContext);
goto LAB_1800082bb;
}
lVar4 = param_1[1];
uVar17 = *(uint *)(param_1 + 8) & 0x40051555;
if (lVar4 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x33,&DAT_180082c58);
}
RtlReleaseResource(param_1[0xb] + 0x48);
uVar14 = 0x50;
uVar12 = 0xc00000e5;
uVar11 = 0xfe;
goto LAB_180033e1f;
}
lVar10 = param_1[10];
if (*(int *)(lVar10 + 0xc4) != 0) {
piVar7 = (int *)0x0;
if (uVar17 != 0) {

lVar10 = param_1[10];
}
iVar3 = FUN_1800102dc(*(uint **)(lVar10 + 200),*(uint *)(lVar10 + 0xc4),pCertContext,
local_80,piVar7,lVar4,uVar17 != 0);
if (iVar3 == 0) goto LAB_1800081b9;
RtlReleaseResource(param_1[0xb] + 0x48);
if (iVar3 == -0x7ff6fccf) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x34,&DAT_180082c58);
}
uVar12 = 0x80090331;
goto LAB_180033ddc;
}
goto LAB_180033e27;
}
LAB_1800081b9:
if ((uVar17 == 0) &&
(uVar5 = FUN_18001588c(*(int *)(lVar4 + 0x20),*(int *)(lVar4 + 0x24),
(longlong)pCertContext), (int)uVar5 == 0)) {

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
pwVar16 = L"NULL";
if (pwVar8 != (wchar_t *)0x0) {
pwVar16 = pwVar8;
}
FUN_18005cc0c(DAT_180091000[2],0x35,&DAT_180082c58,pwVar16,
(char)*(undefined4 *)(lVar4 + 0x20),
(char)*(undefined4 *)(lVar4 + 0x24));
}
FUN_180053000((ulonglong)*(uint *)(lVar4 + 0x20),*(undefined4 *)(lVar4 + 0x24),pwVar8)
;
}
*(longlong **)(param_1[0xb] + 0x28) = local_80;
*(PCCERT_CONTEXT *)(param_1[0xb] + 0x30) = pCertContext;
}
else {
if ((local_84 == 0) ||
(BVar2 = CertCompareCertificateName
(pCertContext->dwCertEncodingType,&pCertContext->pCertInfo->Issuer
,&pCertContext->pCertInfo->Subject), BVar2 == 0)) {
cVar1 = FUN_180007ef4(local_68,pCertContext);
if (cVar1 != '\0') goto LAB_18000812d;
RtlReleaseResource(param_1[0xb] + 0x48);
FUN_18005b470(param_1,0xfc,0x80090308,0x2b);
CertFreeCertificateContext(pCertContext);
goto LAB_1800082bb;
}
LAB_1800082e9:
CertFreeCertificateContext(pCertContext);
}
local_84 = local_84 + 1;
pbVar15 = local_78;
} while (uVar9 != 0);
if (((*(uint *)(param_1 + 8) & 0xc0c00) == 0) ||
(uVar5 = FUN_180015828((longlong)param_1 + 0x1da,(short *)local_68), (char)uVar5 != '\0')
) {
uVar9 = local_84 + uVar13;
puVar6 = (uint *)FUN_18000a1f4((ulonglong)uVar9);
pbVar15 = local_70;
puVar18 = puVar6;
if (puVar6 == (uint *)0x0) {
RtlReleaseResource(param_1[0xb] + 0x48);
}
else {
do {
uVar17 = (uint)pbVar15[1] * 0x100 + (uint)*pbVar15 * 0x10000 + (uint)pbVar15[2];
*puVar18 = uVar17;
uVar13 = uVar13 + (-3 - uVar17);
memcpy(puVar18 + 1,pbVar15 + 3,(ulonglong)uVar17);
pbVar15 = pbVar15 + (uVar17 + 3);
puVar18 = (uint *)((longlong)puVar18 + (ulonglong)uVar17 + 4);
} while (uVar13 != 0);
lVar4 = param_1[0xb];
*(uint *)(lVar4 + 0x20) = uVar9;
*(uint **)(lVar4 + 0x18) = puVar6;
RtlReleaseResource(param_1[0xb] + 0x48);
}
}
else {
RtlReleaseResource(param_1[0xb] + 0x48);
FUN_18005b470(param_1,0xfc,0x80090308,0x28);
}
goto LAB_1800082bb;
}
if ((*(uint *)(param_1 + 8) & 0x800a2aaa) == 0) {
*(undefined *)(param_1 + 0x45) = 1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x32,&DAT_180082c58);
}
goto LAB_1800082bb;
}
}
}
LAB_180033eb6:
FUN_18005b470(param_1,0xfa,0x80090308,0x2a);
LAB_1800082bb:
FUN_180028070(local_40 ^ (ulonglong)auStackY_c8);
return;
}
=========================================
Function at address: 0x180008310
Called functions addresses: 0x18001686c 0x1800077a0 0x180007c20


undefined8
FUN_180008310(uint *param_1,uint param_2,int param_3,uint param_4,wchar_t *param_5,char param_6,
char param_7,wchar_t *param_8,wchar_t *param_9,longlong param_10,char param_11)

{
char cVar1;
ulonglong in_RAX;
undefined8 uVar2;

if ((((param_2 == 0) || (param_1 == (uint *)0x0)) || (param_3 == 0)) ||
((param_8 == (wchar_t *)0x0 || (param_9 == (wchar_t *)0x0)))) {
return in_RAX & 0xffffffffffffff00;
}
if (param_3 == 0x2203) {
if (param_5 == (wchar_t *)0x0) goto LAB_1800083e8;
uVar2 = FUN_180007c20(param_1,param_2,param_5,*(int *)(param_5 + 0x182),param_4,param_10,
param_11);
LAB_1800083e0:
if ((char)uVar2 != '\0') goto LAB_18000849f;
}
else {
if (param_3 == 0x2200) {
uVar2 = FUN_1800077a0(param_1,param_2,1,L"DSA",(wchar_t *)0x0,param_4,param_10,param_11);
goto LAB_1800083e0;
}
if ((param_3 - 0x2400U & 0xffff7fff) == 0) {
cVar1 = '\0';
if ((param_6 != '\0') && (param_3 == 0xa400)) {
uVar2 = FUN_18001686c(param_1,param_2,0,param_4,param_10,param_11);
cVar1 = (char)uVar2;
if ((param_7 == '\0') && (cVar1 != '\0')) goto LAB_18000849f;
}
uVar2 = FUN_18001686c(param_1,param_2,1,param_4,param_10,param_11);
if ((param_7 == '\0') || (cVar1 != '\0')) goto LAB_1800083e0;
}
}
LAB_1800083e8:
uVar2 = FUN_1800077a0(param_1,param_2,4,param_8,(wchar_t *)0x0,0,0,'\x01');
if ((char)uVar2 == '\0') {
uVar2 = FUN_1800077a0(param_1,param_2,4,param_9,(wchar_t *)0x0,0,0,'\x01');
return uVar2;
}
LAB_18000849f:
return CONCAT71((int7)((ulonglong)uVar2 >> 8),1);
}
=========================================
Function at address: 0x1800084b0
Called functions addresses: 0xEXTERNAL:000000c0 0x180007410 0xEXTERNAL:000000c2


char FUN_1800084b0(undefined8 param_1,int *param_2,uint param_3,uint param_4,uint param_5,
int param_6,uint param_7,uint param_8,uint param_9,char param_10,uint *param_11,
uint param_12)

{
uint uVar1;
longlong lVar2;
char cVar3;
longlong *plVar4;
ulonglong uVar5;
uint uVar6;
ulonglong uVar7;

cVar3 = '\0';
RtlAcquireResourceShared(&DAT_180092428,1);
plVar4 = DAT_1800925b0;
if (param_10 != '\0') {
plVar4 = DAT_1800925b8;
}
if (plVar4 != (longlong *)0x0) {
uVar1 = *(uint *)(plVar4 + 1);
uVar7 = 0;
lVar2 = *plVar4;
if (uVar1 != 0) {
do {
if (cVar3 != '\0') break;
uVar5 = FUN_180007410(&DAT_180092420,param_2,(ulonglong)param_3,param_4,param_5,param_6,
param_7,param_8,param_9,uVar7 * 0x360 + lVar2,0,param_11,param_12,
'\x01');
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
cVar3 = (char)uVar5;
} while (uVar6 < uVar1);
}
}
RtlReleaseResource(&DAT_180092428);
return cVar3;
}
=========================================
Function at address: 0x180008600
Called functions addresses: 0x180003df0 0xEXTERNAL:000000f4 0xEXTERNAL:000000f6 0x180006e00 0xEXTERNAL:000000f5 0xEXTERNAL:0000011c 0x180028070


void FUN_180008600(longlong param_1,char param_2)

{
longlong lVar1;
undefined2 uVar2;
ulonglong *puVar3;
longlong lVar4;
int iVar5;
ulonglong uVar6;
undefined4 uVar7;
uint uVar8;
uint uVar9;
ulonglong uVar10;
ulonglong uVar11;
undefined auStackY_178 [32];
uint local_148 [4];
longlong local_138 [16];
undefined local_b8 [126];
undefined2 local_3a;
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_178;
puVar3 = *(ulonglong **)(param_1 + 8);
uVar10 = 0;
uVar11 = uVar10;
if (puVar3 != (ulonglong *)0x0) {
uVar11 = *puVar3;
}
uVar2 = *(undefined2 *)(param_1 + 0x22);
uVar7 = 0;
if (((*(byte *)(param_1 + 0x20) & 1) != 0) && (puVar3 != (ulonglong *)0x0)) {
uVar7 = *(undefined4 *)((longlong)puVar3 + 0x1c);
}
if (*(int *)(param_1 + 0x224) != 0) {
do {
lVar1 = param_1 + uVar10 * 8;
lVar4 = *(longlong *)(lVar1 + 0x250);
if (lVar4 != 0) {
SslFreeObject(lVar4,0);
*(undefined8 *)(lVar1 + 0x250) = 0;
}
uVar9 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar9;
} while (uVar9 < *(uint *)(param_1 + 0x224));
}
*(undefined4 *)(param_1 + 0x2d0) = 0;
*(undefined4 *)(param_1 + 0x224) = 0;
iVar5 = SslCreateHandshakeHash(uVar11,param_1 + 0x250,uVar2,uVar7);
if (iVar5 == 0) {
uVar10 = 1;
*(undefined4 *)(param_1 + 0x224) = 1;
if (param_2 != '\0') {
local_148[0] = 0;
iVar5 = SslGetCipherSuitePRFHashAlgorithm(uVar11,uVar2,uVar7,0);
if (iVar5 == 0) {
local_3a = 0;
uVar6 = FUN_180006e00(param_1 + 0x1da,local_b8,*(uint *)(param_1 + 0x40),
(undefined4 *)(param_1 + 0x2d0),local_138,local_148);
uVar9 = local_148[0];
if ((int)uVar6 == 0) {
if (1 < local_148[0]) {
do {
iVar5 = SslCreateClientAuthHash(uVar11,param_1 + 0x250 + uVar10 * 8,uVar2,uVar7);
if (iVar5 != 0) goto LAB_180033fb6;
uVar8 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar8;
*(uint *)(param_1 + 0x224) = uVar8;
} while (uVar8 < uVar9);
}
goto LAB_1800086ba;
}
}
LAB_180033fb6:
FUN_180003df0(param_1);
}
}
LAB_1800086ba:
FUN_180028070(local_38 ^ (ulonglong)auStackY_178);
return;
}
=========================================
Function at address: 0x1800087d0
Called functions addresses: 0x180007410 0xEXTERNAL:000000c0 0x180041cb0 0x180044bcc 0x180008948 0xEXTERNAL:000000c2


undefined4 FUN_1800087d0(undefined8 param_1,longlong *param_2,int param_3)

{
uint uVar1;
uint uVar2;
uint uVar3;
longlong lVar4;
int *piVar5;
uint uVar6;
undefined4 uVar7;
undefined8 *puVar8;
ulonglong uVar9;
longlong *plVar10;

lVar4 = param_2[10];
uVar1 = *(uint *)(param_2 + 8);
piVar5 = *(int **)(lVar4 + 0xb8);
uVar2 = *(uint *)(lVar4 + 0xb0);
uVar3 = *(uint *)(lVar4 + 0xc0);
RtlAcquireResourceShared(&DAT_180092428);
puVar8 = DAT_1800925b0;
if ((*(uint *)(param_2 + 0x11) >> 0x1d & 1) != 0) {
puVar8 = DAT_1800925b8;
}
uVar6 = 0;
if (puVar8 != (undefined8 *)0x0) {
plVar10 = (longlong *)*puVar8;
if (*(uint *)(puVar8 + 1) != 0) {
do {
if (*(int *)((longlong)plVar10 + 0x1c) == param_3) {
uVar9 = FUN_180007410(&DAT_180092420,piVar5,(ulonglong)uVar2,uVar3,
*(uint *)(lVar4 + 0x9c) >> 0xc & 1,*(uint *)(lVar4 + 0x9c) & 0x800,
*(uint *)(lVar4 + 0xa8),*(uint *)(lVar4 + 0xa4),uVar1,
(longlong)plVar10,0,(uint *)0x0,0,'\x01');
if ((char)uVar9 != '\0') {
if (plVar10[0x6a] != 0) {
LOCK();
piVar5 = (int *)(*(longlong *)(plVar10[0x6a] + 0x10) + 0xc);
*piVar5 = *piVar5 + 1;
UNLOCK();
}
LOCK();
*(int *)(plVar10[0x6b] + 0xc) = *(int *)(plVar10[0x6b] + 0xc) + 1;
UNLOCK();
uVar7 = FUN_180008948(param_2,plVar10);
RtlReleaseResource(&DAT_180092428);
return uVar7;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3a,&DAT_180085700);
}
break;
}
uVar6 = uVar6 + 1;
plVar10 = plVar10 + 0x6c;
} while (uVar6 < *(uint *)(puVar8 + 1));
}
}
RtlReleaseResource(&DAT_180092428);
FUN_180044bcc(*(uint *)(lVar4 + 0xd4),lVar4 + 0xd8,uVar1);
return 0x80090331;
}
=========================================
Function at address: 0x180008948
Called functions addresses: 0x180003ce4 0x18002a7c0 0xEXTERNAL:0000010c 0x1800209bc 0x180028070 0xEXTERNAL:00000075 0x180003d20 0x18005fe8c


void FUN_180008948(longlong *param_1,longlong *param_2)

{
longlong *plVar1;
int iVar2;
longlong lVar3;
longlong lVar4;
undefined auStack_78 [32];
undefined4 *local_58;
undefined4 local_50;
undefined4 local_48;
undefined4 local_38;
undefined4 uStack_34;
undefined4 uStack_30;
uint uStack_2c;
undefined4 uStack_28;
ulonglong local_20;

local_20 = DAT_180091970 ^ (ulonglong)auStack_78;

lVar4 = param_1[1];
if (lVar4 != 0) {
if (*(longlong *)(lVar4 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar4 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar4 + 0x358));
}
plVar1 = param_1 + 3;
if ((longlong *)*plVar1 != (longlong *)0x0) {
FUN_1800209bc((longlong *)*plVar1);
*plVar1 = 0;
}
if (lVar3 != 0) {
FUN_18005fe8c(lVar3,*param_2,plVar1);
}
if ((*(uint *)(param_1 + 8) & 0xf3f00) == 0) {
uStack_34 = 0;
uStack_2c = 0;
uStack_28 = 0;
uStack_30 = *(undefined4 *)(param_2 + 2);
local_38 = 0x14;
if (1 < *(uint *)((longlong)param_2 + 0xc)) {
uStack_28 = 1;
uStack_2c = *(uint *)((longlong)param_2 + 0xc);
}
}
else {
local_48 = 0;
local_58 = &local_38;
local_50 = 0x14;
iVar2 = SslLookupCipherLengths
(*param_2,*(undefined2 *)((longlong)param_1 + 0x22),
*(undefined4 *)((longlong)param_2 + 0x1c),*(undefined4 *)(param_1 + 2));
if (iVar2 != 0) goto LAB_180008a17;
}
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(lVar4 = RtlCompareMemory(&local_38,param_1 + 5,0x14), lVar4 == 0x14)) {
param_1[5] = CONCAT44(uStack_34,local_38);
param_1[6] = CONCAT44(uStack_2c,uStack_30);
*(undefined4 *)(param_1 + 7) = uStack_28;
}
LAB_180008a17:
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 1;
param_1[1] = (longlong)param_2;
FUN_180028070(local_20 ^ (ulonglong)auStack_78);
return;
}
=========================================
Function at address: 0x180008a4c
Called functions addresses: 0xEXTERNAL:000000c0 0x18002a7c0 0x18000a7d4 0x180041cb0 0x18000a1d0 0x180009670 0x180009470 0x18000a534 0x18002a77b 0x180008da0 0x180009e8c 0xEXTERNAL:000000c2


ulonglong FUN_180008a4c(longlong *param_1,undefined *param_2,uint *param_3)

{
longlong lVar1;
char cVar2;
ushort uVar3;
undefined2 uVar4;
uint uVar5;
int iVar6;
undefined8 uVar7;
ulonglong uVar8;
ulonglong uVar9;
void *_Dst;
uint uVar10;
undefined *puVar11;
uint uVar12;
uint uVar13;
uint uVar14;
byte local_res8;
uint local_res20 [2];
uint local_88;
uint local_84;
undefined **local_78;
longlong *local_70;
undefined8 local_68;
undefined4 local_60;
undefined local_58;
undefined8 local_50;
undefined4 local_48;
undefined local_44;
longlong *local_40;

local_68 = 0;
local_78 = &PTR_FUN_18007d048;
local_60 = 0;
local_58 = 0;
local_50 = 0;
local_48 = 0;
local_44 = *(undefined *)((longlong)param_1 + 0x39a);
local_84 = 0;
local_res20[0] = 0;
if ((*(char *)((longlong)param_1 + 0xe9) == '\0') && ((*(byte *)(param_1 + 4) & 4) != 0)) {
local_88 = *(uint *)((longlong)param_1 + 0x2c);
}
else {
local_88 = 0;
}
local_res8 = 0;
uVar5 = *(uint *)((longlong)param_1 + 0x3c);
uVar12 = (-(uint)(*(char *)((longlong)param_1 + 0xe9) != '\0') & 8) + 4;
local_70 = param_1;
local_40 = param_1;
if (param_1[0xa5] != 0) {
RtlAcquireResourceShared(param_1[0xa5] + 0x48,1);
}
uVar8 = FUN_180009670((longlong)&local_78,(int *)local_res20);
if ((int)uVar8 == 0) {
cVar2 = *(char *)((longlong)param_1 + 0xe9);
uVar14 = 0;
if (cVar2 != '\0') {
if (*(int *)((longlong)param_1 + 0x51c) == 0) {
local_84 = 0;
uVar14 = 0;
}
else {
local_84 = (uint)*(byte *)(param_1 + 0xa4);
uVar14 = (uint)*(byte *)(param_1 + 0xa4);
}
}
uVar13 = *(int *)(param_2 + 8) + 0x27 + uVar12 + *(int *)(param_2 + 4) * 2 + local_res20[0];
if (cVar2 != '\0') {
uVar13 = uVar13 + 1 + uVar14;
}
if ((((*(uint *)(param_1 + 8) & 0x2a88) == 0) && ((*(byte *)(param_1 + 8) & 0x20) != 0)) &&
(local_res20[0] == 0)) {
uVar13 = uVar13 + 2;
local_res8 = 1;
}
if (cVar2 == '\0') {
uVar14 = uVar13;
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar10 = *(uint *)((longlong)param_1 + 0x34);
uVar14 = *(int *)(param_1 + 6) + uVar13;
if (uVar10 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar10 = uVar10 - uVar14 % uVar10;
}
uVar14 = uVar14 + uVar10;
}
uVar14 = uVar14 + *(int *)((longlong)param_1 + 0x2c);
}
uVar14 = uVar14 + *(int *)((longlong)param_1 + 0x3c);
}
else {
uVar14 = uVar13 + uVar5;
}
uVar8 = FUN_180009e8c((longlong)param_1,param_3,uVar14);
if ((int)uVar8 == 0) {
puVar11 = (undefined *)
((ulonglong)uVar12 + (ulonglong)local_88 + (ulonglong)uVar5 +
*(longlong *)(param_3 + 2));
*puVar11 = param_2[1];
puVar11[1] = *param_2;
uVar7 = *(undefined8 *)(param_2 + 0x38);
*(undefined8 *)(puVar11 + 2) = *(undefined8 *)(param_2 + 0x30);
*(undefined8 *)(puVar11 + 10) = uVar7;
uVar7 = *(undefined8 *)(param_2 + 0x48);
*(undefined8 *)(puVar11 + 0x12) = *(undefined8 *)(param_2 + 0x40);
*(undefined8 *)(puVar11 + 0x1a) = uVar7;
puVar11[0x22] = param_2[8];
memcpy(puVar11 + 0x23,param_2 + 0x10,(ulonglong)*(uint *)(param_2 + 8));
puVar11 = puVar11 + 0x23 + *(uint *)(param_2 + 8);
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
*puVar11 = (char)local_84;
puVar11 = puVar11 + 1;
if ((*(int *)((longlong)param_1 + 0x51c) == 0) || (local_84 == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180086390);
}
}
else {
memcpy(puVar11,(void *)((longlong)param_1 + 0x41c),(ulonglong)local_84);
puVar11 = puVar11 + local_84;
}
}
uVar8 = 0;
iVar6 = ((uint)local_res8 + *(int *)(param_2 + 4)) * 2;
*puVar11 = (char)((uint)iVar6 >> 8);
puVar11[1] = (char)iVar6;
puVar11 = puVar11 + 2;
if (*(int *)(param_2 + 4) != 0) {
do {
*puVar11 = param_2[uVar8 * 4 + 0x51];
lVar1 = uVar8 * 4;
uVar10 = (int)uVar8 + 1;
uVar8 = (ulonglong)uVar10;
puVar11[1] = param_2[lVar1 + 0x50];
puVar11 = puVar11 + 2;
} while (uVar10 < *(uint *)(param_2 + 4));
}
if (local_res8 != 0) {
*puVar11 = 0;
puVar11[1] = 0xff;
puVar11 = puVar11 + 2;
}
*puVar11 = 1;
puVar11[1] = 0;
uVar9 = FUN_18000a7d4((longlong)&local_78,local_res20[0],puVar11 + 2,local_res20);
if (param_1[0xa5] != 0) {
RtlReleaseResource(param_1[0xa5] + 0x48);
}
uVar8 = uVar9 & 0xffffffff;
if ((int)uVar9 == 0) {
uVar3 = *(ushort *)((longlong)param_1 + 0xdc);
*(ushort *)((longlong)param_1 + 0xdc) = uVar3 + 1;
FUN_18000a534((undefined *)
((ulonglong)local_88 + (ulonglong)uVar5 + *(longlong *)(param_3 + 2)),1,
(void *)0x0,uVar13 - uVar12 & 0xffff,(uint)uVar3,
(uint)*(byte *)((longlong)param_1 + 0xe9));
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(uint *)(param_1 + 0x6d) = uVar13;
_Dst = (void *)FUN_18000a1d0((longlong)param_1,uVar13);
param_1[0x6e] = (longlong)_Dst;
if (_Dst == (void *)0x0) {
uVar8 = 0xe;
}
else {
memcpy(_Dst,(void *)((ulonglong)local_88 + (ulonglong)uVar5 + *(longlong *)(param_3 + 2)),
(ulonglong)*(uint *)(param_1 + 0x6d));
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
uVar8 = FUN_180009470(param_1,param_3,0x16,uVar13);
uVar8 = uVar8 & 0xffffffff;
}
else {
uVar4 = *(undefined2 *)((longlong)param_1 + 0x22);
puVar11 = *(undefined **)(param_3 + 2);
puVar11[0xc] = (char)uVar13;
puVar11[0xb] = (char)(uVar13 >> 8);
puVar11[1] = (char)((ushort)uVar4 >> 8);
puVar11[2] = (char)uVar4;
*puVar11 = 0x16;
param_3[1] = param_3[1] + uVar14;
uVar8 = 0;
}
}
}
goto LAB_180008d73;
}
}
uVar8 = uVar8 & 0xffffffff;
if (param_1[0xa5] != 0) {
RtlReleaseResource(param_1[0xa5] + 0x48);
}
LAB_180008d73:
FUN_180008da0(&local_78);
return uVar8;
}
=========================================
Function at address: 0x180008da0
Called functions addresses: 0x18000909c


void FUN_180008da0(undefined8 *param_1)

{
*param_1 = &PTR_FUN_18007d048;
if ((HLOCAL)param_1[5] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[5]);
}
*param_1 = &PTR_FUN_18007d038;
return;
}
=========================================
Function at address: 0x180008de0
Called functions addresses: 0x18004312c 0x18002a7c0 0x1800272fc 0x18005df3c 0x180029f58 0x180028070 0x18004461c 0x18000909c 0x180041e9c


void FUN_180008de0(undefined *param_1,undefined8 param_2,undefined *param_3)

{
uint uVar1;
uint uVar2;
char cVar3;
ushort uVar4;
wchar_t *pwVar5;
undefined8 *puVar6;
undefined8 uVar7;
HLOCAL pvVar8;
longlong lVar9;
undefined *puVar10;
int iVar11;
wchar_t *pwVar12;
bool bVar13;
undefined auStackY_88 [32];
undefined8 local_48;
ulonglong uStack_40;
undefined8 local_38;
uint local_30 [2];
longlong local_28;
ulonglong local_20;

local_20 = DAT_180091970 ^ (ulonglong)auStackY_88;

puVar6 = *(undefined8 **)(param_1 + 8);
lVar9 = puVar6[10];
if ((lVar9 != 0) && (DAT_180092620 != 0)) {
local_48 = 0;
uStack_40 = 0;
local_38 = 0;
iVar11 = 8;
puVar6 = &local_48;

if ((cVar3 != '\0') && ((uStack_40 & 0x40) != 0)) {
iVar11 = 4;
}
uVar1 = *(uint *)(lVar9 + 0x2e0);
if (1 < uVar1) {
local_28 = 0;
local_30[1] = 0;
local_30[0] = uVar1 * iVar11 * 2;
puVar6 = (undefined8 *)(ulonglong)local_30[0];

if (local_28 != 0) {
param_2 = 0;
param_3 = (undefined *)0x0;
puVar6 = (undefined8 *)0x5;

}
}
}
if (((byte)DAT_180092f00 & 1) != 0) {
pwVar12 = L"";
if (pwVar5 != (wchar_t *)0x0) {
pwVar12 = pwVar5;
}
param_3 = param_1;
FUN_18004461c(puVar6,param_2,param_1,pwVar12);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_3 = &DAT_180084d00;
FUN_180041e9c(DAT_180091000[2],0x34,&DAT_180084d00,param_1);
}
lVar9 = *(longlong *)(param_1 + 8);
uVar1 = *(uint *)(lVar9 + 0x40);
iVar11 = *(int *)(lVar9 + 0x44);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_3 = &DAT_180082b58;
FUN_180041e9c(DAT_180091000[2],0x12,&DAT_180082b58,param_1);
lVar9 = *(longlong *)(param_1 + 8);
}
if (lVar9 != 0) {
uVar2 = *(uint *)(lVar9 + 0x40);

if ((uVar2 & 0x800a2aaa) != 0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 8));
}
*(undefined8 *)(param_1 + 8) = 0;
}
if ((uVar1 & 0x51550) == 0) {
FUN_18000909c(param_1);
goto LAB_180008f53;
}
lVar9 = *(longlong *)(param_1 + 0x18);
cVar3 = param_1[0x20];
if (lVar9 != 0) {
if (iVar11 == 4) {

if (DAT_180092db8 <= uVar4) {
DAT_180092db8 = (uint)uVar4;
}
LOCK();
iVar11 = DAT_180092db4 + 1;
UNLOCK();
bVar13 = DAT_180092db4 == 99;
DAT_180092db4 = iVar11;
if ((bVar13) && (DAT_180092dd8 != (undefined8 *)0x0)) {
DAT_180092dc0 = DAT_180092db8;
if (DAT_180092de0 == 0) {
puVar6 = (undefined8 *)FUN_180029f58(0x50);
if (puVar6 != (undefined8 *)0x0) {
param_3 = (undefined *)CONCAT71((int7)((ulonglong)param_3 >> 8),1);
puVar6 = FUN_1800272fc(puVar6,DAT_180092dc0,1);
goto LAB_1800343ca;
}
}
else {
puVar6 = (undefined8 *)FUN_180029f58(0x80);
if (puVar6 != (undefined8 *)0x0) {
param_3 = (undefined *)(ulonglong)DAT_180092de0;
puVar6 = FUN_18005df3c(puVar6,DAT_180092dc0,DAT_180092de0);
LAB_1800343ca:
if (puVar6 != (undefined8 *)0x0) {
DAT_180092dd8 = puVar6;
}
}
}
}
}
puVar6 = DAT_180092dd8;
if (cVar3 == '\0') {


}
else {

FUN_18000909c(pvVar8);
}
}
*(undefined8 *)(param_1 + 0x18) = 0;
puVar10 = DAT_180092dd0;

param_1 = puVar10;
LAB_180008f53:
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_18004312c(param_1,&DAT_180084ba0,param_3,1,(undefined8 *)local_30);
}
FUN_180028070(local_20 ^ (ulonglong)auStackY_88);
return;
}
=========================================
Function at address: 0x180008fb8
Called functions addresses: 0x18000909c


void FUN_180008fb8(HLOCAL param_1,uint param_2)

{
longlong lVar1;
HLOCAL pvVar2;
HLOCAL pvVar3;
uint *puVar4;
ulonglong uVar5;
uint uVar6;
uint uVar7;
ulonglong uVar8;

uVar6 = 0;
if (param_2 != 0) {
puVar4 = (uint *)((longlong)param_1 + 0x14);
do {
if (param_1 == (HLOCAL)0x0) {
return;
}
uVar5 = 0;
if (puVar4[-5] != 0) {
do {
if ((*(longlong *)(puVar4 + -3) != 0) &&
(pvVar3 = *(HLOCAL *)(*(longlong *)(puVar4 + -3) + 8 + uVar5 * 0x10),
pvVar3 != (HLOCAL)0x0)) {
FUN_18000909c(pvVar3);
}
uVar7 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar7;
} while (uVar7 < puVar4[-5]);
}
if (*(HLOCAL *)(puVar4 + -3) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(puVar4 + -3));
puVar4[-3] = 0;
puVar4[-2] = 0;
puVar4[-5] = 0;
}
uVar5 = 0;
if (*puVar4 != 0) {
do {
lVar1 = *(longlong *)(puVar4 + 1);
if (lVar1 == 0) break;
pvVar3 = *(HLOCAL *)(lVar1 + 0x10 + uVar5 * 0x30);
if (pvVar3 != (HLOCAL)0x0) {
FUN_18000909c(pvVar3);
}
pvVar3 = *(HLOCAL *)(lVar1 + 0x20 + uVar5 * 0x30);
if (pvVar3 != (HLOCAL)0x0) {
uVar8 = 0;
if (*(int *)(lVar1 + 0x18 + uVar5 * 0x30) != 0) {
do {
if ((pvVar3 != (HLOCAL)0x0) &&
(pvVar2 = *(HLOCAL *)((longlong)pvVar3 + uVar8 * 0x10 + 8), pvVar2 != (HLOCAL)0x0
)) {
FUN_18000909c(pvVar2);
pvVar3 = *(HLOCAL *)(lVar1 + 0x20 + uVar5 * 0x30);
}
uVar7 = (int)uVar8 + 1;
uVar8 = (ulonglong)uVar7;
} while (uVar7 < *(uint *)(lVar1 + 0x18 + uVar5 * 0x30));
if (pvVar3 == (HLOCAL)0x0) goto LAB_18000903f;
}
FUN_18000909c(pvVar3);
*(undefined8 *)(lVar1 + 0x20 + uVar5 * 0x30) = 0;
}
LAB_18000903f:
uVar7 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar7;
} while (uVar7 < *puVar4);
}
if (*(HLOCAL *)(puVar4 + 1) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(puVar4 + 1));
puVar4[1] = 0;
puVar4[2] = 0;
*puVar4 = 0;
}
uVar6 = uVar6 + 1;
puVar4 = puVar4 + 10;
} while (uVar6 < param_2);
}
if (param_1 != (HLOCAL)0x0) {
FUN_18000909c(param_1);
}
return;
}
=========================================
Function at address: 0x18000909c
Called functions addresses: 0x18002a7c0 0xEXTERNAL:00000040


void FUN_18000909c(HLOCAL param_1)

{
if (DAT_180092620 != 0) {

return;
}
/* WARNING: Could not recover jumptable at 0x0001800090bd. Too many branches */

LocalFree(param_1);
return;
}
=========================================
Function at address: 0x1800090d0
Called functions addresses: 0xEXTERNAL:000000c0 0x18002a7c0 0x180041cb0 0x18005b470 0x180009470 0xEXTERNAL:0000011c 0xEXTERNAL:00000115 0x18002a77b 0xEXTERNAL:000000c2 0xEXTERNAL:0000011a


ulonglong FUN_1800090d0(longlong *param_1,uint *param_2)

{
char cVar1;
undefined2 uVar2;
longlong lVar3;
uint uVar4;
int iVar5;
ulonglong uVar6;
ulonglong uVar7;
undefined4 *puVar8;
undefined8 uVar9;
longlong lVar10;
char cVar11;
uint uVar12;
undefined *puVar13;
undefined *puVar14;
undefined *puVar15;
ulonglong uVar16;
int iVar17;
undefined *_Src;
longlong lVar18;
uint uVar19;
int local_res18;
uint local_res20;
undefined8 in_stack_ffffffffffffff70;
undefined4 uVar20;

uVar20 = (undefined4)((ulonglong)in_stack_ffffffffffffff70 >> 0x20);
uVar7 = 0;
puVar13 = (undefined *)((ulonglong)param_2[1] + *(longlong *)(param_2 + 2));
uVar6 = uVar7;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
local_res20 = *(uint *)((longlong)param_1 + 0x3c);
lVar18 = 4;
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar6 = (ulonglong)*(uint *)((longlong)param_1 + 0x2c);
}
}
else {
local_res20 = *(uint *)((longlong)param_1 + 0x3c);
lVar18 = 0xc;
}
uVar16 = (ulonglong)local_res20;
local_res18 = (int)uVar6;
iVar17 = (int)lVar18;
puVar13[uVar6 + uVar16] = 1;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
uVar6 = FUN_180009470(param_1,param_2,0x14,1);
if ((int)uVar6 != 0) {
FUN_18005b470(param_1,0x3b6,(int)uVar6,0x50);
return uVar6 & 0xffffffff;
}
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 0xc;
cVar11 = *(char *)((longlong)param_1 + 0xe9);
if ((cVar11 == '\0') && (param_1[0x13] != 0)) {
SslFreeObject(param_1[0x13],0);
cVar11 = *(char *)((longlong)param_1 + 0xe9);
}
param_1[0x13] = param_1[0x15];
param_1[0x15] = 0;
if (cVar11 == '\0') {
param_1[0x17] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3b,&DAT_180082c58);
}
uVar6 = uVar7;
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar6 = (ulonglong)*(uint *)((longlong)param_1 + 0x2c);
}
local_res18 = (int)uVar6;
}
else {
uVar2 = *(undefined2 *)((longlong)param_1 + 0x22);
puVar13[2] = (char)uVar2;
puVar13[1] = (char)((ushort)uVar2 >> 8);
*puVar13 = 0x14;
*(undefined2 *)(puVar13 + 0xb) = 0x100;
param_2[1] = param_2[1] + local_res20 + 1 + local_res18;
}
puVar13 = (undefined *)((ulonglong)param_2[1] + *(longlong *)(param_2 + 2));
uVar19 = *(uint *)(param_1 + 8) & 0xa2aa0;
if ((*(uint *)(param_1 + 8) & 0xf3fc0) == 0) {
uVar12 = 0x24;
}
else {
uVar12 = 0xc;
}
cVar11 = (char)uVar12;
_Src = puVar13 + lVar18 + uVar6 + uVar16;
RtlAcquireResourceShared(param_1[0xb] + 0x48);
if ((ulonglong *)param_1[1] != (ulonglong *)0x0) {
uVar7 = *(ulonglong *)param_1[1];
}
uVar4 = SslComputeFinishedHash
(uVar7,*(undefined8 *)(param_1[0xb] + 0x10),param_1[0x4a],_Src,uVar12,
CONCAT44(uVar20,2 - (uint)(uVar19 != 0)));
RtlReleaseResource(param_1[0xb] + 0x48);
if (uVar4 != 0) {
FUN_18005b470(param_1,0x385,uVar4,0x50);
return (ulonglong)uVar4;
}
if (*(char *)((longlong)param_1 + 0x154) != '\0') goto LAB_1800092e4;
memcpy((void *)((longlong)param_1 + 0x155),_Src,(ulonglong)uVar12);
*(undefined *)((longlong)param_1 + 0x154) = 1;
if ((param_1[0x67] == 0) || (param_1[0xb] == 0)) goto LAB_1800092e4;
RtlAcquireResourceShared(param_1[0xb] + 0x48,1);
lVar10 = param_1[0xb];
lVar3 = *(longlong *)(lVar10 + 0x10);
if (lVar3 != 0) {

if (puVar14 != (undefined *)0x0) {
if ((undefined8 *)param_1[1] == (undefined8 *)0x0) {
uVar9 = 0;
}
else {
uVar9 = *(undefined8 *)param_1[1];
}
iVar5 = SslExportKeyingMaterial
(uVar9,lVar3,"EXPORTER-Token-Binding",param_1 + 0x22,0x40,0,0,puVar14,0x20,0
);
RtlReleaseResource(param_1[0xb] + 0x48);
if (iVar5 == 0) {
puVar8 = (undefined4 *)param_1[0x68];
if (puVar8 == (undefined4 *)0x0) {

param_1[0x68] = (longlong)puVar8;
if (puVar8 == (undefined4 *)0x0) goto LAB_1800346e4;
}
else if (*(undefined **)(puVar8 + 2) != (undefined *)0x0) {
puVar15 = *(undefined **)(puVar8 + 2);
for (lVar10 = 0x20; lVar10 != 0; lVar10 = lVar10 + -1) {
*puVar15 = 0;
puVar15 = puVar15 + 1;
}

;
puVar8 = (undefined4 *)param_1[0x68];
}
*puVar8 = 0x20;
*(undefined **)(param_1[0x68] + 8) = puVar14;
}
else {
LAB_1800346e4:
puVar15 = puVar14;
for (lVar10 = 0x20; lVar10 != 0; lVar10 = lVar10 + -1) {
*puVar15 = 0;
puVar15 = puVar15 + 1;
}

}
goto LAB_1800092e4;
}
lVar10 = param_1[0xb];
}
RtlReleaseResource(lVar10 + 0x48);
LAB_1800092e4:
if (uVar19 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x42,&DAT_180082c58);
}
memcpy((void *)((longlong)param_1 + 0x1a4),_Src,(ulonglong)uVar12);
*(uint *)(param_1 + 0x39) = uVar12;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x41,&DAT_180082c58);
}
memcpy((void *)((longlong)param_1 + 0x179),_Src,(ulonglong)uVar12);
*(uint *)(param_1 + 0x34) = uVar12;
}
uVar2 = *(undefined2 *)((longlong)param_1 + 0xdc);
puVar14 = puVar13 + uVar16 + uVar6;
cVar1 = *(char *)((longlong)param_1 + 0xe9);
*puVar14 = 0x14;
if (cVar1 == '\0') {
lVar10 = 4;
}
else {
puVar14[5] = (char)uVar2;
lVar10 = 0xc;
puVar14[4] = (char)((ushort)uVar2 >> 8);
puVar14[0xb] = cVar11;
*(undefined2 *)(puVar14 + 7) = 0;
puVar14[6] = 0;
puVar14[10] = 0;
puVar14[9] = 0;
}
puVar14[1] = 0;
puVar14[3] = cVar11;
puVar14[2] = 0;
if (_Src != (undefined *)0x0) {
memcpy(puVar14 + lVar10,_Src,(ulonglong)uVar12);
}
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
*(short *)((longlong)param_1 + 0xdc) = *(short *)((longlong)param_1 + 0xdc) + 1;
}
if ((uVar19 == 0) ||

uVar19 == 0)) {
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
uVar7 = FUN_180009470(param_1,param_2,0x16,iVar17 + uVar12);
}
else {
param_2[1] = param_2[1] + iVar17 + uVar12 + local_res20 + local_res18;
uVar2 = *(undefined2 *)((longlong)param_1 + 0x22);
puVar13[2] = (char)uVar2;
puVar13[1] = (char)((ushort)uVar2 >> 8);
puVar13[0xc] = (char)lVar18 + cVar11;
puVar13[0xb] = 0;
uVar7 = 0;
*puVar13 = 0x16;
}
}
else {
FUN_18005b470(param_1,1000,uVar19,0x50);
uVar7 = (ulonglong)uVar19;
}
return uVar7;
}
=========================================
Function at address: 0x180009470
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000010f 0x18005b81c 0x180041cb0 0x180012e50


ulonglong FUN_180009470(longlong *param_1,uint *param_2,undefined4 param_3,int param_4)

{
undefined2 uVar1;
uint uVar2;
uint uVar3;
undefined4 extraout_var;
char cVar4;
uint uVar5;
int iVar6;
undefined *puVar7;
ulonglong uVar8;
ulonglong uVar9;
uint local_res8 [2];
uint local_res10;

puVar7 = (undefined *)((ulonglong)param_2[1] + *(longlong *)(param_2 + 2));
uVar9 = 0;
uVar2 = *(uint *)((longlong)param_1 + 0x3c);
uVar1 = *(undefined2 *)((longlong)param_1 + 0x22);
if ((*(ushort *)(param_1 + 4) & 4) == 0) {
local_res10 = 0;
uVar8 = uVar9;
iVar6 = param_4;
}
else {
uVar3 = *(uint *)((longlong)param_1 + 0x34);
uVar5 = *(int *)(param_1 + 6) + param_4;
local_res10 = *(uint *)((longlong)param_1 + 0x2c);
uVar8 = (ulonglong)local_res10;
if (uVar3 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar3 = uVar3 - uVar5 % uVar3;
}
uVar5 = uVar5 + uVar3;
}
iVar6 = uVar5 + local_res10;
}
local_res8[0] = iVar6 + uVar2;
if (*param_2 < local_res8[0]) {
uVar9 = 0x7a;
}
else {
if ((((*(ushort *)(param_1 + 4) & 4) == 0) || (param_1[1] == 0)) ||
(*(int *)(param_1[1] + 0x1c) == 0)) {
cVar4 = *(char *)((longlong)param_1 + 0xe9);
if (cVar4 == '\0') {
param_1[0x17] = param_1[0x17] + 1;
}
}
else {
if (param_1[0x13] == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180085740);
}
uVar3 = FUN_180012e50(param_1,2);
if (uVar3 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return CONCAT44(extraout_var,uVar3);
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return CONCAT44(extraout_var,uVar3);
}
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_180085740,uVar3);
return (ulonglong)uVar3;
}
uVar8 = (ulonglong)local_res10;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18005b81c(DAT_180091000[2],0xc,&DAT_180085740,param_4,(char)param_1[0x17]);
uVar8 = (ulonglong)local_res10;
}
if ((ulonglong *)param_1[1] != (ulonglong *)0x0) {
uVar9 = *(ulonglong *)param_1[1];
}
uVar3 = SslEncryptPacket(uVar9,param_1[0x13],puVar7 + uVar8 + uVar2,param_4,puVar7,
local_res8[0],local_res8,param_1[0x17],param_3,0);
uVar9 = (ulonglong)uVar3;
if (uVar3 == 0) {
cVar4 = *(char *)((longlong)param_1 + 0xe9);
if (cVar4 == '\0') {
param_1[0x17] = param_1[0x17] + 1;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_180085740,uVar3);
}
cVar4 = *(char *)((longlong)param_1 + 0xe9);
uVar9 = 0x80090329;
}
}
*puVar7 = (char)param_3;
puVar7[1] = (char)((ushort)uVar1 >> 8);
puVar7[2] = (char)uVar1;
if (cVar4 == '\0') {
puVar7[3] = (char)(local_res8[0] - uVar2 >> 8);
puVar7[4] = (char)local_res8[0] - (char)uVar2;
}
else {
puVar7[3] = *(undefined *)((longlong)param_1 + 0xbf);
puVar7[4] = *(undefined *)((longlong)param_1 + 0xbe);
puVar7[5] = *(undefined *)((longlong)param_1 + 0xbd);
puVar7[6] = *(undefined *)((longlong)param_1 + 0xbc);
puVar7[7] = *(undefined *)((longlong)param_1 + 0xbb);
puVar7[8] = *(undefined *)((longlong)param_1 + 0xba);
puVar7[9] = *(undefined *)((longlong)param_1 + 0xb9);
puVar7[10] = *(undefined *)(param_1 + 0x17);
puVar7[0xb] = (char)(local_res8[0] - uVar2 >> 8);
puVar7[0xc] = (char)local_res8[0] - (char)uVar2;
uVar8 = param_1[0x17];
param_1[0x17] = (uVar8 + 1 ^ uVar8) & 0xffffffffffff ^ uVar8;
}
param_2[1] = param_2[1] + local_res8[0];
}
return uVar9;
}
=========================================
Function at address: 0x180009670
Called functions addresses: 0x1800098e4 0x18002a7c0 0x18000988c


undefined8 FUN_180009670(longlong param_1,int *param_2)

{
ushort *puVar1;
longlong lVar2;
longlong lVar3;
wchar_t *pwVar4;
undefined8 uVar5;
int iVar6;
int iVar7;
int iVar8;
longlong local_res8;

lVar3 = *(longlong *)(param_1 + 0x38);
iVar8 = 0;
lVar2 = *(longlong *)(lVar3 + 0x50);
local_res8 = 0;
*(undefined *)(param_1 + 0x1a) = 1;
iVar6 = *(int *)(lVar3 + 0x1a0);
iVar7 = *(int *)(param_1 + 0x14) + 5 + iVar6;
*(int *)(param_1 + 0x14) = iVar7;
if (((*(uint *)(lVar3 + 0x40) & 0x2a88) == 0) && ((*(byte *)(lVar3 + 0x40) & 0x20) != 0)) {
if ((*(char *)(*(longlong *)(param_1 + 8) + 0x229) == '\0') || (iVar6 == 0)) {
*(undefined *)(param_1 + 0x1a) = 0;
}
else {
iVar8 = iVar7 + 2;
}
*(int *)(param_1 + 0x14) = iVar8;
*param_2 = iVar8;
return 0;
}
if ((*(uint *)(lVar3 + 0x40) & 0xa2a80) == 0) {
return 0;
}

if (lVar3 != 0) {

uVar5 = FUN_1800098e4(param_1,pwVar4);
if ((int)uVar5 != 0) {
return uVar5;
}
if (*(longlong *)(param_1 + 0x28) != 0) {
lVar3 = -1;
do {
lVar3 = lVar3 + 1;
} while (*(char *)(*(longlong *)(param_1 + 0x28) + lVar3) != '\0');
*(int *)(param_1 + 0x30) = (int)lVar3;
*(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + (int)lVar3 + 9;
}
}
iVar6 = *(int *)(param_1 + 0x14);
if ((*(uint *)(lVar2 + 0xa0) & 0x700) != 0) {
iVar6 = iVar6 + 9;
*(undefined *)(param_1 + 0x18) = 1;
*(int *)(param_1 + 0x14) = iVar6;
}
lVar3 = *(longlong *)(param_1 + 0x38);
if (*(short *)(lVar3 + 0x398) != 0) {
*(undefined *)(param_1 + 0x20) = 1;
*(uint *)(param_1 + 0x14) = iVar6 + (*(ushort *)(lVar3 + 0x398) + 6) * 2;
}

uVar5 = FUN_18000988c(pwVar4);
if (((int)uVar5 != 0) &&
((*(longlong *)(lVar2 + 0x368) != 0 || (*(longlong *)(lVar2 + 0x370) != 0)))) {
*(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 6;
*(undefined *)(param_1 + 0x19) = 1;
}
lVar3 = *(longlong *)(param_1 + 0x38);
if (*(char *)(lVar3 + 0x39d) != '\0') {
*(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + (uint)*(ushort *)(lVar3 + 0x1da) * 2 + 6;
}

if (local_res8 != 0) {
*(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + *(int *)(local_res8 + 0x1b0) + 4;
}
iVar6 = *(int *)(param_1 + 0x14);
lVar3 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x310);
if (lVar3 != 0) {
iVar6 = iVar6 + *(ushort *)(lVar3 + 4) + 6;
*(int *)(param_1 + 0x14) = iVar6;
}
if (DAT_1800927b8 == 0) {
*(undefined *)(*(longlong *)(param_1 + 0x38) + 0x540) = 1;
*(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 4;
}
else {
lVar3 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
if ((lVar3 == 0) || (DAT_1800927ac == '\0')) goto LAB_180009832;
puVar1 = (ushort *)(lVar3 + 0x42);
*puVar1 = *puVar1 | 8;
}
iVar6 = *(int *)(param_1 + 0x14);
LAB_180009832:
lVar3 = *(longlong *)(param_1 + 0x38);
if ((*(char *)(lVar3 + 0xe9) != '\0') && (*(ushort **)(lVar3 + 800) != (ushort *)0x0)) {
iVar7 = 7;
if (*(byte **)(lVar3 + 0x538) != (byte *)0x0) {
iVar7 = **(byte **)(lVar3 + 0x538) + 7;
}
iVar6 = (uint)**(ushort **)(lVar3 + 800) + iVar6 + iVar7;
*(int *)(param_1 + 0x14) = iVar6;
}
if (*(longlong *)(lVar3 + 0x330) != 0) {
iVar6 = iVar6 + *(byte *)(*(longlong *)(lVar3 + 0x330) + 2) + 7;
*(int *)(param_1 + 0x14) = iVar6;
}
if (iVar6 != 0) {
iVar6 = iVar6 + 2;
*(int *)(param_1 + 0x14) = iVar6;
}
*param_2 = iVar6;
return 0;
}
=========================================
Function at address: 0x18000988c
Called functions addresses: 0x180041cb0 0xEXTERNAL:00000032


undefined8 FUN_18000988c(wchar_t *param_1)

{
wchar_t wVar1;
wchar_t *_Str;
longlong lVar2;
wchar_t *pwVar3;
longlong lVar4;
undefined2 uVar5;
uint uVar6;
wchar_t *pwVar7;
wchar_t *pwVar8;

if ((param_1 != (wchar_t *)0x0) && (DAT_180092f10 != (wchar_t *)0x0)) {
uVar6 = (ushort)*DAT_180092f10 - 0x2a;
if (uVar6 == 0) {
uVar6 = (uint)(ushort)DAT_180092f10[1];
}
if (uVar6 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar5 = 0x12;
LAB_180034ba8:
FUN_180041cb0(DAT_180091000[2],uVar5,&DAT_180085338);
}
return 1;
}
lVar2 = -1;
do {
lVar2 = lVar2 + 1;
} while (param_1[lVar2] != L'\0');
wVar1 = *DAT_180092f10;
_Str = DAT_180092f10;
while (wVar1 != L'\0') {
pwVar3 = wcschr(_Str,L',');
pwVar8 = param_1 + lVar2;
pwVar7 = pwVar3;
if (pwVar3 == (wchar_t *)0x0) {
lVar4 = -1;
do {
lVar4 = lVar4 + 1;
} while (_Str[lVar4] != L'\0');
pwVar3 = _Str + lVar4;
pwVar7 = pwVar3;
}
do {
pwVar8 = pwVar8 + -1;
pwVar3 = pwVar3 + -1;
if ((pwVar3 < _Str) || (pwVar8 < param_1)) break;
} while (*pwVar3 == *pwVar8);
if ((pwVar3 == _Str + -1) && ((pwVar8 == param_1 + -1 || (*pwVar8 == L'.')))) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 1;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 1;
}
uVar5 = 0x13;
goto LAB_180034ba8;
}
wVar1 = *pwVar7;
_Str = pwVar7;
if (wVar1 == L',') {
wVar1 = pwVar7[1];
_Str = pwVar7 + 1;
}
}
}
return 0;
}
=========================================
Function at address: 0x1800098e4
Called functions addresses: 0x18002a7c0 0x180009ad9 0x18002a700 0x18000a418 0xEXTERNAL:0000009b 0x18000a1f4 0x180028070 0x18002a77b 0xEXTERNAL:00000041 0x180041d70 0x18000a498


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_1800098e4(longlong param_1,wchar_t *param_2)

{
WCHAR *_Src;
ulonglong uVar1;
int iVar2;
longlong lVar3;
undefined8 uVar5;
LPCWSTR pWVar6;
void *_Dst;
undefined4 *puVar7;
WCHAR WVar8;
ulonglong uVar9;
ulonglong uVar10;
WCHAR *pWVar11;
WCHAR *_Dst_00;
undefined *puVar12;
undefined *puVar13;
uint uVar14;
WCHAR *lpWideCharStr;
undefined auStack_78 [64];
longlong local_38;
ulonglong local_30;
longlong lVar4;

local_30 = DAT_180091970 ^ (ulonglong)&local_38;
puVar13 = auStack_78;
local_38 = param_1;
if ((param_2 == (wchar_t *)0x0) || (puVar13 = auStack_78, *param_2 == L'\0')) goto LAB_180009aab;
iVar2 = FUN_18000a498(param_2);
if (iVar2 != 0) {
puVar13 = auStack_78;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(puVar13 = auStack_78, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x10,&DAT_180082c68,param_2);
FUN_180009ad9();
return;
}
goto LAB_180009aab;
}
lVar3 = -1;
do {
lVar4 = lVar3;
lVar3 = lVar4 + 1;
} while (param_2[lVar3] != L'\0');
uVar10 = lVar3 * 2 + 2;
puVar13 = auStack_78;
if (0x4000 < uVar10) goto LAB_180009aab;
uVar1 = uVar10 * 3;
_Dst_00 = (WCHAR *)0x0;
puVar13 = auStack_78;
if ((((uVar1 == 0) || (puVar13 = auStack_78, DAT_1800920e0 < uVar1)) ||
(uVar9 = DAT_1800920e8 + 8 + uVar1, _Dst_00 = (WCHAR *)0x0, puVar13 = auStack_78,
uVar9 < uVar1)) || (uVar5 = FUN_18000a418(uVar9), puVar13 = auStack_78, (int)uVar5 == 0)) {
LAB_180034c01:
if (uVar1 <= uVar1 + 8) {
*(undefined8 *)(puVar13 + -8) = 0x180034c21;

if (puVar7 == (undefined4 *)0x0) goto LAB_180009aab;
*puVar7 = 0x70616548;
_Dst_00 = (WCHAR *)(puVar7 + 2);
}
puVar12 = puVar13;
if (_Dst_00 == (WCHAR *)0x0) goto LAB_180009aab;
}
else {
uVar9 = uVar1 + 0x17;
if (uVar9 <= uVar1 + 8) {
uVar9 = 0xffffffffffffff0;
}
lVar3 = -(uVar9 & 0xfffffffffffffff0);
_Dst_00 = (WCHAR *)((longlong)&local_38 + lVar3);
puVar13 = auStack_78 + lVar3;
if (_Dst_00 == (WCHAR *)0x0) goto LAB_180034c01;
_Dst_00[0] = L'';
_Dst_00[1] = L'';
_Dst_00 = (WCHAR *)((longlong)&local_30 + lVar3);
puVar13 = auStack_78 + lVar3;
puVar12 = auStack_78 + lVar3;
if (_Dst_00 == (WCHAR *)0x0) goto LAB_180034c01;
}
_Src = _Dst_00 + lVar4 + 2;
*(undefined8 *)(puVar12 + -8) = 0x180009a01;
memcpy(_Dst_00,param_2,uVar10);
WVar8 = *_Dst_00;
pWVar11 = _Dst_00;
lpWideCharStr = _Dst_00;
while (WVar8 != L'\0') {
pWVar11 = pWVar11 + 1;
pWVar6 = pWVar11;
if (WVar8 != L'/') {
pWVar6 = lpWideCharStr;
}
lpWideCharStr = pWVar6;
WVar8 = *pWVar11;
}
*(undefined8 *)(puVar12 + 0x38) = 0;
*(undefined8 *)(puVar12 + 0x30) = 0;
*(int *)(puVar12 + 0x28) = (int)uVar10 * 2;
*(WCHAR **)(puVar12 + 0x20) = _Src;
*(undefined8 *)(puVar12 + -8) = 0x180009a51;
iVar2 = WideCharToMultiByte(0xfde9,0,lpWideCharStr,-1,*(LPSTR *)(puVar12 + 0x20),
*(int *)(puVar12 + 0x28),*(LPCSTR *)(puVar12 + 0x30),
*(LPBOOL *)(puVar12 + 0x38));
if (iVar2 == 0) {
*(undefined8 *)(puVar12 + -8) = 0x180034c4d;
GetLastError();
}
else {
lVar3 = -1;
if (*(char *)_Src != '\0') {
do {
lVar4 = lVar3;
lVar3 = lVar4 + 1;
} while (*(char *)((longlong)_Src + lVar3) != '\0');
uVar14 = (int)lVar4 + 2;
*(undefined8 *)(puVar12 + -8) = 0x180009a79;
_Dst = (void *)FUN_18000a1f4((ulonglong)uVar14);
*(void **)(local_38 + 0x28) = _Dst;
if (_Dst != (void *)0x0) {
*(undefined8 *)(puVar12 + -8) = 0x180009a94;
memcpy(_Dst,_Src,(ulonglong)uVar14);
}
}
}
puVar13 = puVar12;
if ((_Dst_00 != (WCHAR *)0x0) && (*(int *)(_Dst_00 + -4) == 0x70616548)) {
*(undefined8 *)(puVar12 + -8) = 0x180034c70;

}
LAB_180009aab:
uVar10 = local_30 ^ (ulonglong)&local_38;
*(undefined8 *)(puVar13 + -8) = 0x180009ab7;
FUN_180028070(uVar10);
return;
}
=========================================
Function at address: 0x180009ad9
Called functions addresses: None


void FUN_180009ad9(void)

{
ulonglong unaff_RBP;

FUN_180028070(*(ulonglong *)(unaff_RBP + 8) ^ unaff_RBP);
return;
}
=========================================
Function at address: 0x180009ae4
Called functions addresses: 0x1800156a0 0x18002a7c0 0x180008fb8 0x18000a1f4 0x180028070 0x180034dc2 0x180017394


void FUN_180009ae4(longlong param_1,uint param_2,int param_3,char param_4,longlong *param_5,
uint *param_6)

{
undefined8 *puVar1;
longlong *plVar2;
longlong lVar3;
uint uVar4;
int iVar5;
undefined4 uVar6;
HLOCAL pvVar7;
longlong lVar8;
longlong lVar9;
uint uVar10;
longlong lVar11;
uint uVar12;
longlong *plVar13;
ushort *puVar14;
ulonglong uVar15;
int iVar16;
undefined auStack_128 [32];
uint local_f4;
uint local_f0;
int local_ec;
uint local_e8;
undefined8 local_b0;
undefined8 uStack_a8;
undefined8 local_a0;
longlong lStack_98;
undefined8 local_90;
undefined8 local_88;
undefined8 uStack_80;
undefined8 local_78;
undefined8 uStack_70;
longlong local_68;
undefined8 uStack_60;
ulonglong local_58;

local_58 = DAT_180091970 ^ (ulonglong)auStack_128;
if (param_2 == 0) goto LAB_180009db4;
if ((param_5 == (longlong *)0x0) || (param_6 == (uint *)0x0)) {
code_r0x000180034dc2:
iVar5 = -0x7ff6fca3;
LAB_180034dc7:
param_2 = 0;
pvVar7 = (HLOCAL)0x0;
}
else {
if ((param_1 == 0) && (param_3 == 0)) {
FUN_180034dc2();
return;
}
if (0x10 < param_2) goto code_r0x000180034dc2;
pvVar7 = (HLOCAL)FUN_18000a1f4((ulonglong)(param_2 * 0x28));
if (pvVar7 == (HLOCAL)0x0) {
iVar5 = -0x7ff6fd00;
goto LAB_180034dc7;
}
uVar15 = 0;
local_e8 = 0;
if (param_2 != 0) {
plVar13 = (longlong *)((longlong)pvVar7 + 0x18);
lVar11 = param_1 - (longlong)pvVar7;
do {
local_90 = 0;
local_b0 = 0;
uStack_a8 = 0;
local_a0 = 0;
lStack_98 = 0;
if (param_4 != '\0') {
if (param_3 == 0) {
uVar15 = param_1 + uVar15 * 0x28;
uVar6 = 0x28;
}
else {
uVar15 = (ulonglong)(uint)(param_3 + (int)uVar15 * 0x18);
uVar6 = 0x18;
}

if (iVar5 == 0) goto LAB_180009bf1;
LAB_180034d04:
FUN_180008fb8(pvVar7,param_2);
goto LAB_180034dc7;
}
puVar1 = (undefined8 *)(lVar11 + -0x18 + (longlong)plVar13);
local_b0 = *puVar1;
uStack_a8 = puVar1[1];
puVar1 = (undefined8 *)(lVar11 + -8 + (longlong)plVar13);
local_a0 = *puVar1;
lStack_98 = puVar1[1];
local_90 = *(undefined8 *)(lVar11 + 8 + (longlong)plVar13);
LAB_180009bf1:
if ((uint)local_b0 != 0) {
if ((uint)local_b0 < 0x11) {
lVar8 = FUN_18000a1f4((ulonglong)((uint)local_b0 << 4));
plVar13[-2] = lVar8;
if (lVar8 != 0) {
uVar15 = 0;
*(uint *)(plVar13 + -3) = (uint)local_b0;
if ((uint)local_b0 != 0) {
iVar16 = 0;
do {
puVar14 = (ushort *)(plVar13[-2] + uVar15 * 0x10);
if (param_3 == 0) {
iVar5 = FUN_1800156a0(param_4,(ulonglong *)(uStack_a8 + uVar15 * 0x10),puVar14);
}
else {
iVar5 = FUN_180017394(local_b0._4_4_ + iVar16,puVar14);
}
if (iVar5 != 0) goto LAB_180034d04;
uVar12 = (int)uVar15 + 1;
uVar15 = (ulonglong)uVar12;
iVar16 = iVar16 + 8;
} while (uVar12 < (uint)local_b0);
}
goto LAB_180009bfc;
}
LAB_180034db8:
iVar5 = -0x7ff6fd00;
}
else {
LAB_180034cff:
iVar5 = -0x7ff6fca3;
}
goto LAB_180034d04;
}
LAB_180009bfc:
uVar6 = (undefined4)uStack_a8;
if (param_3 == 0) {
uVar6 = (int)local_a0;
}
*(undefined4 *)(plVar13 + -1) = uVar6;
uVar12 = uStack_a8._4_4_;
if (param_3 == 0) {
uVar12 = local_a0._4_4_;
}
if (uVar12 != 0) {
if (0x10 < uVar12) goto LAB_180034cff;
lVar8 = FUN_18000a1f4((ulonglong)(uVar12 * 0x30));
*plVar13 = lVar8;
if (lVar8 == 0) goto LAB_180034db8;
uVar15 = 0;
*(uint *)((longlong)plVar13 + -4) = uVar12;
local_f4 = 0;
lVar8 = 0;
do {
lVar3 = *plVar13;
local_88 = 0;
uStack_80 = 0;
local_78 = 0;
uStack_70 = 0;
local_68 = 0;
uStack_60 = 0;
if (param_4 == '\0') {
lVar9 = *(longlong *)(lVar11 + (longlong)plVar13);
local_88 = *(undefined8 *)(lVar9 + lVar8);
uStack_80 = ((undefined8 *)(lVar9 + lVar8))[1];
puVar1 = (undefined8 *)(lVar9 + 0x10 + lVar8);
local_78 = *puVar1;
uStack_70 = puVar1[1];
plVar2 = (longlong *)(lVar9 + 0x20 + lVar8);
local_68 = *plVar2;
uStack_60 = plVar2[1];
}
else {
if (param_3 == 0) {
uVar15 = uVar15 * 0x30 + lStack_98;
uVar6 = 0x30;
}
else {
uVar15 = (ulonglong)(uint)((int)uVar15 * 0x1c + (int)local_a0);
uVar6 = 0x1c;
}

if (iVar5 != 0) goto LAB_180034d04;
uVar15 = (ulonglong)local_f4;
}
puVar14 = (ushort *)(lVar3 + 8 + lVar8);
if (param_3 == 0) {
iVar5 = FUN_1800156a0(param_4,(ulonglong *)(lStack_98 + 8 + uVar15 * 0x30),puVar14);
}
else {
iVar5 = FUN_180017394((int)uVar15 * 0x1c + (int)local_a0 + 4,puVar14);
}
if (iVar5 != 0) goto LAB_180034d04;
uVar10 = (uint)uStack_70;
if (param_3 == 0) {
uVar10 = uStack_60._4_4_;
}
*(uint *)(lVar8 + 0x2c + lVar3) = uVar10;
uVar4 = local_78._4_4_;
if (param_3 == 0) {
uVar4 = (uint)uStack_60;
}
*(uint *)(lVar8 + 0x28 + lVar3) = uVar4;
*(undefined4 *)(lVar8 + lVar3) = (undefined4)local_88;
if ((uVar10 != 0) && (uVar10 < uVar4)) goto LAB_180034cff;
uVar10 = uStack_80._4_4_;
if (param_3 == 0) {
uVar10 = (uint)uStack_70;
}
if (uVar10 != 0) {
if (0x10 < uVar10) goto LAB_180034cff;
lVar9 = FUN_18000a1f4((ulonglong)(uVar10 << 4));
*(longlong *)(lVar8 + 0x20 + lVar3) = lVar9;
if (lVar9 == 0) goto LAB_180034db8;
*(uint *)(lVar8 + 0x18 + lVar3) = uVar10;
local_f0 = 0;
local_ec = 0;
do {
puVar14 = (ushort *)
(*(longlong *)(lVar8 + 0x20 + lVar3) + (ulonglong)local_f0 * 0x10);
if (param_3 == 0) {
iVar5 = FUN_1800156a0(param_4,(ulonglong *)(local_68 + (ulonglong)local_f0 * 0x10)
,puVar14);
}
else {
iVar5 = FUN_180017394((int)local_78 + local_ec,puVar14);
}
if (iVar5 != 0) goto LAB_180034d04;
local_f0 = local_f0 + 1;
local_ec = local_ec + 8;
} while (local_f0 < uVar10);
}
lVar8 = lVar8 + 0x30;
local_f4 = local_f4 + 1;
uVar15 = (ulonglong)local_f4;
} while (local_f4 < uVar12);
}
uVar12 = local_a0._4_4_;
if (param_3 == 0) {
uVar12 = (uint)local_90;
}
local_e8 = local_e8 + 1;
uVar15 = (ulonglong)local_e8;
*(uint *)(plVar13 + 1) = uVar12;
plVar13 = plVar13 + 5;
} while (local_e8 < param_2);
}
iVar5 = 0;
}
*param_5 = (longlong)pvVar7;
*param_6 = param_2;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar5 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x44,&DAT_180084ce0,iVar5,(char)iVar5);
}
LAB_180009db4:
FUN_180028070(local_58 ^ (ulonglong)auStack_128);
return;
}
=========================================
Function at address: 0x180009e8c
Called functions addresses: 0x18000a1d0


undefined8 FUN_180009e8c(longlong param_1,uint *param_2,uint param_3)

{
longlong lVar1;

if (*(longlong *)(param_2 + 2) == 0) {
*param_2 = param_3;
lVar1 = FUN_18000a1d0(param_1,param_3);
*(longlong *)(param_2 + 2) = lVar1;
if (lVar1 == 0) {
return 0xe;
}
}
else if (*param_2 < param_3) {
param_2[1] = param_3;
return 0x80090321;
}
param_2[1] = 0;
return 0;
}
=========================================
Function at address: 0x180009ed4
Called functions addresses: 0x180041cdc 0xEXTERNAL:00000113 0x18000a1f4 0x18000909c


int FUN_180009ed4(undefined8 param_1,undefined8 param_2,undefined8 param_3,uint *param_4,
longlong *param_5)

{
int iVar1;
longlong lVar2;

iVar1 = SslExportKey();
if (iVar1 == 0) {
lVar2 = FUN_18000a1f4((ulonglong)*param_4);
*param_5 = lVar2;
if (lVar2 == 0) {
iVar1 = 0xe;
}
else {
iVar1 = SslExportKey(param_1,param_2,param_3,lVar2,*param_4,param_4,0);
if (iVar1 != 0) {
FUN_18000909c((HLOCAL)*param_5);
*param_5 = 0;
}
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180086370,iVar1);
}
return iVar1;
}
=========================================
Function at address: 0x180009f90
Called functions addresses: 0x180003750 0x18005a36c 0x18002a7c0 0x18000d31c 0x180006034 0x18000a1f4 0x18000629c 0x18005b2a4 0x180006300 0x18000538c 0x18000909c 0x1800635d4 0x180006358 0x180028d78


int FUN_180009f90(longlong param_1,wchar_t *param_2,longlong param_3,longlong *param_4,
ulonglong param_5)

{
uint uVar1;
ulonglong uVar2;
bool bVar3;
int iVar4;
ulonglong uVar5;
undefined8 *puVar6;
undefined8 *puVar7;
longlong lVar8;
undefined8 uVar9;
char *pcVar10;
undefined8 *puVar11;
uint uVar12;
longlong lVar13;
wchar_t *pwVar14;
longlong local_res8;

lVar8 = DAT_1800927f0;
puVar6 = (undefined8 *)0x0;
local_res8 = param_1;
uVar5 = FUN_180006358(DAT_1800927f0,(byte *)param_2);
uVar2 = (ulonglong)*(uint *)(lVar8 + 0x34);
pwVar14 = param_2;
bVar3 = FUN_180006034((longlong *)
(((uVar5 & 0xffffffff) / uVar2) * 0x98 + *(longlong *)(lVar8 + 0x28)),
(uVar5 & 0xffffffff) % uVar2,param_2,param_3,&local_res8);
if (!bVar3) {
local_res8 = 0;
}
lVar8 = local_res8;
puVar7 = DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar7 = (undefined8 *)DAT_180091000[2];
pcVar10 = "FOUND";
if (!bVar3) {
pcVar10 = "NO ENTRY";
}
FUN_18005b2a4(puVar7,"NO ENTRY",pwVar14,param_2,pcVar10);
}
if (!bVar3) {
FUN_18000629c(puVar7,(byte *)param_2,(uint *)0x0);
lVar8 = DAT_1800927f0;
iVar4 = FUN_18000538c(DAT_1800927f0,(longlong)param_2,&local_res8);
FUN_180006300(lVar8,(byte *)param_2,(uint *)0x0);
lVar8 = local_res8;
if (iVar4 != 0) {
return iVar4;
}
}
uVar1 = *(uint *)(param_3 + 0x98);
uVar12 = uVar1 & 0x800a2aaa;
if (((param_5 & 0x100000000) != 0) && ((uVar1 & 0x800a0aaa) != 0)) {
return -0x7ff6fca3;
}
if ((uVar1 & 0xa2aa0) == 0) {
return -0x7ff6fccf;
}
if (param_2 != (wchar_t *)0x0) {
lVar13 = -1;
do {
lVar13 = lVar13 + 1;
} while (param_2[lVar13] != L'\0');
iVar4 = (int)lVar13 + 1;
puVar6 = (undefined8 *)FUN_18000a1f4((ulonglong)(uint)(iVar4 * 2));
if (puVar6 == (undefined8 *)0x0) {
return 0xe;
}
_o_wcscpy_s(puVar6,iVar4,param_2);
}
if ((uVar1 & 0xa0000) != 0 && (uVar1 & 0x2aa0) != 0) {
if ((param_5 & 0x400) == 0) {
uVar12 = uVar1 & 0x80002aaa;
}
else {
uVar12 = uVar1 & 0xa0000;
}
}
if ((bVar3) && ((*(uint *)(lVar8 + 0xa8) & 0x2000) == 0)) {
uVar12 = uVar12 & 0xffffcfff;
}
if ((uVar12 & 0x2000) == 0) {
puVar7 = (undefined8 *)FUN_18000a1f4(0x558);
if (puVar7 != (undefined8 *)0x0) {
puVar6 = FUN_180003750(puVar7,lVar8,uVar12,puVar6);
LAB_18000a122:

if (iVar4 == 0) {
lVar8 = FUN_18000a1f4(0x28);
if (lVar8 != 0) {
*(undefined8 **)(lVar8 + 8) = puVar6;
puVar6[0x10] = lVar8;
uVar9 = FUN_18000d31c(uVar12);
*(uint *)((longlong)puVar6 + 0x24) = (uint)uVar9 & 0xffff;
*param_4 = lVar8;
return 0;
}

iVar4 = 0xe;
}
FUN_18000909c(puVar6);
return iVar4;
}
}
else {
puVar7 = (undefined8 *)
FUN_18000a1f4((ulonglong)((-(uint)((param_5 & 0x100000000) != 0) & 0xfffffff0) + 0x7a0)
);
if (puVar7 != (undefined8 *)0x0) {
puVar11 = FUN_1800635d4(param_5,puVar7 + 0xe8,(longlong)puVar7);
if (puVar11 != (undefined8 *)0x0) {
puVar6 = FUN_18005a36c(puVar7,puVar11,lVar8,uVar12,puVar6);
goto LAB_18000a122;
}
if (puVar6 != (undefined8 *)0x0) {
FUN_18000909c(puVar6);
}
goto LAB_180034f10;
}
}
puVar7 = puVar6;
if (puVar6 == (undefined8 *)0x0) {
return 0xe;
}
LAB_180034f10:
FUN_18000909c(puVar7);
return 0xe;
}
=========================================
Function at address: 0x18000a1d0
Called functions addresses: 0x18002a7c0 0x18000a1f4


/* WARNING: Switch with 1 destination removed at 0x00018002a7c0 */
/* WARNING: Switch with 1 destination removed at 0x000180034f8d */

void FUN_18000a1d0(longlong param_1,uint param_2)

{
longlong *plVar1;

plVar1 = *(longlong **)(*(longlong *)(param_1 + 0x80) + 0x18);
if (plVar1 != (longlong *)0x0) {
/* WARNING: Could not recover jumptable at 0x00018002a7a0. Too many branches */

(**(code **)(*plVar1 + 0x30))();
return;
}
FUN_18000a1f4((ulonglong)param_2);
return;
}
=========================================
Function at address: 0x18000a1f4
Called functions addresses: 0x18002a7c0 0xEXTERNAL:0000003f


void FUN_18000a1f4(ulonglong param_1)

{
if (DAT_180092620 != 0) {

return;
}
/* WARNING: Could not recover jumptable at 0x00018000a21c. Too many branches */

LocalAlloc(0x40,param_1 & 0xffffffff);
return;
}
=========================================
Function at address: 0x18000a230
Called functions addresses: 0xEXTERNAL:00000167 0xEXTERNAL:00000165 0x18002a7c0 0xEXTERNAL:00000166 0x18002a700 0x18000a418 0xEXTERNAL:00000169 0x180028070 0xEXTERNAL:00000171


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_18000a230(BCRYPT_HANDLE param_1,longlong param_2,PUCHAR param_3,ULONG param_4,
PUCHAR param_5,ULONG param_6)

{
longlong lVar1;
BCRYPT_HASH_HANDLE pvVar2;
NTSTATUS NVar3;
uint uVar4;
undefined8 uVar5;
ulonglong uVar6;
undefined4 *puVar7;
ulonglong uVar8;
PUCHAR pbHashObject;
undefined *puVar9;
undefined *puVar10;
ULONG cbHashObject;
undefined auStackY_78 [32];
uint local_38 [2];
BCRYPT_HASH_HANDLE local_30;
ULONG local_28 [2];
ulonglong local_20;

local_20 = DAT_180091970 ^ (ulonglong)local_38;
local_30 = (BCRYPT_HASH_HANDLE)0x0;
NVar3 = BCryptGetProperty(param_1,L"ObjectLength",(PUCHAR)local_38,4,local_28,0);
puVar9 = auStackY_78;
if (NVar3 != 0) goto LAB_18000a3e9;
uVar6 = (ulonglong)local_38[0];
pbHashObject = (PUCHAR)0x0;
puVar10 = auStackY_78;
if ((((local_38[0] == 0) ||
(pbHashObject = (PUCHAR)0x0, puVar10 = auStackY_78, DAT_1800920e0 < uVar6)) ||
(uVar8 = DAT_1800920e8 + 8 + uVar6, puVar10 = auStackY_78, uVar8 < uVar6)) ||
(uVar5 = FUN_18000a418(uVar8), pbHashObject = (PUCHAR)0x0, puVar10 = auStackY_78,
(int)uVar5 == 0)) {
LAB_180034f98:
uVar4 = local_38[0] + 8;
puVar9 = puVar10;
if (local_38[0] <= uVar4) {
*(undefined8 *)(puVar10 + -8) = 0x180034fba;

if (puVar7 == (undefined4 *)0x0) goto LAB_18000a3e9;
*puVar7 = 0x70616548;
pbHashObject = (PUCHAR)(puVar7 + 2);
}
cbHashObject = local_38[0];
if (pbHashObject == (PUCHAR)0x0) goto LAB_18000a3e9;
}
else {
uVar6 = (ulonglong)(local_38[0] + 8) + 0xf;
if (uVar6 <= local_38[0] + 8) {
uVar6 = 0xffffffffffffff0;
}
lVar1 = -(uVar6 & 0xfffffffffffffff0);
puVar9 = auStackY_78 + lVar1;
pbHashObject = (PUCHAR)((longlong)local_38 + lVar1);
puVar10 = auStackY_78 + lVar1;
if (pbHashObject == (PUCHAR)0x0) goto LAB_180034f98;
builtin_memcpy(pbHashObject,"Stck",4);
pbHashObject = (PUCHAR)((longlong)local_28 + lVar1 + -8);
puVar10 = auStackY_78 + lVar1;
cbHashObject = local_38[0];
if (pbHashObject == (PUCHAR)0x0) goto LAB_180034f98;
}
*(undefined4 *)(puVar9 + 0x30) = 0;
*(undefined4 *)(puVar9 + 0x28) = 0;
*(undefined8 *)(puVar9 + 0x20) = 0;
*(undefined8 *)(puVar9 + -8) = 0x18000a351;
NVar3 = BCryptCreateHash(param_1,&local_30,pbHashObject,cbHashObject,*(PUCHAR *)(puVar9 + 0x20),
*(ULONG *)(puVar9 + 0x28),*(ULONG *)(puVar9 + 0x30));
pvVar2 = local_30;
if (NVar3 == 0) {
*(undefined8 *)(puVar9 + -8) = 0x18000a375;
NVar3 = BCryptHashData(pvVar2,(PUCHAR)(param_2 + 0x110),0x40,0);
pvVar2 = local_30;
if (NVar3 == 0) {
*(undefined8 *)(puVar9 + -8) = 0x18000a394;
NVar3 = BCryptHashData(pvVar2,param_3,param_4,0);
pvVar2 = local_30;
if (NVar3 == 0) {
*(undefined8 *)(puVar9 + -8) = 0x18000a3b5;
BCryptFinishHash(pvVar2,param_5,param_6,0);
}
}
}
pvVar2 = local_30;
if (local_30 != (BCRYPT_HASH_HANDLE)0x0) {
*(undefined8 *)(puVar9 + -8) = 0x18000a3cc;
BCryptDestroyHash(pvVar2);
}
if ((pbHashObject != (PUCHAR)0x0) && (*(int *)(pbHashObject + -8) == 0x70616548)) {
*(undefined8 *)(puVar9 + -8) = 0x180034ffa;

}
LAB_18000a3e9:
uVar6 = local_20 ^ (ulonglong)local_38;
*(undefined8 *)(puVar9 + -8) = 0x18000a3f5;
FUN_180028070(uVar6);
return;
}
=========================================
Function at address: 0x18000a418
Called functions addresses: 0x18000a444


undefined8 FUN_18000a418(ulonglong param_1)

{
FUN_18000a444(param_1);
return 1;
}
=========================================
Function at address: 0x18000a444
Called functions addresses: 0x18002a700 0x180028070


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_18000a444(ulonglong param_1)

{
ulonglong uVar1;
undefined8 auStack_40 [5];
ulonglong local_18 [2];

local_18[0] = DAT_180091970 ^ (ulonglong)local_18;
uVar1 = param_1 + 0xf;
if (uVar1 <= param_1) {
uVar1 = 0xffffffffffffff0;
}
auStack_40[0] = 0x18000a479;
*(undefined8 *)((longlong)auStack_40 - (uVar1 & 0xfffffffffffffff0)) = 0x18000a488;
FUN_180028070(DAT_180091970);
return;
}
=========================================
Function at address: 0x18000a498
Called functions addresses: 0x180028d90 0x180028070 0xEXTERNAL:000000b4 0xEXTERNAL:000000db


void FUN_18000a498(undefined8 param_1)

{
int iVar1;
undefined auStack_c8 [32];
undefined local_a8 [4];
undefined local_a4 [12];
undefined local_98 [4];
undefined local_94 [4];
undefined local_90 [120];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_c8;
memset(local_98,0,0x80);
iVar1 = RtlIpv4StringToAddressExW(param_1,1,local_94,local_a8);
if (iVar1 < 0) {
RtlIpv6StringToAddressExW(param_1,local_90,local_a4,local_a8);
}
FUN_180028070(local_18 ^ (ulonglong)auStack_c8);
return;
}
=========================================
Function at address: 0x18000a534
Called functions addresses: 0x18002a77b


void FUN_18000a534(undefined *param_1,undefined param_2,void *param_3,uint param_4,
undefined4 param_5,int param_6)

{
undefined uVar1;
undefined uVar2;

*param_1 = param_2;
uVar2 = (undefined)(param_4 >> 8);
uVar1 = (undefined)(param_4 >> 0x10);
if (param_6 != 0) {
param_1[5] = (char)param_5;
param_1[4] = (char)((uint)param_5 >> 8);
param_1[9] = uVar1;
*(undefined2 *)(param_1 + 7) = 0;
param_1[6] = 0;
param_1[0xb] = (char)param_4;
param_1[10] = uVar2;
}
param_1[1] = uVar1;
param_1[3] = (char)param_4;
param_1[2] = uVar2;
if (param_3 != (void *)0x0) {
memcpy(param_1 + (ulonglong)(-(uint)(param_6 != 0) & 8) + 4,param_3,(ulonglong)param_4);
return;
}
return;
}
=========================================
Function at address: 0x18000a590
Called functions addresses: 0x1800152c4 0x1800174c8 0x18002a7c0 0x180041cb0 0x1800615c8 0x18005b470 0x18000ad34 0x1800613d0 0x18002a76f 0x180041d20


ulonglong FUN_18000a590(longlong param_1,int param_2,byte *param_3,ushort param_4)

{
ushort *puVar1;
ulonglong *puVar2;
byte bVar3;
uint uVar4;
longlong lVar5;
uint uVar6;
undefined8 *puVar7;
int iVar8;
int *piVar9;
longlong *plVar10;
ulonglong uVar11;
undefined2 uVar12;
undefined4 uVar13;
uint uVar14;
uint uVar15;
byte *pbVar16;

uVar14 = 0;
uVar6 = (uint)param_4;
iVar8 = 5;
if (param_2 == 5) {
puVar2 = (ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
*puVar2 = *puVar2 | 0x20000;
LAB_18000a6d8:
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),1,iVar8);
return 0;
}
if (param_2 == 6) {
if (param_4 == 0) {
return 0x80090326;
}
bVar3 = *param_3;
pbVar16 = param_3 + 1;
if ((uint)bVar3 != uVar6 - 1) {
return 0x80090326;
}
if (*(char *)(param_1 + 0x34) == '\0') {
return 0;
}
if (bVar3 != 0) {
do {
if (*pbVar16 == 0x40) {
*(undefined *)(*(longlong *)(param_1 + 8) + 0x39a) = 1;
break;
}
uVar14 = uVar14 + 1;
pbVar16 = pbVar16 + 1;
} while (uVar14 < bVar3);
}
iVar8 = 6;
goto LAB_18000a6d8;
}
if (param_2 == 0xe) {
if (((*(uint *)(*(longlong **)(param_1 + 0x38) + 0x11) >> 0xd & 1) == 0) ||
(0xff < (ushort)(param_4 - 5))) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x25;
}
else if (CONCAT11(*param_3,param_3[1]) == 2) {
bVar3 = param_3[4];
pbVar16 = (byte *)0x0;
if ((bVar3 == 0) || (pbVar16 = param_3 + 5, (ushort)bVar3 <= (ushort)(param_4 - 5))) {
uVar11 = FUN_1800613d0(*(longlong **)(param_1 + 0x38),(short *)(param_3 + 2),2,
(longlong)pbVar16,bVar3);
if ((int)uVar11 != 0) {
return uVar11;
}
iVar8 = 0xe;
goto LAB_18000a6d8;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x27;
}
else {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x26;
}
LAB_1800355b4:
FUN_180041cb0(DAT_180091000[2],uVar12,&DAT_180082c68);
return 0x80090326;
}
if (param_2 == 0x10) {

if ((piVar9 == (int *)0x0) || (*piVar9 == 0)) {
if (((*(uint *)(*(longlong *)(param_1 + 8) + 0x88) >> 0x1a & 1) == 0) ||
(0xfe < (ushort)(param_4 - 4))) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x22;
}
else {
if ((uint)CONCAT11(*param_3,param_3[1]) == uVar6 - 2) {
uVar11 = FUN_1800152c4(*(longlong **)(param_1 + 0x38),param_3 + 2,
CONCAT11(*param_3,param_3[1]));
if ((int)uVar11 != 0) {
return uVar11;
}
iVar8 = 0x10;
goto LAB_18000a6d8;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x23;
}
}
else {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x21;
}
goto LAB_1800355b4;
}
if (param_2 == 0x17) {
if (*(char *)(*(longlong *)(param_1 + 0x38) + 0x540) == '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x24,&DAT_180082c68);
}
lVar5 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
if (lVar5 == 0) {
return 0x80090326;
}
if (DAT_1800927ac == '\0') {
return 0x80090326;
}
puVar1 = (ushort *)(lVar5 + 0x42);
*puVar1 = *puVar1 | 4;
return 0x80090326;
}
iVar8 = 0x17;
puVar2 = (ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
*puVar2 = *puVar2 | 0x8000000;
goto LAB_18000a6d8;
}
if (param_2 == 0x18) {
if ((*(int *)(*(longlong **)(param_1 + 0x38) + 0x11) < 0) && (3 < uVar6)) {
if (((ushort)param_3[2] <= (ushort)(param_4 - 3)) && (param_3[2] == 1)) {
uVar11 = FUN_1800615c8(*(longlong **)(param_1 + 0x38),*param_3,param_3[1],
(char *)(param_3 + 3),(ushort)param_3[2]);
if ((int)uVar11 != 0) {
return uVar11;
}
iVar8 = 0x18;
goto LAB_18000a6d8;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x29;
}
else {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x28;
}
goto LAB_1800355b4;
}
if (param_2 == 0x23) {
iVar8 = 0x23;
puVar2 = (ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
*puVar2 = *puVar2 | 0x400000;
goto LAB_18000a6d8;
}
if (param_2 != 0xff01) {
FUN_1800174c8(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),param_2);
return 0;
}
plVar10 = *(longlong **)(param_1 + 8);
if ((*(int *)(plVar10 + 0x34) != 0) && (*(char *)((longlong)plVar10 + 0x229) == '\0')) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2a,&DAT_180082c68);
plVar10 = *(longlong **)(param_1 + 8);
}
FUN_18005b470(plVar10,0x4b7,0x80090346,0x28);
lVar5 = *(longlong *)(param_1 + 8);
*(undefined4 *)(lVar5 + 0x44) = 0x60;
*(undefined2 *)(lVar5 + 0x60) = 0x2802;
return 0x80090346;
}
*(undefined *)((longlong)plVar10 + 0x229) = 1;
plVar10 = *(longlong **)(param_1 + 8);
uVar14 = *(uint *)(plVar10 + 0x34);
uVar4 = *(uint *)(plVar10 + 0x39);
if (param_4 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x2b;
goto LAB_1800355b4;
}
uVar15 = (uint)*param_3;
if (*param_3 + 1 != uVar6) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) == 0) {
return 0x80090326;
}
FUN_180041d20(DAT_180091000[2],0x2c,&DAT_180082c68,uVar15,(char)param_4);
return 0x80090326;
}
if (param_4 == 1) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2d,&DAT_180082c68);
}
if (uVar4 == 0) {
return 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041d20(DAT_180091000[2],0x2e,&DAT_180082c68,uVar6,(char)uVar4);
}
uVar13 = 0x4b7;
}
else {
if (uVar15 != uVar14 + uVar4) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041d20(DAT_180091000[2],0x2f,&DAT_180082c68,uVar15,(char)uVar14);
plVar10 = *(longlong **)(param_1 + 8);
}
uVar13 = 0x4b7;
goto LAB_1800350c2;
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0) {
FUN_180041cb0(DAT_180091000[2],0x30,&DAT_180082c68);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0) {
FUN_180041cb0(DAT_180091000[2],0x31,&DAT_180082c68);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0) {
FUN_180041cb0(DAT_180091000[2],0x32,&DAT_180082c68);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x33,&DAT_180082c68);
}
}
}
}
puVar7 = DAT_180091000;
iVar8 = memcmp(param_3 + 1,(void *)((longlong)plVar10 + 0x179),(ulonglong)uVar14);
if (iVar8 == 0) {
iVar8 = memcmp(param_3 + 1 + uVar14,(void *)((longlong)plVar10 + 0x1a4),(ulonglong)uVar4);
if (iVar8 == 0) {
iVar8 = 0xff01;
goto LAB_18000a6d8;
}
if (((undefined8 **)puVar7 != &DAT_180091000) &&
((*(byte *)((longlong)puVar7 + 0x1c) & 1) != 0)) {
uVar12 = 0x35;
goto LAB_1800352bc;
}
}
else if (((undefined8 **)puVar7 != &DAT_180091000) &&
((*(byte *)((longlong)puVar7 + 0x1c) & 1) != 0)) {
uVar12 = 0x34;
LAB_1800352bc:
FUN_180041cb0(puVar7[2],uVar12,&DAT_180082c68);
}
uVar13 = 0x6c;
}
plVar10 = *(longlong **)(param_1 + 8);
LAB_1800350c2:
FUN_18005b470(plVar10,uVar13,0x80090346,0x28);
lVar5 = *(longlong *)(param_1 + 8);
*(undefined4 *)(lVar5 + 0x44) = 0x60;
*(undefined2 *)(lVar5 + 0x60) = 0x2802;
return 0x80090346;
}
=========================================
Function at address: 0x18000a7d4
Called functions addresses: 0x180041cdc 0x18002a7c0 0x180041cb0 0x180015e38 0x18000ad34 0x18000adf4 0x18002a77b 0x180041d20


/* WARNING: Removing unreachable block (ram,0x00018000aa53) */
/* WARNING: Removing unreachable block (ram,0x00018000aa8e) */
/* WARNING: Removing unreachable block (ram,0x000180035669) */
/* WARNING: Removing unreachable block (ram,0x00018000aa98) */
/* WARNING: Removing unreachable block (ram,0x00018000acdc) */
/* WARNING: Removing unreachable block (ram,0x00018000ad14) */
/* WARNING: Removing unreachable block (ram,0x00018000ad1d) */
/* WARNING: Removing unreachable block (ram,0x00018000acf6) */
/* WARNING: Removing unreachable block (ram,0x00018000aaa3) */

undefined8 FUN_18000a7d4(longlong param_1,uint param_2,undefined *param_3,uint *param_4)

{
ushort *puVar1;
ulonglong *puVar2;
ushort uVar3;
byte *pbVar4;
int iVar5;
short sVar6;
longlong lVar7;
undefined8 uVar8;
longlong lVar9;
ulonglong uVar10;
undefined *puVar11;
undefined2 *puVar12;
undefined2 *puVar13;
byte bVar14;
uint uVar15;
int iVar16;
bool bVar17;
undefined2 *local_res18 [2];

uVar15 = *(uint *)(param_1 + 0x14);
if (uVar15 != 0) {
if (param_2 < uVar15) {
return 0xea;
}
*param_4 = param_2;
puVar12 = (undefined2 *)(param_3 + 2);
*param_3 = (char)(uVar15 - 2 >> 8);
iVar16 = 1;
param_3[1] = *(char *)(param_1 + 0x14) + -2;
local_res18[0] = puVar12;
if (((*(uint *)(*(longlong *)(param_1 + 8) + 0x40) & 0x2a88) != 0) ||
((*(byte *)(*(longlong *)(param_1 + 8) + 0x40) & 0x20) == 0)) {
if (*(longlong *)(param_1 + 0x28) != 0) {
*puVar12 = 0;
param_3[4] = (char)((uint)(*(int *)(param_1 + 0x30) + 5) >> 8);
param_3[5] = *(char *)(param_1 + 0x30) + '\x05';
param_3[6] = (char)((uint)(*(int *)(param_1 + 0x30) + 3) >> 8);
param_3[7] = *(char *)(param_1 + 0x30) + '\x03';
param_3[8] = 0;
param_3[9] = *(undefined *)(param_1 + 0x31);
param_3[10] = *(undefined *)(param_1 + 0x30);
memcpy(param_3 + 0xb,*(void **)(param_1 + 0x28),(ulonglong)*(uint *)(param_1 + 0x30));
iVar16 = 0;
puVar12 = (undefined2 *)(param_3 + 0xb + *(uint *)(param_1 + 0x30));
local_res18[0] = puVar12;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0);
iVar16 = iVar16 + 1;
}
if (*(char *)(param_1 + 0x18) != '\0') {
*(undefined *)puVar12 = 0;
*(undefined8 *)((longlong)puVar12 + 1) = 0x1050005;
puVar12 = (undefined2 *)((longlong)puVar12 + 9);
local_res18[0] = puVar12;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,5);
}
puVar13 = puVar12;
if (*(char *)(param_1 + 0x19) != '\0') {
*(undefined *)puVar12 = 0;
*(undefined4 *)((longlong)puVar12 + 1) = 0x1020006;
puVar13 = puVar12 + 3;
*(undefined *)((longlong)puVar12 + 5) = 0x40;
*(char *)(*(longlong *)(param_1 + 8) + 0x39a) = (char)iVar16;
local_res18[0] = puVar13;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,6);
}
if (*(char *)(param_1 + 0x20) != '\0') {
uVar3 = *(ushort *)(*(longlong *)(param_1 + 0x38) + 0x398);
*(undefined *)puVar13 = 0;
iVar5 = (uint)uVar3 * 2;
*(undefined *)((longlong)puVar13 + 1) = 10;
*(char *)(puVar13 + 1) = (char)((uint)(iVar5 + 2) >> 8);
*(char *)((longlong)puVar13 + 3) = (char)iVar5 + '\x02';
*(char *)(puVar13 + 2) = (char)((uint)iVar5 >> 8);
*(char *)((longlong)puVar13 + 5) = (char)iVar5;
puVar12 = puVar13 + 3;
bVar17 = *(short *)(*(longlong *)(param_1 + 0x38) + 0x398) != 0;
uVar10 = 0;
while (bVar17) {
uVar15 = (int)uVar10 + iVar16;
*(undefined *)puVar12 =
*(undefined *)(*(longlong *)(*(longlong *)(param_1 + 0x38) + 0x390) + 1 + uVar10 * 2)
;
*(undefined *)((longlong)puVar12 + 1) =
*(undefined *)(*(longlong *)(*(longlong *)(param_1 + 0x38) + 0x390) + uVar10 * 2);
puVar12 = puVar12 + 1;
bVar17 = uVar15 < *(ushort *)(*(longlong *)(param_1 + 0x38) + 0x398);
uVar10 = (ulonglong)uVar15;
}
iVar16 = 0;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,10);
*(undefined *)puVar12 = 0;
*(undefined4 *)((longlong)puVar12 + 1) = 0x102000b;
puVar13 = puVar12 + 3;
*(undefined *)((longlong)puVar12 + 5) = 0;
local_res18[0] = puVar13;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),iVar16,iVar16 + 0xb);
}
lVar9 = *(longlong *)(param_1 + 0x38);
if (*(char *)(lVar9 + 0x39d) != '\0') {
uVar3 = *(ushort *)(lVar9 + 0x1da);
*(undefined *)puVar13 = 0;
*(undefined *)((longlong)puVar13 + 1) = 0xd;
uVar15 = (uint)uVar3 * 2 + 2;
*(char *)(puVar13 + 1) = (char)(uVar15 >> 8);
*(char *)((longlong)puVar13 + 3) = (char)uVar15;
FUN_18000adf4((ushort *)(lVar9 + 0x1da),(undefined *)(puVar13 + 2),uVar15);
puVar13 = (undefined2 *)((ulonglong)uVar15 + (longlong)(puVar13 + 2));
local_res18[0] = puVar13;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0xd);
lVar9 = *(longlong *)(param_1 + 0x38);
}

lVar7 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x310);
if (lVar7 != 0) {
uVar3 = *(ushort *)(lVar7 + 4);
*(undefined *)puVar13 = 0;
*(undefined *)((longlong)puVar13 + 1) = 0x10;
*(char *)(puVar13 + 1) = (char)(uVar3 + 2 >> 8);
*(char *)((longlong)puVar13 + 3) = (char)(uVar3 + 2);
*(char *)(puVar13 + 2) = (char)(uVar3 >> 8);
*(char *)((longlong)puVar13 + 5) = (char)uVar3;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_180082c68,(uint)uVar3);
}
memcpy(puVar13 + 3,(void *)(lVar7 + 6),(ulonglong)uVar3);
puVar13 = (undefined2 *)((longlong)(puVar13 + 3) + (ulonglong)uVar3);
puVar2 = (ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
*puVar2 = *puVar2 | 0x4000000;
lVar9 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
local_res18[0] = puVar13;
FUN_18000ad34(lVar9,0,0x10);
}
lVar7 = *(longlong *)(param_1 + 0x38);
if (*(char *)(lVar7 + 0x540) == '\0') {
sVar6 = 1;
}
else {
*(undefined *)puVar13 = 0;
puVar12 = puVar13 + 2;
*(undefined *)((longlong)puVar13 + 1) = 0x17;
local_res18[0] = puVar12;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180082c68);
}
lVar9 = *(longlong *)(param_1 + 8);
sVar6 = 1;
if ((*(longlong *)(lVar9 + 0x78) != 0) && (DAT_1800927ac != '\0')) {
puVar1 = (ushort *)(*(longlong *)(lVar9 + 0x78) + 0x42);
*puVar1 = *puVar1 | 1;
lVar9 = *(longlong *)(param_1 + 8);
}
lVar9 = *(longlong *)(lVar9 + 0x78);
FUN_18000ad34(lVar9,0,0x17);
lVar7 = *(longlong *)(param_1 + 0x38);
puVar13 = puVar12;
}
if ((*(char *)(lVar7 + 0xe9) != '\0') &&
(puVar1 = *(ushort **)(lVar7 + 800), puVar1 != (ushort *)0x0)) {
uVar3 = *puVar1;
uVar10 = (ulonglong)uVar3;
pbVar4 = *(byte **)(lVar7 + 0x538);
if (pbVar4 == (byte *)0x0) {
sVar6 = 1;
bVar14 = 0;
}
else {
bVar14 = *pbVar4;
sVar6 = (ushort)bVar14 + sVar6;
}
sVar6 = uVar3 + 2 + sVar6;
*puVar13 = 0xe00;
*(char *)(puVar13 + 1) = (char)((ushort)sVar6 >> 8);
*(char *)((longlong)puVar13 + 3) = (char)sVar6;
*(char *)(puVar13 + 2) = (char)(uVar3 >> 8);
*(char *)((longlong)puVar13 + 5) = (char)uVar3;
puVar13 = puVar13 + 3;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],0xd,&DAT_180082c68,(uint)uVar3,bVar14);
}
memcpy(puVar13,puVar1 + 1,uVar10);
*(byte *)((longlong)puVar13 + uVar10) = bVar14;
puVar11 = (undefined *)(uVar10 + 1 + (longlong)puVar13);
if (pbVar4 != (byte *)0x0) {
memcpy(puVar11,pbVar4 + 1,(ulonglong)bVar14);
}
puVar13 = (undefined2 *)(puVar11 + bVar14);
puVar2 = (ulonglong *)(*(longlong *)(param_1 + 0x38) + 0x88);
*puVar2 = *puVar2 | 0x2000;
lVar9 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
local_res18[0] = puVar13;
FUN_18000ad34(lVar9,0,0xe);
lVar7 = *(longlong *)(param_1 + 0x38);
}
puVar11 = *(undefined **)(lVar7 + 0x330);
puVar12 = puVar13;
if (puVar11 != (undefined *)0x0) {
uVar8 = FUN_180015e38(lVar9,*puVar11,puVar11[1],puVar11 + 4,puVar11[2],
(ulonglong)(param_3 + param_2),(longlong *)local_res18);
if ((int)uVar8 != 0) {
return uVar8;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xe,&DAT_180082c68,(uint)*(ushort *)(puVar11 + 2));
}
puVar2 = (ulonglong *)(*(longlong *)(param_1 + 0x38) + 0x88);
*puVar2 = *puVar2 | 0x80000000;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0x18);
puVar12 = local_res18[0];
}
}
if (*(char *)(param_1 + 0x1a) != '\0') {
lVar9 = *(longlong *)(param_1 + 0x38);
uVar15 = *(uint *)(lVar9 + 0x1a0);
*puVar12 = 0x1ff;
*(char *)(puVar12 + 1) = (char)(uVar15 + 1 >> 8);
*(char *)((longlong)puVar12 + 3) = (char)uVar15 + '\x01';
*(char *)(puVar12 + 2) = (char)uVar15;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180082c68);
}
if (uVar15 != 0) {
memcpy((undefined *)((longlong)puVar12 + 5),(void *)(lVar9 + 0x179),(ulonglong)uVar15);
}
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0xff01);
}
}
return 0;
}
=========================================
Function at address: 0x18000ad34
Called functions addresses: None


void FUN_18000ad34(longlong param_1,int param_2,int param_3)

{
if ((param_1 != 0) && (DAT_1800927ac != '\0')) {
if (param_3 == 10) {
param_3 = 7;
}
else if (param_3 == 0xb) {
param_3 = 8;
}
else if (param_3 == 0xd) {
param_3 = 9;
}
else if (param_3 == 0xe) {
param_3 = 10;
}
else if (param_3 == 0x10) {
param_3 = 0xb;
}
else if (param_3 == 0x17) {
param_3 = 0xc;
}
else if (param_3 == 0x18) {
param_3 = 0xf;
}
else if (param_3 == 0x23) {
param_3 = 0xd;
}
else if (param_3 == 0xff01) {
param_3 = 0x10;
}
if (param_2 == 0) {
*(uint *)(param_1 + 0x44) = *(uint *)(param_1 + 0x44) | 1 << ((byte)param_3 & 0x1f);
return;
}
if (param_2 == 1) {
*(uint *)(param_1 + 0x48) = *(uint *)(param_1 + 0x48) | 1 << ((byte)param_3 & 0x1f);
return;
}
}
return;
}
=========================================
Function at address: 0x18000adf4
Called functions addresses: 0x18002a77b


void FUN_18000adf4(ushort *param_1,undefined *param_2,uint param_3)

{
uint uVar1;

if (param_2 != (undefined *)0x0) {
uVar1 = (uint)*param_1 * 2;
if (uVar1 + 2 <= param_3) {
*param_2 = (char)(uVar1 >> 8);
param_2[1] = (char)uVar1;
memcpy(param_2 + 2,param_1 + 1,(ulonglong)uVar1);
}
}
return;
}
=========================================
Function at address: 0x18000ae3c
Called functions addresses: 0x180008a4c 0x18000eabc 0x18000af8c 0x18000eb48 0x180006f5c 0x180028070


void FUN_18000ae3c(longlong *param_1,uint *param_2)

{
ushort *puVar1;
uint uVar2;
undefined8 uVar3;
ulonglong uVar4;
longlong *plVar5;
undefined auStackY_1d8 [32];
undefined8 in_stack_fffffffffffffe48;
uint local_198 [2];
longlong lStack_190;
uint local_188 [88];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStackY_1d8;
local_198[0] = 0;
local_198[1] = 0;
lStack_190 = 0;
if ((*(int *)((longlong)param_1 + 0x51c) == 0) ||
(plVar5 = param_1, *(int *)((longlong)param_1 + 0x44) == 4)) {
uVar2 = FUN_18000eb48((longlong)param_1);
plVar5 = (longlong *)(ulonglong)uVar2;
if (uVar2 == 0) goto LAB_18000ae88;
}
else {
LAB_18000ae88:
if ((*(uint *)(param_1 + 8) & 0x80800) != 0) {
puVar1 = (ushort *)((longlong)param_1 + 0x1da);
FUN_18000eabc(plVar5,puVar1);
uVar2 = *(uint *)(param_1[10] + 0xc4);
if (uVar2 != 0) {
uVar3 = FUN_180006f5c(puVar1,*(uint **)(param_1[10] + 200),uVar2);
if ((int)uVar3 != 0) goto LAB_18000af62;
if (*puVar1 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180086390);
}
goto LAB_18000af62;
}
}
*(undefined *)((longlong)param_1 + 0x39d) = 1;
}
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
uVar2 = 0xaa0;
}
else {
uVar2 = *(uint *)(param_1 + 8);
}
uVar3 = FUN_18000af8c((longlong)param_1,local_188,*(uint *)(param_1[10] + 0x98) & uVar2,
param_1 + 0x22,in_stack_fffffffffffffe48,param_1 + 0x72,
(undefined2 *)(param_1 + 0x73));
uVar2 = (uint)uVar3;
if (uVar2 == 0) {
uVar4 = FUN_180008a4c(param_1,(undefined *)local_188,local_198);
uVar2 = (uint)uVar4;
}
}
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
if ((uVar2 != 0) || (lStack_190 == 0)) goto LAB_18000af62;
if ((*(int *)((longlong)param_1 + 0x51c) == 0) || (*(int *)((longlong)param_1 + 0x44) == 4)) {
FUN_18006f874(param_1,local_198,param_2);
goto LAB_18000af62;
}
}
*(longlong *)(param_2 + 2) = lStack_190;
param_2[1] = local_198[1];
*param_2 = local_198[0];
LAB_18000af62:
FUN_180028070(local_28 ^ (ulonglong)auStackY_1d8);
return;
}
=========================================
Function at address: 0x18000af8c
Called functions addresses: 0x18000d31c 0x18000706c 0x18002a77b


undefined8
FUN_18000af8c(longlong param_1,uint *param_2,uint param_3,undefined8 *param_4,undefined8 param_5,
longlong *param_6,undefined2 *param_7)

{
longlong lVar1;
int *piVar2;
undefined8 uVar3;
undefined8 uVar4;
ulonglong uVar5;
uint uVar6;
uint uVar7;
uint uVar8;

lVar1 = *(longlong *)(param_1 + 0x50);
piVar2 = *(int **)(lVar1 + 0xb8);
uVar8 = *(uint *)(lVar1 + 0xb0);
uVar6 = *(uint *)(lVar1 + 0xc0);
param_2[1] = 0x44;
uVar4 = FUN_18000706c(param_1,piVar2,uVar8,uVar6,lVar1,param_3,(longlong)(param_2 + 0x14),
param_2 + 1,param_6,param_7);
uVar8 = 0;
if ((int)uVar4 == 0) {
uVar5 = FUN_18000d31c(param_3);
uVar6 = (uint)uVar5 & 0xffff;
uVar7 = uVar8 + 0x20;
param_2[2] = uVar8;
if ((uVar5 & 0xffff) == 0) {
uVar6 = 0x300;
}
*param_2 = uVar6;
if ((*(longlong *)(param_1 + 0x58) != 0) &&
((ushort)uVar8 < *(ushort *)(*(longlong *)(param_1 + 0x58) + 0xee))) {
param_2[2] = uVar7;
lVar1 = *(longlong *)(param_1 + 0x58);
if (*(ushort *)(lVar1 + 0xee) <= uVar7) {
param_2[2] = (uint)*(ushort *)(lVar1 + 0xee);
memcpy(param_2 + 4,(void *)(lVar1 + 0xf0),(ulonglong)*(ushort *)(lVar1 + 0xee));
}
}
uVar3 = param_4[1];
uVar4 = 0;
*(undefined8 *)(param_2 + 0xc) = *param_4;
*(undefined8 *)(param_2 + 0xe) = uVar3;
uVar3 = param_4[3];
*(undefined8 *)(param_2 + 0x10) = param_4[2];
*(undefined8 *)(param_2 + 0x12) = uVar3;
param_2[3] = uVar7;
}
return uVar4;
}
=========================================
Function at address: 0x18000b0b0
Called functions addresses: 0x18000e850 0x18002a7c0 0x180041cb0 0x180041d20 0x18000b190 0x180041e9c


ulonglong FUN_18000b0b0(longlong param_1,uint *param_2,undefined *param_3,ulonglong param_4)

{
int iVar1;
ulonglong uVar2;
ulonglong uVar3;
uint *puVar4;

puVar4 = param_2;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
puVar4 = (uint *)0xd;
param_3 = &DAT_180082b10;
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180082b10);
}
iVar1 = FUN_18000e850(1,puVar4,param_3,param_4);
if (iVar1 == 0) {
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cb0(DAT_180091000[2],0xe,&DAT_180082b10);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0xf,&DAT_180082b10,0x80090304,4);
}
}
uVar3 = 0x80090304;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x10,&DAT_180082b10,param_1);
}
uVar2 = FUN_18000b190(param_1,0,param_2,0);
uVar3 = uVar2 & 0xffffffff;
if (DAT_1800921a0 != 0) {

param_2[2] = 0;
param_2[3] = 0;
*param_2 = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && ((int)uVar2 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x11,&DAT_180082b10,(int)uVar2,(char)uVar2);
}
}
return uVar3;
}
=========================================
Function at address: 0x18000b190
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0x180041cb0 0x18000b400 0x18004497c 0x18000b32c 0x180041d20 0x180041e9c


undefined8 FUN_18000b190(longlong param_1,longlong param_2,uint *param_3,int param_4)

{
longlong *plVar1;
longlong *plVar2;
undefined8 uVar3;
code *pcVar4;
int iVar5;
longlong lVar6;
undefined8 *puVar7;
uint uVar8;
undefined *puVar9;
longlong lVar10;
longlong local_res18;
undefined auStack_68 [8];
undefined auStack_60 [24];
undefined8 local_38;
undefined8 uStack_30;
undefined8 local_28;
undefined4 local_20;
undefined4 local_1c;

puVar9 = auStack_68;
local_28 = 0;
local_20 = 0;
local_1c = 0;
local_38 = 0;
uStack_30 = 0;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180085418);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0xc,&DAT_180085418,param_1);
}
}
if (param_4 == 0) {
FUN_18000b400(param_1);
}
iVar5 = FUN_18000b32c((longlong)&local_38,*(int **)(param_3 + 2),*param_3,&local_res18);
if (iVar5 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0xd,&DAT_180085418,0x80090330,0x30);
}
return 0x80090330;
}
if ((param_2 != 0) || (param_4 != 0)) {
*(longlong *)(local_res18 + 0x108) = param_2;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18004497c(DAT_180091000[2],0xe,&DAT_180085418,local_res18,(char)param_1);
}
*(longlong *)(local_res18 + 0x120) = param_1;
uVar8 = ((uint)param_1 >> 8) +
((uint)((ulonglong)param_1 >> 0x10) & 0xffff) + (uint)param_1 +
((uint)((ulonglong)param_1 >> 0x18) & 0xff);
uVar8 = uVar8 + (uVar8 >> 4) & DAT_1800919e0 - 1U;
lVar10 = (ulonglong)(DAT_1800919e4 - 1U & uVar8) * 0x60;
RtlAcquireResourceExclusive(DAT_1800921d0 + lVar10,1);
plVar1 = (longlong *)(local_res18 + 0x130);
lVar6 = (ulonglong)uVar8 * 0x10 + DAT_1800921c8;
plVar2 = *(longlong **)(lVar6 + 8);
if (*plVar2 == lVar6) {
*plVar1 = lVar6;
*(longlong **)(local_res18 + 0x138) = plVar2;
*plVar2 = (longlong)plVar1;
*(longlong **)(lVar6 + 8) = plVar1;
RtlReleaseResource(DAT_1800921d0 + lVar10);
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
puVar7 = DAT_180091000;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0;
}
}
else {
puVar7 = (undefined8 *)0x3;
pcVar4 = (code *)swi(0x29);
(*pcVar4)();
puVar9 = auStack_60;
}
*(undefined4 *)(puVar9 + 0x20) = 0;
uVar3 = puVar7[2];
*(undefined8 *)(puVar9 + -8) = 0x180035a24;
FUN_180041d20(uVar3,0xf,&DAT_180085418,0,puVar9[0x20]);
return 0;
}
=========================================
Function at address: 0x18000b32c
Called functions addresses: 0x18000b448 0x18000ed60 0x1800432ec 0x18000e778


int FUN_18000b32c(longlong param_1,int *param_2,uint param_3,undefined8 *param_4)

{
uint uVar1;
int iVar2;
undefined8 *puVar3;
uint uVar4;
int *piVar5;

*param_4 = 0;
uVar4 = 0;
*(uint *)(param_1 + 0x18) = param_3;
piVar5 = (int *)((ulonglong)param_3 + (longlong)param_2);
*(int **)(param_1 + 8) = param_2;
do {
if (piVar5 < param_2 + 4) {
LAB_18000b3a1:
iVar2 = -0x7ff6fcfc;
LAB_180035a75:
if ((undefined8 *)*param_4 != (undefined8 *)0x0) {
FUN_18000ed60((undefined8 *)*param_4);
}
return iVar2;
}
uVar1 = param_2[1];
if (uVar1 < (uint)param_2[2]) goto LAB_18000b3a1;
iVar2 = *param_2;
if (iVar2 == 0) {
puVar3 = FUN_18000e778(uVar4);
*param_4 = puVar3;
if (puVar3 == (undefined8 *)0x0) {
iVar2 = -0x7ff6fd00;
}
else {
iVar2 = FUN_18000b448(param_1,(longlong)puVar3);
if (iVar2 == 0) {
return 0;
}
}
goto LAB_180035a75;
}
if (iVar2 == 1) {
if (uVar1 < 200) goto LAB_18000b3a1;
uVar4 = 0x1d0;
}
else {
if (iVar2 < 2) {
LAB_180035a34:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],0xb,&DAT_180085388,iVar2);
}
goto LAB_18000b3a1;
}
if (3 < iVar2) {
if (iVar2 < 0x12) {
uVar4 = uVar4 + (param_2[2] + 7U & 0xfffffff8);
}
else if (0x14 < iVar2) goto LAB_180035a34;
}
}
param_2 = (int *)((longlong)param_2 + (ulonglong)(uVar1 + 0x10));
} while( true );
}
=========================================
Function at address: 0x18000b400
Called functions addresses: 0x18000ed60 0x18000c774 0x180035a8c


void FUN_18000b400(longlong param_1)

{
longlong *plVar1;

plVar1 = FUN_18000c774(param_1,'\x01');
if (plVar1 == (longlong *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180035a8c((longlong)DAT_180091000);
return;
}
}
else {
FUN_18000ed60(plVar1);
}
return;
}
=========================================
Function at address: 0x18000b448
Called functions addresses: 0x180041dd8 0x180035c6a 0x1800432ec 0x18002a77b 0xEXTERNAL:00000122 0x18000e5e4


int FUN_18000b448(longlong param_1,longlong param_2)

{
int *piVar1;
undefined8 *puVar2;
undefined8 uVar3;
int iVar4;
longlong lVar5;
int *_Src;
undefined8 *puVar6;
undefined8 *_Dst;
int *piVar7;
ulonglong _Size;
int iVar8;
wchar_t *pwVar9;

piVar7 = *(int **)(param_1 + 8);
iVar4 = 0;
if (*piVar7 != 1) {
return -0x7ff6fcfc;
}
_Dst = (undefined8 *)(param_2 + 0x1d0);
iVar8 = 1;
do {
_Src = piVar7 + 4;
if (iVar8 < 0xb) {
if (iVar8 == 10) {
*(undefined8 **)(param_2 + 0xe8) = _Dst;
memcpy(_Dst,_Src,(ulonglong)(uint)piVar7[2]);
*(int *)(param_2 + 0xf0) = piVar7[2];
goto LAB_18000b5b3;
}
if (5 < iVar8) {
if (iVar8 == 6) {
*(undefined8 **)(param_2 + 0xb8) = _Dst;
memcpy(_Dst,_Src,(ulonglong)(uint)piVar7[2]);
*(int *)(param_2 + 0xc0) = piVar7[2];
}
else if (iVar8 == 7) {
*(undefined8 **)(param_2 + 200) = _Dst;
memcpy(_Dst,_Src,(ulonglong)(uint)piVar7[2]);
*(int *)(param_2 + 0xd0) = piVar7[2];
}
else {
if (iVar8 != 8) {
if (iVar8 != 9) goto LAB_180035c8a;
*(undefined8 **)(param_2 + 0x50) = _Dst;
_Size = (ulonglong)(uint)piVar7[2];
memcpy(_Dst,_Src,_Size);
_Dst = (undefined8 *)
((longlong)_Dst + ((ulonglong)(uint)piVar7[2] + 7 & 0xfffffffffffffff8));
iVar4 = FUN_18000e5e4(*(wchar_t **)(param_2 + 0x50),(longlong *)(param_2 + 0x58),_Size);
if (iVar4 != 0) {
iVar4 = FUN_180035c6a();
return iVar4;
}
goto LAB_18000b5c1;
}
*(undefined8 **)(param_2 + 0xd8) = _Dst;
memcpy(_Dst,_Src,(ulonglong)(uint)piVar7[2]);
*(int *)(param_2 + 0xe0) = piVar7[2];
}
goto LAB_18000b5b3;
}
if (iVar8 == 5) {
*(undefined8 **)(param_2 + 0xa8) = _Dst;
memcpy(_Dst,_Src,(ulonglong)(uint)piVar7[2]);
*(int *)(param_2 + 0xb0) = piVar7[2];
goto LAB_18000b5b3;
}
if (iVar8 == 0) {
return 0;
}
if (iVar8 != 1) {
if (iVar8 < 2) {
LAB_180035c8a:
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcfc;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return -0x7ff6fcfc;
}
FUN_1800432ec(DAT_180091000[2],0xf,&DAT_180085388,iVar8);
return -0x7ff6fcfc;
}
if (iVar8 < 4) goto LAB_18000b4c0;
if (iVar8 != 4) goto LAB_180035c8a;
*(undefined8 **)(param_2 + 0x98) = _Dst;
memcpy(_Dst,_Src,(ulonglong)(uint)piVar7[2]);
*(int *)(param_2 + 0xa0) = piVar7[2];
goto LAB_18000b5b3;
}
*(int *)(param_2 + 8) = *_Src;
*(undefined8 *)(param_2 + 0x10) = *(undefined8 *)(piVar7 + 6);
*(int *)(param_2 + 0x18) = piVar7[8];
*(undefined *)(param_2 + 0x20) = *(undefined *)(piVar7 + 0xf);
*(int *)(param_2 + 0x1c) = piVar7[0xb];
*(undefined8 *)(param_2 + 0x60) = *(undefined8 *)(piVar7 + 0x10);
*(undefined8 *)(param_2 + 0x68) = *(undefined8 *)(piVar7 + 0x12);
*(int *)(param_2 + 0x38) = piVar7[9];
*(int *)(param_2 + 0x3c) = piVar7[10];
*(int *)(param_2 + 0x40) = piVar7[0xc];
*(int *)(param_2 + 0x48) = piVar7[0xd];
*(int *)(param_2 + 0x44) = piVar7[0x2a];
*(int *)(param_2 + 0x74) = piVar7[0x30];
*(undefined8 *)(param_2 + 0x78) = *(undefined8 *)(piVar7 + 0x2c);
*(undefined8 *)(param_2 + 0x80) = *(undefined8 *)(piVar7 + 0x2e);
*(undefined2 *)(param_2 + 0x88) = *(undefined2 *)(piVar7 + 0x31);
*(undefined2 *)(param_2 + 0x8a) = *(undefined2 *)((longlong)piVar7 + 0xc6);
*(int *)(param_2 + 0x90) = piVar7[0x32];
*(int *)(param_2 + 0x1cc) = piVar7[0x33];
*(undefined *)(param_2 + 0x1c8) = *(undefined *)(piVar7 + 0x34);
*(int *)(param_2 + 0xc4) = piVar7[0xe];
*(int *)(param_2 + 0x17c) = piVar7[0x29];
*(int *)(param_2 + 0x178) = piVar7[0x28];
*(undefined8 *)(param_2 + 0x108) = *(undefined8 *)(piVar7 + 0x14);
*(int *)(param_2 + 0x110) = piVar7[0x16];
*(undefined8 *)(param_2 + 0x128) = *(undefined8 *)(piVar7 + 0x18);
*(int *)(param_2 + 0x140) = piVar7[0x1a];
memcpy((void *)(param_2 + 0x144),piVar7 + 0x1b,(ulonglong)(uint)piVar7[0x1a]);
}
else {
if (iVar8 < 0x10) {
if (iVar8 == 0xf) {
*(undefined8 **)(param_2 + 0x198) = _Dst;
LAB_180035b40:
uVar3 = *(undefined8 *)(piVar7 + 6);
*_Dst = *(undefined8 *)_Src;
_Dst[1] = uVar3;
}
else if (iVar8 == 0xb) {
*(undefined8 **)(param_2 + 0xf8) = _Dst;
memcpy(_Dst,_Src,(ulonglong)(uint)piVar7[2]);
*(int *)(param_2 + 0x100) = piVar7[2];
}
else {
if (iVar8 != 0xc) {
if (iVar8 != 0xd) {
if (iVar8 != 0xe) goto LAB_180035c8a;
lVar5 = *(longlong *)(param_2 + 400);
goto LAB_180035c51;
}
*(undefined8 **)(param_2 + 400) = _Dst;
goto LAB_180035b40;
}
*(undefined8 **)(param_2 + 0x188) = _Dst;
lVar5 = 2;
puVar6 = _Dst;
do {
uVar3 = *(undefined8 *)(_Src + 2);
piVar1 = _Src + 0x20;
*puVar6 = *(undefined8 *)_Src;
puVar6[1] = uVar3;
puVar2 = puVar6 + 0x10;
uVar3 = *(undefined8 *)(_Src + 6);
puVar6[2] = *(undefined8 *)(_Src + 4);
puVar6[3] = uVar3;
uVar3 = *(undefined8 *)(_Src + 10);
puVar6[4] = *(undefined8 *)(_Src + 8);
puVar6[5] = uVar3;
uVar3 = *(undefined8 *)(_Src + 0xe);
puVar6[6] = *(undefined8 *)(_Src + 0xc);
puVar6[7] = uVar3;
uVar3 = *(undefined8 *)(_Src + 0x12);
puVar6[8] = *(undefined8 *)(_Src + 0x10);
puVar6[9] = uVar3;
uVar3 = *(undefined8 *)(_Src + 0x16);
puVar6[10] = *(undefined8 *)(_Src + 0x14);
puVar6[0xb] = uVar3;
uVar3 = *(undefined8 *)(_Src + 0x1a);
puVar6[0xc] = *(undefined8 *)(_Src + 0x18);
puVar6[0xd] = uVar3;
uVar3 = *(undefined8 *)(_Src + 0x1e);
puVar6[0xe] = *(undefined8 *)(_Src + 0x1c);
puVar6[0xf] = uVar3;
lVar5 = lVar5 + -1;
_Src = piVar1;
puVar6 = puVar2;
} while (lVar5 != 0);
*puVar2 = *(undefined8 *)piVar1;
}
}
else if (iVar8 == 0x10) {
lVar5 = *(longlong *)(param_2 + 0x198);
LAB_180035c51:
*(undefined8 **)(lVar5 + 8) = _Dst;
memcpy(_Dst,_Src,(ulonglong)(uint)piVar7[2]);
}
else {
if (iVar8 != 0x11) {
if (iVar8 == 0x12) {
LAB_18000b4c0:
if (param_2 == 0) {
return iVar4;
}
if (*(longlong *)(param_2 + 0x58) == 0) {
return iVar4;
}
if (iVar8 == 2) {
lVar5 = 0x28;
}
else {
lVar5 = 0x1b0;
if (iVar8 == 3) {
lVar5 = 0x30;
}
}
iVar4 = SslImportKey(*(undefined8 *)(param_2 + 0x58),lVar5 + param_2,L"OpaqueKeyBlob",
_Src,piVar7[2],0);
if (iVar4 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar4;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_180085388,iVar4);
return iVar4;
}
return iVar4;
}
}
else {
if ((iVar8 < 0x13) || (0x14 < iVar8)) goto LAB_180035c8a;
if (param_2 == 0) {
return iVar4;
}
if (*(longlong *)(param_2 + 0x58) == 0) {
return iVar4;
}
lVar5 = 0x1b8;
if (iVar8 != 0x13) {
lVar5 = 0x1c0;
}
iVar4 = SslImportKey(*(undefined8 *)(param_2 + 0x58),lVar5 + param_2,L"OpaqueKeyBlob",
_Src,piVar7[2],0);
if (iVar4 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar4;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
pwVar9 = L"read";
if (*piVar7 != 0x13) {
pwVar9 = L"write";
}
FUN_180041dd8(DAT_180091000[2],0xe,&DAT_180085388,pwVar9,(char)iVar4);
return iVar4;
}
return iVar4;
}
}
goto LAB_18000b5c1;
}
*(undefined8 **)(param_2 + 0x1a8) = _Dst;
memcpy(_Dst,_Src,(ulonglong)(uint)piVar7[2]);
*(int *)(param_2 + 0x1a0) = piVar7[2];
}
LAB_18000b5b3:
_Dst = (undefined8 *)((longlong)_Dst + ((ulonglong)(uint)piVar7[2] + 7 & 0xfffffffffffffff8));
}
LAB_18000b5c1:
piVar7 = (int *)((longlong)piVar7 + (ulonglong)(piVar7[1] + 0x10));
iVar8 = *piVar7;
} while( true );
}
=========================================
Function at address: 0x18000b810
Called functions addresses: 0x18000d7d0 0x18000c3a8 0x18002a7c0 0x18000d410 0x180009f90 0x18000e5b4 0x18000ebec 0x18000d6a8 0x18000d37c


void FUN_18000b810(longlong *param_1,int *param_2,longlong param_3,uint param_4,undefined8 param_5,
undefined8 *param_6,undefined8 *param_7,longlong param_8,undefined4 *param_9,
undefined8 *param_10,undefined *param_11,undefined4 *param_12)

{
int iVar1;
bool bVar2;
undefined4 *puVar3;
undefined uVar4;
int *piVar5;
uint *puVar6;
undefined8 uVar7;
ulonglong uVar8;
ulonglong *puVar9;
undefined8 *puVar10;
uint uVar11;
ulonglong uVar12;
wchar_t *pwVar13;
ulonglong uVar14;
longlong *plVar15;
ulonglong uVar16;
ulonglong uVar17;
int *piVar18;
int *piVar19;
undefined4 extraout_XMM0_Da;
int *local_f8;
uint local_f0;
uint local_ec;
void *local_e8;
undefined8 local_e0;
undefined8 local_d8;
undefined8 local_d0;
longlong local_c8;
longlong local_c0;
undefined8 local_b8;
longlong local_b0;
undefined8 local_a8;
uint *local_a0;
undefined4 *local_98;
uint *local_90;
undefined4 *local_88;
uint *local_80;
ulonglong *local_78;
uint local_70 [2];
undefined8 uStack_68;
uint *local_60;
int *local_58;
undefined4 local_50 [4];
undefined8 local_40;

piVar5 = (int *)0x0;
local_98 = (undefined4 *)0x0;
local_e0 = 0;
local_d0 = 0;
uVar14 = 0x1c;
local_d8 = 0;
local_c8 = 0;
local_b8 = 0;
piVar18 = (int *)0x0;
local_c0 = 0;
local_80 = (uint *)0x0;
local_a8 = 0;
local_b0 = 0;
local_90 = (uint *)0x0;
local_88 = (undefined4 *)0x0;
local_70[0] = 0;
local_70[1] = 0;
uStack_68 = 0;
local_f8 = (int *)0x0;
bVar2 = false;
local_78 = (ulonglong *)0x0;
uVar17 = (ulonglong)param_4;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0) {
FUN_180041cb0(DAT_180091000[2],0x17,&DAT_180084d00);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x18,&DAT_180084d00);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x19,&DAT_180084d00,param_1);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x1a,&DAT_180084d00,param_2);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1b,&DAT_180084d00,param_4);
}
}
}
}
}
if (((param_3 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x1c,&DAT_180084d00,*(wchar_t **)(param_3 + 8));
}
piVar19 = piVar5;
if (param_1 == (longlong *)0x0) {
uVar11 = 0x80090301;
goto LAB_18000bd46;
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x1d,&DAT_180084d00,*(undefined4 *)((longlong)param_1 + 0xd4));
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x1e,&DAT_180084d00,(wchar_t *)(param_1 + 0x1b));
}
}
puVar6 = FUN_18000d6a8(param_8,uVar17,&local_a0,&local_f0,&local_98,local_70,&local_80,&local_a8,
&local_88);
uVar11 = (uint)puVar6;
if (uVar11 == 0) {
uVar12 = (-(ulonglong)((param_4 & 0x4000) != 0) & 0x4000) + 0x1c;
uVar16 = (ulonglong)(-(uint)((param_4 & 0x4000) != 0) & 0x200);
uVar14 = uVar12 | 0x100;
if ((param_4 & 0x100) == 0) {
uVar14 = uVar12;
}
uVar11 = param_4 & 0x800;
if (uVar11 != 0) {
uVar16 = uVar16 | 0x1000;
}
uVar14 = (-(ulonglong)(uVar11 != 0) & 0xffffffffffff8800) + 0x8000 | uVar14;
piVar19 = piVar18;
if ((param_4 & 2) == 0) {
if ((param_4 & 0x80000) != 0) {
uVar14 = uVar14 | 0x80000;
uVar16 = uVar16 | 0x4000;
}
if (DAT_180092f04 != 0) {
uVar16 = uVar16 | 0x4000;
}
}
else {
uVar14 = uVar14 | 2;
uVar16 = uVar16 | 0x100;
if ((param_4 & 0x80000) != 0) {
uVar11 = 0x78;
goto LAB_18000bd2f;
}
}
uVar12 = uVar14 | 0x80;
if ((param_4 & 0x80) == 0) {
uVar12 = uVar14;
}
uVar14 = uVar12;
uVar12 = uVar16 | 0x400;
if ((param_4 & 0x80) == 0) {
uVar12 = uVar16;
}
if ((((param_4 & 0x400) != 0) && (uVar14 = uVar14 | 0x400, uVar11 != 0)) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)))) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180084d00);
}
puVar10 = param_6;
uVar7 = FUN_18000d410((longlong)param_6,&local_60,local_50,&local_58,&local_40,&local_e0,
&local_d0,&local_d8,&local_c8,&local_b8,&local_c0,&local_b0,
(longlong *)&local_90);
uVar11 = (uint)uVar7;
if (uVar11 == 0) {
if (local_90 == (uint *)0x0) {
LAB_18000bacf:
puVar3 = local_88;
puVar9 = local_78;
if ((local_88 != (undefined4 *)0x0) &&
(puVar9 = *(ulonglong **)(local_88 + 2),
*(ulonglong **)(local_88 + 2) == (ulonglong *)0x0)) {
puVar10 = (undefined8 *)0x8;
puVar9 = (ulonglong *)FUN_18000a1f4(8);
*(ulonglong **)(puVar3 + 2) = puVar9;
if (puVar9 == (ulonglong *)0x0) {
uVar11 = 0x80090300;
goto LAB_18000bd2f;
}
*puVar3 = 8;
}
local_78 = puVar9;
if (param_2 == (int *)0x0) {
if (param_3 == 0) {
pwVar13 = L"";
}
else {
pwVar13 = *(wchar_t **)(param_3 + 8);
}
uVar11 = FUN_180009f90((longlong)puVar10,pwVar13,(longlong)param_1,(longlong *)&local_f8,
uVar17);
piVar19 = local_f8;
if (uVar11 == 0) {
plVar15 = *(longlong **)(local_f8 + 2);
plVar15[0x11] = plVar15[0x11] | uVar12;
FUN_18000d37c(plVar15,param_1);

if (((((uVar11 == 0) &&

(plVar15,local_d0,local_d8), uVar11 == 0)) &&

uVar11 == 0)) &&

, uVar11 == 0 &&

uVar11 == 0)))) &&

uVar11 == 0)) {

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x24,&DAT_180084d00);
}
if ((uVar11 == 0) ||
((((char)(*(ushort *)((longlong)plVar15 + 0x22) >> 8) == -2 &&
(*(ushort *)((longlong)plVar15 + 0x22) < 0xff00)) && (uVar11 == 0x90364)))) {
*param_7 = piVar19;
FUN_18000ebec(plVar15[0xf],0,uVar17,param_1,piVar19);
if ((uVar17 >> 8 & 1) == 0) {
if (*(void **)(local_a0 + 2) != local_e8) {
if (*local_a0 < local_ec) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18004492c(DAT_180091000[2],0x25,&DAT_180084d00,*local_a0,(char)local_ec)
;
}
uVar11 = 0x80090321;
goto LAB_1800360d9;
}
memcpy(*(void **)(local_a0 + 2),local_e8,(ulonglong)local_ec);

}
}
else {
*(void **)(local_a0 + 2) = local_e8;
}
*local_a0 = local_ec;
if (uVar11 != 0x90364) {
uVar11 = 0x90312;
}
}
else {
if (((uVar17 >> 8 & 1) != 0) && (local_e8 != (void *)0x0)) {

}
LAB_1800360d9:
FUN_18005aecc(0x180092da0,piVar19);
}
}
}
}
else {
plVar15 = *(longlong **)(param_2 + 2);
bVar2 = true;
LOCK();
iVar1 = *param_2;
*param_2 = *param_2 + 1;
UNLOCK();
local_f8 = param_2;
if (iVar1 == 0) {
*(undefined2 *)((longlong)param_2 + 0x22) = 0;
param_2[9] = 0;
plVar15[0x11] = plVar15[0x11] | uVar12;
FUN_18000d37c(plVar15,param_1);
if ((plVar15[0x11] & 0x200004000U) == 0x200004000) {
piVar5 = local_f8;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x26,&DAT_180084d00);
piVar5 = local_f8;
}
goto LAB_180035fc1;
}
if (((*(int *)((longlong)plVar15 + 0x44) != 4) ||

piVar19 = local_f8, uVar11 == 0 &&

(plVar15,local_d0,local_d8), piVar19 = local_f8, uVar11 == 0))

piVar19 = local_f8, uVar11 == 0)))) &&

, piVar19 = local_f8, uVar11 == 0 &&

piVar19 = local_f8, uVar11 == 0)) &&

piVar19 = local_f8, uVar11 == 0)))) {


(plVar15,param_8,uVar4,
CONCAT71((uint7)(uVar17 >> 0x10),(char)(uVar17 >> 8)) &
0xffffffffffffff01);
piVar19 = local_f8;
if (uVar11 == 0) {

if ((*(uint *)(plVar15 + 0x11) >> 0x12 & 1) != 0) {
uVar11 = *(uint *)(*(longlong *)(param_2 + 2) + 0x40);

if ((uVar11 & 0x800a2aaa) != 0) {
FUN_18000909c(*(HLOCAL *)(param_2 + 2));
}
plVar15 = *(longlong **)(param_2 + 4);
*(longlong **)(param_2 + 2) = plVar15;
param_2[4] = 0;
param_2[5] = 0;
if (plVar15 == (longlong *)0x0) {
uVar11 = 0x54f;
piVar19 = local_f8;
goto LAB_18000bd2f;
}

(plVar15,local_50,&local_f0);
}
if (((ulonglong)plVar15[0x11] >> 0x1c & 1) != 0) {
uVar14 = uVar14 | 0x4000;
plVar15[0x11] = plVar15[0x11] & 0xffffffffefffffff;
}
if ((uVar11 != 0) && (param_2[9] == 0)) {
param_2[9] = uVar11;
}
if (local_98 != (undefined4 *)0x0) {
FUN_180044054(uVar11,plVar15,uVar17,local_70);
}
if (uVar11 == 0x90320) {
if (local_80 != (uint *)0x0) {
FUN_180044114(plVar15,local_80);
}
}
else if (uVar11 == 0x9035c) {
local_a0[1] = 3;
}
uVar12 = FUN_18000e5b4(uVar11);
if ((char)uVar12 == '\0') {
*param_7 = param_2;
}
uVar11 = FUN_18000d7d0(extraout_XMM0_Da,plVar15,param_2,param_12,local_58,local_60,
(longlong)local_50,(int *)local_a0,(longlong)&local_f0,uVar17
,param_11,param_10);
piVar19 = local_f8;
}
}
}
else {
uVar11 = 0x78;
piVar19 = param_2;
}
}
}
else {
puVar9 = *(ulonglong **)(local_90 + 2);
if ((puVar9 == (ulonglong *)0x0) || (*local_90 < 8)) {
uVar11 = 0x57;
}
else {
uVar16 = *puVar9;
if ((uVar16 & 0x100000000) != 0) {
uVar12 = uVar12 | 0x100000000;
uVar14 = uVar14 | 0x100000000;
}
if ((uVar16 & 0x200000000) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x20,&DAT_180084d00);
uVar16 = *puVar9;
}
uVar12 = uVar12 | 0x200000000;
uVar14 = uVar14 | 0x200000000;
}
uVar8 = ~uVar12 & uVar16 & 0xffffffff00000000;
if (uVar8 == 0) {
uVar17 = uVar17 | uVar16;
puVar10 = DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar10 = (undefined8 *)DAT_180091000[2];
FUN_180041e58(puVar10,0x22,&DAT_180084d00,uVar16);
}
goto LAB_18000bacf;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(piVar5 = piVar18, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x21,&DAT_180084d00,uVar8);
}
LAB_180035fc1:
uVar11 = 0x8009035d;
piVar19 = piVar5;
}
}
}
}
LAB_18000bd2f:
if (local_98 != (undefined4 *)0x0) {
*(undefined8 *)(local_98 + 2) = uStack_68;
*local_98 = local_70[1];
}
LAB_18000bd46:
if (param_9 != (undefined4 *)0x0) {
*param_9 = (int)uVar14;
}
if (local_78 != (ulonglong *)0x0) {
*local_78 = uVar14 & 0xffffffff00000000;
}
if ((bVar2) && (piVar19 != (int *)0x0)) {
LOCK();
*piVar19 = *piVar19 + -1;
UNLOCK();
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x27,&DAT_180084d00,uVar11);
}
FUN_18000c3a8(uVar11);
return;
}
=========================================
Function at address: 0x18000bfe0
Called functions addresses: 0x18000c3a8 0x18000c710 0x180041cb0 0x18004ed04 0x18000cd3c 0x180041d20


uint FUN_18000bfe0(longlong param_1,int param_2,longlong param_3)

{
uint uVar1;
uint uVar2;
longlong *plVar3;
ulonglong uVar4;
undefined8 *puVar5;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x12,&DAT_180082b10);
}
plVar3 = FUN_18000c710(param_1);
if (plVar3 != (longlong *)0x0) {
if ((*(int *)(plVar3 + 1) != 4) &&
((uVar1 = *(int *)(plVar3 + 1) - 0x33, 0x1b < uVar1 ||
((0xa000001U >> (uVar1 & 0x1f) & 1) == 0)))) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x14,&DAT_180082b10,0x80090317,0x17);
}
return 0x80090317;
}
if ((*(uint *)(plVar3 + 2) >> 0xc & 1) == 0) {
uVar4 = FUN_18000cd3c((longlong)plVar3,param_2,param_3);
uVar1 = (uint)uVar4;
}
else {
uVar1 = FUN_18004ed04((longlong)plVar3,param_2,param_3);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(((puVar5 = DAT_180091000, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 &&
(uVar2 = FUN_18000c3a8(uVar1), uVar2 != 0)) ||
((*(byte *)((longlong)puVar5 + 0x1c) & 4) != 0)))) {
uVar2 = FUN_18000c3a8(uVar1);
FUN_180041d20(puVar5[2],0x15,&DAT_180082b10,uVar2,(char)uVar2);
}
uVar1 = FUN_18000c3a8(uVar1);
return uVar1;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x13,&DAT_180082b10,0x80090301,1);
}
return 0x80090301;
}
=========================================
Function at address: 0x18000c160
Called functions addresses: 0x180016c58 0x18004e470 0x18004e4e8 0x18000c710 0x18000efa0 0x18000f2c0 0x1800526a8 0x180041cb0 0x180052a04 0x1800171b8 0x18004e9a4 0x18004eb24 0x1800527f0 0x18004e694 0x18004e80c 0x18004ea70 0x1800524a0 0x1800432ec 0x18000d0a8 0x1800525ec 0x18004e5f8 0x18000f6ec 0x18000edbc 0x180052918 0x18000f9f8


DWORD FUN_18000c160(longlong param_1,uint param_2,FILETIME *param_3)

{
DWORD DVar1;
longlong *plVar2;
undefined8 uVar3;

plVar2 = FUN_18000c710(param_1);
if (plVar2 == (longlong *)0x0) {
return 0x80090301;
}
if (param_2 < 0x25) {
if (param_2 == 0x24) {
DVar1 = FUN_18004e694((longlong)plVar2,(int *)param_3);
return DVar1;
}
if (param_2 < 8) {
if (param_2 == 7) {
uVar3 = FUN_180052918((longlong)plVar2,param_3);
return (DWORD)uVar3;
}
if (param_2 == 0) {
uVar3 = FUN_18004e80c((longlong)plVar2,(int *)param_3);
return (DWORD)uVar3;
}
if (param_2 == 1) {
DVar1 = FUN_1800526a8((longlong)plVar2,param_3);
return DVar1;
}
if (param_2 == 2) {
uVar3 = FUN_1800525ec((longlong)plVar2,param_3);
return (DWORD)uVar3;
}
if (param_2 == 4) {
DVar1 = FUN_18000d0a8((longlong)plVar2,(int *)param_3);
return DVar1;
}
if (param_2 == 5) {
DVar1 = FUN_1800524a0((longlong)plVar2,param_3);
return DVar1;
}
}
else {
if (param_2 == 10) {
uVar3 = FUN_1800527f0(param_1,(longlong *)param_3);
return (DWORD)uVar3;
}
if (param_2 == 0x12) {
if (*(FILETIME *)(plVar2 + 0x21) != (FILETIME)0x0) {
*param_3 = *(FILETIME *)(plVar2 + 0x21);
return 0;
}
if (*(DWORD *)(plVar2 + 0x22) == 0) {
return 0x8009030b;
}
return *(DWORD *)(plVar2 + 0x22);
}
if (param_2 == 0x19) {
uVar3 = FUN_18004eb24(plVar2,&param_3->dwLowDateTime);
return (DWORD)uVar3;
}
if (param_2 == 0x1a) {
DVar1 = FUN_18000f2c0((longlong)plVar2,&param_3->dwLowDateTime);
return DVar1;
}
if (param_2 == 0x23) {
uVar3 = FUN_18000f6ec((longlong)plVar2,param_3);
return (DWORD)uVar3;
}
}
}
else if (param_2 < 0x6d) {
if (param_2 == 0x6c) {
uVar3 = FUN_18004e9a4((longlong)plVar2,param_3);
return (DWORD)uVar3;
}
if (param_2 == 0x5a) {
DVar1 = FUN_18000efa0((longlong)plVar2,&param_3->dwLowDateTime);
return DVar1;
}
if (param_2 == 0x53) {
DVar1 = FUN_18000f9f8((longlong)plVar2,param_3);
return DVar1;
}
if (param_2 == 0x5d) {
uVar3 = FUN_1800171b8((longlong)plVar2,&param_3->dwLowDateTime);
return (DWORD)uVar3;
}
if (param_2 == 0x51) {
DVar1 = FUN_180052a04((longlong)plVar2,&param_3->dwLowDateTime);
return DVar1;
}
if (param_2 == 100) {
DVar1 = FUN_18000edbc((longlong)plVar2,&param_3->dwLowDateTime);
return DVar1;
}
}
else {
if (param_2 == 0x6d) {
uVar3 = FUN_180016c58((longlong)plVar2,param_3);
return (DWORD)uVar3;
}
if (param_2 == 0x6e) {
DVar1 = FUN_18004e4e8((longlong)plVar2,&param_3->dwLowDateTime);
return DVar1;
}
if (param_2 == 0x6f) {
uVar3 = FUN_18004ea70((longlong)plVar2,param_3);
return (DWORD)uVar3;
}
if (param_2 == 0x70) {
DVar1 = FUN_18004e5f8((longlong)plVar2,(longlong)param_3);
return DVar1;
}
if (param_2 == 0x72) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180085468);
}
uVar3 = FUN_18004e470(plVar2[2],*(undefined4 *)((longlong)plVar2 + 0x17c),
*(int *)(plVar2 + 0x2f),param_3);
return (DWORD)uVar3;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x14,&DAT_180085468,param_2);
}
return 0x80090302;
}
=========================================
Function at address: 0x18000c2d0
Called functions addresses: 0x180041cdc 0x18000c3a8 0x18004f2bc 0x18000c710 0x180041cb0 0x180052374 0x180041d20 0x18000c40c


uint FUN_18000c2d0(longlong param_1,longlong param_2)

{
uint uVar1;
uint uVar2;
longlong *plVar3;
undefined8 *puVar4;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180082b10);
}
plVar3 = FUN_18000c710(param_1);
if (plVar3 != (longlong *)0x0) {
if ((*(int *)(plVar3 + 1) != 4) && (*(int *)(plVar3 + 1) != 0x4f)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x18,&DAT_180082b10,0x80090317,0x17);
}
return 0x80090317;
}
if ((*(uint *)(plVar3 + 2) >> 0xc & 1) == 0) {
uVar1 = FUN_18000c40c((longlong)plVar3,param_2);
}
else {
uVar1 = FUN_18004f2bc((longlong)plVar3,param_2);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar4 = DAT_180091000;
uVar2 = FUN_18000c3a8(uVar1);
FUN_180041cdc(puVar4[2],0x19,&DAT_180082b10,uVar2);
}
if (uVar1 == 0x80090330) {
FUN_180052374();
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(((puVar4 = DAT_180091000, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 &&
(uVar2 = FUN_18000c3a8(uVar1), uVar2 != 0)) ||
((*(byte *)((longlong)puVar4 + 0x1c) & 4) != 0)))) {
uVar2 = FUN_18000c3a8(uVar1);
FUN_180041d20(puVar4[2],0x1a,&DAT_180082b10,uVar2,(char)uVar2);
}
uVar1 = FUN_18000c3a8(uVar1);
return uVar1;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x17,&DAT_180082b10,0x80090301,1);
}
return 0x80090301;
}
=========================================
Function at address: 0x18000c3a8
Called functions addresses: None


uint FUN_18000c3a8(uint param_1)

{
if ((param_1 & 0x1fff0000) == 0x90000) {
if (param_1 + 0x7ff6ffff < 0x2f) {
return 0x80090304;
}
if (((0x100e < param_1 + 0x7ff6efff) && (0xfec < param_1 + 0x7ff6dfec)) &&
(param_1 != 0x80092011)) {
return param_1;
}
}
else if (param_1 == 0) {
return 0;
}
if (param_1 < 0x80092005) {
if (param_1 == 0x80092004) {
return 0x8009030d;
}
if (param_1 == 0xe) {
return 0x80090300;
}
if (param_1 == 0x57) {
return 0x8009035d;
}
if (param_1 == 0x78) {
return 0x80090302;
}
if (param_1 == 0x7a) {
return 0x80090321;
}
}
else {
if ((param_1 == 0x800b0101) || (param_1 == 0x800b0102)) {
return 0x80090328;
}
if (param_1 == 0x800b0109) {
return 0x80090325;
}
if (param_1 == 0x800b010c) {
return 0x80092010;
}
if (param_1 == 0x800b010f) {
return 0x80090322;
}
}
return 0x80090304;
}
=========================================
Function at address: 0x18000c40c
Called functions addresses: 0x180041cdc 0x180050148 0x180041cb0 0x18004de38 0x18000c91c 0x180041d20 0x18004e050 0x18004f974


int FUN_18000c40c(longlong param_1,longlong param_2)

{
undefined uVar1;
undefined uVar2;
longlong lVar3;
int iVar4;
ulonglong uVar5;
undefined8 uVar6;
uint uVar7;
undefined2 uVar8;
uint *puVar9;
uint *puVar10;
uint *puVar11;
uint *puVar12;
uint uVar13;
int *piVar14;
int *piVar15;
uint uVar16;
bool bVar17;
char local_res10 [8];
uint *local_res18;
uint local_58;
uint local_54;
uint *local_50;
uint local_48 [2];
longlong lStack_40;

puVar11 = (uint *)0x0;
puVar10 = (uint *)0x0;
piVar14 = (int *)0x0;
piVar15 = (int *)0x0;
local_res18 = (uint *)0x0;
local_res10[0] = '\0';
local_48[0] = 0;
local_48[1] = 0;
lStack_40 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x48,&DAT_1800853e8);
}
uVar5 = 0;
if (*(uint *)(param_2 + 4) != 0) {
lVar3 = *(longlong *)(param_2 + 8);
puVar9 = (uint *)(lVar3 + 4);
do {
uVar7 = *puVar9;
puVar12 = (uint *)(ulonglong)uVar7;
if (uVar7 == 0) {
if (puVar10 == (uint *)0x0) {
puVar10 = (uint *)(uVar5 * 0x10 + lVar3);
}
else if (piVar14 == (int *)0x0) {
piVar14 = (int *)(uVar5 * 0x10 + lVar3);
}
else if (piVar15 == (int *)0x0) {
piVar15 = (int *)(uVar5 * 0x10 + lVar3);
}
}
else {
uVar7 = uVar7 - 1;
puVar12 = (uint *)(ulonglong)uVar7;
if (uVar7 == 0) {
puVar11 = (uint *)(uVar5 * 0x10 + lVar3);
}
else if (uVar7 == 0x10) {
local_res18 = (uint *)(uVar5 * 0x10 + lVar3);
}
}
uVar7 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar7;
puVar9 = puVar9 + 4;
} while (uVar7 < *(uint *)(param_2 + 4));
if ((((puVar11 != (uint *)0x0) && (puVar10 != (uint *)0x0)) && (piVar14 != (int *)0x0)) &&
(piVar15 != (int *)0x0)) {
local_50 = *(uint **)(puVar11 + 2);
if (local_50 == (uint *)0x0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcf8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x7ff6fcf8;
}
uVar8 = 0x4a;
goto LAB_18003692b;
}
uVar7 = *(uint *)(param_1 + 0x18);
local_54 = *puVar11;
local_58 = *puVar11;
if (uVar7 < 0x801) {
if ((((uVar7 != 0x800) && (uVar7 != 0x10)) && (uVar7 != 0x20)) &&
(((uVar7 != 0x40 && (uVar7 != 0x80)) && ((uVar7 != 0x100 && (uVar7 != 0x200)))))) {
bVar17 = uVar7 == 0x400;
LAB_180036750:
if (!bVar17) {
iVar4 = -0x7ff6fcff;
goto LAB_18000c617;
}
}
}
else if (((uVar7 != 0x1000) && (uVar7 != 0x2000)) &&
((uVar7 != 0x10000 && ((uVar7 != 0x20000 && (uVar7 != 0x40000)))))) {
bVar17 = uVar7 == 0x80000;
goto LAB_180036750;
}
iVar4 = *(int *)(param_1 + 0x44);
uVar16 = *(int *)(param_1 + 0x40) + iVar4;
if (local_58 < uVar16) {
uVar13 = uVar16;
if (((uVar7 & 0x50000) != 0) && (*(char *)(param_1 + 0x8c) == '\0')) {
if ((*(char *)((longlong)local_50 + 1) == -2) &&
(CONCAT11(*(char *)((longlong)local_50 + 1),*(undefined *)((longlong)local_50 + 2)) <
0xff00)) {
uVar1 = *(undefined *)((longlong)local_50 + 0xb);
uVar2 = *(undefined *)(local_50 + 3);
}
else {
uVar1 = *(undefined *)((longlong)local_50 + 3);
uVar2 = *(undefined *)(local_50 + 1);
}
if (((iVar4 + (uint)CONCAT11(uVar1,uVar2) < uVar16) && (*(char *)local_50 == '\x14')) &&
((uint)CONCAT11(*(undefined *)((longlong)local_50 + 3),*(undefined *)(local_50 + 1)) <
*(uint *)(param_1 + 0x74))) {
iVar4 = -0x7ff6fccd;
goto LAB_18000c617;
}
}
LAB_18000c685:
local_54 = uVar13;
iVar4 = -0x7ff6fce8;
puVar9 = local_50;
LAB_18000c68a:
puVar10[1] = 4;
uVar7 = *puVar11;
*puVar10 = local_54 - uVar7;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18004f974(DAT_180091000[2],puVar9,puVar12,*puVar11,(char)local_54,
(char)(local_54 - uVar7));
}
puVar11[1] = 4;
*puVar11 = local_54 - *puVar11;
}
else {
if ((*(char *)((longlong)local_50 + 1) == -2) &&
(CONCAT11(*(char *)((longlong)local_50 + 1),*(undefined *)((longlong)local_50 + 2)) <
0xff00)) {
uVar1 = *(undefined *)((longlong)local_50 + 0xb);
uVar2 = *(undefined *)(local_50 + 3);
}
else {
uVar1 = *(undefined *)((longlong)local_50 + 3);
uVar2 = *(undefined *)(local_50 + 1);
}
puVar12 = (uint *)(ulonglong)(uint)CONCAT11(uVar1,uVar2);
uVar13 = iVar4 + (uint)CONCAT11(uVar1,uVar2);
if (uVar13 < uVar16) {
iVar4 = -0x7ff6fcf8;
local_res10[0] = '2';
goto LAB_18000c617;
}
lStack_40 = (ulonglong)uVar16 + (longlong)local_50;
local_48[1] = uVar13 - uVar16;
local_48[0] = local_58;
if (local_58 < uVar13) goto LAB_18000c685;
puVar12 = local_48;
puVar9 = &local_58;
if ((uVar7 & 0x3000) == 0) {
uVar5 = FUN_18000c91c(param_1,puVar9,puVar12,local_res10);
iVar4 = (int)uVar5;
}
else {
iVar4 = FUN_180050148(param_1,(longlong)puVar9,puVar12,local_res10);
}
if ((*(uint *)(param_1 + 0x18) & 0xf0000) == 0) {
if (iVar4 != 0) {
LAB_18000c6ef:
if (iVar4 != 0x90321) {
if (iVar4 != -0x7ff6fce8) goto LAB_18000c617;
goto LAB_18000c68a;
}
}
}
else {
if (iVar4 != 0) goto LAB_18000c6ef;
uVar5 = CONCAT71(CONCAT61(CONCAT51(CONCAT41(CONCAT31(CONCAT21(CONCAT11(*(undefined *)
((longlong)
local_50 + 3),
*(undefined *)
(local_50 + 1)),
*(undefined *)
((longlong)local_50 + 5)),
*(undefined *)
((longlong)local_50 + 6)),
*(undefined *)((longlong)local_50 + 7)),
*(undefined *)(local_50 + 2)),
*(undefined *)((longlong)local_50 + 9)),
*(undefined *)((longlong)local_50 + 10));
uVar6 = FUN_18004de38(param_1,uVar5);
if ((char)uVar6 == '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x4c,&DAT_1800853e8,(int)uVar5);
}
iVar4 = -0x7ff6fcf0;
goto LAB_18000c617;
}
}
if (local_54 < *puVar11) {
piVar15[1] = 5;
*piVar15 = *puVar11 - local_54;
*(ulonglong *)(piVar15 + 2) = (ulonglong)local_54 + *(longlong *)(puVar11 + 2);
}
puVar11[1] = 7;
*puVar11 = uVar16;
puVar10[1] = 1;
*(longlong *)(puVar10 + 2) = lStack_40;
*puVar10 = local_48[1];
piVar14[1] = 6;
*(ulonglong *)(piVar14 + 2) = (ulonglong)local_48[1] + *(longlong *)(puVar10 + 2);
*piVar14 = (local_58 - local_48[1]) - uVar16;
}
LAB_18000c617:
if (local_res18 != (uint *)0x0) {
FUN_18004e050(param_1,local_res18,local_res10[0]);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) || (iVar4 == 0)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) {
return iVar4;
}
FUN_180041d20(DAT_180091000[2],0x52,&DAT_1800853e8,iVar4,(char)iVar4);
return iVar4;
}
return iVar4;
}
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcf8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x7ff6fcf8;
}
uVar8 = 0x49;
LAB_18003692b:
FUN_180041d20(DAT_180091000[2],uVar8,&DAT_1800853e8,0x80090308,8);
return -0x7ff6fcf8;
}
=========================================
Function at address: 0x18000c710
Called functions addresses: 0x180041cb0 0x18000c774 0x180041e9c


longlong * FUN_18000c710(longlong param_1)

{
longlong *plVar1;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180085418);
}
plVar1 = FUN_18000c774(param_1,'\0');
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x17,&DAT_180085418,plVar1);
}
return plVar1;
}
=========================================
Function at address: 0x18000c774
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0x180043330 0x18004492c 0x180041cb0 0x18004497c 0xEXTERNAL:000000c2 0x180041e9c


longlong * FUN_18000c774(longlong param_1,char param_2)

{
longlong lVar1;
code *pcVar2;
longlong *plVar3;
uint uVar4;
longlong *plVar5;
longlong *plVar6;
uint uVar7;
longlong lVar8;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x10,&DAT_180085418);
}
uVar4 = ((uint)((ulonglong)param_1 >> 8) & 0xffffff) +
((uint)((ulonglong)param_1 >> 0x10) & 0xffff) + (int)param_1 +
((uint)((ulonglong)param_1 >> 0x18) & 0xff);
uVar4 = (uVar4 >> 4) + uVar4 & DAT_1800919e0 - 1U;
uVar7 = DAT_1800919e4 - 1U & uVar4;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180043330(DAT_180091000[2],0x11,&DAT_180085418,param_1,param_2);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18004492c(DAT_180091000[2],0x12,&DAT_180085418,uVar4,(char)uVar7);
}
}
lVar8 = (ulonglong)uVar7 * 0x60;
if (param_2 == '\0') {
RtlAcquireResourceShared();
}
else {
RtlAcquireResourceExclusive(DAT_1800921d0 + lVar8,1);
}
plVar5 = (longlong *)((ulonglong)uVar4 * 0x10 + DAT_1800921c8);
plVar3 = (longlong *)*plVar5;
do {
plVar6 = (longlong *)0x0;
if (plVar3 == plVar5) {
LAB_18000c866:
RtlReleaseResource(DAT_1800921d0 + lVar8);
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x13,&DAT_180085418,plVar6);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_18004497c(DAT_180091000[2],0x14,&DAT_180085418,param_1,(char)plVar6);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x15,&DAT_180085418,plVar6);
}
}
}
return plVar6;
}
plVar6 = plVar3 + -0x26;
if (plVar3[-2] == param_1) {
if (param_2 != '\0') {
lVar1 = *plVar3;
if ((*(longlong **)(lVar1 + 8) != plVar3) ||
(plVar5 = (longlong *)plVar3[1], (longlong *)*plVar5 != plVar3)) {
pcVar2 = (code *)swi(0x29);
(*pcVar2)(3);
pcVar2 = (code *)swi(3);
plVar3 = (longlong *)(*pcVar2)();
return plVar3;
}
*plVar5 = lVar1;
*(longlong **)(lVar1 + 8) = plVar5;
}
goto LAB_18000c866;
}
plVar3 = (longlong *)*plVar3;
} while( true );
}
=========================================
Function at address: 0x18000c91c
Called functions addresses: 0x180043258 0x180041cdc 0x18000cb70 0x180041cb0 0xEXTERNAL:00000040 0x18000172c 0xEXTERNAL:0000003f 0x18000d1cc 0x180041e58 0xEXTERNAL:0000010a 0x180041d20


ulonglong FUN_18000c91c(longlong param_1,uint *param_2,uint *param_3,undefined *param_4)

{
byte bVar1;
undefined uVar2;
undefined uVar3;
undefined uVar4;
undefined uVar5;
undefined uVar6;
undefined uVar7;
longlong lVar8;
ushort uVar9;
uint uVar10;
uint uVar11;
ulonglong uVar12;
char *pcVar13;
undefined8 *puVar14;
undefined2 uVar15;
ulonglong uVar16;
byte *pbVar17;
undefined4 uVar18;
int iVar19;
undefined4 uVar20;
undefined8 uVar21;
uint local_res8 [2];
uint local_res10;
undefined8 in_stack_ffffffffffffff90;
uint *puVar22;
uint local_48;
uint local_44;
int local_40;

uVar18 = (undefined4)((ulonglong)in_stack_ffffffffffffff90 >> 0x20);
iVar19 = *(int *)(param_1 + 0x40) + *(int *)(param_1 + 0x44);
pbVar17 = *(byte **)(param_2 + 2);
local_res8[0] = *(uint *)(param_1 + 0x18) & 0xf0000;
local_res10 = 4;
if (local_res8[0] != 0) {
local_res10 = 0xc;
}
local_40 = iVar19;
if (*(int *)(param_1 + 8) != 4) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090308;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090308;
}
uVar15 = 0x22;
puVar14 = DAT_180091000;
LAB_180036ea9:
FUN_180041d20(puVar14[2],uVar15,&DAT_180085408,0x80090308,8);
return 0x80090308;
}
bVar1 = *pbVar17;
if (((bVar1 - 0x14 & 0xfffffffc) == 0) && (bVar1 != 0x15)) {
*(undefined *)(param_1 + 0x70) = 0;
}
uVar10 = 0x80090330;
if (bVar1 == 0x15) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3a,&DAT_180085408);
pbVar17 = *(byte **)(param_2 + 2);
}
if ((*(uint *)(param_1 + 0x18) & 0xf0000) == 0) {
uVar21 = *(undefined8 *)(param_1 + 0x60);
}
else {
uVar21 = CONCAT71(CONCAT61(CONCAT51(CONCAT41(CONCAT31(CONCAT21(CONCAT11(pbVar17[3],pbVar17[4])
,pbVar17[5]),pbVar17[6]),
pbVar17[7]),pbVar17[8]),pbVar17[9]),pbVar17[10]);
}
iVar19 = SslDecryptPacket(*(undefined8 *)(param_1 + 0x58),*(undefined8 *)(param_1 + 0x28),
pbVar17,param_2[1],*(undefined8 *)(param_3 + 2),*param_3,param_3 + 1,
uVar21,0);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x3b,&DAT_180085408,iVar19);
}
if ((*(uint *)(param_1 + 0x18) & 0xf0000) == 0) {
*(longlong *)(param_1 + 0x60) = *(longlong *)(param_1 + 0x60) + 1;
}
else {
*(undefined8 *)(param_1 + 0x60) = uVar21;
}
if (iVar19 == 0) {
uVar12 = FUN_18000172c(*(byte **)(param_3 + 2),param_3[1],(byte *)(param_1 + 0x70),
(undefined *)0x0);
param_3[1] = 0;
uVar16 = uVar12 & 0xffffffff;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar16;
}
if ((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) || ((int)uVar12 == 0)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) {
return uVar16;
}
FUN_180041d20(DAT_180091000[2],0x3d,&DAT_180085408,(int)uVar12,(char)uVar12);
return uVar16;
}
*param_4 = 0x14;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0)) goto LAB_18000ca65;
uVar15 = 0x3c;
LAB_180036f63:
uVar21 = DAT_180091000[2];
uVar18 = 0x80090330;
LAB_180036f6d:
FUN_180043258(uVar21,uVar15,&DAT_180085408,uVar18,(char)uVar10);
goto LAB_18000ca65;
}
if (bVar1 == 0x16) {
uVar20 = 0x28;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x28,&DAT_180085408);
}
if ((*(uint *)(param_1 + 0x18) & 0x800a2aaa) == 0) {
if (local_res8[0] == 0) {
uVar20 = 0x4c;
goto LAB_18003715a;
}
lVar8 = *(longlong *)(param_2 + 2);
uVar9 = CONCAT11(*(undefined *)(lVar8 + 3),*(undefined *)(lVar8 + 4));
uVar2 = *(undefined *)(lVar8 + 5);
uVar3 = *(undefined *)(lVar8 + 6);
uVar4 = *(undefined *)(lVar8 + 7);
uVar5 = *(undefined *)(lVar8 + 8);
uVar6 = *(undefined *)(lVar8 + 9);
uVar7 = *(undefined *)(lVar8 + 10);
if ((uint)uVar9 < *(uint *)(param_1 + 0x74)) {
uVar10 = 0x80090333;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0)) goto LAB_18000ca65;
uVar21 = DAT_180091000[2];
uVar15 = 0x32;
uVar18 = 0x80090333;
goto LAB_180036f6d;
}
local_res8[0] = param_2[1];
pcVar13 = (char *)LocalAlloc(0x40,(ulonglong)local_res8[0]);
if (pcVar13 == (char *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x33,&DAT_180085408,0x80090300,0);
}
return 0x80090300;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x34,&DAT_180085408);
}
iVar19 = SslDecryptPacket(*(undefined8 *)(param_1 + 0x58),*(undefined8 *)(param_1 + 0x28),
*(undefined8 *)(param_2 + 2),param_2[1],pcVar13,
CONCAT44(uVar18,local_res8[0]),local_res8,
CONCAT71(CONCAT61(CONCAT51(CONCAT41(CONCAT31(CONCAT21(uVar9,uVar2),
uVar3),uVar4),uVar5),
uVar6),uVar7),0);
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x35,&DAT_180085408,iVar19);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x36,&DAT_180085408,param_3[1]);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x37,&DAT_180085408,*(undefined8 *)(param_1 + 0x60));
}
}
}
if (iVar19 == 0) {
if (local_res8[0] < 0xc) {
LAB_180037107:
uVar10 = 0x80090308;
*param_4 = 10;
}
else {
if (*(char *)(param_1 + 0x8c) == '\0') {
if (*pcVar13 != '\x01') {
uVar10 = 0x80090333;
goto LAB_180037111;
}
}
else if (*pcVar13 != '\x01') goto LAB_180037107;
uVar10 = 0x90321;
*(uint *)(param_1 + 0x90) = (uint)(byte)pcVar13[4] * 0x100 + (uint)(byte)pcVar13[5];
}
}
else {
*param_4 = 0x14;
uVar10 = 0x80090330;
}
LAB_180037111:
LocalFree(pcVar13);
param_3[1] = 0;
param_2[1] = 0;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
(((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)))) goto LAB_18000ca65;
uVar15 = 0x38;
}
else {
puVar22 = &local_44;
uVar11 = FUN_18000d1cc(*(undefined8 *)(param_1 + 0x58),*(undefined4 *)(param_1 + 0x38),
*(uint *)(param_1 + 0x18),*(undefined4 *)(param_1 + 0x3c),(uint *)0x0,
puVar22,&local_48);
uVar18 = (undefined4)((ulonglong)puVar22 >> 0x20);
uVar12 = (ulonglong)uVar11;
if (uVar11 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar12;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cdc(DAT_180091000[2],0x29,&DAT_180085408,uVar11);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if (((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) {
return uVar12;
}
FUN_180041d20(DAT_180091000[2],0x2a,&DAT_180085408,uVar11,(char)uVar11);
return uVar12;
}
return uVar12;
}
if (local_44 + local_48 + local_res10 + local_40 < *param_2) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2b,&DAT_180085408);
}
LAB_18003715a:
param_2[1] = 0;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2c,&DAT_180085408);
}
uVar11 = local_res8[0];
lVar8 = *(longlong *)(param_2 + 2);
if (local_res8[0] == 0) {
uVar21 = *(undefined8 *)(param_1 + 0x60);
}
else {
uVar21 = CONCAT71(CONCAT61(CONCAT51(CONCAT41(CONCAT31(CONCAT21(CONCAT11(*(undefined *)
(lVar8 + 3),
*(undefined *)
(lVar8 + 4)),
*(undefined *)(lVar8 + 5)),
*(undefined *)(lVar8 + 6)),
*(undefined *)(lVar8 + 7)),
*(undefined *)(lVar8 + 8)),*(undefined *)(lVar8 + 9)),
*(undefined *)(lVar8 + 10));
}
iVar19 = SslDecryptPacket(*(undefined8 *)(param_1 + 0x58),*(undefined8 *)(param_1 + 0x28),
lVar8,param_2[1],*(undefined8 *)(param_3 + 2),
CONCAT44(uVar18,*param_3),param_3 + 1,uVar21,0);
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x2d,&DAT_180085408,iVar19);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x2e,&DAT_180085408,param_3[1]);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x2f,&DAT_180085408,*(undefined8 *)(param_1 + 0x60));
}
}
}
if (uVar11 == 0) {
*(longlong *)(param_1 + 0x60) = *(longlong *)(param_1 + 0x60) + 1;
}
else {
*(undefined8 *)(param_1 + 0x60) = uVar21;
}
if (iVar19 != 0) {
*param_4 = 0x14;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0)) goto LAB_18000ca65;
uVar15 = 0x30;
goto LAB_180036f63;
}
if ((param_3[1] != local_res10) || (pcVar13 = *(char **)(param_3 + 2), *pcVar13 != '\0')) {
*param_4 = 10;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090308;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090308;
}
uVar15 = 0x31;
puVar14 = DAT_180091000;
goto LAB_180036ea9;
}
uVar20 = 0x4c;
*(uint *)(param_1 + 0x90) = (uint)(byte)pcVar13[4] * 0x100 + (byte)pcVar13[5] + 1;
}
*(undefined4 *)(param_1 + 8) = uVar20;
param_3[1] = 0;
uVar10 = 0x90321;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0)) goto LAB_18000ca65;
uVar15 = 0x39;
}
}
else {
if (bVar1 != 0x17) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3e,&DAT_180085408);
}
puVar14 = DAT_180091000;
*param_4 = 10;
if ((undefined8 **)puVar14 == &DAT_180091000) {
return 0x80090308;
}
if ((*(byte *)((longlong)puVar14 + 0x1c) & 5) == 0) {
return 0x80090308;
}
uVar15 = 0x3f;
goto LAB_180036ea9;
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x23,&DAT_180085408);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x24,&DAT_180085408);
}
}
uVar10 = FUN_18000cb70(*(undefined8 *)(param_1 + 0x58),*(undefined8 *)(param_1 + 0x28),
iVar19 - *(int *)(param_1 + 0x44),*(int *)(param_1 + 0x44),
(longlong *)(param_1 + 0x60),(int *)param_2,param_3,param_4);
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x25,&DAT_180085408,uVar10);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x26,&DAT_180085408,*(undefined8 *)(param_1 + 0x60));
}
}
if ((local_res8[0] != 0) && (*(char *)(param_1 + 0x8c) == '\0')) {
*(undefined *)(param_1 + 0x8c) = 1;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0 || (uVar10 == 0)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)))) goto LAB_18000ca65;
uVar15 = 0x27;
}
FUN_180041d20(DAT_180091000[2],uVar15,&DAT_180085408,uVar10,(char)uVar10);
LAB_18000ca65:
return (ulonglong)uVar10;
}
=========================================
Function at address: 0x18000cb70
Called functions addresses: 0x180041cdc 0x180041cb0 0xEXTERNAL:0000010a 0x180041d20 0x18002a77b


int FUN_18000cb70(undefined8 param_1,undefined8 param_2,int param_3,int param_4,longlong *param_5,
int *param_6,uint *param_7,undefined *param_8)

{
char cVar1;
undefined uVar2;
undefined uVar3;
undefined8 *puVar4;
longlong lVar5;
uint uVar6;
longlong lVar7;
int iVar8;
uint local_34;
void *local_30;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x40,&DAT_180085408);
}
puVar4 = DAT_180091000;
lVar7 = *(longlong *)(param_6 + 2);
param_6[1] = param_4;
cVar1 = *(char *)(lVar7 + 1);
uVar6 = (uint)CONCAT11(cVar1,*(undefined *)(lVar7 + 2));
if (((3 < uVar6 - 0x300) && (uVar6 != 0xfefd)) && (uVar6 != 0xfeff)) {
iVar8 = -0x7ff6fcf8;
*param_8 = 0x46;
goto LAB_18000ccec;
}
if ((cVar1 == -2) && (uVar6 < 0xff00)) {
uVar2 = *(undefined *)(lVar7 + 0xb);
uVar3 = *(undefined *)(lVar7 + 0xc);
}
else {
uVar2 = *(undefined *)(lVar7 + 3);
uVar3 = *(undefined *)(lVar7 + 4);
}
local_30 = (void *)((ulonglong)(uint)(param_3 + param_4) + lVar7);
iVar8 = (uint)CONCAT11(uVar2,uVar3) + param_4;
local_34 = *param_6 - (param_3 + param_4);
param_6[1] = iVar8;
if (((undefined8 **)puVar4 != &DAT_180091000) && ((*(byte *)((longlong)puVar4 + 0x1c) & 4) != 0))
{
FUN_180041cb0(puVar4[2],0x41,&DAT_180085408);
lVar7 = *(longlong *)(param_6 + 2);
iVar8 = param_6[1];
}
if ((cVar1 == -2) && (uVar6 < 0xff00)) {
lVar5 = CONCAT71(CONCAT61(CONCAT51(CONCAT41(CONCAT31(CONCAT21(CONCAT11(*(undefined *)(lVar7 + 3)
,*(undefined *)
(lVar7 + 4)),
*(undefined *)(lVar7 + 5)),
*(undefined *)(lVar7 + 6)),
*(undefined *)(lVar7 + 7)),*(undefined *)(lVar7 + 8)
),*(undefined *)(lVar7 + 9)),*(undefined *)(lVar7 + 10));
}
else {
lVar5 = *param_5;
}
iVar8 = SslDecryptPacket(param_1,param_2,lVar7,iVar8,local_30,local_34,&local_34,lVar5,0);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x42,&DAT_180085408,iVar8);
}
if (iVar8 == 0) {
if ((cVar1 != -2) || (0xfeff < uVar6)) {
*param_5 = *param_5 + 1;
}
if (*(void **)(param_7 + 2) != local_30) {
if (*param_7 < local_34) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x44,&DAT_180085408);
}
goto LAB_1800373b5;
}
memcpy(*(void **)(param_7 + 2),local_30,(ulonglong)local_34);
}
param_7[1] = local_34;
iVar8 = 0;
puVar4 = DAT_180091000;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x43,&DAT_180085408,iVar8);
}
LAB_1800373b5:
puVar4 = DAT_180091000;
iVar8 = -0x7ff6fcd0;
*param_8 = 0x14;
}
LAB_18000ccec:
if ((undefined8 **)puVar4 != &DAT_180091000) {
if ((*(byte *)((longlong)puVar4 + 0x1c) & 4) != 0) {
FUN_180041cdc(puVar4[2],0x45,&DAT_180085408,iVar8);
puVar4 = DAT_180091000;
}
if (((undefined8 **)puVar4 != &DAT_180091000) &&
((((*(byte *)((longlong)puVar4 + 0x1c) & 1) != 0 && (iVar8 != 0)) ||
((*(byte *)((longlong)puVar4 + 0x1c) & 4) != 0)))) {
FUN_180041d20(puVar4[2],0x46,&DAT_180085408,iVar8,(char)iVar8);
}
}
return iVar8;
}
=========================================
Function at address: 0x18000cd3c
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000010f 0x18004e228 0xEXTERNAL:00000040 0x180041cb0 0xEXTERNAL:0000003f 0x18004def8 0x18002a77b 0x180041d20 0x18002a787 0x180041d70 0x180041e9c


ulonglong FUN_18000cd3c(longlong param_1,int param_2,longlong param_3)

{
int iVar1;
longlong lVar2;
int iVar3;
uint uVar4;
uint uVar5;
undefined2 uVar6;
uint uVar7;
ulonglong uVar8;
ulonglong uVar9;
uint *puVar10;
uint *puVar11;
int *piVar12;
wchar_t *pwVar13;
size_t _Size;
size_t sVar14;
undefined *puVar15;
byte *pbVar16;
HLOCAL pvVar17;
uint *puVar18;
bool bVar19;
uint local_res18;
int local_res20;
ulonglong local_70;
byte *local_68;
HLOCAL local_60;
uint local_58;
uint local_54;
HLOCAL local_50;
uint local_48;
uint uStack_44;
HLOCAL pvStack_40;

puVar11 = (uint *)0x0;
puVar10 = (uint *)0x0;
local_60 = (HLOCAL)0x0;
puVar18 = (uint *)0x0;
local_58 = 0;
local_res20 = 0x17;
local_70 = CONCAT44(local_70._4_4_,0x17);
local_48 = 0;
uStack_44 = 0;
pvStack_40 = (HLOCAL)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_1800853e8);
}
uVar7 = 0;
if (*(uint *)(param_3 + 4) == 0) {
LAB_180037c7a:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0xe,&DAT_1800853e8,0x80090308,8);
}
return 0x80090308;
}
lVar2 = *(longlong *)(param_3 + 8);
piVar12 = (int *)(lVar2 + 4);
do {
iVar1 = *piVar12;
if (iVar1 == 1) {
puVar18 = (uint *)((ulonglong)uVar7 * 0x10 + lVar2);
if (puVar11 == (uint *)0x0) {
puVar11 = puVar18;
}
}
else if (iVar1 == 2) {
if (puVar11 == (uint *)0x0) {
LAB_18000cdd3:
puVar11 = (uint *)((ulonglong)uVar7 * 0x10 + lVar2);
}
else if (puVar10 == (uint *)0x0) goto LAB_18000d082;
}
else if (iVar1 == 6) {
LAB_18000d082:
puVar10 = (uint *)((ulonglong)uVar7 * 0x10 + lVar2);
}
else if (iVar1 == 7) goto LAB_18000cdd3;
uVar7 = uVar7 + 1;
piVar12 = piVar12 + 4;
} while (uVar7 < *(uint *)(param_3 + 4));
if ((puVar11 == (uint *)0x0) || (puVar18 == (uint *)0x0)) goto LAB_180037c7a;
pbVar16 = *(byte **)(puVar18 + 2);
uVar7 = *puVar11;
pvVar17 = *(HLOCAL *)(puVar11 + 2);
bVar19 = pbVar16 != (byte *)((longlong)pvVar17 + (ulonglong)uVar7);
if (puVar10 != (uint *)0x0) {
bVar19 = *(byte **)(puVar10 + 2) != pbVar16 + *puVar18 || bVar19;
}
local_res18 = *puVar18;
_Size = (size_t)local_res18;
uVar4 = local_res18 + uVar7;
local_68 = pbVar16;
if (uVar4 < uVar7) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x8009035d;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x8009035d;
}
uVar6 = 0x12;
LAB_1800374c5:
FUN_180041d20(DAT_180091000[2],uVar6,&DAT_1800853e8,0x8009035d,0x5d);
return 0x8009035d;
}
if (bVar19) {
local_58 = uVar4;
if ((puVar10 != (uint *)0x0) && (local_58 = *puVar10 + uVar4, local_58 < uVar4)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x8009035d;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x8009035d;
}
uVar6 = 0x14;
local_58 = uVar4;
goto LAB_1800374c5;
}
local_60 = LocalAlloc(0x40,(ulonglong)local_58);
if (local_60 == (HLOCAL)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x15,&DAT_1800853e8,0x80090300,0);
}
return 0x80090300;
}
local_54 = 0;
_Size = (size_t)*puVar18;
pbVar16 = (byte *)((ulonglong)*puVar11 + (longlong)local_60);
local_res18 = local_58 - *puVar11;
local_68 = pbVar16;
local_50 = local_60;
memcpy(pbVar16,*(void **)(puVar18 + 2),(ulonglong)*puVar18);
}
else {
local_54 = 0;
uVar7 = *puVar18 + *puVar11;
local_58 = uVar7;
local_50 = pvVar17;
if (puVar10 != (uint *)0x0) {
local_58 = *puVar10 + uVar7;
if (local_58 < uVar7) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x8009035d;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x8009035d;
}
uVar6 = 0x13;
local_58 = uVar7;
goto LAB_1800374c5;
}
local_res18 = *puVar10 + local_res18;
}
}
uVar7 = (uint)_Size;
if (param_2 == 0x40000000) {
uVar8 = FUN_18004e228(param_1,pbVar16,uVar7,(undefined4 *)&local_70);
uVar9 = uVar8 & 0xffffffff;
if ((int)uVar8 == 0) {
local_res20 = (int)local_70;
goto LAB_18000ce8f;
}
LAB_180037ba2:
pvVar17 = local_60;
if (!bVar19) goto LAB_18000d028;
}
else {
LAB_18000ce8f:
iVar1 = local_res20;
local_70 = *(ulonglong *)(param_1 + 0x68);
if ((*(uint *)(param_1 + 0x18) & 0xf0000) != 0) {
local_70 = local_70 | (longlong)*(int *)(param_1 + 0x74) << 0x30;
}
pbVar16 = local_68;
if (((*(byte *)(param_1 + 0x18) & 0x30) != 0) || ((*(byte *)(param_1 + 0x18) & 0xc0) != 0)) {
uVar4 = *(uint *)(param_1 + 0x44);
uVar5 = *puVar11;
if (uVar5 <= *(int *)(param_1 + 0x40) + uVar4) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_1800853e8);
pbVar16 = local_68;
}
goto LAB_18000cecf;
}
if ((local_res20 != 0x17) || (uVar7 < 2)) {
pbVar16 = (byte *)((ulonglong)uVar4 + *(longlong *)(puVar11 + 2));
local_res18 = local_58 - uVar4;
if (uVar7 != 0) {
memmove(pbVar16,*(void **)(puVar18 + 2),_Size);
}
goto LAB_18000cecf;
}
puVar15 = (undefined *)((ulonglong)uVar4 + *(longlong *)(puVar11 + 2));
pvStack_40 = local_50;
uStack_44 = 0;
local_48 = local_58;
*puVar15 = **(undefined **)(puVar18 + 2);
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_1800853e8);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x17,&DAT_1800853e8,1);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x18,&DAT_1800853e8,uVar5 - uVar4);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x19,&DAT_1800853e8,puVar15);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x1a,&DAT_1800853e8,uStack_44);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x1b,&DAT_1800853e8,local_48);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x1c,&DAT_1800853e8,pvStack_40);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1d,&DAT_1800853e8,
*(undefined4 *)(param_1 + 0x68));
}
}
}
}
}
}
}
}
uVar8 = local_70;
iVar3 = SslEncryptPacket(*(undefined8 *)(param_1 + 0x58),*(undefined8 *)(param_1 + 0x30),
puVar15,1,pvStack_40,local_48,&uStack_44,local_70,0x17,0);
if (iVar3 == 0) {
*(longlong *)(param_1 + 0x68) = *(longlong *)(param_1 + 0x68) + 1;
local_70 = uVar8 + 1;
local_50 = (HLOCAL)((longlong)local_50 + (ulonglong)uStack_44);
_Size = (size_t)(uVar7 - 1);
local_res18 = local_res18 - 1;
local_58 = local_58 - uStack_44;
pbVar16 = local_68 + 1;
goto LAB_18000cecf;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar6 = 0x1e;
goto LAB_180037b86;
}
LAB_180037b9d:
uVar9 = 0x80090329;
goto LAB_180037ba2;
}
LAB_18000cecf:
sVar14 = _Size;
if ((*(uint *)(param_1 + 0x18) & 0x3000) != 0) {
sVar14 = (size_t)((int)_Size + 1);
local_res20 = 0x17;
pbVar16[_Size] = (byte)iVar1;
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x20,&DAT_1800853e8);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x21,&DAT_1800853e8,(int)sVar14);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x22,&DAT_1800853e8,local_res18);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x23,&DAT_1800853e8,pbVar16);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x24,&DAT_1800853e8,local_54);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x25,&DAT_1800853e8,local_58);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x26,&DAT_1800853e8,local_50);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x27,&DAT_1800853e8,
*(undefined4 *)(param_1 + 0x68));
}
}
}
}
}
}
}
}
iVar3 = SslEncryptPacket(*(undefined8 *)(param_1 + 0x58),*(undefined8 *)(param_1 + 0x30),pbVar16
,sVar14,local_50,local_58,&local_54,local_70,local_res20,0);
if (iVar3 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar6 = 0x28;
LAB_180037b86:
FUN_180041cdc(DAT_180091000[2],uVar6,&DAT_1800853e8,iVar3);
}
goto LAB_180037b9d;
}
if (((*(uint *)(param_1 + 0x18) & 0xf0000) != 0) && (*(ushort *)(param_1 + 0x88) < local_54)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar6 = 0x29;
iVar3 = 0;
goto LAB_180037b86;
}
goto LAB_180037b9d;
}
uVar8 = *(longlong *)(param_1 + 0x68) + 1;
*(ulonglong *)(param_1 + 0x68) = uVar8;
if (((*(uint *)(param_1 + 0x18) & 0x3000) != 0) &&
((*(char *)(param_1 + 0x1c8) != '\0' || (*(uint *)(param_1 + 0x1cc) <= uVar8)))) {
if (local_58 < local_54) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2a,&DAT_1800853e8);
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
pwVar13 = L"peer request";
if (*(char *)(param_1 + 0x1c8) == '\0') {
pwVar13 = L"write counter";
}
FUN_180041d70(DAT_180091000[2],0x2b,&DAT_1800853e8,pwVar13);
}
local_48 = local_58 - local_54;
pvStack_40 = (HLOCAL)((ulonglong)local_54 + (longlong)local_50);
uStack_44 = 0;
iVar3 = FUN_18004def8(param_1,&local_48);
if (iVar3 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2d,&DAT_1800853e8);
}
*(undefined *)(param_1 + 0x1c8) = 0;
goto LAB_18000cfeb;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar6 = 0x2c;
goto LAB_180037b86;
}
}
goto LAB_180037b9d;
}
LAB_18000cfeb:
pvVar17 = local_60;
uVar9 = 0;
uVar4 = local_54 + uStack_44;
uVar7 = uVar4;
if (*puVar11 <= uVar4) {
uVar7 = *puVar11;
}
uVar4 = uVar4 - uVar7;
*puVar11 = uVar7;
if (puVar10 == (uint *)0x0) {
if (*puVar18 <= uVar4) {
uVar4 = *puVar18;
}
*puVar18 = uVar4;
}
else {
uVar7 = uVar4;
if (*puVar18 <= uVar4) {
uVar7 = *puVar18;
}
*puVar18 = uVar7;
uVar5 = uVar4 - uVar7;
if (*puVar10 <= uVar4 - uVar7) {
uVar5 = *puVar10;
}
*puVar10 = uVar5;
}
if (!bVar19) goto LAB_18000d028;
memcpy(*(void **)(puVar11 + 2),local_60,(ulonglong)*puVar11);
memcpy(*(void **)(puVar18 + 2),(void *)((ulonglong)*puVar11 + (longlong)pvVar17),
(ulonglong)*puVar18);
if (puVar10 != (uint *)0x0) {
memcpy(*(void **)(puVar10 + 2),
(void *)((longlong)pvVar17 + (ulonglong)*puVar11 + (ulonglong)*puVar18),
(ulonglong)*puVar10);
}
}
LocalFree(pvVar17);
LAB_18000d028:
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar9;
}
if ((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) || ((int)uVar9 == 0)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) {
return uVar9;
}
FUN_180041d20(DAT_180091000[2],0x31,&DAT_1800853e8,(int)uVar9,(char)uVar9);
return uVar9;
}
=========================================
Function at address: 0x18000d0a8
Called functions addresses: 0x180041cdc 0x18004f8f0 0x180041cb0 0x18000d1cc 0x180041d20


int FUN_18000d0a8(longlong param_1,int *param_2)

{
uint uVar1;
int iVar2;
int iVar3;
ulonglong uVar4;
uint uVar5;
ulonglong uVar6;
bool bVar7;
uint local_res8 [4];
uint local_res18 [2];
uint local_res20 [2];

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x62,&DAT_1800853e8);
}
uVar5 = *(uint *)(param_1 + 0x18);
iVar2 = FUN_18000d1cc(*(undefined8 *)(param_1 + 0x58),*(undefined4 *)(param_1 + 0x38),uVar5,
*(undefined4 *)(param_1 + 0x3c),local_res20,local_res8,local_res18);
if (iVar2 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar2;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cdc(DAT_180091000[2],99,&DAT_1800853e8,iVar2);
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar2;
}
if (((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) {
return iVar2;
}
FUN_180041d20(DAT_180091000[2],100,&DAT_1800853e8,iVar2,(char)iVar2);
return iVar2;
}
*param_2 = 0;
uVar1 = *(uint *)(param_1 + 0x18);
iVar3 = 0;
iVar2 = iVar3;
if (uVar1 < 0x801) {
iVar2 = 0;
if (uVar1 != 0x800) {
if (((uVar1 == 0x10) || (uVar1 == 0x20)) || ((uVar1 == 0x40 || (uVar1 == 0x80)))) {
iVar2 = *(int *)(param_1 + 0x48);
*param_2 = iVar2;
}
else {
iVar2 = 0;
if ((uVar1 != 0x100) && (iVar2 = iVar3, uVar1 != 0x200)) {
bVar7 = uVar1 == 0x400;
goto LAB_180037da7;
}
}
}
}
else if ((((uVar1 != 0x1000) && (uVar1 != 0x2000)) && (uVar1 != 0x10000)) &&
((uVar1 != 0x20000 && (uVar1 != 0x40000)))) {
bVar7 = uVar1 == 0x80000;
LAB_180037da7:
iVar2 = iVar3;
if (!bVar7) {
param_2[1] = 0;
uVar4 = 0x4000;
uVar6 = 0;
param_2[2] = 0x4000;
iVar2 = 0;
goto LAB_18000d177;
}
}
uVar1 = local_res8[0] + local_res18[0];
uVar6 = (ulonglong)uVar1;
param_2[1] = uVar1;
if ((uVar5 & 0xf0000) == 0) {
uVar4 = 0x4000;
}
else {
uVar4 = (ulonglong)*(ushort *)(param_1 + 0x88);
}
param_2[2] = (int)uVar4;
iVar2 = *(int *)(param_1 + 0x44) + *(int *)(param_1 + 0x40) + iVar2;
*param_2 = iVar2;
if ((*(uint *)(param_1 + 0x18) & 0x3000) != 0) {
uVar5 = local_res18[0] + 7 + uVar1 + iVar2 + local_res8[0];
uVar6 = (ulonglong)uVar5;
param_2[1] = uVar5;
}
LAB_18000d177:
param_2[4] = local_res20[0];
param_2[3] = 4;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_18004f8f0(DAT_180091000[2],uVar4,uVar6,iVar2,(char)uVar6,(char)uVar4,4,
(char)local_res20[0]);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],0x66,&DAT_1800853e8,0,0);
}
}
return 0;
}
=========================================
Function at address: 0x18000d1cc
Called functions addresses: 0x180028d90 0xEXTERNAL:0000010c 0x18000d31c 0xEXTERNAL:00000110 0x180028070


void FUN_18000d1cc(undefined8 param_1,undefined4 param_2,uint param_3,undefined4 param_4,
uint *param_5,uint *param_6,uint *param_7)

{
int iVar1;
uint uVar2;
ulonglong uVar3;
undefined auStack_368 [32];
undefined8 *local_348;
undefined4 local_340;
undefined4 local_338;
undefined8 local_328;
undefined8 uStack_320;
undefined4 local_318;
undefined8 local_308 [34];
uint local_1f8;
uint local_174;
ulonglong local_58;

local_58 = DAT_180091970 ^ (ulonglong)auStack_368;
memset(local_308,0,0x2a4);
uVar3 = FUN_18000d31c(param_3);
local_340 = 0;
local_348 = local_308;
iVar1 = SslLookupCipherSuiteInfo(param_1,uVar3 & 0xffff,param_2,param_4);
if (iVar1 == 0) {
if (param_5 != (uint *)0x0) {
*param_5 = local_1f8;
}
if (param_6 != (uint *)0x0) {
*param_6 = local_174 >> 3;
}
if (param_7 != (uint *)0x0) {
uVar2 = 0;
if (1 < local_1f8) {
uVar2 = local_1f8;
}
*param_7 = uVar2;
}
if ((param_3 & 0x3f00) != 0) {
local_338 = 0;
local_318 = 0;
local_348 = &local_328;
local_340 = 0x14;
local_328 = 0;
uStack_320 = 0;
iVar1 = SslLookupCipherLengths(param_1,uVar3 & 0xffff,param_2,param_4);
if (iVar1 == 0) {
if (param_6 != (uint *)0x0) {
*param_6 = (uint)uStack_320;
}
if (param_7 != (uint *)0x0) {
*param_7 = uStack_320._4_4_;
}
}
}
}
FUN_180028070(local_58 ^ (ulonglong)auStack_368);
return;
}
=========================================
Function at address: 0x18000d31c
Called functions addresses: None


undefined8 FUN_18000d31c(uint param_1)

{
undefined8 uVar1;

if ((param_1 & 0xf0000) != 0 && (param_1 & 0x3ffc) != 0) {
return 0;
}
if ((param_1 & 0xc0000) != 0) {
return 0xfefd;
}
if ((param_1 & 0x30000) != 0) {
return 0xfeff;
}
if ((param_1 & 0x3000) == 0) {
if ((param_1 & 0xc00) == 0) {
uVar1 = 0x300;
if ((param_1 & 0x300) != 0) {
return 0x302;
}
if ((param_1 & 0xc0) != 0) {
return 0x301;
}
if ((param_1 & 0x30) == 0) {
if ((param_1 & 0xc) == 0) {
return 0;
}
return 2;
}
}
else {
uVar1 = 0x303;
}
return uVar1;
}
return 0x304;
}
=========================================
Function at address: 0x18000d37c
Called functions addresses: 0x18002a7c0 0x180041cb0 0x180037e9d 0x180003d4c


void FUN_18000d37c(longlong *param_1,longlong *param_2)

{
longlong *plVar1;
uint uVar2;

plVar1 = (longlong *)param_1[10];
if (plVar1 != param_2) {
if (plVar1 != (longlong *)0x0) {
FUN_180003d4c(DAT_1800927e8,plVar1);

}
LOCK();
*(int *)(param_2 + 3) = *(int *)(param_2 + 3) + 1;
UNLOCK();
param_1[10] = (longlong)param_2;
uVar2 = *(uint *)((longlong)param_2 + 0x9c);
if (((uVar2 & 4) != 0) && (((ulonglong)param_1[0x11] >> 8 & 1) == 0)) {
param_1[0x11] = param_1[0x11] | 0x4000;
uVar2 = *(uint *)((longlong)param_2 + 0x9c);
}
if ((uVar2 & 0x4000) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180082b68);
}
param_1[0x11] = param_1[0x11] | 0x200000000;
}
if (*(int *)((longlong)param_1 + 0x44) == 0x5b) {
if (*(char *)((longlong)param_1 + 0x10a) == '\0') {
FUN_18006049c(param_1);
}
else {
*(undefined *)((longlong)param_1 + 0x39b) = 1;
FUN_18000404c((longlong)param_1,0);
}
}
else if (*(int *)((longlong)param_1 + 0x44) == 0x65) {
FUN_180037e9d();
return;
}
}
return;
}
=========================================
Function at address: 0x18000d410
Called functions addresses: 0x180037ec8 0x180037f5a


undefined8
FUN_18000d410(longlong param_1,undefined8 *param_2,undefined4 *param_3,undefined8 *param_4,
undefined8 *param_5,undefined8 *param_6,undefined8 *param_7,undefined8 *param_8,
longlong *param_9,undefined8 *param_10,longlong *param_11,longlong *param_12,
longlong *param_13)

{
longlong lVar1;
undefined4 *puVar2;
undefined8 uVar3;
uint uVar4;
undefined4 *puVar5;
undefined4 *puVar6;
undefined4 *puVar7;
uint *puVar8;
undefined4 uVar9;
undefined4 *puVar10;
undefined4 *puVar11;
undefined4 *puVar12;
undefined4 *puVar13;
undefined4 *local_res8;
longlong local_68;
longlong local_60;
longlong local_58;
longlong local_50;

puVar2 = (undefined4 *)0x0;
local_res8 = (undefined4 *)0x0;
local_68 = 0;
local_60 = 0;
local_58 = 0;
local_50 = 0;
puVar5 = puVar2;
puVar6 = puVar2;
puVar7 = puVar2;
puVar10 = puVar2;
puVar11 = puVar2;
puVar12 = puVar2;
puVar13 = puVar2;
if (*(uint *)(param_1 + 4) == 0) {
LAB_18000d5ed:
uVar9 = 0;
puVar2 = puVar5;
if (puVar5 == (undefined4 *)0x0) {
*(undefined8 *)(param_3 + 2) = 0;
*param_3 = 0;
goto LAB_18000d50c;
}
}
else {
lVar1 = *(longlong *)(param_1 + 8);
puVar8 = (uint *)(lVar1 + 4);
do {
uVar4 = *puVar8 & 0xfffffff;
if (uVar4 == 0) {
if (((puVar5 == (undefined4 *)0x0) && (local_res8 == (undefined4 *)0x0)) &&
((*puVar8 >> 0x1e & 1) == 0)) goto LAB_18000d4d2;
if (puVar7 == (undefined4 *)0x0) {
puVar7 = (undefined4 *)((longlong)puVar2 * 0x10 + lVar1);
}
}
else if (uVar4 == 2) {
LAB_18000d4d2:
puVar5 = (undefined4 *)((longlong)puVar2 * 0x10 + lVar1);
}
else if (uVar4 == 0x12) {
puVar12 = (undefined4 *)((longlong)puVar2 * 0x10 + lVar1);
}
else {
switch(uVar4) {
case 3:
local_res8 = (undefined4 *)((longlong)puVar2 * 0x10 + lVar1);
break;
case 5:
puVar6 = (undefined4 *)((longlong)puVar2 * 0x10 + lVar1);
break;
case 0x13:
puVar13 = (undefined4 *)((longlong)puVar2 * 0x10 + lVar1);
break;
case 0x14:
puVar10 = (undefined4 *)((longlong)puVar2 * 0x10 + lVar1);
break;
case 0x15:
local_68 = (longlong)puVar2 * 0x10 + lVar1;
break;
case 0x16:
puVar11 = (undefined4 *)((longlong)puVar2 * 0x10 + lVar1);
break;
case 0x17:
local_60 = (longlong)puVar2 * 0x10 + lVar1;
break;
case 0x18:
local_58 = (longlong)puVar2 * 0x10 + lVar1;
break;
case 0x1b:
local_50 = (longlong)puVar2 * 0x10 + lVar1;
}
}
uVar4 = (int)puVar2 + 1;
puVar2 = (undefined4 *)(ulonglong)uVar4;
puVar8 = puVar8 + 4;
} while (uVar4 < *(uint *)(param_1 + 4));
puVar2 = puVar5;
if ((puVar5 == (undefined4 *)0x0) && (puVar2 = local_res8, local_res8 == (undefined4 *)0x0))
goto LAB_18000d5ed;
}
*(undefined8 *)(param_3 + 2) = *(undefined8 *)(puVar2 + 2);
*param_3 = *puVar2;
uVar9 = *puVar2;
puVar5 = puVar2;
LAB_18000d50c:
param_3[1] = uVar9;
if (((puVar7 == (undefined4 *)0x0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar3 = FUN_180037f5a((longlong)DAT_180091000);
return uVar3;
}
*param_2 = puVar5;
*param_4 = puVar7;
*param_5 = puVar6;
*param_6 = puVar12;
*param_7 = puVar13;
*param_8 = puVar10;
*param_9 = local_68;
*param_10 = puVar11;
*param_11 = local_60;
*param_12 = local_58;
*param_13 = local_50;
return 0;
}
=========================================
Function at address: 0x18000d6a8
Called functions addresses: None


uint * FUN_18000d6a8(longlong param_1,ulonglong param_2,undefined8 *param_3,uint *param_4,
undefined8 *param_5,uint *param_6,undefined8 *param_7,undefined8 *param_8,
undefined8 *param_9)

{
longlong lVar1;
uint uVar2;
uint *puVar3;
uint *puVar4;
uint *puVar5;
uint *puVar6;
uint *puVar7;
uint *puVar8;
uint *puVar9;
uint *puVar10;

puVar3 = (uint *)0x0;
puVar4 = (uint *)0x0;
puVar6 = puVar3;
puVar7 = puVar3;
puVar8 = puVar3;
puVar9 = puVar3;
puVar10 = puVar3;
if (*(uint *)(param_1 + 4) != 0) {
lVar1 = *(longlong *)(param_1 + 8);
puVar4 = (uint *)(lVar1 + 4);
puVar5 = puVar3;
do {
uVar2 = *puVar4 & 0xfffffff;
if (uVar2 == 0) {
if ((puVar8 == (uint *)0x0) && ((param_2 & 0x100) != 0)) goto LAB_18000d70b;
}
else if (uVar2 == 2) {
LAB_18000d70b:
puVar8 = (uint *)((longlong)puVar5 * 0x10 + lVar1);
}
else if (uVar2 == 0x11) {
puVar7 = (uint *)((longlong)puVar5 * 0x10 + lVar1);
}
else if (uVar2 == 0x17) {
puVar6 = (uint *)((longlong)puVar5 * 0x10 + lVar1);
}
else if (uVar2 == 0x1a) {
puVar10 = (uint *)((longlong)puVar5 * 0x10 + lVar1);
}
else if (uVar2 == 0x1b) {
puVar9 = (uint *)((longlong)puVar5 * 0x10 + lVar1);
}
uVar2 = (int)puVar5 + 1;
puVar5 = (uint *)(ulonglong)uVar2;
puVar4 = puVar4 + 4;
} while (uVar2 < *(uint *)(param_1 + 4));
puVar4 = puVar3;
if (puVar6 != (uint *)0x0) {
if ((param_2 & 0x100) == 0) {
if (*(longlong *)(puVar6 + 2) == 0) {
puVar4 = (uint *)0xe;
}
}
else {
puVar6[2] = 0;
puVar6[3] = 0;
*puVar6 = 0;
puVar4 = (uint *)0x0;
}
}
}
*param_7 = puVar6;
if (puVar10 != (uint *)0x0) {
if ((param_2 & 0x100) == 0) {
if (*(longlong *)(puVar10 + 2) == 0) {
puVar4 = (uint *)0xe;
}
}
else {
puVar10[2] = 0;
puVar10[3] = 0;
*puVar10 = 0;
}
}
*param_8 = puVar10;
if (puVar9 != (uint *)0x0) {
if ((param_2 & 0x100) == 0) {
if (*(longlong *)(puVar9 + 2) == 0) {
puVar4 = (uint *)0xe;
}
else if (*puVar9 < 8) {
*puVar9 = 8;
puVar4 = (uint *)0x80090321;
}
}
else {
puVar9[2] = 0;
puVar9[3] = 0;
*puVar9 = 0;
}
}
*param_9 = puVar9;
if (puVar7 != (uint *)0x0) {
if ((param_2 & 0x100) == 0) {
puVar6 = *(uint **)(puVar7 + 2);
if (*(uint **)(puVar7 + 2) == (uint *)0x0) {
puVar4 = (uint *)0xe;
puVar6 = puVar3;
}
}
else {
puVar7[2] = 0;
puVar7[3] = 0;
*puVar7 = 0;
puVar6 = puVar3;
}
*(uint **)(param_6 + 2) = puVar6;
*param_6 = *puVar7;
param_6[1] = 0;
}
*param_5 = puVar7;
if (puVar8 == (uint *)0x0) {
puVar4 = (uint *)0x80090308;
}
else {
puVar8[1] = 2;
if ((param_2 & 0x100) == 0) {
puVar3 = *(uint **)(puVar8 + 2);
if (puVar3 == (uint *)0x0) {
return (uint *)0xe;
}
}
else {
puVar8[2] = 0;
puVar8[3] = 0;
*puVar8 = 0;
}
*(uint **)(param_4 + 2) = puVar3;
*param_4 = *puVar8;
param_4[1] = 0;
*param_3 = puVar8;
}
return puVar4;
}
=========================================
Function at address: 0x18000d7d0
Called functions addresses: 0xEXTERNAL:000000c0 0x18003812f 0x18000dbdb 0x1800380b6 0x18000dda0 0x18002a7c0 0x180041cb0 0x18003810b 0x18004a500 0x1800382c8 0xEXTERNAL:000000c2


uint FUN_18000d7d0(undefined4 param_1,longlong *param_2,undefined8 param_3,undefined4 *param_4,
int *param_5,uint *param_6,longlong param_7,int *param_8,longlong param_9,
ulonglong param_10,undefined *param_11,undefined8 *param_12)

{
DWORD *pDVar1;
bool bVar2;
undefined4 uVar3;
char cVar4;
uint uVar5;
uint uVar6;
DWORD csz;
longlong lVar7;
undefined *puVar8;
LPWSTR psz;
uint in_ECX;
undefined8 uVar9;
bool bVar10;
undefined *puVar11;
int iVar12;
undefined *puVar13;
LPWSTR local_b8;
undefined auStack_b0 [16];
undefined auStack_a0 [16];
undefined auStack_90 [16];
undefined auStack_80 [16];
longlong *local_70;
longlong local_68;
longlong lStack_60;
undefined8 local_58;

uVar6 = 0x90312;
bVar2 = false;
if (((in_ECX == 0x90312) && (param_2 != (longlong *)0x0)) &&
(*(int *)((longlong)param_2 + 0x44) == 0x4d)) {
bVar10 = true;
LAB_18000d831:
if (((param_10 & 0x100) != 0) || (!bVar10)) {
*(undefined8 *)(param_8 + 2) = *(undefined8 *)(param_9 + 8);
*param_8 = *(int *)(param_9 + 4);
}
if (in_ECX != 0x80090321) {
if (in_ECX != 0) {
if ((int)in_ECX < 0) {
if (in_ECX != 0x80090318) {
uVar6 = FUN_18003810b(param_1,&DAT_180091000,0);
return uVar6;
}
}
else if ((in_ECX & 0x1fff0000) != 0x90000) {
uVar6 = FUN_18003812f(param_1,&DAT_180091000,0);
return uVar6;
}
}
goto LAB_18000d86b;
}
}
else {
bVar10 = false;
if (in_ECX != 0x80090318) goto LAB_18000d831;
if ((param_5 == (int *)0x0) || (param_6 == (uint *)0x0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(bVar10 = false, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_1 = FUN_180041cb0(DAT_180091000[2],0x11,&DAT_180084d00);
}
}
else {
param_5[1] = 0x40000004;
iVar12 = *(int *)(param_7 + 4) - *param_6;
*param_5 = iVar12;
param_5[2] = 0;
param_5[3] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar6 = FUN_1800380b6((longlong)DAT_180091000,&DAT_180091000,0,iVar12);
return uVar6;
}
}
LAB_18000d86b:
if ((*param_8 != 0) && (!bVar10)) goto LAB_18000d87d;
}
if (((param_10 & 0x100) != 0) && (*(longlong *)(param_8 + 2) != 0)) {
uVar6 = FUN_18003813b(param_1);
return uVar6;
}
LAB_18000d87d:
if (param_2 != (longlong *)0x0) {
if (bVar10) {
in_ECX = 0;
}
else if (((in_ECX == 0) || (in_ECX == 0x90316)) || (in_ECX == 0x8009036a)) {
if (((param_6 != (uint *)0x0) && (*(uint *)(param_7 + 4) < *param_6)) &&
(param_5 != (int *)0x0)) {
param_5[1] = 0x40000005;
*param_5 = *param_6 - *(int *)(param_7 + 4);
param_5[2] = 0;
param_5[3] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar6 = FUN_180038180((longlong)DAT_180091000);
return uVar6;
}
}
if (in_ECX == 0) {
iVar12 = *(int *)((longlong)param_2 + 0x44);
bVar10 = false;
if ((((iVar12 == 4) || (iVar12 == 0x33)) || (iVar12 == 0x4f)) &&
((*(uint *)(param_2 + 0x11) >> 0x1e & 1) == 0)) {
local_68 = 0;
lStack_60 = 0;
local_58 = 0;
*param_11 = 1;
local_70 = param_2;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180084d00);
}
uVar5 = FUN_18000dda0(&local_70,FUN_18004a500);
if (uVar5 != 0) {
return uVar5;
}
uVar3 = (undefined4)local_58;

if (local_68 == 0) {
return 0xe;
}
local_58 = CONCAT44(uVar3,(undefined4)local_58);
lStack_60 = local_68;
uVar5 = FUN_18000dda0(&local_70,FUN_18004a500);
if (uVar5 != 0) {

return uVar5;
}
*(longlong *)(param_4 + 2) = local_68;
*param_4 = (undefined4)local_58;
param_2[0x11] = param_2[0x11] | 0x40000000;
if ((*(int *)((longlong)param_2 + 0x44) == 4) ||
(*(int *)((longlong)param_2 + 0x44) == 0x4f)) {

bVar10 = bVar2;
if (*(char *)((longlong)param_2 + 0x109) == '\0') {
puVar11 = (undefined *)0x0;
psz = (LPWSTR)0x0;


if (lVar7 != 0) {
puVar11 = *(undefined **)(lVar7 + 400);
}
RtlAcquireResourceShared(param_2[0xb] + 0x48,1);
pDVar1 = *(DWORD **)(param_2[0xb] + 0x30);
if (((pDVar1 == (DWORD *)0x0) ||
(csz = CertNameToStrW(*pDVar1,(PCERT_NAME_BLOB)(*(longlong *)(pDVar1 + 6) + 0x50),
0x20000003,(LPWSTR)0x0,0), csz == 0)) ||
(psz = (LPWSTR)FUN_18000a1f4((ulonglong)(csz * 2)), psz == (LPWSTR)0x0)) {
RtlReleaseResource(param_2[0xb] + 0x48);
local_b8 = psz;
if (psz == (LPWSTR)0x0) {
local_b8 = L"";
}
}
else {
CertNameToStrW(*pDVar1,(PCERT_NAME_BLOB)(*(longlong *)(pDVar1 + 6) + 0x50),
0x20000003,psz,csz);
RtlReleaseResource(param_2[0xb] + 0x48);
local_b8 = psz;
}
puVar13 = &DAT_18008233c;
if (puVar11 != (undefined *)0x0) {
puVar13 = puVar11;
}
puVar11 = &DAT_18008233c;
if (puVar8 != (undefined *)0x0) {
puVar11 = puVar8;
}
if ((DAT_1800919b0 & 4) != 0) {
uVar5 = *(uint *)(param_2 + 8);
FUN_1800452cc(uVar5,auStack_80);
uVar9 = DAT_180092df8;
if ((uVar5 & 0x40051555) != 0) {
uVar9 = DAT_180092df0;
}
RtlInitUnicodeString(&local_70,uVar9);
RtlInitUnicodeString(auStack_90,puVar11);
RtlInitUnicodeString(auStack_a0,puVar13);
RtlInitUnicodeString(auStack_b0,local_b8);
FUN_180045408((ushort *)&DAT_180082ac8,0x180082ab0,&local_70,auStack_80);
}
if (psz != (LPWSTR)0x0) {
FUN_18000909c(psz);
}
}
else {
*(undefined *)((longlong)param_2 + 0x109) = 0;
}
}
else {
if (param_2[0x13] != 0) {
SslFreeObject(param_2[0x13],0);
param_2[0x13] = 0;
}
bVar10 = true;
}
}
if ((*(int *)((longlong)param_2 + 0x44) - 3U < 2) ||
(*(int *)((longlong)param_2 + 0x44) == 0x4f)) {
uVar6 = 0;
}
else if (bVar10) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180084d00);
}
uVar6 = 0x90366;
}
else {

if (cVar4 == '\0') {
uVar6 = FUN_1800382c8();
return uVar6;
}
}
in_ECX = uVar6;
if (param_12 != (undefined8 *)0x0) {
lVar7 = param_2[0xb];
if (lVar7 != 0) {
RtlAcquireResourceShared(lVar7 + 0x48,1);
if (*(longlong *)(lVar7 + 0x30) != 0) {
*param_12 = *(undefined8 *)(*(longlong *)(*(longlong *)(lVar7 + 0x30) + 0x18) + 0x48);
RtlReleaseResource(lVar7 + 0x48);
return uVar6;
}
RtlReleaseResource();
}
*param_12 = 0x7fffff36d5969fff;
}
}
}
}
return in_ECX;
}
=========================================
Function at address: 0x18000dbdb
Called functions addresses: 0x180038180 0x18003813b 0x18000909c 0x18000a1f4


int FUN_18000dbdb(undefined4 param_1,undefined8 **param_2,int param_3)

{
undefined4 uVar1;
uint uVar2;
undefined4 *puVar3;
DWORD *pDVar4;
undefined8 *puVar5;
char cVar6;
int iVar7;
DWORD DVar8;
longlong lVar9;
undefined *puVar10;
LPWSTR psz;
undefined8 uVar11;
longlong unaff_RBX;
longlong unaff_RBP;
int unaff_ESI;
undefined *puVar12;
int unaff_EDI;
uint *unaff_R12;
int unaff_R13D;
int *unaff_R14;
undefined *puVar13;
longlong unaff_R15;

if (((*(ulonglong *)(unaff_RBP + 0x97) & 0x100) != 0) && (*(longlong *)(unaff_R15 + 8) != 0)) {
iVar7 = FUN_18003813b(param_1);
return iVar7;
}
if (unaff_RBX == 0) {
return unaff_EDI;
}
if (unaff_ESI != 0) {
return 0;
}
if (((unaff_EDI != 0) && (unaff_EDI != 0x90316)) && (unaff_EDI != -0x7ff6fc96)) {
return unaff_EDI;
}
if (((unaff_R12 != (uint *)0x0) &&
(lVar9 = *(longlong *)(unaff_RBP + 0x7f), *(uint *)(lVar9 + 4) < *unaff_R12)) &&
(unaff_R14 != (int *)0x0)) {
unaff_R14[1] = 0x40000005;
*unaff_R14 = *unaff_R12 - *(int *)(lVar9 + 4);
unaff_R14[2] = 0;
unaff_R14[3] = 0;
if ((DAT_180091000 != param_2) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
iVar7 = FUN_180038180((longlong)DAT_180091000);
return iVar7;
}
}
if (unaff_EDI != 0) {
return unaff_EDI;
}
iVar7 = *(int *)(unaff_RBX + 0x44);
if ((((iVar7 != 4) && (iVar7 != 0x33)) && (iVar7 != 0x4f)) ||
((*(uint *)(unaff_RBX + 0x88) >> 0x1e & 1) != 0)) goto LAB_18000dac0;
*(longlong *)(unaff_RBP + -0x29) = unaff_RBX;
*(undefined8 *)(unaff_RBP + -0x21) = 0;
*(undefined8 *)(unaff_RBP + -0x19) = 0;
*(undefined8 *)(unaff_RBP + -0x11) = 0;
**(undefined **)(unaff_RBP + 0x9f) = 1;
if ((DAT_180091000 != param_2) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180084d00);
}
iVar7 = FUN_18000dda0((undefined8 *)(unaff_RBP + -0x29),FUN_18004a500);
if (iVar7 != 0) {
return iVar7;
}
uVar1 = *(undefined4 *)(unaff_RBP + -0x11);

*(longlong *)(unaff_RBP + -0x21) = lVar9;
if (lVar9 == 0) {
return 0xe;
}
*(undefined4 *)(unaff_RBP + -0xd) = uVar1;
*(longlong *)(unaff_RBP + -0x19) = lVar9;
iVar7 = FUN_18000dda0((undefined8 *)(unaff_RBP + -0x29),FUN_18004a500);
if (iVar7 != 0) {

(*(undefined8 *)(unaff_RBP + -0x29),*(undefined8 *)(unaff_RBP + -0x21));
return iVar7;
}
puVar3 = *(undefined4 **)(unaff_RBP + 0x67);
*(undefined8 *)(puVar3 + 2) = *(undefined8 *)(unaff_RBP + -0x21);
*puVar3 = *(undefined4 *)(unaff_RBP + -0x11);
*(ulonglong *)(unaff_RBX + 0x88) = *(ulonglong *)(unaff_RBX + 0x88) | 0x40000000;
if ((*(int *)(unaff_RBX + 0x44) == 4) || (*(int *)(unaff_RBX + 0x44) == 0x4f)) {

if (*(char *)(unaff_RBX + 0x109) == '\0') {
puVar12 = (undefined *)0x0;
psz = (LPWSTR)0x0;


if (lVar9 != 0) {
puVar12 = *(undefined **)(lVar9 + 400);
}
RtlAcquireResourceShared(*(longlong *)(unaff_RBX + 0x58) + 0x48,1);
pDVar4 = *(DWORD **)(*(longlong *)(unaff_RBX + 0x58) + 0x30);
if (pDVar4 == (DWORD *)0x0) {
LAB_18000da48:
RtlReleaseResource(*(longlong *)(unaff_RBX + 0x58) + 0x48);
if (psz != (LPWSTR)0x0) goto LAB_18000dcdb;
*(undefined **)(unaff_RBP + -0x71) = &DAT_18008233c;
}
else {
DVar8 = CertNameToStrW(*pDVar4,(PCERT_NAME_BLOB)(*(longlong *)(pDVar4 + 6) + 0x50),
0x20000003,(LPWSTR)0x0,0);
*(DWORD *)(unaff_RBP + 0x57) = DVar8;
if ((DVar8 == 0) ||
(psz = (LPWSTR)FUN_18000a1f4((ulonglong)(DVar8 * 2)), psz == (LPWSTR)0x0))
goto LAB_18000da48;
CertNameToStrW(*pDVar4,(PCERT_NAME_BLOB)(*(longlong *)(pDVar4 + 6) + 0x50),0x20000003,psz,
*(DWORD *)(unaff_RBP + 0x57));
RtlReleaseResource(*(longlong *)(unaff_RBX + 0x58) + 0x48);
LAB_18000dcdb:
*(LPWSTR *)(unaff_RBP + -0x71) = psz;
}
puVar13 = &DAT_18008233c;
if (puVar12 != (undefined *)0x0) {
puVar13 = puVar12;
}
puVar12 = &DAT_18008233c;
if (puVar10 != (undefined *)0x0) {
puVar12 = puVar10;
}
*(undefined4 *)(unaff_RBP + 0x57) = *(undefined4 *)(*(longlong *)(unaff_RBX + 0x58) + 8);
if ((DAT_1800919b0 & 4) != 0) {
uVar2 = *(uint *)(unaff_RBX + 0x40);
FUN_1800452cc(uVar2,unaff_RBP + -0x39);
uVar11 = DAT_180092df8;
if ((uVar2 & 0x40051555) != 0) {
uVar11 = DAT_180092df0;
}
RtlInitUnicodeString(unaff_RBP + -0x29,uVar11);
RtlInitUnicodeString(unaff_RBP + -0x49,puVar12);
RtlInitUnicodeString(unaff_RBP + -0x59,puVar13);
RtlInitUnicodeString(unaff_RBP + -0x69,*(undefined8 *)(unaff_RBP + -0x71));
FUN_180045408((ushort *)&DAT_180082ac8,0x180082ab0,unaff_RBP + -0x29,unaff_RBP + -0x39);
}
if (psz != (LPWSTR)0x0) {
FUN_18000909c(psz);
}
}
else {
*(undefined *)(unaff_RBX + 0x109) = 0;
}
param_3 = *(int *)(unaff_RBP + 0x4f);
}
else {
if (*(longlong *)(unaff_RBX + 0x98) != 0) {
SslFreeObject(*(longlong *)(unaff_RBX + 0x98),0);
*(undefined8 *)(unaff_RBX + 0x98) = 0;
}
param_3 = 1;
}
param_2 = &DAT_180091000;
LAB_18000dac0:
if ((*(int *)(unaff_RBX + 0x44) - 3U < 2) || (*(int *)(unaff_RBX + 0x44) == 0x4f)) {
unaff_R13D = 0;
}
else if (param_3 == 0) {

if (cVar6 == '\0') {
iVar7 = FUN_1800382c8();
return iVar7;
}
}
else {
if ((DAT_180091000 != param_2) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180084d00);
}
unaff_R13D = 0x90366;
}
puVar5 = *(undefined8 **)(unaff_RBP + 0xa7);
if (puVar5 != (undefined8 *)0x0) {
lVar9 = *(longlong *)(unaff_RBX + 0x58);
if (lVar9 != 0) {
RtlAcquireResourceShared(lVar9 + 0x48,1);
if (*(longlong *)(lVar9 + 0x30) != 0) {
*puVar5 = *(undefined8 *)(*(longlong *)(*(longlong *)(lVar9 + 0x30) + 0x18) + 0x48);
RtlReleaseResource(lVar9 + 0x48);
return unaff_R13D;
}
RtlReleaseResource();
}
*puVar5 = 0x7fffff36d5969fff;
}
return unaff_R13D;
}
=========================================
Function at address: 0x18000dda0
Called functions addresses: 0x18004dd58 0x18002a77b 0xEXTERNAL:00000113 0x18002a7c0 0x180028070 0x18000e544


void FUN_18000dda0(undefined8 *param_1,undefined *param_2)

{
undefined8 *puVar1;
undefined8 *puVar2;
undefined4 *puVar3;
undefined4 uVar4;
undefined4 uVar5;
undefined4 uVar6;
longlong lVar7;
int iVar8;
longlong lVar9;
undefined8 *puVar10;
void *pvVar11;
uint *puVar12;
undefined8 uVar13;
uint uVar14;
undefined8 *puVar15;
uint uVar16;
undefined4 *puVar17;
undefined auStack_328 [32];
uint *local_308;
void **local_300;
uint *local_2f8;
void **local_2f0;
uint *local_2e8;
void **local_2e0;
uint *local_2d8;
void **local_2d0;
uint *local_2c8;
void *local_2b8;
uint local_2b0;
uint local_2ac;
uint local_2a8;
uint local_2a4;
uint local_2a0 [2];
undefined8 local_298;
uint local_290;
uint local_28c;
longlong local_288;
longlong local_280;
void *local_278;
void *local_270;
void *local_268;
void *local_260;
void *local_258;
longlong local_250;
longlong local_248;
longlong local_240;
void *local_238;
void *local_230;
short local_228 [256];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_328;
local_2b0 = 0;
local_2ac = 0;
local_278 = (void *)0x0;
local_270 = (void *)0x0;
local_268 = (void *)0x0;
local_2a8 = 0;
local_260 = (void *)0x0;
local_2a4 = 0;
local_258 = (void *)0x0;
local_2a0[0] = 0;
if (param_1[1] == 0) {
*(int *)(param_1 + 3) = *(int *)(param_1 + 3) + 0xd8;
}
else {
local_2b8 = (void *)0x0;
if (*(uint *)((longlong)param_1 + 0x1c) < 0xd8) goto LAB_18000e1df;
puVar3 = (undefined4 *)param_1[2];
*puVar3 = 1;
*(undefined8 *)(puVar3 + 1) = 200;

if (iVar8 != 0) goto LAB_18000e1df;

if (local_250 != 0) {
if (param_2 != (undefined *)0x0) {

}
*(void **)(puVar3 + 0x14) = local_2b8;
}
param_1[2] = param_1[2] + 0xd8;
*(int *)((longlong)param_1 + 0x1c) = *(int *)((longlong)param_1 + 0x1c) + -0xd8;
}

if (iVar8 == 0) {
lVar9 = -1;
do {
lVar7 = lVar9 + 1;
lVar9 = lVar9 + 1;
} while (local_228[lVar7] != 0);
iVar8 = (int)lVar9 * 2;
uVar14 = iVar8 + 2;
uVar16 = iVar8 + 0x19U & 0xfffffff8;
if (param_1[1] == 0) {
*(uint *)(param_1 + 3) = *(int *)(param_1 + 3) + uVar16;
}
else {
if (*(uint *)((longlong)param_1 + 0x1c) < uVar16) goto LAB_18000e1df;
puVar3 = (undefined4 *)param_1[2];
puVar3[2] = uVar14;
*puVar3 = 9;
puVar3[1] = uVar16 - 0x10;
memcpy((void *)(param_1[2] + 0x10),local_228,(ulonglong)uVar14);
param_1[2] = param_1[2] + (ulonglong)uVar16;
*(int *)((longlong)param_1 + 0x1c) = *(int *)((longlong)param_1 + 0x1c) - uVar16;
}

lVar9 = 2;
if (local_248 != 0) {
puVar3 = (undefined4 *)param_1[2];
iVar8 = *(int *)((longlong)param_1 + 0x1c);
puVar17 = puVar3;
if (param_1[1] != 0) {
iVar8 = iVar8 + -0x10;
param_1[2] = puVar3 + 4;
*(int *)((longlong)param_1 + 0x1c) = iVar8;
puVar17 = puVar3 + 4;
}
local_300 = &local_2b8;
local_2f8 = (uint *)((ulonglong)local_2f8 & 0xffffffff00000000);
local_2b8 = (void *)CONCAT44(local_2b8._4_4_,iVar8);
local_308 = (uint *)CONCAT44(local_308._4_4_,iVar8);
iVar8 = SslExportKey(local_298,local_248,L"OpaqueKeyBlob",puVar17);
if ((iVar8 != 0) && (iVar8 != -0x7ff6ffd8)) goto LAB_18000e1df;
uVar14 = (int)local_2b8 + 0x17U & 0xfffffff8;
if (param_1[1] == 0) {
*(uint *)(param_1 + 3) = *(int *)(param_1 + 3) + uVar14;
}
else {
*puVar3 = 2;
puVar3[1] = uVar14 - 0x10;
puVar3[2] = (int)local_2b8;
param_1[2] = param_1[2] + (ulonglong)(uVar14 - 0x10);
*(int *)((longlong)param_1 + 0x1c) = *(int *)((longlong)param_1 + 0x1c) + (0x10 - uVar14);
}
}
if (local_240 != 0) {
puVar3 = (undefined4 *)param_1[2];
iVar8 = *(int *)((longlong)param_1 + 0x1c);
puVar17 = puVar3;
if (param_1[1] != 0) {
iVar8 = iVar8 + -0x10;
param_1[2] = puVar3 + 4;
*(int *)((longlong)param_1 + 0x1c) = iVar8;
puVar17 = puVar3 + 4;
}
local_300 = &local_2b8;
local_2f8 = (uint *)((ulonglong)local_2f8 & 0xffffffff00000000);
local_2b8 = (void *)CONCAT44(local_2b8._4_4_,iVar8);
local_308 = (uint *)CONCAT44(local_308._4_4_,iVar8);
iVar8 = SslExportKey(local_298,local_240,L"OpaqueKeyBlob",puVar17);
if ((iVar8 != 0) && (iVar8 != -0x7ff6ffd8)) goto LAB_18000e1df;
uVar14 = (int)local_2b8 + 0x17U & 0xfffffff8;
if (param_1[1] == 0) {
*(uint *)(param_1 + 3) = *(int *)(param_1 + 3) + uVar14;
}
else {
*puVar3 = 3;
puVar3[1] = uVar14 - 0x10;
puVar3[2] = (int)local_2b8;
param_1[2] = param_1[2] + (ulonglong)(uVar14 - 0x10);
*(int *)((longlong)param_1 + 0x1c) = *(int *)((longlong)param_1 + 0x1c) + (0x10 - uVar14);
}
}
local_288 = 0;
local_280 = 0;

if (((local_288 == 0) ||
(uVar13 = FUN_18004dd58((longlong)param_1,0x13,local_298,local_288), (int)uVar13 == 0)) &&
((local_280 == 0 ||
(uVar13 = FUN_18004dd58((longlong)param_1,0x14,local_298,local_280), (int)uVar13 == 0)))) {
local_2c8 = &local_2a4;
local_2d0 = &local_260;
local_2d8 = &local_2a8;
local_2e0 = &local_268;
local_2e8 = &local_28c;
local_2f0 = &local_270;
local_2f8 = &local_2ac;
local_300 = &local_230;
local_308 = &local_2b0;

if ((local_278 == (void *)0x0) ||
(uVar13 = FUN_18000e544((longlong)param_1,4,local_278,local_290), (int)uVar13 == 0)) {
if (local_2b0 != 0) {
uVar14 = local_2b0 + 0x17 & 0xfffffff8;
if (param_1[1] == 0) {
*(uint *)(param_1 + 3) = *(int *)(param_1 + 3) + uVar14;
}
else {
if (*(uint *)((longlong)param_1 + 0x1c) < uVar14) goto LAB_18000e1df;
puVar3 = (undefined4 *)param_1[2];
puVar3[2] = local_2b0;
*puVar3 = 5;
puVar3[1] = uVar14 - 0x10;
memcpy((void *)(param_1[2] + 0x10),local_238,(ulonglong)local_2b0);
param_1[2] = param_1[2] + (ulonglong)uVar14;
*(int *)((longlong)param_1 + 0x1c) = *(int *)((longlong)param_1 + 0x1c) - uVar14;
}
}
if (local_2ac != 0) {
uVar14 = local_2ac + 0x17 & 0xfffffff8;
if (param_1[1] == 0) {
*(uint *)(param_1 + 3) = *(int *)(param_1 + 3) + uVar14;
}
else {
if (*(uint *)((longlong)param_1 + 0x1c) < uVar14) goto LAB_18000e1df;
puVar3 = (undefined4 *)param_1[2];
puVar3[2] = local_2ac;
*puVar3 = 6;
puVar3[1] = uVar14 - 0x10;
memcpy((void *)(param_1[2] + 0x10),local_230,(ulonglong)local_2ac);
param_1[2] = param_1[2] + (ulonglong)uVar14;
*(int *)((longlong)param_1 + 0x1c) = *(int *)((longlong)param_1 + 0x1c) - uVar14;
}
}
if (((local_270 == (void *)0x0) ||
(uVar13 = FUN_18000e544((longlong)param_1,7,local_270,local_28c), (int)uVar13 == 0)) &&
((local_268 == (void *)0x0 ||
((local_2a8 == 0 ||
(uVar13 = FUN_18000e544((longlong)param_1,8,local_268,local_2a8), (int)uVar13 == 0)))))
) {
if (local_260 != (void *)0x0) {
uVar14 = local_2a4 + 0x17 & 0xfffffff8;
if (param_1[1] == 0) {
*(uint *)(param_1 + 3) = *(int *)(param_1 + 3) + uVar14;
}
else {
if (*(uint *)((longlong)param_1 + 0x1c) < uVar14) goto LAB_18000e1df;
puVar3 = (undefined4 *)param_1[2];
*puVar3 = 10;
puVar3[1] = uVar14 - 0x10;
puVar3[2] = local_2a4;
memcpy((void *)(param_1[2] + 0x10),local_260,(ulonglong)local_2a4);
param_1[2] = param_1[2] + (ulonglong)uVar14;
*(int *)((longlong)param_1 + 0x1c) = *(int *)((longlong)param_1 + 0x1c) - uVar14;
}
}

if (local_2a0[0] != 0) {
uVar14 = local_2a0[0] + 0x17 & 0xfffffff8;
if (param_1[1] == 0) {
*(uint *)(param_1 + 3) = *(int *)(param_1 + 3) + uVar14;
}
else {
if (*(uint *)((longlong)param_1 + 0x1c) < uVar14) goto LAB_18000e1df;
puVar3 = (undefined4 *)param_1[2];
puVar3[2] = local_2a0[0];
*puVar3 = 0xb;
puVar3[1] = uVar14 - 0x10;
memcpy((void *)(param_1[2] + 0x10),local_258,(ulonglong)local_2a0[0]);
param_1[2] = param_1[2] + (ulonglong)uVar14;
*(int *)((longlong)param_1 + 0x1c) = *(int *)((longlong)param_1 + 0x1c) - uVar14;
}
}

if (puVar10 != (undefined8 *)0x0) {
if (param_1[1] == 0) {
*(int *)(param_1 + 3) = *(int *)(param_1 + 3) + 0x118;
}
else {
if (*(uint *)((longlong)param_1 + 0x1c) < 0x118) goto LAB_18000e1df;
puVar3 = (undefined4 *)param_1[2];
*puVar3 = 0xc;
puVar3[1] = 0x108;
puVar3[2] = 0x108;
puVar15 = (undefined8 *)(param_1[2] + 0x10);
do {
puVar1 = puVar15 + 0x10;
uVar13 = puVar10[1];
puVar2 = puVar10 + 0x10;
*puVar15 = *puVar10;
puVar15[1] = uVar13;
uVar13 = puVar10[3];
puVar15[2] = puVar10[2];
puVar15[3] = uVar13;
uVar13 = puVar10[5];
puVar15[4] = puVar10[4];
puVar15[5] = uVar13;
uVar13 = puVar10[7];
puVar15[6] = puVar10[6];
puVar15[7] = uVar13;
uVar13 = puVar10[9];
puVar15[8] = puVar10[8];
puVar15[9] = uVar13;
uVar13 = puVar10[0xb];
puVar15[10] = puVar10[10];
puVar15[0xb] = uVar13;
uVar4 = *(undefined4 *)((longlong)puVar10 + 100);
uVar5 = *(undefined4 *)(puVar10 + 0xd);
uVar6 = *(undefined4 *)((longlong)puVar10 + 0x6c);
*(undefined4 *)(puVar15 + 0xc) = *(undefined4 *)(puVar10 + 0xc);
*(undefined4 *)((longlong)puVar15 + 100) = uVar4;
*(undefined4 *)(puVar15 + 0xd) = uVar5;
*(undefined4 *)((longlong)puVar15 + 0x6c) = uVar6;
uVar13 = puVar10[0xf];
puVar15[0xe] = puVar10[0xe];
puVar15[0xf] = uVar13;
lVar9 = lVar9 + -1;
puVar10 = puVar2;
puVar15 = puVar1;
} while (lVar9 != 0);
*puVar1 = *puVar2;
param_1[2] = param_1[2] + 0x118;
*(int *)((longlong)param_1 + 0x1c) = *(int *)((longlong)param_1 + 0x1c) + -0x118;
}
}

if ((((pvVar11 == (void *)0x0) ||
((uVar13 = FUN_18000e544((longlong)param_1,0xd,pvVar11,0x10), (int)uVar13 == 0 &&
((*(byte *)((longlong)pvVar11 + 2) == 0 ||
(uVar13 = FUN_18000e544((longlong)param_1,0xe,*(void **)((longlong)pvVar11 + 8),
(uint)*(byte *)((longlong)pvVar11 + 2)), (int)uVar13 == 0))

pvVar11 == (void *)0x0 ||
((uVar13 = FUN_18000e544((longlong)param_1,0xf,pvVar11,0x10),
(int)uVar13 == 0 &&
((*(ushort *)((longlong)pvVar11 + 2) == 0 ||
(uVar13 = FUN_18000e544((longlong)param_1,0x10,
*(void **)((longlong)pvVar11 + 8),
(uint)*(ushort *)((longlong)pvVar11 + 2)),
(int)uVar13 == 0)))))))) &&

puVar12 == (uint *)0x0 ||
((*(void **)(puVar12 + 2) == (void *)0x0 ||
(uVar13 = FUN_18000e544((longlong)param_1,0x11,*(void **)(puVar12 + 2),*puVar12),
(int)uVar13 == 0)))) &&

(uVar13 = FUN_18004dd58((longlong)param_1,0x12,local_298,lVar9), (int)uVar13 == 0))))
)) {
if (param_1[1] == 0) {
*(int *)(param_1 + 3) = *(int *)(param_1 + 3) + 0x10;
}
else if (0xf < *(uint *)((longlong)param_1 + 0x1c)) {
puVar10 = (undefined8 *)param_1[2];
*puVar10 = 0;
*(undefined4 *)(puVar10 + 1) = 0;
param_1[2] = param_1[2] + 0x10;
*(int *)((longlong)param_1 + 0x1c) = *(int *)((longlong)param_1 + 0x1c) + -0x10;
}
}
}
}
}
}
LAB_18000e1df:
FUN_180028070(local_28 ^ (ulonglong)auStack_328);
return;
}
=========================================
Function at address: 0x18000e544
Called functions addresses: 0x18002a77b


undefined8 FUN_18000e544(longlong param_1,undefined4 param_2,void *param_3,uint param_4)

{
undefined4 *puVar1;
uint uVar2;

uVar2 = param_4 + 0x17 & 0xfffffff8;
if (*(longlong *)(param_1 + 8) == 0) {
*(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + uVar2;
}
else {
if (*(uint *)(param_1 + 0x1c) < uVar2) {
return 0x54f;
}
puVar1 = *(undefined4 **)(param_1 + 0x10);
*puVar1 = param_2;
puVar1[1] = uVar2 - 0x10;
puVar1[2] = param_4;
memcpy((void *)(*(longlong *)(param_1 + 0x10) + 0x10),param_3,(ulonglong)param_4);
*(longlong *)(param_1 + 0x10) = *(longlong *)(param_1 + 0x10) + (ulonglong)uVar2;
*(int *)(param_1 + 0x1c) = *(int *)(param_1 + 0x1c) - uVar2;
}
return 0;
}
=========================================
Function at address: 0x18000e5b4
Called functions addresses: 0x180038498


ulonglong FUN_18000e5b4(uint param_1)

{
undefined8 in_RAX;
uint7 uVar2;
ulonglong uVar1;

uVar2 = (uint7)((ulonglong)in_RAX >> 8);
if (param_1 != 0) {
if ((int)param_1 < 0) {
if (param_1 != 0x80090318) {
uVar1 = FUN_180038498(param_1);
return uVar1;
}
}
else if ((param_1 & 0x1fff0000) != 0x90000) {
return CONCAT71(uVar2,1);
}
}
return (ulonglong)uVar2 << 8;
}
=========================================
Function at address: 0x18000e5e4
Called functions addresses: 0x18005004c 0x180017348 0xEXTERNAL:000000c0 0x1800500a0 0x180016b6c 0xEXTERNAL:0000010b 0xEXTERNAL:000000bc 0x18000e714 0x180041d20 0xEXTERNAL:000000c2 0x180016f2c


int FUN_18000e5e4(wchar_t *param_1,longlong *param_2,undefined8 param_3)

{
int iVar1;
longlong lVar2;
wchar_t *pwVar3;
bool bVar4;
longlong local_28 [2];

bVar4 = false;
RtlAcquireResourceShared(DAT_1800921b8,1);
lVar2 = FUN_18000e714(param_1);
RtlReleaseResource(DAT_1800921b8);
if (lVar2 == 0) {
pwVar3 = param_1;
iVar1 = FUN_180016b6c(local_28,(longlong)param_1);
if (iVar1 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar1;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_1800500a0(DAT_180091000[2],pwVar3,param_3,local_28,param_1);
}
goto LAB_18000e668;
}
RtlAcquireResourceExclusive(DAT_1800921b8,1);
lVar2 = FUN_18000e714(param_1);
bVar4 = lVar2 != 0;
if (bVar4) {
FUN_180017348(local_28);
}
else {
FUN_180016f2c(local_28);
lVar2 = local_28[0];
}
bVar4 = !bVar4;
RtlReleaseResource(DAT_1800921b8);
}
iVar1 = SslIncrementProviderReferenceCount(lVar2);
if (iVar1 == 0) {
*param_2 = lVar2;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_18005004c(DAT_180091000[2],0x18,&DAT_1800853f8,lVar2,(char)iVar1);
}
if (bVar4) {
FUN_180017348(local_28);
}
}
LAB_18000e668:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar1 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x19,&DAT_1800853f8,iVar1,(char)iVar1);
}
return iVar1;
}
=========================================
Function at address: 0x18000e714
Called functions addresses: 0x18000e76d


undefined8 FUN_18000e714(short *param_1)

{
short sVar1;
short sVar2;
uint uVar3;
ulonglong uVar4;
undefined8 uVar5;
short *psVar6;
longlong *plVar7;

uVar4 = 0;
if (DAT_180092a90 == 0) {
return 0;
}
plVar7 = &DAT_180092aa8;
do {
psVar6 = param_1;
do {
sVar1 = *psVar6;
sVar2 = *(short *)((longlong)psVar6 + (*plVar7 - (longlong)param_1));
if (sVar1 != sVar2) break;
psVar6 = psVar6 + 1;
} while (sVar2 != 0);
if (sVar1 == sVar2) {
return (&DAT_180092aa0)[uVar4 * 2];
}
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
plVar7 = plVar7 + 2;
if (DAT_180092a90 <= uVar3) {
uVar5 = FUN_18000e76d();
return uVar5;
}
} while( true );
}
=========================================
Function at address: 0x18000e76d
Called functions addresses: None


undefined8 FUN_18000e76d(void)

{
return 0;
}
=========================================
Function at address: 0x18000e778
Called functions addresses: 0xEXTERNAL:0000003f 0x180028d90


undefined8 * FUN_18000e778(uint param_1)

{
undefined8 *_Dst;

if ((0x1cf < param_1) &&
(_Dst = (undefined8 *)LocalAlloc(0x40,(ulonglong)param_1), _Dst != (undefined8 *)0x0)) {
memset(_Dst,0,(ulonglong)param_1);
*(undefined4 *)((longlong)_Dst + 0x17c) = 0;
_Dst[0x31] = 0;
_Dst[0x32] = 0;
_Dst[0x33] = 0;
_Dst[0x36] = 0;
_Dst[0x37] = 0;
*_Dst = &PTR_FUN_18007d058;
_Dst[0x38] = 0;
*(undefined4 *)(_Dst + 0x12) = 0xffffffff;
*(undefined *)(_Dst + 4) = 0;
*(undefined *)(_Dst + 0xe) = 0;
*(undefined *)((longlong)_Dst + 0x8c) = 0;
*(undefined *)(_Dst + 0x39) = 0;
*(undefined4 *)((longlong)_Dst + 0x1cc) = 0x16a09e6;
_Dst[0x34] = 0;
_Dst[0x35] = 0;
*(undefined4 *)(_Dst + 0x30) = 0xffffffff;
return _Dst;
}
return (undefined8 *)0x0;
}
=========================================
Function at address: 0x18000e850
Called functions addresses: 0x180023520 0x180045064 0x1800237c0 0xEXTERNAL:0000016d 0x180026774 0xEXTERNAL:00000082 0xEXTERNAL:000000e0 0x180041cdc 0x180045408 0x1800276a4 0x180016de0 0x180016fd0 0x180026e34 0xEXTERNAL:00000041 0x180026d60 0x180016ab4 0x18002796c 0x18000a1f4 0x180027890 0xEXTERNAL:000000da 0x180027520 0xEXTERNAL:0000017c 0x180027204 0x1800385e1 0xEXTERNAL:00000057 0x180027a84 0xEXTERNAL:00000151 0x1800279e8


undefined4 FUN_18000e850(int param_1,undefined8 param_2,undefined *param_3,ulonglong param_4)

{
byte bVar1;
int iVar2;
NTSTATUS NVar3;
BOOL BVar4;
DWORD DVar5;
undefined4 uVar6;
undefined8 uVar7;
longlong *plVar8;
undefined7 extraout_var;
ulonglong uVar9;
undefined8 *puVar10;

uVar6 = 1;
if (DAT_1800921d8 != 0) {
return 1;
}
RtlEnterCriticalSection(&DAT_180092cc8);
if (DAT_1800921d8 != 0) goto LAB_18000e8da;
DisableThreadLibraryCalls(DAT_1800921e0);
FUN_180016ab4();
if (param_1 == 0) {
NVar3 = BCryptOpenAlgorithmProvider((BCRYPT_ALG_HANDLE *)&DAT_180092a50,L"SHA1",(LPCWSTR)0x0,0);
if (((NVar3 == 0) &&
(NVar3 = BCryptOpenAlgorithmProvider
((BCRYPT_ALG_HANDLE *)&DAT_180092a48,L"MD5",(LPCWSTR)0x0,0), NVar3 == 0))
&& (NVar3 = BCryptOpenAlgorithmProvider
((BCRYPT_ALG_HANDLE *)&DAT_180092a40,L"DSA",(LPCWSTR)0x0,0), NVar3 == 0
)) {
puVar10 = &DAT_180092a38;
NVar3 = BCryptOpenAlgorithmProvider((BCRYPT_ALG_HANDLE *)&DAT_180092a38,L"RSA",(LPCWSTR)0x0,0)
;
if ((NVar3 == 0) && (iVar2 = FUN_1800237c0(puVar10), iVar2 == 0)) {
param_4 = 0x12;
param_3 = (undefined *)0x0;
BVar4 = CryptAcquireContextW(&DAT_180092a30,(LPCWSTR)0x0,(LPCWSTR)0x0,0x12,0xf0000000);
if (BVar4 == 0) {
DAT_180092a30 = 0;
DVar5 = GetLastError();
uVar9 = (ulonglong)DVar5;
puVar10 = DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
puVar10 = (undefined8 *)DAT_180091000[2];
param_3 = &DAT_180085358;
FUN_180041cdc(puVar10,10,&DAT_180085358,DVar5);
param_4 = uVar9;
}
FUN_180045064(puVar10,DVar5);
}
uVar7 = FUN_180023520();
if ((int)uVar7 != 0) {
FUN_180027520();
plVar8 = FUN_18002796c();
if (((plVar8 != (longlong *)0x0) && (iVar2 = FUN_180026774(plVar8), iVar2 == 0)) &&
(iVar2 = FUN_180026d60(), iVar2 == 0)) {
if (DAT_1800927e8 == (undefined8 *)0x0) {
DAT_1800927e8 = (undefined8 *)FUN_18000a1f4(0x60);
if (DAT_1800927e8 == (undefined8 *)0x0) goto LAB_18000eab2;
*DAT_1800927e8 = &PTR_FUN_18007d478;
}
uVar7 = FUN_180027890((longlong)DAT_1800927e8);
if ((char)uVar7 != '\0') {
FUN_1800276a4();
bVar1 = FUN_180027204();
if ((((int)CONCAT71(extraout_var,bVar1) == 0) && (DVar5 = FUN_1800279e8(), DVar5 == 0)
) && (DVar5 = FUN_180027a84(), DVar5 == 0)) {
I_CertWnfEnableFlushCache();
goto LAB_18000e8ba;
}
}
}
}
}
}
LAB_18000eab2:
uVar6 = 0;
}
else {
LAB_18000e8ba:
iVar2 = FUN_180016fd0();
if (iVar2 != 0) goto LAB_18000eab2;
FUN_180016de0();
DAT_1800921d8 = 1;
if (param_1 != 0) goto LAB_18000e8da;
if ((DAT_1800919b0 & 4) != 0) {
FUN_180045408((ushort *)&DAT_1800850f0,0,param_3,param_4);
}
uVar9 = FUN_180026e34();
if ((int)uVar9 == 0) {
DAT_1800927ac = 1;
QueryPerformanceFrequency((LARGE_INTEGER *)&DAT_180092ed8);
}
}
if (DAT_1800921d8 == 0) {
uVar6 = FUN_1800385e1();
return uVar6;
}
LAB_18000e8da:
RtlLeaveCriticalSection(&DAT_180092cc8);
return uVar6;
}
=========================================
Function at address: 0x18000eabc
Called functions addresses: 0xEXTERNAL:000000c0 0x18000eb08 0xEXTERNAL:000000c2


void FUN_18000eabc(undefined8 param_1,ushort *param_2)

{
RtlAcquireResourceShared(&DAT_180092428,1);
FUN_18000eb08(param_2,&DAT_1800925e8);
/* WARNING: Could not recover jumptable at 0x00018000eaf5. Too many branches */

RtlReleaseResource(&DAT_180092428);
return;
}
=========================================
Function at address: 0x18000eb08
Called functions addresses: 0x18002a77b


void FUN_18000eb08(ushort *param_1,ushort *param_2)

{
ushort uVar1;

*param_1 = 0;
param_1[0x11] = 0;
uVar1 = *param_2;
if (uVar1 < 0x11) {
*param_1 = uVar1;
param_1[0x11] = param_2[0x11];
memcpy(param_1 + 1,param_2 + 1,(ulonglong)uVar1 * 2);
}
return;
}
=========================================
Function at address: 0x18000eb48
Called functions addresses: 0x18002a24f 0x18000eb9c


void FUN_18000eb48(longlong param_1)

{
longlong lVar1;
uint local_res8 [8];

_time32((__time32_t *)local_res8);
lVar1 = (-(ulonglong)((*(uint *)(param_1 + 0x40) & 0xa2aa0) != 0) & 0xffffffffffffffe0) + 0x130;
*(uint *)(lVar1 + param_1) =
local_res8[0] >> 0x18 | (local_res8[0] & 0xff0000) >> 8 | (local_res8[0] & 0xff00) << 8 |
local_res8[0] << 0x18;
FUN_18000eb9c((PUCHAR)(param_1 + 4 + lVar1),0x1c);
return;
}
=========================================
Function at address: 0x18000eb9c
Called functions addresses: 0xEXTERNAL:000000c7 0xEXTERNAL:0000016f


undefined8 FUN_18000eb9c(PUCHAR param_1,ULONG param_2)

{
NTSTATUS NVar1;
undefined8 uVar2;

NVar1 = BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,param_1,param_2,2);
if (-1 < NVar1) {
return 0;
}
/* WARNING: Could not recover jumptable at 0x0001800385f0. Too many branches */

uVar2 = RtlNtStatusToDosError();
return uVar2;
}
=========================================
Function at address: 0x18000ebe0
Called functions addresses: 0x18006f874 0x180041cb0 0x18000ae3c


void thunk_FUN_18000ae3c(longlong *param_1,uint *param_2)

{
ushort *puVar1;
uint uVar2;
undefined8 uVar3;
ulonglong uVar4;
longlong *plVar5;
undefined auStackY_1d8 [32];
undefined8 in_stack_fffffffffffffe48;
uint auStack_198 [2];
longlong lStack_190;
uint auStack_188 [88];
ulonglong uStack_28;

uStack_28 = DAT_180091970 ^ (ulonglong)auStackY_1d8;
auStack_198[0] = 0;
auStack_198[1] = 0;
lStack_190 = 0;
if ((*(int *)((longlong)param_1 + 0x51c) == 0) ||
(plVar5 = param_1, *(int *)((longlong)param_1 + 0x44) == 4)) {
uVar2 = FUN_18000eb48((longlong)param_1);
plVar5 = (longlong *)(ulonglong)uVar2;
if (uVar2 == 0) goto LAB_18000ae88;
}
else {
LAB_18000ae88:
if ((*(uint *)(param_1 + 8) & 0x80800) != 0) {
puVar1 = (ushort *)((longlong)param_1 + 0x1da);
FUN_18000eabc(plVar5,puVar1);
uVar2 = *(uint *)(param_1[10] + 0xc4);
if (uVar2 != 0) {
uVar3 = FUN_180006f5c(puVar1,*(uint **)(param_1[10] + 200),uVar2);
if ((int)uVar3 != 0) goto LAB_18000af62;
if (*puVar1 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180086390);
}
goto LAB_18000af62;
}
}
*(undefined *)((longlong)param_1 + 0x39d) = 1;
}
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
uVar2 = 0xaa0;
}
else {
uVar2 = *(uint *)(param_1 + 8);
}
uVar3 = FUN_18000af8c((longlong)param_1,auStack_188,*(uint *)(param_1[10] + 0x98) & uVar2,
param_1 + 0x22,in_stack_fffffffffffffe48,param_1 + 0x72,
(undefined2 *)(param_1 + 0x73));
uVar2 = (uint)uVar3;
if (uVar2 == 0) {
uVar4 = FUN_180008a4c(param_1,(undefined *)auStack_188,auStack_198);
uVar2 = (uint)uVar4;
}
}
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
if ((uVar2 != 0) || (lStack_190 == 0)) goto LAB_18000af62;
if ((*(int *)((longlong)param_1 + 0x51c) == 0) || (*(int *)((longlong)param_1 + 0x44) == 4)) {
FUN_18006f874(param_1,auStack_198,param_2);
goto LAB_18000af62;
}
}
*(longlong *)(param_2 + 2) = lStack_190;
param_2[1] = auStack_198[1];
*param_2 = auStack_198[0];
LAB_18000af62:
FUN_180028070(uStack_28 ^ (ulonglong)auStackY_1d8);
return;
}
=========================================
Function at address: 0x18000ebec
Called functions addresses: 0x180011144 0xEXTERNAL:00000083


void FUN_18000ebec(longlong param_1,undefined4 param_2,undefined8 param_3,undefined8 param_4,
undefined8 param_5)

{
if ((param_1 != 0) && (DAT_1800927ac != '\0')) {
*(undefined4 *)(param_1 + 0xc) = param_2;
QueryPerformanceCounter((LARGE_INTEGER *)(param_1 + 0x50));
*(undefined4 *)(param_1 + 0x18) = 0;
*(undefined8 *)(param_1 + 0x78) = param_3;
*(undefined8 *)(param_1 + 0x88) = param_4;
*(bool *)(param_1 + 0x1c) = *(int *)(param_1 + 0xc) == 1;
*(undefined8 *)(param_1 + 0x90) = param_5;
FUN_180011144(param_1);
}
return;
}
=========================================
Function at address: 0x18000ec6c
Called functions addresses: 0x18000ec9c


void FUN_18000ec6c(undefined8 *param_1)

{
*param_1 = &PTR_FUN_18007d058;
FUN_18000ec9c((longlong)param_1);
*param_1 = &PTR_FUN_18007cfb8;
return;
}
=========================================
Function at address: 0x18000ec9c
Called functions addresses: 0xEXTERNAL:00000111 0xEXTERNAL:000000c5 0xEXTERNAL:0000011c


void FUN_18000ec9c(longlong param_1)

{
if (*(longlong *)(param_1 + 0x58) != 0) {
SslDecrementProviderReferenceCount();
}
if (*(longlong *)(param_1 + 0x28) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x28),0);
}
if (*(longlong *)(param_1 + 0x30) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x30),0);
}
if (*(longlong *)(param_1 + 0x108) != 0) {
NtClose();
}
if (*(longlong *)(param_1 + 0x1b0) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x1b0),0);
}
if (*(longlong *)(param_1 + 0x1b8) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x1b8),0);
}
if (*(longlong *)(param_1 + 0x1c0) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x1c0),0);
}
return;
}
=========================================
Function at address: 0x18000ed40
Called functions addresses: 0x18000ec6c


undefined8 * FUN_18000ed40(undefined8 *param_1)

{
FUN_18000ec6c(param_1);
return param_1;
}
=========================================
Function at address: 0x18000ed60
Called functions addresses: 0xEXTERNAL:00000040 0x18002a7c0 0x180041e9c


void FUN_18000ed60(undefined8 *param_1)

{
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x7e,&DAT_1800853e8,param_1);
}

/* WARNING: Could not recover jumptable at 0x00018000eda9. Too many branches */

LocalFree(param_1);
return;
}
=========================================
Function at address: 0x18000edbc
Called functions addresses: 0x18000d31c 0x18002a77b 0xEXTERNAL:00000110 0x180028d90 0x180028070


void FUN_18000edbc(longlong param_1,undefined4 *param_2)

{
int iVar1;
ulonglong uVar2;
longlong lVar3;
longlong lVar4;
undefined auStack_318 [32];
undefined4 *local_2f8;
undefined4 local_2f0;
undefined4 local_2e8;
undefined4 local_2e4;
undefined4 local_2e0;
short local_2dc [64];
short local_25c [64];
undefined4 local_1dc;
undefined4 local_1d8;
short local_1d4 [64];
undefined4 local_154;
short local_150 [64];
undefined4 local_d0;
undefined4 local_cc;
short local_c8 [72];
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStack_318;
memset(&local_2e8,0,0x2a4);
uVar2 = FUN_18000d31c(*(uint *)(param_1 + 0x18));
local_2f8 = &local_2e8;
local_2f0 = 0;
iVar1 = SslLookupCipherSuiteInfo
(*(undefined8 *)(param_1 + 0x58),uVar2 & 0xffff,*(undefined4 *)(param_1 + 0x38),
*(undefined4 *)(param_1 + 0x3c));
if (iVar1 == 0) {
param_2[1] = local_2e8;
param_2[2] = local_2e4;
param_2[3] = local_2e0;
*param_2 = 1;
lVar3 = -1;
do {
lVar4 = lVar3;
lVar3 = lVar4 + 1;
} while (local_2dc[lVar3] != 0);
memcpy(param_2 + 4,local_2dc,(ulonglong)((int)lVar4 + 2) * 2);
lVar3 = -1;
do {
lVar4 = lVar3;
lVar3 = lVar4 + 1;
} while (local_25c[lVar3] != 0);
memcpy(param_2 + 0x24,local_25c,(ulonglong)((int)lVar4 + 2) * 2);
param_2[0x44] = local_1dc;
param_2[0x45] = local_1d8;
lVar3 = -1;
do {
lVar4 = lVar3;
lVar3 = lVar4 + 1;
} while (local_1d4[lVar3] != 0);
memcpy(param_2 + 0x46,local_1d4,(ulonglong)((int)lVar4 + 2) * 2);
param_2[0x66] = local_154;
lVar3 = -1;
do {
lVar4 = lVar3;
lVar3 = lVar4 + 1;
} while (local_150[lVar3] != 0);
memcpy(param_2 + 0x67,local_150,(ulonglong)((int)lVar4 + 2) * 2);
param_2[0x87] = local_d0;
param_2[0x88] = local_cc;
lVar3 = -1;
do {
lVar4 = lVar3;
lVar3 = lVar4 + 1;
} while (local_c8[lVar3] != 0);
memcpy(param_2 + 0x89,local_c8,(ulonglong)((int)lVar4 + 2) * 2);
param_2[0xa9] = *(undefined4 *)(param_1 + 0x3c);
}
FUN_180028070(local_38 ^ (ulonglong)auStack_318);
return;
}
=========================================
Function at address: 0x18000efa0
Called functions addresses: 0x18000f120 0x18000f1fc 0x18000d31c 0xEXTERNAL:00000110 0x180028d90 0x180028070 0x18000f0cc


void FUN_18000efa0(longlong param_1,undefined4 *param_2)

{
int iVar1;
ulonglong uVar2;
ulonglong uVar3;
ulonglong uVar4;
undefined auStack_378 [32];
undefined *local_358;
undefined4 local_350;
undefined4 local_348;
undefined local_344 [268];
undefined4 local_238;
undefined4 local_1b0;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_378;
local_348 = 1;
memset(local_344,0,0x324);
uVar2 = FUN_18000d31c(*(uint *)(param_1 + 0x18));
local_350 = 0;
uVar4 = (ulonglong)*(uint *)(param_1 + 0x3c);
uVar3 = (ulonglong)*(uint *)(param_1 + 0x38);
uVar2 = uVar2 & 0xffff;
local_358 = local_344;
iVar1 = SslLookupCipherSuiteInfo(*(undefined8 *)(param_1 + 0x58));
if (iVar1 == 0) {
*param_2 = *(undefined4 *)(param_1 + 0x18);
iVar1 = FUN_18000f1fc((longlong)&local_348,uVar2,uVar3);
param_2[1] = iVar1;
if (iVar1 - 0x7000U < 0x10) {
param_2[1] = 0x7000;
}
param_2[2] = local_238;
iVar1 = FUN_18000f120((longlong)&local_348,uVar2,uVar3,uVar4);
param_2[3] = iVar1;
if (iVar1 - 0x9000U < 0x10) {
param_2[3] = 0x9000;
}
param_2[4] = local_1b0;
iVar1 = FUN_18000f0cc((longlong)&local_348,uVar2);
param_2[5] = iVar1;
if (iVar1 - 0xb000U < 5) {
param_2[5] = 0xb000;
}
param_2[6] = *(undefined4 *)(param_1 + 0x1c);
}
FUN_180028070(local_18 ^ (ulonglong)auStack_378);
return;
}
=========================================
Function at address: 0x18000f0cc
Called functions addresses: 0x180038668 0x1800151f0


undefined4 FUN_18000f0cc(longlong param_1,undefined8 param_2)

{
undefined4 uVar1;
undefined8 uVar2;
undefined4 local_res8 [8];

local_res8[0] = 0;
uVar2 = FUN_1800151f0(param_1 + 0x19c,param_2,local_res8);
if ((((int)uVar2 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar1 = FUN_180038668((longlong)DAT_180091000);
return uVar1;
}
return local_res8[0];
}
=========================================
Function at address: 0x18000f120
Called functions addresses: 0x180038686 0x180007eb0 0x180014d38


undefined4 FUN_18000f120(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
int iVar1;
undefined4 uVar2;
undefined8 *puVar3;
undefined8 uVar4;
undefined4 local_res8 [2];

local_res8[0] = 0;
puVar3 = (undefined8 *)FUN_180014d38(param_1 + 0x118);
if ((puVar3 != (undefined8 *)0x0) &&
(uVar4 = FUN_180007eb0(puVar3,(undefined8 *)0x0,(undefined4 *)0x0,param_4,local_res8,
(undefined4 *)0x0), (int)uVar4 == 0)) {
return local_res8[0];
}
iVar1 = *(int *)(param_1 + 8);
if ((iVar1 == 0xc02f) || ((iVar1 - 0x9cU < 0xd && ((0x1005U >> (iVar1 - 0x9cU & 0x1f) & 1) != 0)))
) {
LAB_18000f1ec:
uVar2 = 0x800c;
}
else {
if ((iVar1 != 0xc030) && (iVar1 != 0xc02c)) {
if (((iVar1 == 0xc02b) || (iVar1 == 0x1301)) || (iVar1 == 0x1303)) goto LAB_18000f1ec;
if (((0xc < iVar1 - 0x9dU) || ((0x1005U >> (iVar1 - 0x9dU & 0x1f) & 1) == 0)) &&
(iVar1 != 0x1302)) {
uVar2 = FUN_180038686();
return uVar2;
}
}
uVar2 = 0x800d;
}
return uVar2;
}
=========================================
Function at address: 0x18000f1fc
Called functions addresses: 0x18002a763 0x1800790c4 0x180041d70


undefined4 FUN_18000f1fc(longlong param_1,undefined8 param_2,undefined8 param_3)

{
wchar_t *_Str1;
int iVar1;
undefined8 uVar2;
wchar_t *pwVar3;
undefined4 uVar4;
undefined4 local_res8 [2];

_Str1 = (wchar_t *)(param_1 + 0x90);
iVar1 = wcscmp(_Str1,L"AES");
if (iVar1 == 0) {
if (*(int *)(param_1 + 0x110) == 0x100) {
uVar4 = 0x6610;
}
else {
uVar4 = 0x6611;
if (*(int *)(param_1 + 0x110) == 0x80) {
uVar4 = 0x660e;
}
}
}
else {
iVar1 = wcscmp(_Str1,L"DES");
if (iVar1 == 0) {
uVar4 = 0x6601;
}
else {
iVar1 = wcscmp(_Str1,L"RC4");
if (iVar1 == 0) {
uVar4 = 0x6801;
}
else {
iVar1 = wcscmp(_Str1,L"3DES");
if (iVar1 == 0) {
uVar4 = 0x6603;
}
else if (*_Str1 == L'\0') {
uVar4 = 0x6000;
}
else {
pwVar3 = L"CHACHA20_POLY1305";
local_res8[0] = 0;
iVar1 = wcscmp(_Str1,L"CHACHA20_POLY1305");
uVar4 = 0;
if ((((iVar1 != 0) &&
(uVar2 = FUN_1800790c4(_Str1,pwVar3,param_3,local_res8), uVar4 = local_res8[0],
(int)uVar2 != 0)) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041d70(DAT_180091000[2],0xd,&DAT_1800853f8,_Str1);
uVar4 = local_res8[0];
}
}
}
}
}
return uVar4;
}
=========================================
Function at address: 0x18000f2c0
Called functions addresses: 0xEXTERNAL:0000003f 0x18002a77b 0x18000909c 0x180041d20 0x18000f3f4


DWORD FUN_18000f2c0(longlong param_1,uint *param_2)

{
uint uVar1;
longlong lVar2;
undefined8 uVar3;
uint uVar4;
HLOCAL _Src;
DWORD DVar5;
HLOCAL pvVar6;
HLOCAL pvVar7;
uint local_res8 [2];
HLOCAL local_res10;

*param_2 = 0;
param_2[2] = 0;
param_2[3] = 0;
if ((*(byte *)(param_1 + 0x18) & 0xc) != 0) {
DVar5 = 0x80090302;
goto LAB_18000f3b0;
}
local_res8[0] = *(uint *)(param_1 + 0xf0);
local_res10 = *(HLOCAL *)(param_1 + 0xe8);
pvVar7 = (HLOCAL)0x0;
if ((local_res8[0] == 0) &&
(DVar5 = FUN_18000f3f4(param_1,&local_res10,local_res8), pvVar7 = local_res10, DVar5 != 0))
goto LAB_18000f3b0;
_Src = local_res10;
uVar4 = local_res8[0];
if ((local_res10 == (void *)0x0) || (local_res8[0] == 0)) {
LAB_18000f3a1:
DVar5 = 0;
}
else {
uVar1 = local_res8[0] + 0x35;
if (uVar1 < local_res8[0]) {
DVar5 = 0x80090304;
}
else {
pvVar6 = LocalAlloc(0x40,(ulonglong)uVar1);
*(HLOCAL *)(param_2 + 2) = pvVar6;
if (pvVar6 != (HLOCAL)0x0) {
*(uint *)((longlong)pvVar6 + 0x18) = uVar4 + 0x15;
*(undefined4 *)(*(longlong *)(param_2 + 2) + 0x1c) = 0x20;
uVar3 = s_tls_server_end_point__180082d20._8_8_;
lVar2 = *(longlong *)(param_2 + 2);
*(undefined8 *)(lVar2 + 0x20) = s_tls_server_end_point__180082d20._0_8_;
*(undefined8 *)(lVar2 + 0x28) = uVar3;
*(undefined4 *)(lVar2 + 0x30) = s_tls_server_end_point__180082d20._16_4_;
*(char *)(lVar2 + 0x34) = s_tls_server_end_point__180082d20[0x14];
memcpy((void *)(lVar2 + 0x35),_Src,(ulonglong)uVar4);
*param_2 = uVar1;
goto LAB_18000f3a1;
}
DVar5 = 0x80090300;
}
}
if (pvVar7 != (HLOCAL)0x0) {
FUN_18000909c(pvVar7);
}
LAB_18000f3b0:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (DVar5 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x67,&DAT_1800853e8,DVar5,(char)DVar5);
}
return DVar5;
}
=========================================
Function at address: 0x18000f3f4
Called functions addresses: 0xEXTERNAL:0000012b 0x18000f484 0x18000f5c0


DWORD FUN_18000f3f4(longlong param_1,undefined8 *param_2,uint *param_3)

{
DWORD DVar1;
PCCERT_CONTEXT local_res8;

*param_2 = 0;
*param_3 = 0;
local_res8 = (PCCERT_CONTEXT)0x0;
if (((*(uint *)(param_1 + 0x18) & 0x40051555) == 0) && (*(uint **)(param_1 + 0x98) != (uint *)0x0)
) {
DVar1 = FUN_18000f5c0(*(uint **)(param_1 + 0x98),*(DWORD *)(param_1 + 0xa0),&local_res8);
if (DVar1 == 0) {
DVar1 = FUN_18000f484((longlong)local_res8,param_2,param_3);
CertFreeCertificateContext(local_res8);
}
}
else {
DVar1 = 0;
}
return DVar1;
}
=========================================
Function at address: 0x18000f484
Called functions addresses: 0xEXTERNAL:00000144 0xEXTERNAL:00000041 0xEXTERNAL:0000014d 0x18000909c 0x18002a763 0x18000a1f4


DWORD FUN_18000f484(longlong param_1,undefined8 *param_2,uint *param_3)

{
int iVar1;
BOOL BVar2;
DWORD DVar3;
PCCRYPT_OID_INFO pCVar4;
BYTE *pbComputedHash;
wchar_t *_Str1;
DWORD local_res8 [2];

local_res8[0] = 0;
pCVar4 = CryptFindOIDInfo(1,*(void **)(*(longlong *)(param_1 + 0x18) + 0x18),0x40000004);
if (((pCVar4 != (PCCRYPT_OID_INFO)0x0) && ((pCVar4->u).dwValue == 0xffffffff)) &&
(_Str1 = *(wchar_t **)(pCVar4 + 1), _Str1 != (wchar_t *)0x0)) {
iVar1 = wcscmp(_Str1,L"SHA1");
if (iVar1 != 0) {
iVar1 = wcscmp(_Str1,L"MD5");
if (iVar1 != 0) goto LAB_18000f512;
}
}
_Str1 = L"SHA256";
LAB_18000f512:
BVar2 = CryptHashCertificate2
(_Str1,0,(void *)0x0,*(BYTE **)(param_1 + 8),*(DWORD *)(param_1 + 0x10),
(BYTE *)0x0,local_res8);
if (BVar2 == 0) {
DVar3 = GetLastError();
}
else {
pbComputedHash = (BYTE *)FUN_18000a1f4((ulonglong)local_res8[0]);
if (pbComputedHash == (BYTE *)0x0) {
DVar3 = 0x80090300;
}
else {
BVar2 = CryptHashCertificate2
(_Str1,0,(void *)0x0,*(BYTE **)(param_1 + 8),*(DWORD *)(param_1 + 0x10),
pbComputedHash,local_res8);
if (BVar2 == 0) {
DVar3 = GetLastError();
FUN_18000909c(pbComputedHash);
}
else {
*param_2 = pbComputedHash;
*param_3 = local_res8[0];
DVar3 = 0;
}
}
}
return DVar3;
}
=========================================
Function at address: 0x18000f5c0
Called functions addresses: 0xEXTERNAL:0000014f 0xEXTERNAL:0000012b 0xEXTERNAL:00000129 0xEXTERNAL:00000128 0xEXTERNAL:00000041


DWORD FUN_18000f5c0(uint *param_1,DWORD param_2,undefined8 *param_3)

{
uint cbCertEncoded;
bool bVar1;
BOOL BVar2;
HCERTSTORE hCertStore;
PCCERT_CONTEXT local_res18;

local_res18 = (PCCERT_CONTEXT)0x0;
if (param_3 == (undefined8 *)0x0) {
param_2 = 0x80090304;
}
else {
if ((PCCERT_CONTEXT)*param_3 != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext((PCCERT_CONTEXT)*param_3);
}
*param_3 = 0;
hCertStore = CertOpenStore((LPCSTR)0x2,0,0,4,(void *)0x0);
if (hCertStore == (HCERTSTORE)0x0) {
param_2 = GetLastError();
}
else {
bVar1 = true;
do {
if (param_2 < 4) {
LAB_180038805:
param_2 = 0x80090304;
break;
}
cbCertEncoded = *param_1;
if (param_2 - 4 < cbCertEncoded) goto LAB_180038805;
BVar2 = CertAddEncodedCertificateToStore
(hCertStore,1,(BYTE *)(param_1 + 1),cbCertEncoded,2,&local_res18);
if (BVar2 == 0) {
param_2 = GetLastError();
break;
}
param_1 = (uint *)((longlong)(param_1 + 1) + (ulonglong)cbCertEncoded);
param_2 = (param_2 - 4) - cbCertEncoded;
if (bVar1) {
bVar1 = false;
*param_3 = local_res18;
}
else {
CertFreeCertificateContext(local_res18);
}
local_res18 = (PCCERT_CONTEXT)0x0;
} while (param_2 != 0);
CertCloseStore(hCertStore,0);
if (param_2 != 0) {
if (local_res18 != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(local_res18);
}
if ((PCCERT_CONTEXT)*param_3 != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext((PCCERT_CONTEXT)*param_3);
*param_3 = 0;
}
}
}
}
return param_2;
}
=========================================
Function at address: 0x18000f6ec
Called functions addresses: 0x180041cb0 0x180028d90


undefined8 FUN_18000f6ec(longlong param_1,undefined8 *param_2)

{
undefined8 *puVar1;
undefined8 uVar2;
undefined8 *puVar3;
longlong lVar4;
undefined8 *puVar5;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x6c,&DAT_1800853e8);
}
puVar3 = *(undefined8 **)(param_1 + 0x188);
if (puVar3 == (undefined8 *)0x0) {
memset(param_2,0,0x108);
}
else {
lVar4 = 2;
do {
uVar2 = puVar3[1];
*param_2 = *puVar3;
param_2[1] = uVar2;
uVar2 = puVar3[3];
param_2[2] = puVar3[2];
param_2[3] = uVar2;
uVar2 = puVar3[5];
param_2[4] = puVar3[4];
param_2[5] = uVar2;
uVar2 = puVar3[7];
param_2[6] = puVar3[6];
param_2[7] = uVar2;
uVar2 = puVar3[9];
param_2[8] = puVar3[8];
param_2[9] = uVar2;
uVar2 = puVar3[0xb];
param_2[10] = puVar3[10];
param_2[0xb] = uVar2;
uVar2 = puVar3[0xd];
param_2[0xc] = puVar3[0xc];
param_2[0xd] = uVar2;
puVar5 = param_2 + 0x10;
puVar1 = puVar3 + 0xe;
uVar2 = puVar3[0xf];
puVar3 = puVar3 + 0x10;
param_2[0xe] = *puVar1;
param_2[0xf] = uVar2;
lVar4 = lVar4 + -1;
param_2 = puVar5;
} while (lVar4 != 0);
*puVar5 = *puVar3;
}
return 0;
}
=========================================
Function at address: 0x18000f7a4
Called functions addresses: 0x18000f9e6 0x180041cdc 0x180041cb0 0xEXTERNAL:00000113 0x1800509d0 0x18000a1f4


int FUN_18000f7a4(longlong param_1,ulonglong param_2,undefined8 param_3,byte param_4,uint *param_5)

{
uint uVar1;
HLOCAL pvVar2;
int iVar3;
undefined8 *puVar4;
undefined2 uVar5;
byte bVar6;
longlong lVar7;
int iVar8;
uint local_res8 [2];
ulonglong local_res10;
ulonglong local_res18;
uint local_res20 [2];
int local_58 [6];

iVar3 = 0;
bVar6 = param_4 & 8;
local_res10 = param_2 & 0xffffffff00000000;
local_res8[0] = 0;
param_5[2] = 0;
param_5[3] = 0;
local_res20[0] = 0;
local_58[0] = 0;
local_res18._1_7_ = (undefined7)((ulonglong)param_3 >> 8);
local_res18 = CONCAT71(local_res18._1_7_,param_4) & 0xffffffffffffff08;
if (*(int *)(param_1 + 0x38) != 0) {
iVar3 = 0;
if ((((param_4 & 1) == 0) || (iVar3 = 0, *(longlong *)(param_1 + 0x28) == 0)) ||
(iVar3 = SslExportKey(*(undefined8 *)(param_1 + 0x58),*(longlong *)(param_1 + 0x28),
L"OpaqueKeyBlob",0,0,&local_res10,0), iVar3 == 0)) {
if ((((param_4 & 2) == 0) || (*(longlong *)(param_1 + 0x30) == 0)) ||
(iVar3 = SslExportKey(*(undefined8 *)(param_1 + 0x58),*(longlong *)(param_1 + 0x30),
L"OpaqueKeyBlob",0,0,local_res8,0), iVar3 == 0)) {
if ((*(longlong *)(param_1 + 0x1b8) == 0) ||
(iVar3 = SslExportKey(*(undefined8 *)(param_1 + 0x58),*(longlong *)(param_1 + 0x1b8),
L"OpaqueKeyBlob",0,0,local_res20,0), iVar3 == 0)) {
if ((*(longlong *)(param_1 + 0x1c0) == 0) ||
(iVar3 = SslExportKey(*(undefined8 *)(param_1 + 0x58),*(longlong *)(param_1 + 0x1c0),
L"OpaqueKeyBlob",0,0,local_58,0), iVar3 == 0))
goto LAB_18000f872;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_1800388cd;
uVar5 = 0x82;
}
else {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_1800388cd;
uVar5 = 0x81;
}
}
else {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_1800388cd;
uVar5 = 0x80;
}
}
else {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_1800388cd;
uVar5 = 0x7f;
}
FUN_180041cdc(DAT_180091000[2],uVar5,&DAT_1800853e8,iVar3);
goto LAB_1800388cd;
}
LAB_18000f872:
iVar8 = local_58[0] + local_res20[0] + local_res8[0] + (int)local_res10;
uVar1 = iVar8 + 0x3d;
if (bVar6 == 0) {
puVar4 = (undefined8 *)FUN_1800509d0((ulonglong)uVar1);
}
else {
puVar4 = (undefined8 *)FUN_18000a1f4((ulonglong)uVar1);
}
if (puVar4 == (undefined8 *)0x0) {
return -0x7ff6fd00;
}
*(undefined8 **)(param_5 + 2) = puVar4;
*param_5 = uVar1;
param_5[1] = 1;
*puVar4 = *(undefined8 *)(param_1 + 0x60);
puVar4[1] = *(undefined8 *)(param_1 + 0x68);
*(undefined4 *)(puVar4 + 2) = *(undefined4 *)(param_1 + 0x74);
*(undefined8 *)((longlong)puVar4 + 0x14) = *(undefined8 *)(param_1 + 0x78);
*(undefined8 *)((longlong)puVar4 + 0x1c) = *(undefined8 *)(param_1 + 0x80);
*(undefined2 *)((longlong)puVar4 + 0x24) = *(undefined2 *)(param_1 + 0x88);
*(undefined2 *)((longlong)puVar4 + 0x26) = *(undefined2 *)(param_1 + 0x8a);
*(undefined4 *)(puVar4 + 5) = *(undefined4 *)(param_1 + 0x90);
*(undefined *)((longlong)puVar4 + 0x2c) = *(undefined *)(param_1 + 0x1c8);
*(int *)((longlong)puVar4 + 0x2d) = (int)local_res10;
*(uint *)((longlong)puVar4 + 0x31) = local_res8[0];
*(uint *)((longlong)puVar4 + 0x35) = local_res20[0];
*(int *)((longlong)puVar4 + 0x39) = local_58[0];
if (*(int *)(param_1 + 0x38) == 0) {
LAB_18000f9ce:
if (iVar3 == 0) {
return 0;
}
}
else if ((((param_4 & 1) == 0) || (*(longlong *)(param_1 + 0x28) == 0)) ||
(iVar3 = SslExportKey(*(undefined8 *)(param_1 + 0x58),*(longlong *)(param_1 + 0x28),
L"OpaqueKeyBlob",(longlong)puVar4 + 0x3d,(int)local_res10,
&local_res10,0), iVar3 == 0)) {
iVar8 = iVar8 - (int)local_res10;
lVar7 = (longlong)puVar4 + 0x3d + (local_res10 & 0xffffffff);
if ((((param_4 & 2) == 0) || (*(longlong *)(param_1 + 0x30) == 0)) ||
(iVar3 = SslExportKey(*(undefined8 *)(param_1 + 0x58),*(longlong *)(param_1 + 0x30),
L"OpaqueKeyBlob",lVar7,local_res8[0],local_res8,0), iVar3 == 0)) {
iVar8 = iVar8 - local_res8[0];
lVar7 = lVar7 + (ulonglong)local_res8[0];
if ((*(longlong *)(param_1 + 0x1b8) == 0) ||
(iVar3 = SslExportKey(*(undefined8 *)(param_1 + 0x58),*(longlong *)(param_1 + 0x1b8),
L"OpaqueKeyBlob",lVar7,local_res20[0],local_res20,0), iVar3 == 0)) {
iVar8 = iVar8 - local_res20[0];
if ((*(longlong *)(param_1 + 0x1c0) == 0) ||
(iVar3 = SslExportKey(*(undefined8 *)(param_1 + 0x58),*(longlong *)(param_1 + 0x1c0),
L"OpaqueKeyBlob",lVar7 + (ulonglong)local_res20[0],local_58[0],
local_58,0), iVar3 == 0)) {
if (iVar8 != local_58[0]) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x87,&DAT_1800853e8);
}
iVar3 = FUN_18000f9e6();
return iVar3;
}
goto LAB_18000f9ce;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar5 = 0x86;
goto LAB_180038a3f;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar5 = 0x85;
goto LAB_180038a3f;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar5 = 0x84;
goto LAB_180038a3f;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar5 = 0x83;
LAB_180038a3f:
FUN_180041cdc(DAT_180091000[2],uVar5,&DAT_1800853e8,iVar3);
iVar3 = FUN_18000f9e6();
return iVar3;
}
bVar6 = (byte)local_res18;
LAB_1800388cd:
pvVar2 = *(HLOCAL *)(param_5 + 2);
if (pvVar2 != (HLOCAL)0x0) {
if (bVar6 == 0) {
FUN_180050980(pvVar2);
}
else {
FUN_18000909c(pvVar2);
}
param_5[2] = 0;
param_5[3] = 0;
}
param_5[0] = 0;
param_5[1] = 0;
return iVar3;
}
=========================================
Function at address: 0x18000f9e6
Called functions addresses: 0x180050980 0x18000909c


undefined4 FUN_18000f9e6(void)

{
HLOCAL pvVar1;
undefined4 unaff_EBX;
longlong unaff_RBP;
undefined8 unaff_R13;
undefined8 *unaff_R15;

pvVar1 = (HLOCAL)unaff_R15[1];
if (pvVar1 != (HLOCAL)0x0) {
if (*(char *)(unaff_RBP + 0x58) == '\0') {
FUN_180050980(pvVar1);
}
else {
FUN_18000909c(pvVar1);
}
unaff_R15[1] = unaff_R13;
}
*unaff_R15 = 0;
return unaff_EBX;
}
=========================================
Function at address: 0x18000f9f8
Called functions addresses: 0x180041cdc 0x180041cb0 0xEXTERNAL:00000041 0xEXTERNAL:0000013b 0x18000f5c0


DWORD FUN_18000f9f8(longlong param_1,undefined8 *param_2)

{
PCCERT_CONTEXT pCertContext;
DWORD DVar1;
BOOL BVar2;
PCCERT_CONTEXT local_res8;
int local_18 [2];
longlong local_10;

local_res8 = (PCCERT_CONTEXT)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180085468);
}
if (*(uint **)(param_1 + 0x98) == (uint *)0x0) {
DVar1 = 0x8009030e;
}
else {
DVar1 = FUN_18000f5c0(*(uint **)(param_1 + 0x98),*(DWORD *)(param_1 + 0xa0),&local_res8);
pCertContext = local_res8;
if (DVar1 == 0) {
local_10 = *(longlong *)(param_1 + 200);
if (local_10 != 0) {
local_18[0] = *(int *)(param_1 + 0xd0);
BVar2 = CertSetCertificateContextProperty(local_res8,0x46,0,local_18);
if (((BVar2 == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
DVar1 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_180085468,DVar1);
}
}
local_10 = *(longlong *)(param_1 + 0xd8);
if ((local_10 != 0) && (local_18[0] = *(int *)(param_1 + 0xe0), local_18[0] != 0)) {
BVar2 = CertSetCertificateContextProperty(pCertContext,0x77,0,local_18);
if ((BVar2 == 0) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)))) {
DVar1 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0xe,&DAT_180085468,DVar1);
}
}
*param_2 = pCertContext;
DVar1 = 0;
}
}
return DVar1;
}
=========================================
Function at address: 0x18000fb04
Called functions addresses: 0x180056428 0x18001011c 0x180010610 0x18005004c 0xEXTERNAL:00000152 0x180044c38 0xEXTERNAL:000000c8 0x180009ae4 0x18002a7c0 0x18000fec0 0x18000fff4 0x180041cdc 0x18005e8a8 0x180045408 0xEXTERNAL:00000129 0x18000fdd4 0x180041cb0 0x18000eb9c 0xEXTERNAL:000000b5 0xEXTERNAL:00000041 0xEXTERNAL:0000013f 0x18000a1f4 0x18005e6d0


uint FUN_18000fb04(longlong param_1,uint param_2,undefined8 *param_3,longlong param_4,uint *param_5,
longlong param_6)

{
longlong *plVar1;
uint uVar2;
longlong *plVar3;
code *pcVar4;
uint uVar5;
char cVar6;
int iVar7;
uint uVar8;
BOOL BVar9;
DWORD DVar10;
undefined8 uVar11;
longlong lVar12;
undefined8 *puVar13;
undefined8 *puVar14;
HCERTSTORE pvVar15;
uint uVar16;
undefined *puVar17;
undefined *puVar18;
undefined auStackY_d8 [8];
undefined auStackY_d0 [24];
uint *in_stack_ffffffffffffff58;
char local_88 [4];
uint local_84;
DWORD local_80 [2];
undefined local_78 [16];
undefined local_68 [16];
undefined4 local_58 [2];
byte local_50;

puVar18 = auStackY_d8;
local_80[0] = 0;
RtlInitializeResource(param_1 + 0x30);
*(undefined4 *)(param_1 + 0x90) = 1;

if (cVar6 != '\0') {
*(undefined4 *)(param_1 + 0xd4) = local_58[0];
*(byte *)(param_1 + 0xac) = local_50 & 1;
*(bool *)(param_1 + 0xad) = (local_50 & 0x11) == 0;
}
FUN_180010610((short *)(param_1 + 0xd8),0x104,param_6);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18005004c(DAT_180091000[2],0x15,&DAT_180082b38,param_1,(char)param_2);
}
uVar8 = *(uint *)(param_1 + 0xd4);
if ((DAT_1800919b0 & 4) != 0) {
uVar11 = DAT_180092df8;
if ((param_2 & 0x40051555) != 0) {
uVar11 = DAT_180092df0;
}
RtlInitUnicodeString(local_78,uVar11);
RtlInitUnicodeString(local_68,param_1 + 0xd8);
in_stack_ffffffffffffff58 = param_5;
FUN_180045408((ushort *)&DAT_1800850e0,0x180084e30,(ulonglong)uVar8,local_68);
}
iVar7 = FUN_180009ae4(*(longlong *)(param_5 + 0x1a),param_5[0x18],0,'\0',
(longlong *)(param_1 + 200),(uint *)(param_1 + 0xc4));
if (iVar7 == 0) {
uVar8 = FUN_18001011c(param_1,*param_5,param_5[0x12],param_5[0x16],param_2);
puVar17 = auStackY_d8;
if (uVar8 == 0) {
*(undefined8 *)(param_1 + 0x2e4) = *param_3;
*(longlong *)(param_1 + 0x2f0) = param_4;
if ((((param_2 & 0x800a2aaa) == 0) || (DAT_180092648 == 0)) ||
(uVar8 = FUN_180056428(param_1,param_4), puVar17 = auStackY_d8, uVar8 == 0)) {
uVar11 = FUN_18000eb9c((PUCHAR)(param_1 + 0x2f8),8);
puVar17 = auStackY_d8;
uVar8 = (uint)uVar11;
if ((uint)uVar11 == 0) {
local_84 = 0;
if (param_5[1] != 0) {
do {
puVar13 = (undefined8 *)FUN_18000a1f4(0x498);
puVar14 = (undefined8 *)0x0;
if (puVar13 != (undefined8 *)0x0) {
puVar14 = FUN_18005e6d0(puVar13,(param_2 & 0x40051555) != 0,
*(undefined *)(param_1 + 0xad),
*(undefined *)(param_1 + 0xac));
}
uVar8 = local_84;
if (puVar14 == (undefined8 *)0x0) {
LAB_180038f15:
puVar17 = puVar18;
uVar8 = 0xe;
goto LAB_180038cfb;
}
plVar1 = puVar14 + 1;
plVar3 = *(longlong **)(param_1 + 0x28);
if (*plVar3 != param_1 + 0x20) {
pcVar4 = (code *)swi(0x29);
(*pcVar4)(3);
puVar18 = auStackY_d0;
goto LAB_180038f15;
}
*plVar1 = param_1 + 0x20;
puVar14[2] = plVar3;
*plVar3 = (longlong)plVar1;
*(longlong **)(param_1 + 0x28) = plVar1;
*(int *)(param_1 + 0x1c) = *(int *)(param_1 + 0x1c) + 1;
uVar2 = param_5[0x16];
uVar16 = uVar2 >> 0x10 & 1;
uVar5 = uVar16 | 4;
if ((uVar2 & 0x20000) == 0) {
uVar5 = uVar16;
}
uVar16 = uVar5 | 8;
if ((uVar2 & 0x40000) == 0) {
uVar16 = uVar5;
}
if (DAT_1800927a4 == 0) {
if (((uVar2 & 0x180000) == 0x80000) && (DAT_1800927a8 == 0)) {
local_88[0] = '\0';
local_80[0] = 1;
BVar9 = CertGetCertificateContextProperty
(*(PCCERT_CONTEXT *)
((ulonglong)local_84 * 0x38 + *(longlong *)(param_5 + 2)),0x79
,local_88,local_80);
if ((BVar9 == 0) || (local_88[0] == '\0')) {
uVar16 = uVar16 | 0x10;
}
}
}
else {
uVar16 = uVar16 | 0x10;
}
in_stack_ffffffffffffff58 =
(uint *)CONCAT71((int7)((ulonglong)in_stack_ffffffffffffff58 >> 8),1);
uVar8 = FUN_18005e8a8((ulonglong)puVar14,*(undefined4 *)(param_1 + 0xd4),
param_1 + 0xd8,param_4,
(uint *)((ulonglong)uVar8 * 0x38 + *(longlong *)(param_5 + 2)),
uVar16,in_stack_ffffffffffffff58,
(uint)(*(longlong *)(param_5 + 6) != 0),
*(uint **)(param_1 + 200),*(uint *)(param_1 + 0xc4));
local_80[0] = (uint)*(byte *)((longlong)puVar14 + 0x4c);
puVar17 = auStackY_d8;
if (uVar8 != 0) goto LAB_180038cfb;
if (*(int *)((longlong)puVar14 + 0x8c) != 0) {
*(undefined *)(param_1 + 900) = 1;
}
local_84 = local_84 + 1;
} while (local_84 < param_5[1]);
}
FUN_18000fff4(param_1,param_5[0x16]);
if (((param_2 & 0x40051555) == 0) || ((*(uint *)(param_1 + 0x9c) & 0x4000) == 0)) {
if ((*(uint *)(param_1 + 0x9c) & 0x2000) == 0) {
uVar8 = param_5[0x13];
}
else {
param_5[0x13] = 0xffffffff;
uVar8 = 0xffffffff;
}
uVar11 = FUN_18000fec0(param_1,uVar8,param_5[0x14]);
uVar8 = (uint)uVar11;
puVar17 = auStackY_d8;
if (uVar8 == 0) {
cVar6 = FUN_18000fdd4(param_1,*(char *)(param_1 + 0xac),*(uint **)(param_5 + 0x10),
param_5[0xe],(undefined8 *)(param_1 + 0xb8),
(uint *)(param_1 + 0xb0),(uint *)(param_1 + 0xc0));
if (cVar6 != '\0') {
if (param_5[0x15] == 0) {
if ((*(uint *)(param_1 + 0x98) & 0x800a2aaa) == 0) {
uVar8 = *(uint *)(DAT_1800927f0 + 0x18);
}
else {
uVar8 = *(uint *)(DAT_1800927f0 + 0x14);
}
}
else {
uVar8 = 0;
if (param_5[0x15] != 0xffffffff) {
uVar8 = param_5[0x15];
}
}
*(uint *)(param_1 + 0xd0) = uVar8;
if (((param_2 & 0x40051555) != 0) &&
(*(HCERTSTORE *)(param_5 + 4) != (HCERTSTORE)0x0)) {
pvVar15 = CertDuplicateStore(*(HCERTSTORE *)(param_5 + 4));
*(HCERTSTORE *)(param_1 + 0x300) = pvVar15;
if ((pvVar15 == (HCERTSTORE)0x0) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)))) {
DVar10 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x17,&DAT_180082b38,DVar10);
}
}
lVar12 = *(longlong *)(param_5 + 6);
if (lVar12 == 0) {
lVar12 = *(longlong *)(param_1 + 800);
}
else {
*(longlong *)(param_1 + 800) = lVar12;
}
if ((lVar12 != 0) && (*(HCERTSTORE *)(param_5 + 8) != (HCERTSTORE)0x0)) {
CertCloseStore(*(HCERTSTORE *)(param_5 + 8),0);
}
if (*(longlong *)(param_5 + 10) != 0) {
*(longlong *)(param_1 + 0x328) = *(longlong *)(param_5 + 10);
if (*(longlong *)(param_5 + 0xc) != 0) {
*(longlong *)(param_1 + 0x330) = *(longlong *)(param_5 + 0xc);
}
}
return 0;
}
puVar17 = auStackY_d8;
uVar8 = 0x80090331;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180082b38);
}
puVar17 = auStackY_d8;
uVar8 = 0x57;
}
}
}
}
}
else {
puVar17 = auStackY_d8;
uVar8 = 0x57;
if (iVar7 == -0x7ff6fd00) {
puVar17 = auStackY_d8;
uVar8 = 0xe;
}
}
LAB_180038cfb:
if (*(int *)(puVar17 + 0x58) == 0) {
uVar2 = *(uint *)(param_1 + 0xd4);
*(undefined8 *)(puVar17 + -8) = 0x180038d21;
FUN_180044c38(uVar2,param_1 + 0xd8,(param_2 & 0x40051555) != 0);
}
*(undefined8 *)(param_1 + 0x2f0) = 0;
return uVar8;
}
=========================================
Function at address: 0x18000fdd4
Called functions addresses: 0x180059c68 0x180041cdc 0x180059d04 0x180059d38 0x18000909c 0x180059cd0 0x1800084b0 0x18000a1f4 0x180059d68


char FUN_18000fdd4(longlong param_1,char param_2,uint *param_3,uint param_4,undefined8 *param_5,
uint *param_6,uint *param_7)

{
char cVar1;
int *piVar2;
uint *puVar3;
undefined4 *puVar4;
ulonglong uVar5;
uint uVar6;
uint uVar7;
undefined2 uVar8;
uint uVar9;
uint uVar10;
ulonglong uVar11;
ulonglong uVar12;
uint *local_res8;

uVar9 = 0;
piVar2 = (int *)0x0;
if (param_1 == 0) {
LAB_18000feb3:
cVar1 = '\0';
}
else {
uVar12 = 0;
uVar10 = 0;
if (param_3 == (uint *)0x0) {
uVar7 = *(uint *)(param_1 + 0xc4);
if (uVar7 == 0) {
return '\x01';
}
}
else {
piVar2 = (int *)FUN_18000a1f4(0x44);
if (piVar2 == (int *)0x0) goto LAB_18000feb3;
uVar11 = 0;
local_res8 = param_3;
if (param_4 != 0) {
do {
uVar10 = *local_res8;
uVar7 = 0;
puVar3 = &DAT_180085640;
do {
if (uVar10 == *puVar3) goto LAB_1800390da;
uVar7 = uVar7 + 1;
puVar3 = puVar3 + 1;
} while (uVar7 < 0x11);
if (uVar7 == 0x11) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return '\0';
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return '\0';
}
uVar10 = param_3[uVar11];
uVar8 = 0xb;
goto LAB_180039228;
}
LAB_1800390da:
uVar7 = uVar10 & 0xe000;
if (uVar7 == 0x2000) {
puVar3 = FUN_180059d68(uVar10);
if ((puVar3 == (uint *)0x0) || ((*puVar3 & *(uint *)(param_1 + 0x98)) == 0))
goto LAB_180039240;
uVar9 = uVar9 | 1;
}
else if (uVar7 == 0x6000) {
puVar3 = FUN_180059cd0(uVar10);
if ((((puVar3 == (uint *)0x0) || (puVar3[8] != uVar10)) ||
(puVar3[10] < *(uint *)(param_1 + 0xa4))) ||
((*(uint *)(param_1 + 0xa8) < puVar3[10] ||
((*puVar3 & *(uint *)(param_1 + 0x98)) == 0)))) goto LAB_180039240;
uVar9 = uVar9 | 8;
}
else if (uVar7 == 0x8000) {
puVar3 = (uint *)FUN_180059d04(uVar10);
if ((puVar3 == (uint *)0x0) || ((*puVar3 & *(uint *)(param_1 + 0x98)) == 0))
goto LAB_180039240;
uVar9 = uVar9 | 2;
}
else {
if (((uVar7 != 0xa000) || (puVar4 = FUN_180059d38(uVar10), puVar4 == (undefined4 *)0x0))
|| ((puVar4[1] & *(uint *)(param_1 + 0x98)) == 0)) {
LAB_180039240:
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return '\0';
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return '\0';
}
uVar8 = 0xc;
LAB_180039228:
FUN_180041cdc(DAT_180091000[2],uVar8,&DAT_180085688,uVar10);
return '\0';
}
uVar9 = uVar9 | 4;
}
uVar5 = FUN_180059c68(piVar2,(uint)uVar12,uVar10);
if ((char)uVar5 == '\0') {
piVar2[uVar12] = uVar10;
uVar12 = (ulonglong)((uint)uVar12 + 1);
}
uVar10 = (int)uVar11 + 1;
uVar11 = (ulonglong)uVar10;
local_res8 = local_res8 + 1;
} while (uVar10 < param_4);
}
*param_5 = piVar2;
uVar10 = (uint)uVar12;
*param_6 = uVar10;
*param_7 = uVar9;
uVar7 = *(uint *)(param_1 + 0xc4);
}
uVar6 = *(uint *)(param_1 + 0x9c) & 0x800;
cVar1 = FUN_1800084b0((ulonglong)uVar6,piVar2,uVar10,uVar9,*(uint *)(param_1 + 0x9c) >> 0xc & 1,
uVar6,*(uint *)(param_1 + 0xa8),*(uint *)(param_1 + 0xa4),
*(uint *)(param_1 + 0x98),param_2,*(uint **)(param_1 + 200),uVar7);
if ((cVar1 == '\0') && (piVar2 == (int *)0x0)) {
FUN_18000909c((HLOCAL)0x0);
}
}
return cVar1;
}
=========================================
Function at address: 0x18000fec0
Called functions addresses: 0x18000ff48


undefined8 FUN_18000fec0(longlong param_1,uint param_2,uint param_3)

{
uint *puVar1;
uint *puVar2;

puVar1 = (uint *)(param_1 + 0xa8);
puVar2 = (uint *)(param_1 + 0xa4);
FUN_18000ff48(param_1,*(char *)(param_1 + 0xac),puVar2,puVar1);
if (param_2 == 0) {
param_2 = *puVar2;
if (param_2 < 0x28) {
param_2 = 0x28;
}
}
else if (param_2 == 0xffffffff) {
param_2 = 0;
}
else if (*puVar1 < param_2) {
return 0x80090331;
}
*puVar2 = param_2;
if (param_3 != 0) {
if (param_3 == 0xffffffff) {
*puVar1 = 0;
}
else {
if (param_3 < param_2) {
return 0x80090331;
}
*puVar1 = param_3;
}
}
if (*puVar1 < param_2) {
return 0x80090331;
}
return 0;
}
=========================================
Function at address: 0x18000ff48
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000c2


void FUN_18000ff48(undefined8 param_1,char param_2,uint *param_3,uint *param_4)

{
uint uVar1;
uint uVar2;
longlong *plVar3;
uint *puVar4;
uint uVar5;

*param_3 = 0;
*param_4 = 0;
RtlAcquireResourceShared(&DAT_180092428);
plVar3 = DAT_1800925b0;
if (param_2 != '\0') {
plVar3 = DAT_1800925b8;
}
if (plVar3 != (longlong *)0x0) {
uVar1 = *(uint *)(plVar3 + 1);
uVar5 = 0;
if (uVar1 != 0) {
puVar4 = (uint *)(*plVar3 + 0x14);
do {
if (uVar5 == 0) {
uVar2 = *puVar4;
}
else {
uVar2 = *param_3;
if (*puVar4 <= *param_3) {
uVar2 = *puVar4;
}
}
*param_3 = uVar2;
uVar2 = *param_4;
if (*param_4 <= *puVar4) {
uVar2 = *puVar4;
}
uVar5 = uVar5 + 1;
puVar4 = puVar4 + 0xd8;
*param_4 = uVar2;
} while (uVar5 < uVar1);
}
}
/* WARNING: Could not recover jumptable at 0x00018000ffde. Too many branches */

RtlReleaseResource(&DAT_180092428);
return;
}
=========================================
Function at address: 0x18000fff4
Called functions addresses: None


void FUN_18000fff4(longlong param_1,uint param_2)

{
uint uVar1;

if ((param_2 & 2) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 1;
}
if ((param_2 & 4) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 2;
}
if ((param_2 & 8) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 4;
}
if ((param_2 >> 0x1a & 1) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 0x4000;
}
if ((param_2 & 0x10) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 8;
}
if ((param_2 & 0x20) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) & 0xfffffffb;
}
if ((param_2 & 0x40) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) & 0xfffffff7;
}
if ((char)param_2 < '\0') {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 0x20;
}
if ((param_2 >> 0x12 & 1) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 0x80;
}
if ((param_2 >> 0x13 & 1) != 0) {
uVar1 = *(uint *)(param_1 + 0x9c);
*(uint *)(param_1 + 0x9c) = uVar1 | 0x100;
if ((param_2 >> 0x14 & 1) == 0) {
*(uint *)(param_1 + 0x9c) = uVar1 | 0x300;
}
}
if ((param_2 >> 0x15 & 1) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 0x400;
}
if ((param_2 >> 0x16 & 1) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 0x800;
}
if ((param_2 >> 0x17 & 1) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 0x1000;
}
if ((param_2 >> 0x19 & 1) != 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 0x2000;
}
if ((param_2 >> 0xf & 1) != 0) {
*(uint *)(param_1 + 0xa0) = *(uint *)(param_1 + 0xa0) | 0x2000;
}
if ((param_2 >> 8 & 1) != 0) {
*(uint *)(param_1 + 0xa0) = *(uint *)(param_1 + 0xa0) | 0x100;
}
if ((param_2 & 0x200) != 0) {
*(uint *)(param_1 + 0xa0) = *(uint *)(param_1 + 0xa0) | 0x200;
}
if ((param_2 & 0x400) != 0) {
*(uint *)(param_1 + 0xa0) = *(uint *)(param_1 + 0xa0) | 0x400;
}
if ((param_2 & 0x800) != 0) {
*(uint *)(param_1 + 0xa0) = *(uint *)(param_1 + 0xa0) | 0x800;
}
if ((param_2 & 0x1000) != 0) {
*(uint *)(param_1 + 0xa0) = *(uint *)(param_1 + 0xa0) | 0x1000;
}
if ((param_2 >> 0xe & 1) == 0) {
return;
}
*(uint *)(param_1 + 0xa0) = *(uint *)(param_1 + 0xa0) | 0x4000;
return;
}
=========================================
Function at address: 0x18001011c
Called functions addresses: 0x180041cdc 0x18002a530


uint FUN_18001011c(longlong param_1,uint param_2,uint param_3,uint param_4,uint param_5)

{
int *piVar1;
undefined8 *puVar2;
int *piVar3;
uint uVar4;

uVar4 = DAT_1800919f8;
if (DAT_180092f18 != 0) {
uVar4 = DAT_1800919f8 & 0xbfffffcf;
}
*(uint *)(param_1 + 0x98) = uVar4;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_180082b38,uVar4);
}
puVar2 = DAT_180091000;
uVar4 = FUN_18002a530(DAT_180091000,*(char *)(param_1 + 0xac));
if (((undefined8 **)puVar2 != &DAT_180091000) && ((*(byte *)((longlong)puVar2 + 0x1c) & 4) != 0))
{
FUN_180041cdc(puVar2[2],0xc,&DAT_180082b38,uVar4);
}
uVar4 = *(uint *)(param_1 + 0x98) & uVar4;
if ((param_4 & 0x1000000) != 0) {
uVar4 = uVar4 & 0xf0000;
}
if (param_3 == 0) {
piVar3 = *(int **)(param_1 + 200);
uVar4 = ~DAT_1800919fc & uVar4;
*(uint *)(param_1 + 0x98) = uVar4;
piVar1 = piVar3 + (ulonglong)*(uint *)(param_1 + 0xc4) * 10;
if (piVar3 < piVar1) {
do {
if (((*piVar3 == 0) && (piVar3[4] != 0)) && ((*(byte *)(piVar3 + 8) & 1) == 0)) {
*(uint *)(param_1 + 0x98) = *(uint *)(param_1 + 0x98) & ~piVar3[4];
}
piVar3 = piVar3 + 10;
} while (piVar3 < piVar1);
uVar4 = *(uint *)(param_1 + 0x98);
}
}
else {
uVar4 = uVar4 & param_3;
}
if (param_2 < 5) {
uVar4 = uVar4 & 0xffffcfff;
}
else if ((param_4 & 0x1000000) == 0) {
uVar4 = uVar4 & 0x3ff0;
}
if ((uVar4 & 0x3000) != 0) {
uVar4 = uVar4 & 0xffffffcf;
}
uVar4 = (-(uint)((param_5 & 0x40051555) != 0) & 0xbffaeaab) + 0x800a2aaa & uVar4;
*(uint *)(param_1 + 0x98) = uVar4;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_180082b38,uVar4);
uVar4 = *(uint *)(param_1 + 0x98);
}
return ~-(uint)(uVar4 != 0) & 0x80090331;
}
=========================================
Function at address: 0x1800102dc
Called functions addresses: 0x180041cdc 0x180004658 0x180008310 0x180013bc8 0x180028d90 0x18005c0f0 0x180028070 0xEXTERNAL:00000139 0x18001050c


void FUN_1800102dc(uint *param_1,uint param_2,PCCERT_CONTEXT param_3,longlong *param_4,int *param_5,
longlong param_6,char param_7)

{
int iVar1;
DWORD DVar2;
DWORD DVar3;
ulonglong uVar4;
undefined8 uVar5;
PCCERT_CONTEXT pCVar6;
undefined2 uVar7;
PCERT_INFO p_Var8;
wchar_t *pwVar9;
undefined auStackY_3f8 [32];
undefined4 in_stack_fffffffffffffc28;
bool local_398;
uint local_394;
uint local_390;
wchar_t *local_388;
undefined4 *local_380;
undefined4 local_378 [2];
undefined *local_370;
uint *local_368;
wchar_t local_358 [64];
wchar_t local_2d8 [64];
undefined local_258 [512];
ulonglong local_58;

local_58 = DAT_180091970 ^ (ulonglong)auStackY_3f8;
local_394 = 0;
local_388 = (wchar_t *)0x0;
local_398 = false;
local_390 = param_2;
local_368 = param_1;
memset(local_2d8,0,0x80);
memset(local_358,0,0x80);
memset(local_258,0,0x1fe);
local_378[0] = 0x1fe0000;
local_370 = local_258;
local_380 = (undefined4 *)0x0;
if (((((param_1 == (uint *)0x0) || (param_2 == 0)) || (param_3 == (PCCERT_CONTEXT)0x0)) ||
((param_6 == 0 || (param_4 == (longlong *)0x0)))) ||
((*param_4 == 0 || (p_Var8 = param_3->pCertInfo, p_Var8 == (PCERT_INFO)0x0))))
goto LAB_1800104a7;
if (((param_5 != (int *)0x0) && (*param_5 == 1)) && (param_5[1] == 2)) {
uVar5 = FUN_18005c0f0((byte *)((longlong)param_5 + 9),(uint)*(byte *)(param_5 + 2),'\x01',
(longlong)local_378);
DVar3 = (DWORD)uVar5;
if (DVar3 == 0) {
p_Var8 = param_3->pCertInfo;
local_380 = local_378;
goto LAB_1800103d9;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_1800104a7;
uVar7 = 0x10;
goto LAB_1800393e0;
}
LAB_1800103d9:
DVar2 = CertGetPublicKeyLength(1,&p_Var8->SubjectPublicKeyInfo);
iVar1 = *(int *)(*param_4 + 4);
if ((DVar2 == 0) || (iVar1 == 0)) goto LAB_1800104a7;
pwVar9 = (wchar_t *)0x0;
if (iVar1 == 0x2203) {
pCVar6 = param_3;
DVar3 = FUN_180013bc8((longlong)param_3,&local_394);
if (DVar3 == 0) {
uVar4 = FUN_180004658(pCVar6,local_394,(longlong *)&local_388);
DVar3 = (DWORD)uVar4;
pwVar9 = local_388;
if (DVar3 == 0) goto LAB_180010414;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_1800104a7;
uVar7 = 0x12;
}
else {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_1800104a7;
uVar7 = 0x11;
}
}
else {
LAB_180010414:
local_394 = 0x40;
DVar3 = FUN_18001050c(param_3,local_358,&local_394,local_2d8,in_stack_fffffffffffffc28);
if (DVar3 == 0) {
if ((param_7 == '\0') && (iVar1 == 0xa400)) {
local_398 = *(int *)(param_6 + 0x20) == 0xa400;
}
FUN_180008310(local_368,local_390,iVar1,DVar2,pwVar9,local_398,'\0',local_2d8,local_358,
(longlong)local_380,'\x01');
goto LAB_1800104a7;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_1800104a7;
uVar7 = 0x13;
}
LAB_1800393e0:
FUN_180041cdc(DAT_180091000[2],uVar7,&DAT_180082b78,DVar3);
LAB_1800104a7:
FUN_180028070(local_58 ^ (ulonglong)auStackY_3f8);
return;
}
=========================================
Function at address: 0x18001050c
Called functions addresses: 0x180010610 0xEXTERNAL:00000152 0xEXTERNAL:00000041


DWORD FUN_18001050c(PCCERT_CONTEXT param_1,short *param_2,uint *param_3,short *param_4,uint param_5)

{
BOOL BVar1;
DWORD DVar2;
short *psVar3;
uint uVar4;
uint uVar5;

uVar5 = 0;
if ((((param_1 == (PCCERT_CONTEXT)0x0) || (param_2 == (short *)0x0)) || (param_3 == (uint *)0x0))
|| (0xffffffff < (ulonglong)*param_3 * 2)) {
DVar2 = 0x57;
}
else {
param_5 = *param_3 * 2;
BVar1 = CertGetCertificateContextProperty(param_1,0x59,param_2,&param_5);
if (BVar1 == 0) {
*param_3 = param_5 >> 1;
DVar2 = GetLastError();
}
else {
uVar4 = param_5 >> 1;
param_2[uVar4 - 1] = 0;
psVar3 = param_2;
if (uVar4 != 0) {
do {
if (*psVar3 == 0x2f) {
*param_3 = uVar5;
param_2[uVar5] = 0;
goto LAB_1800105c3;
}
uVar5 = uVar5 + 1;
psVar3 = psVar3 + 1;
} while (uVar5 < uVar4);
}
if (uVar5 != uVar4) {
LAB_1800105c3:
uVar5 = uVar5 + 1;
if ((uVar5 != uVar4) &&
(((param_4 == (short *)0x0 || (0x3f < uVar4 - uVar5)) ||
(uVar5 = FUN_180010610(param_4,0x40,(longlong)(param_2 + uVar5)), uVar5 == 0)))) {
return 0;
}
}
DVar2 = 0x54f;
}
}
return DVar2;
}
=========================================
Function at address: 0x180010610
Called functions addresses: None


uint FUN_180010610(short *param_1,longlong param_2,longlong param_3)

{
short sVar1;
uint uVar2;
short *psVar3;
longlong lVar4;
longlong lVar5;

if (param_2 - 1U < 0x7fffffff) {
lVar4 = 0x7ffffffe - param_2;
lVar5 = param_3 - (longlong)param_1;
do {
if ((lVar4 + param_2 == 0) || (sVar1 = *(short *)(lVar5 + (longlong)param_1), sVar1 == 0))
break;
*param_1 = sVar1;
param_1 = param_1 + 1;
param_2 = param_2 + -1;
} while (param_2 != 0);
psVar3 = param_1 + -1;
if (param_2 != 0) {
psVar3 = param_1;
}
*psVar3 = 0;
uVar2 = ~-(uint)(param_2 != 0) & 0x8007007a;
}
else {
uVar2 = 0x80070057;
if (param_2 != 0) {
*param_1 = 0;
return 0x80070057;
}
}
return uVar2;
}
=========================================
Function at address: 0x180010674
Called functions addresses: 0x180058ac4 0x180041cdc 0xEXTERNAL:000000e0 0x18000fb04 0x180058b94 0xEXTERNAL:000000da 0x180041cb0 0x180010780 0x18002a7c0 0x1800432ec 0x18000a1f4 0x180058e94


uint FUN_180010674(longlong param_1,undefined8 *param_2,undefined4 *param_3,undefined8 *param_4,
longlong param_5,uint *param_6,longlong param_7)

{
longlong *plVar1;
longlong *plVar2;
code *pcVar3;
uint uVar4;
undefined8 *puVar5;
longlong lVar6;
uint uVar7;
undefined4 *puVar8;

if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
puVar8 = param_3;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
puVar8 = (undefined4 *)&DAT_180085628;
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180085628);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar8 = (undefined4 *)&DAT_180085628;
FUN_1800432ec(DAT_180091000[2],0x10,&DAT_180085628,*param_6);
}
}
FUN_180058ac4(*(undefined8 **)(param_6 + 2),param_6[1],puVar8);
uVar4 = param_6[0xe];
puVar5 = DAT_180091000;
if ((uVar4 != 0) && (*(longlong *)(param_6 + 0x10) != 0)) {
uVar7 = 0;
lVar6 = 0;
do {
if (((undefined8 **)puVar5 != &DAT_180091000) &&
((*(byte *)((longlong)puVar5 + 0x1c) & 4) != 0)) {
FUN_180058e94(puVar5[2],0x11,puVar8,uVar7,
(char)*(undefined4 *)(lVar6 + *(longlong *)(param_6 + 0x10)));
puVar5 = DAT_180091000;
}
uVar7 = uVar7 + 1;
lVar6 = lVar6 + 4;
} while (uVar7 < uVar4);
}
if (((undefined8 **)puVar5 != &DAT_180091000) && ((*(byte *)((longlong)puVar5 + 0x1c) & 4) != 0)
) {
puVar8 = (undefined4 *)&DAT_180085628;
FUN_180041cdc(puVar5[2],0x12,&DAT_180085628,param_6[0x12]);
puVar5 = DAT_180091000;
}
if (((param_6[0x13] != 0) && ((undefined8 **)puVar5 != &DAT_180091000)) &&
((*(byte *)((longlong)puVar5 + 0x1c) & 4) != 0)) {
puVar8 = (undefined4 *)&DAT_180085628;
FUN_1800432ec(puVar5[2],0x13,&DAT_180085628,param_6[0x13]);
puVar5 = DAT_180091000;
}
if (((param_6[0x14] != 0) && ((undefined8 **)puVar5 != &DAT_180091000)) &&
((*(byte *)((longlong)puVar5 + 0x1c) & 4) != 0)) {
puVar8 = (undefined4 *)&DAT_180085628;
FUN_1800432ec(puVar5[2],0x14,&DAT_180085628,param_6[0x14]);
}
FUN_180058b94(*(longlong *)(param_6 + 0x1a),(ulonglong)param_6[0x18],(ulonglong)puVar8);
if (((param_6[0x15] != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x15,&DAT_180085628,param_6[0x15]);
}
if (((param_6[0x16] != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x16,&DAT_180085628,param_6[0x16]);
}
if (((param_6[0x17] != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x17,&DAT_180085628,param_6[0x17]);
}
}
puVar5 = (undefined8 *)FUN_18000a1f4(0x388);
if ((puVar5 != (undefined8 *)0x0) && (puVar5 = FUN_180010780(puVar5), puVar5 != (undefined8 *)0x0)
) {
uVar4 = FUN_18000fb04((longlong)puVar5,(uint)param_3,param_4,param_5,param_6,param_7);
if (uVar4 != 0) {

return uVar4;
}
RtlEnterCriticalSection(param_1 + 8);
plVar2 = *(longlong **)(param_1 + 0x38);
plVar1 = puVar5 + 1;
if (*plVar2 == param_1 + 0x30) {
*plVar1 = param_1 + 0x30;
puVar5[2] = plVar2;
*plVar2 = (longlong)plVar1;
*(longlong **)(param_1 + 0x38) = plVar1;
RtlLeaveCriticalSection(param_1 + 8);
LOCK();
*(int *)(puVar5 + 3) = *(int *)(puVar5 + 3) + 1;
UNLOCK();
*param_2 = puVar5;
return 0;
}
pcVar3 = (code *)swi(0x29);
(*pcVar3)(3);
}
return 0xe;
}
=========================================
Function at address: 0x180010780
Called functions addresses: 0x180028d90


undefined8 * FUN_180010780(undefined8 *param_1)

{
undefined8 *puVar1;

*param_1 = &PTR_FUN_18007d0d8;
*(undefined4 *)(param_1 + 0x12) = 0;
*(undefined8 *)((longlong)param_1 + 0x9c) = 0;
*(undefined2 *)((longlong)param_1 + 0xac) = 0;
*(undefined4 *)(param_1 + 0x16) = 0;
param_1[0x17] = 0;
param_1[0x18] = 0;
param_1[0x19] = 0;
*(undefined8 *)((longlong)param_1 + 0xd4) = 0;
memset((void *)((longlong)param_1 + 0xdc),0,0x204);
puVar1 = param_1 + 4;
param_1[0x5e] = 0;
param_1[5] = puVar1;
*puVar1 = puVar1;
param_1[0x60] = 0;
param_1[0x61] = 0;
param_1[0x62] = 0;
param_1[99] = 0;
param_1[0x66] = 0;
param_1[0x67] = 0;
param_1[0x68] = 0;
param_1[0x69] = 0;
param_1[0x6a] = 0;
param_1[0x6c] = 0;
param_1[0x6d] = 0;
param_1[0x6e] = 0;
param_1[0x6f] = 0;
*(undefined4 *)(param_1 + 0x70) = 0;
*(undefined *)((longlong)param_1 + 900) = 0;
return param_1;
}
=========================================
Function at address: 0x180010874
Called functions addresses: 0x180043258 0xEXTERNAL:000000c7 0x180010674 0x180010cb0 0x18002a7c0 0x180042918 0x180028070 0x1800432ec 0x180041d20 0x18001118c 0x180041d70 0x180042648 0x180010d8c 0x180041e9c 0x1800139f0 0x180041cdc 0x180039a2e 0x18000e850 0x180042800 0x180028d90 0xEXTERNAL:000000c6 0x180043028 0x180010cf8 0x18000c3a8


void FUN_180010874(ushort *param_1,uint param_2,int *param_3,int *param_4,longlong *param_5,
undefined8 *param_6)

{
bool bVar1;
char cVar2;
int iVar3;
uint uVar4;
uint extraout_EAX;
uint extraout_EAX_00;
undefined uVar5;
int *piVar6;
undefined8 uVar7;
int *piVar8;
longlong *plVar9;
undefined uVar10;
undefined8 uVar11;
uint *puVar12;
longlong *plVar13;
undefined uVar14;
undefined *puVar15;
undefined uVar16;
wchar_t *pwVar17;
longlong lVar18;
uint uVar19;
undefined auStackY_3b8 [32];
ulonglong in_stack_fffffffffffffc70;
undefined in_stack_fffffffffffffc78;
undefined in_stack_fffffffffffffc80;
char cVar20;
int iVar21;
undefined4 uVar22;
undefined8 local_360;
longlong *local_358;
longlong lVar23;
undefined8 local_348;
longlong *plStack_340;
longlong *local_338;
uint local_330;
uint local_32c;
undefined8 local_328;
undefined8 local_320;
DWORD local_318 [2];
uint local_310;
undefined8 local_300;
char local_2f0;
int local_2ec;
longlong local_2e8;
uint local_2d8 [18];
uint local_290;
wchar_t local_268 [264];
ulonglong local_58;

local_58 = DAT_180091970 ^ (ulonglong)auStackY_3b8;
uVar11 = 0;
local_360 = param_5;
puVar15 = (undefined *)0x70;
local_338 = (longlong *)0x0;
piVar8 = param_4;
local_32c = param_2;
memset(local_2d8,0,0x70);
lVar23 = 0;
iVar21 = 0;
local_348 = 0;
plStack_340 = (longlong *)0x0;
local_320 = 0;
cVar20 = '\0';
bVar1 = false;
iVar3 = FUN_18000e850(0,uVar11,puVar15,(ulonglong)piVar8);
if ((iVar3 == 0) ||

goto LAB_180010c60;
uVar14 = 8;
memset(local_268,0,0x208);
iVar3 = FUN_180010d8c(local_268,local_318);
uVar16 = (undefined)iVar3;
if (iVar3 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar14 = 0xe0;
FUN_180041d20(DAT_180091000[2],0x32,&DAT_180084ce0,iVar3,(char)local_318[0]);
}
}
else if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
uVar14 = 0xe0;
uVar16 = (char)local_318[0];
FUN_180041cdc(DAT_180091000[2],0x33,&DAT_180084ce0,local_318[0]);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
pwVar17 = local_268;
uVar14 = 0xe0;
FUN_180041d70(DAT_180091000[2],0x34,&DAT_180084ce0,pwVar17);
uVar16 = SUB81(pwVar17,0);
}
}
uVar19 = local_310 & 0x40;
if ((local_310 & 0x11) == 0) {
bVar1 = true;
uVar16 = SUB81(&local_348,0);
uVar14 = 0;

plVar13 = local_360;
if (-1 < iVar3) {
if (iVar21 != 4) goto LAB_1800109eb;
local_338 = (longlong *)*plStack_340;
local_358 = plStack_340 + 1;
local_360 = (longlong *)CONCAT44(1,(int)local_348 + -8);
*plVar13 = (longlong)local_338;
if (local_338 == (longlong *)0x0) {
uVar19 = 0x80090304;
}
else if ((int)local_348 == 8) {
uVar19 = 0x8009030d;
}
else {
uVar11 = FUN_180043028((longlong)local_338,(uint *)&local_360,uVar19 != 0);
FUN_180010cb0((longlong)local_338,param_6);
uVar19 = FUN_18000c3a8((uint)uVar11);
}
goto LAB_180010c28;
}
LAB_1800396d9:
uVar19 = 0x80090304;
plVar13 = local_360;
}
else {
LAB_1800109eb:

if (iVar3 < 0) goto LAB_1800396d9;
if ((param_3 == (int *)0x0) || ((*param_3 == 0 && (param_3[1] == 0)))) {
if (local_2e8 - 1U < 0xfffffffffffffffe) {
uVar16 = SUB81(&stack0xfffffffffffffcb0,0);
uVar5 = 0xff;
in_stack_fffffffffffffc78 = 2;
uVar14 = 0xff;
in_stack_fffffffffffffc70 = in_stack_fffffffffffffc70 & 0xffffffff00000000;
local_328 = local_300;
iVar3 = NtDuplicateObject();
uVar10 = (undefined)local_2e8;
if (-1 < iVar3) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar11 = 0x36;
lVar18 = lVar23;
goto LAB_1800397cd;
}
goto LAB_180010a92;
}
}
else {
iVar3 = -0x3fffff66;
}
LAB_180039af1:
uVar4 = RtlNtStatusToDosError(iVar3);
LAB_180039afd:
uVar19 = FUN_18000c3a8(uVar4);
plVar13 = local_360;
}
else {
if (local_2f0 == '\0') {
iVar3 = -0x3fffff9f;
goto LAB_180039af1;
}
local_328 = *(undefined8 *)param_3;
uVar10 = SUB81(&stack0xfffffffffffffcb0,0);

uVar5 = SUB81(param_3,0);
if (iVar3 < 0) goto LAB_180039af1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar11 = 0x35;
lVar18 = lVar23;
LAB_1800397cd:
uVar14 = 0xe0;
uVar7 = DAT_180091000[2];
lVar23 = lVar18;
FUN_180041e9c(uVar7,(short)uVar11,&DAT_180084ce0,lVar18);
uVar10 = (undefined)uVar11;
uVar5 = (undefined)uVar7;
uVar16 = (undefined)lVar18;
}
LAB_180010a92:
if (local_2ec < 2) {
uVar19 = 0x8009030e;
plVar13 = local_360;
goto LAB_180010c28;
}
local_2d8[0] = 4;
if (param_4 != (int *)0x0) {
uVar22 = (undefined4)((ulonglong)param_4 >> 0x20);
if ((local_310 & 1) == 0) {

if (-1 < (int)uVar4) {
if (2 < local_330) {
if (local_330 < 6) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x38,&DAT_180084ce0,local_330);
}
puVar12 = local_2d8;
uVar10 = (undefined)local_330;
piVar8 = (int *)&local_348;
if (uVar19 == 0) {
uVar4 = FUN_18001118c(param_4,local_330,piVar8,(int *)puVar12);
uVar5 = SUB81(param_4,0);
uVar16 = SUB81(puVar12,0);
uVar14 = SUB81(piVar8,0);
param_4 = (int *)CONCAT44(uVar22,uVar4);
uVar4 = extraout_EAX;
}
else {
piVar6 = param_4;
uVar4 = FUN_1800139f0(param_4,local_330,(undefined8 *)piVar8,(int *)puVar12);
uVar5 = SUB81(piVar6,0);
uVar16 = SUB81(puVar12,0);
uVar14 = SUB81(piVar8,0);
}
if (uVar4 != 0x90312) goto joined_r0x00018003982e;
if (!bVar1) goto LAB_180010b45;
if (DAT_180092620 == 0) {
uVar19 = 0x80090304;
plVar13 = local_360;
goto LAB_180010c28;
}
uVar22 = 10;
if (uVar19 == 0) {
local_348 = CONCAT44(local_348._4_4_,8);

if (plStack_340 == (longlong *)0x0) goto LAB_180039921;
*plStack_340 = (longlong)param_4;
}
else {
local_348 = CONCAT44(local_348._4_4_,4);

if (plStack_340 == (longlong *)0x0) {
LAB_180039921:
uVar19 = 0x80090300;
plVar13 = local_360;
goto LAB_180010c28;
}
*(int *)plStack_340 = (int)param_4;
}
local_348 = CONCAT44(1,(int)local_348);

if ((int)uVar19 < 0) {
uVar19 = FUN_18000c3a8(uVar19);
plVar13 = local_360;
}
else {
uVar19 = 0x80090301;
plVar13 = local_360;
}
goto LAB_180010c28;
}
uVar16 = 0;
if (local_330 == 0x200) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar16 = 0;
FUN_1800432ec(DAT_180091000[2],0x37,&DAT_180084ce0,0x200);
}
puVar12 = local_2d8;
piVar8 = param_4;
lVar18 = lVar23;
uVar4 = FUN_180042918(param_4,(longlong)puVar12,lVar23);
uVar10 = SUB81(puVar12,0);
uVar5 = SUB81(piVar8,0);
uVar14 = (undefined)lVar23;
lVar23 = lVar18;
if (uVar4 != 0) goto LAB_180039afd;
goto LAB_180010b45;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x39,&DAT_180084ce0,local_330);
}
uVar19 = 0x8009030d;
plVar13 = local_360;
goto LAB_180010c28;
}
}
else {
iVar3 = *param_4 + -4;
uVar5 = (undefined)iVar3;
if (iVar3 == 0) {
puVar12 = local_2d8;
lVar18 = lVar23;
iVar3 = FUN_180042648(param_4,param_1,lVar23,puVar12);
uVar10 = SUB81(param_1,0);
uVar5 = SUB81(param_4,0);
uVar16 = SUB81(puVar12,0);
uVar14 = (undefined)lVar23;
param_4 = (int *)CONCAT44(uVar22,iVar3);
uVar4 = extraout_EAX_00;
lVar23 = lVar18;
}
else {
if (iVar3 != 1) goto LAB_180010b45;
puVar12 = local_2d8;
piVar8 = param_4;
lVar18 = lVar23;
uVar4 = FUN_180042800((longlong)param_4,param_1,lVar23,puVar12);
uVar10 = SUB81(param_1,0);
uVar5 = SUB81(piVar8,0);
uVar16 = SUB81(puVar12,0);
uVar14 = (undefined)lVar23;
lVar23 = lVar18;
}
joined_r0x00018003982e:
if (-1 < (int)uVar4) goto LAB_180010b45;
}
goto LAB_180039afd;
}
LAB_180010b45:
if (((local_290 & 0xf0000) != 0) && ((local_290 & 0xfff0ffff) != 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180043258(DAT_180091000[2],0x3a,&DAT_180084ce0,0x80090331,0x31);
}
goto LAB_180010c60;
}
if ((param_4 == (int *)0x0) && ((local_32c & 0x40051555) != 0)) {
FUN_180039a2e(uVar5,uVar10,uVar14,uVar16,in_stack_fffffffffffffc70,in_stack_fffffffffffffc78
,in_stack_fffffffffffffc80,cVar20,(char)param_6,(char)iVar21,lVar23);
return;
}
uVar19 = FUN_180010674(DAT_1800927e8,&local_338,(undefined4 *)(ulonglong)local_32c,&local_328,
lVar23,local_2d8,(longlong)local_268);
FUN_180010cf8((undefined *)local_2d8,'\0');
plVar13 = local_360;
if (uVar19 == 0) {
FUN_180010cb0((longlong)local_338,param_6);
plVar13 = local_360;
*local_360 = (longlong)local_338;
if (!bVar1) goto LAB_180010c1d;
if (DAT_180092620 != 0) {

(&stack0xfffffffffffffc98,&local_320,0,&local_348);
if ((-1 < (int)uVar19) && (iVar21 == 4)) {
*plStack_340 = *plVar13;

if (-1 < (int)uVar19) {
uVar19 = 0x80090301;
cVar20 = '\x01';
goto LAB_180010c28;
}
}
goto LAB_180010c1d;
}
uVar19 = 0x80090304;
}
else {
LAB_180010c1d:
uVar19 = FUN_18000c3a8(uVar19);
}
}
}
LAB_180010c28:
if ((lVar23 == 0) || (cVar20 != '\0')) {
if (uVar19 != 0) goto LAB_180039b52;
}
else if (uVar19 != 0) {
NtClose();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x3c,&DAT_180084ce0,lVar23);
}
LAB_180039b52:
if (uVar19 != 0x80090301) {
plVar9 = (longlong *)0x0;
if (!bVar1) {
plVar9 = plStack_340;
}
FUN_180011434((longlong)plVar9);
if (local_338 != (longlong *)0x0) {
FUN_180003d4c(DAT_1800927e8,local_338);
}
if (plVar13 != (longlong *)0x0) {
*plVar13 = 0;
}
if (param_6 != (undefined8 *)0x0) {
*param_6 = 0;
}
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (uVar19 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x3d,&DAT_180084ce0,uVar19,(char)uVar19);
}
LAB_180010c60:
FUN_180028070(local_58 ^ (ulonglong)auStackY_3b8);
return;
}
=========================================
Function at address: 0x180010cb0
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000c2


void FUN_180010cb0(longlong param_1,undefined8 *param_2)

{
longlong *plVar1;
undefined8 *puVar2;

if ((param_2 != (undefined8 *)0x0) &&
(*param_2 = 0x7fffff36d5969fff, *(int *)(param_1 + 0x1c) != 0)) {
RtlAcquireResourceShared(param_1 + 0x30,1);
puVar2 = *(undefined8 **)(param_1 + 0x20);
do {
if (puVar2 == (undefined8 *)(param_1 + 0x20)) goto LAB_180039bfd;
plVar1 = puVar2 + 3;
puVar2 = (undefined8 *)*puVar2;
} while (*plVar1 == 0);
*param_2 = *(undefined8 *)(*(longlong *)(*plVar1 + 0x18) + 0x48);
LAB_180039bfd:
RtlReleaseResource(param_1 + 0x30);
}
return;
}
=========================================
Function at address: 0x180010cf8
Called functions addresses: 0xEXTERNAL:0000012b 0xEXTERNAL:00000129 0x180008fb8 0x18000909c 0xEXTERNAL:00000126


void FUN_180010cf8(undefined *param_1,char param_2)

{
longlong lVar1;
uint uVar2;
undefined8 *puVar4;
undefined *puVar5;
ulonglong uVar3;

uVar3 = 0;
if (*(longlong *)(param_1 + 8) != 0) {
if (*(int *)(param_1 + 4) != 0) {
do {
puVar4 = (undefined8 *)(uVar3 * 0x38 + *(longlong *)(param_1 + 8));
if ((PCCERT_CONTEXT)*puVar4 != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext((PCCERT_CONTEXT)*puVar4);
}
puVar5 = (undefined *)puVar4[1];
if (puVar5 != (undefined *)0x0) {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (*(short *)(puVar5 + lVar1 * 2) != 0);
for (lVar1 = lVar1 * 2; lVar1 != 0; lVar1 = lVar1 + -1) {
*puVar5 = 0;
puVar5 = puVar5 + 1;
}
FUN_18000909c((HLOCAL)puVar4[1]);
}
*puVar4 = 0;
puVar4[1] = 0;
uVar2 = (int)uVar3 + 1;
uVar3 = (ulonglong)uVar2;
puVar4[2] = 0;
puVar4[3] = 0;
puVar4[4] = 0;
puVar4[5] = 0;
puVar4[6] = 0;
} while (uVar2 < *(uint *)(param_1 + 4));
}
FUN_18000909c(*(HLOCAL *)(param_1 + 8));
*(undefined8 *)(param_1 + 8) = 0;
}
if (*(HCERTSTORE *)(param_1 + 0x10) != (HCERTSTORE)0x0) {
CertCloseStore(*(HCERTSTORE *)(param_1 + 0x10),0);
*(undefined8 *)(param_1 + 0x10) = 0;
}
if (*(HLOCAL *)(param_1 + 0x40) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x40));
*(undefined8 *)(param_1 + 0x40) = 0;
}
if (*(HLOCAL *)(param_1 + 0x68) != (HLOCAL)0x0) {
FUN_180008fb8(*(HLOCAL *)(param_1 + 0x68),*(uint *)(param_1 + 0x60));
*(undefined8 *)(param_1 + 0x68) = 0;
*(undefined4 *)(param_1 + 0x60) = 0;
}
if (param_2 != '\0') {
if (*(longlong *)(param_1 + 0x18) != 0) {
CryptObjectLocatorFree();
}
if (*(HCERTSTORE *)(param_1 + 0x20) != (HCERTSTORE)0x0) {
CertCloseStore(*(HCERTSTORE *)(param_1 + 0x20),0);
}
if (*(longlong *)(param_1 + 0x28) != 0) {
CryptObjectLocatorFree();
}
if (*(HCERTSTORE *)(param_1 + 0x30) != (HCERTSTORE)0x0) {
CertCloseStore(*(HCERTSTORE *)(param_1 + 0x30),0);
}
}
for (lVar1 = 0x70; lVar1 != 0; lVar1 = lVar1 + -1) {
*param_1 = 0;
param_1 = param_1 + 1;
}
return;
}
=========================================
Function at address: 0x180010d8c
Called functions addresses: 0x180010610 0xEXTERNAL:00000040 0xEXTERNAL:00000095 0xEXTERNAL:00000062 0x180028d84 0x180028070 0x180041d70 0xEXTERNAL:00000080 0x180041cdc 0x180041cb0 0xEXTERNAL:0000009d 0xEXTERNAL:00000041 0x180028d3c 0x180028d90 0x180013988 0x180028d48


void FUN_180010d8c(wchar_t *param_1,DWORD *param_2)

{
int *piVar1;
longlong lVar2;
BOOL BVar3;
uint uVar4;
int iVar5;
DWORD DVar6;
HANDLE hProcess;
int *hMem;
undefined2 uVar7;
longlong lVar8;
wchar_t *pwVar9;
undefined auStack_708 [32];
wchar_t *local_6e8;
wchar_t *local_6e0;
undefined8 local_6d8;
undefined8 local_6d0;
undefined8 local_6c8;
DWORD local_6b8 [2];
DWORD local_6b0;
ulonglong local_6ac;
undefined4 uStack_6a4;
undefined4 uStack_6a0;
undefined4 uStack_69c;
DWORD local_698 [2];
int *local_690;
int local_688;
int iStack_684;
int iStack_680;
int iStack_67c;
wchar_t local_668 [256];
wchar_t local_468 [264];
WCHAR local_258 [264];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStack_708;
if ((param_2 == (DWORD *)0x0) || (param_1 == (wchar_t *)0x0)) goto LAB_180010f20;
DVar6 = *param_2;
if ((param_2[2] & 0x2000) == 0) {
if (DVar6 != 0) {
hProcess = OpenProcess(0x1000,0,DVar6);
if (hProcess == (HANDLE)0x0) {
DVar6 = GetLastError();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_1800854a0,DVar6);
}
goto LAB_180010f20;
}
memset(local_258,0,0x208);
local_6b8[0] = 0x104;
BVar3 = QueryFullProcessImageNameW(hProcess,0,local_258,local_6b8);
if (BVar3 == 0) {
DVar6 = GetLastError();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_1800854a0,DVar6);
}
}
else {
memset(local_668,0,0x200);
local_6c8 = 0;
local_6e0 = local_668;
local_6d0 = 0;
local_6d8 = 0x100;
local_6e8 = (wchar_t *)0x0;
uVar4 = _o__wsplitpath_s(local_258,0,0,0);
if (uVar4 == 0) {
memset(local_468,0,0x208);
iVar5 = _o__wcsnicmp(local_668,L"svchost",7);
lVar8 = -1;
if (iVar5 == 0) {
uStack_69c = 0;
uStack_6a4 = 0;
uStack_6a0 = 0;
local_6ac = (ulonglong)*(uint *)((longlong)Self + 0x1720);
local_6b0 = DVar6;
iVar5 = I_QueryTagInformation(0,1,&local_6b0);
if (iVar5 == 0) {
if (CONCAT44(uStack_69c,uStack_6a0) != 0) {
_o_wcsncpy_s(local_468,0x104,CONCAT44(uStack_69c,uStack_6a0),0xffffffffffffffff);
hMem = (int *)CONCAT44(uStack_69c,uStack_6a0);
LAB_180011001:
LocalFree(hMem);
}
}
else {
local_690 = (int *)0x0;
local_698[0] = DVar6;
iVar5 = I_QueryTagInformation(0,3,local_698);
hMem = local_690;
if (iVar5 == 0) {
if (local_690 != (int *)0x0) {
if (*local_690 == 1) {
piVar1 = *(int **)(local_690 + 2);
local_688 = *piVar1;
iStack_684 = piVar1[1];
iStack_680 = piVar1[2];
iStack_67c = piVar1[3];
lVar2 = *(longlong *)(piVar1 + 2);
if ((local_688 == 1) && (lVar2 != 0)) {
_o_wcsncpy_s(local_468,0x104,lVar2,0xffffffffffffffff);
}
}
goto LAB_180011001;
}
}
else if (((iVar5 < 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_1800854a0,iVar5);
}
}
}
do {
lVar8 = lVar8 + 1;
} while (local_468[lVar8] != L'\0');
if (lVar8 == 0) {
uVar4 = FUN_180010610(param_1,0x104,(longlong)local_668);
}
else {
local_6e8 = local_468;
uVar4 = FUN_180013988(param_1,0x104,L"%ls[%ls]",local_668);
}
if (uVar4 == 0x8007007a) {
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0) {
FUN_180041cb0(DAT_180091000[2],0xe,&DAT_1800854a0);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0) {
FUN_180041d70(DAT_180091000[2],0xf,&DAT_1800854a0,local_668);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041d70(DAT_180091000[2],0x10,&DAT_1800854a0,local_468);
}
}
}
}
else if ((((int)uVar4 < 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar7 = 0x11;
goto LAB_180039f2d;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
uVar7 = 0xc;
LAB_180039f2d:
FUN_180041cdc(DAT_180091000[2],uVar7,&DAT_1800854a0,uVar4);
}
}
CloseHandle(hProcess);
goto LAB_180010f20;
}
pwVar9 = L"<UNKNOWN>";
}
else {
pwVar9 = L"SYSTEM";
}
_o_wcsncpy_s(param_1,0x104,pwVar9,0xffffffffffffffff);
LAB_180010f20:
FUN_180028070(local_48 ^ (ulonglong)auStack_708);
return;
}
=========================================
Function at address: 0x180011040
Called functions addresses: 0x180043190 0x180041cdc 0x18004312c 0x180010874 0x180041cb0 0x180028070 0x180041d20


void FUN_180011040(ushort *param_1,undefined *param_2,int *param_3,int *param_4,undefined8 param_5,
undefined8 param_6,longlong *param_7,undefined8 *param_8)

{
uint uVar1;
undefined8 *puVar2;
undefined8 uVar3;
undefined *puVar4;
int *piVar5;
undefined auStackY_88 [32];
undefined8 local_58 [2];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_88;
puVar4 = param_2;
piVar5 = param_3;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
piVar5 = (int *)&DAT_180084ce0;
puVar4 = (undefined *)0x3e;
FUN_180041cb0(DAT_180091000[2],0x3e,&DAT_180084ce0);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
piVar5 = (int *)&DAT_180084ce0;
puVar4 = (undefined *)0x3f;
FUN_180041cb0(DAT_180091000[2],0x3f,&DAT_180084ce0);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
piVar5 = (int *)&DAT_180084ce0;
puVar4 = (undefined *)0x40;
FUN_180041cdc(DAT_180091000[2],0x40,&DAT_180084ce0,(int)param_2);
}
}
}
if ((DAT_180092f00 & 1) != 0) {
puVar4 = &DAT_180084cd0;
FUN_18004312c(DAT_180091000,&DAT_180084cd0,piVar5,1,local_58);
}
if (((ulonglong)param_2 & 1) == 0) {
if (((ulonglong)param_2 & 2) == 0) {
if ((DAT_180092f00 & 1) != 0) {
FUN_180043190(DAT_180091000,puVar4,0x8009030e);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x41,&DAT_180084ce0,0x8009030e,0xe);
}
goto LAB_180011118;
}
uVar3 = 0x80000000;
}
else {
uVar3 = 0x40000000;
}
uVar1 = FUN_180010874(param_1,(uint)uVar3,param_3,param_4,param_7,param_8);
puVar2 = DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar2 = (undefined8 *)DAT_180091000[2];
uVar3 = 0x42;
FUN_180041cb0(puVar2,0x42,&DAT_180084ce0);
}
if ((DAT_180092f00 & 1) != 0) {
FUN_180043190(puVar2,uVar3,(ulonglong)uVar1);
}
LAB_180011118:
FUN_180028070(local_48 ^ (ulonglong)auStackY_88);
return;
}
=========================================
Function at address: 0x180011144
Called functions addresses: 0x180028d84


void FUN_180011144(longlong param_1)

{
if (((param_1 != 0) && (DAT_1800927ac != '\0')) && (*(longlong *)(param_1 + 0x88) != 0)) {
_o_wcsncpy_s(param_1 + 0x298,0x100,*(longlong *)(param_1 + 0x88) + 0xd8,0xffffffffffffffff);
}
return;
}
=========================================
Function at address: 0x18001118c
Called functions addresses: 0xEXTERNAL:0000012b 0xEXTERNAL:0000012d 0xEXTERNAL:0000012a 0x180009ae4 0x180012fc4 0x18002a7c0 0xEXTERNAL:0000012c 0x180041d20 0x180041e9c 0x180041cdc 0x180011434 0xEXTERNAL:00000129 0xEXTERNAL:00000128 0x180041cb0 0xEXTERNAL:00000041 0x18000909c 0x180028d90 0x18000a1f4 0x180010cf8


uint FUN_18001118c(undefined8 param_1,int param_2,int *param_3,int *param_4)

{
undefined4 uVar1;
ulonglong uVar2;
char cVar3;
uint uVar4;
BOOL BVar5;
uint uVar6;
DWORD DVar7;
HCERTSTORE hCertStore;
PCCERT_CONTEXT pPrevCertContext;
HCERTSTORE pvVar8;
longlong lVar9;
uint unaff_EBX;
uint *puVar10;
uint *puVar11;
uint *puVar12;
uint uVar13;
HLOCAL pvVar14;
HCERTSTORE local_e8;
HLOCAL local_e0;
longlong local_d0;
undefined8 *local_c8;
longlong local_c0;
uint local_b8 [2];
uint *local_b0;
undefined local_a8 [4];
uint local_a4;
uint local_a0;
undefined4 uStack_9c;
longlong local_98;
longlong local_90;
uint local_80;
int local_78;
uint uStack_74;
uint local_70;
int local_6c;
int local_68;
int iStack_64;
undefined8 local_60;
undefined8 local_58;
ulonglong uStack_50;
undefined8 local_48;

local_e0 = (HLOCAL)0x0;
local_e8 = (HCERTSTORE)0x0;
pvVar14 = (HLOCAL)0x0;
memset(local_a8,0,0x50);
local_58 = 0;
uStack_50 = 0;
local_48 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180084ce0);
}
if (DAT_180092620 == 0) {
return unaff_EBX;
}

if (cVar3 == '\0') {
return unaff_EBX;
}
uVar2 = uStack_50 & 0x11;
if (param_2 == 3) {

pvVar8 = (HCERTSTORE)0x0;
if ((int)uVar4 < 0) goto LAB_180011364;
local_60 = 0;
}
else {
uVar1 = 0x50;
if (param_2 != 4) {
uVar1 = 0x48;
}

pvVar14 = (HLOCAL)0x0;
pvVar8 = (HLOCAL)0x0;
if ((int)uVar4 < 0) goto LAB_180011364;
}
memset(param_4 + 1,0,0x6c);
*param_4 = param_2;
local_c0 = local_90;
lVar9 = local_98;
uVar13 = local_a0;
if (param_2 == 4) {
local_c0 = local_98;
lVar9 = CONCAT44(uStack_9c,local_a0);
uVar13 = local_a4;
}
if (100 < uVar13) {
pvVar14 = (HLOCAL)0x0;
uVar4 = 0x80090300;
pvVar8 = pvVar14;
goto LAB_180011364;
}
puVar12 = *(uint **)(param_3 + 2);
if ((puVar12 == (uint *)0x0) &&
(((uVar13 != 0 && (lVar9 != 0)) || (puVar12 = (uint *)0x0, local_c0 != 0)))) {
if (uVar2 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180084ce0);
}
pvVar14 = local_e8;
pvVar8 = local_e8;
uVar4 = 0x90312;
goto LAB_180011364;
}
pvVar14 = (HLOCAL)0x0;
local_d0 = 0x100000008;
local_c8 = (undefined8 *)0x0;
local_c8 = (undefined8 *)FUN_18000a1f4(8);
pvVar8 = pvVar14;
if (local_c8 == (undefined8 *)0x0) {
uVar4 = 0x80090300;
goto LAB_180011364;
}
*local_c8 = param_1;
uVar4 = FUN_180012fc4(10,0,0,&local_d0,param_3,1,0,1);
if (local_c8 != (undefined8 *)0x0) {
FUN_18000909c(local_c8);
}
if ((int)uVar4 < 0) goto LAB_180011364;
puVar12 = *(uint **)(param_3 + 2);
if (puVar12 == (uint *)0x0) {
uVar4 = 0x80090304;
goto LAB_180011364;
}
}
if ((uVar13 != 0) && (lVar9 != 0)) {
pvVar14 = (HLOCAL)FUN_18000a1f4((ulonglong)(uVar13 * 8));
if (pvVar14 == (HLOCAL)0x0) {
uVar4 = 0x80090300;
pvVar8 = local_e8;
goto LAB_180011364;
}

pvVar8 = local_e8;
if ((int)uVar4 < 0) goto LAB_180011364;
param_4[1] = uVar13;
lVar9 = FUN_18000a1f4((ulonglong)(uVar13 * 0x38));
uVar4 = 0;
*(longlong *)(param_4 + 2) = lVar9;
if (lVar9 == 0) {
uVar4 = 0x80090300;
goto LAB_180011364;
}
local_e8 = CertOpenStore((LPCSTR)0x2,0,0,4,(void *)0x0);
pvVar8 = local_e8;
if (local_e8 == (HCERTSTORE)0x0) {
GetLastError();
uVar4 = 0x80090300;
goto LAB_180011364;
}
local_d0 = 0;
do {
uVar6 = *puVar12;
puVar10 = puVar12 + 1;
puVar11 = (uint *)((longlong)puVar10 + (ulonglong)uVar6);
local_e0 = pvVar14;
if ((puVar10 == (uint *)0x0) || (uVar6 < 0xc)) goto LAB_18003a257;
lVar9 = *(longlong *)(param_4 + 2);
((void **)(lVar9 + local_d0))[2] = *(void **)puVar10;
if (uVar6 - 0xc < puVar12[3]) goto LAB_18003a257;
BVar5 = CertAddSerializedElementToStore
(local_e8,(BYTE *)(puVar12 + 4),puVar12[3],4,0,2,(DWORD *)0x0,
(void **)(lVar9 + local_d0));
if (BVar5 == 0) {
LAB_18003a494:
uVar4 = 0x8009030d;
goto LAB_180011364;
}
uVar6 = uStack_74;
if (param_2 == 4) {
uVar6 = (uint)local_60;
}
puVar12 = puVar11;
if ((uVar6 >> 0x10 & 1) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180084ce0);
}
uVar6 = *puVar11;
puVar10 = puVar11 + 1;
puVar12 = (uint *)((longlong)puVar10 + (ulonglong)uVar6);
if ((puVar10 == (uint *)0x0) || (uVar6 < 4)) goto LAB_18003a554;
local_b8[0] = *puVar10;
local_b0 = puVar11 + 2;
if ((ulonglong)uVar6 - 4 < (ulonglong)local_b8[0]) goto LAB_18003a554;
hCertStore = CertOpenStore((LPCSTR)0x6,1,0,0,local_b8);
if (hCertStore == (HCERTSTORE)0x0) goto LAB_18003a54a;
pPrevCertContext = (PCCERT_CONTEXT)0x0;
while (pPrevCertContext = CertEnumCertificatesInStore(hCertStore,pPrevCertContext),
pPrevCertContext != (PCCERT_CONTEXT)0x0) {
BVar5 = CertAddCertificateContextToStore
(local_e8,pPrevCertContext,1,(PCCERT_CONTEXT *)0x0);
if ((BVar5 == 0) && (DVar7 = GetLastError(), DVar7 != 0x80092005)) {
BVar5 = CertCloseStore(hCertStore,2);
if ((BVar5 == 0) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)))) {
DVar7 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0xe,&DAT_180084ce0,DVar7);
}
CertFreeCertificateContext(pPrevCertContext);
goto LAB_18003a494;
}
}
BVar5 = CertCloseStore(hCertStore,2);
if (((BVar5 == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
DVar7 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0xf,&DAT_180084ce0,DVar7);
}
}
uVar4 = uVar4 + 1;
local_d0 = local_d0 + 0x38;
} while (uVar4 < uVar13);
}
uVar13 = 0;
if (local_c0 != 0) {
if ((puVar12 + 1 == (uint *)0x0) || (*puVar12 < 4)) {
LAB_18003a257:
uVar4 = 0x80090304;
pvVar14 = local_e0;
pvVar8 = local_e8;
goto LAB_180011364;
}
local_b8[0] = puVar12[1];
local_b0 = puVar12 + 2;
if ((ulonglong)*puVar12 - 4 < (ulonglong)local_b8[0]) {
LAB_18003a554:
pvVar14 = local_e0;
pvVar8 = local_e8;
uVar4 = 0x80090304;
goto LAB_180011364;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x10,&DAT_180084ce0);
}
pvVar8 = CertOpenStore((LPCSTR)0x6,1,0,0,local_b8);
*(HCERTSTORE *)(param_4 + 4) = pvVar8;
if (pvVar8 == (HCERTSTORE)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x11,&DAT_180084ce0);
}
LAB_18003a54a:
pvVar14 = local_e0;
pvVar8 = local_e8;
uVar4 = 0x8009030d;
goto LAB_180011364;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x12,&DAT_180084ce0,pvVar8);
}
}
pvVar8 = local_e8;
if (param_2 == 4) {
if ((local_80 != 0) && (CONCAT44(uStack_74,local_78) != 0)) {
if (local_80 < 0x101) {
param_4[0xe] = local_80;
lVar9 = FUN_18000a1f4((ulonglong)(local_80 * 4));
*(longlong *)(param_4 + 0x10) = lVar9;
if (lVar9 != 0) {

(0,local_80 * 4,lVar9,CONCAT44(uStack_74,local_78));
pvVar14 = local_e0;
if ((int)uVar4 < 0) goto LAB_180011364;
goto LAB_1800113fc;
}
}
pvVar14 = local_e0;
uVar4 = 0x80090300;
goto LAB_180011364;
}
LAB_1800113fc:
if (local_70 == 0xffffffff) {
local_70 = uVar13;
}
param_4[0x12] = local_70 & 0x3fffffff;
param_4[0x13] = local_6c;
param_4[0x14] = local_68;
param_4[0x15] = iStack_64;
param_4[0x16] = (uint)local_60;
local_a4 = local_60._4_4_;
}
else {
pvVar14 = local_e0;
uVar4 = uVar13;
if ((param_2 != 5) ||
(uVar4 = FUN_180009ae4(CONCAT44(iStack_64,local_68),local_70,0,'\x01',
(longlong *)(param_4 + 0x1a),(uint *)(param_4 + 0x18)),
pvVar14 = local_e0, uVar4 != 0)) goto LAB_180011364;
param_4[0x15] = local_78;
param_4[0x16] = uStack_74;
}
param_4[0x17] = local_a4;
pvVar14 = local_e0;
uVar4 = uVar13;
LAB_180011364:
if (param_3 != (int *)0x0) {
if ((*(HLOCAL *)(param_3 + 2) != (HLOCAL)0x0) && ((uStack_50 & 0x10) != 0)) {
FUN_18000909c(*(HLOCAL *)(param_3 + 2));
}
param_3[2] = 0;
param_3[3] = 0;
param_3[0] = 0;
param_3[1] = 0;
FUN_180011434(0);
}
if (pvVar14 != (HLOCAL)0x0) {
FUN_18000909c(pvVar14);
}
if (pvVar8 != (HCERTSTORE)0x0) {
CertCloseStore(pvVar8,0);
}
if ((int)uVar4 < 0) {
FUN_180010cf8((undefined *)param_4,'\x01');
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (uVar4 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x13,&DAT_180084ce0,uVar4,(char)uVar4);
}
return unaff_EBX;
}
=========================================
Function at address: 0x180011434
Called functions addresses: 0x18002a7c0


void FUN_180011434(longlong param_1)

{
if (param_1 != 0) {

}

return;
}
=========================================
Function at address: 0x18001147c
Called functions addresses: 0x180041cdc 0x180041dd8 0x180041cb0 0x18002a7c0 0xEXTERNAL:00000122 0x180041e58


int FUN_18001147c(longlong *param_1,ulonglong param_2,longlong *param_3,uint param_4)

{
ushort uVar1;
uint uVar2;
int iVar3;
undefined4 uVar4;
uint uVar5;
uint uVar6;
uint uVar7;
uint uVar8;
int iVar9;
undefined8 uVar10;
undefined8 uVar11;
undefined2 uVar12;
longlong lVar13;
longlong lVar14;
wchar_t *pwVar15;

uVar2 = *(uint *)(param_1 + 8);
iVar9 = 0;
if (param_3 == (longlong *)0x0) {
return 0x57;
}
if (param_4 < 0x3d) {
return 0x57;
}
if ((param_2 & 1) != 0) {
lVar13 = *param_3;
param_1[0x16] = lVar13;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x1d,&DAT_180084b60,lVar13);
}
}
if ((param_2 & 2) != 0) {
lVar13 = param_3[1];
param_1[0x17] = lVar13;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x1e,&DAT_180084b60,lVar13);
}
}
if ((param_2 & 1) == 0) {
LAB_180011548:
if ((param_2 & 1) != 0) goto LAB_180011552;
LAB_180011572:
if ((param_2 & 1) != 0) goto LAB_18001157a;
}
else {
iVar3 = *(int *)(param_3 + 2);
*(int *)(param_1 + 0x18) = iVar3;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_180011548;
FUN_180041e58(DAT_180091000[2],0x1f,&DAT_180084b60,(longlong)iVar3);
LAB_180011552:
lVar13 = *(longlong *)((longlong)param_3 + 0x14);
param_1[0x19] = lVar13;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_180011572;
FUN_180041e58(DAT_180091000[2],0x20,&DAT_180084b60,lVar13);
LAB_18001157a:
lVar13 = *(longlong *)((longlong)param_3 + 0x1c);
param_1[0x1a] = lVar13;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x21,&DAT_180084b60,lVar13);
}
}
uVar1 = *(ushort *)((longlong)param_3 + 0x24);
*(ushort *)(param_1 + 0x1b) = uVar1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x22,&DAT_180084b60,(uint)uVar1);
}
uVar1 = *(ushort *)((longlong)param_3 + 0x26);
*(ushort *)((longlong)param_1 + 0xda) = uVar1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x23,&DAT_180084b60,(uint)uVar1);
}
if ((param_2 & 1) != 0) {
uVar4 = *(undefined4 *)(param_3 + 5);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x24,&DAT_180084b60,uVar4);
}
if ((((undefined4 *)param_1[0x1c] != (undefined4 *)0x0) &&
(*(undefined4 *)param_1[0x1c] = uVar4, (undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x25,&DAT_180084b60,*(undefined4 *)param_1[0x1c]);
}
}

uVar5 = *(uint *)((longlong)param_3 + 0x2d);
uVar6 = *(uint *)((longlong)param_3 + 0x31);
uVar7 = *(uint *)((longlong)param_3 + 0x35);
uVar8 = *(uint *)((longlong)param_3 + 0x39);
if (((0x10000 < uVar5) || (0x10000 < uVar6)) || ((0x10000 < uVar7 || (0x10000 < uVar8)))) {
return 0x57;
}
if (param_4 - 0x3d != uVar8 + uVar7 + uVar6 + uVar5) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x54f;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cb0(DAT_180091000[2],0x26,&DAT_180084b60);
return 0x54f;
}
return 0x54f;
}
lVar13 = (longlong)param_3 + 0x3d + (ulonglong)uVar5;
lVar14 = lVar13 + (ulonglong)uVar6;
if ((param_2 & 1) != 0) {
uVar11 = 0;
if (uVar5 == 0) {
param_1[0x12] = 0;
iVar9 = 0;
}
else {
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
uVar11 = *(undefined8 *)param_1[1];
}
iVar9 = SslImportKey(uVar11,param_1 + 0x12,L"OpaqueKeyBlob",(longlong)param_3 + 0x3d,uVar5,0);
if (iVar9 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar9;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return iVar9;
}
uVar12 = 0x27;
goto LAB_18003a929;
}
}
}
uVar11 = 0;
if ((param_2 & 2) != 0) {
if (uVar6 == 0) {
param_1[0x13] = 0;
}
else {
uVar10 = uVar11;
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
uVar10 = *(undefined8 *)param_1[1];
}
iVar9 = SslImportKey(uVar10,param_1 + 0x13,L"OpaqueKeyBlob",lVar13,uVar6,0);
if (iVar9 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar9;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return iVar9;
}
uVar12 = 0x28;
LAB_18003a929:
FUN_180041cdc(DAT_180091000[2],uVar12,&DAT_180084b60,iVar9);
return iVar9;
}
}
}
if (uVar7 != 0) {
uVar10 = uVar11;
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
uVar10 = *(undefined8 *)param_1[1];
}

if (iVar9 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar9;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return iVar9;
}
pwVar15 = L"server";
uVar12 = 0x29;
if ((uVar2 & 0x40051555) != 0) {
pwVar15 = L"client";
}
goto LAB_18003aa11;
}
}
if (uVar8 == 0) {
return iVar9;
}
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
uVar11 = *(undefined8 *)param_1[1];
}

(param_1,uVar11,0,lVar14 + (ulonglong)uVar7,uVar8);
if (iVar9 == 0) {
return 0;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar9;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return iVar9;
}
pwVar15 = L"server";
uVar12 = 0x2a;
if ((uVar2 & 0x40051555) == 0) {
pwVar15 = L"client";
}
LAB_18003aa11:
FUN_180041dd8(DAT_180091000[2],uVar12,&DAT_180084b60,pwVar15,(char)iVar9);
return iVar9;
}
=========================================
Function at address: 0x180011740
Called functions addresses: 0x180011434 0x180061340 0x18002a77b 0x18001147c 0x18000404c 0x18002a7c0 0x180041d20 0x18000a1f4


int FUN_180011740(longlong *param_1)

{
longlong lVar1;
char cVar2;
int iVar3;
void *_Dst;
ulonglong uVar4;
undefined2 uVar5;
uint uVar6;
ulonglong uVar7;
int local_res8 [2];
ulonglong local_res10;
ulonglong local_48;
longlong *plStack_40;
undefined local_38 [8];
uint local_30;

local_res10 = 0;
local_res8[0] = 0;
local_48 = 0;
plStack_40 = (longlong *)0x0;
if (DAT_180092620 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x3fffff1b;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x3fffff1b;
}
uVar5 = 0x62;
LAB_18003aaf2:
FUN_180041d20(DAT_180091000[2],uVar5,&DAT_180082c58,0xc00000e5,0xe5);
return -0x3fffff1b;
}

if (cVar2 == '\0') {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x3fffff1b;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x3fffff1b;
}
uVar5 = 99;
goto LAB_18003aaf2;
}
uVar6 = local_30 & 0x40;

if ((iVar3 == 0) &&
(((plStack_40 != (longlong *)0x0 && ((uint)local_48 != 0)) || (local_res8[0] == 4)))) {
iVar3 = 0;
if (local_res8[0] == 1) {
*(uint *)(param_1 + 0x76) = (uint)local_48;
*(uint *)(param_1 + 9) = (-(uint)((*(uint *)(param_1 + 8) & 0x2000) != 0) & 10) + 0x5b;
_Dst = (void *)FUN_18000a1f4(local_48 & 0xffffffff);
param_1[0x75] = (longlong)_Dst;
if (_Dst != (void *)0x0) {
memcpy(_Dst,plStack_40,local_48 & 0xffffffff);
*(undefined *)(param_1 + 0x81) = 1;
goto LAB_180011819;
}
}
else {
if (local_res8[0] == 4) {
if (param_1 == (longlong *)0x0) {
iVar3 = 0x54f;
}
if (plStack_40 == (longlong *)0x0) {
FUN_180061340((longlong)param_1,0,'\0');
}
else if ((uint)local_48 == (-(uint)(uVar6 != 0) & 0xfffffff8) + 0x24) {
uVar4 = -(ulonglong)(uVar6 != 0) & 0xfffffffffffffffc;
if (uVar6 == 0) {
uVar7 = *(ulonglong *)((longlong)plStack_40 + 0x14);
uVar4 = *(ulonglong *)(uVar4 + 0x1c + (longlong)plStack_40);
}
else {
uVar7 = (ulonglong)*(uint *)((longlong)plStack_40 + 0x14);
uVar4 = (ulonglong)*(uint *)(uVar4 + 0x1c + (longlong)plStack_40);
}
lVar1 = param_1[0x74];
if (lVar1 == 0) {
iVar3 = 0x54f;
}
*(ulonglong *)(lVar1 + 0x68) = uVar7;
*(ulonglong *)(lVar1 + 0x70) = uVar4;
*(undefined *)((longlong)param_1 + 0x39b) = 0;
FUN_18000404c((longlong)param_1,0);
}
else {
iVar3 = 0x54f;
}
goto LAB_180011819;
}
if (local_res8[0] == 7) {
iVar3 = FUN_18001147c(param_1,local_res10 & 0xffffffff,plStack_40,(uint)local_48);
if (iVar3 == 0) goto LAB_180011819;
goto LAB_180011840;
}
if (local_res8[0] == 9) {
*(undefined *)(param_1 + 0x3b) = *(undefined *)plStack_40;
goto LAB_180011819;
}
}
iVar3 = 0x54f;
}
else {
LAB_180011840:
iVar3 = -0x3fffff1b;
}
LAB_180011819:
*(undefined4 *)((longlong)param_1 + 0x44) = *(undefined4 *)(param_1 + 9);
*(undefined4 *)(param_1 + 9) = 0x4d;
FUN_180011434(0);
return iVar3;
}
=========================================
Function at address: 0x180011860
Called functions addresses: 0x18006ffcc 0x180070804 0x1800119b0 0x18002a7c0 0x180070304 0x18003ac04 0x180044ee8 0x180011740 0x180012e50 0x180073a40


ulonglong FUN_180011860(longlong *param_1,int *param_2,uint *param_3)

{
longlong *plVar1;
char cVar2;
int iVar3;
uint uVar4;
byte *pbVar5;
undefined4 extraout_var;
undefined4 extraout_var_00;
ulonglong uVar6;
uint uVar7;
int local_18;
int local_14;
longlong local_10;
ulonglong uVar8;

uVar4 = 0;
if ((*(int *)((longlong)param_1 + 0x44) == 0x4d) && (iVar3 = FUN_180011740(param_1), iVar3 != 0))
{
uVar6 = FUN_18003ac04();
return uVar6;
}
if (((*(char *)((longlong)param_1 + 0x10a) != '\0') || ((*(uint *)(param_1 + 8) & 0x3000) != 0))
&& ((((ulonglong)param_1[0x11] >> 0x1e & 1) != 0 ||
(*(char *)((longlong)param_1 + 0x109) != '\0')))) {
if (param_1[0x13] == 0) {
uVar4 = 2;
}
if (param_1[0x12] == 0) {
uVar4 = uVar4 | 1;
}
if (uVar4 != 0) {
param_1[0x11] = param_1[0x11] & 0xffffffffbfffffff;
if (*(char *)((longlong)param_1 + 0x10a) != '\0') {
*(undefined4 *)(param_1 + 9) = *(undefined4 *)((longlong)param_1 + 0x44);
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4d;
iVar3 = FUN_180012e50(param_1,uVar4);
return CONCAT44(extraout_var,iVar3);
}
iVar3 = FUN_180012e50(param_1,uVar4);
if (iVar3 != 0) {
return CONCAT44(extraout_var_00,iVar3);
}
}
}
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
plVar1 = (longlong *)(param_1[0x48] + 0x38);
if ((longlong *)*plVar1 != plVar1) {
uVar6 = FUN_18006ffcc(param_1,param_3);
return uVar6;
}
if ((((*(int *)((longlong)param_1 + 0x44) != 4) && (*param_2 == 0)) && (param_2[1] == 0)) &&
(*(longlong *)(param_2 + 2) == 0)) {
uVar6 = FUN_180073a40(param_1[0x48]);
if ((int)uVar6 != 0) {
return uVar6;
}
FUN_180044ee8(*(uint *)(param_1[10] + 0xd4));
uVar6 = FUN_180070304((longlong)param_1);
if ((int)uVar6 != 0) {
return uVar6;
}
uVar6 = FUN_18006ffcc(param_1,param_3);
return uVar6;
}
}

if (cVar2 == '\0') {
uVar6 = FUN_180070804(param_1,(longlong)param_2,(longlong)param_3);
uVar4 = (uint)uVar6;
}
else {
if ((*(uint *)(param_1 + 0x11) >> 0xc & 1) != 0) {
uVar4 = param_2[1];
uVar8 = 0;
do {
iVar3 = (int)uVar8;
local_14 = uVar4 - iVar3;
local_10 = uVar8 + *(longlong *)(param_2 + 2);
local_18 = *param_2 - iVar3;
pbVar5 = FUN_1800119b0(param_1,(longlong)&local_18,param_3);
uVar7 = iVar3 + local_14;
uVar8 = (ulonglong)uVar7;
uVar6 = (ulonglong)pbVar5 & 0xffffffff;
if ((*(int *)((longlong)param_1 + 0x44) == 4) || ((int)pbVar5 != 0)) break;
uVar4 = param_2[1];
} while (uVar4 != uVar7);
param_2[1] = uVar7;
goto LAB_1800118fe;
}
pbVar5 = FUN_1800119b0(param_1,(longlong)param_2,param_3);
uVar4 = (uint)pbVar5;
}
uVar6 = (ulonglong)uVar4;
LAB_1800118fe:
if (((*(int *)(param_1 + 8) == 0x1000) && (*(int *)((longlong)param_1 + 0x44) == 4)) &&
(((*(uint *)(param_1 + 0x11) >> 8 & 1) != 0 &&
((*(char *)(param_1 + 0x45) == '\0' && ((int)uVar6 == 0)))))) {

uVar6 = (ulonglong)uVar4;
if ((uVar4 == 0x90316) && (*(int *)((longlong)param_1 + 0x44) == 4)) {
uVar6 = 0;
}
}
return uVar6;
}
=========================================
Function at address: 0x1800119b0
Called functions addresses: 0x18003ad76 0x18002a7c0


byte * FUN_1800119b0(longlong *param_1,longlong param_2,uint *param_3)

{
byte bVar1;
ushort uVar2;
longlong lVar3;
byte bVar4;
uint uVar5;
uint uVar6;
byte *pbVar7;
byte *pbVar8;
ulonglong uVar9;
undefined4 *puVar10;
longlong *plVar11;
undefined2 uVar12;
uint uVar13;
undefined *puVar14;
uint uVar15;
byte *pbVar16;
undefined4 uVar17;
byte bVar18;
undefined *puVar19;
char cVar20;
int iVar21;
longlong lVar22;
longlong lVar23;
uint uVar24;
uint uVar25;
uint uVar26;
bool bVar27;
uint local_res20;
uint local_7b8;
byte *local_7b0;
int local_7a8;
uint local_7a4;
byte *local_798;
undefined8 local_790;
longlong local_788;
uint local_780;
undefined4 local_77c;
ulonglong uStack_778;
int iStack_770;
int iStack_76c;
byte *pbStack_768;
int iStack_760;
int iStack_75c;
byte *pbStack_758;
uint uStack_750;
uint uStack_74c;
byte *pbStack_748;
undefined local_738 [8];
undefined4 uStack_730;
undefined4 uStack_72c;

local_77c = *(undefined4 *)(param_2 + 4);
pbVar8 = (byte *)0x0;
uVar17 = 0;
local_7a8 = 0;
uVar6 = 5;
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar6 = 0xd;
}
bVar27 = false;
local_788 = 0;
local_790 = 0;
plVar11 = param_1;

pbVar16 = (byte *)((ulonglong)pbVar7 & 0xffffffff);
if ((int)pbVar7 != 0) {
return pbVar7;
}
iVar21 = *(int *)((longlong)param_1 + 0x44);
if (((iVar21 < 6) || (0x5a < iVar21)) && (1 < iVar21)) {
pbVar8 = (byte *)FUN_18003ad76(plVar11,iVar21,(ulonglong)pbVar16);
return pbVar8;
}
if (((iVar21 != 0x4c) || (*(char *)((longlong)param_1 + 0x22b) != '\0')) ||
((*(longlong *)(param_2 + 8) == 0 || ((*(uint *)(param_1 + 8) & 0x50000) == 0))))
goto LAB_180011a69;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180082c58);
}
pbVar16 = (byte *)((ulonglong)pbVar7 & 0xffffffff);
if (*(char *)((longlong)param_1 + 0x10a) == '\0') {
LAB_18003ae95:
uVar15 = FUN_180041244((longlong)param_1);
pbVar16 = (byte *)(ulonglong)uVar15;
if (uVar15 == 0x90312) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4d;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar12 = 0xc;
LAB_18003b9be:
FUN_180041cb0(DAT_180091000[2],uVar12,&DAT_180082c58);
}
return (byte *)0x90312;
}
if (uVar15 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return pbVar16;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180082c58);
return (byte *)(ulonglong)uVar15;
}
return pbVar16;
}
}
else if (*(int *)(param_1 + 9) != 0x4d) {
*(undefined4 *)(param_1 + 9) = *(undefined4 *)((longlong)param_1 + 0x44);
goto LAB_18003ae95;
}
bVar27 = *(char *)(param_1 + 0x3b) == '\0';
LAB_180011a69:
local_7b8 = 0;
local_798 = *(byte **)(param_2 + 8);
local_7a4 = *(uint *)(param_2 + 4);
while( true ) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xe,&DAT_180082c58);
pbVar16 = (byte *)(ulonglong)local_7b8;
}
if (local_7a4 < uVar6) {
if (local_7a8 == 0) {
*(uint *)(param_2 + 4) = uVar6;
lVar22 = param_1[0x10];
if (*(short *)(lVar22 + 0x22) == 0) {
*(undefined2 *)(lVar22 + 0x22) = 0xd;
*(undefined4 *)(lVar22 + 0x24) = 0x80090318;
}
memset(local_738,0,0x6e8);
cVar20 = DAT_1800927ac;
lVar22 = param_1[1];
if (lVar22 != 0) {
uVar17 = *(undefined4 *)(lVar22 + 0x1c);
}
uStack_72c = *(undefined4 *)(param_1 + 2);
uVar2 = *(ushort *)((longlong)param_1 + 0x22);
lVar3 = param_1[0x11];
uStack_730 = uVar17;
if ((lVar22 != 0) && (param_1[0xb] != 0)) {
lVar23 = param_1[0xf];
iVar21 = *(int *)(lVar22 + 0x20);
if (((lVar23 != 0) && (DAT_1800927ac != '\0')) &&
(((*(undefined4 *)(lVar23 + 0x30) = *(undefined4 *)(param_1[0xb] + 8), iVar21 == 0xaa02
|| (iVar21 == 0xa400)) &&
(puVar10 = FUN_180059d38(iVar21), puVar10 != (undefined4 *)0x0)))) {
*(undefined4 *)(lVar23 + 0x34) = puVar10[8];
*(undefined4 *)(lVar23 + 0x38) = puVar10[10];
if (iVar21 == 0xaa02) {
*(undefined4 *)(lVar23 + 0x3c) = puVar10[0xc];
}
}
}
lVar22 = param_1[0xf];
if ((lVar22 != 0) && (cVar20 != '\0')) {
*(undefined4 *)(lVar22 + 0x24) = uStack_72c;
*(undefined4 *)(lVar22 + 0x68) = 0x80090318;
*(undefined4 *)(lVar22 + 0x70) = 0xd;
*(undefined4 *)(lVar22 + 0x20) = uVar17;
*(uint *)(lVar22 + 0x28) = (uint)uVar2;
*(longlong *)(lVar22 + 0x80) = lVar3;
lVar22 = param_1[0xf];
}
if (((lVar22 != 0) && (cVar20 != '\0')) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180053180(DAT_180091000[2],(ulonglong)*(ushort *)(lVar22 + 0x42),
(ulonglong)*(ushort *)(lVar22 + 0x40),L"Error",(wchar_t *)(lVar22 + 0x98),
(wchar_t *)(lVar22 + 0x298));
}
return (byte *)0x80090318;
}
goto LAB_180011efd;
}
bVar4 = *local_798;
puVar19 = (undefined *)(ulonglong)bVar4;
local_res20 = (uint)bVar4;
if (3 < bVar4 - 0x14) {
FUN_18005b470(param_1,10,0x80090308,10);
return (byte *)0x80090308;
}
bVar18 = local_798[1];
bVar1 = local_798[2];
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xf,&DAT_180082c58,(uint)CONCAT11(bVar18,bVar1));
puVar19 = (undefined *)(ulonglong)local_res20;
}
if (CONCAT11(bVar18,bVar1) < 0x300) {
if ((0x301 < *(uint *)((longlong)param_1 + 0x24)) &&
((*(uint *)(param_1 + 8) & 0x800a00aa) != 0)) {
FUN_180012184((longlong)param_1,0xb,-0x7ff6fcda);
return (byte *)0x80090326;
}
FUN_18005b470(param_1,0xb,0x80090308,0x46);
return (byte *)0x80090308;
}
if ((local_798[1] == 0xfe) && (CONCAT11(local_798[1],local_798[2]) < 0xff00)) {
bVar18 = local_798[0xb];
bVar1 = local_798[0xc];
}
else {
bVar18 = local_798[3];
bVar1 = local_798[4];
}
uVar15 = (uint)CONCAT11(bVar18,bVar1);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x10,&DAT_180082c58,uVar15);
puVar19 = (undefined *)(ulonglong)local_res20;
}
local_780 = uVar15 + uVar6;
uVar5 = 0;
if (local_7a4 < local_780) break;
local_7a8 = local_7a8 + local_780;
*(int *)(param_2 + 4) = local_7a8;
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar24 = 0;
uVar2 = CONCAT11(local_798[3],local_798[4]);
local_7b8 = 0;
local_7b0 = (byte *)0x0;
uStack_778 = CONCAT71(CONCAT61(CONCAT51(CONCAT41(CONCAT31(CONCAT21(uVar2,local_798[5]),
local_798[6]),local_798[7]),
local_798[8]),local_798[9]),local_798[10]);
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041d20(DAT_180091000[2],0x11,&DAT_180082c58,(uint)uVar2,local_798[10]);
puVar19 = (undefined *)(ulonglong)local_res20;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18006a8f8(DAT_180091000[2],0x12,&DAT_180082c58,*(undefined4 *)(param_1 + 0x18),
(char)*(undefined2 *)((longlong)param_1 + 0xdc),
(char)*(undefined4 *)param_1[0x1c]);
puVar19 = (undefined *)(ulonglong)local_res20;
}
}
pbVar16 = pbVar8;
uVar26 = uVar5;
if (bVar27) {
bVar18 = (byte)puVar19;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180082c58);
bVar18 = bVar4;
}
pbVar16 = (byte *)0x0;
if (((uint)uVar2 < *(uint *)(param_1 + 0x18)) && (bVar18 == 0x14)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18003b86d;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
uVar12 = 0x14;
LAB_18003b835:
FUN_180041cb0(DAT_180091000[2],uVar12,&DAT_180082c58);
}
LAB_18003b84c:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1b,&DAT_180082c58);
}
LAB_18003b86d:
FUN_180044ee8(*(uint *)(param_1[10] + 0xd4));
FUN_180073a40(param_1[0x48]);
uVar9 = FUN_180070304((longlong)param_1);
pbVar8 = (byte *)(uVar9 & 0xffffffff);
if ((int)uVar9 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return pbVar8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cb0(DAT_180091000[2],0x1c,&DAT_180082c58);
return pbVar8;
}
return pbVar8;
}
param_1[0x11] = param_1[0x11] & 0xffffffffbfffffff;
*(undefined *)((longlong)param_1 + 0x109) = 1;
*(undefined4 *)((longlong)param_1 + 0x44) = 4;
if ((local_7b8 == 0) && (*(char *)((longlong)param_1 + 0x10a) == '\0')) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180082c58);
}
uVar6 = FUN_180012e50(param_1,1);
pbVar8 = (byte *)(ulonglong)uVar6;
if (uVar6 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return pbVar8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cdc(DAT_180091000[2],0x1e,&DAT_180082c58,uVar6);
return pbVar8;
}
return pbVar8;
}
}
pbVar8 = (byte *)FUN_18006ffcc(param_1,param_3);
return pbVar8;
}
if ((uint)uVar2 == *(uint *)(param_1 + 0x18)) {
if (bVar18 == 0x17) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18003b86d;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
uVar12 = 0x15;
goto LAB_18003b835;
}
goto LAB_18003b84c;
}
if ((((bVar18 == 0x16) && (uVar26 = uVar24, (*(byte *)(param_1 + 4) & 2) != 0)) &&
(param_1[1] != 0)) && (*(int *)(param_1[1] + 0x1c) != 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180082c58);
}
iStack_770 = uVar15 + uVar6;
iStack_76c = iStack_770;
pbStack_768 = local_798;
uVar9 = FUN_180011ff0(param_1,&iStack_770);
if ((int)uVar9 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return (byte *)0x90312;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return (byte *)0x90312;
}
uVar12 = 0x17;
goto LAB_18003b9be;
}
pbVar16 = (byte *)0x1;
local_7b8 = 1;
local_7b0 = pbVar8;
if ((*(byte *)(param_1 + 4) & 2) != 0) {
local_7b0 = (byte *)(ulonglong)*(uint *)((longlong)param_1 + 0x2c);
}
if ((local_798[1] == 0xfe) && (CONCAT11(local_798[1],local_798[2]) < 0xff00)) {
bVar4 = local_798[0xb];
bVar18 = local_798[0xc];
}
else {
bVar4 = local_798[3];
bVar18 = local_798[4];
}
uVar26 = (uint)CONCAT11(bVar4,bVar18);
if (uVar15 < uVar26 + uVar6 + (int)local_7b0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return (byte *)0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return (byte *)0x80090326;
}
uVar12 = 0x18;
goto LAB_18003ba69;
}
local_7b0 = local_7b0 + (longlong)(local_798 + uVar6);
if (uVar26 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return (byte *)0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return (byte *)0x80090326;
}
uVar12 = 0x19;
goto LAB_18003ba69;
}
if (*local_7b0 == 0x14) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18003b86d;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
uVar12 = 0x1a;
goto LAB_18003b835;
}
goto LAB_18003b84c;
}
}
}
}
uVar24 = (uint)pbVar16;
if ((*(int *)((longlong)param_1 + 0x44) == 0x4c) &&
(*(char *)((longlong)param_1 + 0xe9) != '\0')) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180082c58);
uVar24 = local_7b8;
}
*(int *)(param_1[0x49] + 0x24) = (int)*(short *)(*(longlong *)(param_1[0x49] + 0x28) + 0xc0)
;
}
if ((((*(byte *)(param_1 + 4) & 2) == 0) || (param_1[1] == 0)) ||
(*(int *)(param_1[1] + 0x1c) == 0)) {
if (uVar24 == 0) {
LAB_18003b38f:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x24,&DAT_180082c58);
}
local_7b0 = local_798 + uVar6;
uVar26 = uVar15;
}
}
else if (uVar24 == 0) {
if ((uint)uVar2 != *(uint *)(param_1[0x49] + 0x24)) goto LAB_18003b38f;
if ((uint)uVar2 < *(uint *)(param_1 + 0x18)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x20,&DAT_180082c58);
}
FUN_180044e9c(*(uint *)(param_1[10] + 0xd4));
return (byte *)0x90312;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x21,&DAT_180082c58);
}
iStack_760 = uVar15 + uVar6;
iStack_75c = iStack_760;
pbStack_758 = local_798;
uVar9 = FUN_180011ff0(param_1,&iStack_760);
if ((int)uVar9 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return (byte *)0x90312;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return (byte *)0x90312;
}
uVar12 = 0x22;
goto LAB_18003b9be;
}
local_7b0 = pbVar8;
if ((*(byte *)(param_1 + 4) & 2) != 0) {
local_7b0 = (byte *)(ulonglong)*(uint *)((longlong)param_1 + 0x2c);
}
if ((local_798[1] == 0xfe) && (CONCAT11(local_798[1],local_798[2]) < 0xff00)) {
bVar4 = local_798[0xb];
bVar18 = local_798[0xc];
}
else {
bVar4 = local_798[3];
bVar18 = local_798[4];
}
if (uVar15 < CONCAT11(bVar4,bVar18) + uVar6 + (int)local_7b0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return (byte *)0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return (byte *)0x80090326;
}
uVar12 = 0x23;
LAB_18003ba69:
FUN_180041cb0(DAT_180091000[2],uVar12,&DAT_180082c58);
return (byte *)0x80090326;
}
local_7b0 = local_7b0 + (longlong)(local_798 + uVar6);
uVar26 = (uint)CONCAT11(bVar4,bVar18);
}
FUN_180072adc((longlong *)param_1[0x49],(ulonglong)local_res20,local_7b0,uVar26,uStack_778);
puVar19 = (undefined *)(ulonglong)local_res20;
}
local_7b0 = (byte *)0x0;
local_7b8 = (uint)puVar19;
if (((*(uint *)(param_1 + 8) & 0x3000) == 0) || ((char)puVar19 != '\x14')) {
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
pbVar7 = (byte *)(ulonglong)local_780;
pbVar16 = local_798;
puVar14 = puVar19;
}
else {
pbVar16 = pbVar8;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar19 = &DAT_180082c58;
pbVar16 = (byte *)0x36;
FUN_180041cb0(DAT_180091000[2],0x36,&DAT_180082c58);
}
local_7b0 = (byte *)FUN_180072f28((undefined8 *)param_1[0x49],pbVar16,puVar19);
pbVar16 = pbVar8;
pbVar7 = pbVar8;
if (local_7b0 != (byte *)0x0) {
local_7b8 = *(uint *)(local_7b0 + 0x40);
pbVar16 = *(byte **)(local_7b0 + 0x28);
pbVar7 = (byte *)(ulonglong)*(uint *)(local_7b0 + 0x14);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x37,&DAT_180082c58,local_7b8);
}
puVar14 = (undefined *)(ulonglong)local_7b8;
puVar19 = (undefined *)(ulonglong)local_res20;
}
uVar24 = (uint)pbVar7;
if (pbVar16 != (byte *)0x0) {
while( true ) {
uVar26 = (uint)puVar19;
if (((((*(byte *)(param_1 + 4) & 2) == 0) || (param_1[1] == 0)) ||
(*(int *)(param_1[1] + 0x1c) == 0)) ||
((*(char *)((longlong)param_1 + 0xe9) != '\0' &&
((local_7b0 == (byte *)0x0 || (*(int *)(local_7b0 + 0x44) == 0)))))) {
if ((*(char *)((longlong)param_1 + 0xe9) == '\0') || ((int)puVar14 == 0x14)) {
pbVar16 = pbVar16 + uVar6;
uVar24 = uVar24 - uVar6;
}
}
else {
uVar25 = (uint)pbVar7;
uStack_750 = uVar25;
uStack_74c = uVar25;
pbStack_748 = pbVar16;
if (((*(int *)((longlong)param_1 + 0x44) - 0x4eU < 2) && (uVar6 < uVar24)) &&
((pbVar16 != (byte *)0x0 && (*pbVar16 == 0x16)))) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x25,&DAT_180082c58);
puVar14 = (undefined *)(ulonglong)local_7b8;
uVar26 = local_res20;
}
uVar2 = *(ushort *)(pbVar16 + ((ulonglong)uVar24 - 2));
if (uVar24 - uVar6 < (uint)uVar2) {
return (byte *)0x80090308;
}
bVar4 = (byte)(uVar2 >> 8);
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
pbVar16[3] = bVar4;
pbVar16[4] = (byte)uVar2;
}
else {
pbVar16[0xb] = bVar4;
pbVar16[0xc] = (byte)uVar2;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x26,&DAT_180082c58);
}
pbVar7 = (byte *)FUN_180011ff0(param_1,(int *)&uStack_750);
if ((int)pbVar7 != 0) {
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
return pbVar7;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x27,&DAT_180082c58);
}
}
if ((*(uint *)(param_1 + 8) & 0x3000) == 0) {
puVar14 = (undefined *)(ulonglong)local_7b8;
uVar26 = local_res20;
}
else {
bVar4 = *pbVar16;
uVar26 = (uint)bVar4;
local_res20 = (uint)bVar4;
puVar14 = (undefined *)(ulonglong)local_res20;
if (bVar4 == 0x14) {
FUN_18005b470(param_1,0x388,0x80090326,10);
return (byte *)0x80090326;
}
}
}
uVar13 = uVar5;
if ((*(byte *)(param_1 + 4) & 2) != 0) {
uVar13 = *(uint *)((longlong)param_1 + 0x2c);
}
if ((pbVar16[1] == 0xfe) && (CONCAT11(pbVar16[1],pbVar16[2]) < 0xff00)) {
bVar4 = pbVar16[0xb];
bVar18 = pbVar16[0xc];
}
else {
bVar4 = pbVar16[3];
bVar18 = pbVar16[4];
}
uVar24 = (uint)CONCAT11(bVar4,bVar18);
if (uVar25 < uVar24 + uVar6 + uVar13) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return (byte *)0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return (byte *)0x80090326;
}
uVar12 = 0x28;
goto LAB_18003ba69;
}
pbVar16 = pbVar16 + (uVar6 + uVar13);
}
if (((uVar26 - 0x14 & 0xfffffffc) == 0) && (uVar26 != 0x15)) {
*(undefined *)((longlong)param_1 + 0x1d9) = 0;
}

pbVar7 = (byte *)(ulonglong)uVar24;
if (uVar24 != 0) {
if ((*(uint *)(param_1 + 0x11) >> 0x12 & 1) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x29,&DAT_180082c58);
}
*(undefined4 *)(param_2 + 4) = local_77c;
return pbVar7;
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cdc(DAT_180091000[2],0x2a,&DAT_180082c58,uVar24);
return pbVar7;
}
return pbVar7;
}
return pbVar7;
}
if (local_7b0 != (byte *)0x0) {
FUN_18006f734(local_7b0);
}
uVar24 = 0;
if (((*(uint *)(param_1 + 8) & 0x3000) != 0) && (local_res20 == 0x14)) break;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') goto LAB_180011c40;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
pbVar16 = &DAT_180082c58;
puVar14 = (undefined *)0x36;
FUN_180041cb0(DAT_180091000[2],0x36,&DAT_180082c58);
}
local_7b0 = (byte *)FUN_180072f28((undefined8 *)param_1[0x49],puVar14,pbVar16);
pbVar16 = pbVar8;
pbVar7 = pbVar8;
local_7b8 = local_res20;
if (local_7b0 != (byte *)0x0) {
pbVar16 = *(byte **)(local_7b0 + 0x28);
pbVar7 = (byte *)(ulonglong)*(uint *)(local_7b0 + 0x14);
local_7b8 = *(uint *)(local_7b0 + 0x40);
}
uVar24 = (uint)pbVar7;
puVar14 = (undefined *)(ulonglong)local_7b8;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x37,&DAT_180082c58,local_7b8);
pbVar8 = (byte *)FUN_180011c2d((longlong)DAT_180091000,local_7b0);
return pbVar8;
}
if (pbVar16 == (byte *)0x0) goto LAB_180011c40;
puVar19 = (undefined *)(ulonglong)local_res20;
}

if (uVar5 != 0) {
if ((uVar5 != 0x80090326) && (uVar5 != 0x80090308)) {
return (byte *)(ulonglong)uVar5;
}
FUN_18005b470(param_1,0x388,uVar5,10);
return (byte *)(ulonglong)uVar5;
}
}
}
else {

uVar24 = 0;
if (uVar5 != 0) {
if ((uVar5 == 0x80090326) || (uVar5 == 0x80090308)) {
FUN_18005b470(param_1,0x388,uVar5,10);
}
return (byte *)(ulonglong)uVar5;
}
}
LAB_180011c40:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x2b,&DAT_180082c58,uVar24);
}
iVar21 = *(int *)((longlong)param_1 + 0x44);
local_798 = local_798 + (uVar15 + uVar6);
local_7a4 = local_7a4 - (uVar15 + uVar6);
pbVar16 = pbVar8;
if (iVar21 - 0x5bU < 0xc) {
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
pbVar8 = (byte *)FUN_180011f40(param_1,param_3);
return pbVar8;
}
uVar9 = FUN_180011f40(param_1,&local_790);
iVar21 = *(int *)((longlong)param_1 + 0x44);
pbVar16 = (byte *)(uVar9 & 0xffffffff);
}
local_7b8 = (uint)pbVar16;
if (((iVar21 == 4) || (iVar21 == 0x4f)) || (local_7a4 == 0)) goto LAB_180011efd;
}
if (local_7a8 == 0) {
*(uint *)(param_2 + 4) = local_780;
FUN_180012184((longlong)param_1,0xd,-0x7ff6fce8);
return (byte *)0x80090318;
}
pbVar16 = (byte *)(ulonglong)local_7b8;
LAB_180011efd:
if (((*(char *)((longlong)param_1 + 0xe9) != '\0') && ((int)pbVar16 == 0)) && (local_788 != 0)) {
uVar6 = FUN_18006f874(param_1,(undefined4 *)&local_790,param_3);
pbVar16 = (byte *)(ulonglong)uVar6;
}
return pbVar16;
}
=========================================
Function at address: 0x180011c2d
Called functions addresses: 0x180011ff0 0x180012184 0x180028d90 0x180011f40


ulonglong FUN_180011c2d(longlong param_1,byte *param_2)

{
byte bVar1;
ushort uVar2;
longlong lVar3;
byte bVar4;
int iVar5;
uint uVar6;
ulonglong uVar7;
undefined4 *puVar8;
uint uVar9;
undefined2 uVar10;
int iVar11;
uint uVar12;
byte *pbVar13;
ulonglong uVar14;
longlong *unaff_RBX;
void *unaff_RBP;
uint uVar15;
byte *unaff_RSI;
char cVar16;
byte *unaff_RDI;
char cVar17;
undefined *puVar18;
undefined *in_R11;
longlong lVar19;
longlong lVar20;
uint unaff_R12D;
longlong unaff_R13;
byte *pbVar21;
uint uVar22;
ulonglong unaff_R15;
undefined4 uStack0000000000000030;
undefined8 uStack0000000000000038;
undefined8 uStack0000000000000040;
undefined4 uStack0000000000000048;
undefined4 uStack0000000000000050;
undefined4 uStack0000000000000058;
undefined4 uStack0000000000000060;
undefined4 uStack0000000000000068;
uint uStack0000000000000070;
uint uStack0000000000000078;
undefined8 uStack0000000000000080;
undefined4 uStack0000000000000088;
uint uStack0000000000000090;
undefined4 uStack0000000000000098;

code_r0x000180011c2d:
uVar15 = (uint)unaff_R15;
cVar16 = (char)unaff_RDI;
uVar6 = (uint)unaff_RDI;
if (unaff_RSI != (byte *)0x0) {
uVar9 = *(uint *)((longlong)unaff_RBP + 0x758);
goto LAB_180011b86;
}
LAB_180011c39:
pbVar21 = *(byte **)((longlong)unaff_RBP + -0x60);
LAB_180011c3d:
iVar5 = *(int *)((longlong)unaff_RBP + -0x7c);
do {
if ((param_1 != unaff_R13) && ((*(byte *)(param_1 + 0x1c) & 4) != 0)) {
FUN_1800432ec(*(undefined8 *)(param_1 + 0x10),0x2b,&DAT_180082c58,(int)unaff_R15);
param_1 = DAT_180091000;
}
iVar11 = *(int *)((longlong)unaff_RBX + 0x44);
pbVar21 = pbVar21 + (iVar5 + unaff_R12D);
uVar15 = *(int *)((longlong)unaff_RBP + -0x6c) - (iVar5 + unaff_R12D);
*(byte **)((longlong)unaff_RBP + -0x60) = pbVar21;
*(uint *)((longlong)unaff_RBP + -0x6c) = uVar15;
if (iVar11 - 0x5bU < 0xc) {
if (*(char *)((longlong)unaff_RBX + 0xe9) == cVar16) {
uVar7 = FUN_180011f40(unaff_RBX,*(undefined8 *)((longlong)unaff_RBP + 0x750));
return uVar7;
}
uVar7 = FUN_180011f40(unaff_RBX,(longlong)unaff_RBP + -0x58);
iVar11 = *(int *)((longlong)unaff_RBX + 0x44);
uVar7 = uVar7 & 0xffffffff;
param_1 = DAT_180091000;
}
else {
uVar7 = (ulonglong)unaff_RDI & 0xffffffff;
}
*(int *)((longlong)unaff_RBP + -0x80) = (int)uVar7;
if (((iVar11 == 4) || (iVar11 == 0x4f)) || (uVar15 == 0)) {
LAB_180011efd:
if (*(char *)((longlong)unaff_RBX + 0xe9) == cVar16) {
return uVar7;
}
if ((int)uVar7 == 0) {
if (*(byte **)((longlong)unaff_RBP + -0x50) != unaff_RDI) {
uVar6 = FUN_18006f874(unaff_RBX,(undefined4 *)((longlong)unaff_RBP + -0x58),
*(uint **)((longlong)unaff_RBP + 0x750));
return (ulonglong)uVar6;
}
return uVar7;
}
return uVar7;
}
lVar19 = *(longlong *)((longlong)unaff_RBP + 0x748);
if ((param_1 != unaff_R13) && ((*(byte *)(param_1 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(param_1 + 0x10),0xe,&DAT_180082c58);
uVar7 = (ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
param_1 = DAT_180091000;
}
if (uVar15 < unaff_R12D) {
if (*(uint *)((longlong)unaff_RBP + -0x70) == uVar6) {
*(uint *)(lVar19 + 4) = unaff_R12D;
lVar19 = unaff_RBX[0x10];
if (*(short *)(lVar19 + 0x22) == (short)unaff_RDI) {
*(undefined2 *)(lVar19 + 0x22) = 0xd;
*(undefined4 *)(lVar19 + 0x24) = 0x80090318;
}
memset(unaff_RBP,0,0x6e8);
cVar16 = DAT_1800927ac;
lVar19 = unaff_RBX[1];
if (lVar19 != 0) {
unaff_RDI = (byte *)(ulonglong)*(uint *)(lVar19 + 0x1c);
}
uVar2 = *(ushort *)((longlong)unaff_RBX + 0x22);
lVar3 = unaff_RBX[0x11];
*(undefined4 *)((longlong)unaff_RBP + 0xc) = *(undefined4 *)(unaff_RBX + 2);
*(int *)((longlong)unaff_RBP + 8) = (int)unaff_RDI;
if ((lVar19 != 0) && (unaff_RBX[0xb] != 0)) {
lVar20 = unaff_RBX[0xf];
iVar5 = *(int *)(lVar19 + 0x20);
if (((lVar20 != 0) && (cVar16 != '\0')) &&
(((*(undefined4 *)(lVar20 + 0x30) = *(undefined4 *)(unaff_RBX[0xb] + 8),
iVar5 == 0xaa02 || (iVar5 == 0xa400)) &&
(puVar8 = FUN_180059d38(iVar5), puVar8 != (undefined4 *)0x0)))) {
*(undefined4 *)(lVar20 + 0x34) = puVar8[8];
*(undefined4 *)(lVar20 + 0x38) = puVar8[10];
if (iVar5 == 0xaa02) {
*(undefined4 *)(lVar20 + 0x3c) = puVar8[0xc];
}
}
}
lVar19 = unaff_RBX[0xf];
if ((lVar19 != 0) && (cVar16 != '\0')) {
*(int *)(lVar19 + 0x24) =
(int)((ulonglong)*(undefined8 *)((longlong)unaff_RBP + 8) >> 0x20);
*(undefined4 *)(lVar19 + 0x68) = 0x80090318;
*(undefined4 *)(lVar19 + 0x70) = 0xd;
*(int *)(lVar19 + 0x20) = (int)unaff_RDI;
*(uint *)(lVar19 + 0x28) = (uint)uVar2;
*(longlong *)(lVar19 + 0x80) = lVar3;
lVar19 = unaff_RBX[0xf];
}
if (((lVar19 != 0) && (cVar16 != '\0')) &&
((DAT_180091000 != unaff_R13 && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)))) {
uStack0000000000000098 = *(undefined4 *)(lVar19 + 0x70);
uStack0000000000000088 = *(undefined4 *)(lVar19 + 0x68);
uStack0000000000000090 = (uint)*(byte *)(lVar19 + 0x6c);
uStack0000000000000080 = *(undefined8 *)(lVar19 + 0x60);
uStack0000000000000068 = *(undefined4 *)(lVar19 + 0x30);
uStack0000000000000078 = (uint)*(ushort *)(lVar19 + 0x42);
uStack0000000000000070 = (uint)*(ushort *)(lVar19 + 0x40);
uStack0000000000000060 = *(undefined4 *)(lVar19 + 0x2c);
uStack0000000000000058 = *(undefined4 *)(lVar19 + 0x28);
uStack0000000000000050 = *(undefined4 *)(lVar19 + 0x24);
uStack0000000000000048 = *(undefined4 *)(lVar19 + 0x20);
uStack0000000000000040 = *(undefined8 *)(lVar19 + 0x80);
uStack0000000000000038 = *(undefined8 *)(lVar19 + 0x78);
uStack0000000000000030 = *(undefined4 *)(lVar19 + 0x18);
FUN_180053180(*(undefined8 *)(DAT_180091000 + 0x10),(ulonglong)*(ushort *)(lVar19 + 0x42),
(ulonglong)*(ushort *)(lVar19 + 0x40),L"Error",(wchar_t *)(lVar19 + 0x98),
(wchar_t *)(lVar19 + 0x298));
}
return 0x80090318;
}
goto LAB_180011efd;
}
bVar4 = *pbVar21;
puVar18 = (undefined *)(ulonglong)bVar4;
*(uint *)((longlong)unaff_RBP + 0x758) = (uint)bVar4;
if (3 < bVar4 - 0x14) {
FUN_18005b470(unaff_RBX,10,0x80090308,10);
return 0x80090308;
}
bVar4 = pbVar21[1];
bVar1 = pbVar21[2];
if ((param_1 != unaff_R13) && ((*(byte *)(param_1 + 0x1c) & 4) != 0)) {
FUN_180041cdc(*(undefined8 *)(param_1 + 0x10),0xf,&DAT_180082c58,(uint)CONCAT11(bVar4,bVar1));
puVar18 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
param_1 = DAT_180091000;
}
if (CONCAT11(bVar4,bVar1) < 0x300) {
if ((0x301 < *(uint *)((longlong)unaff_RBX + 0x24)) &&
((*(uint *)(unaff_RBX + 8) & 0x800a00aa) != 0)) {
FUN_180012184((longlong)unaff_RBX,0xb,-0x7ff6fcda);
return 0x80090326;
}
FUN_18005b470(unaff_RBX,0xb,0x80090308,0x46);
return 0x80090308;
}
if ((pbVar21[1] == 0xfe) && (CONCAT11(pbVar21[1],pbVar21[2]) < 0xff00)) {
bVar4 = pbVar21[0xb];
bVar1 = pbVar21[0xc];
}
else {
bVar4 = pbVar21[3];
bVar1 = pbVar21[4];
}
uVar15 = (uint)CONCAT11(bVar4,bVar1);
*(uint *)((longlong)unaff_RBP + -0x7c) = uVar15;
if ((param_1 != unaff_R13) && ((*(byte *)(param_1 + 0x1c) & 4) != 0)) {
FUN_180041cdc(*(undefined8 *)(param_1 + 0x10),0x10,&DAT_180082c58,uVar15);
puVar18 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
}
uVar9 = uVar15 + unaff_R12D;
*(uint *)((longlong)unaff_RBP + -0x48) = uVar9;
if (*(uint *)((longlong)unaff_RBP + -0x6c) < uVar9) {
if (*(uint *)((longlong)unaff_RBP + -0x70) == uVar6) {
*(uint *)(lVar19 + 4) = uVar9;
FUN_180012184((longlong)unaff_RBX,0xd,-0x7ff6fce8);
return 0x80090318;
}
uVar7 = (ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
goto LAB_180011efd;
}
iVar5 = *(int *)((longlong)unaff_RBP + -0x70) + uVar9;
*(int *)(lVar19 + 4) = iVar5;
*(int *)((longlong)unaff_RBP + -0x70) = iVar5;
if (*(char *)((longlong)unaff_RBX + 0xe9) != cVar16) {
uVar2 = CONCAT11(pbVar21[3],pbVar21[4]);
*(uint *)((longlong)unaff_RBP + -0x80) = uVar6;
bVar4 = pbVar21[5];
*(byte **)((longlong)unaff_RBP + -0x78) = unaff_RDI;
*(ulonglong *)((longlong)unaff_RBP + -0x40) =
CONCAT71(CONCAT61(CONCAT51(CONCAT41(CONCAT31(CONCAT21(uVar2,bVar4),pbVar21[6]),pbVar21[7]
),pbVar21[8]),pbVar21[9]),pbVar21[10]);
uVar7 = (ulonglong)uVar2;
*(ulonglong *)((longlong)unaff_RBP + -0x68) = uVar7;
if (DAT_180091000 != unaff_R13) {
if ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041d20(*(undefined8 *)(DAT_180091000 + 0x10),0x11,&DAT_180082c58,(uint)uVar2,
(char)*(undefined8 *)((longlong)unaff_RBP + -0x40));
puVar18 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
uVar7 = *(ulonglong *)((longlong)unaff_RBP + -0x68);
}
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18006a8f8(*(undefined8 *)(DAT_180091000 + 0x10),0x12,&DAT_180082c58,
*(undefined4 *)(unaff_RBX + 0x18),
(char)*(undefined2 *)((longlong)unaff_RBX + 0xdc),
(char)*(undefined4 *)unaff_RBX[0x1c]);
puVar18 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
uVar7 = *(ulonglong *)((longlong)unaff_RBP + -0x68);
}
}
uVar12 = (uint)uVar7;
cVar17 = (char)puVar18;
pbVar13 = unaff_RDI;
uVar22 = uVar6;
uVar9 = uVar6;
if (*(char *)((longlong)unaff_RBP + 0x740) != cVar16) {
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x13,&DAT_180082c58);
cVar17 = (char)*(undefined4 *)((longlong)unaff_RBP + 0x758);
uVar12 = (uint)*(undefined8 *)((longlong)unaff_RBP + -0x68);
}
if ((uVar12 < *(uint *)(unaff_RBX + 0x18)) && (cVar17 == '\x14')) {
if (DAT_180091000 == unaff_R13) goto LAB_18003b86d;
if ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0) {
uVar10 = 0x14;
LAB_18003b835:
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),uVar10,&DAT_180082c58);
}
LAB_18003b84c:
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x1b,&DAT_180082c58);
}
LAB_18003b86d:
FUN_180044ee8(*(uint *)(unaff_RBX[10] + 0xd4));
FUN_180073a40(unaff_RBX[0x48]);
uVar7 = FUN_180070304((longlong)unaff_RBX);
uVar14 = uVar7 & 0xffffffff;
if ((int)uVar7 != 0) {
if (DAT_180091000 == unaff_R13) {
return uVar14;
}
if ((*(byte *)(DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x1c,&DAT_180082c58);
return uVar14;
}
return uVar14;
}
unaff_RBX[0x11] = unaff_RBX[0x11] & 0xffffffffbfffffff;
iVar5 = *(int *)((longlong)unaff_RBP + -0x80);
*(undefined *)((longlong)unaff_RBX + 0x109) = 1;
*(undefined4 *)((longlong)unaff_RBX + 0x44) = 4;
if ((iVar5 == 0) && (*(char *)((longlong)unaff_RBX + 0x10a) == '\0')) {
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x1d,&DAT_180082c58);
}
uVar6 = FUN_180012e50(unaff_RBX,1);
uVar7 = (ulonglong)uVar6;
if (uVar6 != 0) {
if (DAT_180091000 == unaff_R13) {
return uVar7;
}
if ((*(byte *)(DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cdc(*(undefined8 *)(DAT_180091000 + 0x10),0x1e,&DAT_180082c58,uVar6);
return uVar7;
}
return uVar7;
}
}
uVar7 = FUN_18006ffcc(unaff_RBX,*(uint **)((longlong)unaff_RBP + 0x750));
return uVar7;
}
if (uVar12 == *(uint *)(unaff_RBX + 0x18)) {
if (cVar17 == '\x17') {
if (DAT_180091000 == unaff_R13) goto LAB_18003b86d;
if ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0) {
uVar10 = 0x15;
goto LAB_18003b835;
}
goto LAB_18003b84c;
}
if ((((cVar17 == '\x16') && ((*(byte *)(unaff_RBX + 4) & 2) != 0)) && (unaff_RBX[1] != 0))
&& (*(uint *)(unaff_RBX[1] + 0x1c) != uVar6)) {
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x16,&DAT_180082c58);
}
*(uint *)((longlong)unaff_RBP + -0x38) = uVar15 + unaff_R12D;
*(uint *)((longlong)unaff_RBP + -0x34) = uVar15 + unaff_R12D;
*(byte **)((longlong)unaff_RBP + -0x30) = pbVar21;
uVar7 = FUN_180011ff0(unaff_RBX,(int *)((longlong)unaff_RBP + -0x38));
if ((int)uVar7 != 0) {
if (DAT_180091000 == unaff_R13) {
return 0x90312;
}
if ((*(byte *)(DAT_180091000 + 0x1c) & 1) == 0) {
return 0x90312;
}
uVar10 = 0x17;
goto LAB_18003b9be;
}
bVar4 = *(byte *)(unaff_RBX + 4);
uVar9 = 1;
*(undefined4 *)((longlong)unaff_RBP + -0x80) = 1;
if ((bVar4 & 2) == 0) {
uVar7 = (ulonglong)unaff_RDI & 0xffffffff;
}
else {
uVar7 = (ulonglong)*(uint *)((longlong)unaff_RBX + 0x2c);
}
if ((pbVar21[1] == 0xfe) && (CONCAT11(pbVar21[1],pbVar21[2]) < 0xff00)) {
bVar4 = pbVar21[0xb];
bVar1 = pbVar21[0xc];
}
else {
bVar4 = pbVar21[3];
bVar1 = pbVar21[4];
}
uVar22 = (uint)CONCAT11(bVar4,bVar1);
if (uVar15 < uVar22 + unaff_R12D + (int)uVar7) {
if (DAT_180091000 == unaff_R13) {
return 0x80090326;
}
if ((*(byte *)(DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar10 = 0x18;
goto LAB_18003ba69;
}
pbVar13 = pbVar21 + uVar7 + unaff_R12D;
*(byte **)((longlong)unaff_RBP + -0x78) = pbVar13;
if (uVar22 == 0) {
if (DAT_180091000 == unaff_R13) {
return 0x80090326;
}
if ((*(byte *)(DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar10 = 0x19;
goto LAB_18003ba69;
}
if (*pbVar13 == 0x14) {
if (DAT_180091000 == unaff_R13) goto LAB_18003b86d;
if ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0) {
uVar10 = 0x1a;
goto LAB_18003b835;
}
goto LAB_18003b84c;
}
uVar12 = (uint)*(undefined8 *)((longlong)unaff_RBP + -0x68);
}
}
}
if ((*(int *)((longlong)unaff_RBX + 0x44) == 0x4c) &&
(*(char *)((longlong)unaff_RBX + 0xe9) != cVar16)) {
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x1f,&DAT_180082c58);
uVar9 = *(uint *)((longlong)unaff_RBP + -0x80);
uVar12 = (uint)*(undefined8 *)((longlong)unaff_RBP + -0x68);
}
*(int *)(unaff_RBX[0x49] + 0x24) =
(int)*(short *)(*(longlong *)(unaff_RBX[0x49] + 0x28) + 0xc0);
pbVar13 = *(byte **)((longlong)unaff_RBP + -0x78);
}
if ((((*(byte *)(unaff_RBX + 4) & 2) == 0) || (unaff_RBX[1] == 0)) ||
(*(uint *)(unaff_RBX[1] + 0x1c) == uVar6)) {
if (uVar9 == 0) {
LAB_18003b38f:
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x24,&DAT_180082c58);
}
pbVar13 = pbVar21 + unaff_R12D;
uVar22 = uVar15;
}
}
else if (uVar9 == 0) {
if (uVar12 != *(uint *)(unaff_RBX[0x49] + 0x24)) goto LAB_18003b38f;
if (uVar12 < *(uint *)(unaff_RBX + 0x18)) {
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x20,&DAT_180082c58);
}
FUN_180044e9c(*(uint *)(unaff_RBX[10] + 0xd4));
return 0x90312;
}
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x21,&DAT_180082c58);
}
*(uint *)((longlong)unaff_RBP + -0x28) = uVar15 + unaff_R12D;
*(uint *)((longlong)unaff_RBP + -0x24) = uVar15 + unaff_R12D;
*(byte **)((longlong)unaff_RBP + -0x20) = pbVar21;
uVar7 = FUN_180011ff0(unaff_RBX,(int *)((longlong)unaff_RBP + -0x28));
if ((int)uVar7 != 0) {
if (DAT_180091000 == unaff_R13) {
return 0x90312;
}
if ((*(byte *)(DAT_180091000 + 0x1c) & 1) == 0) {
return 0x90312;
}
uVar10 = 0x22;
LAB_18003b9be:
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),uVar10,&DAT_180082c58);
return 0x90312;
}
if ((*(byte *)(unaff_RBX + 4) & 2) == 0) {
uVar7 = (ulonglong)unaff_RDI & 0xffffffff;
}
else {
uVar7 = (ulonglong)*(uint *)((longlong)unaff_RBX + 0x2c);
}
if ((pbVar21[1] == 0xfe) && (CONCAT11(pbVar21[1],pbVar21[2]) < 0xff00)) {
bVar4 = pbVar21[0xb];
bVar1 = pbVar21[0xc];
}
else {
bVar4 = pbVar21[3];
bVar1 = pbVar21[4];
}
if (uVar15 < CONCAT11(bVar4,bVar1) + unaff_R12D + (int)uVar7) {
if (DAT_180091000 == unaff_R13) {
return 0x80090326;
}
if ((*(byte *)(DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar10 = 0x23;
goto LAB_18003ba69;
}
pbVar13 = pbVar21 + uVar7 + unaff_R12D;
uVar22 = (uint)CONCAT11(bVar4,bVar1);
}
FUN_180072adc((longlong *)unaff_RBX[0x49],(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758),
pbVar13,uVar22,*(ulonglong *)((longlong)unaff_RBP + -0x40));
puVar18 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
uVar9 = *(uint *)((longlong)unaff_RBP + -0x48);
}
uVar15 = *(uint *)(unaff_RBX + 8);
*(byte **)((longlong)unaff_RBP + -0x78) = unaff_RDI;
*(int *)((longlong)unaff_RBP + -0x80) = (int)puVar18;
unaff_R15 = (ulonglong)unaff_RDI & 0xffffffff;
if (((uVar15 & 0x3000) == 0) || ((char)puVar18 != '\x14')) break;
iVar5 = *(int *)((longlong)unaff_RBP + -0x7c);

if (uVar15 != 0) {
if ((uVar15 == 0x80090326) || (uVar15 == 0x80090308)) {
FUN_18005b470(unaff_RBX,0x388,uVar15,10);
}
return (ulonglong)uVar15;
}
unaff_R15 = (ulonglong)unaff_RDI & 0xffffffff;
param_1 = DAT_180091000;
} while( true );
if (*(char *)((longlong)unaff_RBX + 0xe9) == cVar16) {
unaff_R15 = (ulonglong)uVar9;
param_2 = unaff_RDI;
unaff_RSI = pbVar21;
in_R11 = puVar18;
}
else {
pbVar13 = unaff_RDI;
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
puVar18 = &DAT_180082c58;
pbVar13 = (byte *)0x36;
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x36,&DAT_180082c58);
}
param_2 = (byte *)FUN_180072f28((undefined8 *)unaff_RBX[0x49],pbVar13,puVar18);
*(byte **)((longlong)unaff_RBP + -0x78) = param_2;
if (param_2 == (byte *)0x0) {
uVar15 = *(uint *)((longlong)unaff_RBP + -0x80);
unaff_RSI = unaff_RDI;
}
else {
uVar15 = *(uint *)(param_2 + 0x40);
unaff_RSI = *(byte **)(param_2 + 0x28);
unaff_R15 = (ulonglong)*(uint *)(param_2 + 0x14);
*(uint *)((longlong)unaff_RBP + -0x80) = uVar15;
}
in_R11 = (undefined *)(ulonglong)uVar15;
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(*(undefined8 *)(DAT_180091000 + 0x10),0x37,&DAT_180082c58,uVar15);
in_R11 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
param_2 = *(byte **)((longlong)unaff_RBP + -0x78);
}
puVar18 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
}
uVar9 = (uint)puVar18;
uVar15 = (uint)unaff_R15;
param_1 = DAT_180091000;
if (unaff_RSI != (byte *)0x0) goto LAB_180011b86;
goto LAB_180011c3d;
LAB_18003b692:
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
unaff_RSI = &DAT_180082c58;
uVar14 = 0x36;
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x36,&DAT_180082c58);
}
param_2 = (byte *)FUN_180072f28((undefined8 *)unaff_RBX[0x49],uVar14,unaff_RSI);
*(byte **)((longlong)unaff_RBP + -0x78) = param_2;
if (param_2 == (byte *)0x0) {
uVar6 = *(uint *)((longlong)unaff_RBP + -0x80);
unaff_RSI = unaff_RDI;
}
else {
uVar6 = *(uint *)(param_2 + 0x40);
unaff_RSI = *(byte **)(param_2 + 0x28);
unaff_R15 = (ulonglong)*(uint *)(param_2 + 0x14);
*(uint *)((longlong)unaff_RBP + -0x80) = uVar6;
}
in_R11 = (undefined *)(ulonglong)uVar6;
param_1 = DAT_180091000;
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(*(undefined8 *)(DAT_180091000 + 0x10),0x37,&DAT_180082c58,uVar6);
uVar7 = FUN_180011c2d(DAT_180091000,*(byte **)((longlong)unaff_RBP + -0x78));
return uVar7;
}
goto code_r0x000180011c2d;
LAB_180011b86:
if (((((*(byte *)(unaff_RBX + 4) & 2) == 0) || (unaff_RBX[1] == 0)) ||
(*(uint *)(unaff_RBX[1] + 0x1c) == uVar6)) ||
((*(char *)((longlong)unaff_RBX + 0xe9) != cVar16 &&
((param_2 == (byte *)0x0 || (*(uint *)(param_2 + 0x44) == uVar6)))))) {
if ((*(char *)((longlong)unaff_RBX + 0xe9) == cVar16) || ((int)in_R11 == 0x14)) {
unaff_RSI = unaff_RSI + unaff_R12D;
}
}
else {
iVar5 = *(int *)((longlong)unaff_RBX + 0x44);
*(uint *)((longlong)unaff_RBP + -0x18) = uVar15;
*(uint *)((longlong)unaff_RBP + -0x14) = uVar15;
*(byte **)((longlong)unaff_RBP + -0x10) = unaff_RSI;
if (((iVar5 - 0x4eU < 2) && (unaff_R12D < uVar15)) &&
((unaff_RSI != (byte *)0x0 && (*unaff_RSI == 0x16)))) {
if ((param_1 != unaff_R13) && ((*(byte *)(param_1 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(param_1 + 0x10),0x25,&DAT_180082c58);
uVar9 = *(uint *)((longlong)unaff_RBP + 0x758);
in_R11 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
}
uVar2 = *(ushort *)(unaff_RSI + ((ulonglong)uVar15 - 2));
if (uVar15 - unaff_R12D < (uint)uVar2) {
return 0x80090308;
}
bVar4 = (byte)(uVar2 >> 8);
if (*(char *)((longlong)unaff_RBX + 0xe9) == cVar16) {
unaff_RSI[3] = bVar4;
unaff_RSI[4] = (byte)uVar2;
}
else {
unaff_RSI[0xb] = bVar4;
unaff_RSI[0xc] = (byte)uVar2;
}
}
else {
if ((param_1 != unaff_R13) && ((*(byte *)(param_1 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(param_1 + 0x10),0x26,&DAT_180082c58);
}
uVar7 = FUN_180011ff0(unaff_RBX,(int *)((longlong)unaff_RBP + -0x18));
if ((int)uVar7 != 0) {
if (*(char *)((longlong)unaff_RBX + 0xe9) == cVar16) {
return uVar7;
}
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x27,&DAT_180082c58);
}
}
if ((*(uint *)(unaff_RBX + 8) & 0x3000) == 0) {
uVar9 = *(uint *)((longlong)unaff_RBP + 0x758);
in_R11 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
}
else {
bVar4 = *unaff_RSI;
uVar9 = (uint)bVar4;
*(uint *)((longlong)unaff_RBP + 0x758) = (uint)bVar4;
in_R11 = (undefined *)(ulonglong)(uint)bVar4;
if (bVar4 == 0x14) {
FUN_18005b470(unaff_RBX,0x388,0x80090326,10);
return 0x80090326;
}
}
}
uVar12 = uVar6;
if ((*(byte *)(unaff_RBX + 4) & 2) != 0) {
uVar12 = *(uint *)((longlong)unaff_RBX + 0x2c);
}
if ((unaff_RSI[1] == 0xfe) && (CONCAT11(unaff_RSI[1],unaff_RSI[2]) < 0xff00)) {
bVar4 = unaff_RSI[0xb];
bVar1 = unaff_RSI[0xc];
}
else {
bVar4 = unaff_RSI[3];
bVar1 = unaff_RSI[4];
}
if (uVar15 < CONCAT11(bVar4,bVar1) + unaff_R12D + uVar12) {
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 1) != 0)) {
uVar10 = 0x28;
LAB_18003ba69:
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),uVar10,&DAT_180082c58);
}
return 0x80090326;
}
unaff_RSI = unaff_RSI + (unaff_R12D + uVar12);
}
if (((uVar9 - 0x14 & 0xfffffffc) == 0) && (uVar9 != 0x15)) {
*(char *)((longlong)unaff_RBX + 0x1d9) = cVar16;
}
uVar14 = (ulonglong)in_R11 & 0xffffffff;

uVar7 = (ulonglong)uVar15;
if (uVar15 == 0) {
if (*(HLOCAL *)((longlong)unaff_RBP + -0x78) != (HLOCAL)0x0) {
FUN_18006f734(*(HLOCAL *)((longlong)unaff_RBP + -0x78));
}
uVar15 = *(uint *)(unaff_RBX + 8);
unaff_R15 = (ulonglong)unaff_RDI & 0xffffffff;
*(int *)((longlong)unaff_RBP + -0x80) = *(int *)((longlong)unaff_RBP + 0x758);
if (((uVar15 & 0x3000) == 0) || (*(int *)((longlong)unaff_RBP + 0x758) != 0x14)) {
param_1 = DAT_180091000;
if (*(char *)((longlong)unaff_RBX + 0xe9) != cVar16) goto LAB_18003b692;
goto LAB_180011c39;
}

uVar7 = (ulonglong)uVar15;
param_1 = DAT_180091000;
if (uVar15 == 0) goto LAB_180011c39;
if ((uVar15 == 0x80090326) || (uVar15 == 0x80090308)) {
FUN_18005b470(unaff_RBX,0x388,uVar15,10);
uVar7 = (ulonglong)uVar15;
}
}
else if ((*(uint *)(unaff_RBX + 0x11) >> 0x12 & 1) == 0) {
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(*(undefined8 *)(DAT_180091000 + 0x10),0x2a,&DAT_180082c58,uVar15);
}
}
else {
if ((DAT_180091000 != unaff_R13) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x29,&DAT_180082c58);
}
*(undefined4 *)(*(longlong *)((longlong)unaff_RBP + 0x748) + 4) =
*(undefined4 *)((longlong)unaff_RBP + -0x44);
}
return uVar7;
}
=========================================
Function at address: 0x180011f40
Called functions addresses: 0x180041cb0 0x18002a7c0


ulonglong FUN_180011f40(longlong *param_1,undefined8 param_2)

{
int iVar1;
uint uVar2;
ulonglong uVar3;
undefined2 uVar4;

if (param_1[0xb] == 0) {
return 0x54f;
}

if ((int)uVar3 != 0) {
return uVar3;
}
iVar1 = *(int *)((longlong)param_1 + 0x44);
if ((iVar1 < 0x50) || (0x5f < iVar1)) {
if (iVar1 == 2) {
LAB_18003bdb5:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2e,&DAT_180082c58);
}

uVar3 = (ulonglong)uVar2;
if (((*(uint *)(param_1 + 8) & 0x3000) != 0) && (*(int *)((longlong)param_1 + 0x44) == 2)) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4f;
goto LAB_180011fb8;
}
}
else {
if (iVar1 == 3) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar4 = 0x2f;
LAB_18003bd94:
FUN_180041cb0(DAT_180091000[2],uVar4,&DAT_180082c58);
}
LAB_18003bdab:
uVar3 = 0x80090317;
goto LAB_18003be73;
}
if (iVar1 == 5) goto LAB_18003bdb5;
if (iVar1 == 0x4f) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar4 = 0x30;
goto LAB_18003bd94;
}
goto LAB_18003bdab;
}
if (iVar1 != 0x60) goto LAB_180011f96;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2d,&DAT_180082c58);
}

(param_1,param_2,*(undefined *)(param_1 + 0xc),
*(undefined *)((longlong)param_1 + 0x61));
uVar3 = (ulonglong)uVar2;
*(undefined2 *)(param_1 + 0xc) = 0;
}
*(undefined4 *)((longlong)param_1 + 0x44) = 3;
}
else {
LAB_180011f96:

uVar3 = (ulonglong)uVar2;
}
LAB_180011fb8:
uVar2 = (uint)uVar3;
if (uVar2 == 0) {
return uVar3;
}
if ((int)uVar2 < 0) {
if (uVar2 == 0x80090318) {
return uVar3;
}
if (uVar2 == 0x80090321) {
return uVar3;
}
if (uVar2 == 0x8009036a) {
return uVar3;
}
if (uVar2 == 0x8009036b) {
return uVar3;
}
}
else if ((uVar2 & 0x1fff0000) == 0x90000) {
return uVar3;
}
LAB_18003be73:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x31,&DAT_180082c58);
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x60;
return uVar3;
}
=========================================
Function at address: 0x180011ff0
Called functions addresses: 0x180041cdc 0x18005b81c 0x180041cb0 0x18005b470 0x180012184 0xEXTERNAL:0000010a 0x18003c04c 0x180012e50


ulonglong FUN_180011ff0(longlong *param_1,int *param_2)

{
longlong lVar1;
undefined uVar2;
int iVar3;
uint uVar4;
ulonglong uVar5;
undefined8 uVar6;
undefined uVar7;
char cVar8;
undefined uVar9;
undefined uVar10;
int iVar11;
undefined unaff_R15B;
uint uVar12;
undefined uVar13;
undefined uVar14;
undefined in_stack_ffffffffffffffd0;

uVar6 = 0;
iVar3 = 0;
uVar12 = 0;
iVar11 = iVar3;
if ((*(ushort *)(param_1 + 4) & 2) != 0) {
iVar3 = *(int *)((longlong)param_1 + 0x2c);
iVar11 = *(int *)(param_1 + 6);
}
lVar1 = *(longlong *)(param_2 + 2);
cVar8 = ((char)*param_2 - (char)*(undefined4 *)((longlong)param_1 + 0x3c)) - (char)iVar3;
if ((*(char *)(lVar1 + 1) == -2) &&
(CONCAT11(*(char *)(lVar1 + 1),*(undefined *)(lVar1 + 2)) < 0xff00)) {
uVar2 = *(undefined *)(lVar1 + 0xb);
uVar13 = *(undefined *)(lVar1 + 0xc);
}
else {
uVar2 = *(undefined *)(lVar1 + 3);
uVar13 = *(undefined *)(lVar1 + 4);
}
if ((uint)CONCAT11(uVar2,uVar13) < (uint)(iVar11 + iVar3)) {
FUN_18005b470(param_1,0x3bf,0x80090326,0x32);
uVar5 = 0x80090326;
}
else {
if ((((param_1[0x12] == 0) && ((*(ushort *)(param_1 + 4) & 2) != 0)) && (param_1[1] != 0)) &&
(*(int *)(param_1[1] + 0x1c) != 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180085740);
}
uVar4 = FUN_180012e50(param_1,1);
if (uVar4 != 0) {
FUN_18005b470(param_1,0x3c1,uVar4,0x50);
return (ulonglong)uVar4;
}
}
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
uVar2 = (undefined)param_1[0x16];
}
else {
uVar2 = *(undefined *)(*(longlong *)(param_2 + 2) + 10);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18005b81c(DAT_180091000[2],0x10,&DAT_180085740,*param_2,uVar2);
}
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
uVar6 = *(undefined8 *)param_1[1];
}
uVar10 = (undefined)*param_2;
uVar13 = 8;
uVar9 = (undefined)*(undefined8 *)(param_2 + 2);
uVar7 = (undefined)param_1[0x12];
uVar14 = 0;
iVar3 = SslDecryptPacket(uVar6);
if (iVar3 == 0) {
if ((*(uint *)(param_1 + 8) & 0x3000) != 0) {
uVar5 = FUN_18003c04c((ulonglong)uVar12,uVar7,uVar9,uVar10,cVar8,uVar13,uVar2,uVar14,
in_stack_ffffffffffffffd0,unaff_R15B,uVar12);
return uVar5;
}
lVar1 = *(longlong *)(param_2 + 2);
uVar2 = (undefined)(uVar12 >> 8);
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
*(undefined *)(lVar1 + 3) = uVar2;
*(char *)(lVar1 + 4) = (char)uVar12;
param_1[0x16] = param_1[0x16] + 1;
}
else {
*(undefined *)(lVar1 + 0xb) = uVar2;
*(char *)(lVar1 + 0xc) = (char)uVar12;
}
uVar5 = 0;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x11,&DAT_180085740,iVar3);
}
if ((*(uint *)((longlong)param_1 + 0x24) < 0x302) ||
((*(uint *)(param_1 + 8) & 0x800a00aa) == 0)) {
FUN_18005b470(param_1,0x3c0,iVar3,0x14);
uVar5 = 0x80090330;
}
else {
FUN_180012184((longlong)param_1,0x3c2,iVar3);
uVar5 = 0x80090326;
}
}
}
return uVar5;
}
=========================================
Function at address: 0x180012184
Called functions addresses: 0x180012368 0x180012458 0x180028d90 0x1800124f0


void FUN_180012184(longlong param_1,undefined4 param_2,int param_3)

{
ushort uVar1;
uint uVar2;
longlong lVar3;
undefined8 uVar4;
undefined4 uVar5;
ulonglong uVar6;
undefined local_708 [8];
undefined4 local_700;
undefined4 uStack_6fc;

lVar3 = *(longlong *)(param_1 + 0x80);
if (*(short *)(lVar3 + 0x22) == 0) {
*(short *)(lVar3 + 0x22) = (short)param_2;
*(int *)(lVar3 + 0x24) = param_3;
}
uVar6 = 0x6e8;
memset(local_708,0,0x6e8);
lVar3 = *(longlong *)(param_1 + 8);
if (lVar3 == 0) {
local_700 = 0;
}
else {
local_700 = *(undefined4 *)(lVar3 + 0x1c);
}
uVar5 = local_700;
uStack_6fc = *(undefined4 *)(param_1 + 0x10);
uVar1 = *(ushort *)(param_1 + 0x22);
uVar4 = *(undefined8 *)(param_1 + 0x88);
if ((lVar3 != 0) && (*(longlong *)(param_1 + 0x58) != 0)) {
uVar2 = *(uint *)(*(longlong *)(param_1 + 0x58) + 8);
uVar6 = (ulonglong)uVar2;
FUN_180012458(*(longlong *)(param_1 + 0x78),*(int *)(lVar3 + 0x20),uVar2);
}
lVar3 = *(longlong *)(param_1 + 0x78);
if ((lVar3 != 0) && (DAT_1800927ac != '\0')) {
*(int *)(lVar3 + 0x68) = param_3;
*(undefined4 *)(lVar3 + 0x70) = param_2;
*(undefined4 *)(lVar3 + 0x20) = uVar5;
*(undefined4 *)(lVar3 + 0x24) = uStack_6fc;
*(uint *)(lVar3 + 0x28) = (uint)uVar1;
*(undefined8 *)(lVar3 + 0x80) = uVar4;
if (param_3 != -0x7ff6fce8) {
FUN_1800124f0(lVar3,'\x01',uVar6);
}
}
FUN_180012368(*(longlong *)(param_1 + 0x78),L"Error");
return;
}
=========================================
Function at address: 0x1800122b0
Called functions addresses: 0x180012368 0x1800123c0 0x18002a77b 0x180012458 0x180028d90 0x1800124a0


void FUN_1800122b0(longlong *param_1)

{
longlong lVar1;
undefined8 uVar2;
undefined local_de8 [8];
undefined4 local_de0;
undefined4 local_ddc;
uint local_dd8;
longlong local_d80;
undefined local_6f8 [1776];

FUN_1800124a0(param_1);
memset(local_de8,0,0x6e8);
lVar1 = param_1[1];
if (lVar1 != 0) {
local_de0 = *(undefined4 *)(lVar1 + 0x1c);
}
local_ddc = *(undefined4 *)(param_1 + 2);
local_dd8 = (uint)*(ushort *)((longlong)param_1 + 0x22);
local_d80 = param_1[0x11];
if ((lVar1 != 0) && (param_1[0xb] != 0)) {
FUN_180012458(param_1[0xf],*(int *)(lVar1 + 0x20),*(undefined4 *)(param_1[0xb] + 8));
}
uVar2 = 0x6e8;
memcpy(local_6f8,local_de8,0x6e8);
FUN_1800123c0(param_1[0xf],(longlong)local_6f8,uVar2);
FUN_180012368(param_1[0xf],L"Client");
return;
}
=========================================
Function at address: 0x180012368
Called functions addresses: 0x180053180


void FUN_180012368(longlong param_1,wchar_t *param_2)

{
if ((((param_1 != 0) && (DAT_1800927ac != '\0')) &&
((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180053180(DAT_180091000[2],(ulonglong)*(ushort *)(param_1 + 0x42),
(ulonglong)*(ushort *)(param_1 + 0x40),param_2,(wchar_t *)(param_1 + 0x98),
(wchar_t *)(param_1 + 0x298));
}
return;
}
=========================================
Function at address: 0x1800123c0
Called functions addresses: 0x1800124f0 0xEXTERNAL:00000083


void FUN_1800123c0(longlong param_1,longlong param_2,undefined8 param_3)

{
longlong lVar1;

if (param_1 == 0) {
return;
}
if (DAT_1800927ac != '\0') {
*(undefined4 *)(param_1 + 0x20) = *(undefined4 *)(param_2 + 8);
*(undefined4 *)(param_1 + 0x24) = *(undefined4 *)(param_2 + 0xc);
*(undefined4 *)(param_1 + 0x28) = *(undefined4 *)(param_2 + 0x10);
*(undefined8 *)(param_1 + 0x80) = *(undefined8 *)(param_2 + 0x68);
QueryPerformanceCounter((LARGE_INTEGER *)(param_1 + 0x58));
lVar1 = (*(longlong *)(param_1 + 0x58) - *(longlong *)(param_1 + 0x50)) * 1000;
*(longlong *)(param_1 + 0x60) = lVar1;
*(longlong *)(param_1 + 0x60) = lVar1 / DAT_180092ed8;
if (*(int *)(param_1 + 0x68) == -0x7ff6fce8) {
*(undefined4 *)(param_1 + 0x68) = 0;
*(undefined4 *)(param_1 + 0x70) = 0;
}
FUN_1800124f0(param_1,'\0',param_3);
}
return;
}
=========================================
Function at address: 0x180012458
Called functions addresses: 0x180059d38


void FUN_180012458(longlong param_1,int param_2,undefined4 param_3)

{
undefined4 *puVar1;
int iVar2;

if ((param_1 != 0) && (DAT_1800927ac != '\0')) {
iVar2 = 0xaa02;
*(undefined4 *)(param_1 + 0x30) = param_3;
if ((param_2 == 0xaa02) || (param_2 == 0xa400)) {
puVar1 = FUN_180059d38(param_2);
if (puVar1 != (undefined4 *)0x0) {
*(undefined4 *)(param_1 + 0x34) = puVar1[8];
*(undefined4 *)(param_1 + 0x38) = puVar1[10];
if (param_2 == iVar2) {
*(undefined4 *)(param_1 + 0x3c) = puVar1[0xc];
}
}
}
}
return;
}
=========================================
Function at address: 0x1800124a0
Called functions addresses: 0x18005b628 0x180072a90 0x18002a7c0


void FUN_1800124a0(longlong *param_1)

{
undefined2 uVar1;

*(undefined4 *)((longlong)param_1 + 0x44) = 4;

if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar1 = FUN_18005b628((longlong)param_1,(uint)*(ushort *)(param_1 + 0x1b));
*(undefined2 *)((longlong)param_1 + 0xda) = uVar1;
FUN_180072a90(param_1[0x49]);
*(undefined4 *)param_1[0x48] = 0;
*(undefined2 *)((longlong)param_1 + 0xdc) = 0;
}
return;
}
=========================================
Function at address: 0x1800124f0
Called functions addresses: 0x18001278c 0x180021540 0xEXTERNAL:00000037 0x180052cc4


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_1800124f0(longlong param_1,char param_2,undefined8 param_3)

{
wchar_t *_Str;
int iVar1;
wchar_t *pwVar2;
undefined local_res8 [8];
undefined local_res18 [8];
ushort local_res20 [4];
undefined2 local_a8;
undefined2 local_a6;
undefined4 local_a4;
undefined4 local_a0;
undefined4 local_9c;
undefined4 local_98;
undefined4 local_94;
undefined4 local_90;
undefined4 local_8c;
undefined4 local_88;
undefined4 local_84;
undefined4 local_80;
undefined4 local_7c;
undefined4 local_78 [2];
wchar_t *local_70;
wchar_t *local_68;
wchar_t *local_60;
undefined8 local_58;
longlong local_50;
ushort local_48;
undefined8 local_40;
wchar_t *local_38;
wchar_t *local_30;
wchar_t *local_28;
ushort local_20;

_Str = (wchar_t *)(param_1 + 0x98);
if (_Str != (wchar_t *)0x0) {
pwVar2 = wcsstr(_Str,L".data.microsoft.com");
if (pwVar2 != (wchar_t *)0x0) {
return;
}
pwVar2 = wcsstr(_Str,L".telemetry.microsoft.com");
if (pwVar2 != (wchar_t *)0x0) {
return;
}
}
iVar1 = *(int *)(param_1 + 0xc);
if (param_2 == '\0') {
if (iVar1 == 0) {
if (((5 < DAT_180091480) && ((_DAT_180091490 & 0x400000000000) != 0)) &&
((DAT_180091498 & 0x400000000000) == DAT_180091498)) {
local_78[0] = *(undefined4 *)(param_1 + 0x70);
local_res8[0] = *(undefined *)(param_1 + 0x6c);
local_7c = *(undefined4 *)(param_1 + 0x68);
local_80 = *(undefined4 *)(param_1 + 0x3c);
local_84 = *(undefined4 *)(param_1 + 0x38);
local_88 = *(undefined4 *)(param_1 + 0x34);
local_res20[0] = *(ushort *)(param_1 + 0x6f8);
local_8c = *(undefined4 *)(param_1 + 0x30);
local_90 = *(undefined4 *)(param_1 + 0x28);
local_94 = *(undefined4 *)(param_1 + 0x24);
local_50 = param_1 + 0x630;
local_98 = *(undefined4 *)(param_1 + 0x48);
local_9c = *(undefined4 *)(param_1 + 0x44);
local_a6 = *(undefined2 *)(param_1 + 0x42);
local_a8 = *(undefined2 *)(param_1 + 0x40);
local_58 = *(undefined8 *)(param_1 + 0x80);
local_60 = *(wchar_t **)(param_1 + 0x78);
local_res18[0] = *(undefined *)(param_1 + 0x18);
local_68 = (wchar_t *)(param_1 + 0x298);
local_a0 = *(undefined4 *)(param_1 + 0x20);
local_a4 = DAT_180092648;
local_38 = *(wchar_t **)(param_1 + 0x60);
local_40 = 1;
local_70 = _Str;
local_48 = local_res20[0];
local_30 = local_38;
local_28 = local_38;
FUN_18001278c((ulonglong)local_res20[0],&DAT_1800845be,param_3,&local_40,&local_38,&local_30
,&local_28,&local_70,&local_a4,&local_a0,&local_68,local_res18,&local_60,
&local_58,&local_a8,&local_a6,&local_9c,&local_98,&local_50,local_res20,
&local_94,&local_90,&local_8c,&local_88,&local_84,&local_80,&local_7c,
local_res8,local_78);
}
}
else if (iVar1 == 1) {
FUN_180021540(param_1);
}
}
else if (iVar1 == 0) {
if (((5 < DAT_180091480) && ((_DAT_180091490 & 0x400000000000) != 0)) &&
((DAT_180091498 & 0x400000000000) == DAT_180091498)) {
local_a4 = *(undefined4 *)(param_1 + 0x70);
local_res8[0] = *(undefined *)(param_1 + 0x6c);
local_a0 = *(undefined4 *)(param_1 + 0x68);
local_9c = *(undefined4 *)(param_1 + 0x3c);
local_98 = *(undefined4 *)(param_1 + 0x38);
local_94 = *(undefined4 *)(param_1 + 0x34);
local_res20[0] = *(ushort *)(param_1 + 0x6f8);
local_90 = *(undefined4 *)(param_1 + 0x30);
local_8c = *(undefined4 *)(param_1 + 0x28);
local_88 = *(undefined4 *)(param_1 + 0x24);
local_50 = param_1 + 0x630;
local_84 = *(undefined4 *)(param_1 + 0x48);
local_80 = *(undefined4 *)(param_1 + 0x44);
local_a8 = *(undefined2 *)(param_1 + 0x42);
local_a6 = *(undefined2 *)(param_1 + 0x40);
local_40 = *(undefined8 *)(param_1 + 0x80);
local_38 = *(wchar_t **)(param_1 + 0x78);
local_res18[0] = *(undefined *)(param_1 + 0x18);
local_30 = (wchar_t *)(param_1 + 0x298);
local_7c = *(undefined4 *)(param_1 + 0x20);
local_78[0] = DAT_180092648;
local_70 = *(wchar_t **)(param_1 + 0x60);
local_58 = 1;
local_68 = local_70;
local_60 = local_70;
local_48 = local_res20[0];
local_28 = _Str;
FUN_18001278c((ulonglong)local_res20[0],&DAT_1800843de,param_3,&local_58,&local_60,&local_68,
&local_70,&local_28,local_78,&local_7c,&local_30,local_res18,&local_38,&local_40
,&local_a6,&local_a8,&local_80,&local_84,&local_50,local_res20,&local_88,
&local_8c,&local_90,&local_94,&local_98,&local_9c,&local_a0,local_res8,&local_a4
);
}
}
else if ((((iVar1 == 1) && (5 < DAT_180091480)) && ((_DAT_180091490 & 0x400000000000) != 0)) &&
((DAT_180091498 & 0x400000000000) == DAT_180091498)) {
local_78[0] = *(undefined4 *)(param_1 + 0x62c);
local_50 = param_1 + 0x498;
local_48 = *(undefined2 *)(param_1 + 0x628);
local_7c = *(undefined4 *)(param_1 + 0x2c);
local_80 = *(undefined4 *)(param_1 + 0x70);
local_res8[0] = *(undefined *)(param_1 + 0x6c);
local_res20[0] = *(ushort *)(param_1 + 0x6f8);
local_84 = *(undefined4 *)(param_1 + 0x68);
local_88 = *(undefined4 *)(param_1 + 0x3c);
local_8c = *(undefined4 *)(param_1 + 0x38);
local_90 = *(undefined4 *)(param_1 + 0x34);
local_94 = *(undefined4 *)(param_1 + 0x30);
local_98 = *(undefined4 *)(param_1 + 0x28);
local_9c = *(undefined4 *)(param_1 + 0x24);
local_28 = (wchar_t *)(param_1 + 0x630);
local_a0 = *(undefined4 *)(param_1 + 0x48);
local_a4 = *(undefined4 *)(param_1 + 0x44);
local_a6 = *(undefined2 *)(param_1 + 0x42);
local_a8 = *(undefined2 *)(param_1 + 0x40);
local_58 = *(undefined8 *)(param_1 + 0x80);
local_60 = *(wchar_t **)(param_1 + 0x78);
local_res18[0] = *(undefined *)(param_1 + 0x18);
local_68 = (wchar_t *)(param_1 + 0x298);
local_70 = (wchar_t *)0x1;
local_20 = local_res20[0];
FUN_180052cc4((ulonglong)local_res20[0],&DAT_1800847a6,param_3,&local_70,&local_68,local_res18,
&local_60,&local_58,&local_a8,&local_a6,&local_a4,&local_a0,&local_28,local_res20,
&local_9c,&local_98,&local_94,&local_90,&local_8c,&local_88,&local_84,local_res8,
&local_80,&local_7c,&local_50,local_78);
}
return;
}
=========================================
Function at address: 0x18001278c
Called functions addresses: 0x180012af0 0x1800293fb 0x180027af0 0x180028070 0x180012dc8


void FUN_18001278c(undefined8 param_1,byte *param_2,undefined8 param_3,undefined8 param_4,
undefined8 param_5,undefined8 param_6,undefined8 param_7,undefined8 *param_8,
undefined8 param_9,undefined8 param_10,undefined8 *param_11,undefined8 param_12,
undefined8 param_13,undefined8 param_14,undefined8 param_15,undefined8 param_16,
undefined8 param_17,undefined8 param_18,undefined8 *param_19,undefined8 param_20,
undefined8 param_21,undefined8 param_22,undefined8 param_23,undefined8 param_24,
undefined8 param_25,undefined8 param_26,undefined8 param_27,undefined8 param_28,
undefined8 param_29)

{
longlong lVar1;
undefined8 uVar2;
longlong lVar3;
undefined auStackY_238 [32];
EVENT_DESCRIPTOR local_208;
undefined4 local_1f8;
_EVENT_DATA_DESCRIPTOR local_1e8;
ushort *local_1d8;
uint local_1d0;
undefined4 local_1cc;
undefined8 local_1c8;
undefined8 local_1c0;
undefined8 local_1b8;
undefined8 local_1b0;
undefined8 local_1a8;
undefined8 local_1a0;
undefined8 local_198;
undefined8 local_190;
undefined *local_188;
int local_180;
undefined4 local_17c;
undefined8 local_178;
undefined8 local_170;
undefined8 local_168;
undefined8 local_160;
undefined *local_158;
int local_150;
undefined4 local_14c;
undefined8 local_148;
undefined8 local_140;
undefined8 local_138;
undefined8 local_130;
undefined8 local_128;
undefined8 local_120;
undefined8 local_118;
undefined8 local_110;
undefined8 local_108;
undefined8 local_100;
undefined8 local_f8;
undefined8 local_f0;
undefined8 local_e8;
undefined8 local_e0;
ushort *local_d8;
undefined8 local_d0;
undefined8 local_c8;
int local_c0;
undefined4 local_bc;
undefined8 local_b8;
undefined8 local_b0;
undefined8 local_a8;
undefined8 local_a0;
undefined8 local_98;
undefined8 local_90;
undefined8 local_88;
undefined8 local_80;
undefined8 local_78;
undefined8 local_70;
undefined8 local_68;
undefined8 local_60;
undefined8 local_58;
undefined8 local_50;
undefined8 local_48;
undefined8 local_40;
undefined8 local_38;
undefined8 local_30;
undefined8 local_28;
undefined8 local_20;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_238;
local_28 = param_29;
local_38 = param_28;
local_150 = 2;
local_48 = param_27;
local_58 = param_26;
local_68 = param_25;
local_78 = param_24;
local_88 = param_23;
local_98 = param_22;
local_a8 = param_21;
local_b8 = param_20;
local_20 = 4;
local_30 = 1;
local_40 = 4;
local_d8 = (ushort *)(param_19 + 1);
local_50 = 4;
local_c8 = *param_19;
local_c0 = (uint)*local_d8 << 2;
local_e8 = param_18;
local_f8 = param_17;
local_108 = param_16;
local_118 = param_15;
local_128 = param_14;
local_138 = param_13;
local_148 = param_12;
lVar3 = -1;
local_60 = 4;
local_70 = 4;
local_158 = (undefined *)*param_11;
local_80 = 4;
local_90 = 4;
local_a0 = 4;
local_b0 = 2;
local_d0 = 2;
local_bc = 0;
local_e0 = 4;
local_f0 = 4;
local_100 = 2;
local_110 = 2;
local_120 = 8;
local_130 = 8;
local_140 = 1;
local_180 = 2;
if (local_158 == (undefined *)0x0) {
local_158 = &DAT_18008233c;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (*(short *)(local_158 + lVar1 * 2) != 0);
local_150 = (int)lVar1 * 2 + 2;
}
local_168 = param_10;
local_178 = param_9;
local_14c = 0;
local_188 = (undefined *)*param_8;
local_160 = 4;
local_170 = 4;
if (local_188 == (undefined *)0x0) {
local_188 = &DAT_18008233c;
}
else {
do {
lVar3 = lVar3 + 1;
} while (*(short *)(local_188 + lVar3 * 2) != 0);
local_180 = (int)lVar3 * 2 + 2;
}
local_198 = param_7;
local_1a8 = param_6;
local_1b8 = param_5;
local_208._0_4_ = (uint)*param_2 << 0x18;
local_208._4_4_ = ZEXT24(*(ushort *)(param_2 + 1));
local_17c = 0;
local_208.Keyword = *(ULONGLONG *)(param_2 + 3);
local_1d8 = (ushort *)(param_2 + 0xb);
local_1e8.Ptr = (ULONGLONG)PTR_DAT_180091488;
local_190 = 8;
local_1a0 = 8;
local_1b0 = 8;
local_1c0 = 8;
local_1e8.Size = (ULONG)*(ushort *)PTR_DAT_180091488;
local_1d0 = (uint)*local_1d8;
local_1e8.Reserved = 2;
local_1cc = 1;
local_1f8 = 0xbe9;
local_1c8 = param_4;
if (DAT_1800914a8 == FUN_180027af0) {
uVar2 = FUN_180012dc8(FUN_180027af0,(longlong)&local_1e8);
if ((byte)uVar2 == 0) {
EventWriteTransfer(DAT_1800914a0,&local_208,(LPCGUID)0x0,(LPCGUID)0x0,0x1d,&local_1e8);
}
else {
FUN_180012af0(0x180091480,(undefined8 *)&local_208,0x1d,(longlong)&local_1e8,(byte)uVar2);
}
}
FUN_180028070(local_18 ^ (ulonglong)auStackY_238);
return;
}
=========================================
Function at address: 0x180012af0
Called functions addresses: 0x180012d04 0x1800136a0 0xEXTERNAL:00000071 0xEXTERNAL:00000072 0x180012c27


ulonglong FUN_180012af0(longlong param_1,undefined8 *param_2,byte param_3,longlong param_4,
byte param_5)

{
int *piVar1;
longlong lVar2;
longlong lVar3;
longlong lVar4;
longlong lVar5;
uint uVar6;
int iVar7;
ulonglong uVar8;
byte bVar9;
ulonglong uVar10;
longlong *plVar11;
longlong lVar12;
longlong local_res8;
undefined8 *local_res10;

lVar4 = *(longlong *)(param_1 + 0x30);
lVar12 = 0;
local_res8 = 0;
uVar10 = 0;
local_res10 = param_2;
uVar6 = FUN_180012d04(param_5,param_3,param_4);
AcquireSRWLockShared((PSRWLOCK)(lVar4 + 0x108));
plVar11 = (longlong *)(lVar4 + (ulonglong)(uVar6 & 0x1f) * 8);
do {
if (*plVar11 == 0) {
if (0x3ff < *(uint *)(lVar4 + 0x100)) {
*(int *)(lVar4 + 300) = *(int *)(lVar4 + 300) + 1;
uVar10 = 0xea;
goto LAB_180012bf1;
}
if (lVar12 == 0) {
uVar8 = FUN_1800136a0(local_res10,param_3,param_4,param_5,uVar6,&local_res8);
uVar10 = uVar8 & 0xffffffff;
lVar12 = local_res8;
if (local_res8 == 0) {
if ((int)uVar8 == 8) {
*(int *)(lVar4 + 0x130) = *(int *)(lVar4 + 0x130) + 1;
}
else {
*(int *)(lVar4 + 0x134) = *(int *)(lVar4 + 0x134) + 1;
}
goto LAB_180012bf1;
}
}
LOCK();
lVar2 = *plVar11;
if (lVar2 == 0) {
*plVar11 = lVar12;
}
UNLOCK();
lVar12 = local_res8;
if (lVar2 == 0) {
local_res8 = 0;
LOCK();
piVar1 = (int *)(lVar4 + 0x100);
iVar7 = *piVar1;
*piVar1 = *piVar1 + 1;
UNLOCK();
if (iVar7 == 0) {
FUN_1800234bc(*(PTP_TIMER *)(lVar4 + 0x158),(ulonglong)*(uint *)(lVar4 + 0x160));
}
lVar12 = local_res8;
if (*(uint *)(lVar4 + 0x120) < *(uint *)(lVar4 + 0x100)) {
*(uint *)(lVar4 + 0x120) = *(uint *)(lVar4 + 0x100);
}
goto LAB_180012bf1;
}
}
lVar2 = *plVar11;
if (uVar6 == *(uint *)(lVar2 + 0x28)) {
iVar7 = FUN_1800138fc(param_3,param_4,lVar2);
}
else {
iVar7 = uVar6 - *(int *)(lVar2 + 0x28);
}
if (iVar7 == 0) {
if (lVar2 != 0) {
uVar8 = 2;
if (2 < param_5 + 2) {
do {
lVar12 = **(longlong **)(param_4 + uVar8 * 0x10);
bVar9 = *(byte *)(*(longlong *)(lVar2 + 0x10) + 0xd + uVar8 * 0x10);
plVar11 = *(longlong **)(*(longlong *)(lVar2 + 0x10) + uVar8 * 0x10);
if (bVar9 == 0x71) {
LOCK();
*plVar11 = *plVar11 + lVar12;
UNLOCK();
}
else if (bVar9 - 0x72 < 2) {
do {
if (bVar9 == 0x72) {
if (*plVar11 <= lVar12) break;
}
else if (lVar12 <= *plVar11) break;
lVar5 = *plVar11;
LOCK();
lVar3 = *plVar11;
if (lVar5 == lVar3) {
*plVar11 = lVar12;
}
UNLOCK();
} while (lVar5 != lVar3);
}
bVar9 = (char)uVar8 + 1;
uVar8 = (ulonglong)bVar9;
lVar12 = local_res8;
} while ((uint)bVar9 < param_5 + 2);
}
}
LAB_180012bf1:
ReleaseSRWLockShared((PSRWLOCK)(lVar4 + 0x108));
if (lVar12 != 0) {
FUN_180023334(lVar12);
}
return uVar10;
}
plVar11 = (longlong *)(lVar2 + 0x20 + ((longlong)iVar7 >> 0x3f & 0xfffffffffffffff8U));
} while( true );
}
=========================================
Function at address: 0x180012c27
Called functions addresses: 0x180023334 0x1800234bc 0x1800138fc 0x180012c27


ulonglong FUN_180012c27(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
undefined param_5,undefined param_6,undefined param_7,undefined param_8,
undefined param_9,undefined param_10,longlong param_11,byte param_12)

{
int *piVar1;
longlong lVar2;
longlong lVar3;
longlong lVar4;
longlong *plVar5;
longlong lVar6;
int iVar7;
ulonglong uVar8;
byte bVar9;
longlong unaff_RBX;
ulonglong unaff_RBP;
longlong *unaff_RSI;
longlong unaff_RDI;
byte unaff_R12B;
longlong unaff_R13;
int unaff_R14D;
undefined7 in_stack_00000031;
undefined8 *in_stack_00000078;

do {
do {
lVar3 = *unaff_RSI;
if (unaff_R14D == *(int *)(lVar3 + 0x28)) {
iVar7 = FUN_1800138fc(unaff_R12B,unaff_R13,lVar3);
}
else {
iVar7 = unaff_R14D - *(int *)(lVar3 + 0x28);
}
if (iVar7 == 0) {
if (lVar3 != 0) {
uVar8 = 2;
if (2 < param_12 + 2) {
do {
lVar4 = **(longlong **)(unaff_R13 + uVar8 * 0x10);
bVar9 = *(byte *)(*(longlong *)(lVar3 + 0x10) + 0xd + uVar8 * 0x10);
plVar5 = *(longlong **)(*(longlong *)(lVar3 + 0x10) + uVar8 * 0x10);
if (bVar9 == 0x71) {
LOCK();
*plVar5 = *plVar5 + lVar4;
UNLOCK();
}
else if (bVar9 - 0x72 < 2) {
do {
if (bVar9 == 0x72) {
if (*plVar5 <= lVar4) break;
}
else if (lVar4 <= *plVar5) break;
lVar6 = *plVar5;
LOCK();
lVar2 = *plVar5;
if (lVar6 == lVar2) {
*plVar5 = lVar4;
}
UNLOCK();
} while (lVar6 != lVar2);
}
bVar9 = (char)uVar8 + 1;
uVar8 = (ulonglong)bVar9;
unaff_RDI = param_11;
} while ((uint)bVar9 < param_12 + 2);
}
}
goto LAB_180012bf1;
}
unaff_RSI = (longlong *)(lVar3 + 0x20 + ((longlong)iVar7 >> 0x3f & 0xfffffffffffffff8U));
} while (*unaff_RSI != 0);
if (0x3ff < *(uint *)(unaff_RBX + 0x100)) {
*(int *)(unaff_RBX + 300) = *(int *)(unaff_RBX + 300) + 1;
unaff_RBP = 0xea;
goto LAB_180012bf1;
}
if (unaff_RDI == 0) {
uVar8 = FUN_1800136a0(in_stack_00000078,unaff_R12B,unaff_R13,param_12,unaff_R14D,&param_11);
unaff_RBP = uVar8 & 0xffffffff;
unaff_RDI = param_11;
if (param_11 == 0) {
if ((int)uVar8 == 8) {
*(int *)(unaff_RBX + 0x130) = *(int *)(unaff_RBX + 0x130) + 1;
}
else {
*(int *)(unaff_RBX + 0x134) = *(int *)(unaff_RBX + 0x134) + 1;
}
goto LAB_180012bf1;
}
}
LOCK();
lVar3 = *unaff_RSI;
if (lVar3 == 0) {
*unaff_RSI = unaff_RDI;
}
UNLOCK();
unaff_RDI = param_11;
} while (lVar3 != 0);
param_11 = 0;
LOCK();
piVar1 = (int *)(unaff_RBX + 0x100);
iVar7 = *piVar1;
*piVar1 = *piVar1 + 1;
UNLOCK();
if (iVar7 == 0) {
FUN_1800234bc(*(PTP_TIMER *)(unaff_RBX + 0x158),(ulonglong)*(uint *)(unaff_RBX + 0x160));
}
unaff_RDI = param_11;
if (*(uint *)(unaff_RBX + 0x120) < *(uint *)(unaff_RBX + 0x100)) {
*(uint *)(unaff_RBX + 0x120) = *(uint *)(unaff_RBX + 0x100);
}
LAB_180012bf1:
ReleaseSRWLockShared((PSRWLOCK)CONCAT71(in_stack_00000031,param_6));
if (unaff_RDI != 0) {
FUN_180023334(unaff_RDI);
}
return unaff_RBP & 0xffffffff;
}
=========================================
Function at address: 0x180012d04
Called functions addresses: 0x180012d94


int FUN_180012d04(char param_1,byte param_2,longlong param_3)

{
byte bVar1;
ulonglong uVar2;
longlong *plVar3;
uint local_res8 [2];

local_res8[0] = 0;
FUN_180012d94(local_res8,param_3 + 0x10,8);
bVar1 = param_1 + 2;
if (bVar1 < param_2) {
plVar3 = (longlong *)((ulonglong)bVar1 * 0x10 + param_3);
uVar2 = (ulonglong)(byte)(param_2 - bVar1);
do {
FUN_180012d94(local_res8,*plVar3,(ulonglong)*(uint *)(plVar3 + 1));
plVar3 = plVar3 + 2;
uVar2 = uVar2 - 1;
} while (uVar2 != 0);
}
return (local_res8[0] * 9 >> 0xb ^ local_res8[0] * 9) * 0x8001;
}
=========================================
Function at address: 0x180012d94
Called functions addresses: None


void FUN_180012d94(uint *param_1,longlong param_2,ulonglong param_3)

{
byte *pbVar1;
uint uVar2;
ulonglong uVar3;

uVar3 = 0;
if (param_3 != 0) {
do {
pbVar1 = (byte *)(uVar3 + param_2);
uVar3 = uVar3 + 1;
uVar2 = ((uint)*pbVar1 + *param_1) * 0x401;
*param_1 = uVar2 >> 6 ^ uVar2;
} while (uVar3 < param_3);
}
return;
}
=========================================
Function at address: 0x180012dc8
Called functions addresses: None


undefined8 FUN_180012dc8(undefined8 param_1,longlong param_2)

{
byte bVar1;
byte bVar2;
uint uVar3;
longlong lVar4;
uint uVar5;
ulonglong in_RAX;
ulonglong uVar6;
undefined7 uVar7;
byte *pbVar8;
byte *pbVar9;
byte bVar10;

lVar4 = *(longlong *)(param_2 + 0x10);
bVar10 = 0;
uVar3 = *(uint *)(param_2 + 0x18);
pbVar8 = (byte *)(lVar4 + 2);
do {
bVar1 = *pbVar8;
in_RAX = CONCAT71((int7)(in_RAX >> 8),bVar1);
pbVar8 = pbVar8 + 1;
} while ((char)bVar1 < '\0');
do {
bVar1 = *pbVar8;
in_RAX = CONCAT71((int7)(in_RAX >> 8),bVar1);
pbVar8 = pbVar8 + 1;
} while (bVar1 != 0);
while (pbVar8 < (byte *)((ulonglong)uVar3 + lVar4)) {
do {
pbVar9 = pbVar8;
uVar7 = (undefined7)(in_RAX >> 8);
in_RAX = CONCAT71(uVar7,*pbVar9);
pbVar8 = pbVar9 + 1;
} while (*pbVar9 != 0);
bVar1 = pbVar9[1];
if (-1 < (char)bVar1) break;
in_RAX = CONCAT71(uVar7,pbVar9[2]);
pbVar8 = pbVar9 + 3;
if (-1 < (char)pbVar9[2]) break;
for (; bVar2 = *pbVar8, (char)bVar2 < '\0'; pbVar8 = pbVar8 + 1) {
if (bVar2 != 0x80) goto LAB_180012e42;
}
if (((bVar1 & 0x7f) != 9) ||
(uVar5 = (int)CONCAT71((int7)((ulonglong)param_2 >> 8),bVar2) - 0x71,
in_RAX = (ulonglong)uVar5, 2 < (byte)uVar5)) break;
uVar6 = (ulonglong)bVar10;
in_RAX = uVar6 * 2;
bVar10 = bVar10 + 1;
*(byte *)(param_2 + 0x2d + uVar6 * 0x10) = bVar2;
}
LAB_180012e42:
return CONCAT71((int7)(in_RAX >> 8),bVar10);
}
=========================================
Function at address: 0x180012e50
Called functions addresses: 0x180041cdc 0x18002a77b 0x180012fc4 0x18000909c 0x18001147c 0x18002a7c0


int FUN_180012e50(longlong *param_1,uint param_2)

{
byte bVar1;
char cVar2;
int iVar3;
uint *puVar4;
uint uVar5;
uint local_48 [2];
longlong *local_40;
uint local_38 [2];
longlong *plStack_30;
undefined local_28 [8];
byte local_20;

bVar1 = *(byte *)((longlong)param_1 + 0x10a);
local_38[0] = 0;
local_38[1] = 0;
plStack_30 = (longlong *)0x0;
uVar5 = param_2 | 8;
if (bVar1 == 0) {
uVar5 = param_2;
}
if (DAT_180092620 == 0) {
iVar3 = 0x57;
}
else {

if (cVar2 == '\0') {
iVar3 = 0x54f;
}
else {
local_48[1] = 1;
if ((local_20 & 0x40) == 0) {
local_48[0] = 0;
local_40 = (longlong *)0x0;
}
else {
local_48[0] = 8;
if (bVar1 == 0) {
local_40 = param_1 + 0x10;
}
else {

if (local_40 == (longlong *)0x0) {
return 0xe;
}
memcpy(local_40,param_1 + 0x10,(ulonglong)local_48[0]);
}
}
puVar4 = local_38;
if (bVar1 != 0) {
puVar4 = (uint *)0x0;
}
iVar3 = FUN_180012fc4(7,param_1[0x10],(ulonglong)uVar5,local_48,(int *)puVar4,
(uint)(bVar1 == 0),(uint)bVar1,1);
if (iVar3 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1c,&DAT_180084b60,iVar3);
}
iVar3 = -0x7ff6fcfc;
if ((bVar1 != 0) && (local_40 != (longlong *)0x0)) {

}
}
else if (bVar1 == 0) {
iVar3 = FUN_18001147c(param_1,(ulonglong)uVar5,plStack_30,local_38[0]);
}
else {
iVar3 = 0x90312;
}
if (plStack_30 != (longlong *)0x0) {
FUN_18000909c(plStack_30);
}
}
}
return iVar3;
}
=========================================
Function at address: 0x180012fc4
Called functions addresses: 0x180011434 0x180041cdc 0x18000909c 0x18002a7c0


int FUN_180012fc4(ulonglong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
int *param_5,int param_6,int param_7,undefined param_8)

{
HLOCAL pvVar1;
int iVar2;

if (DAT_180092620 != 0) {
if (param_7 != 0) {

(param_1,param_2,param_3,param_4,param_8);
if (-1 < iVar2) {
return iVar2;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180084b60,iVar2);
}
FUN_180011434(0);
return iVar2;
}
if (param_5 != (int *)0x0) {
param_5[1] = 0;
param_5[2] = 0;
param_5[3] = 0;
*param_5 = 0;

if (-1 < iVar2) {
pvVar1 = *(HLOCAL *)(param_5 + 2);
if ((pvVar1 == (HLOCAL)0x0) || (*param_5 == 0)) {
if (param_6 == 0) {
return iVar2;
}
iVar2 = -0x7ff6fcfc;
}
else {
if (param_6 == 0) {
iVar2 = -0x7ff6fcfc;
}
if (-1 < iVar2) {
return iVar2;
}
}
if (pvVar1 != (HLOCAL)0x0) {
FUN_18000909c(pvVar1);
}
param_5[1] = 0;
param_5[2] = 0;
param_5[3] = 0;
*param_5 = 0;
return iVar2;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar2;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return iVar2;
}
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_180084b60,iVar2);
return iVar2;
}
}
return -0x7ff6fcfc;
}
=========================================
Function at address: 0x180013030
Called functions addresses: 0x180013060


void FUN_180013030(undefined8 *param_1)

{
*param_1 = &PTR_FUN_18007d0d8;
FUN_180013060((longlong)param_1);
*param_1 = &PTR_FUN_18007c298;
return;
}
=========================================
Function at address: 0x180013060
Called functions addresses: 0xEXTERNAL:00000040 0x180008fb8 0x1800570b0 0xEXTERNAL:000000bc 0x18002a7c0 0xEXTERNAL:00000134 0x180041e9c 0xEXTERNAL:000000c0 0xEXTERNAL:00000129 0x18000909c 0xEXTERNAL:00000126 0xEXTERNAL:000000c5 0xEXTERNAL:00000047 0xEXTERNAL:000000b3 0x180001604


void FUN_180013060(longlong param_1)

{
longlong lVar1;
undefined8 *puVar2;
undefined8 *puVar3;
HLOCAL pvVar4;
int iVar5;
longlong lVar6;
HCERTSTORE pvVar7;
undefined8 *puVar8;
int local_res8 [2];

local_res8[0] = 0;
if (*(int *)(param_1 + 0x90) != 0) {
lVar1 = param_1 + 0x30;
RtlAcquireResourceExclusive(lVar1,1);
if (*(int *)(param_1 + 0x1c) != 0) {
puVar2 = (undefined8 *)(param_1 + 0x20);
puVar8 = (undefined8 *)*puVar2;
while (puVar8 != puVar2) {
puVar3 = puVar8 + -1;
puVar8 = (undefined8 *)*puVar8;
if (puVar3 != (undefined8 *)0x0) {

}
}
*(undefined4 *)(param_1 + 0x1c) = 0;
*puVar2 = 0;
*(undefined8 *)(param_1 + 0x28) = 0;
}
if (*(HLOCAL *)(param_1 + 0xb8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0xb8));
}
if (*(HLOCAL *)(param_1 + 200) != (HLOCAL)0x0) {
FUN_180008fb8(*(HLOCAL *)(param_1 + 200),*(uint *)(param_1 + 0xc4));
*(undefined8 *)(param_1 + 200) = 0;
*(undefined4 *)(param_1 + 0xc4) = 0;
}
if (*(HLOCAL *)(param_1 + 0x360) != (HLOCAL)0x0) {
LocalFree(*(HLOCAL *)(param_1 + 0x360));
}
pvVar4 = *(HLOCAL *)(param_1 + 0x350);
if (pvVar4 != (HLOCAL)0x0) {
if (*(PCCTL_CONTEXT *)((longlong)pvVar4 + 0x28) != (PCCTL_CONTEXT)0x0) {
CertFreeCTLContext(*(PCCTL_CONTEXT *)((longlong)pvVar4 + 0x28));
}
FUN_18000909c(pvVar4);
}
pvVar7 = *(HCERTSTORE *)(param_1 + 0x300);
if (pvVar7 != (HCERTSTORE)0x0) {
if (*(longlong *)(param_1 + 0x308) != 0) {
FUN_1800570b0(pvVar7,pvVar7,(longlong *)(param_1 + 0x308));
pvVar7 = *(HCERTSTORE *)(param_1 + 0x300);
}
CertCloseStore(pvVar7,0);
}
if (*(HLOCAL *)(param_1 + 0x368) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x368));
}
if (*(HLOCAL *)(param_1 + 0x370) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x370));
}
if (*(longlong *)(param_1 + 0x310) != 0) {
lVar6 = *(longlong *)(param_1 + 0x2f0);
iVar5 = FUN_180001604(lVar6,local_res8);
if ((iVar5 == 0) && (*(longlong *)(param_1 + 0x318) != 0)) {
FUN_1800570b0(lVar6,*(HCERTSTORE *)(param_1 + 0x310),(longlong *)(param_1 + 0x318));
}
CertCloseStore(*(HCERTSTORE *)(param_1 + 0x310),0);
if (local_res8[0] != 0) {
RevertToSelf();
}
}
if (*(longlong *)(param_1 + 800) != 0) {
CryptObjectLocatorFree();
}
if (*(longlong *)(param_1 + 0x328) != 0) {
CryptObjectLocatorFree();
}
pvVar7 = *(HCERTSTORE *)(param_1 + 0x330);
if (pvVar7 != (HCERTSTORE)0x0) {
if (*(longlong *)(param_1 + 0x338) != 0) {
FUN_1800570b0(pvVar7,pvVar7,(longlong *)(param_1 + 0x338));
pvVar7 = *(HCERTSTORE *)(param_1 + 0x330);
}
CertCloseStore(pvVar7,0);
}
pvVar7 = *(HCERTSTORE *)(param_1 + 0x340);
if (pvVar7 != (HCERTSTORE)0x0) {
if (*(longlong *)(param_1 + 0x348) != 0) {
FUN_1800570b0(pvVar7,pvVar7,(longlong *)(param_1 + 0x348));
pvVar7 = *(HCERTSTORE *)(param_1 + 0x340);
}
CertCloseStore(pvVar7,0);
}
if (*(longlong *)(param_1 + 0x2f0) != 0) {
NtClose();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x18,&DAT_180082b38,*(undefined8 *)(param_1 + 0x2f0));
}
*(undefined8 *)(param_1 + 0x2f0) = 0;
}
if (*(HLOCAL *)(param_1 + 0x378) != (HLOCAL)0x0) {
LocalFree(*(HLOCAL *)(param_1 + 0x378));
}
RtlReleaseResource(lVar1);
RtlDeleteResource(lVar1);
}
return;
}
=========================================
Function at address: 0x180013210
Called functions addresses: 0x180013030 0x18000909c


undefined8 * FUN_180013210(undefined8 *param_1,uint param_2)

{
FUN_180013030(param_1);
if ((param_2 & 1) != 0) {
FUN_18000909c(param_1);
}
return param_1;
}
=========================================
Function at address: 0x180013248
Called functions addresses: 0x180011434 0x180041cdc 0xEXTERNAL:000000c7 0xEXTERNAL:0000013a 0x18002a7c0 0x18001336c


ulonglong FUN_180013248(undefined8 *param_1,PCCERT_CONTEXT param_2)

{
char cVar1;
int iVar2;
ulonglong uVar3;
PCCERT_CONTEXT pCVar4;
uint local_38 [2];
uint *local_30;
undefined local_28 [8];
byte local_20;

if (param_2 == (PCCERT_CONTEXT)0x0) {
return 0x8009030e;
}
if (param_1 == (undefined8 *)0x0) {
return 0x57;
}
if ((DAT_180092620 != 0) &&

if ((local_20 & 0x10) == 0) {
uVar3 = FUN_18001336c(param_2,(uint *)0x0,local_38);
if ((int)uVar3 < 0) {
return uVar3;
}

if (local_30 != (uint *)0x0) {
uVar3 = FUN_18001336c(param_2,local_30,local_38);
if ((int)uVar3 < 0) {

return uVar3 & 0xffffffff;
}
local_38[1] = 1;
if (DAT_180092620 == 0) {
iVar2 = -0x7ff6fcfc;
}
else {

if (-1 < iVar2) {
return 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180084b60,iVar2);
}
FUN_180011434(0);
}

uVar3 = RtlNtStatusToDosError(iVar2);
return uVar3;
}
return 0xe;
}
pCVar4 = CertDuplicateCertificateContext(param_2);
if (pCVar4 != (PCCERT_CONTEXT)0x0) {
*param_1 = pCVar4;
return 0;
}
}
return 0x54f;
}
=========================================
Function at address: 0x18001336c
Called functions addresses: 0xEXTERNAL:00000127 0xEXTERNAL:00000125


undefined8 FUN_18001336c(PCCERT_CONTEXT param_1,uint *param_2,uint *param_3)

{
BOOL BVar1;
uint uVar2;
uint uVar3;
DWORD local_res8 [2];
uint local_28 [2];
uint *local_20;

local_res8[0] = 0;
if (param_1 == (PCCERT_CONTEXT)0x0) {
*param_3 = 0;
}
else {
BVar1 = CertSerializeCertificateStoreElement(param_1,0,(BYTE *)0x0,local_res8);
if (BVar1 == 0) {
return 0x8009030d;
}
if (param_1->hCertStore == (HCERTSTORE)0x0) {
uVar3 = 0;
}
else {
local_28[0] = 0;
local_20 = (uint *)0x0;
BVar1 = CertSaveStore(param_1->hCertStore,1,1,2,local_28,0);
uVar3 = local_28[0];
if (BVar1 == 0) {
return 0x8009030d;
}
}
uVar2 = local_res8[0] + 8 + uVar3;
if (param_2 == (uint *)0x0) {
*param_3 = uVar2;
}
else {
if (*param_3 < uVar2) {
return 0x80090321;
}
*param_3 = uVar2;
*param_2 = uVar3;
if (param_1->hCertStore != (HCERTSTORE)0x0) {
local_20 = param_2 + 1;
local_28[0] = uVar3;
BVar1 = CertSaveStore(param_1->hCertStore,1,1,2,local_28,0);
if (BVar1 == 0) {
return 0x8009030d;
}
}
*(DWORD *)((longlong)param_2 + (ulonglong)uVar3 + 4) = local_res8[0];
BVar1 = CertSerializeCertificateStoreElement
(param_1,0,(BYTE *)((longlong)param_2 + (ulonglong)uVar3 + 8),local_res8);
if (BVar1 == 0) {
return 0x8009030d;
}
}
}
return 0;
}
=========================================
Function at address: 0x1800134ac
Called functions addresses: 0xEXTERNAL:0000012b 0xEXTERNAL:000000c0 0x18002a7c0 0xEXTERNAL:0000013b 0x180013248 0x18000f5c0 0xEXTERNAL:000000c2


DWORD FUN_1800134ac(longlong *param_1,undefined8 *param_2)

{
longlong lVar1;
uint *puVar2;
DWORD DVar3;
BOOL BVar4;
ulonglong uVar5;
undefined2 uVar6;
int local_res8 [4];
int local_res18 [2];
PCCERT_CONTEXT local_res20;
longlong local_48;
longlong local_40;
int local_38 [2];
longlong local_30;

local_48 = 0;
local_40 = 0;
local_res8[0] = 0;
local_res18[0] = 0;
local_res20 = (PCCERT_CONTEXT)0x0;
RtlAcquireResourceShared(param_1[0xb] + 0x48,1);
lVar1 = param_1[0xb];
puVar2 = *(uint **)(lVar1 + 0x18);
DVar3 = *(DWORD *)(lVar1 + 0x20);
if (puVar2 == (uint *)0x0) {
RtlReleaseResource(lVar1 + 0x48);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180085110);
}
return 0x8009030e;
}

DVar3 = FUN_18000f5c0(puVar2,DVar3,&local_res20);
RtlReleaseResource(param_1[0xb] + 0x48);
if (DVar3 == 0) {
RtlAcquireResourceShared(param_1[0xb] + 0x48,1);
if (local_48 != 0) {
local_30 = local_48;
local_38[0] = local_res8[0];
BVar4 = CertSetCertificateContextProperty(local_res20,0x46,0,local_38);
if (((BVar4 == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
DVar3 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0xf,&DAT_180085110,DVar3);
}
}

if ((local_40 != 0) && (local_res18[0] != 0)) {
local_30 = local_40;
local_38[0] = local_res18[0];
BVar4 = CertSetCertificateContextProperty(local_res20,0x77,0,local_38);
if ((BVar4 == 0) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)))) {
DVar3 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x10,&DAT_180085110,DVar3);
}
}
RtlReleaseResource(param_1[0xb] + 0x48);
uVar5 = FUN_180013248(param_2,local_res20);
DVar3 = (DWORD)uVar5;
if (((DVar3 == 0) || ((undefined8 **)DAT_180091000 == &DAT_180091000)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18001362d;
uVar6 = 0x11;
}
else {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18001362d;
uVar6 = 0xe;
}
FUN_180041cdc(DAT_180091000[2],uVar6,&DAT_180085110,DVar3);
LAB_18001362d:
if (local_res20 != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(local_res20);
}
return DVar3;
}
=========================================
Function at address: 0x180013660
Called functions addresses: 0x1800134ac 0x180046538 0x180046eb8 0x18002a7c0 0x18004648c 0x180046e2c 0x180046670 0x18005b3a0


ulonglong FUN_180013660(longlong *param_1,int param_2,undefined8 *param_3)

{
DWORD DVar1;
undefined4 uVar2;
undefined4 extraout_var;
ulonglong uVar3;
ulonglong extraout_RAX;
undefined4 extraout_var_00;
longlong lVar4;
undefined4 extraout_var_01;

if (param_2 == 0x22) {
uVar2 = FUN_180046e2c((longlong)param_1,param_3);
return CONCAT44(extraout_var_00,uVar2);
}
if (param_2 == 0x59) {
uVar3 = FUN_180046670((longlong)param_1,param_3);
return uVar3;
}
if (param_2 == 0x5b) {
uVar3 = FUN_180046538((longlong)param_1,param_3);
return uVar3;
}
if (param_2 == 0x66) {
FUN_180046eb8((longlong)param_1,param_3);
return extraout_RAX;
}
if (param_2 == 0x67) {
DVar1 = FUN_1800134ac(param_1,param_3);
return CONCAT44(extraout_var,DVar1);
}
if (param_2 == 0x6b) {

return uVar3;
}
if (param_2 == 0x71) {
uVar3 = FUN_18004648c((longlong)param_1,param_3);
return uVar3;
}
if (param_2 != 6) {
if (param_2 == 0x52) {
uVar3 = FUN_180046ca0(param_1,param_3);
return uVar3;
}
if (param_2 != 0x54) {
if (param_2 != 0x5e) {
return 0x78;
}
uVar3 = FUN_180045fdc((longlong)param_1,param_3);
return uVar3;
}

if (lVar4 != 0) {
uVar3 = FUN_180013248(param_3,*(PCCERT_CONTEXT *)(lVar4 + 0x20));
return uVar3;
}
return 0x8009030e;
}
DVar1 = FUN_1800461e4((longlong)param_1,(longlong)param_3);
return CONCAT44(extraout_var_01,DVar1);
}
=========================================
Function at address: 0x1800136a0
Called functions addresses: 0x18002a77b 0xEXTERNAL:000000e8 0xEXTERNAL:000000e7 0x1800138c8


undefined8
FUN_1800136a0(undefined8 *param_1,byte param_2,longlong param_3,byte param_4,undefined4 param_5,
undefined8 *param_6)

{
undefined8 *puVar1;
undefined8 uVar2;
undefined8 uVar3;
ulonglong uVar4;
HANDLE hHeap;
longlong lVar5;
void *pvVar6;
undefined8 *puVar7;
uint uVar8;
longlong lVar9;
ulonglong uVar10;
SIZE_T dwBytes;
uint *puVar11;
ulonglong uVar12;
ulonglong uVar13;
byte bVar14;
LPVOID local_38;
SIZE_T local_30;

uVar12 = 0;
local_38 = (LPVOID)0x0;
bVar14 = 0;
*param_6 = 0;
uVar10 = uVar12;
if (param_2 != 0) {
puVar11 = (uint *)(param_3 + 8);
uVar13 = uVar12;
do {
uVar8 = *puVar11;
puVar11 = puVar11 + 4;
if (1 < bVar14) {
uVar10 = uVar8 + uVar10;
}
uVar4 = uVar8 + uVar13;
if (1 < bVar14) {
uVar4 = uVar13;
}
bVar14 = bVar14 + 1;
uVar13 = uVar4;
} while (bVar14 < param_2);
if (0xffff < uVar4 + uVar10) {
return 0x216;
}
}
dwBytes = (ulonglong)param_2 * 0x10 + 0x2e + uVar10;
if (dwBytes != 0) {
hHeap = GetProcessHeap();
local_38 = HeapAlloc(hHeap,8,dwBytes);
if (local_38 != (LPVOID)0x0) {
local_30 = dwBytes;
lVar5 = FUN_1800138c8((longlong *)&local_38,(ulonglong)param_2 * 0x10);
if (param_4 != 0xfffffffe) {
do {
if ((byte)uVar12 < 2) {
puVar7 = (undefined8 *)(param_3 + uVar12 * 0x10);
uVar2 = puVar7[1];
puVar1 = (undefined8 *)(lVar5 + uVar12 * 0x10);
*puVar1 = *puVar7;
puVar1[1] = uVar2;
}
else {
uVar8 = *(uint *)(param_3 + 8 + uVar12 * 0x10);
pvVar6 = (void *)FUN_1800138c8((longlong *)&local_38,(ulonglong)uVar8);
memcpy(pvVar6,*(void **)(param_3 + uVar12 * 0x10),(ulonglong)uVar8);
*(void **)(lVar5 + uVar12 * 0x10) = pvVar6;
*(undefined4 *)(lVar5 + 0xc + uVar12 * 0x10) =
*(undefined4 *)(param_3 + 0xc + uVar12 * 0x10);
*(undefined4 *)(lVar5 + 8 + uVar12 * 0x10) =
*(undefined4 *)(param_3 + 8 + uVar12 * 0x10);
}
bVar14 = (byte)uVar12 + 1;
uVar12 = (ulonglong)bVar14;
} while ((uint)bVar14 < param_4 + 2);
}
lVar9 = 0x2e;
puVar7 = (undefined8 *)FUN_1800138c8((longlong *)&local_38,0x2e);
puVar7[2] = lVar5;
uVar2 = *param_1;
uVar3 = param_1[1];
*(byte *)((longlong)puVar7 + 0x2d) = param_4;
bVar14 = param_4 + 2;
*(byte *)((longlong)puVar7 + 0x2c) = param_2;
*(undefined4 *)(puVar7 + 5) = param_5;
*puVar7 = uVar2;
puVar7[1] = uVar3;
if (bVar14 < param_2) {
lVar5 = (lVar9 + -0x36) - param_3;
uVar10 = (ulonglong)(byte)(param_2 - bVar14);
puVar11 = (uint *)(param_3 + 8 + (ulonglong)bVar14 * 0x10);
do {
uVar8 = *puVar11;
pvVar6 = (void *)FUN_1800138c8((longlong *)&local_38,(ulonglong)uVar8);
memcpy(pvVar6,*(void **)(puVar11 + -2),(ulonglong)uVar8);
*(void **)((longlong)puVar11 + puVar7[2] + lVar5) = pvVar6;
*(uint *)((longlong)puVar11 + puVar7[2] + lVar5 + 0xc) = puVar11[1];
*(uint *)((longlong)puVar11 + puVar7[2] + lVar5 + 8) = *puVar11;
uVar10 = uVar10 - 1;
puVar11 = puVar11 + 4;
} while (uVar10 != 0);
}
*param_6 = puVar7;
return 0;
}
}
return 8;
}
=========================================
Function at address: 0x1800138c8
Called functions addresses: None


longlong FUN_1800138c8(longlong *param_1,ulonglong param_2)

{
longlong lVar1;

if (((param_1 != (longlong *)0x0) && (param_2 != 0)) && (param_2 <= (ulonglong)param_1[1])) {
lVar1 = *param_1;
param_1[1] = param_1[1] - param_2;
*param_1 = lVar1 + param_2;
return lVar1;
}
return 0;
}
=========================================
Function at address: 0x1800138fc
Called functions addresses: 0x18002a76f


int FUN_1800138fc(byte param_1,longlong param_2,longlong param_3)

{
longlong lVar1;
int iVar2;
longlong lVar3;
uint uVar4;

lVar1 = *(longlong *)(param_3 + 0x10);
iVar2 = memcmp((void *)(param_2 + 0x10),(void *)(lVar1 + 0x10),8);
if (iVar2 == 0) {
for (uVar4 = *(byte *)(param_3 + 0x2d) + 2; uVar4 < param_1; uVar4 = uVar4 + 1) {
lVar3 = (ulonglong)uVar4 * 0x10;
iVar2 = *(int *)(lVar3 + 8 + param_2) - *(int *)(lVar3 + 8 + lVar1);
if (iVar2 != 0) {
return iVar2;
}
iVar2 = memcmp(*(void **)(lVar3 + param_2),*(void **)(lVar3 + lVar1),
(ulonglong)*(uint *)(lVar3 + 8 + param_2));
if (iVar2 != 0) {
return iVar2;
}
}
iVar2 = 0;
}
return iVar2;
}
=========================================
Function at address: 0x180013988
Called functions addresses: 0x18002a25c


undefined4 FUN_180013988(wchar_t *param_1,longlong param_2,wchar_t *param_3,undefined8 param_4)

{
size_t _Count;
int iVar1;
undefined4 uVar2;
undefined8 local_res20;

if (param_2 - 1U < 0x7fffffff) {
_Count = param_2 - 1;
uVar2 = 0;
local_res20 = param_4;
iVar1 = FID_conflict__vsnprintf(param_1,_Count,param_3,(va_list)&local_res20);
if ((iVar1 < 0) || (_Count < (ulonglong)(longlong)iVar1)) {
uVar2 = 0x8007007a;
}
else if ((longlong)iVar1 != _Count) {
return 0;
}
param_1[_Count] = L'\0';
}
else {
uVar2 = 0x80070057;
if (param_2 != 0) {
*param_1 = L'\0';
}
}
return uVar2;
}
=========================================
Function at address: 0x1800139f0
Called functions addresses: 0xEXTERNAL:0000012a 0x180009ae4 0x18002a7c0 0x180028070 0x180011434 0xEXTERNAL:00000129 0xEXTERNAL:00000128 0x180041cb0 0xEXTERNAL:00000041 0x18000909c 0x180028d90 0x18000a1f4 0x180010cf8


void FUN_1800139f0(undefined8 param_1,int param_2,undefined8 *param_3,int *param_4)

{
uint uVar1;
longlong lVar2;
int iVar3;
BOOL BVar4;
uint *puVar5;
HCERTSTORE pvVar6;
longlong lVar7;
undefined8 uVar8;
uint uVar9;
uint uVar10;
uint uVar11;
uint *puVar12;
uint *puVar13;
undefined auStackY_e8 [32];
uint *local_a8;
uint *local_a0;
uint local_90 [2];
uint *local_88;
undefined8 local_80;
undefined8 uStack_78;
undefined8 local_70;
undefined8 uStack_68;
undefined8 local_60;
undefined8 uStack_58;
undefined8 local_50;
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_e8;
local_a0 = (uint *)0x0;
local_a8 = (uint *)0x0;
puVar13 = (uint *)0x0;
local_80 = 0;
uStack_78 = 0;
local_50 = 0;
local_70 = 0;
uStack_68 = 0;
local_60 = 0;
uStack_58 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180084ce0);
}
puVar5 = (uint *)0x0;
if (param_2 == 3) {

puVar12 = (uint *)0x0;
if (iVar3 < 0) goto LAB_180013b64;
local_50 = 0;
}
else {
uVar8 = 0x38;
if (param_2 != 4) {
uVar8 = 0x2c;
}

puVar12 = (uint *)0x0;
if (iVar3 < 0) goto LAB_180013b64;
}
memset(param_4 + 1,0,0x6c);
*param_4 = param_2;
if (param_2 == 4) {
uVar11 = uStack_78._4_4_;
uVar10 = local_80._4_4_;
uVar9 = (uint)uStack_78;
}
else {
uVar11 = (uint)local_70;
uVar10 = (uint)uStack_78;
uVar9 = uStack_78._4_4_;
}
puVar5 = puVar13;
puVar12 = puVar13;
if (100 < uVar10) {
iVar3 = -0x7ff6fd00;
goto LAB_180013b64;
}
if (param_3[1] == 0) {
if (((uVar10 != 0) && (uVar9 != 0)) || (uVar11 != 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x17,&DAT_180084ce0);
}
iVar3 = 0x90312;
goto LAB_180013b64;
}
}
else {
puVar13 = (uint *)param_3[1];
}
if ((uVar10 != 0) && (uVar9 != 0)) {
puVar5 = (uint *)FUN_18000a1f4((ulonglong)(uVar10 * 4));
puVar12 = local_a8;
if (puVar5 == (uint *)0x0) {
iVar3 = -0x7ff6fd00;
goto LAB_180013b64;
}

if (iVar3 < 0) goto LAB_180013b64;
param_4[1] = uVar10;
lVar7 = FUN_18000a1f4((ulonglong)(uVar10 * 0x38));
*(longlong *)(param_4 + 2) = lVar7;
local_a0 = puVar5;
if (lVar7 != 0) {
local_a8 = (uint *)CertOpenStore((LPCSTR)0x2,0,0,4,(void *)0x0);
if (local_a8 != (uint *)0x0) {
uVar9 = 0;
if (uVar10 != 0) {
lVar7 = 0;
puVar5 = puVar13;
do {
uVar1 = *puVar5;
puVar12 = puVar5 + 1;
puVar13 = (uint *)((longlong)puVar12 + (ulonglong)uVar1);
if ((puVar12 == (uint *)0x0) || (uVar1 < 0xc)) goto LAB_18003cebc;
lVar2 = *(longlong *)(param_4 + 2);
((void **)(lVar2 + lVar7))[2] = (void *)(ulonglong)*puVar12;
if (uVar1 - 8 < puVar5[2]) goto LAB_18003cebc;
BVar4 = CertAddSerializedElementToStore
(local_a8,(BYTE *)(puVar5 + 3),puVar5[2],4,0,2,(DWORD *)0x0,
(void **)(lVar2 + lVar7));
if (BVar4 == 0) {
GetLastError();
goto LAB_18003ceb2;
}
uVar9 = uVar9 + 1;
lVar7 = lVar7 + 0x38;
puVar5 = puVar13;
} while (uVar9 < uVar10);
}
goto LAB_180013b06;
}
GetLastError();
}
goto LAB_18003ce17;
}
LAB_180013b06:
if (uVar11 != 0) {
if ((puVar13 + 1 != (uint *)0x0) && (3 < *puVar13)) {
local_90[0] = puVar13[1];
local_88 = puVar13 + 2;
if ((ulonglong)local_90[0] <= (ulonglong)*puVar13 - 4) {
pvVar6 = CertOpenStore((LPCSTR)0x6,1,0,0,local_90);
*(HCERTSTORE *)(param_4 + 4) = pvVar6;
if (pvVar6 == (HCERTSTORE)0x0) {
LAB_18003ceb2:
iVar3 = -0x7ff6fcf3;
puVar5 = local_a0;
puVar12 = local_a8;
goto LAB_180013b64;
}
goto LAB_180013b0f;
}
}
LAB_18003cebc:
iVar3 = -0x7ff6fcfc;
puVar5 = local_a0;
puVar12 = local_a8;
goto LAB_180013b64;
}
LAB_180013b0f:
puVar5 = local_a0;
puVar12 = local_a8;
if (param_2 == 4) {
if (((uint)uStack_68 != 0) && (uStack_68._4_4_ != 0)) {
if ((uint)uStack_68 < 0x101) {
uVar9 = (uint)uStack_68 * 4;
param_4[0xe] = (uint)uStack_68;
lVar7 = FUN_18000a1f4((ulonglong)uVar9);
*(longlong *)(param_4 + 0x10) = lVar7;
if (lVar7 != 0) {

if (iVar3 < 0) goto LAB_180013b64;
goto LAB_18003cf83;
}
}
LAB_18003ce17:
iVar3 = -0x7ff6fd00;
puVar5 = local_a0;
puVar12 = local_a8;
goto LAB_180013b64;
}
LAB_18003cf83:
if ((uint)local_60 == 0xffffffff) {
uVar9 = 0;
}
else {
param_4[0x12] = (uint)local_60;
uVar9 = (uint)local_60;
}
param_4[0x12] = uVar9 & 0x3fffffff;
param_4[0x13] = local_60._4_4_;
param_4[0x14] = (int)uStack_58;
param_4[0x15] = uStack_58._4_4_;
param_4[0x16] = (int)local_50;
iVar3 = local_50._4_4_;
LAB_180013b57:
param_4[0x17] = iVar3;
}
else if (param_2 == 5) {
iVar3 = FUN_180009ae4(0,local_60._4_4_,(int)uStack_58,'\x01',(longlong *)(param_4 + 0x1a),
(uint *)(param_4 + 0x18));
if (iVar3 != 0) goto LAB_180013b64;
param_4[0x15] = uStack_68._4_4_;
param_4[0x16] = (uint)local_60;
iVar3 = local_80._4_4_;
goto LAB_180013b57;
}
iVar3 = 0;
LAB_180013b64:
if (param_3 != (undefined8 *)0x0) {
param_3[1] = 0;
*param_3 = 0;
FUN_180011434(0);
}
if (puVar5 != (uint *)0x0) {
FUN_18000909c(puVar5);
}
if (puVar12 != (uint *)0x0) {
CertCloseStore(puVar12,0);
}
if (iVar3 < 0) {
FUN_180010cf8((undefined *)param_4,'\x01');
}
FUN_180028070(local_48 ^ (ulonglong)auStackY_e8);
return;
}
=========================================
Function at address: 0x180013bc8
Called functions addresses: 0xEXTERNAL:00000141 0xEXTERNAL:00000040 0xEXTERNAL:00000041 0x180013c60


DWORD FUN_180013bc8(longlong param_1,undefined4 *param_2)

{
BOOL BVar1;
DWORD DVar2;
ulonglong uVar3;
undefined8 uVar4;
DWORD local_res8 [2];
longlong *local_res10 [3];

*param_2 = 0;
local_res10[0] = (longlong *)0x0;
local_res8[0] = 8;
uVar4 = 1;
BVar1 = CryptDecodeObjectEx(1,(LPCSTR)0x49,*(BYTE **)(*(longlong *)(param_1 + 0x18) + 0x70),
*(DWORD *)(*(longlong *)(param_1 + 0x18) + 0x68),0x8000,
(PCRYPT_DECODE_PARA)0x0,local_res10,local_res8);
if (BVar1 == 0) {
DVar2 = GetLastError();
}
else {
uVar3 = FUN_180013c60(uVar4,*local_res10[0],param_2);
DVar2 = (DWORD)uVar3;
}
if (local_res10[0] != (longlong *)0x0) {
LocalFree(local_res10[0]);
}
return DVar2;
}
=========================================
Function at address: 0x180013c60
Called functions addresses: 0xEXTERNAL:000000f9 0xEXTERNAL:000000c0 0xEXTERNAL:000000fe 0x180013d04 0x180028d24 0xEXTERNAL:000000c2


ulonglong FUN_180013c60(undefined8 param_1,longlong param_2,undefined4 *param_3)

{
bool bVar1;
int iVar2;
ulonglong uVar3;
ulonglong uVar4;
longlong lVar5;
uint uVar6;
ulonglong uVar7;
longlong local_38;
undefined8 uStack_30;
undefined8 local_28;

*param_3 = 0;
RtlAcquireResourceShared(&DAT_180092428,1);
if ((param_2 == 0) || (DAT_1800925c8 == (longlong *)0x0)) {
uVar4 = 0x57;
}
else {
uVar3 = FUN_180013d04(DAT_1800925c8,param_2,param_3);
uVar4 = uVar3 & 0xffffffff;
if ((int)uVar3 != 0) {
bVar1 = false;
uVar3 = 0;
local_28 = 0;
local_38 = 0;
uStack_30 = 0;
if (DAT_180092498 != 0) {
do {
iVar2 = SslEnumEccCurves((&DAT_1800924a0)[uVar3],&uStack_30,&local_38,0);
if (iVar2 == 0) {
uVar7 = 0;
if ((uint)uStack_30 != 0) {
do {
lVar5 = uVar7 * 0x30c + local_38;
iVar2 = _o__stricmp(lVar5 + 0x1fe,param_2);
if (iVar2 == 0) {
uVar4 = 0;
*param_3 = *(undefined4 *)(lVar5 + 0x304);
bVar1 = true;
break;
}
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
} while (uVar6 < (uint)uStack_30);
}
}
if (local_38 != 0) {
SslFreeBuffer();
local_38 = 0;
}
} while ((!bVar1) &&
(uVar6 = (int)uVar3 + 1, uVar3 = (ulonglong)uVar6, uVar6 < DAT_180092498));
}
}
}
RtlReleaseResource(&DAT_180092428);
return uVar4;
}
=========================================
Function at address: 0x180013d04
Called functions addresses: 0x18003d0c4


undefined8 FUN_180013d04(longlong *param_1,longlong param_2,undefined4 *param_3)

{
char cVar1;
char cVar2;
longlong lVar3;
undefined8 uVar4;
uint uVar5;
ulonglong uVar6;
longlong lVar7;
longlong lVar8;
char *pcVar9;
ulonglong uVar10;

*param_3 = 0;
uVar10 = 0;
if (*(uint *)(param_1 + 1) != 0) {
lVar3 = *param_1;
do {
uVar6 = 0;
lVar7 = uVar10 * 0x20;
if (*(int *)(lVar7 + 8 + lVar3) != 0) {
do {
pcVar9 = (char *)(*(longlong *)(lVar7 + lVar3) + 0x1fe + uVar6 * 0x30c);
lVar8 = param_2 - (longlong)pcVar9;
do {
cVar1 = *pcVar9;
cVar2 = pcVar9[lVar8];
if (cVar1 != cVar2) break;
pcVar9 = pcVar9 + 1;
} while (cVar2 != '\0');
if (cVar1 == cVar2) {
*param_3 = *(undefined4 *)(uVar6 * 0x30c + 0x304 + *(longlong *)(lVar7 + lVar3));
return 0;
}
uVar5 = (int)uVar6 + 1;
uVar6 = (ulonglong)uVar5;
if (*(uint *)(lVar7 + 8 + lVar3) <= uVar5) {
uVar4 = FUN_18003d0c4();
return uVar4;
}
} while( true );
}
uVar5 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar5;
} while (uVar5 < *(uint *)(param_1 + 1));
}
return 0x490;
}
=========================================
Function at address: 0x180013dd0
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:000000c2


ulonglong FUN_180013dd0(longlong param_1,short *param_2,ulonglong *param_3)

{
longlong lVar1;
ulonglong uVar2;
short *psVar3;
uint uVar4;
ulonglong uVar5;
ulonglong uVar6;

uVar5 = 0;
uVar2 = uVar5;
if (*(ulonglong **)(param_1 + 8) != (ulonglong *)0x0) {
uVar2 = **(ulonglong **)(param_1 + 8);
}
*param_3 = uVar2;
uVar6 = uVar5;
if (*(ulonglong **)(param_1 + 8) != (ulonglong *)0x0) {
uVar6 = **(ulonglong **)(param_1 + 8);
}
RtlAcquireResourceShared(&DAT_180092428,CONCAT71((int7)(uVar2 >> 8),1));
uVar4 = 0;
uVar2 = uVar5;
if (DAT_180092498 != 0) {
do {
uVar4 = (uint)uVar2;
if ((&DAT_1800924a0)[uVar2] == uVar6) {
psVar3 = *(short **)(DAT_180092490 + uVar2 * 0x10);
lVar1 = 0x100;
goto LAB_180013e53;
}
uVar4 = uVar4 + 1;
uVar2 = (ulonglong)uVar4;
} while (uVar4 < DAT_180092498);
}
goto LAB_180013e86;
while( true ) {
*param_2 = *psVar3;
psVar3 = psVar3 + 1;
param_2 = param_2 + 1;
lVar1 = lVar1 + -1;
if (lVar1 == 0) break;
LAB_180013e53:
if (lVar1 == -0x7ffffefe) goto LAB_180013e83;
if (*psVar3 == 0) {
if (lVar1 != 0) goto LAB_180013e83;
break;
}
}
param_2 = param_2 + -1;
LAB_180013e83:
*param_2 = 0;
LAB_180013e86:
RtlReleaseResource(&DAT_180092428);
if (uVar4 == DAT_180092498) {
uVar5 = 0x490;
}
return uVar5;
}
=========================================
Function at address: 0x180013ed0
Called functions addresses: 0x18002a77b 0x180041cb0 0x18002a7c0 0x1800432ec


undefined8 FUN_180013ed0(longlong *param_1,uint *param_2)

{
ushort uVar1;
uint uVar2;
uint *puVar3;
byte *pbVar4;
void *_Dst;
undefined8 uVar5;
undefined2 uVar6;
byte *pbVar7;
uint *puVar8;
uint *_Src;
undefined8 *puVar9;

_Src = (uint *)0x0;
if (param_2 == (uint *)0x0) {
LAB_180013fe9:
_Dst = (void *)0x0;
if (_Src != (uint *)0x0) {
uVar1 = *(ushort *)(_Src + 1);

if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,_Src,(ulonglong)uVar1 + 6);
}

param_1[0x62] = (longlong)_Dst;
if (param_1[99] != 0) {

param_1[99] = 0;
}
uVar5 = 0;
}
else {
if (((param_2[1] == 0x12) && (0xb < *param_2)) &&
(puVar3 = *(uint **)(param_2 + 2), puVar3 != (uint *)0x0)) {
uVar2 = *puVar3;
if (((7 < uVar2) && (3 < uVar2 + 4)) && (uVar2 + 4 <= *param_2)) {
puVar8 = puVar3 + 1;
puVar9 = DAT_180091000;
if ((uVar2 & 0xfffffff8) != 0) {
do {
if (*puVar8 == 2) {
if (_Src != (uint *)0x0) {
if (((undefined8 **)puVar9 == &DAT_180091000) ||
((*(byte *)((longlong)puVar9 + 0x1c) & 1) == 0)) goto LAB_18003d1e6;
uVar5 = puVar9[2];
uVar6 = 0x4f;
goto LAB_18003d1da;
}
pbVar4 = (byte *)((longlong)puVar8 + 6);
if (pbVar4 == (byte *)0x0) {
return 0x57;
}
if (0xfffb < (ushort)(*(ushort *)(puVar8 + 1) - 2)) {
if (((undefined8 **)puVar9 != &DAT_180091000) &&
((*(byte *)((longlong)puVar9 + 0x1c) & 1) != 0)) {
uVar6 = 0x4a;
LAB_18003d14f:
FUN_180041cb0(puVar9[2],uVar6,&DAT_180082c58);
return 0x80090326;
}
goto LAB_18003d1e6;
}
pbVar7 = pbVar4 + *(ushort *)(puVar8 + 1);
for (; _Src = puVar8, pbVar4 < pbVar7; pbVar4 = pbVar4 + *pbVar4 + 1) {
if ((*pbVar4 == 0) || (pbVar7 <= pbVar4 + *pbVar4)) {
if (((undefined8 **)puVar9 == &DAT_180091000) ||
((*(byte *)((longlong)puVar9 + 0x1c) & 1) == 0)) goto LAB_18003d1e6;
uVar6 = 0x4c;
goto LAB_18003d14f;
}
}
}
else if (((undefined8 **)puVar9 != &DAT_180091000) &&
((*(byte *)((longlong)puVar9 + 0x1c) & 4) != 0)) {
FUN_1800432ec(puVar9[2],0x50,&DAT_180082c58,*puVar8);
puVar9 = DAT_180091000;
}
puVar8 = (uint *)((longlong)puVar8 +
((ulonglong)*(ushort *)(puVar8 + 1) + 0xd & 0xfffffffffffffff8));
} while ((ulonglong)((longlong)puVar8 + (-4 - (longlong)puVar3) >> 3) <
(ulonglong)(*puVar3 >> 3));
}
goto LAB_180013fe9;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar6 = 0x4e;
goto LAB_18003d1d6;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar6 = 0x4d;
LAB_18003d1d6:
uVar5 = DAT_180091000[2];
LAB_18003d1da:
FUN_180041cb0(uVar5,uVar6,&DAT_180082c58);
}
LAB_18003d1e6:
uVar5 = 0x80090326;
}
return uVar5;
}
=========================================
Function at address: 0x180014090
Called functions addresses: 0x180041cdc 0x18002a77b 0x18002a7c0


ulonglong FUN_180014090(longlong *param_1,undefined4 *param_2)

{
uint uVar1;
undefined uVar2;
longlong lVar3;
ulonglong uVar4;
undefined4 uVar5;
int iVar6;
uint uVar7;
undefined4 uVar8;

*param_2 = *(undefined4 *)((longlong)param_1 + 0x44);
uVar8 = 0;
*(longlong *)(param_2 + 2) = param_1[0x11];
param_2[4] = *(undefined4 *)(param_1 + 8);

*(undefined *)(param_2 + 0xb) = uVar2;
*(longlong *)(param_2 + 0x14) = param_1[0x10];
uVar5 = uVar8;
if (((*(byte *)(param_1 + 4) & 8) != 0) && (param_1[1] != 0)) {
uVar5 = *(undefined4 *)(param_1[1] + 0x1c);
}
param_2[5] = uVar5;
param_2[7] = *(undefined4 *)(param_1[0xb] + 8);
param_2[6] = *(undefined4 *)(param_1 + 2);
uVar5 = uVar8;
if ((*(byte *)(param_1 + 4) & 8) != 0) {
uVar5 = *(undefined4 *)((longlong)param_1 + 0x2c);
}
param_2[8] = uVar5;
param_2[0x26] = *(undefined4 *)((longlong)param_1 + 0x3c);
iVar6 = *(int *)((longlong)param_1 + 0x2c);
uVar1 = *(uint *)((longlong)param_1 + 0x34);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_180082b68,*(undefined4 *)(param_1 + 8));
}
if ((DAT_1800927bc != 2) &&
((((DAT_1800927bc == 1 || ((*(uint *)(param_1[10] + 0x9c) & 0x400) != 0)) &&
(*(int *)(param_1 + 8) - 3U < 0x2ff)) &&
(((*(int *)(param_1 + 8) - 0xfefdU & 0xfffffffd) != 0 && ((*(byte *)(param_1 + 7) & 1) != 0)))
))) {
uVar7 = *(uint *)(param_1 + 6);
if (uVar1 != 0) {
uVar7 = uVar7 + (uVar1 - uVar7 % uVar1);
}
iVar6 = *(int *)((longlong)param_1 + 0x3c) + -1 + *(int *)((longlong)param_1 + 0x2c) + uVar7;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xc,&DAT_180082b68,iVar6);
}
param_2[9] = iVar6;

uVar5 = uVar8;
if (lVar3 != 0) {
uVar5 = *(undefined4 *)(lVar3 + 0x1ac);
}
param_2[10] = uVar5;

if (-1 < (int)uVar4) {
*(longlong *)(param_2 + 0xc) = param_1[0x16];
*(longlong *)(param_2 + 0xe) = param_1[0x17];
param_2[0x16] = 0x20;
lVar3 = param_1[0xb];
if (*(ushort *)(lVar3 + 0xee) < 0x21) {
param_2[0x16] = (uint)*(ushort *)(lVar3 + 0xee);
memcpy(param_2 + 0x17,(void *)(lVar3 + 0xf0),(ulonglong)*(ushort *)(lVar3 + 0xee));
}
param_2[0x2c] = *(undefined4 *)(param_1 + 0x18);
*(longlong *)(param_2 + 0x28) = param_1[0x19];
*(longlong *)(param_2 + 0x2a) = param_1[0x1a];
*(undefined2 *)(param_2 + 0x2d) = *(undefined2 *)(param_1 + 0x1b);
*(undefined2 *)((longlong)param_2 + 0xb6) = *(undefined2 *)((longlong)param_1 + 0xda);
if ((undefined4 *)param_1[0x1c] != (undefined4 *)0x0) {
uVar8 = *(undefined4 *)param_1[0x1c];
}
param_2[0x2e] = uVar8;
param_2[0x2f] = DAT_1800919bc;

*(undefined *)(param_2 + 0x30) = uVar2;
uVar4 = uVar4 & 0xffffffff;
}
return uVar4;
}
=========================================
Function at address: 0x180014300
Called functions addresses: 0x180041cdc 0xEXTERNAL:000000f2


int FUN_180014300(longlong param_1,char *param_2,int param_3)

{
int iVar1;
undefined8 uVar2;
uint uVar3;
ulonglong uVar4;

if ((((param_2 != (char *)0x0) && (param_3 != 0)) && (*param_2 != '\0')) &&
(uVar4 = 0, *(int *)(param_1 + 0x224) != 0)) {
do {
if (*(undefined8 **)(param_1 + 8) == (undefined8 *)0x0) {
uVar2 = 0;
}
else {
uVar2 = **(undefined8 **)(param_1 + 8);
}
iVar1 = SslHashHandshake(uVar2,*(undefined8 *)(param_1 + 0x250 + uVar4 * 8),param_2,param_3,0)
;
if (iVar1 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar1;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return iVar1;
}
FUN_180041cdc(DAT_180091000[2],0xe,&DAT_180085740,iVar1);
return iVar1;
}
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
} while (uVar3 < *(uint *)(param_1 + 0x224));
}
return 0;
}
=========================================
Function at address: 0x1800143b0
Called functions addresses: 0x18002a7c0


void FUN_1800143b0(longlong *param_1,undefined8 *param_2,undefined4 *param_3,undefined8 *param_4,
undefined4 *param_5,undefined8 *param_6,undefined4 *param_7,undefined8 param_8,
undefined8 param_9,undefined8 param_10,undefined8 param_11,undefined8 param_12,
undefined8 param_13)

{
longlong lVar1;
undefined4 uVar2;


if (lVar1 == 0) {
*param_6 = 0;
*param_4 = 0;
uVar2 = 0;
*param_7 = 0;
param_7 = param_5;
}
else {
*param_4 = *(undefined8 *)(lVar1 + 400);
*param_5 = *(undefined4 *)(lVar1 + 0x198);
*param_6 = *(undefined8 *)(lVar1 + 0x1a0);
uVar2 = *(undefined4 *)(lVar1 + 0x1a8);
}
*param_7 = uVar2;
lVar1 = param_1[0xb];
*param_3 = *(undefined4 *)(lVar1 + 0x20);
*param_2 = *(undefined8 *)(lVar1 + 0x18);



return;
}
=========================================
Function at address: 0x180014500
Called functions addresses: 0xEXTERNAL:0000003f 0x180014543 0x18002a7c0


void FUN_180014500(longlong param_1,ulonglong param_2)

{
longlong lVar1;

lVar1 = *(longlong *)(*(longlong *)(param_1 + 0x80) + 0x18);
if (lVar1 != 0) {

FUN_180014543();
return;
}
if (DAT_180092620 != 0) {

return;
}
LocalAlloc(0x40,param_2 & 0xffffffff);
FUN_180014543();
return;
}
=========================================
Function at address: 0x180014543
Called functions addresses: None


void FUN_180014543(void)

{
return;
}
=========================================
Function at address: 0x180014550
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:0000018b 0xEXTERNAL:000000bc


ulonglong FUN_180014550(longlong param_1,longlong param_2,char param_3,char param_4)

{
int *piVar1;
longlong *plVar2;
int iVar3;
longlong *plVar4;
code *pcVar5;
ulonglong uVar6;
uint uVar7;

if ((param_3 != '\0') && (param_4 == '\0')) {
RtlAcquireResourceExclusive(param_1 + 0x30,1);
}
LOCK();
piVar1 = (int *)(param_2 + 0xe8);
iVar3 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
uVar7 = iVar3 - 1;
if (uVar7 == 1) {
LsaIModifyPerformanceCounter(iVar3 + 3,1,0);
if (param_3 == '\0') goto LAB_180014604;
plVar4 = *(longlong **)(param_1 + 0x28);
plVar2 = (longlong *)(param_2 + 0x140);
if (*plVar4 != param_1 + 0x20) {
pcVar5 = (code *)swi(0x29);
(*pcVar5)(3);
pcVar5 = (code *)swi(3);
uVar6 = (*pcVar5)();
return uVar6;
}
*plVar2 = param_1 + 0x20;
*(longlong **)(param_2 + 0x148) = plVar4;
*plVar4 = (longlong)plVar2;
*(longlong **)(param_1 + 0x28) = plVar2;
}
else if (param_3 == '\0') goto LAB_180014604;
if (param_4 == '\0') {
RtlReleaseResource(param_1 + 0x30);
}
LAB_180014604:
return (ulonglong)uVar7;
}
=========================================
Function at address: 0x180014630
Called functions addresses: 0x180041cb0 0x18002a77b 0x18002a7c0 0x180014734


undefined8 FUN_180014630(longlong *param_1,uint *param_2)

{
void *_Src;
ulonglong uVar1;
void *_Dst;
undefined2 uVar2;
longlong lVar3;
uint uVar4;

if (param_2 == (uint *)0x0) {
_Dst = (void *)0x0;
LAB_18001464e:
if (param_1[0x66] != 0) {

}
lVar3 = param_1[0x67];
param_1[0x66] = (longlong)_Dst;
if (lVar3 != 0) {
if (*(longlong *)(lVar3 + 8) != 0) {

lVar3 = param_1[0x67];
}

param_1[0x67] = 0;
}
return 0;
}
if (((param_2[1] == 0x15) && (uVar4 = *param_2, 5 < uVar4)) &&
(_Src = *(void **)(param_2 + 2), _Src != (void *)0x0)) {
uVar1 = FUN_180014734((longlong)_Src);
if (uVar4 < (uint)uVar1) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar2 = 0x5c;
}
else {
if (_Src == (void *)0xfffffffffffffffc) {
return 0x57;
}
if ((ushort)(*(short *)((longlong)_Src + 2) - 1U) < 0xff) {
uVar1 = FUN_180014734((longlong)_Src);

if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,_Src,uVar1 & 0xffffffff);
goto LAB_18001464e;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar2 = 0x5a;
}
}
else {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar2 = 0x5b;
}
FUN_180041cb0(DAT_180091000[2],uVar2,&DAT_180082c58);
return 0x80090326;
}
=========================================
Function at address: 0x180014734
Called functions addresses: None


ulonglong FUN_180014734(longlong param_1)

{
ulonglong uVar1;
ulonglong uVar2;

if (param_1 != 0) {
uVar1 = (ulonglong)*(ushort *)(param_1 + 2) + 4;
uVar2 = 6;
if (6 < uVar1) {
uVar2 = uVar1;
}
return uVar2;
}
return 0;
}
=========================================
Function at address: 0x180014760
Called functions addresses: 0x18005b470 0x18002a7c0 0xEXTERNAL:00000114


int FUN_180014760(longlong *param_1,int param_2,undefined4 *param_3,longlong param_4,
longlong param_5,int *param_6)

{
undefined2 uVar1;
uint uVar2;
undefined4 *puVar3;
uint uVar4;
int iVar5;
undefined8 uVar6;
longlong *plVar7;
ulonglong uVar8;

uVar4 = 0;
if (param_4 == 0) {
return 0x57;
}
puVar3 = *(undefined4 **)(param_4 + 8);
uVar2 = *(uint *)(param_4 + 4);
if (param_2 != 0) {
if (param_2 != 1) {
return 0x57;
}
if (param_3 == (undefined4 *)0x0) {
return 0x57;
}
if (uVar2 == 0) {
return 0x57;
}
*param_3 = *(undefined4 *)((longlong)param_1 + 0x24);
puVar3[1] = 0x16;
*puVar3 = 4;
*(undefined4 **)(puVar3 + 2) = param_3;
uVar4 = 1;
if ((*(uint *)(param_1 + 0x11) >> 0x1b & 1) != 0) {
if (param_5 == 0) {
return 0x57;
}
if (param_6 == (int *)0x0) {
return 0x57;
}
iVar5 = *param_6;
if (iVar5 == 0) {
return 0x57;
}
uVar1 = *(undefined2 *)((longlong)param_1 + 0x22);

plVar7 = (longlong *)param_1[1];
if (plVar7 != (longlong *)0x0) {
plVar7 = (longlong *)*plVar7;
}
iVar5 = SslComputeSessionHash(plVar7,uVar6,uVar1,param_5,iVar5,param_6,0);
if (iVar5 != 0) {
FUN_18005b470(param_1,0x25c,iVar5,0x33);
return iVar5;
}
if (uVar2 < 2) {
return 0x57;
}
puVar3[5] = 0x19;
puVar3[4] = *param_6;
iVar5 = 2;
*(longlong *)(puVar3 + 6) = param_5;
goto LAB_1800147de;
}
}
if (uVar2 < uVar4 + 2) {
return 0x57;
}
uVar8 = (ulonglong)uVar4;
*(longlong **)(puVar3 + uVar8 * 4 + 2) = param_1 + 0x22;
puVar3[uVar8 * 4 + 1] = 0x14;
puVar3[uVar8 * 4] = 0x20;
uVar8 = (ulonglong)(uVar4 + 1);
iVar5 = uVar4 + 2;
puVar3[uVar8 * 4 + 1] = 0x15;
puVar3[uVar8 * 4] = 0x20;
*(longlong **)(puVar3 + uVar8 * 4 + 2) = param_1 + 0x26;
LAB_1800147de:
*(int *)(param_4 + 4) = iVar5;
return 0;
}
=========================================
Function at address: 0x180014810
Called functions addresses: 0x18002a77b 0x180041cb0 0x18002a7c0


undefined8 FUN_180014810(longlong *param_1,uint *param_2,uint *param_3)

{
ushort *puVar1;
void *pvVar2;
undefined8 uVar3;
undefined2 uVar4;
uint uVar5;
size_t sVar6;

if (param_2 == (uint *)0x0) {
LAB_180014833:
if (param_3 != (uint *)0x0) {
if (((param_3[1] != 0x17) || (*param_3 < 4)) ||
(puVar1 = *(ushort **)(param_3 + 2), puVar1 == (ushort *)0x0)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar4 = 0x5f;
LAB_18003d726:
FUN_180041cb0(DAT_180091000[2],uVar4,&DAT_180082c58);
return 0x80090326;
}
uVar5 = *puVar1 + 2;
sVar6 = (size_t)uVar5;
if (uVar5 < 5) {
sVar6 = 4;
}
else if (*param_3 < uVar5) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar4 = 0x60;
goto LAB_18003d726;
}
if (param_1[0x6b] != 0) {

}

param_1[0x6b] = (longlong)pvVar2;
if (pvVar2 == (void *)0x0) goto LAB_18003d6fe;
memcpy(pvVar2,puVar1,sVar6);
}
uVar3 = 0;
}
else {
if (((param_2[1] != 0x16) || (*param_2 < 4)) ||
(puVar1 = *(ushort **)(param_2 + 2), puVar1 == (ushort *)0x0)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar4 = 0x5d;
goto LAB_18003d726;
}
uVar5 = *puVar1 + 2;
sVar6 = (size_t)uVar5;
if (uVar5 < 5) {
sVar6 = 4;
}
else if (*param_2 < uVar5) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar4 = 0x5e;
goto LAB_18003d726;
}
if (param_1[0x6a] != 0) {

}

param_1[0x6a] = (longlong)pvVar2;
if (pvVar2 != (void *)0x0) {
memcpy(pvVar2,puVar1,sVar6);
goto LAB_180014833;
}
LAB_18003d6fe:
uVar3 = 0xe;
}
return uVar3;
}
=========================================
Function at address: 0x180014860
Called functions addresses: 0xEXTERNAL:0000011c


void FUN_180014860(longlong param_1)

{
if (*(longlong *)(param_1 + 0x98) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x98),0);
*(undefined8 *)(param_1 + 0x98) = 0;
}
if (*(longlong *)(param_1 + 0x90) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x90),0);
*(undefined8 *)(param_1 + 0x90) = 0;
}
if ((*(char *)(param_1 + 0xe9) != '\0') && (*(char *)(param_1 + 0x108) != '\0')) {
*(undefined8 *)(param_1 + 0xf8) = 0;
}
return;
}
=========================================
Function at address: 0x1800148d0
Called functions addresses: 0x18007075c 0x180041cb0 0x18002a7c0 0x180003ea4 0x180070c68


int FUN_1800148d0(longlong *param_1,uint *param_2,uint *param_3)

{
int iVar1;
uint uVar2;
longlong *plVar3;
undefined2 uVar4;
ushort *puVar5;
byte *pbVar6;

puVar5 = (ushort *)0x0;
pbVar6 = (byte *)0x0;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
if ((param_2 == (uint *)0x0) && (param_3 == (uint *)0x0)) {
return 0;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcda;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return -0x7ff6fcda;
}
uVar4 = 0x54;
goto LAB_18003d8dd;
}
if ((param_1[0x48] != 0) &&
(plVar3 = (longlong *)(param_1[0x48] + 0x38), (longlong *)*plVar3 != plVar3)) {
return 0;
}
if (param_2 != (uint *)0x0) {
if (((param_2[1] != 0x13) || (*param_2 < 4)) ||
(puVar5 = *(ushort **)(param_2 + 2), puVar5 == (ushort *)0x0)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcda;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return -0x7ff6fcda;
}
uVar4 = 0x55;
goto LAB_18003d8dd;
}
if (*param_2 < *puVar5 + 2) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcda;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return -0x7ff6fcda;
}
uVar4 = 0x56;
goto LAB_18003d8dd;
}
iVar1 = FUN_180070c68((short *)(puVar5 + 1),*puVar5,1);
if (iVar1 != 0) {
return iVar1;
}
}
if (param_3 != (uint *)0x0) {
if (((param_2 == (uint *)0x0) || (param_3[1] != 0x14)) ||
((*param_3 < 2 || (pbVar6 = *(byte **)(param_3 + 2), pbVar6 == (byte *)0x0)))) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcda;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return -0x7ff6fcda;
}
uVar4 = 0x57;
goto LAB_18003d8dd;
}
if ((*pbVar6 == 0) || (*param_3 < *pbVar6 + 1)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcda;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return -0x7ff6fcda;
}
uVar4 = 0x58;
goto LAB_18003d8dd;
}
}
if (puVar5 == (ushort *)0x0) {
iVar1 = 0;
}
else {
iVar1 = *puVar5 + 2;
}
if (pbVar6 == (byte *)0x0) {
uVar2 = 0;
}
else {
uVar2 = (uint)*pbVar6;
}
if (uVar2 + 1 + iVar1 < 0x10000) {
iVar1 = FUN_18007075c(param_1,puVar5);
if (iVar1 != 0) {
return iVar1;
}

if (iVar1 == 0) {
FUN_180003ea4(param_1);
return 0;
}
return iVar1;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcda;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return -0x7ff6fcda;
}
uVar4 = 0x59;
LAB_18003d8dd:
FUN_180041cb0(DAT_180091000[2],uVar4,&DAT_180082c58);
return -0x7ff6fcda;
}
=========================================
Function at address: 0x180014940
Called functions addresses: 0x18005b628 0x180041cb0


undefined8 FUN_180014940(longlong param_1,int *param_2)

{
short sVar1;
ushort uVar2;

if ((*(char *)(param_1 + 0xe9) != '\0') && (param_2 != (int *)0x0)) {
if ((param_2[1] != 0x18) || ((*param_2 != 2 || (*(ushort **)(param_2 + 2) == (ushort *)0x0)))) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x61,&DAT_180082c58);
}
return 0x80090326;
}
uVar2 = **(ushort **)(param_2 + 2);
if (((0x10000 < uVar2) || (uVar2 < 200)) ||
(sVar1 = FUN_18005b628(param_1,(uint)uVar2), sVar1 == 0)) {
return 0x57;
}
*(ushort *)(param_1 + 0xd8) = uVar2;
*(short *)(param_1 + 0xda) = sVar1;
}
return 0;
}
=========================================
Function at address: 0x180014970
Called functions addresses: None


void FUN_180014970(undefined8 param_1,undefined8 *param_2,undefined8 *param_3)

{
if (param_2 != (undefined8 *)0x0) {
*param_2 = 0;
}
if (param_3 != (undefined8 *)0x0) {
*param_3 = 0;
}
return;
}
=========================================
Function at address: 0x180014990
Called functions addresses: None


int FUN_180014990(longlong param_1,longlong *param_2,int *param_3)

{
uint uVar1;

*param_2 = param_1 + 0x155;
uVar1 = *(uint *)(param_1 + 0x40) & 0x3fc0;
*param_3 = (-(uint)(uVar1 != 0) & 0xffffffe8) + 0x24;
return -uVar1;
}
=========================================
Function at address: 0x1800149c0
Called functions addresses: 0x180014ab0 0x18003da5d 0x18003da05 0x180014c84 0x180012e50


void FUN_1800149c0(longlong *param_1,int param_2,byte *param_3,uint param_4)

{
int iVar1;
undefined8 uVar2;

iVar1 = *(int *)((longlong)param_1 + 0x44);
if (iVar1 == 0x33) {
if (((*(uint *)(param_1 + 0x11) >> 0x1e & 1) != 0) &&
(*(char *)((longlong)param_1 + 0x10a) == '\0')) {
iVar1 = FUN_180012e50(param_1,2);
if (iVar1 != 0) {
return;
}
param_1[0x11] = param_1[0x11] & 0xffffffffbfffffff;
}
iVar1 = 0x2e;
*(undefined4 *)((longlong)param_1 + 0x44) = 0x2e;
}
if (param_2 == 0x14) {
if (iVar1 != 0x2e) {
if (iVar1 == 0x2f) {
if (((ulonglong)param_1[0x11] >> 0x18 & 1) != 0) {
FUN_18003da5d();
return;
}
}
else if (iVar1 + -0x32 != 0) {
FUN_18003da05(iVar1 + -0x32);
return;
}
}
uVar2 = FUN_180014c84(param_1,(char *)param_3,param_4);
if ((int)uVar2 == 0) {
if ((*(int *)((longlong)param_1 + 0x44) == 0x2f) ||
(*(int *)((longlong)param_1 + 0x44) == 0x34)) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x30;
}
else {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x2d;
}
}
}
FUN_180014ab0(param_1,param_2,param_3,(ulonglong)param_4);
return;
}
=========================================
Function at address: 0x180014ab0
Called functions addresses: 0x180014b9c


/* WARNING: Removing unreachable block (ram,0x000180014b94) */

int FUN_180014ab0(longlong *param_1,int param_2,byte *param_3,ulonglong param_4)

{
longlong lVar1;
int iVar2;
ulonglong uVar3;
longlong *plVar4;
undefined8 uVar5;
uint uVar6;
uint uVar7;
longlong lVar8;
uint uVar9;
char acStackX_8 [8];
uint local_38 [4];

uVar7 = (uint)param_4;
uVar3 = param_4 & 0xffffffff;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
plVar4 = (longlong *)param_1[0x3a];
iVar2 = 0;
local_38[0] = 0;
if ((plVar4 != (longlong *)0x0) && (*(int *)((longlong)plVar4 + 0x24) != 0)) {
if (param_2 == 0x16) {
uVar5 = FUN_18007037c(plVar4,param_3,uVar7,0,local_38);
if ((int)uVar5 != 0) {
return (int)uVar5;
}
lVar8 = param_1[0x3a];
uVar9 = *(uint *)(lVar8 + 0x20);
uVar6 = (-(uint)(*(int *)(lVar8 + 0x28) != 0) & 8) + 4;
if ((uVar9 <= uVar6) || (*(uint *)(lVar8 + 0x24) < uVar9)) {
if (*(uint *)(lVar8 + 0x24) < uVar6) {
return 0;
}
lVar1 = *(longlong *)(lVar8 + 0x18);
if ((uint)*(byte *)(lVar1 + 2) * 0x100 + (uint)*(byte *)(lVar1 + 1) * 0x10000 +
(uint)*(byte *)(lVar1 + 3) != 0) {
return 0;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x45,&DAT_180082c58,uVar9);
lVar8 = param_1[0x3a];
}
iVar2 = FUN_180014b9c(param_1,*(undefined8 *)(lVar8 + 0x18),*(undefined4 *)(lVar8 + 0x20));
if (iVar2 == 0) {
*(undefined8 *)(param_1[0x3a] + 0x20) = 0;
uVar3 = FUN_180014b89(uVar7 != local_38[0]);
return (int)uVar3;
}
return iVar2;
}
if (param_2 == 0x15) {
plVar4[4] = 0;
uVar3 = FUN_180014b89('\x01');
return (int)uVar3;
}
}
if (param_2 == 0x15) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x39,&DAT_180082c58);
}
uVar5 = FUN_18000172c(param_3,uVar7,(byte *)((longlong)param_1 + 0x1d9),acStackX_8);
iVar2 = (int)uVar5;
if (iVar2 == 0) {
if (acStackX_8[0] != '\0') {
*(undefined *)(param_1 + 0x45) = 1;
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4b;
}
}
else if (((iVar2 == -0x7ff6fc99) || (*(uint *)((longlong)param_1 + 0x24) < 0x302)) ||
((*(uint *)(param_1 + 8) & 0x800a00aa) == 0)) {
if (uVar7 == 2) {
FUN_1800451f4(*(uint *)(param_1[10] + 0xd4),param_1[10] + 0xd8,*param_3);
}
}
else {
FUN_180012184((longlong)param_1,0xe,iVar2);
iVar2 = -0x7ff6fcda;
}
}
else if (param_2 == 0x16) {
do {
uVar7 = (uint)uVar3;
if (uVar7 < 4) {
plVar4 = (longlong *)param_1[0x3a];
if (plVar4 != (longlong *)0x0) goto LAB_18003ddd8;
uVar9 = DAT_1800919f0;
if (((*(uint *)(param_1 + 8) & 0x40051555) != 0) &&
(uVar9 = DAT_1800919ec, (*(uint *)(param_1 + 0x11) & 0x100) != 0)) {
uVar6 = DAT_1800919e8;
if (DAT_1800919e8 < DAT_1800919ec) {
uVar6 = DAT_1800919ec;
}
if (uVar6 == 0) goto LAB_18003dd3d;
}
if (uVar9 == 0) {
LAB_18003dd3d:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x43,&DAT_180082c58);
}
FUN_18005b470(param_1,0xc,0x80090326,10);
return -0x7ff6fcda;
}
plVar4 = (longlong *)FUN_18000a1d0((longlong)param_1,0x30);
joined_r0x00018003de60:
if (plVar4 == (longlong *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x44,&DAT_180082c58);
}
return 0xe;
}
*plVar4 = 0;
*(undefined8 *)((longlong)plVar4 + 0xc) = 0x100;
plVar4[3] = 0;
plVar4[4] = 0;
param_1[0x3a] = (longlong)plVar4;
FUN_18006ff64(plVar4,(longlong)param_1);
plVar4 = (longlong *)param_1[0x3a];
LAB_18003ddd8:
local_38[0] = 0;
uVar5 = FUN_18007037c(plVar4,param_3,uVar7,1,local_38);
return (int)uVar5;
}
uVar9 = (uint)param_3[2] * 0x100 + (uint)param_3[1] * 0x10000 + (uint)param_3[3];
if (uVar3 < (ulonglong)uVar9 + 4) {
plVar4 = (longlong *)param_1[0x3a];
if (plVar4 != (longlong *)0x0) goto LAB_18003ddd8;
uVar9 = DAT_1800919f0;
if (((*(uint *)(param_1 + 8) & 0x40051555) != 0) &&
(uVar9 = DAT_1800919ec, (*(uint *)(param_1 + 0x11) & 0x100) != 0)) {
uVar6 = DAT_1800919e8;
if (DAT_1800919e8 < DAT_1800919ec) {
uVar6 = DAT_1800919ec;
}
if (uVar6 == 0) goto LAB_18003dd3d;
}
if (uVar9 == 0) goto LAB_18003dd3d;
plVar4 = (longlong *)FUN_18000a1d0((longlong)param_1,0x30);
goto joined_r0x00018003de60;
}
iVar2 = FUN_180014b9c(param_1,param_3,uVar9 + 4);
if (iVar2 != 0) {
return iVar2;
}
param_3 = param_3 + (ulonglong)uVar9 + 4;
uVar7 = uVar7 + (-4 - uVar9);
uVar3 = (ulonglong)uVar7;
iVar2 = 0;
} while (uVar7 != 0);
}
}
else {
iVar2 = FUN_18006f914(param_1,param_2,param_3,uVar7);
}
return iVar2;
}
=========================================
Function at address: 0x180014b89
Called functions addresses: 0x18006ff64 0x180041cb0 0x18007037c 0x18000172c 0x18000a1d0 0x180012184 0x18005b470 0x1800451f4


ulonglong FUN_180014b89(char param_1)

{
uint uVar1;
ulonglong uVar2;
ulonglong *puVar3;
undefined8 uVar4;
longlong *plVar5;
int unaff_EBX;
uint unaff_EBP;
byte *unaff_RSI;
longlong *unaff_RDI;
uint uVar6;
ulonglong unaff_R12;
uint uVar7;
undefined8 *unaff_R14;
bool bVar8;
uint uStack0000000000000030;
char in_stack_00000070;

uVar6 = (uint)unaff_R12;
uVar2 = unaff_R12 & 0xffffffff;
if (param_1 != '\0') {
if (unaff_EBX == 0x15) {
if ((DAT_180091000 != unaff_R14) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x39,&DAT_180082c58);
}
uVar4 = FUN_18000172c(unaff_RSI,unaff_EBP,(byte *)((longlong)unaff_RDI + 0x1d9),
&stack0x00000070);
uVar1 = (uint)uVar4;
if (uVar1 == 0) {
if (in_stack_00000070 != (char)unaff_R12) {
*(undefined *)(unaff_RDI + 0x45) = 1;
*(undefined4 *)((longlong)unaff_RDI + 0x44) = 0x4b;
}
}
else if (((uVar1 == 0x80090367) || (*(uint *)((longlong)unaff_RDI + 0x24) < 0x302)) ||
((*(uint *)(unaff_RDI + 8) & 0x800a00aa) == 0)) {
if (unaff_EBP == 2) {
FUN_1800451f4(*(uint *)(unaff_RDI[10] + 0xd4),unaff_RDI[10] + 0xd8,*unaff_RSI);
}
}
else {
FUN_180012184((longlong)unaff_RDI,0xe,uVar1);
uVar1 = 0x80090326;
}
}
else {
uVar1 = uVar6;
if (unaff_EBX == 0x16) {
do {
if (unaff_EBP < 4) {
plVar5 = (longlong *)unaff_RDI[0x3a];
if (plVar5 == (longlong *)0x0) {
if ((*(uint *)(unaff_RDI + 8) & 0x40051555) == 0) {
bVar8 = DAT_1800919f0 == uVar6;
}
else {
if ((*(uint *)(unaff_RDI + 0x11) & 0x100) != 0) {
uVar1 = DAT_1800919e8;
if (DAT_1800919e8 < DAT_1800919ec) {
uVar1 = DAT_1800919ec;
}
if (uVar1 == 0) goto LAB_18003dd3d;
}
bVar8 = DAT_1800919ec == 0;
}
if (bVar8) goto LAB_18003dd3d;
puVar3 = (ulonglong *)FUN_18000a1d0((longlong)unaff_RDI,0x30);
if (puVar3 == (ulonglong *)0x0) goto LAB_18003dd89;
LAB_18003ddb0:
*puVar3 = unaff_R12;
*(undefined8 *)((longlong)puVar3 + 0xc) = 0x100;
puVar3[3] = unaff_R12;
puVar3[4] = unaff_R12;
unaff_RDI[0x3a] = (longlong)puVar3;
FUN_18006ff64((longlong *)puVar3,(longlong)unaff_RDI);
plVar5 = (longlong *)unaff_RDI[0x3a];
}
LAB_18003ddd8:
uStack0000000000000030 = uVar6;
uVar4 = FUN_18007037c(plVar5,unaff_RSI,unaff_EBP,1,&stack0x00000030);
uVar1 = (uint)uVar4;
break;
}
uVar7 = (uint)unaff_RSI[2] * 0x100 + (uint)unaff_RSI[1] * 0x10000 + (uint)unaff_RSI[3];
if ((ulonglong)unaff_EBP < (ulonglong)uVar7 + 4) {
plVar5 = (longlong *)unaff_RDI[0x3a];
if (plVar5 != (longlong *)0x0) goto LAB_18003ddd8;
if ((*(uint *)(unaff_RDI + 8) & 0x40051555) == 0) {
bVar8 = DAT_1800919f0 == uVar6;
}
else {
if ((*(uint *)(unaff_RDI + 0x11) & 0x100) != 0) {
uVar1 = DAT_1800919e8;
if (DAT_1800919e8 < DAT_1800919ec) {
uVar1 = DAT_1800919ec;
}
if (uVar1 == 0) goto LAB_18003dd3d;
}
bVar8 = DAT_1800919ec == 0;
}
if (bVar8) {
LAB_18003dd3d:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x43,&DAT_180082c58);
}
FUN_18005b470(unaff_RDI,0xc,0x80090326,10);
uVar1 = 0x80090326;
}
else {
puVar3 = (ulonglong *)FUN_18000a1d0((longlong)unaff_RDI,0x30);
if (puVar3 != (ulonglong *)0x0) goto LAB_18003ddb0;
LAB_18003dd89:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x44,&DAT_180082c58);
}
uVar1 = 0xe;
}
break;
}
uVar1 = FUN_180014b9c(unaff_RDI,unaff_RSI,uVar7 + 4);
if (uVar1 != 0) break;
unaff_RSI = unaff_RSI + (ulonglong)uVar7 + 4;
unaff_EBP = unaff_EBP + (-4 - uVar7);
} while (unaff_EBP != 0);
}
}
uVar2 = (ulonglong)uVar1;
}
return uVar2;
}
=========================================
Function at address: 0x180014b9c
Called functions addresses: 0x18002a7c0 0x18006a8f8


int FUN_180014b9c(longlong *param_1,undefined *param_2,undefined4 param_3)

{
int iVar1;
int iVar2;
int local_res8 [2];

local_res8[0] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18006a8f8(DAT_180091000[2],0x3a,&DAT_180082c58,*(undefined4 *)(param_1 + 8),*param_2,
(char)*(undefined4 *)((longlong)param_1 + 0x44));
}

if ((((iVar1 == 0) || (iVar1 == 0x90320)) && (local_res8[0] == 0)) &&
((*(int *)(param_1 + 0x6d) == 0 &&

)))) {
iVar1 = iVar2;
}
if (*(char *)((longlong)param_1 + 0x39b) == '\0') {
if (iVar1 == 0x90320) {
*(undefined *)((longlong)param_1 + 0x39c) = 1;
}
}
else {
iVar1 = 0x90312;
*(undefined4 *)(param_1 + 9) = *(undefined4 *)((longlong)param_1 + 0x44);
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4d;
}
return iVar1;
}
=========================================
Function at address: 0x180014c84
Called functions addresses: 0x180041cb0 0x18005b470 0xEXTERNAL:0000011c


undefined8 FUN_180014c84(longlong *param_1,char *param_2,int param_3)

{
longlong lVar1;
char cVar2;
undefined8 uVar3;

if ((param_3 == 1) && (*param_2 == '\x01')) {
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 10;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
lVar1 = param_1[0x14];
param_1[0x14] = 0;
param_1[0x12] = lVar1;
cVar2 = *(char *)((longlong)param_1 + 0xe9);
if (cVar2 == '\0') {
param_1[0x16] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180082c58);
cVar2 = *(char *)((longlong)param_1 + 0xe9);
}
if (cVar2 != '\0') {
*(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + 1;
param_1[0x1a] = 0;
param_1[0x19] = 0;
}
uVar3 = 0;
}
else {
FUN_18005b470(param_1,0x388,0x80090326,10);
uVar3 = 0x80090326;
}
return uVar3;
}
=========================================
Function at address: 0x180014d20
Called functions addresses: 0x18005b6e8


undefined8 FUN_180014d20(longlong param_1,int param_2)

{
undefined8 uVar1;

if (param_2 == 0) {
return *(undefined8 *)(param_1 + 0x250);
}
uVar1 = FUN_18005b6e8(param_1,param_2);
return uVar1;
}
=========================================
Function at address: 0x180014d38
Called functions addresses: 0x180028d3c


undefined8 FUN_180014d38(undefined8 param_1)

{
longlong lVar1;
uint uVar2;
int iVar3;
uint uVar4;
ulonglong uVar5;

uVar5 = 0;
uVar2 = DAT_180092324;
if (DAT_180092324 != 0) {
do {
if ((((longlong *)(&DAT_180092330)[uVar5] != (longlong *)0x0) &&
(lVar1 = *(longlong *)(&DAT_180092330)[uVar5], lVar1 != 0)) &&
(iVar3 = _o__wcsnicmp(param_1,lVar1,0x40), uVar2 = DAT_180092324, iVar3 == 0)) {
return (&DAT_180092330)[uVar5];
}
uVar4 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar4;
} while (uVar4 < uVar2);
}
return 0;
}
=========================================
Function at address: 0x180014db8
Called functions addresses: 0x180053b60 0x180014fd4 0x180015030 0x18000909c 0x180014f8c 0x18000a1f4 0x180015120


ulonglong FUN_180014db8(longlong param_1,undefined8 *param_2,int *param_3)

{
undefined8 *puVar1;
longlong lVar2;
int iVar3;
DWORD DVar4;
uint uVar5;
undefined4 extraout_var;
undefined8 *puVar6;
undefined4 extraout_var_00;
undefined4 extraout_var_01;
ulonglong uVar7;
DWORD local_res8 [2];
int local_res20 [2];
longlong local_38 [2];

lVar2 = *(longlong *)(param_1 + 0x18);
local_38[0] = 0;
puVar1 = (undefined8 *)(lVar2 + 0x60);
if (puVar1 == (undefined8 *)0x0) {
LAB_180014f6f:
uVar7 = 0x80090304;
}
else {
iVar3 = FUN_180014fd4((char *)*puVar1);
if (iVar3 == 0) {
return 0x8009030d;
}
local_res20[0] = iVar3;
if (iVar3 == 0x2200) {
DVar4 = FUN_180053b60((longlong)puVar1,(undefined4 *)0x0,local_res8);
if (DVar4 != 0) {
return CONCAT44(extraout_var_01,DVar4);
}
if ((local_res8[0] <= local_res8[0] + 0x10) &&
(puVar6 = (undefined8 *)FUN_18000a1f4((ulonglong)(local_res8[0] + 0x10)),
puVar6 != (undefined8 *)0x0)) {
*puVar6 = puVar6 + 2;
*(DWORD *)(puVar6 + 1) = local_res8[0];
uVar5 = FUN_180053b60((longlong)puVar1,(undefined4 *)(puVar6 + 2),(uint *)(puVar6 + 1));
LAB_180014e6d:
if (uVar5 != 0) {
FUN_18000909c(puVar6);
return (ulonglong)uVar5;
}
LAB_180014f0b:
*param_2 = puVar6;
if (param_3 != (int *)0x0) {
*param_3 = iVar3;
}
return 0;
}
}
else if (iVar3 == 0x2203) {
DVar4 = FUN_180015120(*(BYTE **)(lVar2 + 0x70),*(DWORD *)(lVar2 + 0x68),local_38,local_res20);
if (DVar4 != 0) {
return CONCAT44(extraout_var_00,DVar4);
}
uVar7 = FUN_180015030((longlong)puVar1,local_38[0],(undefined4 *)0x0,local_res8);
if ((int)uVar7 != 0) {
return uVar7;
}
if (local_res8[0] + 0x10 < 0x10) {
return 0x216;
}
puVar6 = (undefined8 *)FUN_18000a1f4((ulonglong)(local_res8[0] + 0x10));
if (puVar6 != (undefined8 *)0x0) {
*puVar6 = puVar6 + 2;
*(DWORD *)(puVar6 + 1) = local_res8[0];
uVar7 = FUN_180015030((longlong)puVar1,local_38[0],(undefined4 *)(puVar6 + 2),
(uint *)(puVar6 + 1));
iVar3 = local_res20[0];
if ((int)uVar7 != 0) {
FUN_18000909c(puVar6);
return uVar7 & 0xffffffff;
}
goto LAB_180014f0b;
}
}
else {
if (iVar3 != 0xa400) goto LAB_180014f6f;
DVar4 = FUN_180014f8c((longlong)puVar1,(void *)0x0,local_res8);
if (DVar4 != 0) {
return CONCAT44(extraout_var,DVar4);
}
if (local_res8[0] + 0x10 < 0x10) {
return 0x216;
}
puVar6 = (undefined8 *)FUN_18000a1f4((ulonglong)(local_res8[0] + 0x10));
if (puVar6 != (undefined8 *)0x0) {
*puVar6 = puVar6 + 2;
*(DWORD *)(puVar6 + 1) = local_res8[0];
uVar5 = FUN_180014f8c((longlong)puVar1,puVar6 + 2,(DWORD *)(puVar6 + 1));
goto LAB_180014e6d;
}
}
uVar7 = 0x80090300;
}
return uVar7;
}
=========================================
Function at address: 0x180014f8c
Called functions addresses: 0xEXTERNAL:00000041 0xEXTERNAL:0000014e


DWORD FUN_180014f8c(longlong param_1,void *param_2,DWORD *param_3)

{
BOOL BVar1;
DWORD DVar2;

BVar1 = CryptDecodeObject(1,&DAT_00000013,*(BYTE **)(param_1 + 0x20),*(DWORD *)(param_1 + 0x18),0,
param_2,param_3);
if (BVar1 != 0) {
return 0;
}
/* WARNING: Could not recover jumptable at 0x00018003dff4. Too many branches */

DVar2 = GetLastError();
return DVar2;
}
=========================================
Function at address: 0x180014fd4
Called functions addresses: None


undefined4 FUN_180014fd4(char *param_1)

{
char cVar1;
char cVar2;
uint uVar3;
ulonglong uVar4;
char *pcVar5;
undefined **ppuVar6;

ppuVar6 = &PTR_s_1_2_840_113549_1_1_1_18007d750;
uVar4 = 0;
do {
pcVar5 = param_1;
do {
cVar1 = *pcVar5;
cVar2 = pcVar5[(longlong)*ppuVar6 - (longlong)param_1];
if (cVar1 != cVar2) break;
pcVar5 = pcVar5 + 1;
} while (cVar2 != '\0');
if (cVar1 == cVar2) {
return (&DAT_18007d758)[uVar4 * 4];
}
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
ppuVar6 = ppuVar6 + 2;
if (7 < uVar3) {
return 0;
}
} while( true );
}
=========================================
Function at address: 0x180015030
Called functions addresses: 0x18002a77b


undefined8 FUN_180015030(longlong param_1,longlong param_2,undefined4 *param_3,uint *param_4)

{
uint uVar1;
int iVar2;
undefined4 uVar3;
longlong lVar4;
char *pcVar5;
int iVar6;
undefined8 uVar7;

uVar7 = 0;
if ((((param_2 != 0) && (lVar4 = *(longlong *)(param_2 + 0x28), lVar4 != 0)) &&
(*(uint *)(param_2 + 0x20) != 0)) &&
(((param_1 != 0 && (pcVar5 = *(char **)(param_1 + 0x20), pcVar5 != (char *)0x0)) &&
((iVar2 = *(int *)(param_1 + 0x18), iVar2 != 0 &&
(0xb < (*(uint *)(param_2 + 0x20) & 0xfffffffc))))))) {
uVar3 = *(undefined4 *)(lVar4 + 4);
iVar6 = (uint)((*(uint *)(lVar4 + 8) & 7) != 0) + (*(uint *)(lVar4 + 8) >> 3);
if (iVar6 != 0) {
uVar1 = iVar6 * 2 + 0x10;
if (param_3 != (undefined4 *)0x0) {
if (uVar1 <= *param_4) {
param_3[3] = iVar6;
*param_3 = 0x206;
param_3[1] = 0x2203;
param_3[2] = uVar3;
if (iVar6 * 2 + 1U != iVar2) {
return 0x8009035d;
}
if ((*pcVar5 - 4U & 0xfc) != 0) {
return 0x8009035d;
}
if (*pcVar5 == '\x05') {
return 0x8009035d;
}
memcpy(param_3 + 4,pcVar5 + 1,(ulonglong)(uint)(iVar6 * 2));
return 0;
}
uVar7 = 0x80090321;
}
*param_4 = uVar1;
return uVar7;
}
}
return 0x8009035d;
}
=========================================
Function at address: 0x180015120
Called functions addresses: 0xEXTERNAL:00000141 0xEXTERNAL:00000040 0xEXTERNAL:0000014d 0xEXTERNAL:00000041 0x180015504


DWORD FUN_180015120(BYTE *param_1,DWORD param_2,undefined8 *param_3,undefined4 *param_4)

{
BOOL BVar1;
DWORD DVar2;
PCCRYPT_OID_INFO pCVar3;
undefined8 uVar4;
void *pvKey;
DWORD local_18 [2];
undefined8 *local_10;

local_10 = (undefined8 *)0x0;
local_18[0] = 8;
BVar1 = CryptDecodeObjectEx(1,(LPCSTR)0x49,param_1,param_2,0x8000,(PCRYPT_DECODE_PARA)0x0,
&local_10,local_18);
if (BVar1 == 0) {
DVar2 = GetLastError();
}
else {
pvKey = (void *)*local_10;
pCVar3 = CryptFindOIDInfo(1,pvKey,3);
*param_3 = pCVar3;
if (pCVar3 == (PCCRYPT_OID_INFO)0x0) {
DVar2 = 0x8009030d;
}
else {
uVar4 = FUN_180015504(*(undefined8 *)(pCVar3 + 1),pvKey,param_4);
DVar2 = (DWORD)uVar4;
if (DVar2 != 0) {
DVar2 = 0x8009030d;
}
}
}
if (local_10 != (undefined8 *)0x0) {
LocalFree(local_10);
}
return DVar2;
}
=========================================
Function at address: 0x1800151f0
Called functions addresses: 0x18001529c 0x180028d3c


undefined8 FUN_1800151f0(undefined8 param_1,undefined8 param_2,undefined4 *param_3)

{
uint uVar1;
int iVar2;
longlong lVar3;
uint uVar4;
ulonglong uVar5;
undefined8 uVar6;

if (param_3 != (undefined4 *)0x0) {
*param_3 = 0;
}
uVar5 = 0;
uVar1 = DAT_1800923b0;
if (DAT_1800923b0 != 0) {
do {
if (((longlong *)(&DAT_1800923c0)[uVar5] != (longlong *)0x0) &&
(lVar3 = *(longlong *)(&DAT_1800923c0)[uVar5], lVar3 != 0)) {
uVar6 = 0x40;
iVar2 = _o__wcsnicmp(param_1);
uVar1 = DAT_1800923b0;
if (iVar2 == 0) {
if ((&DAT_1800923c0)[uVar5] == 0) {
return 0x490;
}
uVar6 = FUN_18001529c((&DAT_1800923c0)[uVar5],lVar3,uVar6,param_3,(undefined4 *)0x0);
return uVar6;
}
}
uVar4 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar4;
} while (uVar4 < uVar1);
}
return 0x490;
}
=========================================
Function at address: 0x18001529c
Called functions addresses: None


undefined8
FUN_18001529c(longlong param_1,undefined8 param_2,undefined8 param_3,undefined4 *param_4,
undefined4 *param_5)

{
if (param_4 != (undefined4 *)0x0) {
*param_4 = *(undefined4 *)(param_1 + 0xc);
}
if (param_5 != (undefined4 *)0x0) {
*param_5 = *(undefined4 *)(param_1 + 0x10);
}
return 0;
}
=========================================
Function at address: 0x1800152c4
Called functions addresses: 0x180015484 0x180041cdc 0x180041cb0 0x18002a77b 0x18002a7c0 0x1800153d0


undefined8 FUN_1800152c4(longlong *param_1,byte *param_2,ushort param_3)

{
longlong lVar1;
undefined8 uVar2;
byte *pbVar3;
undefined4 *puVar4;

uVar2 = FUN_180015484(2,param_2,param_3,0);
if ((int)uVar2 == 0) {
lVar1 = param_1[0x62];
if (lVar1 == 0) {
uVar2 = 0x57;
}
else {
pbVar3 = FUN_1800153d0((byte *)(lVar1 + 6),*(ushort *)(lVar1 + 4),param_2,param_3);
if (pbVar3 == (byte *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x44,&DAT_180085810);
}
uVar2 = 0x80090367;
}
else {
puVar4 = (undefined4 *)param_1[99];
if (puVar4 == (undefined4 *)0x0) {

param_1[99] = (longlong)puVar4;
if (puVar4 == (undefined4 *)0x0) {
return 0xe;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x45,&DAT_180085810,(uint)*pbVar3);
puVar4 = (undefined4 *)param_1[99];
}
*puVar4 = 1;
*(undefined4 *)(param_1[99] + 4) = 2;
*(byte *)(param_1[99] + 8) = *pbVar3;
memcpy((void *)(param_1[99] + 9),pbVar3 + 1,(ulonglong)*pbVar3);
uVar2 = 0;
}
}
}
return uVar2;
}
=========================================
Function at address: 0x1800153d0
Called functions addresses: 0xEXTERNAL:00000075


byte * FUN_1800153d0(byte *param_1,ushort param_2,byte *param_3,ushort param_4)

{
ulonglong uVar1;
ulonglong uVar2;
byte *pbVar3;
byte *pbVar4;

if (((param_1 != (byte *)0x0) && (param_3 != (byte *)0x0)) &&
(pbVar4 = param_1 + param_2, param_1 < pbVar4)) {
do {
if (param_3 < param_3 + param_4) {
uVar2 = (ulonglong)*param_1;
pbVar3 = param_3;
do {
if ((byte)uVar2 == *pbVar3) {
uVar1 = RtlCompareMemory(param_1 + 1,pbVar3 + 1,uVar2);
uVar2 = (ulonglong)*param_1;
if (uVar1 == uVar2) {
return param_1;
}
}
pbVar3 = pbVar3 + (ulonglong)*pbVar3 + 1;
} while (pbVar3 < param_3 + param_4);
}
param_1 = param_1 + (ulonglong)*param_1 + 1;
} while (param_1 < pbVar4);
}
return (byte *)0x0;
}
=========================================
Function at address: 0x180015484
Called functions addresses: 0x180041cb0


undefined8 FUN_180015484(int param_1,byte *param_2,ushort param_3,int param_4)

{
byte *pbVar1;
undefined2 uVar2;

if ((param_2 == (byte *)0x0) || (param_1 != 2)) {
return 0x57;
}
if ((ushort)(param_3 - 2) < 0xfffc) {
if ((param_4 == 0) && ((ushort)(*param_2 + 1) < param_3)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar2 = 0x4b;
}
else {
pbVar1 = param_2 + param_3;
while( true ) {
if (pbVar1 <= param_2) {
return 0;
}
if ((*param_2 == 0) || (pbVar1 <= param_2 + *param_2)) break;
param_2 = param_2 + *param_2 + 1;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar2 = 0x4c;
}
}
else {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar2 = 0x4a;
}
FUN_180041cb0(DAT_180091000[2],uVar2,&DAT_180082c58);
return 0x80090326;
}
=========================================
Function at address: 0x180015504
Called functions addresses: 0x1800155b4 0x180028d3c


undefined8 FUN_180015504(undefined8 param_1,undefined8 param_2,undefined4 *param_3)

{
uint uVar1;
int iVar2;
longlong lVar3;
uint uVar4;
ulonglong uVar5;
undefined8 uVar6;

if (param_3 != (undefined4 *)0x0) {
*param_3 = 0;
}
uVar5 = 0;
uVar1 = DAT_180092218;
if (DAT_180092218 != 0) {
do {
if (((longlong *)(&DAT_180092220)[uVar5] != (longlong *)0x0) &&
(lVar3 = *(longlong *)(&DAT_180092220)[uVar5], lVar3 != 0)) {
uVar6 = 0x40;
iVar2 = _o__wcsnicmp(param_1);
uVar1 = DAT_180092218;
if (iVar2 == 0) {
if ((&DAT_180092220)[uVar5] == 0) {
return 0x490;
}
uVar6 = FUN_1800155b4((&DAT_180092220)[uVar5],lVar3,uVar6,param_3,(undefined4 *)0x0,
(undefined4 *)0x0);
return uVar6;
}
}
uVar4 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar4;
} while (uVar4 < uVar1);
}
return 0x490;
}
=========================================
Function at address: 0x1800155b4
Called functions addresses: None


undefined8
FUN_1800155b4(longlong param_1,undefined8 param_2,undefined8 param_3,undefined4 *param_4,
undefined4 *param_5,undefined4 *param_6)

{
if (param_4 != (undefined4 *)0x0) {
*param_4 = *(undefined4 *)(param_1 + 0xc);
}
if (param_5 != (undefined4 *)0x0) {
*param_5 = *(undefined4 *)(param_1 + 0x10);
}
if (param_6 != (undefined4 *)0x0) {
*param_6 = *(undefined4 *)(param_1 + 0x14);
}
return 0;
}
=========================================
Function at address: 0x1800155ec
Called functions addresses: None


undefined8 FUN_1800155ec(void)

{
undefined8 *puVar1;
undefined *puVar2;
undefined **ppuVar3;
longlong lVar4;

puVar1 = &DAT_180092330;
lVar4 = 7;
puVar2 = &DAT_18007d340;
do {
*puVar1 = puVar2;
puVar2 = puVar2 + 0x18;
puVar1 = puVar1 + 1;
lVar4 = lVar4 + -1;
} while (lVar4 != 0);
DAT_180092324 = 7;
puVar1 = &DAT_180092220;
puVar2 = &DAT_18007d290;
lVar4 = 7;
do {
*puVar1 = puVar2;
puVar2 = puVar2 + 0x18;
puVar1 = puVar1 + 1;
lVar4 = lVar4 + -1;
} while (lVar4 != 0);
DAT_180092218 = 7;
puVar1 = &DAT_1800923c0;
ppuVar3 = &PTR_DAT_18007d1e0;
lVar4 = 7;
do {
*puVar1 = ppuVar3;
ppuVar3 = ppuVar3 + 3;
puVar1 = puVar1 + 1;
lVar4 = lVar4 + -1;
} while (lVar4 != 0);
DAT_1800923b0 = 7;
puVar1 = &DAT_1800922a0;
ppuVar3 = &PTR_DAT_18007d100;
lVar4 = 7;
do {
*puVar1 = ppuVar3;
ppuVar3 = ppuVar3 + 4;
puVar1 = puVar1 + 1;
lVar4 = lVar4 + -1;
} while (lVar4 != 0);
DAT_180092320 = 7;
return 0;
}
=========================================
Function at address: 0x1800156a0
Called functions addresses: 0x18002a77b 0x18000909c 0x18002a7c0 0x18000a1f4


int FUN_1800156a0(char param_1,ulonglong *param_2,ushort *param_3)

{
ushort uVar1;
int iVar2;
void *_Dst;
ushort uVar3;
undefined8 local_18;
void *pvStack_10;

iVar2 = 0;
local_18 = 0;
pvStack_10 = (void *)0x0;
if ((param_2 == (ulonglong *)0x0) || (param_3 == (ushort *)0x0)) {
return -0x7ff6fca3;
}
if (param_1 == '\0') {
local_18 = *param_2;
pvStack_10 = (void *)param_2[1];
}
else {

if (iVar2 != 0) goto LAB_18003e0fe;
}
uVar1 = (ushort)(local_18 >> 0x10);
if ((((uVar1 != 0) && (uVar3 = (ushort)local_18, uVar3 != 0)) && (pvStack_10 != (void *)0x0)) &&
((((local_18 & 1) == 0 && ((local_18 >> 0x10 & 1) == 0)) &&
((uVar3 <= uVar1 && (uVar1 != 0xffff)))))) {
*param_3 = uVar3;
param_3[1] = uVar1;
_Dst = (void *)FUN_18000a1f4(local_18 >> 0x10 & 0xffff);
*(void **)(param_3 + 4) = _Dst;
if (_Dst == (void *)0x0) {
iVar2 = -0x7ff6fd00;
goto LAB_18003e0fe;
}
if (param_1 == '\0') {
memcpy(_Dst,pvStack_10,(ulonglong)param_3[1]);
}
else {

if (iVar2 != 0) goto LAB_18003e0fe;
}
uVar1 = *param_3;
if (*(short *)(*(longlong *)(param_3 + 4) + -2 + ((ulonglong)uVar1 & 0xfffffffffffffffe)) != 0)
{
return iVar2;
}
if (2 < uVar1) {
*param_3 = uVar1 - 2;
return iVar2;
}
}
iVar2 = -0x7ff6fca3;
LAB_18003e0fe:
if (*(HLOCAL *)(param_3 + 4) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_3 + 4));
param_3[4] = 0;
param_3[5] = 0;
param_3[6] = 0;
param_3[7] = 0;
}
param_3[0] = 0;
param_3[1] = 0;
return iVar2;
}
=========================================
Function at address: 0x180015828
Called functions addresses: None


ulonglong FUN_180015828(longlong param_1,short *param_2)

{
ulonglong uVar1;
ushort uVar2;
ushort uVar3;

uVar1 = 0;
if (((param_2 != (short *)0x0) && (*param_2 != 0)) && (param_2[0x11] != 0)) {
uVar2 = DAT_180092808;
if ((*(ushort *)(param_1 + 0x22) & DAT_180092808) == 0) {
uVar2 = 0;
}
uVar2 = *(ushort *)(param_1 + 0x22) | uVar2;
uVar3 = DAT_180092804;
if ((uVar2 & DAT_180092804) == 0) {
uVar3 = 0;
}
uVar2 = uVar2 | uVar3;
if ((uVar2 & DAT_180092800) != 0) {
uVar1 = (ulonglong)DAT_180092800;
}
uVar1 = CONCAT71((int7)(uVar1 >> 8),
((uint)(ushort)param_2[0x11] & ~((uint)uVar2 | (uint)uVar1)) == 0);
}
return uVar1;
}
=========================================
Function at address: 0x18001588c
Called functions addresses: 0xEXTERNAL:00000124 0x180015917 0x180041d20


ulonglong FUN_18001588c(int param_1,int param_2,longlong param_3)

{
BOOL BVar1;
ulonglong uVar2;
uint uVar3;
uint local_res18 [4];

if (param_3 == 0) {
return 0;
}
if (param_2 != 0x2400) {
return 1;
}
if (param_1 != 0xae06) {
if (param_1 == 0xa400) {
uVar3 = 0x20;
goto LAB_1800158b9;
}
if (param_1 != 0xaa02) {
uVar2 = FUN_180015917();
return uVar2;
}
}
uVar3 = 0x80;
LAB_1800158b9:
local_res18[0] = 0;
BVar1 = CertGetIntendedKeyUsage(0x10001,*(PCERT_INFO *)(param_3 + 0x18),(BYTE *)local_res18,4);
if (BVar1 == 0) {
return 1;
}
uVar2 = (ulonglong)((uVar3 & local_res18[0]) != 0);
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0) {
FUN_180041d20(DAT_180091000[2],0x14,&DAT_180082b78,local_res18[0],(char)uVar3);
return uVar2;
}
return uVar2;
}
return uVar2;
}
=========================================
Function at address: 0x180015917
Called functions addresses: None


undefined8 FUN_180015917(void)

{
return 1;
}
=========================================
Function at address: 0x180015930
Called functions addresses: 0x180014550


void FUN_180015930(longlong param_1,undefined8 param_2,longlong param_3,char param_4)

{
int *piVar1;
longlong lVar2;

*(undefined8 *)(param_1 + 0xbc) = *(undefined8 *)(*(longlong *)(param_3 + 0x50) + 0x2f8);
if (*(longlong *)(param_1 + 0x180) != 0) {
*(undefined *)(*(longlong *)(param_1 + 0x180) + 0xec) = 0;
FUN_180014550(*(longlong *)(*(longlong *)(param_1 + 0x180) + 0xe0),
*(longlong *)(param_1 + 0x180),'\x01',param_4);
*(undefined8 *)(param_1 + 0x180) = 0;
}
lVar2 = *(longlong *)(param_3 + 8);
*(longlong *)(param_1 + 0xb0) = lVar2;
*(undefined4 *)(param_1 + 0xb8) = *(undefined4 *)(param_3 + 0x10);
if (*(longlong *)(lVar2 + 0x350) != 0) {
LOCK();
piVar1 = (int *)(*(longlong *)(*(longlong *)(lVar2 + 0x350) + 0x10) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
}
LOCK();
piVar1 = (int *)(*(longlong *)(lVar2 + 0x358) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
return;
}
=========================================
Function at address: 0x1800159d0
Called functions addresses: None


undefined8 FUN_1800159d0(longlong param_1,undefined4 *param_2,undefined4 *param_3)

{
longlong lVar1;

if ((param_2 != (undefined4 *)0x0) && (param_3 != (undefined4 *)0x0)) {
lVar1 = *(longlong *)(param_1 + 0x58);
*param_2 = *(undefined4 *)(lVar1 + 0xd8);
*param_3 = *(undefined4 *)(lVar1 + 0xdc);
return 0;
}
return 0x57;
}
=========================================
Function at address: 0x180015a10
Called functions addresses: 0x1800517a0 0x180041cb0 0x18002a7c0 0x180051f10


void FUN_180015a10(undefined8 param_1,longlong param_2)

{
int iVar1;
uint uVar2;
undefined4 *puVar3;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180082b10);
}
uVar2 = 0;
puVar3 = &DAT_1800918b0;
do {

if (iVar1 != 0) {
return;
}
uVar2 = uVar2 + 1;
puVar3 = puVar3 + 4;
} while (uVar2 < 10);
return;
}
=========================================
Function at address: 0x180015a90
Called functions addresses: 0x180015ad0 0x18004f9dc


ulonglong FUN_180015a90(undefined8 param_1,uint *param_2,uint *param_3,undefined8 *param_4)

{
undefined4 uVar1;
ulonglong extraout_RAX;
undefined4 extraout_var;

if ((param_2 != (uint *)0x0) && (2 < *param_2)) {
if (*param_2 < 5) {
uVar1 = FUN_18004f9dc(param_1,(int *)param_2,param_3,param_4);
return CONCAT44(extraout_var,uVar1);
}
if (*param_2 == 5) {
FUN_180015ad0(param_1,(undefined8 *)param_2,param_3,param_4);
return extraout_RAX;
}
}
return 0xc000000d;
}
=========================================
Function at address: 0x180015ad0
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000003f 0x18002a77b 0x180041cb0


undefined4
FUN_180015ad0(undefined8 param_1,undefined8 *param_2,undefined4 *param_3,undefined8 *param_4)

{
ushort uVar1;
longlong lVar2;
longlong lVar3;
longlong lVar4;
longlong lVar5;
undefined8 uVar6;
undefined8 *puVar7;
longlong lVar8;
uint uVar9;
longlong lVar11;
ulonglong uVar12;
undefined4 unaff_EDI;
undefined4 uVar13;
ulonglong uVar14;
uint uVar15;
uint uVar17;
uint uVar18;
SIZE_T uBytes;
undefined8 *puVar19;
uint local_res8;
SIZE_T local_80;
ulonglong uVar10;
ulonglong uVar16;

uVar14 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1e,&DAT_180082b10);
}
if (((param_2 == (undefined8 *)0x0) || (param_4 == (undefined8 *)0x0)) ||
(param_3 == (undefined4 *)0x0)) {
LAB_18003e43d:
uVar13 = 0xc000000d;
}
else {
local_80 = 0x48;
if (*(int *)(param_2 + 1) != 0) {
local_80 = (ulonglong)*(uint *)(param_2 + 1) * 8 + 0x48;
}
if (*(int *)(param_2 + 4) != 0) {
local_80 = local_80 + (ulonglong)*(uint *)(param_2 + 4) * 8;
}
uVar18 = *(uint *)(param_2 + 7);
uBytes = local_80;
if (uVar18 != 0) {
if (0x10 < uVar18) {
return unaff_EDI;
}
lVar2 = param_2[8];
if (lVar2 == 0) goto LAB_18003e43d;
uBytes = local_80 + (ulonglong)uVar18 * 0x28;
uVar12 = uVar14;
local_80 = uBytes;
do {
uVar17 = *(uint *)(lVar2 + uVar12 * 0x28);
if (uVar17 != 0) {
if (0x10 < uVar17) {
return unaff_EDI;
}
lVar3 = *(longlong *)(lVar2 + 8 + uVar12 * 0x28);
if (lVar3 == 0) {
return unaff_EDI;
}
uBytes = uBytes + (ulonglong)uVar17 * 0x10;
uVar10 = uVar14;
do {
uVar1 = *(ushort *)(lVar3 + 2 + uVar10 * 0x10);
if (uVar1 == 0) {
return unaff_EDI;
}
if (((*(ushort *)(lVar3 + uVar10 * 0x10) | uVar1) & 1) != 0) {
return unaff_EDI;
}
if (uVar1 < *(ushort *)(lVar3 + uVar10 * 0x10)) {
return unaff_EDI;
}
if (uVar1 == 0xffff) {
return unaff_EDI;
}
if (*(longlong *)(lVar3 + 8 + uVar10 * 0x10) == 0) {
return unaff_EDI;
}
uBytes = uBytes + uVar1;
uVar9 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar9;
local_80 = uBytes;
} while (uVar9 < uVar17);
}
uVar17 = *(uint *)(lVar2 + 0x14 + uVar12 * 0x28);
if (uVar17 != 0) {
if (0x10 < uVar17) {
return unaff_EDI;
}
lVar3 = *(longlong *)(lVar2 + 0x18 + uVar12 * 0x28);
if (lVar3 == 0) {
return unaff_EDI;
}
uBytes = uBytes + (ulonglong)uVar17 * 0x30;
uVar10 = uVar14;
do {
lVar8 = uVar10 * 0x30 + lVar3;
if (*(short *)(lVar8 + 10) == 0) {
return unaff_EDI;
}
uVar1 = *(ushort *)(lVar8 + 10);
if (((uVar1 | *(ushort *)(lVar8 + 8)) & 1) != 0) {
return unaff_EDI;
}
if (uVar1 < *(ushort *)(lVar8 + 8)) {
return unaff_EDI;
}
if (uVar1 == 0xffff) {
return unaff_EDI;
}
if (*(longlong *)(lVar8 + 0x10) == 0) {
if (*(short *)(lVar8 + 8) != 0) {
return unaff_EDI;
}
if (uVar1 != 0) {
return unaff_EDI;
}
}
uVar9 = *(uint *)(lVar8 + 0x18);
uBytes = uBytes + *(ushort *)(lVar8 + 10);
if (uVar9 != 0) {
if (0x10 < uVar9) {
return unaff_EDI;
}
lVar8 = *(longlong *)(lVar8 + 0x20);
if (lVar8 == 0) {
return unaff_EDI;
}
uBytes = uBytes + (ulonglong)uVar9 * 0x10;
uVar16 = uVar14;
do {
uVar1 = *(ushort *)(lVar8 + 2 + uVar16 * 0x10);
if (uVar1 == 0) {
return unaff_EDI;
}
if (((*(ushort *)(lVar8 + uVar16 * 0x10) | uVar1) & 1) != 0) {
return unaff_EDI;
}
if (uVar1 < *(ushort *)(lVar8 + uVar16 * 0x10)) {
return unaff_EDI;
}
if (uVar1 == 0xffff) {
return unaff_EDI;
}
if (*(longlong *)(lVar8 + 8 + uVar16 * 0x10) == 0) {
return unaff_EDI;
}
uBytes = uBytes + uVar1;
uVar15 = (int)uVar16 + 1;
uVar16 = (ulonglong)uVar15;
} while (uVar15 < uVar9);
}
uVar9 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar9;
local_80 = uBytes;
} while (uVar9 < uVar17);
}
uVar17 = (int)uVar12 + 1;
uVar12 = (ulonglong)uVar17;
} while (uVar17 < uVar18);
}
puVar7 = (undefined8 *)LocalAlloc(0x40,uBytes);
if (puVar7 == (undefined8 *)0x0) {
uVar13 = 0xc0000017;
}
else {
uVar6 = param_2[1];
puVar19 = puVar7 + 9;
*puVar7 = *param_2;
puVar7[1] = uVar6;
uVar6 = param_2[3];
puVar7[2] = param_2[2];
puVar7[3] = uVar6;
uVar6 = param_2[5];
puVar7[4] = param_2[4];
puVar7[5] = uVar6;
uVar6 = param_2[7];
puVar7[6] = param_2[6];
puVar7[7] = uVar6;
puVar7[8] = param_2[8];
if (*(int *)(param_2 + 1) != 0) {
memcpy(puVar19,(void *)param_2[2],(ulonglong)*(uint *)(param_2 + 1) << 3);
puVar7[2] = puVar19;
*(undefined4 *)(puVar7 + 1) = *(undefined4 *)(param_2 + 1);
puVar19 = puVar19 + *(uint *)(param_2 + 1);
}
if (*(int *)(param_2 + 4) != 0) {
memcpy(puVar19,(void *)param_2[5],(ulonglong)*(uint *)(param_2 + 4) << 3);
puVar7[5] = puVar19;
*(undefined4 *)(puVar7 + 4) = *(undefined4 *)(param_2 + 4);
puVar19 = puVar19 + *(uint *)(param_2 + 4);
}
if (*(int *)(param_2 + 7) != 0) {
memcpy(puVar19,(void *)param_2[8],(ulonglong)*(uint *)(param_2 + 7) * 0x28);
puVar7[8] = puVar19;
local_res8 = 0;
puVar19 = puVar19 + (ulonglong)*(uint *)(param_2 + 7) * 5;
if (*(uint *)(param_2 + 7) != 0) {
do {
uVar12 = 0;
lVar2 = param_2[8];
lVar3 = puVar7[8];
uVar18 = (uint)uVar14;
if (*(int *)(lVar2 + uVar14 * 0x28) != 0) {
memcpy(puVar19,*(void **)(lVar2 + 8 + uVar14 * 0x28),
(ulonglong)*(uint *)(lVar2 + uVar14 * 0x28) << 4);
*(undefined8 **)(lVar3 + 8 + uVar14 * 0x28) = puVar19;
uVar17 = *(uint *)(lVar2 + uVar14 * 0x28);
puVar19 = puVar19 + (ulonglong)uVar17 * 2;
uVar10 = uVar12;
if (uVar17 != 0) {
do {
lVar8 = *(longlong *)(lVar2 + 8 + uVar14 * 0x28);
memcpy(puVar19,*(void **)(lVar8 + 8 + uVar10 * 0x10),
(ulonglong)*(ushort *)(lVar8 + 2 + uVar10 * 0x10));
uVar17 = (int)uVar10 + 1;
*(undefined8 **)(*(longlong *)(lVar3 + 8 + uVar14 * 0x28) + 8 + uVar10 * 0x10) =
puVar19;
puVar19 = (undefined8 *)
((longlong)puVar19 +
(ulonglong)
*(ushort *)
(*(longlong *)(lVar2 + 8 + uVar14 * 0x28) + 2 + uVar10 * 0x10));
uVar10 = (ulonglong)uVar17;
uVar18 = local_res8;
} while (uVar17 < *(uint *)(lVar2 + uVar14 * 0x28));
}
}
if (*(int *)(lVar2 + 0x14 + uVar14 * 0x28) != 0) {
memcpy(puVar19,*(void **)(lVar2 + 0x18 + uVar14 * 0x28),
(ulonglong)*(uint *)(lVar2 + 0x14 + uVar14 * 0x28) * 0x30);
*(undefined8 **)(lVar3 + 0x18 + uVar14 * 0x28) = puVar19;
uVar17 = *(uint *)(lVar2 + 0x14 + uVar14 * 0x28);
puVar19 = puVar19 + (ulonglong)uVar17 * 6;
if (uVar17 != 0) {
do {
uVar10 = 0;
lVar8 = *(longlong *)(lVar2 + 0x18 + uVar14 * 0x28);
lVar11 = uVar12 * 0x30;
lVar4 = *(longlong *)(lVar3 + 0x18 + uVar14 * 0x28);
memcpy(puVar19,*(void **)(lVar11 + 0x10 + lVar8),
(ulonglong)*(ushort *)(lVar11 + 10 + lVar8));
*(undefined8 **)(lVar11 + 0x10 + lVar4) = puVar19;
puVar19 = (undefined8 *)
((longlong)puVar19 + (ulonglong)*(ushort *)(lVar11 + 10 + lVar8));
if (*(int *)(lVar11 + 0x18 + lVar8) != 0) {
memcpy(puVar19,*(void **)(lVar11 + 0x20 + lVar8),
(ulonglong)*(uint *)(lVar11 + 0x18 + lVar8) << 4);
*(undefined8 **)(lVar11 + 0x20 + lVar4) = puVar19;
uVar18 = *(uint *)(lVar11 + 0x18 + lVar8);
puVar19 = puVar19 + (ulonglong)uVar18 * 2;
if (uVar18 != 0) {
do {
lVar5 = *(longlong *)(lVar8 + 0x20 + lVar11);
memcpy(puVar19,*(void **)(lVar5 + 8 + uVar10 * 0x10),
(ulonglong)*(ushort *)(lVar5 + 2 + uVar10 * 0x10));
uVar18 = (int)uVar10 + 1;
*(undefined8 **)(*(longlong *)(lVar4 + 0x20 + lVar11) + 8 + uVar10 * 0x10) =
puVar19;
puVar19 = (undefined8 *)
((longlong)puVar19 +
(ulonglong)
*(ushort *)
(*(longlong *)(lVar8 + 0x20 + lVar11) + 2 + uVar10 * 0x10));
uVar10 = (ulonglong)uVar18;
} while (uVar18 < *(uint *)(lVar8 + 0x18 + lVar11));
}
}
uVar17 = (int)uVar12 + 1;
uVar12 = (ulonglong)uVar17;
uVar18 = local_res8;
} while (uVar17 < *(uint *)(lVar2 + 0x14 + uVar14 * 0x28));
}
}
local_res8 = uVar18 + 1;
uVar14 = (ulonglong)local_res8;
uBytes = local_80;
} while (local_res8 < *(uint *)(param_2 + 7));
}
}
uVar13 = 0;
*(undefined4 *)(puVar7 + 6) = *(undefined4 *)(param_2 + 6);
*(undefined4 *)((longlong)puVar7 + 0x34) = *(undefined4 *)((longlong)param_2 + 0x34);
*(undefined4 *)((longlong)puVar7 + 4) = *(undefined4 *)((longlong)param_2 + 4);
*param_3 = (int)uBytes;
*param_4 = puVar7;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1f,&DAT_180082b10,uVar13);
}
return unaff_EDI;
}
=========================================
Function at address: 0x180015e38
Called functions addresses: 0x18002a77b


undefined8
FUN_180015e38(undefined8 param_1,undefined param_2,undefined param_3,void *param_4,byte param_5,
ulonglong param_6,longlong *param_7)

{
undefined2 *puVar1;
uint uVar2;

if ((((param_4 != (void *)0x0) && (param_5 != 0)) && (param_7 != (longlong *)0x0)) &&
((puVar1 = (undefined2 *)*param_7, puVar1 != (undefined2 *)0x0 &&
(uVar2 = param_5 + 3, (longlong)puVar1 + (ulonglong)uVar2 + 4 <= param_6)))) {
*puVar1 = 0x1800;
*(char *)((longlong)puVar1 + 3) = (char)uVar2;
*(undefined *)((longlong)puVar1 + 5) = param_3;
*(char *)(puVar1 + 1) = (char)(uVar2 >> 8);
*(undefined *)(puVar1 + 2) = param_2;
*(byte *)(puVar1 + 3) = param_5;
memcpy((void *)((longlong)puVar1 + 7),param_4,(ulonglong)param_5);
*param_7 = (ulonglong)param_5 + (longlong)puVar1 + 7;
return 0;
}
return 0x57;
}
=========================================
Function at address: 0x180015ee0
Called functions addresses: 0x180041cdc 0x180041cb0 0x18002a7c0 0x1800432ec 0x180041d70 0x180041e9c 0x18000c3a8


void FUN_180015ee0(longlong param_1,undefined4 param_2,undefined8 param_3,undefined4 param_4)

{
longlong lVar1;
longlong lVar2;
uint uVar3;

if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x19,&DAT_180085110);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x1a,&DAT_180085110,param_1);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x1b,&DAT_180085110,param_2);
}
}
}
lVar1 = *(longlong *)(param_1 + 8);
lVar2 = *(longlong *)(lVar1 + 0x50);
if ((lVar2 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x1c,&DAT_180085110,*(undefined4 *)(lVar2 + 0xd4));
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x1d,&DAT_180085110,(wchar_t *)(lVar2 + 0xd8));
}
}

FUN_18000c3a8(uVar3);
return;
}
=========================================
Function at address: 0x180015fc8
Called functions addresses: 0x180078934 0x180078d70 0x18001610c 0x180079214 0x180016034 0x180016064 0x1800795f8


void FUN_180015fc8(void)

{
int iVar1;
ulonglong uVar2;
uint uVar3;
int local_res8 [2];
longlong local_res10 [3];

local_res10[0] = 0;
uVar3 = 0;
local_res8[0] = 0;
uVar2 = FUN_18001610c(0x180082440,0,local_res10);
if ((-1 < (int)uVar2) &&
(iVar1 = FUN_180016064(local_res10[0],L"EnableTlsExternalAlgorithms",local_res8), -1 < iVar1))
{
uVar3 = (uint)(local_res8[0] == 1);
}
FUN_180016034(local_res10);
DAT_1800921b0 = uVar3;
if (uVar3 != 0) {
FUN_180079214();
FUN_180078934();
FUN_1800795f8();
FUN_180078d70();
}
return;
}
=========================================
Function at address: 0x180016034
Called functions addresses: 0xEXTERNAL:000000c5


void FUN_180016034(longlong *param_1)

{
if (*param_1 != 0) {
NtClose();
*param_1 = 0;
}
return;
}
=========================================
Function at address: 0x180016064
Called functions addresses: 0xEXTERNAL:000000c8 0x180028070 0xEXTERNAL:000000d4


void FUN_180016064(undefined8 param_1,undefined8 param_2,undefined4 *param_3)

{
int iVar1;
undefined auStack_78 [32];
undefined4 local_58;
undefined4 *local_50;
undefined4 local_48 [2];
undefined8 local_40;
undefined8 uStack_38;
undefined8 local_30;
undefined8 uStack_28;
undefined4 local_20;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_78;
local_48[0] = 0;
local_40 = 0;
uStack_38 = 0;
local_20 = 0;
local_30 = 0;
uStack_28 = 0;
RtlInitUnicodeString(&local_40);
local_50 = local_48;
local_58 = 0x14;
iVar1 = NtQueryValueKey(param_1,&local_40,2,&local_30);
if ((-1 < iVar1) && (local_30._4_4_ == 4)) {
*param_3 = uStack_28._4_4_;
}
FUN_180028070(local_18 ^ (ulonglong)auStack_78);
return;
}
=========================================
Function at address: 0x18001610c
Called functions addresses: 0xEXTERNAL:000000d6 0xEXTERNAL:000000c8 0xEXTERNAL:000000d5 0xEXTERNAL:000000d9 0xEXTERNAL:000000d7


ulonglong FUN_18001610c(longlong param_1,longlong param_2,undefined8 param_3)

{
uint uVar1;
ulonglong uVar2;
longlong lVar3;
longlong lVar4;
undefined2 local_res20;
undefined8 *local_68;
undefined8 local_60;
undefined8 uStack_58;
undefined8 local_50;
undefined8 uStack_48;
undefined8 *local_40;
undefined8 uStack_38;
undefined8 local_30;
undefined8 uStack_28;

local_60 = 0;
uStack_58 = 0;
local_68 = (undefined8 *)0x0;
local_50 = 0;
uStack_48 = 0;
local_40 = (undefined8 *)0x0;
uStack_38 = 0;
local_30 = 0;
uStack_28 = 0;
if (param_2 == 0) {
RtlInitUnicodeString(&local_60,param_1);
local_40 = &local_60;
}
else {
lVar3 = -1;
lVar4 = -1;
do {
lVar4 = lVar4 + 1;
} while (*(short *)(param_1 + lVar4 * 2) != 0);
do {
lVar3 = lVar3 + 1;
} while (*(short *)(param_2 + lVar3 * 2) != 0);
uVar1 = ((int)lVar4 + (int)lVar3) * 2 + 4;
local_68 = (undefined8 *)
RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,
(ulonglong)uVar1 + 0x10);
if (local_68 == (undefined8 *)0x0) {
uVar2 = 0xc0000017;
goto LAB_180016276;
}
*(undefined2 *)local_68 = 0;
local_res20 = (undefined2)uVar1;
*(undefined2 *)((longlong)local_68 + 2) = local_res20;
local_68[1] = local_68 + 2;
RtlAppendUnicodeToString(local_68,param_1);
RtlAppendUnicodeToString(local_68,&DAT_1800820b4);
RtlAppendUnicodeToString(local_68,param_2);
local_40 = local_68;
}
uStack_38 = CONCAT44(uStack_38._4_4_,0x240);
local_50 = CONCAT44(local_50._4_4_,0x30);
uStack_48 = 0;
local_30 = 0;
uStack_28 = 0;
uVar2 = NtOpenKey(param_3,0x20019,&local_50);
LAB_180016276:
if (local_68 != (undefined8 *)0x0) {
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,local_68);
uVar2 = uVar2 & 0xffffffff;
}
return uVar2;
}
=========================================
Function at address: 0x1800162b0
Called functions addresses: 0x18005abd8 0x180029f58 0x180028d84


undefined8 FUN_1800162b0(longlong param_1)

{
undefined2 *puVar1;
longlong lVar2;
undefined8 *puVar3;
undefined8 *puVar4;
undefined8 *puVar5;
undefined8 *puVar6;
undefined8 uVar7;

puVar6 = (undefined8 *)0x0;
if (*(char *)(param_1 + 0xe9) == '\0') {
LAB_1800162cc:
lVar2 = *(longlong *)(param_1 + 0x530);
if ((*(longlong *)(param_1 + 0x78) != 0) && (DAT_1800927ac != '\0')) {
puVar1 = (undefined2 *)(*(longlong *)(param_1 + 0x78) + 0x98);
*puVar1 = 0;
if (lVar2 != 0) {
_o_wcsncpy_s(puVar1,0x100,lVar2,0xffffffffffffffff);
}
}
uVar7 = 0;
}
else {
puVar3 = (undefined8 *)FUN_180029f58(0x60);
puVar5 = puVar6;
if (puVar3 != (undefined8 *)0x0) {
puVar5 = puVar3 + 3;
*puVar3 = 0;
puVar3[4] = puVar5;
*puVar5 = puVar5;
puVar5 = puVar3 + 5;
puVar3[6] = puVar5;
*puVar5 = puVar5;
puVar5 = puVar3 + 7;
*(undefined4 *)(puVar3 + 1) = 10;
puVar4 = puVar3 + 9;
puVar3[8] = puVar5;
*puVar5 = puVar5;
puVar3[0xb] = param_1;
puVar3[10] = puVar4;
*puVar4 = puVar4;
puVar5 = puVar3;
}
*(undefined8 **)(param_1 + 0x240) = puVar5;
if (puVar5 != (undefined8 *)0x0) {
puVar5 = (undefined8 *)FUN_180029f58(0x30);
if (puVar5 != (undefined8 *)0x0) {
*puVar5 = *(undefined8 *)(param_1 + 0x240);
puVar5[1] = 0;
puVar5[2] = 0;
puVar5[3] = 0;
*(undefined4 *)(puVar5 + 4) = 0;
puVar5[5] = param_1;
*(int *)((longlong)puVar5 + 0x24) = (int)*(short *)(param_1 + 0xc0);
puVar6 = puVar5;
}
lVar2 = *(longlong *)(param_1 + 0x240);
*(undefined8 **)(param_1 + 0x248) = puVar6;
if (puVar6 != (undefined8 *)0x0) {
*(longlong *)(param_1 + 0xe0) = lVar2;
goto LAB_1800162cc;
}
if (lVar2 != 0) {
FUN_18005abd8(lVar2);
}
}
uVar7 = 0xe;
}
return uVar7;
}
=========================================
Function at address: 0x180016320
Called functions addresses: 0x180016390


ulonglong FUN_180016320(longlong param_1,int *param_2,short *param_3,int *param_4,uint param_5)

{
ulonglong uVar1;

uVar1 = (ulonglong)*(uint *)(param_1 + 0xa8);
if ((((((param_5 & *(uint *)(param_1 + 0xa8)) != 0) &&
(uVar1 = (ulonglong)*(uint *)(param_1 + 0xbc), *param_4 == *(uint *)(param_1 + 0xbc))) &&
(uVar1 = (ulonglong)*(uint *)(param_1 + 0xc0), param_4[1] == *(uint *)(param_1 + 0xc0))) &&
((param_3 == (short *)0x0 || (uVar1 = FUN_180016390(param_1,param_3), (char)uVar1 != '\0'))))
&& (((uint *)param_2 == (uint *)0x0 ||
((uVar1 = (ulonglong)(uint)*param_2, *(uint *)(param_1 + 0x178) == *param_2 &&
(uVar1 = (ulonglong)((uint *)param_2)[1],
*(uint *)(param_1 + 0x17c) == ((uint *)param_2)[1])))))) {
return CONCAT71((int7)(uVar1 >> 8),1);
}
return uVar1 & 0xffffffffffffff00;
}
=========================================
Function at address: 0x180016390
Called functions addresses: None


ulonglong FUN_180016390(longlong param_1,short *param_2)

{
short sVar1;
short sVar2;
short *psVar3;
longlong lVar4;

psVar3 = *(short **)(param_1 + 0x170);
if (psVar3 != param_2) {
if ((psVar3 != (short *)0x0) && (param_2 != (short *)0x0)) {
lVar4 = (longlong)param_2 - (longlong)psVar3;
do {
sVar1 = *psVar3;
sVar2 = *(short *)((longlong)psVar3 + lVar4);
if (sVar1 != sVar2) break;
psVar3 = psVar3 + 1;
} while (sVar2 != 0);
if (sVar1 == sVar2) goto LAB_1800163c3;
}
return (ulonglong)psVar3 & 0xffffffffffffff00;
}
LAB_1800163c3:
return CONCAT71((int7)((ulonglong)psVar3 >> 8),1);
}
=========================================
Function at address: 0x1800163e0
Called functions addresses: 0x180041cdc 0x1800164b0 0x18000e850 0x180041cb0 0x18000909c 0x180041d20


ulonglong FUN_1800163e0(undefined8 param_1,undefined8 param_2,uint *param_3,uint *param_4)

{
int iVar1;
ulonglong uVar2;
undefined2 uVar3;
void *local_18 [2];

iVar1 = FUN_18000e850(1,param_2,(undefined *)param_3,(ulonglong)param_4);
if (iVar1 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090304;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090304;
}
uVar3 = 0x32;
}
else {
if ((param_3 != (uint *)0x0) && (param_4 != (uint *)0x0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x34,&DAT_180085440);
}
uVar2 = FUN_1800164b0(local_18,*(uint **)(param_3 + 2),*param_3);
*param_4 = *param_3;
FUN_18000909c(*(HLOCAL *)(param_3 + 2));
param_3[2] = 0;
param_3[3] = 0;
*param_3 = 0;
param_3[1] = 0;
if ((int)uVar2 < 0) {
param_4[1] = 0;
*param_4 = 0;
param_4[2] = 0;
param_4[3] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x35,&DAT_180085440,(int)uVar2);
}
return uVar2 & 0xffffffff;
}
**(undefined8 **)(param_4 + 2) = local_18[0];
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x36,&DAT_180085440);
}
return 0;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090304;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090304;
}
uVar3 = 0x33;
}
FUN_180041d20(DAT_180091000[2],uVar3,&DAT_180085440,0x80090304,4);
return 0x80090304;
}
=========================================
Function at address: 0x1800164b0
Called functions addresses: 0xEXTERNAL:0000012a 0xEXTERNAL:00000129 0x1800165c3 0xEXTERNAL:00000128 0x180041cb0


undefined8 FUN_1800164b0(void **param_1,uint *param_2,uint param_3)

{
uint cbElement;
BOOL BVar1;
HCERTSTORE hCertStore;
undefined8 uVar2;
uint uVar3;
uint local_18 [2];
uint *local_10;

if (param_3 < 4) {
return 0x8009030d;
}
local_18[0] = *param_2;
local_10 = param_2 + 1;
if (0xfffffff9 < local_18[0]) {
return 0x8009030d;
}
if ((ulonglong)param_3 < (ulonglong)local_18[0] + 4) {
return 0x8009030d;
}
hCertStore = CertOpenStore((LPCSTR)0x6,1,0,4,local_18);
uVar2 = 0;
if (hCertStore == (HCERTSTORE)0x0) {
return 0x8009030d;
}
uVar3 = param_3 + (-4 - local_18[0]);
if (3 < uVar3) {
cbElement = *(uint *)((longlong)param_2 + (ulonglong)local_18[0] + 4);
if ((cbElement < 0xfffffffa) && ((ulonglong)cbElement + 4 <= (ulonglong)uVar3)) {
BVar1 = CertAddSerializedElementToStore
(hCertStore,(BYTE *)((ulonglong)local_18[0] + 8 + (longlong)param_2),
cbElement,2,0,2,(DWORD *)0x0,param_1);
if (BVar1 != 0) goto LAB_180016594;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2e,&DAT_180084b60);
uVar2 = FUN_1800165c3();
return uVar2;
}
}
}
uVar2 = 0x8009030d;
LAB_180016594:
CertCloseStore(hCertStore,0);
return uVar2;
}
=========================================
Function at address: 0x1800165c3
Called functions addresses: None


undefined8 FUN_1800165c3(void)

{
HCERTSTORE unaff_RBP;

CertCloseStore(unaff_RBP,0);
return 0x8009030d;
}
=========================================
Function at address: 0x1800165e0
Called functions addresses: 0x180041cb0 0x18002a77b 0x180012184 0x18000a1f4


undefined8 FUN_1800165e0(longlong param_1,uint *param_2)

{
void *_Dst;

if (*(int *)(param_1 + 0x44) == 0x31) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x28,&DAT_180085810);
}
if ((*(longlong *)(param_2 + 2) == 0) || (*param_2 == 0)) {
FUN_180012184(param_1,500,-0x7ff6fcf8);
return 0x80090308;
}
_Dst = (void *)FUN_18000a1f4((ulonglong)*param_2);
*(void **)(param_1 + 0x3a8) = _Dst;
if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,*(void **)(param_2 + 2),(ulonglong)*param_2);
*(uint *)(param_1 + 0x3b0) = *param_2;
*(undefined4 *)(param_1 + 0x44) = 0x5b;
}
return 0;
}
=========================================
Function at address: 0x180016610
Called functions addresses: 0x180050980 0x180050800 0x18000e850 0x180041cb0 0x18000c710 0x18000f7a4 0x1800509d0


int FUN_180016610(longlong param_1,undefined8 param_2,int *param_3,uint *param_4)

{
int iVar1;
longlong *plVar2;

iVar1 = FUN_18000e850(1,param_2,(undefined *)param_3,(ulonglong)param_4);
if (((iVar1 == 0) || (param_3 == (int *)0x0)) || (param_4 == (uint *)0x0)) {
iVar1 = -0x7ff6fcfc;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x37,&DAT_180085440);
}
if ((*(longlong **)(param_3 + 2) == (longlong *)0x0) || (*param_3 != 8)) {
plVar2 = FUN_18000c710(param_1);
}
else {
plVar2 = FUN_180050800(*(longlong **)(param_3 + 2));
}
if (plVar2 == (longlong *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x38,&DAT_180085440);
}
iVar1 = -0x7ff6fcff;
}
else {
iVar1 = FUN_18000f7a4((longlong)plVar2,0x1800509d0,FUN_180050980,(byte)param_2,param_4);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x39,&DAT_180085440);
}
}
}
return iVar1;
}
=========================================
Function at address: 0x1800166f0
Called functions addresses: 0x18005b440 0x18002a7c0 0x180047244 0x18004718c 0x180047118


int FUN_1800166f0(longlong param_1,int param_2,longlong param_3,uint param_4)

{
int iVar1;
int local_res18 [4];

if (param_2 == 0x22) {
iVar1 = FUN_180047244(param_1,param_3,param_4);
return iVar1;
}
if (param_2 == 0x65) {
iVar1 = FUN_180047118(param_1,param_3,param_4);
return iVar1;
}
if (param_2 == 0x69) {
local_res18[0] = 0;
if ((param_4 == 4) &&

)) {
*(undefined *)(param_1 + 0x22c) = 1;
return 0;
}
return 0x57;
}
if (param_2 == 0x6a) {
iVar1 = FUN_18004718c(param_1,param_3,param_4);
return iVar1;
}
if (param_2 == 0x5e) {
iVar1 = FUN_18004705c(param_1,param_3,param_4);
return iVar1;
}
if (param_2 == 0x68) {
iVar1 = FUN_180047320(param_1,param_3,param_4);
return iVar1;
}
return 0x78;
}
=========================================
Function at address: 0x180016790
Called functions addresses: 0xEXTERNAL:0000011c


undefined8 FUN_180016790(longlong param_1,undefined8 param_2)

{
if (*(longlong *)(param_1 + 0x400) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x400),0);
}
*(undefined8 *)(param_1 + 0x400) = param_2;
return 0;
}
=========================================
Function at address: 0x1800167e0
Called functions addresses: 0xEXTERNAL:0000011c


undefined8 FUN_1800167e0(longlong param_1,undefined8 param_2)

{
if (*(longlong *)(param_1 + 0x3f8) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x3f8),0);
}
*(undefined8 *)(param_1 + 0x3f8) = param_2;
return 0;
}
=========================================
Function at address: 0x180016828
Called functions addresses: 0x18002a7c0


void FUN_180016828(undefined8 param_1,longlong *param_2)

{
int *piVar1;
int iVar2;

if (param_2 != (longlong *)0x0) {
LOCK();
piVar1 = (int *)((longlong)param_2 + 0x1c);
iVar2 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar2 == 1) {

}
}
return;
}
=========================================
Function at address: 0x18001686c
Called functions addresses: 0xEXTERNAL:0000003c 0x18003e8c5 0x18003e91a 0xEXTERNAL:000000a7


undefined FUN_18001686c(uint *param_1,uint param_2,int param_3,uint param_4,longlong param_5,
char param_6)

{
uint *puVar1;
undefined uVar2;
int iVar3;
int *piVar4;
wchar_t *_Str1;
uint uVar5;
ulonglong uVar6;
int *piVar7;
undefined uVar8;
ulonglong uVar9;
undefined4 in_stack_ffffffffffffffe0;

uVar9 = (ulonglong)param_4;
if (((param_2 != 0) && (param_1 != (uint *)0x0)) &&
(puVar1 = param_1 + (ulonglong)param_2 * 10, param_1 < puVar1)) {
do {
if (param_1[5] != 0) {
if (*param_1 == 0) {
LAB_180016916:
if ((param_6 == '\0') || ((*(byte *)(param_1 + 8) & 1) == 0)) {
piVar7 = *(int **)(param_1 + 6);
piVar4 = piVar7 + (ulonglong)param_1[5] * 0xc;
for (; piVar7 < piVar4; piVar7 = piVar7 + 0xc) {
if ((*piVar7 == param_3) && (*(short *)(piVar7 + 2) == 6)) {
_Str1 = *(wchar_t **)(piVar7 + 4);
uVar2 = 0xa0;
uVar8 = 3;
iVar3 = wcsncmp(_Str1,L"RSA",3);
if (iVar3 == 0) {
if (((piVar7[6] == 0) && (piVar7[10] == 0)) && (piVar7[0xb] == 0)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 1;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
uVar2 = FUN_18003e91a((longlong)DAT_180091000);
return uVar2;
}
return 1;
}
if (param_4 != 0) {
if (piVar7[10] == 0) {
if (piVar7[0xb] == 0) goto LAB_18001693f;
}
else if (param_4 < (uint)piVar7[10]) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 1;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"RSA",(char)param_4,
(char)param_3);
return 1;
}
return 1;
}
if (piVar7[0xb] != 0) {
uVar2 = FUN_18003e8c5((char)_Str1,uVar2,uVar8,(char)uVar9,
in_stack_ffffffffffffffe0);
return uVar2;
}
}
}
}
LAB_18001693f:
piVar4 = (int *)((ulonglong)param_1[5] * 0x30 + *(longlong *)(param_1 + 6));
}
}
}
else if (param_5 != 0) {
uVar6 = 0;
do {
iVar3 = RtlCompareUnicodeString(uVar6 * 0x10 + *(longlong *)(param_1 + 2),param_5,1);
if (iVar3 == 0) goto LAB_180016916;
uVar5 = (int)uVar6 + 1;
uVar6 = (ulonglong)uVar5;
} while (uVar5 < *param_1);
}
}
param_1 = param_1 + 10;
} while (param_1 < puVar1);
}
return 0;
}
=========================================
Function at address: 0x1800169e0
Called functions addresses: 0x180041cdc 0x180041cb0 0x18002a7c0 0x1800432ec 0x180041d70 0x18000c3a8 0x180041e9c


void FUN_1800169e0(longlong param_1,undefined4 param_2,undefined8 param_3)

{
longlong lVar1;
longlong lVar2;
uint uVar3;

if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180085110);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x15,&DAT_180085110,param_1);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x16,&DAT_180085110,param_2);
}
}
}
lVar1 = *(longlong *)(param_1 + 8);
lVar2 = *(longlong *)(lVar1 + 0x50);
if ((lVar2 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x17,&DAT_180085110,*(undefined4 *)(lVar2 + 0xd4));
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x18,&DAT_180085110,(wchar_t *)(lVar2 + 0xd8));
}
}

FUN_18000c3a8(uVar3);
return;
}
=========================================
Function at address: 0x180016ab4
Called functions addresses: 0x18007af10 0xEXTERNAL:000000a4 0x18003e9e8 0x18007af40


void FUN_180016ab4(void)

{
longlong lVar1;

lVar1 = RtlImageNtHeader(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x10));
if (((*(char *)((longlong)ProcessEnvironmentBlock + 2) != '\0') || (lVar1 == 0)) ||
(DAT_1800920e0 = *(longlong *)(lVar1 + 0x68),
(ulonglong)(*(longlong *)(lVar1 + 0x60) - DAT_1800920e0) < 0x3000)) {
DAT_1800920e0 = 0;
}
if (lVar1 == 0) {
DAT_1800920e8 = 0xfffffffffffffff7;
}
else {
DAT_1800920e8 = (ulonglong)*(uint *)((longlong)Self + 0x1748);
if (DAT_1800920e8 == 0) {
DAT_1800920e8 = 0x3000;
}
else if (DAT_1800920e8 + 8 < 8) {
FUN_18003e9e8();
return;
}
}
DAT_1800920f0 = FUN_18007af10;
DAT_1800920f8 = FUN_18007af40;
return;
}
=========================================
Function at address: 0x180016b6c
Called functions addresses: 0x180028d78 0xEXTERNAL:0000003f 0xEXTERNAL:0000010d 0x180041d20 0xEXTERNAL:0000011c


int FUN_180016b6c(longlong *param_1,longlong param_2)

{
int iVar1;
HLOCAL pvVar2;
longlong lVar3;
longlong lVar4;
longlong local_res18;

local_res18 = 0;
iVar1 = SslOpenProvider(&local_res18,param_2,DAT_180092f58);
if (iVar1 == 0) {
lVar3 = -1;
do {
lVar4 = lVar3;
lVar3 = lVar4 + 1;
} while (*(short *)(param_2 + lVar3 * 2) != 0);
lVar4 = lVar4 + 2;
pvVar2 = LocalAlloc(0x40,lVar4 * 2);
if (pvVar2 == (HLOCAL)0x0) {
iVar1 = -0x7ff6fd00;
}
else {
_o_wcscpy_s(pvVar2,lVar4,param_2);
*param_1 = local_res18;
local_res18 = 0;
param_1[1] = (longlong)pvVar2;
}
}
if (local_res18 != 0) {
SslFreeObject(local_res18,0);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar1 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0xf,&DAT_1800853f8,iVar1,(char)iVar1);
}
return iVar1;
}
=========================================
Function at address: 0x180016c58
Called functions addresses: 0xEXTERNAL:0000003f 0x18002a77b 0x180041cb0


undefined8 FUN_180016c58(longlong param_1,undefined8 *param_2)

{
ushort uVar1;
undefined8 *puVar2;
void *_Src;
undefined8 uVar3;
HLOCAL _Dst;

puVar2 = *(undefined8 **)(param_1 + 0x198);
_Dst = (HLOCAL)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x6e,&DAT_1800853e8);
}
if (puVar2 == (undefined8 *)0x0) {
*param_2 = 0;
param_2[1] = 0;
}
else {
_Src = (void *)puVar2[1];
if (_Src != (void *)0x0) {
uVar1 = *(ushort *)((longlong)puVar2 + 2);
_Dst = LocalAlloc(0x40,(ulonglong)uVar1);
if (_Dst == (HLOCAL)0x0) {
return 0x80090300;
}
memcpy(_Dst,_Src,(ulonglong)uVar1);
}
uVar3 = puVar2[1];
*param_2 = *puVar2;
param_2[1] = uVar3;
param_2[1] = _Dst;
}
return 0;
}
=========================================
Function at address: 0x180016cd0
Called functions addresses: 0x180007410


ulonglong FUN_180016cd0(longlong param_1,longlong param_2)

{
ulonglong in_RAX;
ulonglong uVar1;

if (param_2 == 0) {
uVar1 = in_RAX & 0xffffffffffffff00;
}
else {
uVar1 = FUN_180007410(&DAT_180092420,*(int **)(param_2 + 0xb8),
(ulonglong)*(uint *)(param_2 + 0xb0),*(uint *)(param_2 + 0xc0),
*(uint *)(param_2 + 0x9c) >> 0xc & 1,*(uint *)(param_2 + 0x9c) & 0x800,
*(uint *)(param_2 + 0xa8),*(uint *)(param_2 + 0xa4),
*(uint *)(param_2 + 0x98),*(longlong *)(param_1 + 0xb0),0,
*(uint **)(param_2 + 200),*(uint *)(param_2 + 0xc4),'\0');
}
return uVar1;
}
=========================================
Function at address: 0x180016da0
Called functions addresses: 0x180041cb0 0x18000b400


undefined8 FUN_180016da0(longlong param_1)

{
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180082b10);
}
FUN_18000b400(param_1);
return 0;
}
=========================================
Function at address: 0x180016de0
Called functions addresses: 0xEXTERNAL:00000055 0xEXTERNAL:00000054


void FUN_180016de0(void)

{
DAT_1800921a8 = LoadLibraryExW(L"sspicli.dll",(HANDLE)0x0,0);
if (DAT_1800921a8 != (HMODULE)0x0) {
DAT_1800921a0 = GetProcAddress(DAT_1800921a8,"FreeContextBuffer");
}
DAT_180092190 = LoadLibraryExW(L"mskeyprotect.dll",(HANDLE)0x0,0x800);
if (DAT_180092190 != (HMODULE)0x0) {
DAT_180092188 = GetProcAddress(DAT_180092190,"KeyFileProtectSessionTicket");
DAT_180092180 = GetProcAddress(DAT_180092190,"KeyFileUnprotectSessionTicket");
}
return;
}
=========================================
Function at address: 0x180016e98
Called functions addresses: 0xEXTERNAL:000000b5


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined1 * FUN_180016e98(void)

{
_DAT_180092488 = 0;
DAT_180092490 = 0;
DAT_180092498 = 0;
DAT_1800925a8 = 0;
DAT_1800925b0 = 0;
DAT_1800925b8 = 0;
_DAT_1800925c0 = 0;
DAT_1800925c8 = 0;
DAT_1800925d0 = 0;
_DAT_1800925ea = 0;
uRam00000001800925f2 = 0;
_DAT_1800925fa = 0;
uRam0000000180092602 = 0;
DAT_1800925e8 = 0;
DAT_18009260a = 0;
RtlInitializeResource(&DAT_180092428);
DAT_180092420 = 1;
return &DAT_180092420;
}
=========================================
Function at address: 0x180016f2c
Called functions addresses: 0x180041cb0 0x180041d20


int FUN_180016f2c(undefined8 *param_1)

{
int iVar1;

iVar1 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_1800853f8);
}
if (DAT_180092a90 < 0x20) {
(&DAT_180092aa0)[(ulonglong)DAT_180092a90 * 2] = *param_1;
(&DAT_180092aa8)[(ulonglong)DAT_180092a90 * 2] = param_1[1];
DAT_180092a90 = DAT_180092a90 + 1;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_1800853f8);
}
iVar1 = -0x7ff6fcfc;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar1 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x16,&DAT_1800853f8,iVar1,(char)iVar1);
}
return iVar1;
}
=========================================
Function at address: 0x180016fd0
Called functions addresses: 0xEXTERNAL:00000040 0xEXTERNAL:0000003f 0xEXTERNAL:000000b5 0x180041d20


/* WARNING: Removing unreachable block (ram,0x00018003eb5a) */
/* WARNING: Removing unreachable block (ram,0x00018003eb6a) */

int FUN_180016fd0(void)

{
int iVar1;

iVar1 = 0;
DAT_1800921b8 = LocalAlloc(0x40,0x60);
if (DAT_1800921b8 == (HLOCAL)0x0) {
iVar1 = -0x7ff6fd00;
}
else {
RtlInitializeResource(DAT_1800921b8);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar1 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x13,&DAT_1800853f8,iVar1,0);
}
return iVar1;
}
=========================================
Function at address: 0x180017090
Called functions addresses: 0x18002a0b0 0xEXTERNAL:000000c0 0xEXTERNAL:00000088 0x1800032c4 0x18002a7c0 0xEXTERNAL:000000bc 0x18005dca8 0x18002a118


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180017090(undefined8 param_1,char param_2)

{
uint *puVar1;
longlong *plVar2;
code *pcVar3;
DWORD DVar4;
undefined8 uVar5;
longlong *plVar6;
undefined *puVar7;
longlong lVar8;
longlong *plVar9;
uint *puVar10;
undefined auStack_28 [8];
undefined auStack_20 [24];

puVar7 = auStack_28;
if (*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) <
DAT_180092d78) {
_Init_thread_header(&DAT_180092d78);
if (DAT_180092d78 == -1) {
DAT_1800921e8 = DAT_1800927f8;
DAT_1800921f0 = DAT_180092dd0;
_DAT_1800921f8 = DAT_180092dd8;
_DAT_180092200 = &DAT_180092da0;
_DAT_180092208 = DAT_1800927f0;
_DAT_180092210 = DAT_1800927e8;
_Init_thread_footer(&DAT_180092d78);
}
}
if (param_2 == '\0') {
LAB_18003ec8e:
*(undefined8 *)(puVar7 + -8) = 0x18003ecad;

}
else {
plVar6 = &DAT_1800921e8;
lVar8 = 6;
do {
if (*plVar6 != 0) {

}
plVar6 = plVar6 + 1;
lVar8 = lVar8 + -1;
} while (lVar8 != 0);
if ((DAT_180092704 != 0) && (DAT_180092778 != 0)) {
DVar4 = GetTickCount();
RtlAcquireResourceExclusive(&DAT_180092718,1);
plVar6 = DAT_180092708;
LAB_18003ec69:
do {
if ((longlong **)plVar6 == &DAT_180092708) goto code_r0x00018003ec6e;
puVar10 = (uint *)(plVar6 + -5);
plVar2 = (longlong *)*plVar6;
plVar9 = plVar6;
uVar5 = FUN_1800032c4((ulonglong)*puVar10,(ulonglong)DVar4,DAT_1800926f8);
plVar6 = plVar2;
if ((DAT_180092700 < DAT_180092704) || ((char)uVar5 != '\0')) {
puVar1 = puVar10 + 6;
lVar8 = *(longlong *)puVar1;
if ((*(uint **)(lVar8 + 8) == puVar1) &&
(plVar2 = *(longlong **)(puVar10 + 8), (uint *)*plVar2 == puVar1)) {
*plVar2 = lVar8;
*(longlong **)(lVar8 + 8) = plVar2;
lVar8 = *plVar9;
if ((*(longlong **)(lVar8 + 8) == plVar9) &&
(plVar2 = (longlong *)plVar9[1], (longlong *)*plVar2 == plVar9)) {
*plVar2 = lVar8;
*(longlong **)(lVar8 + 8) = plVar2;
DAT_180092704 = DAT_180092704 - 1;
FUN_18005dca8(puVar10);
goto LAB_18003ec69;
}
}
pcVar3 = (code *)swi(0x29);
(*pcVar3)(3);
puVar7 = auStack_20;
goto LAB_18003ec8e;
}
} while( true );
}
}
LAB_180017112:
/* WARNING: Could not recover jumptable at 0x000180017128. Too many branches */

ResetEvent(DAT_1800927e0);
return;
code_r0x00018003ec6e:
RtlReleaseResource(&DAT_180092718);
goto LAB_180017112;
}
=========================================
Function at address: 0x1800171b8
Called functions addresses: 0x18002a77b 0x180041cb0


undefined8 FUN_1800171b8(longlong param_1,undefined4 *param_2)

{
undefined4 uVar1;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x5e,&DAT_1800853e8);
}
*param_2 = 0;
uVar1 = *param_2;
if ((*(uint *)(param_1 + 0x10) >> 0xf & 1) == 0) {
uVar1 = 1;
}
*param_2 = uVar1;
param_2[1] = *(undefined4 *)(param_1 + 0x140);
memcpy(param_2 + 2,(void *)(param_1 + 0x144),(ulonglong)*(uint *)(param_1 + 0x140));
return 0;
}
=========================================
Function at address: 0x180017230
Called functions addresses: 0xEXTERNAL:00000056 0xEXTERNAL:0000017d 0xEXTERNAL:00000040 0x180045bf8 0x180055070 0xEXTERNAL:000000da 0x18007b25c 0x18005988c 0x18005e674 0xEXTERNAL:000000bc 0xEXTERNAL:0000016e 0x18005de98 0xEXTERNAL:000000e0 0x180017348 0x180055014 0xEXTERNAL:000000c0 0x180024f64 0x180058d5c 0x18005b8b4 0x180054fc4 0xEXTERNAL:000000b3 0x18004cf24


undefined8 FUN_180017230(void)

{
undefined *puVar1;
uint uVar2;
bool bVar4;
ulonglong uVar3;

uVar3 = 0;
bVar4 = DAT_180092620 != 0;
RtlEnterCriticalSection(&DAT_180092cc8);
if (bVar4) {
if (DAT_1800927f0 != (longlong *)0x0) {
FUN_18005988c(DAT_1800927f0);
DAT_1800927f0 = (longlong *)0x0;
}
if (DAT_1800927e8 != 0) {
FUN_180058d5c();
DAT_1800927e8 = 0;
}
if (DAT_180092f78 != 0) {
FUN_18005b8b4(DAT_180092f78);
DAT_180092f78 = 0;
}
FUN_18005de98();
FUN_180045bf8();
FUN_18004cf24();
FUN_18005e674();
if (DAT_180092a50 != (BCRYPT_ALG_HANDLE)0x0) {
BCryptCloseAlgorithmProvider(DAT_180092a50,0);
DAT_180092a50 = (BCRYPT_ALG_HANDLE)0x0;
}
if (DAT_180092a48 != (BCRYPT_ALG_HANDLE)0x0) {
BCryptCloseAlgorithmProvider(DAT_180092a48,0);
DAT_180092a48 = (BCRYPT_ALG_HANDLE)0x0;
}
if (DAT_180092a40 != (BCRYPT_ALG_HANDLE)0x0) {
BCryptCloseAlgorithmProvider(DAT_180092a40,0);
DAT_180092a40 = (BCRYPT_ALG_HANDLE)0x0;
}
if (DAT_180092a38 != (BCRYPT_ALG_HANDLE)0x0) {
BCryptCloseAlgorithmProvider(DAT_180092a38,0);
DAT_180092a38 = (BCRYPT_ALG_HANDLE)0x0;
}
if (DAT_180092a30 != 0) {
CryptReleaseContext(DAT_180092a30,0);
DAT_180092a30 = 0;
}
puVar1 = &DAT_180092428;
RtlAcquireResourceExclusive(&DAT_180092428,1);
FUN_180024f64(puVar1,'\x01');
RtlReleaseResource(&DAT_180092428);
FUN_180055070();
FUN_180055014();
FUN_180054fc4();
if (DAT_1800927ac != '\0') {
DAT_1800927ac = '\0';
FUN_18007b25c();
}
}
if (DAT_1800921a8 != (HMODULE)0x0) {
FreeLibrary(DAT_1800921a8);
DAT_1800921a8 = (HMODULE)0x0;
DAT_1800921a0 = 0;
}
if (DAT_180092190 != (HMODULE)0x0) {
FreeLibrary(DAT_180092190);
DAT_180092190 = (HMODULE)0x0;
DAT_180092188 = 0;
DAT_180092180 = 0;
}
if (DAT_1800921b8 != (HLOCAL)0x0) {
RtlDeleteResource();
LocalFree(DAT_1800921b8);
}
DAT_1800921b8 = (HLOCAL)0x0;
if (DAT_180092a90 != 0) {
do {
FUN_180017348(&DAT_180092aa0 + uVar3 * 2);
uVar2 = (int)uVar3 + 1;
uVar3 = (ulonglong)uVar2;
} while (uVar2 < DAT_180092a90);
}
DAT_180092a90 = 0;
DAT_1800921d8 = 0;
RtlLeaveCriticalSection(&DAT_180092cc8);
return 1;
}
=========================================
Function at address: 0x180017348
Called functions addresses: 0xEXTERNAL:00000040 0xEXTERNAL:0000011c


void FUN_180017348(longlong *param_1)

{
if (*param_1 != 0) {
SslFreeObject(*param_1,0);
*param_1 = 0;
}
if ((HLOCAL)param_1[1] != (HLOCAL)0x0) {
LocalFree((HLOCAL)param_1[1]);
param_1[1] = 0;
}
return;
}
=========================================
Function at address: 0x180017394
Called functions addresses: 0x18000909c 0x18002a7c0 0x18000a1f4


int FUN_180017394(int param_1,ushort *param_2)

{
ushort uVar1;
ushort uVar2;
int iVar3;
longlong lVar4;
undefined8 local_res18;

local_res18 = 0;
if ((param_1 == 0) || (param_2 == (ushort *)0x0)) {
return -0x3ffffff3;
}

if (iVar3 != 0) goto LAB_18003ee38;
uVar1 = local_res18._2_2_;
if ((((local_res18._2_2_ != 0) && (uVar2 = (ushort)local_res18, uVar2 != 0)) &&
(local_res18._4_4_ != 0)) &&
((((local_res18 & 1) == 0 && ((local_res18 & 0x10000) == 0)) &&
((uVar2 <= local_res18._2_2_ && (local_res18._2_2_ != 0xffff)))))) {
*param_2 = uVar2;
param_2[1] = local_res18._2_2_;
lVar4 = FUN_18000a1f4((ulonglong)local_res18._2_2_);
*(longlong *)(param_2 + 4) = lVar4;
if (lVar4 == 0) {
iVar3 = -0x7ff6fd00;
goto LAB_18003ee38;
}

if (iVar3 != 0) goto LAB_18003ee38;
uVar1 = *param_2;
if (*(short *)(*(longlong *)(param_2 + 4) + -2 + ((ulonglong)uVar1 & 0xfffffffffffffffe)) != 0)
{
return 0;
}
if (2 < uVar1) {
*param_2 = uVar1 - 2;
return 0;
}
}
iVar3 = -0x7ff6fca3;
LAB_18003ee38:
if (*(HLOCAL *)(param_2 + 4) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_2 + 4));
param_2[4] = 0;
param_2[5] = 0;
param_2[6] = 0;
param_2[7] = 0;
}
param_2[0] = 0;
param_2[1] = 0;
return iVar3;
}
=========================================
Function at address: 0x1800174c8
Called functions addresses: 0x18003ee5c


void FUN_1800174c8(longlong param_1,int param_2)

{
if (param_1 == 0) {
return;
}
if (DAT_1800927ac == '\0') {
return;
}
if (param_2 < 0x11) {
if (param_2 == 0x10) {
return;
}
if (-1 < param_2) {
if (param_2 < 7) {
return;
}
if (9 < param_2) {
if (param_2 < 0xc) {
return;
}
FUN_18003ee5c(param_1,param_2);
return;
}
}
}
else if (0x16 < param_2) {
if (param_2 < 0x19) {
return;
}
if (param_2 == 0x23) {
return;
}
if (param_2 == 0xff01) {
return;
}
}
if (0x31 < *(ushort *)(param_1 + 0x6f8)) {
return;
}
*(int *)(param_1 + 0x630 + (ulonglong)*(ushort *)(param_1 + 0x6f8) * 4) = param_2;
*(short *)(param_1 + 0x6f8) = *(short *)(param_1 + 0x6f8) + 1;
return;
}
=========================================
Function at address: 0x180017510
Called functions addresses: 0xEXTERNAL:000000ed


void FUN_180017510(undefined8 param_1,undefined8 param_2)

{
ResolveDelayLoadedAPI
(0x180000000,param_1,DAT_180086928,DelayLoadFailureHook_exref,param_2,DAT_180086924);
return;
}
=========================================
Function at address: 0x180017560
Called functions addresses: 0xEXTERNAL:000000e0 0x180041cdc 0xEXTERNAL:000000da 0x180041cb0 0xEXTERNAL:00000067 0xEXTERNAL:00000041 0xEXTERNAL:00000140


undefined8 FUN_180017560(longlong param_1)

{
int *piVar1;
int iVar2;
bool bVar3;
bool bVar4;
DWORD DVar5;
DWORD DVar6;
BOOL BVar7;
undefined8 *puVar8;

bVar3 = false;
LOCK();
piVar1 = (int *)(param_1 + 0x58);
iVar2 = *piVar1;
*piVar1 = *piVar1 + 1;
UNLOCK();
if (iVar2 + 1 < 2) {
bVar4 = true;
if (((*(HANDLE *)(param_1 + 0x50) != (HANDLE)0x0) && (*(longlong *)(param_1 + 0x48) != 0)) &&
(DVar5 = WaitForSingleObjectEx(*(HANDLE *)(param_1 + 0x50),0,0), DVar5 == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x18,&DAT_180085628);
}
BVar7 = CertControlStore(*(HCERTSTORE *)(param_1 + 0x48),0,1,(void *)(param_1 + 0x50));
bVar3 = bVar4;
if (((BVar7 == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar5 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x19,&DAT_180085628,DVar5);
}
}
DVar5 = WaitForSingleObjectEx(DAT_1800927d0,0,0);
DVar6 = WaitForSingleObjectEx(DAT_1800927c8,0,0);
if (DVar6 == 0) {
RtlEnterCriticalSection(param_1 + 8);
for (puVar8 = *(undefined8 **)(param_1 + 0x30); puVar8 != (undefined8 *)(param_1 + 0x30);
puVar8 = (undefined8 *)*puVar8) {
*(uint *)((longlong)puVar8 + 0x94) = *(uint *)((longlong)puVar8 + 0x94) | 0x10;
}
RtlLeaveCriticalSection(param_1 + 8);
}
if ((bVar3) || (DVar5 == 0)) {
RtlEnterCriticalSection(param_1 + 8);
for (puVar8 = *(undefined8 **)(param_1 + 0x30); puVar8 != (undefined8 *)(param_1 + 0x30);
puVar8 = (undefined8 *)*puVar8) {
if (((DVar5 == 0) && (puVar8[99] != 0)) || ((bVar3 && (puVar8[99] == 0)))) {
*(uint *)((longlong)puVar8 + 0x94) = *(uint *)((longlong)puVar8 + 0x94) | 0x40;
}
}
RtlLeaveCriticalSection(param_1 + 8);
}
}
LOCK();
*(int *)(param_1 + 0x58) = *(int *)(param_1 + 0x58) + -1;
UNLOCK();
return 0;
}
=========================================
Function at address: 0x180017638
Called functions addresses: None


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180017638(void)

{
_DAT_180092a78 = 1;
_DAT_180092a70 = 0;
_DAT_180092a60 = 0;
return;
}
=========================================
Function at address: 0x180017660
Called functions addresses: 0xEXTERNAL:00000040 0x18000ff48 0x180041cb0 0x18000909c 0x18002a7c0 0x180043650 0x180059940 0x1800432ec 0x180056124 0x18000c3a8


uint FUN_180017660(longlong param_1,int param_2,int *param_3)

{
int iVar1;
HLOCAL hMem;
char cVar2;
uint uVar3;
undefined4 uVar4;
undefined8 uVar5;
longlong lVar6;
int iVar7;
uint uVar8;
int iVar9;
HLOCAL local_res8;
HLOCAL local_res20;
longlong local_58;
undefined8 local_50;
longlong local_48;
undefined local_40 [8];
uint local_38;

local_res20 = (HLOCAL)0x0;
local_res8 = (HLOCAL)((ulonglong)local_res8 & 0xffffffff00000000);
local_58 = 0;
if (param_1 == 0) {
return 0x80090301;
}

if (cVar2 == '\0') {
return 0x80090304;
}
if ((local_38 >> 0x10 & 1) != 0) {
uVar8 = FUN_180043650(param_1,param_2,param_3);
return uVar8;
}
uVar8 = local_38 & 0x40;
if (param_2 == 1) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x17,&DAT_180084cf0);
}
iVar7 = (-(uint)(uVar8 != 0) & 0xfffffffc) + 8;
}
else if (param_2 == 0x56) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180084cf0);
}
iVar7 = (-(uint)(uVar8 != 0) & 0xfffffff8) + 0x10;
}
else if (param_2 == 0x57) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180084cf0);
}
iVar7 = 8;
}
else {
if (param_2 != 0x58) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x18,&DAT_180084cf0,param_2);
}
return 0x80090302;
}
iVar7 = 4;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180084cf0);
}
}

if ((int)uVar3 < 0) {
return uVar3;
}
if (param_2 == 1) {
local_res8 = (HLOCAL)0x0;
uVar3 = FUN_180056124(param_1,&local_res8);
hMem = local_res8;
if (uVar3 != 0) {
return uVar3;
}
lVar6 = -1;
do {
lVar6 = lVar6 + 1;
} while (*(short *)((longlong)local_res8 + lVar6 * 2) != 0);
iVar9 = (int)lVar6 * 2 + 2;

if ((int)uVar3 < 0) {
if (hMem == (HLOCAL)0x0) {
return uVar3;
}
LocalFree(hMem);
return uVar3;
}
if (uVar8 == 0) {
local_50 = local_58;
}
else {
local_50 = CONCAT44(local_50._4_4_,(int)local_58);
}
if ((local_58 != 0) &&

(int)uVar8 < 0)) {

if (hMem == (HLOCAL)0x0) {
return uVar8;
}
LocalFree(hMem);
return uVar8;
}
if (hMem != (HLOCAL)0x0) {
LocalFree(hMem);
}
goto LAB_180017786;
}
if (param_2 == 0x56) {
uVar5 = FUN_180059940(param_1,(longlong *)&local_res20,(uint *)&local_res8);
uVar3 = FUN_18000c3a8((uint)uVar5);
if (uVar3 != 0) {
return uVar3;
}
iVar1 = (int)local_res8;
iVar9 = (int)local_res8 * 4;

if ((int)uVar3 < 0) {
FUN_18000909c(local_res20);
return uVar3;
}
if (uVar8 == 0) {
local_48 = local_58;
}
else {
local_50._4_4_ = (undefined4)local_58;
}
local_50 = CONCAT44(local_50._4_4_,iVar1);

FUN_18000909c(local_res20);
if ((int)uVar8 < 0) {

return uVar8;
}
goto LAB_180017786;
}
if (param_2 == 0x57) {
iVar9 = *(int *)(param_1 + 0xa4);
uVar8 = *(uint *)(param_1 + 0xa8);
local_50 = *(longlong *)(param_1 + 0xa4);
if (uVar8 == 0) {
LAB_1800178f5:
if (iVar9 == 0) goto LAB_180017786;
}
else {
if (iVar9 != 0) goto LAB_180017786;
if (uVar8 == 0) goto LAB_1800178f5;
}
FUN_18000ff48((ulonglong)uVar8,(byte)local_38 & 1,(uint *)&local_res20,(uint *)&local_res8);
uVar4 = local_50._4_4_;
if (*(int *)(param_1 + 0xa8) == 0) {
uVar4 = (int)local_res8;
}
local_50 = CONCAT44(uVar4,(undefined4)local_50);
if (*(int *)(param_1 + 0xa4) != 0) goto LAB_180017786;
uVar4 = local_res20._0_4_;
}
else {
if (param_2 != 0x58) goto LAB_180017786;
uVar4 = *(undefined4 *)(param_1 + 0x98);
}
local_50 = CONCAT44(local_50._4_4_,uVar4);
LAB_180017786:

if ((int)uVar8 < 0) {
if (local_58 != 0) {

}
}
else {
uVar8 = 0;
}
return uVar8;
}
=========================================
Function at address: 0x180017bbc
Called functions addresses: 0x18004d1e0 0xEXTERNAL:000000bf


void FUN_180017bbc(void)

{
if (DAT_180091380 == 0) {
EtwEventRegister(&DAT_1800825b0,FUN_18004d1e0,&DAT_180091380,&DAT_180091380);
}
return;
}
=========================================
Function at address: 0x180017bfc
Called functions addresses: 0xEXTERNAL:000000ab


void FUN_180017bfc(void)

{
undefined8 *puVar1;

puVar1 = DAT_180091000;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
for (; puVar1 != (undefined8 *)0x0; puVar1 = (undefined8 *)*puVar1) {
if (puVar1[1] != 0) {
EtwUnregisterTraceGuids();
puVar1[1] = 0;
}
}
DAT_180091000 = &DAT_180091000;
}
return;
}
=========================================
Function at address: 0x180017c60
Called functions addresses: 0x18000909c 0xEXTERNAL:0000008d


undefined8 FUN_180017c60(longlong param_1,uint param_2)

{
PSLIST_ENTRY p_Var1;
byte bVar2;
int iVar3;
int iVar4;

if ((*(char *)(param_1 + 0x20) != '\0') && (param_2 != 0)) {
iVar3 = *(int *)(param_1 + 0x3c) - *(int *)(param_1 + 0x38);
*(int *)(param_1 + 0x38) = *(int *)(param_1 + 0x3c);
iVar4 = *(int *)(param_1 + 0x40);
*(int *)(param_1 + 0x40) = *(int *)(param_1 + 0x44);
if ((uint)(iVar3 * 0x3c) / param_2 < *(uint *)(param_1 + 0x30)) {
bVar2 = *(byte *)(param_1 + 0x21);
iVar4 = *(int *)(param_1 + 0x34);
}
else {
if (*(int *)(param_1 + 0x44) != iVar4) {
return 0;
}
iVar4 = *(int *)(param_1 + 0x34);
if (iVar4 <= iVar3) {
return 0;
}
bVar2 = *(char *)(param_1 + 0x21) + 1;
}
iVar4 = (iVar4 >> (bVar2 & 0x1f)) + 1;
while ((iVar4 != 0 && (*(int *)(param_1 + 0x28) < *(int *)(param_1 + 0x34)))) {
p_Var1 = InterlockedPopEntrySList((PSLIST_HEADER)(param_1 + 0x10));
FUN_18000909c(p_Var1);
LOCK();
*(int *)(param_1 + 0x34) = *(int *)(param_1 + 0x34) + -1;
UNLOCK();
iVar4 = iVar4 + -1;
}
}
return 0;
}
=========================================
Function at address: 0x180017c90
Called functions addresses: None


void FUN_180017c90(undefined8 *param_1)

{
*param_1 = &PTR_FUN_18007d3e8;
if (param_1[6] != 0) {

}
if (param_1[7] != 0) {

}
return;
}
=========================================
Function at address: 0x180017ccc
Called functions addresses: 0xEXTERNAL:000000a1 0x18007a134 0x18002623c 0xEXTERNAL:00000064 0xEXTERNAL:000000a2 0xEXTERNAL:000000a0 0xEXTERNAL:00000068


undefined4 * FUN_180017ccc(void)

{
PHANDLE phNewTimer;
int iVar1;
uint uVar2;
longlong *plVar3;
WAITORTIMERCALLBACK Callback;
code *pcVar4;
longlong *plVar5;
DWORD DueTime;
BOOL BVar6;
undefined4 *Parameter;
longlong lVar7;
ULONG DueTime_00;

plVar5 = DAT_180092d88;
Parameter = (undefined4 *)ProcessEnvironmentBlock;
if (((*(byte *)((longlong)ProcessEnvironmentBlock + 3) & 2) == 0) &&
(DAT_180092d88 != (longlong *)0x0)) {
Parameter = FUN_18002623c();
if (Parameter != (undefined4 *)0x0) {
EnterCriticalSection((LPCRITICAL_SECTION)(Parameter + 0x14));
lVar7 = *plVar5;
if ((*(longlong **)(lVar7 + 8) != plVar5) ||
(plVar3 = (longlong *)plVar5[1], (longlong *)*plVar3 != plVar5)) {
lVar7 = 3;
pcVar4 = (code *)swi(0x29);
(*pcVar4)();
if (99 < *(uint *)(lVar7 + 0x14)) {
if (*(uint *)(lVar7 + 0x1c) < *(uint *)(lVar7 + 0x18)) {
LOCK();
*(uint *)(lVar7 + 0x1c) = *(uint *)(lVar7 + 0x18);
UNLOCK();
}
*(undefined4 *)(lVar7 + 0x18) = 0;
}
return (undefined4 *)0x0;
}
*plVar3 = lVar7;
*(longlong **)(lVar7 + 8) = plVar3;
iVar1 = Parameter[8];
Parameter[8] = iVar1 + -1;
if (*(longlong *)(Parameter + 0x10) == plVar5[0x12]) {
phNewTimer = (PHANDLE)(Parameter + 0x12);
DeleteTimerQueueTimer((HANDLE)0x0,*phNewTimer,(HANDLE)0xffffffffffffffff);
*phNewTimer = (HANDLE)0x0;
*(undefined8 *)(Parameter + 0x10) = 0;
plVar3 = *(longlong **)(Parameter + 10);
if (plVar3 != (longlong *)(Parameter + 10)) {
DueTime = (Parameter[8] + 6) * 10000;
Parameter[0xf] = (Parameter[8] + 6) * 10;
Callback = (WAITORTIMERCALLBACK)plVar3[0x12];
*(WAITORTIMERCALLBACK *)(Parameter + 0x10) = Callback;
BVar6 = CreateTimerQueueTimer(phNewTimer,(HANDLE)0x0,Callback,Parameter,DueTime,DueTime,0)
;
if (BVar6 == 0) {
*(undefined8 *)(Parameter + 0x10) = 0;
}
}
}
else if (*(longlong *)(Parameter + 0x10) != 0) {
uVar2 = Parameter[0xf];
iVar1 = (iVar1 + -1) * 10;
if (iVar1 + 0x78U < uVar2) {
iVar1 = iVar1 + 0x3c;
DueTime_00 = iVar1 * 1000;
Parameter[0xf] = iVar1;
BVar6 = ChangeTimerQueueTimer
((HANDLE)0x0,*(HANDLE *)(Parameter + 0x12),DueTime_00,DueTime_00);
if (BVar6 == 0) {
Parameter[0xf] = uVar2;
}
}
}
LeaveCriticalSection((LPCRITICAL_SECTION)(Parameter + 0x14));
Parameter = (undefined4 *)FUN_18007a134(plVar5);
DAT_180092d88 = (longlong *)0x0;
}
}
return Parameter;
}
=========================================
Function at address: 0x180017d1c
Called functions addresses: 0xEXTERNAL:000000be


undefined8 FUN_180017d1c(void)

{
undefined8 uVar1;

if (DAT_180091380 == 0) {
uVar1 = 0;
}
else {
uVar1 = EtwEventUnregister();
DAT_180091380 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x180017d60
Called functions addresses: None


undefined8 FUN_180017d60(longlong param_1,int param_2)

{
if (((param_2 != 0) && (*(longlong *)(param_1 + 0x38) != 0)) && (99 < *(uint *)(param_1 + 0x14)))
{
if (*(uint *)(param_1 + 0x1c) < *(uint *)(param_1 + 0x18)) {
LOCK();
*(uint *)(param_1 + 0x1c) = *(uint *)(param_1 + 0x18);
UNLOCK();
}
*(undefined4 *)(param_1 + 0x18) = 0;
}
return 0;
}
=========================================
Function at address: 0x180017d80
Called functions addresses: 0x18002a7c0


void FUN_180017d80(undefined8 param_1,int param_2,byte param_3,undefined8 param_4,undefined8 param_5
,undefined8 param_6,int *param_7)

{
int iVar1;

if (param_7 != (int *)0x0) {
if (param_2 == 0) {
*param_7 = 0;
}
else if (param_2 == 1) {
if (param_3 == 0) {
iVar1 = 0x100;
}
else {
iVar1 = param_3 + 1;
}
*param_7 = iVar1;
*(undefined8 *)(param_7 + 4) = param_4;
*(undefined8 *)(param_7 + 6) = param_5;
}
if (*(longlong *)(param_7 + 10) != 0) {

}
}
return;
}
=========================================
Function at address: 0x180017e08
Called functions addresses: 0xEXTERNAL:000000b3


void FUN_180017e08(char *param_1)

{
if (*param_1 != '\0') {
RtlDeleteResource(param_1 + 8);
}
return;
}
=========================================
Function at address: 0x180017e30
Called functions addresses: 0x18007916c 0x18007888c 0x180079550 0x180078c6c


void FUN_180017e30(void)

{
if (DAT_1800921b0 == 0) {
return;
}
FUN_18007916c();
FUN_18007888c();
FUN_180079550();
FUN_180078c6c();
return;
}
=========================================
Function at address: 0x180017e50
Called functions addresses: 0xEXTERNAL:0000006c 0x180017e85 0x180027b44 0xEXTERNAL:0000006e


void FUN_180017e50(undefined8 param_1,undefined8 param_2,undefined8 param_3,longlong param_4)

{
BOOLEAN BVar1;
longlong lVar2;

if ((int)param_2 != 2) {
return;
}
if ((param_4 == 0x20) &&
(BVar1 = TryAcquireSRWLockExclusive((PSRWLOCK)&DAT_180092d70), lVar2 = DAT_180092ee8,
BVar1 != '\0')) {
for (; lVar2 != 0; lVar2 = *(longlong *)(lVar2 + 0x150)) {
FUN_180027b44(lVar2,param_2,param_3,param_4);
}
ReleaseSRWLockExclusive((PSRWLOCK)&DAT_180092d70);
FUN_180017e85();
return;
}
return;
}
=========================================
Function at address: 0x180017e85
Called functions addresses: None


void FUN_180017e85(void)

{
return;
}
=========================================
Function at address: 0x180017e94
Called functions addresses: None


void FUN_180017e94(void)

{
return;
}
=========================================
Function at address: 0x180017ea0
Called functions addresses: None


undefined8 FUN_180017ea0(undefined4 *param_1)

{
param_1[1] = 0xe0001;
*(wchar_t **)(param_1 + 4) = L"Schannel";
*(wchar_t **)(param_1 + 6) = L"Schannel Security Package";
*param_1 = 0x4107b3;
param_1[2] = 0x6000;
return 0;
}
=========================================
Function at address: 0x180017ee0
Called functions addresses: None


undefined8 FUN_180017ee0(undefined4 *param_1)

{
param_1[1] = 0xe0001;
*(wchar_t **)(param_1 + 4) = L"Microsoft Unified Security Protocol Provider";
*(wchar_t **)(param_1 + 6) = L"Schannel Security Package";
*param_1 = 0x4107b3;
param_1[2] = 0x6000;
return 0;
}
=========================================
Function at address: 0x180017f20
Called functions addresses: None


void FUN_180017f20(void)

{
return;
}
=========================================
Function at address: 0x180017f30
Called functions addresses: None


undefined8 FUN_180017f30(void)

{
return 0x80090302;
}
=========================================
Function at address: 0x180017f40
Called functions addresses: None


undefined8 FUN_180017f40(void)

{
return 0;
}
=========================================
Function at address: 0x180017f50
Called functions addresses: None


undefined8 FUN_180017f50(void)

{
return 0x78;
}
=========================================
Function at address: 0x180017f60
Called functions addresses: None


void FUN_180017f60(longlong param_1,undefined8 *param_2,undefined4 *param_3,undefined8 *param_4,
undefined4 *param_5,undefined8 *param_6,undefined4 *param_7,undefined8 *param_8,
undefined4 *param_9,undefined8 *param_10,undefined4 *param_11,undefined8 *param_12
,undefined4 *param_13)

{
*param_2 = *(undefined8 *)(param_1 + 0x98);
*param_3 = *(undefined4 *)(param_1 + 0xa0);
*param_4 = *(undefined8 *)(param_1 + 0xa8);
*param_5 = *(undefined4 *)(param_1 + 0xb0);
*param_6 = *(undefined8 *)(param_1 + 0xb8);
*param_7 = *(undefined4 *)(param_1 + 0xc0);
*param_8 = *(undefined8 *)(param_1 + 200);
*param_9 = *(undefined4 *)(param_1 + 0xd0);
*param_10 = *(undefined8 *)(param_1 + 0xd8);
*param_11 = *(undefined4 *)(param_1 + 0xe0);
*param_12 = *(undefined8 *)(param_1 + 0xe8);
*param_13 = *(undefined4 *)(param_1 + 0xf0);
return;
}
=========================================
Function at address: 0x180018010
Called functions addresses: None


undefined8 FUN_180018010(longlong param_1,undefined8 *param_2,undefined4 *param_3)

{
*param_2 = *(undefined8 *)(param_1 + 0x108);
*param_3 = *(undefined4 *)(param_1 + 0x110);
return 0;
}
=========================================
Function at address: 0x180018030
Called functions addresses: None


undefined8 FUN_180018030(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x1b0);
}
=========================================
Function at address: 0x180018050
Called functions addresses: None


void FUN_180018050(longlong param_1,undefined8 *param_2,undefined8 *param_3)

{
*param_2 = *(undefined8 *)(param_1 + 0x28);
*param_3 = *(undefined8 *)(param_1 + 0x30);
return;
}
=========================================
Function at address: 0x180018070
Called functions addresses: None


undefined8 FUN_180018070(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x188);
}
=========================================
Function at address: 0x180018090
Called functions addresses: None


undefined8 FUN_180018090(longlong param_1)

{
return *(undefined8 *)(param_1 + 400);
}
=========================================
Function at address: 0x1800180b0
Called functions addresses: None


undefined8 FUN_1800180b0(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x198);
}
=========================================
Function at address: 0x1800180d0
Called functions addresses: None


longlong FUN_1800180d0(longlong param_1)

{
return param_1 + 0x1a0;
}
=========================================
Function at address: 0x1800180f0
Called functions addresses: None


void FUN_1800180f0(longlong param_1,undefined8 *param_2,undefined4 *param_3)

{
*param_2 = *(undefined8 *)(param_1 + 0xf8);
*param_3 = *(undefined4 *)(param_1 + 0x100);
return;
}
=========================================
Function at address: 0x180018110
Called functions addresses: 0x18002a77b


undefined8 FUN_180018110(longlong param_1,undefined4 *param_2)

{
*param_2 = *(undefined4 *)(param_1 + 8);
*(undefined8 *)(param_2 + 2) = *(undefined8 *)(param_1 + 0x10);
param_2[4] = *(undefined4 *)(param_1 + 0x18);
param_2[5] = *(undefined4 *)(param_1 + 0x38);
param_2[6] = *(undefined4 *)(param_1 + 0x3c);
param_2[7] = *(undefined4 *)(param_1 + 0x1c);
param_2[8] = *(undefined4 *)(param_1 + 0x40);
param_2[9] = *(undefined4 *)(param_1 + 0x48);
param_2[0x26] = *(undefined4 *)(param_1 + 0x44);
param_2[10] = *(undefined4 *)(param_1 + 0xc4);
*(undefined8 *)(param_2 + 0xc) = *(undefined8 *)(param_1 + 0x60);
*(undefined8 *)(param_2 + 0xe) = *(undefined8 *)(param_1 + 0x68);
param_2[0x2c] = *(undefined4 *)(param_1 + 0x74);
*(undefined8 *)(param_2 + 0x28) = *(undefined8 *)(param_1 + 0x78);
*(undefined8 *)(param_2 + 0x2a) = *(undefined8 *)(param_1 + 0x80);
*(undefined2 *)(param_2 + 0x2d) = *(undefined2 *)(param_1 + 0x88);
*(undefined2 *)((longlong)param_2 + 0xb6) = *(undefined2 *)(param_1 + 0x8a);
param_2[0x2f] = *(undefined4 *)(param_1 + 0x1cc);
*(undefined *)(param_2 + 0x30) = *(undefined *)(param_1 + 0x1c8);
*(undefined *)(param_2 + 0xb) = *(undefined *)(param_1 + 0x20);
param_2[0x24] = *(undefined4 *)(param_1 + 0x178);
param_2[0x25] = *(undefined4 *)(param_1 + 0x17c);
param_2[0x16] = *(undefined4 *)(param_1 + 0x140);
memcpy(param_2 + 0x17,(void *)(param_1 + 0x144),(ulonglong)*(uint *)(param_1 + 0x140));
param_2[0x1f] = *(undefined4 *)(param_1 + 0x164);
memcpy(param_2 + 0x20,(void *)(param_1 + 0x168),(ulonglong)*(uint *)(param_1 + 0x164));
*(undefined8 *)(param_2 + 0x14) = *(undefined8 *)(param_1 + 0x128);
return 0;
}
=========================================
Function at address: 0x180018250
Called functions addresses: None


undefined8 FUN_180018250(void)

{
return 0xc00000bb;
}
=========================================
Function at address: 0x180018260
Called functions addresses: None


undefined8 FUN_180018260(void)

{
return 0xc00000bb;
}
=========================================
Function at address: 0x180018270
Called functions addresses: None


undefined8 FUN_180018270(void)

{
return 0x80090302;
}
=========================================
Function at address: 0x180018280
Called functions addresses: None


undefined8 FUN_180018280(void)

{
return 0x80090302;
}
=========================================
Function at address: 0x180018290
Called functions addresses: None


void FUN_180018290(void)

{
return;
}
=========================================
Function at address: 0x1800182a0
Called functions addresses: None


undefined8 FUN_1800182a0(void)

{
return 0x78;
}
=========================================
Function at address: 0x1800182b0
Called functions addresses: None


undefined8 FUN_1800182b0(void)

{
return 0;
}
=========================================
Function at address: 0x1800182c0
Called functions addresses: None


undefined8 FUN_1800182c0(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x3a0);
}
=========================================
Function at address: 0x1800182e0
Called functions addresses: None


undefined8 FUN_1800182e0(longlong param_1)

{
return *(undefined8 *)(*(longlong *)(param_1 + 0x3e0) + 0x150);
}
=========================================
Function at address: 0x180018300
Called functions addresses: None


void FUN_180018300(longlong param_1,undefined8 *param_2)

{
*param_2 = *(undefined8 *)(param_1 + 0x528);
return;
}
=========================================
Function at address: 0x180018320
Called functions addresses: None


void FUN_180018320(undefined8 param_1,undefined8 *param_2)

{
*param_2 = 0;
return;
}
=========================================
Function at address: 0x180018330
Called functions addresses: None


void FUN_180018330(longlong param_1,undefined8 *param_2)

{
*param_2 = *(undefined8 *)(param_1 + 0x3e0);
return;
}
=========================================
Function at address: 0x180018350
Called functions addresses: None


void FUN_180018350(undefined8 param_1,undefined8 *param_2)

{
*param_2 = 0;
return;
}
=========================================
Function at address: 0x180018360
Called functions addresses: None


void FUN_180018360(longlong param_1,undefined8 *param_2,undefined4 *param_3)

{
longlong lVar1;

lVar1 = *(longlong *)(param_1 + 0x528);
*param_3 = *(undefined4 *)(lVar1 + 0x158);
*param_2 = *(undefined8 *)(lVar1 + 0x150);
return;
}
=========================================
Function at address: 0x180018390
Called functions addresses: None


void FUN_180018390(undefined8 param_1,undefined8 *param_2,undefined4 *param_3)

{
*param_2 = 0;
*param_3 = 0;
return;
}
=========================================
Function at address: 0x1800183b0
Called functions addresses: None


void FUN_1800183b0(longlong param_1,undefined8 *param_2,undefined4 *param_3)

{
longlong lVar1;

lVar1 = *(longlong *)(param_1 + 0x528);
*param_3 = *(undefined4 *)(lVar1 + 0x168);
*param_2 = *(undefined8 *)(lVar1 + 0x160);
return;
}
=========================================
Function at address: 0x1800183e0
Called functions addresses: None


void FUN_1800183e0(undefined8 param_1,undefined8 *param_2,undefined4 *param_3)

{
*param_2 = 0;
*param_3 = 0;
return;
}
=========================================
Function at address: 0x180018400
Called functions addresses: None


undefined8 FUN_180018400(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x400);
}
=========================================
Function at address: 0x180018420
Called functions addresses: None


undefined8 FUN_180018420(void)

{
return 0;
}
=========================================
Function at address: 0x180018430
Called functions addresses: None


void FUN_180018430(longlong param_1,undefined8 *param_2,undefined4 *param_3)

{
longlong lVar1;

lVar1 = *(longlong *)(param_1 + 0x528);
*param_2 = *(undefined8 *)(lVar1 + 400);
*param_3 = *(undefined4 *)(lVar1 + 0x198);
return;
}
=========================================
Function at address: 0x180018460
Called functions addresses: None


void FUN_180018460(undefined8 param_1,undefined8 *param_2,undefined4 *param_3)

{
*param_2 = 0;
*param_3 = 0;
return;
}
=========================================
Function at address: 0x180018480
Called functions addresses: None


undefined8 FUN_180018480(void)

{
return 0;
}
=========================================
Function at address: 0x180018490
Called functions addresses: None


undefined8 FUN_180018490(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x5b8);
}
=========================================
Function at address: 0x1800184b0
Called functions addresses: None


undefined8 FUN_1800184b0(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x448);
}
=========================================
Function at address: 0x1800184d0
Called functions addresses: None


undefined FUN_1800184d0(void)

{
return 0;
}
=========================================
Function at address: 0x1800184e0
Called functions addresses: None


undefined FUN_1800184e0(longlong param_1)

{
return *(undefined *)(param_1 + 0x650);
}
=========================================
Function at address: 0x1800184f0
Called functions addresses: None


undefined FUN_1800184f0(longlong param_1)

{
return *(undefined *)(param_1 + 0x4e0);
}
=========================================
Function at address: 0x180018500
Called functions addresses: None


undefined8 FUN_180018500(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x360);
}
=========================================
Function at address: 0x180018520
Called functions addresses: None


undefined8 FUN_180018520(void)

{
return 0;
}
=========================================
Function at address: 0x180018530
Called functions addresses: None


void FUN_180018530(longlong param_1,undefined8 *param_2,undefined8 *param_3)

{
*param_2 = *(undefined8 *)(param_1 + 0x90);
*param_3 = *(undefined8 *)(param_1 + 0x98);
return;
}
=========================================
Function at address: 0x180018550
Called functions addresses: None


undefined FUN_180018550(longlong param_1)

{
return *(undefined *)(param_1 + 0x22a);
}
=========================================
Function at address: 0x180018560
Called functions addresses: None


undefined FUN_180018560(void)

{
return 0;
}
=========================================
Function at address: 0x180018570
Called functions addresses: None


undefined8 FUN_180018570(longlong param_1)

{
return *(undefined8 *)(param_1 + 8);
}
=========================================
Function at address: 0x180018580
Called functions addresses: None


undefined8 FUN_180018580(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x318);
}
=========================================
Function at address: 0x1800185a0
Called functions addresses: None


undefined8 FUN_1800185a0(void)

{
return 0;
}
=========================================
Function at address: 0x1800185b0
Called functions addresses: None


undefined8 FUN_1800185b0(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x328);
}
=========================================
Function at address: 0x1800185d0
Called functions addresses: None


undefined8 FUN_1800185d0(void)

{
return 0;
}
=========================================
Function at address: 0x1800185e0
Called functions addresses: None


undefined8 FUN_1800185e0(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x338);
}
=========================================
Function at address: 0x180018600
Called functions addresses: None


undefined8 FUN_180018600(void)

{
return 0;
}
=========================================
Function at address: 0x180018610
Called functions addresses: None


undefined8 FUN_180018610(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x3f8);
}
=========================================
Function at address: 0x180018630
Called functions addresses: None


undefined8 FUN_180018630(void)

{
return 0;
}
=========================================
Function at address: 0x180018640
Called functions addresses: None


undefined8 FUN_180018640(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x530);
}
=========================================
Function at address: 0x180018660
Called functions addresses: None


undefined8 FUN_180018660(void)

{
return 0;
}
=========================================
Function at address: 0x180018670
Called functions addresses: None


undefined8 FUN_180018670(longlong param_1)

{
return *(undefined8 *)(param_1 + 0x340);
}
=========================================
Function at address: 0x180018690
Called functions addresses: None


undefined8 FUN_180018690(void)

{
return 0;
}
=========================================
Function at address: 0x1800186a0
Called functions addresses: None


void FUN_1800186a0(undefined8 param_1,undefined8 *param_2,undefined4 *param_3)

{
*param_2 = 0;
*param_3 = 0;
return;
}
=========================================
Function at address: 0x1800186c0
Called functions addresses: None


undefined8 FUN_1800186c0(void)

{
return 0;
}
=========================================
Function at address: 0x1800186d0
Called functions addresses: None


undefined8 FUN_1800186d0(void)

{
return 0;
}
=========================================
Function at address: 0x1800186e0
Called functions addresses: None


undefined8 FUN_1800186e0(void)

{
return 0;
}
=========================================
Function at address: 0x1800186f0
Called functions addresses: None


undefined8 FUN_1800186f0(void)

{
return 0;
}
=========================================
Function at address: 0x180018700
Called functions addresses: None


void FUN_180018700(void)

{
return;
}
=========================================
Function at address: 0x180018710
Called functions addresses: None


undefined8 FUN_180018710(void)

{
return 0;
}
=========================================
Function at address: 0x180018720
Called functions addresses: None


undefined8 FUN_180018720(void)

{
return 0x78;
}
=========================================
Function at address: 0x180018730
Called functions addresses: None


undefined8 FUN_180018730(void)

{
return 0;
}
=========================================
Function at address: 0x180018740
Called functions addresses: None


undefined8 FUN_180018740(void)

{
return 0;
}
=========================================
Function at address: 0x180018750
Called functions addresses: None


void FUN_180018750(void)

{
return;
}
=========================================
Function at address: 0x180018760
Called functions addresses: None


void FUN_180018760(longlong param_1,undefined param_2)

{
*(undefined *)(param_1 + 0x650) = param_2;
return;
}
=========================================
Function at address: 0x180018770
Called functions addresses: None


void FUN_180018770(longlong param_1,undefined param_2)

{
*(undefined *)(param_1 + 0x4e0) = param_2;
return;
}
=========================================
Function at address: 0x180018780
Called functions addresses: None


undefined8 FUN_180018780(void)

{
return 0;
}
=========================================
Function at address: 0x180018790
Called functions addresses: None


undefined8 FUN_180018790(void)

{
return 0;
}
=========================================
Function at address: 0x1800187a0
Called functions addresses: None


void FUN_1800187a0(longlong param_1,undefined param_2)

{
*(undefined *)(param_1 + 0x22a) = param_2;
return;
}
=========================================
Function at address: 0x1800187b0
Called functions addresses: None


void FUN_1800187b0(void)

{
return;
}
=========================================
Function at address: 0x1800187c0
Called functions addresses: None


undefined8 FUN_1800187c0(void)

{
return 0x78;
}
=========================================
Function at address: 0x1800187d0
Called functions addresses: None


undefined8 FUN_1800187d0(void)

{
return 0;
}
=========================================
Function at address: 0x1800187e0
Called functions addresses: None


undefined8 FUN_1800187e0(void)

{
return 0;
}
=========================================
Function at address: 0x1800187f0
Called functions addresses: None


undefined8 FUN_1800187f0(void)

{
return 0;
}
=========================================
Function at address: 0x180018800
Called functions addresses: None


undefined FUN_180018800(void)

{
return 1;
}
=========================================
Function at address: 0x180018810
Called functions addresses: None


undefined8 FUN_180018810(void)

{
return 0x78;
}
=========================================
Function at address: 0x180018820
Called functions addresses: None


undefined8 FUN_180018820(undefined8 param_1,undefined8 *param_2,undefined4 *param_3)

{
*param_2 = 0;
*param_3 = 0;
return 0x80090302;
}
=========================================
Function at address: 0x180018840
Called functions addresses: None


undefined8 FUN_180018840(void)

{
return 1;
}
=========================================
Function at address: 0x180018850
Called functions addresses: None


undefined8 FUN_180018850(void)

{
return 2;
}
=========================================
Function at address: 0x180018860
Called functions addresses: None


undefined8 FUN_180018860(longlong param_1,undefined8 *param_2,undefined4 *param_3)

{
*param_2 = *(undefined8 *)(*(longlong *)(param_1 + 0x3e0) + 0x158);
*param_3 = *(undefined4 *)(*(longlong *)(param_1 + 0x3e0) + 0x160);
return 0;
}
=========================================
Function at address: 0x180018890
Called functions addresses: None


undefined8 FUN_180018890(void)

{
return 0;
}
=========================================
Function at address: 0x1800188a0
Called functions addresses: None


undefined8 FUN_1800188a0(longlong param_1)

{
*(undefined2 *)(param_1 + 0x98) = 5;
return 0;
}
=========================================
Function at address: 0x1800188c0
Called functions addresses: None


undefined FUN_1800188c0(void)

{
return 0;
}
=========================================
Function at address: 0x1800188d0
Called functions addresses: None


void FUN_1800188d0(longlong *param_1,longlong *param_2,uint *param_3)

{
*param_2 = *param_1;
*param_1 = *param_1 + (ulonglong)*param_3;
*(uint *)(param_1 + 1) = *(int *)(param_1 + 1) - *param_3;
return;
}
=========================================
Function at address: 0x1800188f0
Called functions addresses: None


void FUN_1800188f0(void)

{
return;
}
=========================================
Function at address: 0x180018910
Called functions addresses: 0x180079a10 0xEXTERNAL:000000d3 0xEXTERNAL:00000064 0xEXTERNAL:00000052 0xEXTERNAL:00000068


void FUN_180018910(longlong param_1)

{
if (*(int *)(param_1 + 0x1c) == 0) {
RegSetValueExW(*(HKEY *)(param_1 + 0xa8),*(LPCWSTR *)(param_1 + 0xb8),0,4,
(BYTE *)(param_1 + 0x18),4);
}
else {
if (*(int *)(param_1 + 0x1c) != -1) {
return;
}
EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xc0));
FUN_180079a10(param_1,*(uint *)(param_1 + 0x18),0);
LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xc0));
}
NtQuerySystemTime(param_1 + 0x18);
return;
}
=========================================
Function at address: 0x180018960
Called functions addresses: 0x180074f68 0x180071c4c 0x180062118 0x180073c88 0x18002a7c0 0x180006620 0x180076330 0x180041d20 0x180071978 0x1800024d0 0x180076ba0 0x180018bd0 0x180041cb0 0x180053124 0x180007fac


ulonglong FUN_180018960(longlong *param_1,byte *param_2,int param_3,undefined4 *param_4)

{
int iVar1;
uint uVar2;
undefined uVar3;
undefined2 uVar4;
ulonglong uVar5;
ulonglong uVar6;
longlong lVar7;
undefined8 uVar8;
ushort *puVar9;
uint uVar10;
char local_res8 [8];
undefined local_res18;

uVar2 = 4;
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar2 = 0xc;
}
uVar10 = param_3 - uVar2;
lVar7 = (ulonglong)*param_2 << 0x10;
*param_4 = 0;
puVar9 = (ushort *)(param_2 + uVar2);
uVar3 = 1;
uVar2 = (uint)*(ushort *)((longlong)param_1 + 0x44) | (uint)lVar7;
local_res8[0] = '\0';
local_res18 = 1;
if (uVar2 == 0x10000) {
LAB_180018a35:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180082bd8);
uVar3 = local_res18;
}

;
if (uVar2 == 0) {
*(uint *)((longlong)param_1 + 0x44) = (local_res8[0] != '\0') + 0x5d;
}
*(undefined *)(param_1 + 0x45) = 0;
return (ulonglong)uVar2;
}
if (uVar2 == 0x140041) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180082bd8);
}
uVar2 = FUN_180006620(param_1,puVar9,uVar10);
if (uVar2 != 0) {
return (ulonglong)uVar2;
}

*param_4 = 1;
return (ulonglong)uVar2;
}
if (uVar2 < 0x100047) {
if (uVar2 == 0x100046) goto LAB_180018ac1;
if (uVar2 == 0x1004c) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180082bd8);
}
if (DAT_1800927c0 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0x80090326;
}
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180082bd8);
return 0x80090326;
}
FUN_180053124(param_1[0xf],1,param_1[0x11]);

param_1[0x11] = param_1[0x11] & 0xffffffffbfffffff;
uVar3 = 0;
param_1[0xb] = 0;
local_res18 = 0;
goto LAB_180018a35;
}
if (uVar2 == 0xb0046) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x10,&DAT_180082bd8);
}
if (*(int *)(param_1[1] + 0x30) != 4) {
if ((*(uint *)(param_1 + 0x11) >> 8 & 1) != 0) {
uVar2 = FUN_180007fac(param_1,(byte *)puVar9,uVar10);
if (uVar2 != 0) {
return (ulonglong)uVar2;
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x3c;
return (ulonglong)uVar2;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar4 = 0x12;
goto LAB_18002d419;
}
goto LAB_18002d429;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18002d429;
uVar4 = 0x11;
goto LAB_18002d419;
}
if (uVar2 != 0xf003d) {
if (uVar2 != 0x10003c) goto LAB_18002d128;
goto LAB_180018ac1;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180082bd8);
}
if (*(int *)(param_1[1] + 0x30) != 4) {
uVar6 = (ulonglong)uVar10;
uVar5 = FUN_180062118(param_1,puVar9,uVar10);
if ((int)uVar5 != 0) {
return uVar5 & 0xffffffff;
}
uVar5 = FUN_180073c88(param_1,puVar9,uVar6,lVar7);
*(undefined4 *)((longlong)param_1 + 0x44) = 0x3e;
return uVar5 & 0xffffffff;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar4 = 0x14;
goto LAB_18002d419;
}
LAB_18002d429:
uVar5 = 0x80090326;
}
else {
if (uVar2 == 0x14003f) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180082bd8);
}
uVar2 = FUN_180006620(param_1,puVar9,uVar10);
if (uVar2 != 0) {
return (ulonglong)uVar2;
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x5f;
return (ulonglong)uVar2;
}
if (uVar2 != 0x10004b) {
if (uVar2 == 0x170046) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180082bd8);
}
uVar5 = FUN_180076330((longlong)param_1,(byte *)puVar9,uVar10);
return uVar5 & 0xffffffff;
}
LAB_18002d128:
if ((*(uint *)(param_1 + 8) & 0xf3fc0) != 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x60;
*(undefined2 *)(param_1 + 0xc) = 0xa02;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],0x17,&DAT_180082bd8,(uint)lVar7,
(char)*(undefined2 *)((longlong)param_1 + 0x44));
}
goto LAB_18002d429;
}
LAB_180018ac1:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180082bd8);
}
if (*(int *)(param_1[1] + 0x30) == 4) {
if (param_1[0x6a] == 0) {
uVar2 = FUN_180076ba0(param_1,(undefined *)puVar9,uVar10,0);
if (uVar2 != 0) {
return (ulonglong)uVar2;
}
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
*(undefined *)(param_1 + 0x1d) = 1;
}
*param_4 = 1;
return 0x90320;
}
}
else if ((*(int *)((longlong)param_1 + 0x44) == 0x46) &&
((*(uint *)(param_1 + 0x11) >> 8 & 1) != 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar4 = 0xe;
LAB_18002d419:
FUN_180041cb0(DAT_180091000[2],uVar4,&DAT_180082bd8);
}
goto LAB_18002d429;
}
uVar8 = 0;

uVar5 = (ulonglong)uVar2;
if (uVar2 == 0) {
*param_4 = 1;
param_1[0x11] = param_1[0x11] | 0x8000;
iVar1 = *(int *)(param_1[1] + 0x30);
if (iVar1 == 3) {
uVar2 = FUN_180018bd0(param_1,(byte *)puVar9,uVar10);
uVar5 = (ulonglong)uVar2;
}
else if (iVar1 == 2) {
uVar2 = FUN_180074f68(param_1,(undefined *)puVar9,uVar10);
uVar5 = (ulonglong)uVar2;
}
else if (iVar1 == 4) {
uVar2 = FUN_1800024d0(param_1,0,0,(ushort *)CONCAT71((int7)((ulonglong)uVar8 >> 8),1));
uVar5 = (ulonglong)uVar2;
}
else {
iVar1 = *(int *)(param_1[1] + 0x34);
if (iVar1 == 2) {
uVar2 = FUN_180071c4c(param_1,(undefined *)puVar9,uVar10);
uVar5 = (ulonglong)uVar2;
}
else if (iVar1 == 4) {
uVar2 = FUN_180071978(param_1,(undefined *)puVar9,uVar10);
uVar5 = (ulonglong)uVar2;
}
else {
uVar5 = 0x80090308;
}
}
if ((int)uVar5 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x3d;
}
}
}
return uVar5;
}
=========================================
Function at address: 0x180018bd0
Called functions addresses: 0x1800029e8 0x18002a77b 0x18002a700 0x18000a418 0x18005b470 0x18002a7c0 0xEXTERNAL:00000122 0x180028d90 0x180028070 0xEXTERNAL:0000011c 0x1800024d0


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_180018bd0(longlong *param_1,byte *param_2,uint param_3)

{
byte *pbVar1;
byte bVar2;
uint uVar3;
longlong lVar4;
int iVar5;
undefined8 uVar6;
ulonglong uVar7;
undefined4 *puVar8;
ulonglong uVar9;
undefined8 *puVar10;
undefined4 uVar11;
undefined8 *puVar12;
undefined8 *_Dst;
undefined *puVar13;
undefined *puVar14;
undefined uVar15;
undefined8 *puVar16;
undefined auStack_68 [48];
longlong local_38 [2];

local_38[1] = DAT_180091970 ^ (ulonglong)local_38;
puVar10 = (undefined8 *)0x0;
local_38[0] = 0;
iVar5 = 0;
puVar12 = (undefined8 *)0x0;
uVar3 = *(uint *)(param_1[0x78] + 0x18);
uVar7 = (ulonglong)uVar3;
_Dst = puVar10;
puVar14 = auStack_68;
if ((((uVar3 == 0) || (_Dst = puVar12, puVar14 = auStack_68, DAT_1800920e0 < uVar7)) ||
(uVar9 = DAT_1800920e8 + 8 + uVar7, puVar14 = auStack_68, uVar9 < uVar7)) ||
(uVar6 = FUN_18000a418(uVar9), puVar14 = auStack_68, (int)uVar6 == 0)) {
LAB_18002d530:
if (uVar3 <= uVar3 + 8) {
*(undefined8 *)(puVar14 + -8) = 0x18002d552;

if (puVar8 == (undefined4 *)0x0) goto LAB_180018dbf;
*puVar8 = 0x70616548;
_Dst = (undefined8 *)(puVar8 + 2);
}
puVar13 = puVar14;
if (_Dst == (undefined8 *)0x0) goto LAB_180018dbf;
}
else {
uVar7 = (ulonglong)(uVar3 + 8) + 0xf;
if (uVar7 <= uVar3 + 8) {
uVar7 = 0xffffffffffffff0;
}
lVar4 = -(uVar7 & 0xfffffffffffffff0);
_Dst = (undefined8 *)((longlong)local_38 + lVar4);
puVar14 = auStack_68 + lVar4;
if (_Dst == (undefined8 *)0x0) goto LAB_18002d530;
*(undefined4 *)_Dst = 0x6b637453;
_Dst = (undefined8 *)((longlong)local_38 + lVar4 + 8);
puVar14 = auStack_68 + lVar4;
puVar13 = auStack_68 + lVar4;
if (_Dst == (undefined8 *)0x0) goto LAB_18002d530;
}
*(undefined8 *)(puVar13 + -8) = 0x180018ca8;
memset(_Dst,0,(ulonglong)uVar3);
*_Dst = **(undefined8 **)(param_1[0x78] + 0x10);
if ((param_2 != (byte *)0x0) && (2 < param_3)) {
bVar2 = *param_2;
pbVar1 = param_2 + 1;
if ((bVar2 + 1 == param_3) && (bVar2 != 0)) {
if (pbVar1 == (byte *)0x0) {
LAB_18002d5f4:
iVar5 = 0x54f;
goto LAB_18002d600;
}
if ((*(byte *)((longlong)param_1 + 0x14) & 8) == 0) {
if ((*pbVar1 == 4) && ((ulonglong)bVar2 + 7 <= (ulonglong)uVar3)) {
*(undefined8 *)(puVar13 + -8) = 0x180018d24;
memcpy(_Dst + 1,param_2 + 2,(ulonglong)(bVar2 - 1));
}
else {
iVar5 = -0x7ff6fcf8;
}
}
else {
*(undefined8 *)(puVar13 + -8) = 0x18002d586;
uVar6 = FUN_1800029e8(pbVar1,(uint)bVar2,(longlong)_Dst,uVar3);
iVar5 = (int)uVar6;
}
if (iVar5 != 0) goto LAB_18002d5f4;
puVar12 = (undefined8 *)param_1[1];
if ((puVar12[0x6a] != 0) && (*(char *)(puVar12[0x6a] + 0x18) != '\0')) {
uVar11 = *(undefined4 *)_Dst;
*(undefined4 *)_Dst = *(undefined4 *)(param_1 + 2);
puVar12 = puVar10;
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
puVar12 = *(undefined8 **)param_1[1];
}
*(undefined4 *)(puVar13 + 0x28) = 0;
*(uint *)(puVar13 + 0x20) = uVar3;
*(undefined8 *)(puVar13 + -8) = 0x180018d80;
puVar16 = _Dst;
iVar5 = SslImportKey(puVar12,local_38,L"SSLECCPUBLICBLOB",_Dst);
if (iVar5 != 0) {
*(undefined4 *)_Dst = uVar11;
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
puVar10 = *(undefined8 **)param_1[1];
}
goto LAB_18002d5bc;
}
LAB_180018d8d:
lVar4 = local_38[0];
uVar6 = *(undefined8 *)(param_1[0x78] + 8);
*(undefined8 *)(puVar13 + -8) = 0x180018da7;
FUN_1800024d0(param_1,uVar6,lVar4,(ushort *)CONCAT71((int7)((ulonglong)puVar16 >> 8),1));
goto LAB_180018da9;
}
if (puVar12 != (undefined8 *)0x0) {
puVar10 = (undefined8 *)*puVar12;
}
LAB_18002d5bc:
*(undefined4 *)(puVar13 + 0x28) = 0;
*(uint *)(puVar13 + 0x20) = uVar3;
*(undefined8 *)(puVar13 + -8) = 0x18002d5db;
puVar16 = _Dst;
iVar5 = SslImportKey(puVar10,local_38,L"ECCPUBLICBLOB",_Dst);
if (iVar5 == 0) goto LAB_180018d8d;
uVar15 = 0x33;
uVar11 = 0x2bf;
}
else {
iVar5 = -0x7ff6fcf8;
LAB_18002d600:
uVar15 = 0x32;
uVar11 = 0x2be;
}
*(undefined8 *)(puVar13 + -8) = 0x18002d613;
FUN_18005b470(param_1,uVar11,iVar5,uVar15);
}
LAB_180018da9:
puVar14 = puVar13;
if ((_Dst != (undefined8 *)0x0) && (*(int *)(_Dst + -1) == 0x70616548)) {
*(undefined8 *)(puVar13 + -8) = 0x18002d63a;

}
LAB_180018dbf:
lVar4 = local_38[0];
if (local_38[0] != 0) {
*(undefined8 *)(puVar14 + -8) = 0x180018dd1;
SslFreeObject(lVar4,0);
}
uVar7 = local_38[1] ^ (ulonglong)local_38;
*(undefined8 *)(puVar14 + -8) = 0x180018de4;
FUN_180028070(uVar7);
return;
}
=========================================
Function at address: 0x180018e08
Called functions addresses: 0xEXTERNAL:00000089 0xEXTERNAL:0000009a


bool FUN_180018e08(longlong param_1)

{
LONG LVar1;
_FILETIME local_res8 [4];

GetSystemTimeAsFileTime(local_res8);
LOCK();
*(int *)(param_1 + 0x1c) = *(int *)(param_1 + 0x1c) + 1;
UNLOCK();
LVar1 = CompareFileTime(local_res8,(FILETIME *)(param_1 + 0x20));
return LVar1 < 0;
}
=========================================
Function at address: 0x180018e50
Called functions addresses: 0xEXTERNAL:000000c0 0x180023408 0xEXTERNAL:000000c2


longlong FUN_180018e50(void)

{
undefined *puVar1;
longlong lVar2;
longlong local_res8 [4];

puVar1 = &DAT_180092428;
local_res8[0] = 0;
RtlAcquireResourceShared(&DAT_180092428,1);
lVar2 = 0;
if (DAT_1800924a0 != 0) {
FUN_180023408(puVar1,DAT_1800924a0,local_res8);
lVar2 = local_res8[0];
}
RtlReleaseResource(&DAT_180092428);
return lVar2;
}
=========================================
Function at address: 0x180018eb4
Called functions addresses: 0xEXTERNAL:00000089


undefined8 * FUN_180018eb4(undefined8 *param_1,uint param_2)

{
_FILETIME local_res8;

*(undefined4 *)((longlong)param_1 + 0x1c) = 1;
*param_1 = &PTR_FUN_18007c270;
param_1[1] = 0;
param_1[2] = 0;
*(undefined4 *)(param_1 + 3) = 0;
*(undefined4 *)(param_1 + 5) = 0;
GetSystemTimeAsFileTime(&local_res8);
param_1[4] = (longlong)local_res8 + (ulonglong)param_2;
return param_1;
}
=========================================
Function at address: 0x180018f20
Called functions addresses: 0x180018f58 0x18000909c


undefined8 * FUN_180018f20(undefined8 *param_1,uint param_2)

{
FUN_180018f58(param_1);
if ((param_2 & 1) != 0) {
FUN_18000909c(param_1);
}
return param_1;
}
=========================================
Function at address: 0x180018f58
Called functions addresses: 0x18000909c 0xEXTERNAL:0000011c


void FUN_180018f58(undefined8 *param_1)

{
ulonglong uVar1;
undefined *puVar2;

*param_1 = &PTR_FUN_18007c270;
if (param_1[1] != 0) {
SslFreeObject(param_1[1],0);
}
if ((undefined *)param_1[2] != (undefined *)0x0) {
puVar2 = (undefined *)param_1[2];
for (uVar1 = (ulonglong)*(uint *)(param_1 + 3); uVar1 != 0; uVar1 = uVar1 - 1) {
*puVar2 = 0;
puVar2 = puVar2 + 1;
}
FUN_18000909c((HLOCAL)param_1[2]);
}
*param_1 = &PTR_FUN_18007c298;
return;
}
=========================================
Function at address: 0x180018fc0
Called functions addresses: 0x180003c24 0x18002a7c0 0xEXTERNAL:000000c5 0xEXTERNAL:000000b3


undefined8 * FUN_180018fc0(undefined8 *param_1,ulonglong param_2)

{
*param_1 = &PTR_FUN_18007c330;
if (param_1[0x2b] != 0) {
NtClose();
}
*param_1 = &PTR_FUN_18007c2c0;
FUN_180003c24((longlong)param_1);
if (*(int *)((longlong)param_1 + 0x44) == 0) {
RtlDeleteResource(param_1 + 9);
}
*param_1 = &PTR_FUN_18007c298;
if ((param_2 & 1) != 0) {

}
return param_1;
}
=========================================
Function at address: 0x180019060
Called functions addresses: 0xEXTERNAL:00000040 0x180041cdc 0x180062db4 0x1800090d0 0x18000a1d0 0x180062884 0x180063404


ulonglong FUN_180019060(longlong *param_1,uint *param_2)

{
undefined2 uVar1;
int iVar2;
uint extraout_EAX;
ulonglong uVar3;
undefined *puVar4;
ulonglong uVar5;
uint uVar6;
int iVar7;
HLOCAL hMem;
int iVar8;
uint uVar9;
int iVar10;
char cVar11;
uint uVar12;
uint uVar13;
ushort local_res8 [4];
int local_res18 [2];
HLOCAL local_res20;

cVar11 = *(char *)((longlong)param_1 + 0xe9);
uVar5 = 0;
iVar8 = 0;
uVar12 = 0;
local_res18[0] = 0;
local_res20 = (HLOCAL)0x0;
local_res8[0] = 0;
if (cVar11 == '\0') {
uVar13 = 5;
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar5 = (ulonglong)*(uint *)((longlong)param_1 + 0x2c);
}
}
else {
uVar13 = 0xd;
}
if ((*(uint *)(param_1 + 0x11) >> 0x16 & 1) != 0) {
param_2 = (uint *)FUN_180062db4(param_1,(longlong *)&local_res20,(short *)local_res8);
uVar3 = (ulonglong)extraout_EAX;
if (extraout_EAX != 0) {
hMem = local_res20;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x35,&DAT_180082bd8,extraout_EAX);
hMem = local_res20;
}
goto LAB_180019185;
}
cVar11 = *(char *)((longlong)param_1 + 0xe9);
uVar12 = (uint)local_res8[0];
local_res18[0] = 0x12;
if (cVar11 == '\0') {
local_res18[0] = 10;
}
local_res18[0] = local_res18[0] + (uint)local_res8[0];
iVar8 = local_res18[0];
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar9 = local_res18[0] + *(int *)(param_1 + 6);
uVar6 = *(uint *)((longlong)param_1 + 0x34);
if (uVar6 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar6 = uVar6 - uVar9 % uVar6;
}
uVar9 = uVar9 + uVar6;
}
iVar8 = uVar9 + *(int *)((longlong)param_1 + 0x2c);
}
iVar8 = iVar8 + *(int *)((longlong)param_1 + 0x3c);
}
hMem = local_res20;
iVar10 = 1;
if ((*(ushort *)(param_1 + 4) & 4) != 0) {
uVar6 = *(uint *)((longlong)param_1 + 0x34);
uVar9 = *(int *)(param_1 + 6) + 1;
if (uVar6 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar6 = uVar6 - uVar9 % uVar6;
}
uVar9 = uVar9 + uVar6;
}
iVar10 = uVar9 + *(int *)((longlong)param_1 + 0x2c);
}
if ((*(byte *)(param_1 + 8) & 0x30) == 0) {
iVar7 = 0x18;
iVar2 = 0x10;
}
else {
iVar7 = 0x30;
iVar2 = 0x28;
}
if (cVar11 == '\0') {
iVar7 = iVar2;
}
if ((*(ushort *)(param_1 + 4) & 1) != 0) {
uVar9 = iVar7 + *(int *)(param_1 + 6);
uVar6 = *(uint *)((longlong)param_1 + 0x34);
if (uVar6 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar6 = uVar6 - uVar9 % uVar6;
}
uVar9 = uVar9 + uVar6;
}
iVar7 = uVar9 + *(int *)((longlong)param_1 + 0x2c);
}
puVar4 = *(undefined **)(param_2 + 2);
uVar6 = iVar10 + *(int *)((longlong)param_1 + 0x3c) * 2 + iVar7 + iVar8;
if (puVar4 == (undefined *)0x0) {
*param_2 = uVar6;
puVar4 = (undefined *)FUN_18000a1d0((longlong)param_1,uVar6);
*(undefined **)(param_2 + 2) = puVar4;
if (puVar4 == (undefined *)0x0) {
uVar3 = 0xe;
goto LAB_180019185;
}
}
else if (*param_2 < uVar6) {
param_2[1] = uVar6;
uVar3 = 0x80090321;
goto LAB_180019185;
}
param_2[1] = 0;
if ((*(uint *)(param_1 + 0x11) >> 0x16 & 1) != 0) {
FUN_180062884((longlong)param_1,hMem,uVar12,puVar4 + uVar5 + uVar13,local_res18);
iVar8 = local_res18[0];
uVar5 = FUN_180063404(param_1,puVar4 + uVar5 + uVar13,local_res18[0],param_2,0x3f3,0x3c4);
uVar3 = uVar5 & 0xffffffff;
if ((int)uVar5 != 0) goto LAB_180019185;
if (*(char *)((longlong)param_1 + 0xe9) != (char)uVar5) {
param_2[1] = param_2[1] + uVar13 + iVar8;
uVar1 = *(undefined2 *)((longlong)param_1 + 0x22);
puVar4[0xc] = (char)iVar8;
puVar4[0xb] = (char)((uint)iVar8 >> 8);
puVar4[1] = (char)((ushort)uVar1 >> 8);
puVar4[2] = (char)uVar1;
*puVar4 = 0x16;
}
}
uVar3 = FUN_1800090d0(param_1,param_2);
uVar3 = uVar3 & 0xffffffff;
LAB_180019185:
if (hMem != (HLOCAL)0x0) {
LocalFree(hMem);
}
return uVar3;
}
=========================================
Function at address: 0x1800191dc
Called functions addresses: None


void FUN_1800191dc(longlong param_1)

{
uint uVar1;
uint uVar2;
char acVar3 [8];

if (*(longlong *)(param_1 + 0x50) != 0) {
uVar1 = *(uint *)(*(longlong *)(param_1 + 0x50) + 0x98);
uVar2 = *(uint *)(param_1 + 0x40);
acVar3 = DAT_180082bc0;
if ((uVar1 >> 0xc & 1) == 0 || (uVar2 >> 10 & 1) == 0) {
if (*(char *)(param_1 + 0xe9) == '\0') {
uVar2 = uVar2 & 0x1400;
uVar1 = uVar1 & 0x1400;
}
else {
uVar2 = uVar2 >> 0x12 & 1;
uVar1 = uVar1 >> 0x12 & 1;
}
acVar3 = s_DOWNGRD_180082bb8;
if (uVar1 == 0 || uVar2 != 0) {
return;
}
}
*(char (*) [8])(param_1 + 0x148) = acVar3;
}
return;
}
=========================================
Function at address: 0x180019220
Called functions addresses: 0x18002a7c0


undefined8 FUN_180019220(longlong param_1,char param_2,char param_3,undefined2 *param_4)

{
int *piVar1;
longlong lVar2;
undefined8 uVar3;
uint uVar4;
int iVar5;

uVar4 = *(uint *)(param_1 + 0x14);
if (uVar4 == 0) {
lVar2 = *(longlong *)(param_1 + 8);
iVar5 = 0;
if (*(char *)(lVar2 + 0x39a) != '\0') {
iVar5 = 6;
*(undefined *)(param_1 + 0x19) = 1;
*(undefined4 *)(param_1 + 0x14) = 6;
}
if (param_2 != '\0') {
iVar5 = iVar5 + 4;
*(undefined *)(param_1 + 0x18) = 1;
*(int *)(param_1 + 0x14) = iVar5;
}
if ((*(uint *)(lVar2 + 0x88) >> 0x16 & 1) != 0) {
*(int *)(param_1 + 0x14) = iVar5 + 4;
}

if (((piVar1 != (int *)0x0) && (*piVar1 == 1)) && (piVar1[1] == 2)) {
*(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + *(byte *)(piVar1 + 2) + 7;
}
if ((*(uint *)(*(longlong *)(param_1 + 8) + 0x88) >> 0x1b & 1) != 0) {
*(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + 4;
}

if (lVar2 != 0) {
*(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + *(byte *)(lVar2 + 2) + 9;
}

if (lVar2 != 0) {
*(int *)(param_1 + 0x14) = *(int *)(param_1 + 0x14) + *(byte *)(lVar2 + 2) + 7;
}
lVar2 = *(longlong *)(param_1 + 8);
uVar4 = *(uint *)(param_1 + 0x14);
if (param_3 != '\0') {
*(undefined *)(param_1 + 0x1a) = 1;
*(uint *)(param_1 + 0x14) = uVar4 + 5;
iVar5 = *(int *)(lVar2 + 0x1a0) + uVar4 + 5;
*(int *)(param_1 + 0x14) = iVar5;
uVar4 = *(int *)(lVar2 + 0x1c8) + iVar5;
*(uint *)(param_1 + 0x14) = uVar4;
}
if ((*(uint *)(lVar2 + 0x88) >> 0x15 & 1) != 0) {
uVar4 = uVar4 + 4;
*(uint *)(param_1 + 0x14) = uVar4;
}
if (uVar4 != 0) {
uVar4 = uVar4 + 2;
*(uint *)(param_1 + 0x14) = uVar4;
}
}
if (uVar4 < 0x10000) {
*param_4 = *(undefined2 *)(param_1 + 0x14);
uVar3 = 0;
}
else {
uVar3 = 0x54f;
}
return uVar3;
}
=========================================
Function at address: 0x180019380
Called functions addresses: 0x180019550 0xEXTERNAL:000000c0 0x180062768 0x180041cb0 0x18002a7c0 0xEXTERNAL:000000bc 0x180019060 0x18001a970


ulonglong FUN_180019380(longlong *param_1,uint *param_2)

{
int iVar1;
longlong lVar2;
longlong lVar3;
uint uVar4;
undefined8 uVar5;
uint uVar6;
ulonglong uVar7;
ulonglong uVar8;

iVar1 = *(int *)((longlong)param_1 + 0x44);
uVar8 = 0;
if (iVar1 == 0x5e) {
uVar6 = FUN_180019550(param_1,param_2);
uVar8 = (ulonglong)uVar6;
if (uVar6 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x40;
}
}
else if (iVar1 == 0x5d) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x19,&DAT_180082bd8);
}
uVar6 = FUN_18001a970(param_1,param_2);
uVar8 = (ulonglong)uVar6;
if (uVar6 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x46;
}
}
else if (iVar1 == 4) {
if (DAT_1800927c0 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1b,&DAT_180082bd8);
}
uVar8 = FUN_180062768(param_1,param_2);
uVar8 = uVar8 & 0xffffffff;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1a,&DAT_180082bd8);
}
uVar8 = 0x80090326;
}
}
else if (iVar1 == 0x5f) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x18,&DAT_180082bd8);
}
uVar7 = FUN_180019060(param_1,param_2);
uVar8 = uVar7 & 0xffffffff;
if ((int)uVar7 == 0) {

uVar5 = DAT_1800927f0;
if ((((ulonglong)param_1[0x11] >> 0x16 & 1) == 0) &&
(((ulonglong)param_1[0x11] >> 0x1b & 1) != 0)) {
lVar2 = param_1[0xb];
if ((lVar2 != 0) && (lVar3 = param_1[10], lVar3 != 0)) {
RtlAcquireResourceExclusive(*(longlong *)(lVar2 + 0xe0) + 0x30,1);
RtlAcquireResourceExclusive(lVar2 + 0x48,1);
uVar6 = *(uint *)(lVar3 + 0xd0);
*(undefined *)(lVar2 + 0xec) = 1;
uVar4 = *(uint *)(lVar2 + 0x118);
if (uVar6 < *(uint *)(lVar2 + 0x118)) {
uVar4 = uVar6;
}
*(uint *)(lVar2 + 0x118) = uVar4;

RtlReleaseResource(lVar2 + 0x48);
RtlReleaseResource(*(longlong *)(lVar2 + 0xe0) + 0x30);
}
}
}
}
return uVar8;
}
=========================================
Function at address: 0x180019550
Called functions addresses: 0xEXTERNAL:000000f3 0xEXTERNAL:000000c2 0x18002a24f 0x1800090d0 0xEXTERNAL:0000011c 0x180028070 0x18002a7c0 0xEXTERNAL:000000c7 0xEXTERNAL:000000c0 0x180041cdc 0xEXTERNAL:0000016f 0x18000a1d0 0x180009470 0x18005b470 0x180019ee0


void FUN_180019550(longlong *param_1,uint *param_2)

{
char cVar1;
NTSTATUS NVar2;
int iVar3;
int iVar4;
int *piVar5;
longlong lVar6;
char acVar7 [8];
undefined8 uVar8;
ulonglong uVar9;
undefined *puVar10;
uint uVar11;
int iVar12;
undefined4 *puVar13;
undefined8 uVar14;
undefined2 uVar15;
uint uVar16;
undefined4 uVar17;
int iVar18;
uint uVar19;
ulonglong uVar20;
undefined auStack_118 [32];
undefined4 *local_f8;
undefined4 *local_f0;
uint local_d8;
uint local_d4;
uint local_d0 [2];
undefined **local_c8;
longlong *local_c0;
undefined4 local_b8;
uint uStack_b4;
undefined4 local_b0;
longlong *local_a8;
uint local_a0 [2];
undefined4 local_98;
undefined4 local_94;
undefined *local_90;
undefined local_88 [64];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStack_118;
iVar3 = 0;
if ((*(byte *)(param_1 + 4) & 4) == 0) {
local_d4 = 0;
}
else {
local_d4 = *(uint *)((longlong)param_1 + 0x2c);
}
local_d8 = 5;
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
local_d8 = 0xd;
}
cVar1 = *(char *)((longlong)param_1 + 0x229);
local_c8 = &PTR_FUN_18007c320;
uStack_b4 = 0;
local_b0 = 0;
if (*(char *)((longlong)param_1 + 0x39a) != '\0') {
iVar3 = 6;
local_b0 = 0x100;
uStack_b4 = 6;
}
if ((*(uint *)(param_1 + 0x11) >> 0x16 & 1) != 0) {
uStack_b4 = iVar3 + 4;
}
local_b8 = 0;
local_c0 = param_1;
local_a8 = param_1;

if (((piVar5 != (int *)0x0) && (*piVar5 == 1)) && (piVar5[1] == 2)) {
uStack_b4 = (uint)*(byte *)(piVar5 + 2) + uStack_b4 + 7;
}
if ((*(uint *)(local_c0 + 0x11) >> 0x1b & 1) != 0) {
uStack_b4 = uStack_b4 + 4;
}

if (lVar6 != 0) {
uStack_b4 = (uint)*(byte *)(lVar6 + 2) + uStack_b4 + 9;
}

if (lVar6 != 0) {
uStack_b4 = (uint)*(byte *)(lVar6 + 2) + uStack_b4 + 7;
}
if (cVar1 != '\0') {
local_b0._0_3_ = CONCAT12(1,(undefined2)local_b0);
uStack_b4 = uStack_b4 + *(int *)(local_c0 + 0x39) + 5 + *(int *)(local_c0 + 0x34);
}
if ((*(uint *)(local_c0 + 0x11) >> 0x15 & 1) != 0) {
uStack_b4 = uStack_b4 + 4;
}
if (uStack_b4 != 0) {
uStack_b4 = uStack_b4 + 2;
}
if (uStack_b4 < 0x10000) {
iVar3 = 4;
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
iVar3 = 0xc;
}
local_d0[0] = iVar3 + 0x46 + (uStack_b4 & 0xffff);
if ((*(ushort *)(param_1 + 4) & 4) == 0) {
iVar3 = *(int *)((longlong)param_1 + 0x3c);
iVar18 = 1;
uVar16 = local_d0[0];
}
else {
uVar19 = *(uint *)((longlong)param_1 + 0x34);
uVar16 = *(int *)(param_1 + 6) + local_d0[0];
if (uVar19 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar19 = uVar19 - uVar16 % uVar19;
}
uVar16 = uVar16 + uVar19;
}
uVar19 = *(uint *)((longlong)param_1 + 0x34);
uVar16 = *(int *)((longlong)param_1 + 0x2c) + uVar16;
iVar3 = *(int *)((longlong)param_1 + 0x3c);
uVar11 = *(int *)(param_1 + 6) + 1;
if (uVar19 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar19 = uVar19 - uVar11 % uVar19;
}
uVar11 = uVar11 + uVar19;
}
iVar18 = uVar11 + *(int *)((longlong)param_1 + 0x2c);
}
if ((*(byte *)(param_1 + 8) & 0x30) == 0) {
iVar12 = 0x18;
iVar4 = 0x10;
}
else {
iVar12 = 0x30;
iVar4 = 0x28;
}
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
iVar12 = iVar4;
}
if ((*(ushort *)(param_1 + 4) & 1) != 0) {
uVar11 = iVar12 + *(int *)(param_1 + 6);
uVar19 = *(uint *)((longlong)param_1 + 0x34);
if (uVar19 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar19 = uVar19 - uVar11 % uVar19;
}
uVar11 = uVar11 + uVar19;
}
iVar12 = uVar11 + *(int *)((longlong)param_1 + 0x2c);
}
puVar10 = *(undefined **)(param_2 + 2);
uVar16 = iVar18 + iVar3 * 3 + iVar12 + uVar16;
if (puVar10 == (undefined *)0x0) {
*param_2 = uVar16;
puVar10 = (undefined *)FUN_18000a1d0((longlong)param_1,uVar16);
*(undefined **)(param_2 + 2) = puVar10;
if (puVar10 == (undefined *)0x0) goto LAB_180019a36;
}
else if (*param_2 < uVar16) {
param_2[1] = uVar16;
goto LAB_180019a36;
}
param_2[1] = 0;
_time32((__time32_t *)local_a0);
lVar6 = 0x130;
if ((*(uint *)(param_1 + 8) & 0xa2aa0) != 0) {
lVar6 = 0x110;
}
*(uint *)((longlong)param_1 + lVar6) =
local_a0[0] >> 0x18 | (local_a0[0] & 0xff0000) >> 8 | (local_a0[0] & 0xff00) << 8 |
local_a0[0] << 0x18;
NVar2 = BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,(PUCHAR)((longlong)param_1 + lVar6 + 4),0x1c,2);
if ((NVar2 < 0) && (iVar3 = RtlNtStatusToDosError(NVar2), iVar3 != 0)) goto LAB_180019a36;
if (param_1[10] == 0) goto LAB_1800197ef;
uVar19 = *(uint *)(param_1[10] + 0x98);
uVar16 = *(uint *)(param_1 + 8);
acVar7 = DAT_180082bc0;
if ((uVar16 >> 10 & 1) == 0 || (uVar19 >> 0xc & 1) == 0) {
acVar7 = s_DOWNGRD_180082bb8;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
if ((uVar16 & 0x1400) == 0 && (uVar19 & 0x1400) != 0) goto LAB_1800197e8;
}
else if ((uVar16 >> 0x12 & 1) == 0 && (uVar19 >> 0x12 & 1) != 0) goto LAB_1800197e8;
}
else {
LAB_1800197e8:
*(char (*) [8])(param_1 + 0x29) = acVar7;
}
LAB_1800197ef:
RtlAcquireResourceShared(param_1[0x7c] + 0x48,1);
local_a0[0] = 0;
uVar8 = *(undefined8 *)(param_1[0x7c] + 0x10);
if (param_1[0x14] != 0) {
SslFreeObject(param_1[0x14],0);
param_1[0x14] = 0;
}
puVar13 = (undefined4 *)param_1[0x15];
if (puVar13 != (undefined4 *)0x0) {
SslFreeObject(puVar13,0);
puVar13 = (undefined4 *)0x0;
param_1[0x15] = 0;
}
if ((((*(byte *)(param_1 + 4) & 1) == 0) || (param_1[1] == 0)) ||
(*(int *)(param_1[1] + 0x1c) == 0)) {
LAB_1800198e7:
RtlReleaseResource(param_1[0x7c] + 0x48);

if (iVar3 != 0) goto LAB_180019a36;
*(undefined *)((longlong)param_1 + 0x154) = 0;

(param_1,param_1[0x6e],*(undefined4 *)(param_1 + 0x6d),0);
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
uVar19 = local_d4;
*(undefined4 *)(param_1 + 0x6d) = 0;
if (iVar3 != 0) {
FUN_18005b470(param_1,0x3ef,iVar3,0x50);
goto LAB_180019a36;
}
uVar9 = (ulonglong)local_d8;
uVar20 = (ulonglong)local_d4;
uVar8 = FUN_180019ee0((longlong)param_1,puVar10 + uVar20 + uVar9,local_d0,(longlong)&local_c8)
;
uVar16 = local_d0[0];
iVar3 = (int)uVar8;
if (iVar3 != 0) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180019a36;
uVar15 = 0x2d;
goto LAB_18002e7dc;
}

(param_1,puVar10 + uVar20 + uVar9,local_d0[0],1);
if (iVar3 == 0) {
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
uVar9 = FUN_180009470(param_1,param_2,0x16,uVar16);
iVar3 = (int)uVar9;
if (iVar3 != 0) {
uVar17 = 0x3ba;
goto LAB_18002e774;
}
if (*(char *)((longlong)param_1 + 0xe9) != (char)uVar9) goto LAB_18002e784;
}
else {
LAB_18002e784:
param_2[1] = param_2[1] + local_d8 + uVar19 + uVar16;
uVar15 = *(undefined2 *)((longlong)param_1 + 0x22);
puVar10[0xc] = (char)uVar16;
puVar10[0xb] = (char)(uVar16 >> 8);
puVar10[1] = (char)((ushort)uVar15 >> 8);
puVar10[2] = (char)uVar15;
*puVar10 = 0x16;
}
FUN_1800090d0(param_1,param_2);
}
else {
uVar17 = 0x3ee;
LAB_18002e774:
FUN_18005b470(param_1,uVar17,iVar3,0x50);
}
goto LAB_180019a36;
}
local_90 = local_88;
local_98 = SUB84(puVar13,0);
local_94 = 4;
local_f8 = puVar13;
local_f0 = puVar13;

if (iVar3 == 0) {
if ((undefined8 *)param_1[1] == (undefined8 *)0x0) {
uVar14 = 0;
}
else {
uVar14 = *(undefined8 *)param_1[1];
}
local_f8 = &local_98;
local_f0 = (undefined4 *)((ulonglong)local_f0 & 0xffffffff00000000);
iVar3 = SslGenerateSessionKeys(uVar14,uVar8,param_1 + 0x14,param_1 + 0x15);
if (iVar3 == 0) goto LAB_1800198e7;
uVar17 = 600;
}
else {
uVar17 = 0x259;
}
FUN_18005b470(param_1,uVar17,iVar3,0x33);
RtlReleaseResource(param_1[0x7c] + 0x48);
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180019a36;
uVar15 = 0x2c;
}
else {
iVar3 = 0x54f;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180019a36;
uVar15 = 0x2b;
}
LAB_18002e7dc:
FUN_180041cdc(DAT_180091000[2],uVar15,&DAT_180082bd8,iVar3);
LAB_180019a36:
FUN_180028070(local_48 ^ (ulonglong)auStack_118);
return;
}
=========================================
Function at address: 0x180019b10
Called functions addresses: 0x18002a7c0 0x18002a77b


ulonglong FUN_180019b10(longlong *param_1,byte *param_2,uint param_3,void *param_4,uint *param_5,
longlong *param_6,uint *param_7)

{
byte bVar1;
byte bVar2;
byte bVar3;
longlong lVar4;
bool bVar5;
uint uVar6;
uint *_Src;
uint uVar7;
undefined2 uVar8;
byte *pbVar9;
uint uVar10;
ushort uVar11;
ulonglong uVar12;
int iVar13;
byte *pbVar14;
uint *puVar15;
undefined8 *puVar16;
char cVar17;
undefined uVar18;
uint uVar19;
undefined **local_60;
longlong *local_58;
undefined4 local_50;
undefined4 local_4c;
undefined2 local_48;
undefined local_46;
undefined local_45;
longlong *local_40;

bVar5 = false;
*(undefined *)((longlong)param_1 + 0x22a) = 0;
cVar17 = DAT_1800927ac;
if (1 < param_3) {
uVar7 = (uint)*param_2 * 0x100 + (uint)param_2[1];
if (uVar7 < 0x300) {
FUN_18005b470(param_1,0x4b1,0x80090308,0x46);
}
else {
*(uint *)((longlong)param_1 + 0x24) = uVar7;
if ((param_1[0xf] != 0) && (cVar17 != '\0')) {
*(uint *)(param_1[0xf] + 0x2c) = uVar7;
}
if (0x1f < param_3 - 2) {
lVar4 = *(longlong *)(param_2 + 10);
param_1[0x22] = *(longlong *)(param_2 + 2);
param_1[0x23] = lVar4;
lVar4 = *(longlong *)(param_2 + 0x1a);
param_1[0x24] = *(longlong *)(param_2 + 0x12);
param_1[0x25] = lVar4;
if (param_3 != 0x22) {
bVar1 = param_2[0x22];
if (bVar1 < 0x21) {
if ((uint)bVar1 <= param_3 - 0x23) {
if (bVar1 != 0) {
memcpy(param_4,param_2 + 0x23,(ulonglong)(uint)bVar1);
}
pbVar9 = param_2 + 0x23 + bVar1;
uVar7 = (param_3 - 0x23) - (uint)bVar1;
*param_5 = (uint)bVar1;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
LAB_180019bfa:
if (((1 < uVar7) &&
(uVar19 = (uint)*pbVar9 * 0x100 + (uint)pbVar9[1], (uVar19 & 1) == 0)) &&
(uVar19 <= uVar7 - 2)) {
uVar10 = uVar19 >> 1;
if (*param_7 < uVar10) {
_Src = (uint *)FUN_18000a1d0((longlong)param_1,uVar10 << 2);
cVar17 = DAT_1800927ac;
if (_Src == (uint *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x36,&DAT_180082bd8,uVar10 * 4);
uVar10 = 0;
uVar12 = 0x80090308;
goto LAB_180019ea5;
}
goto LAB_18002e80c;
}
}
else {
_Src = (uint *)*param_6;
}
uVar6 = 0;
puVar15 = _Src;
if (uVar19 >> 1 != 0) {
do {
bVar1 = pbVar9[(ulonglong)(uVar6 * 2) + 2];
bVar2 = pbVar9[(ulonglong)(uVar6 * 2 + 1) + 2];
*puVar15 = (uint)CONCAT11(bVar1,bVar2);
if (CONCAT11(bVar1,bVar2) == 0xff) {
if (*(int *)(param_1 + 0x34) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x37,&DAT_180082bd8);
}
FUN_18005b470(param_1,0x4b7,0x80090346,0x28);
*(undefined4 *)((longlong)param_1 + 0x44) = 0x60;
uVar12 = 0x80090346;
*(undefined2 *)(param_1 + 0xc) = 0x2802;
goto LAB_18002e9ee;
}
*(undefined *)((longlong)param_1 + 0x229) = 1;
bVar5 = true;
}
uVar6 = uVar6 + 1;
puVar15 = puVar15 + 1;
} while (uVar6 < uVar10);
}
lVar4 = param_1[0xf];
if ((lVar4 != 0) && (cVar17 != '\0')) {
*(uint *)(lVar4 + 0x62c) = uVar10;
uVar6 = uVar10;
if (100 < uVar10) {
uVar6 = 100;
}
memcpy((void *)(lVar4 + 0x498),_Src,(ulonglong)uVar6 << 2);
*(short *)(lVar4 + 0x628) = (short)uVar6;
}
uVar6 = 0;
iVar13 = (uVar7 - 2) - uVar19;
pbVar9 = pbVar9 + (ulonglong)uVar19 + 2;
if (iVar13 == 0) {
uVar12 = 0x80090308;
}
else {
bVar1 = *pbVar9;
uVar12 = (ulonglong)bVar1;
if (bVar1 == 0) {
uVar12 = 0x80090308;
}
else {
uVar7 = iVar13 - 1;
pbVar14 = pbVar9;
if (bVar1 <= uVar7) {
while( true ) {
if (pbVar14[1] == 0) break;
uVar6 = uVar6 + 1;
pbVar14 = pbVar14 + 1;
if (bVar1 <= uVar6) {
uVar12 = FUN_180019ecb(uVar12,(longlong)pbVar9);
return uVar12;
}
}
uVar7 = uVar7 - bVar1;
if (1 < uVar7) {
bVar1 = pbVar9[uVar12 + 1];
local_60 = &PTR_FUN_18007c320;
bVar2 = pbVar9[uVar12 + 2];
uVar19 = (uint)CONCAT11(bVar1,bVar2);
local_4c = 0;
local_48 = 0;
local_46 = 0;
local_58 = param_1;
local_40 = param_1;
if (uVar19 <= uVar7 - 2) {
bVar3 = *(byte *)(param_1 + 8);
uVar18 = 0;
local_50 = 1;
pbVar9 = pbVar9 + uVar12 + 3;
*(undefined *)((longlong)param_1 + 0x39a) = 0;
local_45 = 0;
puVar16 = DAT_180091000;
if (CONCAT11(bVar1,bVar2) != 0) {
do {
if (uVar19 < 4) {
LAB_18002ea46:
uVar12 = 0x80090326;
LAB_18002ea4b:
FUN_18005b470(param_1,0x4b2,0x80090308,10);
LAB_18002e9d6:
if ((int)uVar12 != 0) goto LAB_18002e9ee;
goto LAB_180019e84;
}
uVar11 = CONCAT11(pbVar9[2],pbVar9[3]);
uVar7 = (uint)CONCAT11(*pbVar9,pbVar9[1]);
if (((undefined8 **)puVar16 != &DAT_180091000) &&
((*(byte *)((longlong)puVar16 + 0x1c) & 4) != 0)) {
FUN_180041cdc(puVar16[2],0x49,&DAT_180082c68,uVar7);
puVar16 = DAT_180091000;
}
pbVar14 = pbVar9 + 4;
if (uVar19 - 4 < (uint)uVar11) {
if (((undefined8 **)puVar16 != &DAT_180091000) &&
((*(byte *)((longlong)puVar16 + 0x1c) & 2) != 0)) {
FUN_180041cb0(puVar16[2],0x4a,&DAT_180082c68);
}
goto LAB_18002ea46;
}
pbVar9 = pbVar14 + uVar11;
uVar19 = (uVar19 - 4) - (uint)uVar11;
if (((bVar3 & 0x30) == 0) || (uVar7 == 0xff01)) {

(&local_60,uVar7,pbVar14,uVar11);
uVar12 = (ulonglong)uVar6;
if (uVar6 == 0) {
puVar16 = DAT_180091000;
if (uVar7 == 0xff01) {
uVar18 = 1;
}
goto LAB_180019e4b;
}
if ((uVar6 != 0x80090346) && (uVar6 != 0x80090367))
goto LAB_18002ea4b;
goto LAB_18002e9d6;
}
LAB_180019e4b:
} while (uVar19 != 0);
}

}
}
uVar12 = 0;
LAB_180019e84:
if ((*(char *)((longlong)param_1 + 0x22a) == '\0') && (!bVar5)) {
if (DAT_1800919ac == 0) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0))
goto LAB_18002ead3;
uVar8 = 0x38;
}
else {
if (*(char *)((longlong)param_1 + 0x229) == '\0') goto LAB_180019e92;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0))
goto LAB_18002ead3;
uVar8 = 0x39;
}
FUN_180041cb0(DAT_180091000[2],uVar8,&DAT_180082bd8);
LAB_18002ead3:
FUN_18005b470(param_1,0x4b7,0x80090346,0x28);
*(undefined4 *)((longlong)param_1 + 0x44) = 0x60;
*(undefined2 *)(param_1 + 0xc) = 0x2802;
return 0x80090346;
}
LAB_180019e92:
*param_6 = (longlong)_Src;
goto LAB_180019ea5;
}
uVar12 = 0x80090308;
}
}
LAB_18002e9ee:
uVar10 = 0;
if ((_Src != (uint *)0x0) && (_Src != (uint *)*param_6)) {

uVar10 = 0;
}
goto LAB_180019ea5;
}
}
else if (uVar7 != 0) {
bVar1 = *pbVar9;
if ((bVar1 < 0x21) && ((uint)bVar1 <= uVar7 - 1)) {
pbVar9 = pbVar9 + (ulonglong)bVar1 + 1;
uVar7 = (uVar7 - 1) - (uint)bVar1;
goto LAB_180019bfa;
}
}
}
}
}
}
}
}
LAB_18002e80c:
uVar12 = 0x80090308;
uVar10 = 0;
LAB_180019ea5:
*param_7 = uVar10;
return uVar12;
}
=========================================
Function at address: 0x180019ecb
Called functions addresses: 0x180041cdc 0x18002e97b 0x180041cb0 0x18005b470


ulonglong FUN_180019ecb(longlong param_1,longlong param_2)

{
byte bVar1;
longlong lVar2;
uint uVar3;
ulonglong uVar4;
undefined2 uVar5;
uint uVar6;
undefined4 unaff_EBP;
ushort uVar7;
uint uVar8;
int unaff_EDI;
undefined *puVar9;
undefined *puVar10;
undefined in_R8B;
undefined in_R9B;
uint in_R10D;
undefined8 *puVar11;
undefined uVar12;
bool in_ZF;
undefined in_stack_00000028;
undefined in_stack_00000030;
undefined7 in_stack_00000031;
undefined in_stack_00000038;
undefined in_stack_00000040;
undefined in_stack_00000048;
undefined in_stack_00000050;
longlong *in_stack_000000a0;
char in_stack_000000b0;
longlong *in_stack_000000c8;
undefined4 *in_stack_000000d0;

if (in_ZF) {
uVar4 = FUN_18002e97b((char)param_1,(char)param_2,in_R8B,in_R9B,in_stack_00000028,
in_stack_00000030,in_stack_00000038,in_stack_00000040,in_stack_00000048,
in_stack_00000050,in_stack_000000a0);
return uVar4;
}
uVar8 = unaff_EDI - (int)param_1;
if (1 < uVar8) {
uVar7 = CONCAT11(*(undefined *)(param_2 + 1 + param_1),*(undefined *)(param_2 + 2 + param_1));
uVar6 = (uint)uVar7;
if (uVar6 <= uVar8 - 2) {
bVar1 = *(byte *)(in_stack_000000a0 + 8);
uVar12 = 0;
puVar9 = (undefined *)(param_1 + 3 + param_2);
*(undefined *)((longlong)in_stack_000000a0 + 0x39a) = 0;
puVar11 = DAT_180091000;
if (uVar7 != 0) {
do {
if (uVar6 < 4) {
LAB_18002ea46:
uVar4 = 0x80090326;
LAB_18002ea4b:
FUN_18005b470(in_stack_000000a0,0x4b2,0x80090308,10);
LAB_18002e9d6:
if ((int)uVar4 == 0) goto LAB_180019e84;
unaff_EBP = 0;
lVar2 = CONCAT71(in_stack_00000031,in_stack_00000030);
if ((lVar2 != 0) && (lVar2 != *in_stack_000000c8)) {

unaff_EBP = 0;
}
goto LAB_180019ea5;
}
uVar7 = CONCAT11(puVar9[2],puVar9[3]);
uVar8 = (uint)CONCAT11(*puVar9,puVar9[1]);
if (((undefined8 **)puVar11 != &DAT_180091000) &&
((*(byte *)((longlong)puVar11 + 0x1c) & 4) != 0)) {
FUN_180041cdc(puVar11[2],0x49,&DAT_180082c68,uVar8);
puVar11 = DAT_180091000;
}
puVar10 = puVar9 + 4;
if (uVar6 - 4 < (uint)uVar7) {
if (((undefined8 **)puVar11 != &DAT_180091000) &&
((*(byte *)((longlong)puVar11 + 0x1c) & 2) != 0)) {
FUN_180041cb0(puVar11[2],0x4a,&DAT_180082c68);
}
goto LAB_18002ea46;
}
puVar9 = puVar10 + uVar7;
uVar6 = (uVar6 - 4) - (uint)uVar7;
if (((bVar1 & 0x30) == 0) || (uVar8 == 0xff01)) {

(&stack0x00000038,uVar8,puVar10,uVar7);
uVar4 = (ulonglong)uVar3;
if (uVar3 == 0) {
puVar11 = DAT_180091000;
if (uVar8 == 0xff01) {
uVar12 = 1;
}
goto LAB_180019e4b;
}
if ((uVar3 != 0x80090346) && (uVar3 != 0x80090367)) goto LAB_18002ea4b;
goto LAB_18002e9d6;
}
LAB_180019e4b:
} while (uVar6 != 0);
}

in_R10D = 0;
}
}
uVar4 = (ulonglong)in_R10D;
LAB_180019e84:
if ((*(char *)((longlong)in_stack_000000a0 + 0x22a) == '\0') && (in_stack_000000b0 == '\0')) {
if (DAT_1800919ac == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar5 = 0x38;
LAB_18002eac3:
FUN_180041cb0(DAT_180091000[2],uVar5,&DAT_180082bd8);
}
}
else {
if (*(char *)((longlong)in_stack_000000a0 + 0x229) == '\0') goto LAB_180019e92;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar5 = 0x39;
goto LAB_18002eac3;
}
}
FUN_18005b470(in_stack_000000a0,0x4b7,0x80090346,0x28);
uVar4 = 0x80090346;
*(undefined4 *)((longlong)in_stack_000000a0 + 0x44) = 0x60;
*(undefined2 *)(in_stack_000000a0 + 0xc) = 0x2802;
}
else {
LAB_180019e92:
*in_stack_000000c8 = CONCAT71(in_stack_00000031,in_stack_00000030);
LAB_180019ea5:
*in_stack_000000d0 = unaff_EBP;
}
return uVar4;
}
=========================================
Function at address: 0x180019ee0
Called functions addresses: 0x180041cdc 0x18001a100 0x18002a7c0 0x18002a77b


undefined8 FUN_180019ee0(longlong param_1,undefined *param_2,uint *param_3,longlong param_4)

{
char cVar1;
ushort uVar2;
short sVar3;
undefined uVar4;
int iVar5;
uint uVar6;
undefined8 uVar7;
int *piVar8;
longlong lVar9;
undefined uVar10;
undefined *puVar11;
uint uVar12;
uint uVar13;
undefined2 uVar14;
uint local_res10 [2];
int local_38;

if ((param_2 == (undefined *)0x0) || (param_3 == (uint *)0x0)) {
return 0x57;
}
uVar6 = 0;
if (param_4 != 0) {
uVar6 = *(uint *)(param_4 + 0x14);
if (uVar6 == 0) {
iVar5 = 0;
if (*(char *)(*(longlong *)(param_4 + 8) + 0x39a) != '\0') {
iVar5 = 6;
*(undefined *)(param_4 + 0x19) = 1;
*(undefined4 *)(param_4 + 0x14) = 6;
}
if ((*(uint *)(*(longlong *)(param_4 + 8) + 0x88) >> 0x16 & 1) != 0) {
*(int *)(param_4 + 0x14) = iVar5 + 4;
}

if (((piVar8 != (int *)0x0) && (*piVar8 == 1)) && (piVar8[1] == 2)) {
*(int *)(param_4 + 0x14) = *(int *)(param_4 + 0x14) + *(byte *)(piVar8 + 2) + 7;
}
if ((*(uint *)(*(longlong *)(param_4 + 8) + 0x88) >> 0x1b & 1) != 0) {
*(int *)(param_4 + 0x14) = *(int *)(param_4 + 0x14) + 4;
}

if (lVar9 != 0) {
*(int *)(param_4 + 0x14) = *(int *)(param_4 + 0x14) + *(byte *)(lVar9 + 2) + 9;
}

if (lVar9 != 0) {
*(int *)(param_4 + 0x14) = *(int *)(param_4 + 0x14) + *(byte *)(lVar9 + 2) + 7;
}
uVar6 = *(uint *)(param_4 + 0x14);
if ((*(uint *)(*(longlong *)(param_4 + 8) + 0x88) >> 0x15 & 1) != 0) {
uVar6 = uVar6 + 4;
*(uint *)(param_4 + 0x14) = uVar6;
}
if (uVar6 != 0) {
uVar6 = uVar6 + 2;
*(uint *)(param_4 + 0x14) = uVar6;
}
}
if (0xffff < uVar6) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x32,&DAT_180082bd8,0x54f);
}
return 0x54f;
}
}
cVar1 = *(char *)(param_1 + 0xe9);
uVar13 = 4;
iVar5 = 4;
local_38 = 4;
if (cVar1 != '\0') {
iVar5 = 0xc;
}
uVar6 = iVar5 + 0x46 + (uVar6 & 0xffff);
if (*param_3 < uVar6) {
*param_3 = uVar6;
return 0xea;
}
if (cVar1 != '\0') {
uVar13 = 0xc;
local_38 = 0xc;
}
puVar11 = param_2 + uVar13;
uVar12 = *(uint *)(param_1 + 0x40);
if ((uVar12 & 0xf0000) == 0 || (uVar12 & 0x3ffc) == 0) {
if ((uVar12 & 0xc0000) != 0) {
uVar4 = 0xfd;
uVar10 = 0xfe;
goto LAB_180019fda;
}
if ((uVar12 & 0x30000) != 0) {
uVar4 = 0xff;
uVar10 = 0xfe;
goto LAB_180019fda;
}
if ((uVar12 & 0x3000) == 0) {
if ((uVar12 & 0xc00) != 0) {
uVar4 = 3;
uVar10 = 3;
goto LAB_180019fda;
}
if ((uVar12 & 0x300) == 0) {
if ((uVar12 & 0xc0) != 0) goto LAB_18002ecb1;
if ((uVar12 & 0x30) == 0) {
if ((uVar12 & 0xc) != 0) {
uVar4 = 2;
uVar10 = 0;
goto LAB_180019fda;
}
goto LAB_18002eca3;
}
uVar4 = 0;
}
else {
uVar4 = 2;
}
}
else {
uVar4 = 4;
}
}
else {
LAB_18002eca3:
if (cVar1 != '\0') {
uVar4 = 0xff;
uVar10 = 0xfe;
goto LAB_180019fda;
}
LAB_18002ecb1:
uVar4 = 1;
}
uVar10 = 3;
LAB_180019fda:
*puVar11 = uVar10;
uVar12 = (uVar6 - uVar13) - 0x23;
puVar11[1] = uVar4;
uVar7 = *(undefined8 *)(param_1 + 0x138);
*(undefined8 *)(puVar11 + 2) = *(undefined8 *)(param_1 + 0x130);
*(undefined8 *)(puVar11 + 10) = uVar7;
uVar7 = *(undefined8 *)(param_1 + 0x148);
*(undefined8 *)(puVar11 + 0x12) = *(undefined8 *)(param_1 + 0x140);
*(undefined8 *)(puVar11 + 0x1a) = uVar7;
uVar2 = *(ushort *)(*(longlong *)(param_1 + 0x3e0) + 0xee);
uVar13 = uVar12;
if (uVar2 <= uVar12) {
uVar13 = (uint)uVar2;
memcpy(puVar11 + 0x23,(void *)(*(longlong *)(param_1 + 0x3e0) + 0xf0),(ulonglong)(uint)uVar2);
}
puVar11[0x22] = (char)uVar13;
puVar11 = puVar11 + 0x23 + uVar13;
uVar14 = 0;
if (((*(byte *)(param_1 + 0x20) & 1) != 0) && (uVar14 = 0, *(longlong *)(param_1 + 8) != 0)) {
uVar14 = (undefined2)*(undefined4 *)(*(longlong *)(param_1 + 8) + 0x1c);
}
uVar13 = (uVar12 - uVar13) - 3;
*puVar11 = (char)((ushort)uVar14 >> 8);
puVar11[1] = (char)uVar14;
puVar11[2] = 0;
local_res10[0] = uVar13;
if (((param_4 == 0) || (uVar13 == 0)) ||
(uVar7 = FUN_18001a100(param_4,uVar13,puVar11 + 3,local_res10), (int)uVar7 == 0)) {
sVar3 = *(short *)(param_1 + 0xdc);
uVar6 = uVar6 + (local_res10[0] - uVar13);
*param_3 = uVar6;
local_38 = uVar6 - local_38;
*(short *)(param_1 + 0xdc) = sVar3 + 1;
cVar1 = *(char *)(param_1 + 0xe9);
*param_2 = 2;
uVar4 = (undefined)((uint)local_38 >> 8);
uVar10 = (undefined)((uint)local_38 >> 0x10);
if (cVar1 != '\0') {
param_2[5] = (char)sVar3;
param_2[9] = uVar10;
param_2[4] = (char)((ushort)sVar3 >> 8);
*(undefined2 *)(param_2 + 7) = 0;
param_2[6] = 0;
param_2[0xb] = (char)local_38;
param_2[10] = uVar4;
}
param_2[1] = uVar10;
uVar7 = 0;
param_2[3] = (char)local_38;
param_2[2] = uVar4;
}
return uVar7;
}
=========================================
Function at address: 0x18001a100
Called functions addresses: 0x180041cdc 0x180003e7c 0x180041cb0 0x180015e38 0x18000ad34 0x180041d20 0x18002a7c0 0x18002a77b


undefined8 FUN_18001a100(longlong param_1,uint param_2,undefined *param_3,uint *param_4)

{
short sVar1;
uint *puVar2;
byte bVar3;
uint uVar4;
uint uVar5;
void *_Src;
int *piVar6;
ushort *puVar7;
undefined *puVar8;
undefined8 uVar9;
longlong lVar10;
ushort uVar11;
undefined4 *puVar12;
undefined4 *puVar13;
char cVar14;
ulonglong _Size;
undefined4 *local_res18;

if ((param_3 == (undefined *)0x0) || (param_4 == (uint *)0x0)) {
return 0x57;
}
uVar4 = *(uint *)(param_1 + 0x14);
*param_4 = uVar4;
if (uVar4 == 0) {
return 0;
}
if (param_2 < uVar4) {
LAB_18002efc1:
uVar9 = 0xea;
}
else {
puVar13 = (undefined4 *)(param_3 + 2);
*param_3 = (char)(uVar4 - 2 >> 8);
param_3[1] = *(char *)(param_1 + 0x14) + -2;
local_res18 = puVar13;
if (*(char *)(param_1 + 0x18) != '\0') {
*(undefined2 *)puVar13 = 0x500;
puVar13 = (undefined4 *)(param_3 + 6);
local_res18 = puVar13;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,5);
}
puVar12 = puVar13;
if (*(char *)(param_1 + 0x19) != '\0') {
*(undefined *)puVar13 = 0;
puVar12 = (undefined4 *)((longlong)puVar13 + 6);
*(undefined4 *)((longlong)puVar13 + 1) = 0x1020006;
*(undefined *)((longlong)puVar13 + 5) = 0x40;
local_res18 = puVar12;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,6);
}
puVar13 = puVar12;
if ((*(uint *)(*(longlong *)(param_1 + 8) + 0x88) >> 0x16 & 1) != 0) {
*(undefined *)puVar12 = 0;
puVar13 = puVar12 + 1;
*(undefined *)((longlong)puVar12 + 1) = 0x23;
local_res18 = puVar13;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x11,&DAT_180082c68);
}
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0x23);
}

cVar14 = DAT_1800927ac;
if (((piVar6 != (int *)0x0) && (*piVar6 == 1)) && (piVar6[1] == 2)) {
bVar3 = *(byte *)(piVar6 + 2);
*(undefined2 *)puVar13 = 0x1000;
uVar11 = bVar3 + 1;
sVar1 = bVar3 + 3;
*(char *)((longlong)puVar13 + 2) = (char)((ushort)sVar1 >> 8);
*(char *)((longlong)puVar13 + 3) = (char)sVar1;
*(char *)(puVar13 + 1) = (char)(uVar11 >> 8);
*(char *)((longlong)puVar13 + 5) = (char)uVar11;
*(undefined *)((longlong)puVar13 + 6) = *(undefined *)(piVar6 + 2);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x12,&DAT_180082c68,(uint)uVar11);
}
memcpy((undefined *)((longlong)puVar13 + 7),(void *)((longlong)piVar6 + 9),
(ulonglong)*(byte *)(piVar6 + 2));
cVar14 = DAT_1800927ac;
puVar13 = (undefined4 *)((undefined *)((longlong)puVar13 + 7) + *(byte *)(piVar6 + 2));
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
local_res18 = puVar13;
if ((lVar10 != 0) && (DAT_1800927ac != '\0')) {
puVar2 = (uint *)(lVar10 + 0x44);
*puVar2 = *puVar2 | 0x800;
}
}
if ((*(uint *)(*(longlong *)(param_1 + 8) + 0x88) >> 0x1b & 1) != 0) {
*(undefined2 *)puVar13 = 0x1700;
puVar13 = puVar13 + 1;
local_res18 = puVar13;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180082c68);
cVar14 = DAT_1800927ac;
}
lVar10 = *(longlong *)(param_1 + 8);
if ((*(longlong *)(lVar10 + 0x78) != 0) && (cVar14 != '\0')) {
puVar7 = (ushort *)(*(longlong *)(lVar10 + 0x78) + 0x42);
*puVar7 = *puVar7 | 2;
lVar10 = *(longlong *)(param_1 + 8);
}
if ((*(longlong *)(lVar10 + 0x78) != 0) && (cVar14 != '\0')) {
puVar2 = (uint *)(*(longlong *)(lVar10 + 0x78) + 0x44);
*puVar2 = *puVar2 | 0x1000;
}
}

if (puVar7 != (ushort *)0x0) {
bVar3 = *(byte *)(puVar7 + 1);
uVar11 = *puVar7;
_Src = *(void **)(puVar7 + 4);
*(undefined2 *)puVar13 = 0xe00;
*(char *)((longlong)puVar13 + 2) = (char)(bVar3 + 5 >> 8);
*(char *)((longlong)puVar13 + 3) = (char)(bVar3 + 5);
*(undefined2 *)(puVar13 + 1) = 0x200;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],0x14,&DAT_180082c68,(uint)uVar11,bVar3);
}
*(char *)((longlong)puVar13 + 6) = (char)uVar11;
*(char *)((longlong)puVar13 + 7) = (char)(uVar11 >> 8);
*(byte *)(puVar13 + 2) = bVar3;
if (_Src != (void *)0x0) {
memcpy((undefined *)((longlong)puVar13 + 9),_Src,(ulonglong)bVar3);
}
puVar13 = (undefined4 *)((undefined *)((longlong)puVar13 + 9) + bVar3);
local_res18 = puVar13;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0xe);
}

if (puVar8 != (undefined *)0x0) {
lVar10 = *(longlong *)(param_1 + 0x20);
if (((*(uint *)(lVar10 + 0x40) & 0x1000) == 0) &&
((*(char *)(param_1 + 0x1a) == '\0' ||
(lVar10 = *(longlong *)(param_1 + 8), (*(uint *)(lVar10 + 0x88) >> 0x1b & 1) == 0)))) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180082c68);
}
FUN_180003e7c(*(longlong **)(param_1 + 8));
}
else {
uVar9 = FUN_180015e38(lVar10,*puVar8,puVar8[1],*(void **)(puVar8 + 8),puVar8[2],
(ulonglong)(param_3 + param_2),(longlong *)&local_res18);
if ((int)uVar9 != 0) {
return uVar9;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],(short)uVar9 + 0x16,&DAT_180082c68,
(uint)*(ushort *)(puVar8 + 2));
}
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0x18);
puVar13 = local_res18;
}
}
if (*(char *)(param_1 + 0x1a) != '\0') {
lVar10 = *(longlong *)(param_1 + 8);
uVar4 = *(uint *)(lVar10 + 0x1a0);
uVar5 = *(uint *)(lVar10 + 0x1c8);
_Size = (ulonglong)uVar5;
if (uVar4 != uVar5) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041d20(DAT_180091000[2],0x17,&DAT_180082c68,uVar4,(char)uVar5);
}
return 0x54f;
}
if (param_3 + param_2 < (undefined *)((ulonglong)uVar4 + 5 + _Size + (longlong)puVar13)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x18,&DAT_180082c68);
}
goto LAB_18002efc1;
}
*(undefined2 *)puVar13 = 0x1ff;
cVar14 = (char)uVar4 + (char)uVar5;
*(char *)((longlong)puVar13 + 2) = (char)(uVar4 + 1 + uVar5 >> 8);
*(char *)((longlong)puVar13 + 3) = cVar14 + '\x01';
*(char *)(puVar13 + 1) = cVar14;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x19,&DAT_180082c68);
}
memcpy((undefined *)((longlong)puVar13 + 5),(void *)(lVar10 + 0x179),(ulonglong)uVar4);
puVar8 = (undefined *)((longlong)puVar13 + 5) + uVar4;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1a,&DAT_180082c68);
}
memcpy(puVar8,(void *)(lVar10 + 0x1a4),_Size);
puVar13 = (undefined4 *)(puVar8 + _Size);
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
if ((lVar10 != 0) && (DAT_1800927ac != '\0')) {
puVar2 = (uint *)(lVar10 + 0x44);
*puVar2 = *puVar2 | 0x10000;
}
}
if ((*(uint *)(*(longlong *)(param_1 + 8) + 0x88) >> 0x15 & 1) != 0) {
*puVar13 = 0;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0);
}
uVar9 = 0;
}
return uVar9;
}
=========================================
Function at address: 0x18001a450
Called functions addresses: 0x18005b660 0xEXTERNAL:00000116 0x18002a700 0x18000a418 0x180004510 0x18005b470 0x180028070 0x18002a7c0 0x18002a77b 0x18000a230


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_18001a450(longlong *param_1,PUCHAR param_2,ULONG param_3,void *param_4,int param_5,
int param_6,undefined8 param_7,undefined4 *param_8)

{
longlong lVar1;
ULONG UVar2;
longlong *plVar3;
PUCHAR pUVar4;
BCRYPT_HANDLE pvVar5;
int iVar6;
longlong lVar7;
undefined8 uVar8;
ulonglong uVar9;
undefined4 *puVar10;
ulonglong uVar11;
undefined4 uVar12;
undefined *puVar13;
undefined *puVar14;
PUCHAR _Dst;
uint uVar15;
PUCHAR pUVar16;
uint uVar17;
uint uVar18;
uint uVar19;
undefined auStack_c8 [40];
undefined8 uStack_a0;
undefined local_98 [16];
undefined4 local_88;
UCHAR aUStack_80 [40];
uint local_58;
ULONG UStack_54;
longlong *local_50 [2];
PUCHAR local_40;
BCRYPT_HANDLE local_38;
ulonglong local_30;

local_30 = DAT_180091970 ^ (ulonglong)&local_58;
pUVar16 = (PUCHAR)0x0;
uVar19 = 0;
uVar17 = 0;
puVar14 = local_98;
UStack_54 = param_3;
local_50[0] = param_1;
local_40 = param_2;
if (param_1[3] == 0) goto LAB_18001a65a;
if (param_5 == 0) {
uVar15 = 0x24;
puVar14 = local_98;
if ((DAT_1800920e0 < 0x24) || (puVar14 = local_98, DAT_1800920e8 + 0x2cU < 0x24)) {
LAB_18002f07b:
*(undefined8 *)(puVar14 + -8) = 0x18002f097;

if (puVar10 == (undefined4 *)0x0) goto LAB_18001a65a;
*puVar10 = 0x70616548;
_Dst = (PUCHAR)(puVar10 + 2);
puVar13 = puVar14;
if (_Dst == (PUCHAR)0x0) goto LAB_18001a65a;
}
else {
uStack_a0 = 0x18002f058;
uVar8 = FUN_18000a418(DAT_1800920e8 + 0x2cU);
puVar14 = local_98;
if ((int)uVar8 == 0) goto LAB_18002f07b;
puVar14 = auStack_c8;
if (&stack0x00000000 == (undefined *)0x88) goto LAB_18002f07b;
local_88 = 0x6b637453;
_Dst = aUStack_80;
puVar14 = auStack_c8;
puVar13 = auStack_c8;
if (_Dst == (UCHAR *)0x0) goto LAB_18002f07b;
}
*(undefined8 *)(puVar13 + -8) = 0x18002f0be;
iVar6 = FUN_18005b660((longlong)param_1,local_40,UStack_54,_Dst);
uVar19 = uVar17;
LAB_18001a5e1:
if (iVar6 == 0) {
uVar8 = *(undefined8 *)(param_1[3] + 8);
uVar12 = *param_8;
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
pUVar16 = *(PUCHAR *)param_1[1];
}
*(uint *)(puVar13 + 0x38) = uVar19;
*(undefined4 **)(puVar13 + 0x30) = param_8;
*(undefined4 *)(puVar13 + 0x28) = uVar12;
*(undefined8 *)(puVar13 + 0x20) = param_7;
*(undefined8 *)(puVar13 + -8) = 0x18001a633;
iVar6 = SslSignHash(pUVar16,uVar8,_Dst,uVar15);
if (iVar6 == 0) goto LAB_18001a642;
uVar12 = 0x44d;
}
else {
uVar12 = 0x44c;
}
*(undefined8 *)(puVar13 + -8) = 0x18002f160;
FUN_18005b470(param_1,uVar12,iVar6,0x50);
}
else {
if (param_4 != (void *)0x0) {
lVar7 = -1;
do {
lVar1 = lVar7 * 2;
lVar7 = lVar7 + 1;
} while (*(short *)((longlong)param_4 + lVar1 + 2) != 0);
uVar17 = (int)lVar7 * 2 + 2;
}
uVar18 = uVar17 + 0x40;
local_58 = 0x40;
puVar14 = local_98;
if (uVar18 < 0x40) goto LAB_18001a65a;
uVar9 = (ulonglong)uVar18;
puVar14 = local_98;
_Dst = pUVar16;
if ((DAT_1800920e0 < uVar9) ||
(uVar11 = DAT_1800920e8 + 8 + uVar9, puVar14 = local_98, uVar11 < uVar9)) {
LAB_18002f0d9:
if (uVar18 <= uVar17 + 0x48) {
*(undefined8 *)(puVar14 + -8) = 0x18002f0fb;

if (puVar10 == (undefined4 *)0x0) goto LAB_18001a65a;
*puVar10 = 0x70616548;
_Dst = (PUCHAR)(puVar10 + 2);
}
puVar13 = puVar14;
if (_Dst == (PUCHAR)0x0) goto LAB_18001a65a;
}
else {
uStack_a0 = 0x18001a518;
uVar8 = FUN_18000a418(uVar11);
puVar14 = local_98;
_Dst = (PUCHAR)0x0;
if ((int)uVar8 == 0) goto LAB_18002f0d9;
uVar9 = (ulonglong)(uVar17 + 0x48) + 0xf;
if (uVar9 <= uVar17 + 0x48) {
uVar9 = 0xffffffffffffff0;
}
uStack_a0 = 0x18001a542;
lVar7 = -(uVar9 & 0xfffffffffffffff0);
_Dst = (PUCHAR)((longlong)&local_58 + lVar7);
puVar14 = local_98 + lVar7;
if (_Dst == (PUCHAR)0x0) goto LAB_18002f0d9;
builtin_memcpy(_Dst,"Stck",4);
_Dst = (PUCHAR)((longlong)local_50 + lVar7);
puVar14 = local_98 + lVar7;
puVar13 = local_98 + lVar7;
if (_Dst == (PUCHAR)0x0) goto LAB_18002f0d9;
}
local_38 = (BCRYPT_HANDLE)0x0;
*(undefined8 *)(puVar13 + -8) = 0x18001a576;
iVar6 = FUN_180004510(param_5,(longlong *)&local_38,&local_58);
pvVar5 = local_38;
pUVar4 = local_40;
plVar3 = local_50[0];
UVar2 = UStack_54;
uVar15 = local_58;
if (iVar6 == 0) {
*(uint *)(puVar13 + 0x28) = local_58;
*(PUCHAR *)(puVar13 + 0x20) = _Dst + uVar17;
*(undefined8 *)(puVar13 + -8) = 0x18001a5a5;
iVar6 = FUN_18000a230(pvVar5,(longlong)plVar3,pUVar4,UVar2,*(PUCHAR *)(puVar13 + 0x20),
*(ULONG *)(puVar13 + 0x28));
}
param_1 = local_50[0];
if (uVar17 == 0) goto LAB_18001a5e1;
*(undefined8 *)(puVar13 + -8) = 0x18001a5be;
memcpy(_Dst,param_4,(ulonglong)uVar17);
uVar15 = uVar15 + uVar17;
if (uVar15 <= uVar18) {
param_1 = local_50[0];
if (param_6 == 8) {
uVar19 = 2;
}
else {
if (param_6 != 2) goto LAB_18001a642;
uVar19 = 1;
}
goto LAB_18001a5e1;
}
}
LAB_18001a642:
puVar14 = puVar13;
if ((_Dst != (PUCHAR)0x0) && (*(int *)(_Dst + -8) == 0x70616548)) {
*(undefined8 *)(puVar13 + -8) = 0x18002f17d;

}
LAB_18001a65a:
uVar9 = local_30 ^ (ulonglong)&local_58;
*(undefined8 *)(puVar14 + -8) = 0x18001a666;
FUN_180028070(uVar9);
return;
}
=========================================
Function at address: 0x18001a690
Called functions addresses: 0x180018eb4 0x18000503c 0xEXTERNAL:000000c2 0xEXTERNAL:0000009a 0x180016828 0x180018e50 0xEXTERNAL:00000089 0x18002a7c0 0x180023480 0xEXTERNAL:000000c0 0x18000a1f4 0x180041cb0 0xEXTERNAL:000000bc 0x180018e08 0x1800751b8 0x180009ed4


ulonglong FUN_18001a690(longlong param_1,int param_2,_FILETIME *param_3,_FILETIME *param_4)

{
uint uVar1;
LONG LVar2;
undefined8 *puVar3;
_FILETIME _Var4;
_FILETIME _Var5;
ulonglong uVar6;
longlong lVar7;
longlong lVar8;
undefined4 uVar9;
_FILETIME _Var10;
ulonglong uVar11;
int iVar12;
wchar_t *pwVar13;
int *piVar14;
_FILETIME _Var15;
_FILETIME local_48 [2];

_Var15.dwLowDateTime = 0;
_Var15.dwHighDateTime = 0;
iVar12 = 0xaa02;
if (param_2 != 0) {
iVar12 = 0xae06;
}
uVar1 = 0;
piVar14 = &DAT_1800914c0;
do {
if (*piVar14 == iVar12) {
uVar11 = (ulonglong)uVar1;
if (uVar11 != 0x3fffffff9ffdbad) {
lVar8 = param_1 + 0x228;
RtlAcquireResourceShared(lVar8,&DAT_180091401);
_Var10 = *param_3;
if (_Var10 != (_FILETIME)0x0) {
GetSystemTimeAsFileTime(local_48);
LOCK();
*(int *)((longlong)_Var10 + 0x1c) = *(int *)((longlong)_Var10 + 0x1c) + 1;
UNLOCK();
LVar2 = CompareFileTime(local_48,(FILETIME *)((longlong)_Var10 + 0x20));
if (LVar2 < 0) {
if ((param_2 != 0) ||
(_Var15 = *param_3,
*(int *)((longlong)_Var15 + 0x28) == (&DAT_1800914f0)[uVar11 * 0x10])) {
*param_4 = *param_3;
RtlReleaseResource(lVar8);
return 0;
}
}
else {
_Var15 = *param_3;
}
}
RtlReleaseResource(lVar8);
puVar3 = (undefined8 *)FUN_18000a1f4(0x30);
if (puVar3 == (undefined8 *)0x0) {
_Var10.dwLowDateTime = 0;
_Var10.dwHighDateTime = 0;
}
else {
_Var4 = (_FILETIME)FUN_180018eb4(puVar3,(&DAT_1800914f8)[uVar11 * 0x10]);
_Var10 = _Var4;
if (_Var4 != (_FILETIME)0x0) {
_Var5 = (_FILETIME)FUN_180018e50();
puVar3 = (undefined8 *)((longlong)_Var4 + 8);
local_48[0] = _Var5;
if (param_2 == 0) {
uVar1 = FUN_1800751b8(_Var5,0x32,0x301,0,(undefined *)0x0,0,(undefined *)0x0,puVar3,
(uint *)((longlong)_Var4 + 0x28));
uVar11 = (ulonglong)uVar1;
if (uVar1 != 0) goto LAB_18001a8b5;
pwVar13 = L"DHPUBLICBLOB";
LAB_18001a896:
uVar1 = FUN_180009ed4(_Var5,*puVar3,pwVar13,(uint *)((longlong)_Var4 + 0x18),
(longlong *)((longlong)_Var4 + 0x10));
uVar11 = (ulonglong)uVar1;
if (uVar1 != 0) goto LAB_18001a8b5;
}
else {
uVar9 = 0xc009;
if (param_2 != *(int *)(param_1 + 0x8c)) {
uVar9 = 0xc013;
}
uVar6 = FUN_18000503c(_Var5,uVar9,0x301,param_2,puVar3,
(uint *)((longlong)_Var4 + 0x28));
uVar11 = uVar6 & 0xffffffff;
if ((int)uVar6 == 0) {
pwVar13 = L"ECCPUBLICBLOB";
goto LAB_18001a896;
}
LAB_18001a8b5:

_Var10.dwLowDateTime = 0;
_Var10.dwHighDateTime = 0;
_Var5 = _Var4;
}
FUN_180023480(_Var5,(longlong *)local_48);
goto LAB_18001a8f6;
}
}
uVar11 = 0xe;
LAB_18001a8f6:
lVar7 = lVar8;
RtlAcquireResourceExclusive(lVar8,1);
FUN_180016828(lVar7,(longlong *)*param_3);
*param_3 = _Var10;
if (_Var10 != (_FILETIME)0x0) {
FUN_180018e08((longlong)_Var10);
_Var10 = *param_3;
}
*param_4 = _Var10;
RtlReleaseResource();
if (_Var15 == (_FILETIME)0x0) {
return uVar11;
}
FUN_180016828(lVar8,(longlong *)_Var15);
return uVar11;
}
break;
}
uVar1 = uVar1 + 1;
piVar14 = piVar14 + 0x10;
} while (uVar1 < 4);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1a,&DAT_180082ba8);
}
return 0x54f;
}
=========================================
Function at address: 0x18001a970
Called functions addresses: 0x180076ac8 0x180028070 0x18000909c 0x180057104 0xEXTERNAL:000000c7 0xEXTERNAL:00000041 0x18002a77b 0x180041cdc 0x1800191dc 0x180019220 0xEXTERNAL:0000013c 0x180041cb0 0x180055c40 0x18005c948 0xEXTERNAL:000000c2 0x18002a24f 0x180062690 0x18001be70 0x18002a7c0 0x180063404 0xEXTERNAL:00000135 0x180074c40 0xEXTERNAL:000000c0 0x180028d90 0xEXTERNAL:0000016f 0x18000a1d0 0x18005b470 0x18000a534 0x180009470 0x180019ee0 0x18005c0f0 0x1800723a4


void FUN_18001a970(longlong *param_1,uint *param_2)

{
char cVar1;
short sVar2;
ushort uVar3;
bool bVar4;
HLOCAL pvVar5;
uint *puVar6;
uint *puVar7;
byte bVar8;
int iVar9;
int iVar10;
NTSTATUS NVar11;
DWORD DVar12;
int extraout_EAX;
int extraout_EAX_00;
undefined8 uVar13;
PCCERT_SERVER_OCSP_RESPONSE_CONTEXT pCVar14;
ulonglong uVar15;
int *piVar16;
uint uVar17;
longlong lVar18;
byte bVar19;
undefined2 uVar20;
uint uVar21;
undefined *puVar22;
byte *pbVar23;
ushort *puVar24;
ushort *puVar25;
ushort *puVar26;
int iVar27;
ushort *puVar28;
int iVar29;
uint uVar30;
int iVar31;
ulonglong uVar32;
PCCERT_SERVER_OCSP_RESPONSE_CONTEXT pCVar33;
PCCERT_SERVER_OCSP_RESPONSE_CONTEXT pCVar34;
undefined auStackY_368 [32];
void *local_328;
byte local_320;
uint local_31c;
int local_318;
uint local_314;
int local_310;
int local_30c;
int local_308;
undefined4 local_304;
int local_300;
uint local_2fc;
uint local_2f8;
int local_2f4;
HLOCAL local_2f0;
int local_2e8;
int local_2e4;
uint local_2e0 [2];
undefined8 local_2d8;
uint local_2d0;
uint local_2cc;
uint local_2c8;
int local_2c4;
ushort *local_2c0;
uint *local_2b8;
longlong local_2b0;
PCCERT_SERVER_OCSP_RESPONSE_CONTEXT local_2a8;
void *local_2a0;
uint local_298;
undefined local_290 [16];
undefined **local_280;
longlong *local_278;
undefined8 local_270;
undefined4 local_268;
longlong *local_260;
byte local_258 [16];
BYTE local_248 [512];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_368;
local_2b8 = param_2;
RtlAcquireResourceShared(param_1[0x7c] + 0x48);
pCVar33 = (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)0x0;
iVar29 = 0;
uVar17 = 0;
iVar27 = 0;
local_2a8 = (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)0x0;
local_2f8 = local_2f8 & 0xffffff00;
iVar10 = 4;
lVar18 = *(longlong *)(param_1[0x7c] + 0x150);
local_280 = &PTR_FUN_18007c320;
local_2c0 = (ushort *)param_1[10];
bVar4 = false;
local_270 = 0;
local_268 = 0;
local_318 = 4;
uVar30 = (uint)(*(int *)(param_1[1] + 0x30) == 4);
local_2b0 = 4;
local_30c = *(int *)((longlong)param_1 + 0x3c);
local_310 = iVar27;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
if ((*(byte *)(param_1 + 4) & 4) != 0) {
local_310 = *(int *)((longlong)param_1 + 0x2c);
}
}
else {
local_318 = 0xc;
local_2b0 = 0xc;
}
local_2cc = local_310 + local_30c;
local_2a0 = (void *)0x0;
local_314 = 0;
local_328 = (void *)0x0;
local_2f0 = (HLOCAL)0x0;
local_2c8 = 0;
uVar32 = 0;
local_2d8 = (undefined *)((ulonglong)local_2d8._4_4_ << 0x20);
local_320 = 0;
local_2f4 = 0;
local_308 = 0;
local_2c4 = 0;
local_2e8 = 0;
local_2d0 = 0;
local_2fc = 0;
local_300 = 0;
local_31c = 0;
local_2e4 = 0;
local_2e0[0] = 0;
local_258[0] = 0;
local_258[1] = 0;
local_258[2] = 0;
local_258[3] = 0;
local_258[4] = 0;
local_258[5] = 0;
local_258[6] = 0;
local_258[7] = 0;
local_258[8] = 0;
local_258[9] = 0;
local_258[10] = 0;
local_258[0xb] = 0;
local_258[0xc] = 0;
local_258[0xd] = 0;
local_258[0xe] = 0;
local_258[0xf] = 0;
local_298 = uVar30;
local_278 = param_1;
local_260 = param_1;
memset(local_248,0,0x1fe);
local_290._0_4_ = 0x1fe0000;
local_290._8_8_ = local_248;
pCVar14 = pCVar33;
if (uVar30 == 0) {
if ((((((*(uint *)(param_1 + 8) & 0x51540) != 0) &&
(pCVar14 = (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)0x0,
(*(uint *)(param_1 + 0x11) >> 0x11 & 1) != 0)) &&
(*(HCERT_SERVER_OCSP_RESPONSE *)(lVar18 + 0x1c8) != (HCERT_SERVER_OCSP_RESPONSE)0x0)) &&
((pCVar14 = CertGetServerOcspResponseContext
(*(HCERT_SERVER_OCSP_RESPONSE *)(lVar18 + 0x1c8),0,(LPVOID)0x0),
local_2a8 = pCVar14, pCVar14 == (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)0x0 &&
((undefined8 **)DAT_180091000 != &DAT_180091000)))) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
DVar12 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x1f,&DAT_180082bd8,DVar12);
}
if (((*(uint *)(param_1 + 0x11) >> 8 & 1) != 0) &&
(local_2f8 = local_2f8 & 0xff, (*(uint *)(param_1 + 8) & 0x40400) != 0)) {
local_2f8 = 1;
}
}
local_304 = (uint)local_304._2_2_ << 0x10;
uVar13 = FUN_180019220((longlong)&local_280,pCVar14 != (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)0x0,
*(char *)((longlong)param_1 + 0x229),(undefined2 *)&local_304);
iVar31 = local_318;
iVar9 = (int)uVar13;
if (iVar9 != 0) {
RtlReleaseResource(param_1[0x7c] + 0x48);
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18001b050;
uVar20 = 0x20;
LAB_18002f28c:
FUN_180041cdc(DAT_180091000[2],uVar20,&DAT_180082bd8,iVar9);
goto LAB_18001b050;
}
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
iVar10 = 0xc;
}
uVar21 = iVar10 + 0x46 + (local_304 & 0xffff);
local_304 = uVar21;
if (uVar30 == 0) {
local_2a0 = *(void **)(lVar18 + 0x1b8);
local_2d0 = *(uint *)(lVar18 + 0x1c0);
if (local_2a0 == (void *)0x0) {
RtlReleaseResource(param_1[0x7c] + 0x48);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x21,&DAT_180082bd8);
}
goto LAB_18001b050;
}
local_2e8 = local_318 + 3 + local_2d0;
}
iVar10 = *(int *)(param_1[1] + 0x30);
if (iVar10 == 3) {
iVar10 = FUN_18001be70(param_1,0,&local_31c);
LAB_18001ab9b:
if (iVar10 != 0) {
RtlReleaseResource(param_1[0x7c] + 0x48);
FUN_18005b470(param_1,0x4e2,iVar10,0x50);
goto LAB_18001b050;
}
uVar32 = (ulonglong)local_31c;
if (local_31c != 0) {
iVar29 = local_31c + iVar31;
local_300 = iVar29;
}
}
else {
if (iVar10 == 2) {
iVar10 = FUN_180074c40(param_1,(PUCHAR)0x0,&local_31c);
param_1 = (longlong *)CONCAT44((int)((ulonglong)param_1 >> 0x20),iVar10);
iVar10 = extraout_EAX;
goto LAB_18001ab9b;
}
if (iVar10 == 4) {
iVar10 = FUN_180076ac8((longlong)param_1,0,(undefined *)0x0,&local_31c);
goto LAB_18001ab9b;
}
if (*(char *)(param_1[1] + 0x48) != '\0') {
iVar10 = FUN_1800723a4(param_1,(PUCHAR)0x0,(int *)&local_31c);
goto LAB_18001ab9b;
}
iVar29 = 0;
}
puVar28 = local_2c0;
if (local_2a8 != (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)0x0) {
uVar17 = local_2a8->cbEncodedOcspResponse + 4 + iVar31;
local_2fc = uVar17;
}
if ((uVar30 == 0) && ((*(uint *)(param_1 + 0x11) >> 8 & 1) != 0)) {
uVar15 = FUN_180057104((undefined8 *)local_2c0);
iVar9 = (int)uVar15;
if (iVar9 != 0) {
RtlReleaseResource(param_1[0x7c] + 0x48);
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001b050;
uVar20 = 0x22;
goto LAB_18002f28c;
}
if (DAT_180092f08 == 0) {
LAB_18002f482:
pCVar14 = pCVar33;
if ((((*(int *)(param_1[10] + 0xc4) == 0) ||

piVar16 == (int *)0x0)) || (*piVar16 != 1)) || (piVar16[1] != 2)) {
LAB_18002f543:
piVar16 = &DAT_1800858e8;
lVar18 = 3;
do {
uVar17 = *(uint *)(param_1[10] + 0xc4);
if ((uVar17 == 0) ||
(uVar15 = FUN_18005c948(*(uint **)(param_1[10] + 200),uVar17,*piVar16,(longlong)pCVar14
), pCVar34 = pCVar33, (char)uVar15 == '\0')) {
pCVar34 = (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)(ulonglong)(byte)((char)pCVar33 + 1);
*(int *)(local_258 + (longlong)pCVar33 * 4) = *piVar16;
}
piVar16 = piVar16 + 1;
lVar18 = lVar18 + -1;
pCVar33 = pCVar34;
} while (lVar18 != 0);
local_320 = (byte)pCVar34;
if (local_320 == 0) {
RtlReleaseResource(param_1[0x7c] + 0x48);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar20 = 0x25;
goto LAB_18002f52a;
}
}
else {
puVar28 = (ushort *)((longlong)param_1 + 0x1da);
if ((char)local_2f8 == '\0') {
puVar28 = (ushort *)0x0;
}
uVar13 = FUN_180062690(local_328,local_2c8,puVar28,local_258,local_320,(byte *)0x0,
local_2e0);
if ((int)uVar13 == 0) {
iVar27 = local_2e0[0] + local_318;
iVar31 = local_318;
uVar17 = local_2fc;
iVar29 = local_300;
local_2e4 = iVar27;
goto LAB_18001abe5;
}
RtlReleaseResource(param_1[0x7c] + 0x48);
FUN_18005b470(param_1,0x4e3,(int)uVar13,0x50);
}
}
else {
uVar13 = FUN_18005c0f0((byte *)((longlong)piVar16 + 9),(uint)*(byte *)(piVar16 + 2),'\x01',
(longlong)local_290);
pCVar14 = (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)local_290;
if ((int)uVar13 == 0) goto LAB_18002f543;
RtlReleaseResource(param_1[0x7c] + 0x48);
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001b047;
uVar20 = 0x24;
LAB_18002f52a:
FUN_180041cb0(DAT_180091000[2],uVar20,&DAT_180082bd8);
}
}
else {
uVar13 = FUN_180055c40((longlong)puVar28,&local_2f0,(undefined4 *)&local_2d8);
if ((int)uVar13 == 0) {
local_328 = local_2f0;
local_2c8 = (uint)local_2d8;
goto LAB_18002f482;
}
RtlReleaseResource(param_1[0x7c] + 0x48);
local_328 = local_2f0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x23,&DAT_180082bd8,(int)uVar13);
local_328 = local_2f0;
}
}
goto LAB_18001b047;
}
LAB_18001abe5:
puVar6 = local_2b8;
puVar28 = (ushort *)0x0;
if ((*(char *)((longlong)param_1 + 0xe9) == '\0') &&
(iVar10 = iVar27 + iVar31 + iVar29 + uVar17 + local_2e8, iVar10 + uVar21 < 0x3fd1)) {
iVar29 = iVar10 + uVar21 + local_310;
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar30 = iVar29 + *(int *)(param_1 + 6);
uVar17 = *(uint *)((longlong)param_1 + 0x34);
if (uVar17 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar17 = uVar17 - uVar30 % uVar17;
}
uVar30 = uVar30 + uVar17;
}
iVar29 = uVar30 + *(int *)((longlong)param_1 + 0x2c);
}
uVar17 = iVar29 + *(int *)((longlong)param_1 + 0x3c);
}
else {
bVar4 = true;
iVar10 = iVar29 + uVar17 + local_2e8 + uVar21 + local_310;
local_308 = local_310 + iVar31;
iVar29 = iVar27 + local_310;
if (iVar27 == 0) {
iVar29 = 0;
}
local_2f4 = iVar27;
local_2c4 = iVar31;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
if ((*(byte *)(param_1 + 4) & 4) == 0) {
iVar27 = *(int *)((longlong)param_1 + 0x3c);
uVar17 = iVar10 + iVar27;
local_314 = iVar27 + iVar29;
}
else {
uVar17 = iVar10 + *(int *)(param_1 + 6);
uVar30 = *(uint *)((longlong)param_1 + 0x34);
if (uVar30 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar30 = uVar30 - uVar17 % uVar30;
}
uVar17 = uVar17 + uVar30;
}
iVar27 = *(int *)((longlong)param_1 + 0x3c);
uVar17 = uVar17 + *(int *)((longlong)param_1 + 0x2c) + iVar27;
uVar30 = *(uint *)((longlong)param_1 + 0x34);
local_314 = *(int *)(param_1 + 6) + iVar29;
if (uVar30 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar30 = uVar30 - local_314 % uVar30;
}
local_314 = local_314 + uVar30;
}
uVar21 = local_308 + *(int *)(param_1 + 6);
local_314 = *(int *)((longlong)param_1 + 0x2c) + iVar27 + local_314;
uVar30 = *(uint *)((longlong)param_1 + 0x34);
if (uVar30 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar30 = uVar30 - uVar21 % uVar30;
}
uVar21 = uVar21 + uVar30;
}
local_308 = uVar21 + *(int *)((longlong)param_1 + 0x2c);
}
local_308 = local_308 + iVar27;
}
else {
uVar17 = iVar10 + local_30c;
local_308 = local_308 + local_30c;
local_314 = iVar29 + local_30c;
if (iVar29 == 0) {
local_314 = 0;
}
}
}
uVar30 = local_308 + local_314 + uVar17;
puVar22 = *(undefined **)(local_2b8 + 2);
local_2d8 = puVar22;
if (puVar22 == (undefined *)0x0) {
*local_2b8 = uVar30;
puVar22 = (undefined *)FUN_18000a1d0((longlong)param_1,uVar30);
*(undefined **)(puVar6 + 2) = puVar22;
if (puVar22 == (undefined *)0x0) {
iVar29 = 0xe;
local_2d8 = puVar22;
goto LAB_18002f786;
}
LAB_18001ac77:
puVar6[1] = 0;
local_2d8 = puVar22;

if (iVar29 == 0) {
*(undefined *)((longlong)param_1 + 0x154) = 0;

(param_1,param_1[0x6e],*(undefined4 *)(param_1 + 0x6d),0);
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(undefined4 *)(param_1 + 0x6d) = 0;
if (iVar29 != 0) {
FUN_18005b470(param_1,0x3ef,iVar29,0x50);
}
lVar18 = param_1[0x7c];
if (iVar29 == 0) {
*(undefined2 *)(lVar18 + 0xee) = 0x20;
_time32((__time32_t *)&local_2c0);
if ((*(uint *)(param_1 + 8) & 0xa2aa0) == 0) {
lVar18 = 0x130;
}
else {
lVar18 = 0x110;
}
*(uint *)(lVar18 + (longlong)param_1) =
(uint)local_2c0 >> 0x18 | ((uint)local_2c0 & 0xff0000) >> 8 |
((uint)local_2c0 & 0xff00) << 8 | (uint)local_2c0 << 0x18;
NVar11 = BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,(PUCHAR)((longlong)param_1 + lVar18 + 4),
0x1c,2);
if ((NVar11 < 0) && (iVar29 = RtlNtStatusToDosError(NVar11), iVar29 != 0)) {
RtlReleaseResource(param_1[0x7c] + 0x48);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar20 = 0x27;
goto LAB_18002f7d7;
}
}
else {
FUN_1800191dc((longlong)param_1);
local_2f0 = (HLOCAL)(ulonglong)local_2cc;
puVar22 = puVar22 + (longlong)local_2f0;
uVar13 = FUN_180019ee0((longlong)param_1,puVar22,&local_304,(longlong)&local_280);
if ((int)uVar13 == 0) {
local_2cc = local_304;
puVar24 = (ushort *)(puVar22 + local_304);
if (local_298 == 0) {
uVar15 = (ulonglong)local_2d0;
pbVar23 = (byte *)((longlong)puVar24 + local_2b0);
*pbVar23 = (byte)(local_2d0 >> 0x10);
pbVar23[2] = (byte)local_2d0;
pbVar23[1] = (byte)(local_2d0 >> 8);
memcpy(pbVar23 + 3,local_2a0,(ulonglong)local_2d0);
RtlReleaseResource(param_1[0x7c] + 0x48);
sVar2 = *(short *)((longlong)param_1 + 0xdc);
iVar29 = local_2d0 + 3;
*(short *)((longlong)param_1 + 0xdc) = sVar2 + 1;
cVar1 = *(char *)((longlong)param_1 + 0xe9);
*(byte *)puVar24 = 0xb;
bVar19 = (byte)((uint)iVar29 >> 8);
bVar8 = (byte)((uint)iVar29 >> 0x10);
if (cVar1 != '\0') {
*(byte *)((longlong)puVar24 + 5) = (byte)sVar2;
*(byte *)((longlong)puVar24 + 9) = bVar8;
*(byte *)(puVar24 + 2) = (byte)((ushort)sVar2 >> 8);
((byte *)((longlong)puVar24 + 7))[0] = 0;
((byte *)((longlong)puVar24 + 7))[1] = 0;
*(byte *)(puVar24 + 3) = 0;
*(byte *)((longlong)puVar24 + 0xb) = (byte)iVar29;
*(byte *)(puVar24 + 5) = bVar19;
}
*(byte *)((longlong)puVar24 + 1) = bVar8;
*(byte *)((longlong)puVar24 + 3) = (byte)iVar29;
*(byte *)(puVar24 + 1) = bVar19;
puVar24 = (ushort *)(pbVar23 + 3 + uVar15);
}
else {
RtlReleaseResource(param_1[0x7c] + 0x48);
}
pCVar33 = local_2a8;
puVar26 = puVar24;
if (local_2a8 != (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)0x0) {
puVar26 = (ushort *)((longlong)puVar24 + (ulonglong)local_2fc);
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
memcpy(puVar24 + 4,local_2a8->pbEncodedOcspResponse,
(ulonglong)local_2a8->cbEncodedOcspResponse);
*(byte *)(puVar24 + 2) = 1;
*(byte *)((longlong)puVar24 + 5) =
*(byte *)((longlong)&pCVar33->cbEncodedOcspResponse + 2);
*(byte *)(puVar24 + 3) = *(byte *)((longlong)&pCVar33->cbEncodedOcspResponse + 1);
*(byte *)((longlong)puVar24 + 7) = *(byte *)&pCVar33->cbEncodedOcspResponse;
}
else {
memcpy(puVar24 + 8,local_2a8->pbEncodedOcspResponse,
(ulonglong)local_2a8->cbEncodedOcspResponse);
*(byte *)(puVar24 + 6) = 1;
*(byte *)((longlong)puVar24 + 0xd) =
*(byte *)((longlong)&pCVar33->cbEncodedOcspResponse + 2);
*(byte *)(puVar24 + 7) = *(byte *)((longlong)&pCVar33->cbEncodedOcspResponse + 1);
*(byte *)((longlong)puVar24 + 0xf) = *(byte *)&pCVar33->cbEncodedOcspResponse;
}
uVar3 = *(ushort *)((longlong)param_1 + 0xdc);
*(ushort *)((longlong)param_1 + 0xdc) = uVar3 + 1;
FUN_18000a534((undefined *)puVar24,0x16,(void *)0x0,pCVar33->cbEncodedOcspResponse + 4
,(uint)uVar3,(uint)*(byte *)((longlong)param_1 + 0xe9));
}
iVar29 = local_300;
if ((int)uVar32 != 0) {
pbVar23 = (byte *)((longlong)puVar26 + local_2b0);
iVar29 = *(int *)(param_1[1] + 0x30);
if (iVar29 == 3) {
iVar29 = FUN_18001be70(param_1,pbVar23,&local_31c);
LAB_18001ae95:
if (iVar29 != 0) {
FUN_18005b470(param_1,0x4e2,iVar29,0x50);
goto LAB_18001b047;
}
uVar32 = (ulonglong)local_31c;
}
else {
if (iVar29 == 2) {
iVar29 = FUN_180074c40(param_1,pbVar23,&local_31c);
param_1 = (longlong *)CONCAT44((int)((ulonglong)param_1 >> 0x20),iVar29);
iVar29 = extraout_EAX_00;
goto LAB_18001ae95;
}
if (iVar29 == 4) {
iVar29 = FUN_180076ac8((longlong)param_1,0,pbVar23,&local_31c);
goto LAB_18001ae95;
}
if (*(char *)(param_1[1] + 0x48) != '\0') {
iVar29 = FUN_1800723a4(param_1,pbVar23,(int *)&local_31c);
goto LAB_18001ae95;
}
}
sVar2 = *(short *)((longlong)param_1 + 0xdc);
*(short *)((longlong)param_1 + 0xdc) = sVar2 + 1;
cVar1 = *(char *)((longlong)param_1 + 0xe9);
*(byte *)puVar26 = 0xc;
bVar19 = (byte)(uVar32 >> 0x10);
bVar8 = (byte)(uVar32 >> 8);
if (cVar1 != '\0') {
*(byte *)((longlong)puVar26 + 5) = (byte)sVar2;
*(byte *)(puVar26 + 2) = (byte)((ushort)sVar2 >> 8);
*(byte *)((longlong)puVar26 + 9) = bVar19;
((byte *)((longlong)puVar26 + 7))[0] = 0;
((byte *)((longlong)puVar26 + 7))[1] = 0;
*(byte *)(puVar26 + 3) = 0;
*(byte *)((longlong)puVar26 + 0xb) = (byte)uVar32;
*(byte *)(puVar26 + 5) = bVar8;
}
*(byte *)((longlong)puVar26 + 1) = bVar19;
*(byte *)((longlong)puVar26 + 3) = (byte)uVar32;
*(byte *)(puVar26 + 1) = bVar8;
puVar26 = (ushort *)(pbVar23 + uVar32);
iVar29 = local_318 + (int)uVar32;
}
iVar10 = local_2fc + iVar29 + local_2e8 + local_2cc;
if (bVar4) {
iVar29 = iVar10 + local_310;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar30 = iVar29 + *(int *)(param_1 + 6);
uVar17 = *(uint *)((longlong)param_1 + 0x34);
if (uVar17 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar17 = uVar17 - uVar30 % uVar17;
}
uVar30 = uVar30 + uVar17;
}
iVar29 = uVar30 + *(int *)((longlong)param_1 + 0x2c);
}
uVar17 = iVar29 + *(int *)((longlong)param_1 + 0x3c);
}
else {
uVar17 = iVar29 + local_30c;
}
puVar26 = (ushort *)(local_2d8 + uVar17);
}
puVar24 = puVar28;
if (local_2e4 == 0) {
puVar25 = puVar26;
if (bVar4) {
LAB_18002fbb5:
puVar25 = (ushort *)((longlong)puVar26 + (longlong)local_2f0);
puVar28 = puVar26;
}
}
else {
local_2c0 = puVar26;
if (bVar4) {
local_2c0 = (ushort *)((longlong)puVar26 + (longlong)local_2f0);
}
puVar24 = puVar26;
if (!bVar4) {
puVar24 = puVar28;
}
pbVar23 = (byte *)((longlong)local_2c0 + local_2b0);
puVar26 = (ushort *)((longlong)param_1 + 0x1da);
if ((char)local_2f8 == '\0') {
puVar26 = puVar28;
}
uVar13 = FUN_180062690(local_328,local_2c8,puVar26,local_258,local_320,pbVar23,
local_2e0);
uVar30 = local_2e0[0];
if ((int)uVar13 != 0) {
FUN_18005b470(param_1,0x4e3,(int)uVar13,0x50);
goto LAB_18001b047;
}
uVar3 = *(ushort *)((longlong)param_1 + 0xdc);
uVar32 = (ulonglong)local_2e0[0];
*(ushort *)((longlong)param_1 + 0xdc) = uVar3 + 1;
FUN_18000a534((undefined *)local_2c0,0xd,(void *)0x0,local_2e0[0],(uint)uVar3,
(uint)*(byte *)((longlong)param_1 + 0xe9));
puVar25 = (ushort *)(pbVar23 + uVar32);
iVar29 = local_318 + uVar30;
if (bVar4) {
iVar27 = iVar29 + local_310;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar21 = iVar27 + *(int *)(param_1 + 6);
uVar30 = *(uint *)((longlong)param_1 + 0x34);
if (uVar30 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar30 = uVar30 - uVar21 % uVar30;
}
uVar21 = uVar21 + uVar30;
}
iVar27 = uVar21 + *(int *)((longlong)param_1 + 0x2c);
}
local_314 = iVar27 + *(int *)((longlong)param_1 + 0x3c);
}
else {
local_314 = iVar27 + local_30c;
}
puVar26 = (ushort *)((ulonglong)local_314 + (longlong)puVar24);
local_2f4 = iVar29;
goto LAB_18002fbb5;
}
iVar10 = iVar10 + iVar29;
}
sVar2 = *(short *)((longlong)param_1 + 0xdc);
*(short *)((longlong)param_1 + 0xdc) = sVar2 + 1;
cVar1 = *(char *)((longlong)param_1 + 0xe9);
*(byte *)puVar25 = 0xe;
if (cVar1 != '\0') {
*(byte *)((longlong)puVar25 + 5) = (byte)sVar2;
*(byte *)(puVar25 + 2) = (byte)((ushort)sVar2 >> 8);
((byte *)((longlong)puVar25 + 7))[0] = 0;
((byte *)((longlong)puVar25 + 7))[1] = 0;
*(byte *)(puVar25 + 3) = 0;
puVar25[5] = 0;
*(byte *)((longlong)puVar25 + 9) = 0;
}
puVar25[1] = 0;
*(byte *)((longlong)puVar25 + 1) = 0;
if (bVar4) {
local_308 = local_318 + local_310;
local_2c4 = local_318;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar21 = local_308 + *(int *)(param_1 + 6);
uVar30 = *(uint *)((longlong)param_1 + 0x34);
if (uVar30 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar30 = uVar30 - uVar21 % uVar30;
}
uVar21 = uVar21 + uVar30;
}
local_308 = uVar21 + *(int *)((longlong)param_1 + 0x2c);
}
local_308 = local_308 + *(int *)((longlong)param_1 + 0x3c);
}
else {
local_308 = local_308 + local_30c;
}
}
else {
iVar10 = iVar10 + local_318;
iVar29 = iVar10 + local_310;
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar30 = iVar29 + *(int *)(param_1 + 6);
uVar17 = *(uint *)((longlong)param_1 + 0x34);
if (uVar17 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar17 = uVar17 - uVar30 % uVar17;
}
uVar30 = uVar30 + uVar17;
}
iVar29 = uVar30 + *(int *)((longlong)param_1 + 0x2c);
}
uVar17 = iVar29 + *(int *)((longlong)param_1 + 0x3c);
}

(param_1,(undefined *)((longlong)local_2f0 + (longlong)local_2d8),
iVar10,1);
puVar6 = local_2b8;
if (iVar29 == 0) {
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
uVar32 = FUN_180009470(param_1,local_2b8,0x16,iVar10);
iVar29 = (int)uVar32;
if (iVar29 != 0) {
FUN_18005b470(param_1,0x3bd,iVar29,0x50);
}
}
puVar7 = local_2b8;
pvVar5 = local_2f0;
uVar30 = local_314;
if (iVar29 == 0) {
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
puVar6[1] = puVar6[1] + uVar17;
uVar20 = *(undefined2 *)((longlong)param_1 + 0x22);
local_2d8[0xc] = (char)(uVar17 - local_30c);
local_2d8[0xb] = (char)(uVar17 - local_30c >> 8);
local_2d8[1] = (char)((ushort)uVar20 >> 8);
local_2d8[2] = (char)uVar20;
*local_2d8 = 0x16;
}
if (local_314 != 0) {
uVar32 = FUN_180063404(param_1,(byte *)((longlong)local_2f0 + (longlong)puVar24),
local_2f4,local_2b8,0x3f2,0x3be);
iVar29 = (int)uVar32;
if (iVar29 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar20 = 0x29;
goto LAB_18002f7d7;
}
goto LAB_18001b047;
}
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
puVar7[1] = puVar7[1] + uVar30;
uVar20 = *(undefined2 *)((longlong)param_1 + 0x22);
iVar29 = uVar30 - local_30c;
*(byte *)(puVar24 + 6) = (byte)iVar29;
*(byte *)((longlong)puVar24 + 0xb) = (byte)((uint)iVar29 >> 8);
*(byte *)((longlong)puVar24 + 1) = (byte)((ushort)uVar20 >> 8);
*(byte *)(puVar24 + 1) = (byte)uVar20;
*(byte *)puVar24 = 0x16;
}
}
iVar10 = local_308;
if (local_308 != 0) {
uVar32 = FUN_180063404(param_1,(byte *)((longlong)pvVar5 + (longlong)puVar28),
local_2c4,puVar7,0x3f0,0x3bb);
iVar29 = (int)uVar32;
if (iVar29 == 0) {
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
puVar7[1] = puVar7[1] + iVar10;
uVar20 = *(undefined2 *)((longlong)param_1 + 0x22);
iVar10 = iVar10 - local_30c;
*(byte *)(puVar28 + 6) = (byte)iVar10;
*(byte *)((longlong)puVar28 + 0xb) = (byte)((uint)iVar10 >> 8);
*(byte *)((longlong)puVar28 + 1) = (byte)((ushort)uVar20 >> 8);
*(byte *)(puVar28 + 1) = (byte)uVar20;
*(byte *)puVar28 = 0x16;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar20 = 0x2a;
goto LAB_18002f7d7;
}
}
goto LAB_18001b047;
}
}
else {
FUN_18005b470(param_1,0x3f1,iVar29,0x50);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar20 = 0x28;
goto LAB_18002f7d7;
}
}
else {
RtlReleaseResource(param_1[0x7c] + 0x48);
FUN_18005b470(param_1,0x4e4,(int)uVar13,0x50);
}
}
goto LAB_18001b047;
}
}
else {
lVar18 = param_1[0x7c];
}
RtlReleaseResource(lVar18 + 0x48);
}
else {
if (uVar30 <= *local_2b8) goto LAB_18001ac77;
local_2b8[1] = uVar30;
iVar29 = -0x7ff6fcdf;
LAB_18002f786:
RtlReleaseResource(param_1[0x7c] + 0x48);
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001b047;
uVar20 = 0x26;
LAB_18002f7d7:
FUN_180041cdc(DAT_180091000[2],uVar20,&DAT_180082bd8,iVar29);
}
LAB_18001b047:
if (local_328 != (HLOCAL)0x0) {
FUN_18000909c(local_328);
}
LAB_18001b050:
if (local_2a8 != (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)0x0) {
CertFreeServerOcspResponseContext(local_2a8);
}
FUN_180028070(local_48 ^ (ulonglong)auStackY_368);
return;
}
=========================================
Function at address: 0x18001b0b0
Called functions addresses: 0x18003030b 0xEXTERNAL:000000c2 0xEXTERNAL:0000010c 0xEXTERNAL:00000075 0xEXTERNAL:000000c9 0x180028070 0x18002a7c0 0xEXTERNAL:000000c7 0x18002a77b 0xEXTERNAL:000000c0 0x180028d90 0x18002fe39 0x180041cb0 0x18001c410 0xEXTERNAL:000000bc


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_18001b0b0(undefined8 param_1,longlong *param_2,uint *param_3,uint param_4,uint param_5,
byte param_6)

{
int *piVar1;
wchar_t *pwVar2;
wchar_t *pwVar3;
ulonglong *puVar4;
int iVar5;
undefined4 uVar6;
uint uVar7;
ulonglong uVar8;
longlong lVar9;
ulonglong uVar10;
undefined4 *puVar11;
char cVar12;
uint uVar13;
wchar_t *_Dst;
byte *pbVar14;
byte bVar15;
bool bVar16;
undefined2 uVar17;
longlong *plVar18;
byte *pbVar19;
wchar_t *pwVar20;
uint *puVar21;
undefined8 *puVar22;
ulonglong *puVar23;
uint uVar24;
longlong lVar25;
uint *_Size;
char *pcVar26;
byte *pbVar27;
byte *pbVar28;
byte *pbVar29;
undefined auStackY_548 [32];
bool local_4e8;
char local_4e7;
char local_4e6 [2];
int local_4e4;
byte *local_4e0;
uint local_4d8;
int local_4d4;
ulonglong *local_4d0;
ulonglong *local_4c8;
uint *local_4c0;
uint *local_4b8;
byte *local_4b0;
uint local_4a8;
undefined4 *local_4a0;
wchar_t *local_498;
undefined4 local_490 [2];
undefined *local_488;
longlong local_480;
ushort local_478;
ushort local_476;
undefined4 local_474;
byte *local_470;
uint *local_468;
undefined8 local_460;
undefined4 uStack_458;
undefined8 uStack_454;
undefined8 local_448;
undefined4 local_440;
undefined2 local_43c;
wchar_t local_43a [249];
undefined local_248 [512];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_548;
lVar25 = param_2[10];
local_4b8 = (uint *)0x0;
local_4d0 = (ulonglong *)0x0;
local_4d4 = 0;
local_4e6[0] = '\0';
local_4b0 = (byte *)0x0;
local_4a8 = param_4;
local_480 = lVar25;
local_468 = param_3;
memset(local_248,0,0x1fe);
local_490[0] = 0x1fe0000;
local_488 = local_248;
uVar24 = *(uint *)(lVar25 + 0xc4);
pwVar20 = *(wchar_t **)(lVar25 + 200);
local_4a0 = (undefined4 *)0x0;
local_4e8 = uVar24 != 0;
local_4c0 = (uint *)0x0;
local_4c8 = (ulonglong *)0x0;
local_4e0 = (byte *)0x0;
local_4e4 = 0;
local_4e7 = '\0';
local_498 = pwVar20;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1b,&DAT_180085700);
}
RtlAcquireResourceShared(&DAT_180092428);
lVar25 = param_2[0x79];
pbVar14 = (byte *)(lVar25 + 6);
if (lVar25 == 0) {
local_4d8 = 0;
pbVar14 = (byte *)0x0;
}
else {
local_4d8 = (uint)*(ushort *)(lVar25 + 4);
}
do {
puVar22 = DAT_180091000;
_Dst = local_43a;
uVar8 = 0;
local_440 = DAT_180083d18;
lVar25 = 0x1f2;
local_43c = DAT_180083d1c;
local_448 = _DAT_180083d10;
memset(_Dst,0,0x1f2);
uVar13 = local_4d8;
if ((local_4c8 == (ulonglong *)0x0) || (local_4e8 == false)) {
if ((pbVar14 != (byte *)0x0) && (local_4d8 != 0)) {
local_4a0 = local_490;
local_474 = 0;
local_4b0 = pbVar14;
if ((local_488 == (undefined *)0x0) || (local_4d8 - 1 < (uint)*pbVar14)) goto LAB_18001b488;
local_470 = pbVar14 + 1;
local_478 = (ushort)*pbVar14;
local_476 = local_478;
uVar6 = RtlAnsiStringToUnicodeString(local_490,&local_478,0);
iVar5 = RtlNtStatusToDosError(uVar6);
if (iVar5 != 0) goto LAB_18001b488;
lVar9 = 0x200;
lVar25 = (longlong)local_488 - (longlong)&local_448;
_Dst = (wchar_t *)&local_448;
while (((ulonglong)(ushort)local_490[0] - 0x200) + lVar9 != 0) {
if (*(wchar_t *)(lVar25 + (longlong)_Dst) == L'\0') {
if (lVar9 == 0) {
_Dst = _Dst + -1;
}
break;
}
*_Dst = *(wchar_t *)(lVar25 + (longlong)_Dst);
_Dst = _Dst + 1;
lVar9 = lVar9 + -1;
if (lVar9 == 0) {
FUN_18002fe39(_Dst,0,lVar25);
return;
}
}
*_Dst = L'\0';
uVar7 = *pbVar14 + 1;
if (uVar13 < uVar7) goto LAB_18001b488;
local_4d8 = uVar13 - uVar7;
pbVar14 = pbVar14 + uVar7;
puVar22 = DAT_180091000;
}
uVar8 = (ulonglong)local_4e8;
}
else {
uVar8 = uVar8 & 0xffffffffffffff00;
local_4e8 = false;
}
if (((undefined8 **)puVar22 != &DAT_180091000) &&
((*(byte *)((longlong)puVar22 + 0x1c) & 4) != 0)) {
_Dst = (wchar_t *)puVar22[2];
pcVar26 = "strict";
if ((char)uVar8 == '\0') {
pcVar26 = "all";
}
FUN_18005a1f4(_Dst,uVar8,lVar25,pcVar26,(wchar_t *)&local_448);
uVar8 = (ulonglong)local_4e8;
}
bVar15 = (byte)uVar8;
if ((uVar24 != 0) && (pwVar20 != (wchar_t *)0x0)) {
_Dst = (wchar_t *)((ulonglong)uVar24 * 5);
pwVar2 = pwVar20 + (ulonglong)uVar24 * 0x14;
pwVar3 = local_498;
while (bVar15 = (byte)uVar8, pwVar3 < pwVar2) {
if ((*(uint *)(pwVar20 + 8) & param_5) != 0) {
if (*(int *)pwVar20 == 0) {
LAB_18002fe9c:
bVar16 = SUB81(uVar8,0);
if ((bVar16 == false) || ((*(byte *)(pwVar20 + 0x10) & 1) == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0xf,&DAT_180082b78,param_5);
bVar16 = local_4e8;
}
iVar5 = -0x7ff6fccf;
goto LAB_18001b57a;
}
}
else if (local_4a0 != (undefined4 *)0x0) {
_Dst = pwVar20;
uVar13 = FUN_18005c318((uint *)pwVar20,(longlong)local_4a0);
uVar8 = (ulonglong)local_4e8;
if ((char)uVar13 != '\0') goto LAB_18002fe9c;
}
}
pwVar20 = pwVar20 + 0x14;
pwVar3 = pwVar20;
}
}
plVar18 = param_2;
_Size = local_468;
uVar8 = FUN_18001c410(_Dst,param_2,local_468,local_4a8,param_6,(longlong)local_4a0,bVar15,
&local_4d0,(longlong *)&local_4b8,&local_4d4,local_4e6);
iVar5 = (int)uVar8;
if (iVar5 == 0) {
if (param_6 != 0) goto LAB_18001b2c8;
puVar21 = local_4b8;
cVar12 = local_4e6[0];
if (local_4e8 == false) goto LAB_18001b85a;
if (local_4c8 == (ulonglong *)0x0) {
local_4c8 = local_4d0;
local_4c0 = local_4b8;
local_4e0 = local_4b0;
local_4e7 = local_4e6[0];
local_4e4 = local_4d4;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180085700);
}
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
pcVar26 = "strict";
if (local_4e8 == false) {
pcVar26 = "all";
}
FUN_18005a2a4(DAT_180091000[2],plVar18,_Size,pcVar26,(wchar_t *)&local_448);
}
local_4d0 = (ulonglong *)0x0;
local_4b8 = (uint *)0x0;
local_4d4 = 0;
local_4e6[0] = '\0';
bVar16 = local_4e8;
LAB_18001b57a:
} while ((uVar24 != 0) &&
((pwVar20 = local_498, local_4d8 != 0 ||
((local_4c8 != (ulonglong *)0x0 && (bVar16 != false))))));
puVar21 = local_4b8;
_Size = local_4c0;
if (iVar5 == 0) {
LAB_18001b862:
local_4e0 = (byte *)0x0;

if (local_4e0 == (byte *)0x0) goto LAB_18001b488;
RtlAcquireResourceExclusive(local_4e0 + 0x48,1);
*(uint **)(local_4e0 + 0x150) = puVar21;
*(undefined8 *)(local_4e0 + 0xbc) = *(undefined8 *)(local_480 + 0x2f8);
RtlReleaseResource(local_4e0 + 0x48);
LAB_18001b2c8:
puVar4 = local_4d0;
iVar5 = 0;
if (local_4d0[0x6a] != 0) {
LOCK();
piVar1 = (int *)(*(longlong *)(local_4d0[0x6a] + 0x10) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
}
LOCK();
*(int *)(local_4d0[0x6b] + 0xc) = *(int *)(local_4d0[0x6b] + 0xc) + 1;
UNLOCK();

lVar25 = param_2[1];
if (lVar25 != 0) {
if (*(longlong *)(lVar25 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar25 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar25 + 0x358));
}
if ((longlong *)param_2[3] != (longlong *)0x0) {
FUN_1800209bc((longlong *)param_2[3]);
param_2[3] = 0;
}
puVar23 = local_4d0;
if (lVar9 != 0) {
uVar8 = *local_4d0;
RtlAcquireResourceShared(lVar9 + 0x228,1);
_Size = (uint *)0x0;
if (*(uint *)(lVar9 + 0x60) != 0) {
do {
lVar25 = *(longlong *)(*(longlong *)(lVar9 + 0x58) + (longlong)_Size * 8);
if (*(ulonglong *)(lVar25 + 0x10) == uVar8) {
LOCK();
piVar1 = (int *)(lVar25 + 0x18);
*piVar1 = *piVar1 + 1;
UNLOCK();
param_2[3] = *(longlong *)(*(longlong *)(lVar9 + 0x58) + (longlong)_Size * 8);
puVar23 = local_4d0;
break;
}
uVar24 = (int)_Size + 1;
_Size = (uint *)(ulonglong)uVar24;
} while (uVar24 < *(uint *)(lVar9 + 0x60));
}
RtlReleaseResource(lVar9 + 0x228);
}
uVar8 = 0;
if ((*(uint *)(param_2 + 8) & 0xf3f00) == 0) {
uStack_458 = *(undefined4 *)(puVar23 + 2);
local_460 = 0x14;
uStack_454 = 0;
if (1 < *(uint *)((longlong)puVar23 + 0xc)) {
uStack_454 = CONCAT44(1,*(uint *)((longlong)puVar23 + 0xc));
}
LAB_18001b3e3:
if ((*(byte *)(param_2 + 4) & 1) != 0) {
_Size = (uint *)0x14;
lVar25 = RtlCompareMemory(&local_460,param_2 + 5);
if (lVar25 != 0x14) {
*(ushort *)(param_2 + 4) = *(ushort *)(param_2 + 4) | 1;
param_2[1] = (longlong)puVar23;
goto LAB_18001b488;
}
}
*(undefined4 *)(param_2 + 5) = (undefined4)local_460;
*(undefined4 *)((longlong)param_2 + 0x2c) = local_460._4_4_;
*(undefined4 *)(param_2 + 6) = uStack_458;
*(undefined4 *)((longlong)param_2 + 0x34) = (undefined4)uStack_454;
*(undefined4 *)(param_2 + 7) = uStack_454._4_4_;
}
else {
_Size = (uint *)(ulonglong)*(uint *)((longlong)puVar23 + 0x1c);
iVar5 = SslLookupCipherLengths
(*puVar23,*(undefined2 *)((longlong)param_2 + 0x22),_Size,
*(undefined4 *)(param_2 + 2));
if (iVar5 == 0) goto LAB_18001b3e3;
}
cVar12 = local_4e6[0];
*(ushort *)(param_2 + 4) = *(ushort *)(param_2 + 4) | 1;
param_2[1] = (longlong)puVar23;
if (iVar5 != 0) goto LAB_18001b488;
if (((param_6 == 0) && (*(int *)(puVar23 + 6) == 3)) || ((param_5 >> 0xc & 1) != 0)) {
*(int *)(param_2 + 2) = local_4d4;
plVar18 = (longlong *)puVar4[0x6a];
if (plVar18 != (longlong *)0x0) {
uVar24 = *(uint *)(plVar18 + 1);
_Size = (uint *)(ulonglong)uVar24;
if (uVar24 != 0) {
do {
if (*(int *)(uVar8 * 0x30c + 0x304 + *plVar18) == local_4d4) {
lVar25 = uVar8 * 0x30c + *plVar18;
if (lVar25 != 0) {
*(undefined4 *)((longlong)param_2 + 0x14) = *(undefined4 *)(lVar25 + 0x308);
}
break;
}
uVar13 = (int)uVar8 + 1;
uVar8 = (ulonglong)uVar13;
} while (uVar13 < uVar24);
}
}
}
if ((local_4e6[0] == '\0') && ((param_5 >> 0xc & 1) != 0)) {
_Size = (uint *)*puVar23;

if (iVar5 != 0) goto LAB_18001b488;
}
if (local_4b0 == (byte *)0x0) {
pbVar14 = (byte *)0x0;
LAB_18001b456:
if (cVar12 == '\0') {
if (param_6 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18003030b((longlong)DAT_180091000,pbVar14,_Size);
return;
}
goto LAB_18001b488;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001b488;
uVar17 = 0x24;
}
else {
*(undefined4 *)((longlong)param_2 + 0x44) = 0x47;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001b488;
uVar17 = 0x23;
}
FUN_18005a04c(DAT_180091000[2],uVar17,_Size,*(undefined4 *)((longlong)puVar23 + 0x1c),
(wchar_t *)((longlong)puVar23 + 0x4a));
goto LAB_18001b488;
}
if ((ushort)(*local_4b0 + 1) < 2) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar17 = 0x4a;
LAB_1800302c1:
FUN_180041cb0(DAT_180091000[2],uVar17,&DAT_180082c58);
}
goto LAB_18001b488;
}
pbVar29 = local_4b0 + (ushort)(*local_4b0 + 1);
for (pbVar14 = local_4b0; pbVar14 < pbVar29; pbVar14 = pbVar14 + *pbVar14 + 1) {
if ((*pbVar14 == 0) || (pbVar29 <= pbVar14 + *pbVar14)) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18001b488;
uVar17 = 0x4c;
goto LAB_1800302c1;
}
}
lVar25 = param_2[0x62];
if (lVar25 == 0) goto LAB_18001b488;
pbVar28 = (byte *)(lVar25 + 6);
if (pbVar28 != (byte *)0x0) {
pbVar27 = pbVar28 + *(ushort *)(lVar25 + 4);
pbVar14 = local_4b0;
for (; pbVar28 < pbVar27; pbVar28 = pbVar28 + (ulonglong)*pbVar28 + 1) {
pbVar19 = pbVar14;
if (pbVar14 < pbVar29) {
uVar8 = (ulonglong)*pbVar28;
do {
if ((byte)uVar8 == *pbVar14) {
uVar10 = RtlCompareMemory(pbVar28 + 1,pbVar14 + 1,uVar8);
uVar8 = (ulonglong)*pbVar28;
if (uVar10 == uVar8) {
puVar11 = (undefined4 *)param_2[99];
if (puVar11 == (undefined4 *)0x0) {
puVar11 = (undefined4 *)

param_2[99] = (longlong)puVar11;
if (puVar11 == (undefined4 *)0x0) goto LAB_18001b488;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3d,&DAT_180082bd8);
puVar11 = (undefined4 *)param_2[99];
}
*puVar11 = 1;
pbVar14 = pbVar28 + 1;
*(undefined4 *)(param_2[99] + 4) = 2;
*(byte *)(param_2[99] + 8) = *pbVar28;
_Size = (uint *)(ulonglong)*pbVar28;
memcpy((void *)(param_2[99] + 9),pbVar14,(size_t)_Size);
goto LAB_18001b456;
}
}
pbVar14 = pbVar14 + (ulonglong)*pbVar14 + 1;
pbVar19 = local_4b0;
} while (pbVar14 < pbVar29);
}
pbVar14 = pbVar19;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180082bd8);
}
}
else {
if (local_4c8 != (ulonglong *)0x0) {
puVar21 = local_4c0;
cVar12 = local_4e7;
local_4e6[0] = local_4e7;
local_4d4 = local_4e4;
local_4d0 = local_4c8;
local_4b8 = local_4c0;
local_4b0 = local_4e0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
_Size = (uint *)&DAT_180085700;
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180085700);
}
LAB_18001b85a:
if (cVar12 == '\0') goto LAB_18001b862;
goto LAB_18001b2c8;
}
if ((param_2[0x79] == 0) || (*(short *)(param_2[0x79] + 4) == 0)) {
if ((iVar5 == -0x7ff6fccf) &&
((FUN_180044bcc(*(uint *)(local_480 + 0xd4),local_480 + 0xd8,param_5),
(undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)))) {
FUN_180041cb0(DAT_180091000[2],0x22,&DAT_180085700);
}
goto LAB_18001b488;
}
if (uVar24 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar17 = 0x21;
goto LAB_180030056;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar17 = 0x20;
LAB_180030056:
FUN_180041cb0(DAT_180091000[2],uVar17,&DAT_180085700);
}
}
FUN_18005b470(param_2,0x4b8,0x80090367,0x78);
*(undefined4 *)((longlong)param_2 + 0x44) = 0x60;
*(undefined2 *)(param_2 + 0xc) = 0x7802;
LAB_18001b488:
RtlReleaseResource(&DAT_180092428);
if (param_2[0x79] != 0) {

param_2[0x79] = 0;
}
FUN_180028070(local_48 ^ (ulonglong)auStackY_548);
return;
}
=========================================
Function at address: 0x18001b930
Called functions addresses: 0x180041cdc 0xEXTERNAL:000000a7 0xEXTERNAL:0000003c 0x18001686c 0xEXTERNAL:00000124 0x1800077a0 0x180007c20 0x180030595 0x1800432ec 0x180041d20


undefined8
FUN_18001b930(longlong param_1,longlong param_2,wchar_t *param_3,uint param_4,longlong param_5,
uint *param_6,uint param_7,longlong param_8,char param_9)

{
uint *puVar1;
int iVar2;
int iVar3;
char cVar4;
BOOL BVar5;
int iVar6;
undefined8 uVar7;
ushort uVar8;
wchar_t *_Str1;
uint *puVar9;
undefined *puVar10;
uint uVar11;
ulonglong uVar12;
int *piVar13;
uint uVar14;
byte bVar15;
ulonglong uVar16;
bool bVar17;
uint local_res8 [2];
undefined8 in_stack_ffffffffffffffa0;
uint local_40;

uVar14 = 0;
uVar11 = uVar14;
if (param_3 != (wchar_t *)0x0) {
uVar11 = *(uint *)(param_3 + 0x182);
}
if (*(int **)(param_1 + 0x20) == (int *)0x0) {
return 0;
}
if (**(int **)(param_1 + 0x20) != 1) {
return 0;
}
if (param_2 == 0) {
return 0;
}
iVar2 = *(int *)(param_2 + 0x20);
iVar3 = *(int *)(param_2 + 0x24);
if ((*(longlong *)(param_1 + 0x1b0) == 0) && (*(int *)(param_1 + 0x84) == 0)) {
return 0;
}
if (((iVar2 == 0xa400) && (*(int *)(param_1 + 0x7c) == 1)) && (*(int *)(param_1 + 0x80) != 1)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) == 0) {
return 0;
}
FUN_1800432ec(DAT_180091000[2],0x2a,&DAT_180082ba8,*(int *)(param_1 + 0x80));
return 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],0x2b,&DAT_180082ba8,iVar3,(char)*(undefined4 *)(param_1 + 0x84));
}
if (iVar3 == 0x2400) {
if ((*(int *)(param_1 + 0x84) - 0x2400U & 0xffff7fff) != 0) {
return 0;
}
}
else if (iVar3 == 0x2200) {
bVar17 = *(int *)(param_1 + 0x84) == 0x2200;
LAB_180030436:
if (!bVar17) {
return 0;
}
}
else if (iVar3 == 0x2203) {
if (*(int *)(param_1 + 0x84) != 0x2203) {
return 0;
}
if (uVar11 != *(uint *)(param_1 + 0x8c)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) == 0) {
return 0;
}
FUN_180041d20(DAT_180091000[2],0x2c,&DAT_180082ba8,uVar11,(char)*(uint *)(param_1 + 0x8c));
return 0;
}
}
else {
if (iVar3 == 0xa400) {
bVar17 = *(int *)(param_1 + 0x84) == 0xa400;
goto LAB_180030436;
}
if ((iVar3 != 0) && (*(int *)(param_1 + 0x84) != iVar3)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) == 0) {
return 0;
}
FUN_180041cdc(DAT_180091000[2],0x2d,&DAT_180082ba8,iVar3);
return 0;
}
}
local_40 = 3;
if (param_7 != 0) {
iVar6 = *(int *)(param_1 + 0x84);
if (iVar6 == 0x2203) {
local_res8[0] = *(uint *)(param_1 + 0x88);
}
else {
local_res8[0] = *(uint *)(param_1 + 0x1ac);
}
uVar16 = (ulonglong)local_res8[0];
if ((((param_6 != (uint *)0x0) && (iVar6 != 0)) && (param_1 != -0x90)) && (param_1 != -0x110)) {
if (iVar6 == 0x2203) {
if (param_3 != (wchar_t *)0x0) {
uVar7 = FUN_180007c20(param_6,param_7,param_3,*(int *)(param_3 + 0x182),local_res8[0],
param_8,param_9);
cVar4 = (char)uVar7;
goto joined_r0x0001800304f4;
}
}
else if (iVar6 == 0x2200) {
uVar7 = FUN_1800077a0(param_6,param_7,1,L"DSA",(wchar_t *)0x0,local_res8[0],param_8,param_9)
;
cVar4 = (char)uVar7;
joined_r0x0001800304f4:
if (cVar4 != '\0') {
return 0;
}
}
else {
if (iVar6 == 0xa400) {
if (iVar2 == 0xa400) {
in_stack_ffffffffffffffa0 =
CONCAT71((int7)((ulonglong)in_stack_ffffffffffffffa0 >> 8),param_9);
cVar4 = FUN_18001686c(param_6,param_7,0,local_res8[0],param_8,param_9);
if (cVar4 != '\0') {
return 0;
}
}
}
else if (iVar6 != 0x2400) goto LAB_18001baf7;
puVar9 = param_6;
if (param_6 < param_6 + (ulonglong)param_7 * 10) {
do {
if (puVar9[5] != 0) {
if (*puVar9 == 0) {
LAB_18001bd7f:
if (((param_9 == '\0') || ((*(byte *)(puVar9 + 8) & 1) == 0)) &&
(piVar13 = *(int **)(puVar9 + 6), piVar13 < piVar13 + (ulonglong)puVar9[5] * 0xc)
) {
do {
if ((*piVar13 == 1) && (*(short *)(piVar13 + 2) == 6)) {
_Str1 = *(wchar_t **)(piVar13 + 4);
puVar10 = &DAT_1800822a0;
iVar6 = wcsncmp(_Str1,L"RSA",3);
if (iVar6 == 0) {
if (((piVar13[6] == 0) && (piVar13[10] == 0)) && (piVar13[0xb] == 0)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0;
}
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"RSA",1);
return 0;
}
if (local_res8[0] != 0) {
if (piVar13[10] == 0) {
if (piVar13[0xb] != 0) {
uVar7 = FUN_180030595(_Str1,puVar10,local_res8[0],(char)uVar16,
(int)in_stack_ffffffffffffffa0);
return uVar7;
}
}
else {
if (local_res8[0] < (uint)piVar13[10]) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0;
}
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"RSA",
(char)local_res8[0],1);
return 0;
}
if (piVar13[0xb] != 0) {
uVar7 = FUN_180030595(_Str1,puVar10,local_res8[0],(char)uVar16,
(int)in_stack_ffffffffffffffa0);
return uVar7;
}
}
}
}
}
piVar13 = piVar13 + 0xc;
} while (piVar13 < (int *)((ulonglong)puVar9[5] * 0x30 + *(longlong *)(puVar9 + 6)
));
}
}
else {
uVar12 = 0;
if (param_8 != 0) {
do {
iVar6 = RtlCompareUnicodeString
(uVar12 * 0x10 + *(longlong *)(puVar9 + 2),param_8,1);
if (iVar6 == 0) goto LAB_18001bd7f;
uVar11 = (int)uVar12 + 1;
uVar12 = (ulonglong)uVar11;
} while (uVar11 < *puVar9);
}
}
}
puVar9 = puVar9 + 10;
} while (puVar9 < param_6 + (ulonglong)param_7 * 10);
}
}
LAB_18001baf7:
uVar7 = FUN_1800077a0(param_6,param_7,4,(wchar_t *)(param_1 + 0x90),(wchar_t *)0x0,0,0,'\x01')
;
if ((char)uVar7 != '\0') {
return 0;
}
uVar7 = FUN_1800077a0(param_6,param_7,4,(wchar_t *)(param_1 + 0x110),(wchar_t *)0x0,0,0,'\x01'
);
if ((char)uVar7 != '\0') {
return 0;
}
}
}
if (param_5 != 0) {
iVar6 = *(int *)(param_1 + 0x84);
if (iVar6 == 0xa400) {
LAB_18001bb90:
local_40 = 1;
}
else if (iVar6 == 0x2200) {
local_40 = 2;
}
else if (iVar6 != 0x2203) {
if (iVar6 != 0x2400) {
return 0;
}
goto LAB_18001bb90;
}
bVar15 = 0;
puVar9 = &DAT_18007c3a8;
while (((puVar9[1] != local_40 || ((*puVar9 & param_4) == 0)) ||
((((*(uint *)(param_1 + 0x1ac) != 0 && ((local_40 == 1 && (puVar9[9] == 8)))) &&
(*(uint *)(param_1 + 0x1ac) >> 3 < (uint)*(byte *)(puVar9 + 8) * 2 + 2)) ||
(((((param_4 & 0x3000) != 0 && (puVar9[1] == 3)) &&
(puVar9[10] != *(uint *)(param_1 + 0x8c))) ||
((0xb < bVar15 ||
(uVar8 = *(ushort *)(param_5 + 0x22), (uVar8 >> (bVar15 & 0x1f) & 1) == 0))))))))) {
bVar15 = bVar15 + 1;
puVar1 = puVar9 + 0xc;
puVar9 = puVar9 + 0x12;
if (&UNK_18007c6ef < puVar1) {
return 0;
}
}
if ((short *)(param_1 + 0x200) == (short *)0x0) {
return 2;
}
if (*(short *)(param_1 + 0x200) == 0) {
return 2;
}
if (*(ushort *)(param_1 + 0x222) == 0) {
return 2;
}
uVar11 = uVar14;
if ((uVar8 & DAT_180092808) != 0) {
uVar11 = (uint)DAT_180092808;
}
uVar8 = uVar8 | (ushort)uVar11;
uVar11 = uVar14;
if ((uVar8 & DAT_180092804) != 0) {
uVar11 = (uint)DAT_180092804;
}
uVar8 = uVar8 | (ushort)uVar11;
if ((uVar8 & DAT_180092800) != 0) {
uVar14 = (uint)DAT_180092800;
}
if (((uint)*(ushort *)(param_1 + 0x222) & ~(uVar8 | uVar14)) != 0) {
return 2;
}
}
if (*(longlong *)(param_1 + 0x20) == 0) {
return 2;
}
if (iVar3 != 0x2400) goto LAB_18001bd16;
if (iVar2 == 0xae06) {
LAB_18001bcb1:
uVar11 = 0x80;
}
else {
if (iVar2 != 0xa400) {
if (iVar2 != 0xaa02) goto LAB_18001bd16;
goto LAB_18001bcb1;
}
uVar11 = 0x20;
}
local_res8[0] = 0;
BVar5 = CertGetIntendedKeyUsage
(0x10001,*(PCERT_INFO *)(*(longlong *)(param_1 + 0x20) + 0x18),
(BYTE *)local_res8,4);
if (BVar5 != 0) {
uVar14 = uVar11 & local_res8[0];
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041d20(DAT_180091000[2],0x14,&DAT_180082b78,local_res8[0],(char)uVar11);
}
if (uVar14 == 0) {
return 2;
}
}
LAB_18001bd16:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2e,&DAT_180082ba8,iVar3);
}
return 1;
}
=========================================
Function at address: 0x18001be70
Called functions addresses: 0xEXTERNAL:0000003f 0x18001a690 0xEXTERNAL:00000047 0x180028070 0x18002a7c0 0x18002a77b 0x180028d90 0xEXTERNAL:000000c0 0xEXTERNAL:00000116 0x180030871 0x18005b470 0xEXTERNAL:000000bc 0x18001a450 0x180001604


void FUN_18001be70(longlong *param_1,undefined8 param_2,undefined8 param_3)

{
PUCHAR pUVar1;
_FILETIME *p_Var2;
byte bVar3;
NCRYPT_KEY_HANDLE hKey;
code *pcVar4;
int iVar5;
longlong lVar6;
ulonglong uVar7;
_FILETIME _Var8;
uint *puVar9;
longlong *plVar10;
undefined8 uVar11;
longlong *plVar12;
ulonglong uVar13;
uint uVar14;
undefined **ppuVar15;
uint uVar16;
undefined *puVar17;
undefined *puVar18;
undefined *puVar19;
undefined *puVar20;
undefined *puVar21;
_FILETIME *p_Var22;
int iVar23;
uint uVar24;
uint uVar25;
ushort *puVar26;
byte bVar27;
ULONG UVar28;
undefined uVar29;
longlong lVar30;
PUCHAR pUVar31;
byte bVar32;
ushort uVar33;
uint uVar34;
uint uVar35;
uint uVar36;
ushort uVar37;
uint unaff_R15D;
undefined auStack_108 [8];
undefined auStack_100 [56];
undefined local_c8;
uint local_c0;
undefined4 local_bc;
longlong *local_b8;
undefined4 local_b0;
undefined4 local_ac;
undefined8 local_a8;
undefined8 local_a0;
undefined8 local_90;
ulonglong local_48;

puVar19 = auStack_108;
puVar20 = auStack_108;
puVar17 = auStack_108;
puVar18 = auStack_108;
puVar21 = auStack_108;
local_48 = DAT_180091970 ^ (ulonglong)auStack_108;
uVar13 = 0;
iVar5 = 0;
uVar24 = 0;
uVar14 = unaff_R15D & 0xffffff00;
local_b8 = param_1;
local_a0 = param_3;
local_a8 = param_2;
uVar33 = 0;
uVar35 = 0;
local_ac = 0;
local_90 = 0;
local_c0 = uVar14;
local_c8 = 0;
local_bc = 0;
local_b0 = 0;
if (*(int *)(param_1[1] + 0x34) == 2) {
uVar34 = 1;
}
else {
if (*(int *)(param_1[1] + 0x34) != 4) goto LAB_18001c264;
uVar34 = 3;
}
p_Var2 = (_FILETIME *)(param_1 + 0x78);
_Var8 = *p_Var2;
puVar19 = auStack_108;
if (_Var8 == (_FILETIME)0x0) {
iVar23 = *(int *)(param_1 + 2);

if (iVar23 == 0) {
uVar7 = FUN_18001a690(lVar6,0,(_FILETIME *)(lVar6 + 0x1f0),p_Var2);
iVar23 = (int)uVar7;
if (iVar23 != 0x57) goto LAB_18001bfa2;
uVar35 = 1;
}
else {
if (iVar23 == *(int *)(lVar6 + 0x8c)) {
p_Var22 = (_FILETIME *)(lVar6 + 0x1f8);
}
else {
p_Var2->dwLowDateTime = 0;
p_Var2->dwHighDateTime = 0;
RtlAcquireResourceExclusive(lVar6 + 0x228,1);
plVar12 = (longlong *)(lVar6 + 0x1e0);
for (plVar10 = (longlong *)*plVar12; plVar10 != plVar12; plVar10 = (longlong *)*plVar10) {
if (*(int *)(plVar10 + 2) == iVar23) {
p_Var22 = (_FILETIME *)(plVar10 + 3);
puVar17 = auStack_108;
param_1 = local_b8;
if (p_Var22 != (_FILETIME *)0x0) goto LAB_18001bf73;
break;
}
}
plVar10 = (longlong *)LocalAlloc(0x40,0x20);
if (plVar10 == (longlong *)0x0) {
RtlReleaseResource(lVar6 + 0x228);
iVar23 = 0xe;
puVar21 = auStack_108;
goto LAB_1800307ce;
}
*(int *)(plVar10 + 2) = iVar23;
plVar10[1] = (longlong)plVar10;
*plVar10 = (longlong)plVar10;
lVar30 = *plVar12;
if (*(longlong **)(lVar30 + 8) != plVar12) {
lVar30 = 3;
pcVar4 = (code *)swi(0x29);
plVar10 = (longlong *)(*pcVar4)();
puVar20 = auStack_100;
}
*plVar10 = lVar30;
p_Var22 = (_FILETIME *)(plVar10 + 3);
plVar10[1] = (longlong)plVar12;
*(longlong **)(lVar30 + 8) = plVar10;
*plVar12 = (longlong)plVar10;
puVar17 = puVar20;
LAB_18001bf73:
*(undefined8 *)(puVar17 + -8) = 0x18001bf81;
RtlReleaseResource(lVar6 + 0x228);
uVar14 = *(uint *)(puVar17 + 0x48);
}
*(undefined8 *)(puVar17 + -8) = 0x18001bf9b;
uVar7 = FUN_18001a690(lVar6,iVar23,p_Var22,p_Var2);
param_1 = *(longlong **)(puVar17 + 0x50);
iVar23 = (int)uVar7;
puVar18 = puVar17;
LAB_18001bfa2:
puVar21 = puVar18;
if (iVar23 == 0) {
*(undefined4 *)(param_1[0xb] + 8) = *(undefined4 *)((longlong)*p_Var2 + 0x28);
_Var8 = *p_Var2;
puVar19 = puVar18;
goto LAB_18001bfba;
}
}
LAB_1800307ce:
uVar29 = 0x28;
if (uVar35 == 0) {
uVar29 = 0x50;
}
*(undefined8 *)(puVar21 + -8) = 0x1800307f0;
FUN_18005b470(param_1,0x25b,iVar23,uVar29);
*(undefined8 *)(puVar21 + -8) = 0x180030803;
FUN_18005b470(param_1,0x41a,iVar23,0x50);
puVar19 = puVar21;
goto LAB_18001c264;
}
LAB_18001bfba:
lVar6 = *(longlong *)((longlong)_Var8 + 0x10);
*(longlong *)(puVar19 + 0x70) = lVar6;
if (lVar6 == 0) goto LAB_18001c264;
uVar25 = *(uint *)(lVar6 + 4);
uVar36 = 0;
if ((*(byte *)((longlong)param_1 + 0x14) & 8) == 0) {
if (uVar25 < 0x80) {
uVar14 = uVar25 * 2 + 1;
uVar16 = uVar35;
goto LAB_18001bfed;
}
uVar16 = 0x54f;
}
else {
if (uVar25 < 0x100) {
uVar14 = uVar25;
}
uVar14 = uVar14 & 0xff;
uVar16 = 0x57;
if (uVar25 < 0x100) {
uVar16 = uVar24;
}
LAB_18001bfed:
puVar19[0x40] = (char)uVar14;
*(uint *)(puVar19 + 0x48) = uVar14;
}
bVar32 = (byte)uVar14;
if (uVar16 != 0) goto LAB_18001c264;
uVar25 = *(uint *)(param_1 + 8);
iVar23 = (uVar14 & 0xff) + 6;
if ((uVar25 & 0x40400) != 0) {
*(uint *)(puVar19 + 0x50) = (uVar14 & 0xff) + 8;
*(undefined8 *)(puVar19 + -8) = 0x18001c03a;

if (lVar6 == 0) goto LAB_18001c264;
bVar32 = 0;
uVar25 = *(uint *)(param_1 + 8);
puVar9 = &DAT_18007c3a8;
bVar27 = 0;
uVar7 = 0xff;
lVar30 = 0xc;
do {
if (((((((puVar9[1] == uVar34) && ((*puVar9 & uVar25) != 0)) && (bVar27 < 0xc)) &&
((*(ushort *)(param_1 + 0x44) >> (bVar27 & 0x1f) & 1) != 0)) &&
(((uVar34 != 1 || (puVar9[9] != 8)) ||
((uint)*(byte *)(puVar9 + 8) * 2 + 2 <= *(uint *)(lVar6 + 0x1ac) >> 3)))) &&
((((uVar25 & 0x3000) == 0 || (puVar9[1] != 3)) || (puVar9[10] == 0)))) &&
(((bVar3 = *(byte *)(puVar9 + 8), bVar3 < bVar32 && (0x14 < bVar3)) || (bVar32 < 0x15)))) {
uVar7 = (ulonglong)bVar27;
bVar32 = bVar3;
}
puVar9 = puVar9 + 0x12;
bVar27 = bVar27 + 1;
lVar30 = lVar30 + -1;
} while (lVar30 != 0);
ppuVar15 = (undefined **)&DAT_18007c390;
uVar37 = uVar33;
if ((byte)uVar7 < 0xc) {
uVar37 = (&DAT_18007c390)[uVar7 * 0x24];
}
uVar33 = uVar37 >> 8 | uVar37 << 8;
if (uVar33 == 0) goto LAB_18001c264;
do {
if (uVar37 == *(ushort *)ppuVar15) {
*(undefined4 *)(puVar19 + 0x4c) = *(undefined4 *)(ppuVar15 + 5);
*(undefined **)(puVar19 + 0x78) = ppuVar15[6];
*(undefined4 *)(puVar19 + 0x58) = *(undefined4 *)((longlong)ppuVar15 + 0x3c);
break;
}
ppuVar15 = ppuVar15 + 9;
} while (ppuVar15 < &PTR_FUN_18007c6f0);
bVar32 = (byte)*(undefined4 *)(puVar19 + 0x48);
iVar23 = *(int *)(puVar19 + 0x50);
}
*(undefined8 *)(puVar19 + -8) = 0x18001c137;
memset(puVar19 + 0x80,0,0x40);
*(undefined4 *)(puVar19 + 0x44) = 0;
if ((uVar25 & 0x43c00) == 0) {
if (uVar34 == 1) {
uVar7 = 0x24;
LAB_18001c1d4:
if ((uVar25 & 0x40051555) == 0) {
*(undefined8 *)(puVar19 + -8) = 0x1800308e3;

if (lVar6 != 0) {
hKey = *(NCRYPT_KEY_HANDLE *)(lVar6 + 0x68);
*(undefined4 *)(puVar19 + 0x38) = 0x40;
*(undefined **)(puVar19 + 0x30) = puVar19 + 0x44;
*(undefined4 *)(puVar19 + 0x28) = *(undefined4 *)(puVar19 + 0x44);
*(undefined8 *)(puVar19 + 0x20) = 0;
*(undefined8 *)(puVar19 + -8) = 0x180030922;
iVar5 = NCryptSignHash(hKey,(void *)0x0,puVar19 + 0x80,(DWORD)uVar7,
*(PBYTE *)(puVar19 + 0x20),*(DWORD *)(puVar19 + 0x28),
*(DWORD **)(puVar19 + 0x30),*(DWORD *)(puVar19 + 0x38));
goto LAB_18001c231;
}
}
else if (param_1[3] != 0) {
uVar11 = *(undefined8 *)(param_1[3] + 8);
if ((ulonglong *)param_1[1] != (ulonglong *)0x0) {
uVar13 = *(ulonglong *)param_1[1];
}
*(undefined4 *)(puVar19 + 0x38) = 0;
*(undefined **)(puVar19 + 0x30) = puVar19 + 0x44;
*(undefined4 *)(puVar19 + 0x28) = 0;
*(undefined8 *)(puVar19 + 0x20) = 0;
*(undefined8 *)(puVar19 + -8) = 0x18001c22c;
iVar5 = SslSignHash(uVar13,uVar11,puVar19 + 0x80,uVar7);
LAB_18001c231:
uVar24 = *(uint *)(puVar19 + 0x44);
goto LAB_18001c236;
}
LAB_18003089d:
iVar5 = -0x7ff6fcfc;
goto LAB_1800308a4;
}
if (uVar34 == 3) {
uVar7 = 0x14;
goto LAB_18001c1cb;
}
}
else {
if (DAT_180092324 == 0) {
iVar5 = 0x490;
uVar7 = uVar13;
}
else {
plVar12 = &DAT_180092330;
uVar7 = uVar13;
while ((lVar6 = *plVar12, lVar6 == 0 || (*(int *)(lVar6 + 0x14) != *(int *)(puVar19 + 0x4c))))
{
uVar14 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar14;
plVar12 = plVar12 + 1;
if (DAT_180092324 <= uVar14) {
FUN_180030871();
return;
}
}
uVar7 = (ulonglong)*(uint *)(lVar6 + 8);
}
uVar24 = 0;
if (iVar5 == 0) {
LAB_18001c1cb:
if ((uint)uVar7 < 0x41) goto LAB_18001c1d4;
goto LAB_18003089d;
}
LAB_18001c236:
if (iVar5 < 0) {
LAB_1800308a4:
*(undefined8 *)(puVar19 + -8) = 0x1800308b7;
FUN_18005b470(param_1,0x41b,iVar5,0x50);
goto LAB_18001c264;
}
}
if (uVar24 < 0x8d) {
uVar24 = 0x8c;
}
puVar9 = *(uint **)(puVar19 + 0x68);
uVar24 = iVar23 + uVar24;
if (*(longlong *)(puVar19 + 0x60) == 0) {
*puVar9 = uVar24;
goto LAB_18001c264;
}
if (*puVar9 < uVar24) {
*puVar9 = uVar24;
goto LAB_18001c264;
}
lVar6 = *(longlong *)(param_1[10] + 0x2f0);
*(undefined8 *)(puVar19 + -8) = 0x18001c2ad;
iVar5 = FUN_180001604(lVar6,(undefined4 *)(puVar19 + 0x5c));
if (iVar5 == 0) {
pUVar31 = *(PUCHAR *)(puVar19 + 0x60);
*pUVar31 = '\x03';
pUVar1 = pUVar31 + 4;
pUVar31[1] = (UCHAR)((uint)*(undefined4 *)(param_1 + 2) >> 8);
pUVar31[2] = *(UCHAR *)(param_1 + 2);
if ((*(byte *)((longlong)param_1 + 0x14) & 8) == 0) {
lVar6 = *(longlong *)(puVar19 + 0x70);
uVar14 = *(uint *)(lVar6 + 4);
if (uVar14 < 0x80) {
bVar27 = (char)uVar14 * '\x02' + 1;
if (pUVar1 != (PUCHAR)0x0) {
if (bVar27 <= bVar32) {
*pUVar1 = '\x04';
*(undefined8 *)(puVar19 + -8) = 0x18001c320;
memcpy(pUVar31 + 5,(void *)(lVar6 + 8),(ulonglong)bVar27 - 1);
uVar36 = uVar35;
goto LAB_18001c326;
}
uVar36 = 0x80090321;
}
}
else {
bVar27 = (byte)*(undefined4 *)(puVar19 + 0x48);
uVar36 = 0x54f;
}
}
else {
*(undefined8 *)(puVar19 + -8) = 0x180030956;
uVar11 = FUN_180002a40(*(longlong *)(puVar19 + 0x70),pUVar1,puVar19 + 0x40);
uVar36 = (uint)uVar11;
bVar27 = puVar19[0x40];
LAB_18001c326:
pUVar31 = *(PUCHAR *)(puVar19 + 0x60);
}
if (uVar36 == 0) {
pUVar31[3] = bVar27;
uVar24 = uVar24 + (-4 - (uint)bVar27);
puVar26 = (ushort *)(pUVar31 + (ulonglong)(bVar27 + 1) + 3);
UVar28 = (int)puVar26 - (int)pUVar31;
if ((*(uint *)(param_1 + 8) & 0x40400) != 0) {
if (uVar24 < 2) goto LAB_18001c3e3;
*puVar26 = uVar33;
puVar26 = puVar26 + 1;
uVar24 = uVar24 - 2;
}
iVar5 = uVar24 - 2;
*(int *)(puVar19 + 0x44) = iVar5;
if (uVar34 == 1) {
*(undefined **)(puVar19 + 0x38) = puVar19 + 0x44;
*(ushort **)(puVar19 + 0x30) = puVar26 + 1;
*(undefined4 *)(puVar19 + 0x28) = *(undefined4 *)(puVar19 + 0x58);
*(undefined4 *)(puVar19 + 0x20) = *(undefined4 *)(puVar19 + 0x4c);
*(undefined8 *)(puVar19 + -8) = 0x18001c3b4;
iVar5 = FUN_18001a450(param_1,pUVar31,UVar28,*(void **)(puVar19 + 0x78),
*(int *)(puVar19 + 0x20),*(int *)(puVar19 + 0x28),
*(undefined8 *)(puVar19 + 0x30),*(undefined4 **)(puVar19 + 0x38));
LAB_18001c3b4:
if (iVar5 != 0) goto LAB_18001c3e3;
iVar5 = *(int *)(puVar19 + 0x44);
pUVar31 = *(PUCHAR *)(puVar19 + 0x60);
}
else if (uVar34 == 3) {
*(undefined **)(puVar19 + 0x28) = puVar19 + 0x44;
*(ushort **)(puVar19 + 0x20) = puVar26 + 1;
*(undefined8 *)(puVar19 + -8) = 0x1800309bf;
iVar5 = FUN_180075c88(param_1,pUVar31,UVar28,*(int *)(puVar19 + 0x4c),
*(BYTE **)(puVar19 + 0x20),*(uint **)(puVar19 + 0x28));
goto LAB_18001c3b4;
}
*(UCHAR *)puVar26 = (UCHAR)((uint)iVar5 >> 8);
*(undefined *)((longlong)puVar26 + 1) = puVar19[0x44];
**(int **)(puVar19 + 0x68) = *(int *)(puVar19 + 0x44) + 2 + ((int)puVar26 - (int)pUVar31);
}
}
LAB_18001c3e3:
if (*(int *)(puVar19 + 0x5c) != 0) {
*(undefined8 *)(puVar19 + -8) = 0x18001c3f5;
RevertToSelf();
}
LAB_18001c264:
*(undefined8 *)(puVar19 + -8) = 0x18001c274;
FUN_180028070(*(ulonglong *)(puVar19 + 0xc0) ^ (ulonglong)puVar19);
return;
}
=========================================
Function at address: 0x18001c410
Called functions addresses: 0xEXTERNAL:000000c0 0x180030ac4 0xEXTERNAL:000000c2 0x18001cbe0 0x18005d5d4 0x180030a4e 0x18002a7c0 0x18001c7b0


ulonglong FUN_18001c410(undefined8 param_1,longlong *param_2,uint *param_3,uint param_4,byte param_5
,longlong param_6,byte param_7,undefined8 *param_8,longlong *param_9,
int *param_10,undefined *param_11)

{
uint *puVar1;
uint uVar2;
uint *puVar3;
longlong *plVar4;
ulonglong uVar5;
undefined8 uVar6;
ulonglong *puVar7;
uint uVar8;
undefined *puVar9;
undefined8 *puVar10;
bool bVar11;
ulonglong local_res10;
undefined4 in_stack_ffffffffffffff60;
longlong *in_stack_ffffffffffffff68;
int *in_stack_ffffffffffffff70;
ulonglong *in_stack_ffffffffffffff78;
undefined in_stack_ffffffffffffff80;
undefined uVar12;
uint local_74;
uint local_70;
int local_6c;
int local_68;
longlong local_60;
undefined *local_58;
longlong local_50;
undefined *local_48;

if (((((param_2 == (longlong *)0x0) || (param_3 == (uint *)0x0)) || (param_4 == 0)) ||
((param_8 == (undefined8 *)0x0 || (param_9 == (longlong *)0x0)))) ||
((param_10 == (int *)0x0 || (param_11 == (undefined *)0x0)))) {
return 0x8009035d;
}
*param_10 = 0;
puVar7 = DAT_1800925b0;
*param_9 = 0;
if ((*(uint *)(param_2 + 0x11) >> 0x1d & 1) != 0) {
puVar7 = DAT_1800925b8;
}
*param_11 = 0;
*param_8 = 0;
local_58 = (undefined *)0x0;
local_50 = 0;
local_68 = 0;
uVar12 = 0;
if (puVar7 == (ulonglong *)0x0) {
LAB_180030b65:
uVar8 = 0x80090304;
}
else {
puVar9 = (undefined *)*puVar7;
uVar2 = *(uint *)(puVar7 + 1);
if ((puVar9 == (undefined *)0x0) || (uVar2 == 0)) goto LAB_180030b65;
bVar11 = (*(uint *)(param_2 + 8) & 0x1000) != 0;
local_70 = 0;
local_74 = 0;
if (param_5 == 0) {
LAB_18001c5c7:
local_48 = puVar9 + (ulonglong)uVar2 * 0x360;
puVar10 = DAT_180091000;
uVar8 = 0x80090331;
if (puVar9 < local_48) {
do {
uVar2 = *(uint *)(puVar9 + 0x1c);
local_60 = 0;
local_6c = 0;
local_res10 = local_res10 & 0xffffffffffffff00;
if ((uVar2 != 0) && (puVar1 = param_3 + param_4, puVar3 = param_3, param_3 < puVar1)) {
do {
if (uVar2 == *puVar3) {
if ((param_5 != 0) && (local_74 != uVar2)) {
uVar5 = FUN_180030a4e(puVar7,puVar1,(ulonglong)uVar2,(char)local_70,
in_stack_ffffffffffffff60,(char)in_stack_ffffffffffffff68,
(char)in_stack_ffffffffffffff70,
(char)in_stack_ffffffffffffff78,in_stack_ffffffffffffff80,
uVar12,bVar11);
return uVar5;
}
in_stack_ffffffffffffff78 = &local_res10;
in_stack_ffffffffffffff70 = &local_6c;
in_stack_ffffffffffffff68 = (longlong *)(ulonglong)local_70;
in_stack_ffffffffffffff60 =
CONCAT31((int3)((uint)in_stack_ffffffffffffff60 >> 8),param_7);
uVar8 = FUN_18001cbe0(puVar7,param_2,puVar9,param_5,param_6,param_7,local_70,
in_stack_ffffffffffffff70,
(undefined *)in_stack_ffffffffffffff78);
puVar10 = DAT_180091000;
if (uVar8 != 0) goto LAB_18001c639;
if (*(int *)(puVar9 + 0x30) == 4) {
*param_8 = puVar9;
goto LAB_18001c729;
}
in_stack_ffffffffffffff68 = &local_60;
in_stack_ffffffffffffff60 =
CONCAT31((int3)((uint)in_stack_ffffffffffffff60 >> 8),param_7);
plVar4 = FUN_18001c7b0(puVar7,param_2,puVar9,(ulonglong)param_5,param_6,param_7,
in_stack_ffffffffffffff68);
uVar8 = (uint)plVar4;
if (uVar8 == 0) {
*param_8 = puVar9;
*param_9 = local_60;
*param_10 = local_6c;
*param_11 = (undefined)local_res10;
goto LAB_18001c729;
}
puVar10 = DAT_180091000;
if (((uVar8 == 0x80090331) && (local_60 != 0)) && (local_58 == (undefined *)0x0)) {
local_50 = local_60;
local_68 = local_6c;
uVar12 = (undefined)local_res10;
local_58 = puVar9;
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar5 = FUN_180030ac4();
return uVar5;
}
goto LAB_18001c639;
}
puVar3 = puVar3 + 1;
} while (puVar3 < puVar1);
}
if (((undefined8 **)puVar10 != &DAT_180091000) &&
((*(byte *)((longlong)puVar10 + 0x1c) & 4) != 0)) {
puVar7 = (ulonglong *)puVar10[2];
FUN_180041d70(puVar7,0x26,&DAT_180085700,(wchar_t *)(puVar9 + 0x4a));
puVar10 = DAT_180091000;
}
uVar8 = 0x80090331;
LAB_18001c639:
puVar9 = puVar9 + 0x360;
} while (puVar9 < local_48);
if (uVar8 == 0) goto LAB_18001c729;
if (local_58 != (undefined *)0x0) {
uVar8 = 0;
*param_8 = local_58;
*param_9 = local_50;
*param_10 = local_68;
*param_11 = uVar12;
goto LAB_18001c729;
}
}
}
else {
local_res10 = 0;

if (local_res10 != 0) {
RtlAcquireResourceShared(local_res10 + 0x48);
if (bVar11) {
uVar6 = FUN_18005d5d4(local_res10,(undefined *)0x0,&local_70);
uVar8 = (uint)uVar6;
if (uVar8 != 0) {
RtlReleaseResource(local_res10 + 0x48);
goto LAB_1800309ee;
}
}
else if (*(longlong *)(local_res10 + 0xb0) == 0) {
local_74 = 0;
}
else {
local_74 = *(uint *)(*(longlong *)(local_res10 + 0xb0) + 0x1c);
}
puVar7 = (ulonglong *)(local_res10 + 0x48);
RtlReleaseResource();
goto LAB_18001c5c7;
}
uVar8 = 0x80090304;
}
}
LAB_1800309ee:
*param_8 = 0;
*param_9 = 0;
*param_10 = 0;
*param_11 = 0;
LAB_18001c729:
return (ulonglong)uVar8;
}
=========================================
Function at address: 0x18001c7b0
Called functions addresses: 0xEXTERNAL:000000c0 0x180041cdc 0xEXTERNAL:000000c2 0xEXTERNAL:00000075 0x180041cb0 0x180055510 0x1800228d0 0x18001b930 0x18002a7c0 0x180030b7a 0x1800567a8


longlong *
FUN_18001c7b0(undefined8 param_1,longlong *param_2,undefined *param_3,undefined8 param_4,
longlong param_5,char param_6,longlong *param_7)

{
longlong *plVar1;
int iVar2;
longlong *plVar3;
ulonglong *puVar4;
char cVar5;
undefined4 uVar6;
uint uVar7;
longlong lVar8;
undefined8 uVar9;
undefined4 extraout_var;
ulonglong uVar10;
undefined2 uVar11;
wchar_t *pwVar12;
longlong *plVar13;
longlong lVar14;
longlong *plVar15;
longlong *plVar16;
undefined *puVar17;
longlong *plVar18;
bool bVar19;
longlong *local_res10;
longlong local_80;
longlong *local_78;
ulonglong *local_70;
uint local_68;
uint local_64;
longlong *local_60;
uint *local_58;
longlong local_50;
longlong local_48;

if (((param_2 == (longlong *)0x0) || (param_3 == (undefined *)0x0)) ||
(param_7 == (longlong *)0x0)) {
return (longlong *)0x8009035d;
}
iVar2 = *(int *)(param_3 + 0x34);
plVar15 = (longlong *)0x80090331;
if ((iVar2 == 4) || (*(int *)(param_2 + 8) == 0x1000)) {
lVar14 = param_2[10];
local_80 = 0;
*param_7 = 0;
bVar19 = true;
if ((iVar2 == 4) && (bVar19 = true, *(char *)(lVar14 + 900) == '\0')) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return (longlong *)0x80090331;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return (longlong *)0x80090331;
}
uVar6 = FUN_180030b7a((longlong)DAT_180091000);
return (longlong *)CONCAT44(extraout_var,uVar6);
}
}
else {
lVar14 = param_2[10];
*param_7 = 0;
bVar19 = false;
}
local_80 = 0;
plVar16 = (longlong *)0x0;
plVar13 = param_2;
puVar17 = param_3;
if ((char)param_4 != '\0') {
plVar13 = &local_80;

if (local_80 == 0) {
return (longlong *)0x80090304;
}
}
lVar8 = local_80;
local_64 = *(uint *)(param_2 + 8);
local_78 = (longlong *)0x0;
if ((local_64 & 0x41400) != 0) {
local_78 = (longlong *)((longlong)param_2 + 0x1fe);
}
plVar18 = plVar16;
if ((*(char *)(lVar14 + 900) == '\0') || (!bVar19)) {
local_68 = *(uint *)(lVar14 + 0xc4);
local_58 = *(uint **)(lVar14 + 200);
local_50 = local_80;
if (*(char *)((longlong)param_2 + 0x39d) == '\0') {
local_78 = (longlong *)0x0;
}
bVar19 = (*(uint *)(param_2 + 0x11) >> 0x1b & 1) != 0;
local_60 = (longlong *)0x0;
local_70 = (ulonglong *)0x0;
local_res10 = (longlong *)((ulonglong)local_res10 & 0xffffffff00000000);
if (*(int *)(lVar14 + 0x1c) == 0) {
LAB_180030e4e:
plVar18 = plVar16;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_180030e7f;
uVar11 = 0x37;
}
else {
if ((*(byte *)(lVar14 + 0x9c) & 0x40) == 0) {
LAB_18001c91c:
local_48 = lVar14 + 0x30;
RtlAcquireResourceShared(local_48,1);
if (lVar8 != 0) {
RtlAcquireResourceShared(lVar8 + 0x48,1);
if (*(longlong *)(lVar8 + 0x150) != 0) {
local_70 = (ulonglong *)(*(longlong *)(lVar8 + 0x150) + 0x28);
local_res10 = (longlong *)CONCAT44(local_res10._4_4_,0x14);
}
}
puVar4 = local_70;
plVar13 = plVar16;
if (*(longlong **)(lVar14 + 0x20) != (longlong *)(lVar14 + 0x20)) {
iVar2 = (int)local_res10;
plVar18 = *(longlong **)(lVar14 + 0x20);
do {
plVar1 = plVar18 + -1;
plVar3 = (longlong *)*plVar18;
if ((puVar4 == (ulonglong *)0x0) ||
(((plVar18 != (longlong *)0xffffffffffffffe0 && (iVar2 == 0x14)) &&
(lVar8 = RtlCompareMemory(puVar4), lVar8 == 0x14)))) {
uVar9 = FUN_18001b930((longlong)plVar1,(longlong)param_3,(wchar_t *)0x0,local_64,
(longlong)local_78,local_58,local_68,param_5,param_6);
if ((int)uVar9 == 1) {
if ((plVar13 == (longlong *)0x0) ||
(cVar5 = *(char *)(plVar18 + 9), (bool)cVar5 != bVar19)) {
cVar5 = *(char *)(plVar18 + 9);
plVar13 = plVar1;
plVar15 = plVar16;
}
lVar8 = local_50;
if ((bool)cVar5 != bVar19) break;
}
else if (((int)uVar9 == 2) && (local_60 == (longlong *)0x0)) {
local_60 = plVar1;
}
}
plVar18 = plVar3;
lVar8 = local_50;
} while (plVar3 != (longlong *)(lVar14 + 0x20));
}
uVar7 = (uint)plVar15;
if (lVar8 != 0) {
RtlReleaseResource(lVar8 + 0x48);
}
RtlReleaseResource(local_48);
plVar18 = local_60;
if (plVar13 != (longlong *)0x0) {
plVar18 = plVar13;
}
if (uVar7 == 0) goto LAB_18001caa5;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar17 = &DAT_180082b38;
plVar13 = (longlong *)0x25;
FUN_180041cb0(DAT_180091000[2],0x25,&DAT_180082b38);
}
uVar7 = FUN_180055510(lVar14,plVar13,puVar17,param_4);
if (uVar7 == 0) goto LAB_18001c91c;
plVar15 = (longlong *)(ulonglong)uVar7;
}
if ((uVar7 != 0x80090331) || (plVar18 == (longlong *)0x0)) goto LAB_180030e4e;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_180030e7f;
uVar11 = 0x36;
plVar16 = plVar18;
}
FUN_180041cb0(DAT_180091000[2],uVar11,&DAT_180085700);
plVar18 = plVar16;
}
else {
local_70 = *(ulonglong **)(param_3 + 0x350);
if (local_70 == (ulonglong *)0x0) {
return (longlong *)0x80090304;
}
pwVar12 = (wchar_t *)*local_70;
if (pwVar12 + (ulonglong)*(uint *)(local_70 + 1) * 0x186 <= pwVar12) {
return (longlong *)0x80090331;
}
do {
uVar10 = FUN_1800228d0((longlong)param_2,*(uint *)(pwVar12 + 0x182));
plVar15 = (longlong *)(uVar10 & 0xffffffff);
if ((int)uVar10 == 0) {
plVar15 = local_78;
if (*(char *)((longlong)param_2 + 0x39d) == (char)uVar10) {
plVar15 = plVar16;
}
local_res10 = (longlong *)0x0;
uVar7 = FUN_1800567a8(param_2[10],(longlong)param_3,pwVar12,
(ulonglong)*(uint *)(param_2 + 8),
(byte)((uint)*(undefined4 *)(param_2 + 0x11) >> 0x1b) & 1,
(longlong)plVar15,*(uint **)(lVar14 + 200),*(uint *)(lVar14 + 0xc4),
param_5,param_6,local_80,&local_res10);
plVar15 = (longlong *)(ulonglong)uVar7;
if (uVar7 == 0) {
*param_7 = (longlong)local_res10;
return plVar15;
}
if (((uVar7 == 0x80090331) && (plVar18 == (longlong *)0x0)) &&
(local_res10 != (longlong *)0x0)) {
plVar18 = local_res10;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x38,&DAT_180085700,*(undefined4 *)(pwVar12 + 0x182));
plVar18 = local_res10;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x39,&DAT_180085700,*(undefined4 *)(pwVar12 + 0x182));
}
}
pwVar12 = pwVar12 + 0x186;
} while (pwVar12 < (wchar_t *)((ulonglong)*(uint *)(local_70 + 1) * 0x30c + *local_70));
}
LAB_180030e7f:
if ((int)plVar15 == 0) {
return plVar15;
}
if (plVar18 == (longlong *)0x0) {
return plVar15;
}
plVar15 = (longlong *)0x80090331;
LAB_18001caa5:
*param_7 = (longlong)plVar18;
return plVar15;
}
=========================================
Function at address: 0x18001cb30
Called functions addresses: 0x180078140 0x18006e97c 0x18001e0c0 0x180078668 0x180030ea4 0x180078428


ulonglong FUN_18001cb30(longlong param_1,int param_2,byte *param_3,ushort param_4)

{
uint uVar1;
undefined4 uVar2;
int iVar3;
ulonglong uVar4;
undefined4 extraout_var;
undefined4 extraout_var_00;
short sVar5;
uint uVar6;

uVar6 = *(uint *)(param_1 + 0x10) & 0xff;
uVar1 = param_2 << 8 | uVar6;
if (0x2900 < uVar1) {
if (uVar1 == 0x2901) {
iVar3 = FUN_180078140(param_1,param_3,param_4);
return CONCAT44(extraout_var_00,iVar3);
}
if (uVar1 == 0x2b01) {
uVar2 = FUN_180078668(param_1,param_3,param_4);
return CONCAT44(extraout_var,uVar2);
}
if (uVar1 == 0x2d01) {
uVar4 = FUN_180078428(param_1,param_3,param_4);
return uVar4;
}
if (uVar1 == 0x3101) {
if (param_4 != 0) {
return 0x80090308;
}
*(undefined *)(*(longlong *)(param_1 + 0x28) + 0x5e2) = 1;
return 0;
}
if (uVar1 == 0x3301) {
uVar4 = FUN_180030ea4(param_1);
return uVar4;
}
}
sVar5 = (short)param_2;
if (((sVar5 != 0x39) && (sVar5 != -0x5b)) ||
(uVar4 = FUN_18006e97c(*(longlong *)(param_1 + 0x28) + 1000,sVar5,uVar6,(longlong)param_3,
param_4), (int)uVar4 == 0)) {
uVar4 = FUN_18001e0c0(param_1,param_2,param_3,param_4);
}
return uVar4;
}
=========================================
Function at address: 0x18001cbe0
Called functions addresses: 0x180007410 0x180041dd8 0x18005c734 0x180059d04 0x18001e850 0x18005a174 0x180041d70


int FUN_18001cbe0(undefined8 param_1,longlong *param_2,undefined *param_3,char param_4,
longlong param_5,byte param_6,int param_7,int *param_8,undefined *param_9)

{
wchar_t *pwVar1;
undefined **ppuVar2;
uint uVar3;
uint uVar4;
uint uVar5;
uint uVar6;
uint uVar7;
uint uVar8;
longlong lVar9;
int *piVar10;
ulonglong uVar11;
uint *puVar12;
undefined8 *puVar13;
undefined8 uVar14;
int iVar15;
uint uVar16;
int iVar17;
char cVar18;
byte bVar19;
uint local_res8;

if ((((param_2 == (longlong *)0x0) || (param_3 == (undefined *)0x0)) || (param_8 == (int *)0x0))
|| (param_9 == (undefined *)0x0)) {
return -0x7ff6fca3;
}
lVar9 = param_2[10];
uVar3 = *(uint *)(lVar9 + 0xc4);
puVar12 = *(uint **)(lVar9 + 200);
uVar16 = *(uint *)(lVar9 + 0xa4);
uVar4 = *(uint *)(lVar9 + 0xa8);
uVar5 = *(uint *)(lVar9 + 0xc0);
pwVar1 = (wchar_t *)(param_3 + 0x4a);
uVar6 = *(uint *)(param_2 + 8);
uVar7 = *(uint *)(lVar9 + 0x9c);
uVar8 = *(uint *)(lVar9 + 0xb0);
local_res8 = 1;
piVar10 = *(int **)(lVar9 + 0xb8);
*param_8 = 0;
*param_9 = 0;
uVar11 = FUN_180007410(&DAT_180092420,piVar10,(ulonglong)uVar8,uVar5,
(uint)((uVar7 >> 0xc & 1) != 0),uVar7 & 0x800,uVar4,uVar16,uVar6,
(longlong)param_3,param_5,puVar12,uVar3,param_6);
if ((char)uVar11 == '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x29,&DAT_180085700,pwVar1);
}
LAB_180030f68:
iVar17 = -0x7ff6fccf;
}
else {
iVar17 = *(int *)(param_3 + 0x30);
if (iVar17 != 4) {
if (*(int *)((longlong)param_2 + 0x44) == 0x47) {
if (((*(byte *)(param_2 + 4) & 1) == 0) || (param_2[1] == 0)) {
iVar15 = 0;
}
else {
iVar15 = *(int *)(param_2[1] + 0x1c);
}
if (*(int *)(param_3 + 0x1c) != iVar15) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x2a,&DAT_180085700,pwVar1);
return -0x7ff6fccf;
}
goto LAB_180030f68;
}
}
uVar3 = *(uint *)(param_2 + 8);
if (((uVar3 & 0x40400) != 0) && (param_2 != (longlong *)0xfffffffffffffe02)) {
iVar15 = *(int *)(param_3 + 0x24);
if (iVar15 == 0x2400) {
LAB_18001cd5d:
uVar16 = 1;
LAB_18001cd62:
bVar19 = 0;
puVar12 = &DAT_18007c3a8;
do {
if (((((puVar12[1] == uVar16) && ((*puVar12 & uVar3) != 0)) &&
(((uVar3 & 0x3000) == 0 || ((puVar12[1] != 3 || (puVar12[10] == 0)))))) &&
(bVar19 < 0xc)) &&
(uVar16 = local_res8, (*(ushort *)(param_2 + 0x44) >> (bVar19 & 0x1f) & 1) != 0))
goto LAB_18001cdb9;
bVar19 = bVar19 + 1;
ppuVar2 = (undefined **)(puVar12 + 0xc);
puVar12 = puVar12 + 0x12;
} while (ppuVar2 < &PTR_FUN_18007c6f0);
}
else {
if (iVar15 == 0x2200) {
uVar16 = 2;
local_res8 = 2;
goto LAB_18001cd62;
}
if (iVar15 == 0x2203) {
uVar16 = 3;
local_res8 = 3;
goto LAB_18001cd62;
}
if (iVar15 == 0xa400) goto LAB_18001cd5d;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041dd8(DAT_180091000[2],0x2b,&DAT_180085700,pwVar1,(char)iVar15);
return -0x7ff6fccf;
}
goto LAB_180030f68;
}
LAB_18001cdb9:
if ((uVar3 >> 0xc & 1) == 0) {
cVar18 = '\0';
}
else {
cVar18 = '\x01';
if (param_4 != '\0') {
cVar18 = '\x01';
puVar13 = FUN_180059d04(*(int *)(param_3 + 0x2c));
if (puVar13 == (undefined8 *)0x0) {
return 0x54f;
}
if (param_7 != *(int *)(puVar13 + 4)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18005a174(DAT_180091000[2],0x2c,&DAT_180085700,pwVar1,(char)param_7);
return -0x7ff6fccf;
}
goto LAB_180030f68;
}
}
}
if ((iVar17 == 3) || (cVar18 != '\0')) {
uVar11 = FUN_18001e850((ulonglong)param_6,param_2,param_3,param_4,param_6,param_5,param_8,
param_9);
iVar17 = (int)uVar11;
if (iVar17 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar17;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return iVar17;
}
FUN_180041dd8(DAT_180091000[2],0x2d,&DAT_180085700,(wchar_t *)(param_3 + 0x4a),
(char)uVar11);
return iVar17;
}
}
else if ((iVar17 == 2) &&
(uVar14 = FUN_18005c734(*(uint **)(lVar9 + 200),*(uint *)(lVar9 + 0xc4),0,param_5,
param_6), (char)uVar14 != '\0')) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x2e,&DAT_180085700,pwVar1);
return -0x7ff6fccf;
}
goto LAB_180030f68;
}
}
iVar17 = 0;
}
return iVar17;
}
=========================================
Function at address: 0x18001ce80
Called functions addresses: 0x18003136f 0xEXTERNAL:00000088 0xEXTERNAL:000000c2 0xEXTERNAL:0000010c 0xEXTERNAL:00000075 0xEXTERNAL:0000018b 0x180028070 0x18002a7c0 0x180003d20 0x18001d8eb 0x18002a77b 0x18001b0b0 0xEXTERNAL:000000c0 0x180028d90 0x180003ce4 0x1800077a0 0xEXTERNAL:000000bc 0x18002a76f


/* WARNING: Removing unreachable block (ram,0x00018001d2b7) */
/* WARNING: Removing unreachable block (ram,0x00018003131e) */
/* WARNING: Removing unreachable block (ram,0x00018001d2c0) */
/* WARNING: Removing unreachable block (ram,0x000180031325) */
/* WARNING: Removing unreachable block (ram,0x00018001d2d5) */
/* WARNING: Removing unreachable block (ram,0x00018001db55) */
/* WARNING: Removing unreachable block (ram,0x00018001d2e5) */
/* WARNING: Removing unreachable block (ram,0x00018001d303) */
/* WARNING: Removing unreachable block (ram,0x00018003132c) */
/* WARNING: Removing unreachable block (ram,0x00018001d334) */
/* WARNING: Removing unreachable block (ram,0x00018001d356) */
/* WARNING: Removing unreachable block (ram,0x00018001d35a) */
/* WARNING: Removing unreachable block (ram,0x00018001d35e) */
/* WARNING: Removing unreachable block (ram,0x00018001d393) */
/* WARNING: Removing unreachable block (ram,0x00018001d3bc) */
/* WARNING: Removing unreachable block (ram,0x00018001db64) */
/* WARNING: Removing unreachable block (ram,0x00018001db6a) */
/* WARNING: Removing unreachable block (ram,0x00018001d3d8) */
/* WARNING: Removing unreachable block (ram,0x00018001d3e0) */
/* WARNING: Removing unreachable block (ram,0x00018001d3ef) */
/* WARNING: Removing unreachable block (ram,0x00018001d40d) */
/* WARNING: Removing unreachable block (ram,0x00018001d41d) */
/* WARNING: Removing unreachable block (ram,0x00018001d45f) */
/* WARNING: Removing unreachable block (ram,0x00018001d49b) */
/* WARNING: Removing unreachable block (ram,0x00018001d475) */
/* WARNING: Removing unreachable block (ram,0x00018001d4b3) */
/* WARNING: Removing unreachable block (ram,0x00018001d4c6) */
/* WARNING: Removing unreachable block (ram,0x000180031351) */
/* WARNING: Removing unreachable block (ram,0x00018001d4d0) */
/* WARNING: Removing unreachable block (ram,0x00018001d4d5) */
/* WARNING: Removing unreachable block (ram,0x00018001d4e9) */
/* WARNING: Removing unreachable block (ram,0x00018001d4f6) */
/* WARNING: Removing unreachable block (ram,0x00018001d4fd) */
/* WARNING: Removing unreachable block (ram,0x00018001d8ba) */
/* WARNING: Removing unreachable block (ram,0x00018001d8da) */
/* WARNING: Removing unreachable block (ram,0x00018003138e) */
/* WARNING: Removing unreachable block (ram,0x00018001d511) */
/* WARNING: Removing unreachable block (ram,0x000180031380) */
/* WARNING: Removing unreachable block (ram,0x00018001d52a) */
/* WARNING: Removing unreachable block (ram,0x00018001d533) */
/* WARNING: Removing unreachable block (ram,0x00018001d538) */
/* WARNING: Removing unreachable block (ram,0x00018001d549) */
/* WARNING: Removing unreachable block (ram,0x00018001d559) */

void FUN_18001ce80(longlong *param_1,void *param_2,uint param_3,char param_4,byte *param_5)

{
int *piVar1;
undefined4 uVar2;
longlong *plVar3;
ulonglong uVar4;
code *pcVar5;
byte bVar6;
bool bVar7;
NTSTATUS NVar8;
void *_Dst;
undefined8 uVar9;
longlong lVar10;
longlong lVar11;
undefined8 *puVar12;
undefined8 *puVar13;
uint uVar14;
longlong lVar15;
undefined8 *puVar16;
undefined uVar17;
longlong *plVar18;
ushort *puVar19;
byte bVar20;
undefined *puVar21;
undefined *puVar22;
undefined *puVar23;
ushort *puVar24;
undefined **ppuVar25;
longlong *plVar26;
longlong *plVar27;
int iVar28;
uint uVar29;
undefined uVar30;
uint *puVar31;
ulonglong uVar32;
longlong lVar33;
undefined auStackY_298 [8];
undefined auStackY_290 [24];
undefined4 uVar34;
undefined uVar35;
undefined in_stack_fffffffffffffda0;
char cVar36;
uint local_254;
undefined uVar37;
int iVar38;
undefined4 in_stack_fffffffffffffdb4;
uint *in_stack_fffffffffffffdb8;
undefined *local_230;
ushort *puVar39;
undefined4 uStack_210;
int iStack_20c;
undefined4 uStack_208;
undefined4 uStack_204;
undefined4 uStack_200;
undefined4 uStack_1fc;
undefined4 uStack_1f8;
undefined4 uStack_1f4;
undefined8 local_1d8;
undefined4 uStack_1d0;
undefined8 uStack_1cc;
ushort auStack_1c0 [20];
undefined local_198 [272];
undefined8 local_88;
undefined8 uStack_80;
undefined8 local_78;
undefined8 uStack_70;
uint local_68 [8];
ulonglong local_48;

puVar22 = auStackY_298;
puVar23 = auStackY_298;
local_48 = DAT_180091970 ^ (ulonglong)auStackY_298;
uVar32 = (ulonglong)param_3;
local_68[0] = 0;
local_68[1] = 0;
local_68[2] = 0;
local_68[3] = 0;
local_68[4] = 0;
local_68[5] = 0;
local_68[6] = 0;
local_68[7] = 0;
cVar36 = param_4;
memset(local_198,0,0x110);
lVar15 = DAT_1800927f0;
local_254 = 0x44;
lVar33 = 0xc;
uVar14 = 4;
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar14 = 0xc;
}
local_88 = 0;
uStack_80 = 0;
local_78 = 0;
uStack_70 = 0;
puVar21 = auStackY_298;
local_230 = local_198;
if (((param_2 == (void *)0x0) || (puVar21 = auStackY_298, param_3 < uVar14)) ||
(puVar21 = auStackY_298, param_5 == (byte *)0x0)) goto LAB_18001d88f;
*param_5 = 0;
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(uint *)(param_1 + 0x6d) = param_3;
if (*(longlong *)(param_1[0x10] + 0x18) == 0) {
if (DAT_180092620 == 0) {
_Dst = LocalAlloc(0x40,uVar32);
}
else {

}
}
else {

(*(longlong *)(param_1[0x10] + 0x18),uVar32,1);
}
param_1[0x6e] = (longlong)_Dst;
puVar21 = auStackY_298;
if (_Dst != (void *)0x0) {
memcpy(_Dst,param_2,(ulonglong)*(uint *)(param_1 + 0x6d));
iVar28 = param_3 - uVar14;
puVar24 = (ushort *)((longlong)param_2 + (ulonglong)uVar14);
iVar38 = iVar28;
puVar39 = puVar24;
if ((*(uint *)(param_1 + 8) & 0x40400) != 0) {
RtlAcquireResourceShared(&DAT_180092428);
*(undefined2 *)((longlong)param_1 + 0x1da) = 0;
*(undefined2 *)((longlong)param_1 + 0x1fc) = 0;
uVar14 = (uint)DAT_1800925e8;
if (uVar14 < 0x11) {
*(ushort *)((longlong)param_1 + 0x1da) = DAT_1800925e8;
*(undefined2 *)((longlong)param_1 + 0x1fc) = DAT_18009260a;
memcpy((void *)((longlong)param_1 + 0x1dc),&DAT_1800925ea,(ulonglong)uVar14 * 2);
}
RtlReleaseResource(&DAT_180092428);
in_stack_fffffffffffffdb8 = *(uint **)(param_1[10] + 200);
if ((in_stack_fffffffffffffdb8 != (uint *)0x0) &&
(uVar14 = *(uint *)(param_1[10] + 0xc4), uVar14 != 0)) {
ppuVar25 = &PTR_DAT_18007c3b0;
*(undefined2 *)((longlong)param_1 + 0x1da) = 0;
bVar20 = 0;
param_4 = cVar36;
iVar28 = iVar38;
puVar24 = puVar39;
do {
if (bVar20 < 0xc) {
uVar29 = 1 << (bVar20 & 0x1f);
if ((*(ushort *)((longlong)param_1 + 0x1fc) & uVar29) != 0) {
in_stack_fffffffffffffda0 = 1;
*(ushort *)((longlong)param_1 + 0x1fc) =
*(ushort *)((longlong)param_1 + 0x1fc) & ~(ushort)(1 << (bVar20 & 0x1f));
uVar9 = FUN_1800077a0(in_stack_fffffffffffffdb8,uVar14,4,(wchar_t *)ppuVar25[2],
(wchar_t *)0x0,0,0,'\x01');
if ((char)uVar9 == '\0') {
in_stack_fffffffffffffda0 = 1;
uVar9 = FUN_1800077a0(in_stack_fffffffffffffdb8,uVar14,4,(wchar_t *)*ppuVar25,
(wchar_t *)0x0,0,0,'\x01');
if ((((char)uVar9 == '\0') &&
((uVar29 & *(ushort *)((longlong)param_1 + 0x1fc)) == 0)) &&
(*(ushort *)((longlong)param_1 + 0x1da) < 0x10)) {
*(ushort *)
((longlong)param_1 +
(ulonglong)*(ushort *)((longlong)param_1 + 0x1da) * 2 + 0x1dc) =
(ushort)(&DAT_18007c390)[(ulonglong)bVar20 * 0x24] >> 8 |
(&DAT_18007c390)[(ulonglong)bVar20 * 0x24] << 8;
*(short *)((longlong)param_1 + 0x1da) = *(short *)((longlong)param_1 + 0x1da) + 1;
*(ushort *)((longlong)param_1 + 0x1fc) =
*(ushort *)((longlong)param_1 + 0x1fc) | (ushort)(1 << (bVar20 & 0x1f));
}
}
}
}
ppuVar25 = ppuVar25 + 9;
bVar20 = bVar20 + 1;
lVar33 = lVar33 + -1;
} while (lVar33 != 0);
puVar21 = auStackY_298;
cVar36 = param_4;
iVar38 = iVar28;
puVar39 = puVar24;
if (*(short *)((longlong)param_1 + 0x1da) == 0) goto LAB_18001d86d;
}
*(undefined *)((longlong)param_1 + 0x39d) = 0;
}
uVar37 = (undefined)iVar38;
uVar35 = SUB81(&local_254,0);
uVar34 = SUB84(&local_230,0);

if (iVar28 != 0) {
puVar21 = auStackY_298;
if ((iVar28 != -0x7ff6fcba) && (puVar21 = auStackY_298, iVar28 != -0x7ff6fc99)) {
FUN_18005b470(param_1,0x4b0,0x80090308,10);
puVar21 = auStackY_298;
}
goto LAB_18001d86d;
}
if (((ulonglong)param_1[0x11] >> 0x1b & 1) == 0) {
param_1[0x11] = param_1[0x11] & 0xffffffffffbfffff;
}
if ((*(uint *)(param_1 + 8) & 0x40400) != 0) {
if (*(char *)((longlong)param_1 + 0x39d) == '\0') {
auStack_1c0[0] = 0;
auStack_1c0[1] = 0;
auStack_1c0[2] = 0;
auStack_1c0[3] = 0;
auStack_1c0[4] = 0;
auStack_1c0[5] = 0;
auStack_1c0[6] = 0;
auStack_1c0[7] = 0;
auStack_1c0[8] = 0;
auStack_1c0[0x11] = 0;
auStack_1c0[9] = 0;
auStack_1c0[10] = 0;
auStack_1c0[0xb] = 0;
auStack_1c0[0xc] = 0;
auStack_1c0[0xd] = 0;
auStack_1c0[0xe] = 0;
auStack_1c0[0xf] = 0;
auStack_1c0[0x10] = 0;
FUN_18005e624(auStack_1c0);
FUN_18000eb08((ushort *)((longlong)param_1 + 0x1fe),(ushort *)((longlong)param_1 + 0x1da));
puVar24 = auStack_1c0;
FUN_18002a548((ushort *)((longlong)param_1 + 0x1fe),(longlong)puVar24,*(uint *)(param_1 + 8)
);
}
if (*(short *)((longlong)param_1 + 0x1fe) == 0) {
FUN_18005b470(param_1,0x4b6,0x80090331,0x28);
puVar21 = auStackY_298;
goto LAB_18001d86d;
}
}
if ((param_4 == '\0') || ((*(uint *)(param_1 + 0x11) >> 0x1b & 1) == 0)) goto LAB_18001d848;
uVar14 = *(uint *)(param_1 + 0x7b);
plVar18 = (longlong *)(ulonglong)uVar14;
if (uVar14 != 0) {
puVar24 = (ushort *)param_1[0x7a];
bVar7 = FUN_1800631d0(param_1,(undefined8 *)puVar24,uVar14,local_68,0);
*param_5 = bVar7;
lVar33 = param_1[0xf];
if ((lVar33 != 0) && (DAT_1800927ac != '\0')) {
*(ushort *)(lVar33 + 0x40) = *(ushort *)(lVar33 + 0x40) | 2;
*(undefined4 *)(lVar33 + 0x18) = 1;
}
}
bVar20 = *param_5;
if (bVar20 != 0) {
uVar32 = 0;
uVar14 = 0;
if (local_254 != 0) {
puVar24 = *(ushort **)(param_1[0x7c] + 0xb0);
do {
uVar14 = (uint)uVar32;
uVar29 = 0;
if (puVar24 != (ushort *)0x0) {
uVar29 = *(uint *)(puVar24 + 0xe);
}
plVar18 = (longlong *)(uVar32 * 4);
if (*(uint *)((longlong)plVar18 + (longlong)local_230) == uVar29) {
puVar31 = (uint *)((longlong)plVar18 + (longlong)local_230);
uVar2 = *(undefined4 *)((longlong)param_1 + 0x44);
uVar34 = (undefined4)CONCAT71((int7)((ulonglong)&local_230 >> 8),bVar20);
plVar18 = param_1;
bVar6 = 1;
iVar28 = FUN_18001b0b0(&DAT_180092420,param_1,puVar31,1,*(uint *)(param_1 + 8),bVar20);
bVar20 = bVar6;
uVar17 = SUB81(plVar18,0);
uVar30 = SUB81(puVar31,0);
if (iVar28 != 0) {
*(undefined2 *)(param_1 + 0xc) = 0;
*(undefined4 *)((longlong)param_1 + 0x44) = uVar2;
goto LAB_1800313a8;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x30,&DAT_180082bd8);
}
puVar24 = (ushort *)0x1;
param_1[0xb] = param_1[0x7c];
RtlAcquireResourceExclusive(param_1[0x7c] + 0x48);
lVar33 = param_1[0xb];
lVar11 = *(longlong *)(lVar33 + 0xb0);
lVar10 = *(longlong *)(lVar11 + 0x350);
if (lVar10 != 0) {
LOCK();
piVar1 = (int *)(*(longlong *)(lVar10 + 0x10) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
}
LOCK();
piVar1 = (int *)(*(longlong *)(lVar11 + 0x358) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
plVar18 = *(longlong **)(lVar33 + 0xb0);

lVar11 = param_1[1];
if (lVar11 != 0) {
if (*(longlong *)(lVar11 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar11 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar11 + 0x358));
}
if (param_1[3] != 0) {
LOCK();
piVar1 = (int *)(param_1[3] + 0x18);
iVar28 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar28 == 1) {
puVar24 = (ushort *)0x1;

}
param_1[3] = 0;
}
if (lVar10 == 0) goto LAB_18001d72a;
lVar11 = *plVar18;
puVar24 = (ushort *)0x1;
RtlAcquireResourceShared(lVar10 + 0x228);
uVar32 = 0;
if (*(uint *)(lVar10 + 0x60) == 0) goto LAB_18001d714;
puVar24 = *(ushort **)(lVar10 + 0x58);
goto LAB_18001d6f3;
}
uVar14 = uVar14 + 1;
uVar32 = (ulonglong)uVar14;
} while (uVar14 < local_254);
}
goto LAB_18001d83f;
}
goto code_r0x00018001d8eb;
}
goto LAB_18001d86d;
while (uVar29 = (int)uVar32 + 1, uVar32 = (ulonglong)uVar29, uVar29 < *(uint *)(lVar10 + 0x60)) {
LAB_18001d6f3:
if (*(longlong *)(*(longlong *)(puVar24 + uVar32 * 4) + 0x10) == lVar11) {
LOCK();
piVar1 = (int *)(*(longlong *)(puVar24 + uVar32 * 4) + 0x18);
*piVar1 = *piVar1 + 1;
UNLOCK();
param_1[3] = *(longlong *)(*(longlong *)(lVar10 + 0x58) + uVar32 * 8);
break;
}
}
LAB_18001d714:
RtlReleaseResource(lVar10 + 0x228);
LAB_18001d72a:
puVar19 = (ushort *)0x0;
if ((*(uint *)(param_1 + 8) & 0xf3f00) == 0) {
uStack_1d0 = *(undefined4 *)(plVar18 + 2);
local_1d8 = 0x14;
uStack_1cc = 0;
uVar2 = uVar34;
if (1 < *(uint *)((longlong)plVar18 + 0xc)) {
uStack_1cc = CONCAT44(1,*(uint *)((longlong)plVar18 + 0xc));
}
LAB_18001d76e:
uVar34 = uVar2;
if ((*(byte *)(param_1 + 4) & 1) != 0) {
puVar24 = (ushort *)(param_1 + 5);
lVar11 = RtlCompareMemory(&local_1d8,puVar24,0x14);
if (lVar11 != 0x14) goto LAB_18001d7a5;
}
*(undefined4 *)(param_1 + 5) = (undefined4)local_1d8;
*(undefined4 *)((longlong)param_1 + 0x2c) = local_1d8._4_4_;
*(undefined4 *)(param_1 + 6) = uStack_1d0;
*(undefined4 *)((longlong)param_1 + 0x34) = (undefined4)uStack_1cc;
*(undefined4 *)(param_1 + 7) = uStack_1cc._4_4_;
}
else {
puVar24 = (ushort *)(ulonglong)*(ushort *)((longlong)param_1 + 0x22);
uVar35 = 0;
uVar34 = 0x14;
iVar28 = SslLookupCipherLengths
(*plVar18,puVar24,*(undefined4 *)((longlong)plVar18 + 0x1c),
*(undefined4 *)(param_1 + 2));
uVar2 = 0x14;
if (iVar28 == 0) goto LAB_18001d76e;
}
LAB_18001d7a5:
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 1;
param_1[1] = (longlong)plVar18;
iVar28 = *(int *)(lVar33 + 0xb8);
bVar20 = (byte)iVar28;
*(int *)(param_1 + 2) = iVar28;
plVar18 = (longlong *)plVar18[0x6a];
if ((plVar18 != (longlong *)0x0) &&
(puVar31 = (uint *)(plVar18 + 1), puVar24 = puVar19, *puVar31 != 0)) {
plVar18 = (longlong *)*plVar18;
do {
if (*(int *)((longlong)plVar18 + (longlong)puVar19 * 0x30c + 0x304) == iVar28) {
lVar33 = (longlong)plVar18 + (longlong)puVar19 * 0x30c;
puVar24 = puVar19;
if (lVar33 != 0) {
*(undefined4 *)((longlong)param_1 + 0x14) = *(undefined4 *)(lVar33 + 0x308);
}
break;
}
uVar29 = (int)puVar19 + 1;
puVar19 = (ushort *)(ulonglong)uVar29;
puVar24 = puVar19;
} while (uVar29 < *puVar31);
}
RtlReleaseResource(param_1[0xb] + 0x48);
lVar33 = param_1[0xf];
if ((lVar33 != 0) && (DAT_1800927ac != '\0')) {
*(ushort *)(lVar33 + 0x40) = *(ushort *)(lVar33 + 0x40) | 4;
*(undefined4 *)(lVar33 + 0x18) = 1;
}
LAB_18001d83f:
uVar17 = SUB81(puVar24,0);
uVar30 = SUB81(plVar18,0);
if (uVar14 == local_254) {
LAB_1800313a8:
*(undefined *)(param_1[0x7c] + 0xec) = 0;

*param_5 = 0;
FUN_18001d8eb((char)param_1,uVar17,uVar30,bVar20,uVar34,uVar35,in_stack_fffffffffffffda0,cVar36,
uVar37,(char)in_stack_fffffffffffffdb8,in_stack_fffffffffffffdb4,lVar15,puVar39);
return;
}
LAB_18001d848:
puVar21 = auStackY_298;
if (*param_5 == 0) {
code_r0x00018001d8eb:
if ((((ulonglong)param_1[0x11] >> 0xb & 1) != 0) && (*(int *)(param_1 + 0x7b) != 0)) {
param_1[0x11] = param_1[0x11] | 0x400000;
}
NVar8 = BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,(PUCHAR)&local_88,0x20,2);
if ((NVar8 < 0) && (iVar28 = RtlNtStatusToDosError(NVar8), puVar21 = auStackY_298, iVar28 != 0))
goto LAB_18001d86d;
if ((DAT_1800927f0 != 0) &&
(lVar33 = (((local_88 & 0xffffffff) % (ulonglong)*(uint *)(DAT_1800927f0 + 0x10)) /
(ulonglong)*(uint *)(DAT_1800927f0 + 0x34)) * 0x98 +
*(longlong *)(DAT_1800927f0 + 0x28), lVar33 != 0)) {
RtlAcquireResourceExclusive(lVar33 + 0x30);
}
uVar34 = *(undefined4 *)(param_1 + 8);
uVar32 = (local_88 & 0xffffffff) % (ulonglong)*(uint *)(lVar15 + 0x10);
uStack_210 = (undefined4)uVar32;
iStack_20c = local_88._4_4_;
uStack_208 = (undefined4)uStack_80;
uStack_204 = uStack_80._4_4_;
uStack_200 = (undefined4)local_78;
uStack_1fc = local_78._4_4_;
uStack_1f8 = (undefined4)uStack_70;
uStack_1f4 = uStack_70._4_4_;
if (DAT_1800919f4 != -1) {
iStack_20c = DAT_1800919f4;
}
lVar33 = lVar15;

if (puVar12 == (undefined8 *)0x0) {
iVar28 = 0xe;
}
else {
FUN_180006b5c(puVar12,*(undefined4 *)(lVar15 + 0x18),&uStack_210);
*(undefined4 *)(puVar12 + 0x1b) = 0x80090325;
*puVar12 = &PTR_FUN_18007c330;
puVar12[0x2a] = 0;
puVar12[0x2b] = 0;
*(undefined4 *)(puVar12 + 0x2c) = 0;
iVar28 = *(int *)((longlong)puVar12 + 0x44);
if (iVar28 == 0) {
uVar14 = *(uint *)(lVar15 + 0x34);
uVar4 = uVar32 / uVar14;
plVar26 = (longlong *)(uVar4 * 0x98 + *(longlong *)(lVar33 + 0x28));
FUN_1800069c4(uVar4,(longlong)puVar12);
puVar12[0x1c] = plVar26;
plVar18 = puVar12 + 0x24;
lVar15 = (uVar32 % (ulonglong)uVar14) * 0x10 + *plVar26;
plVar3 = *(longlong **)(lVar15 + 8);
plVar27 = plVar26;
if (*plVar3 == lVar15) {
*plVar18 = lVar15;
plVar27 = plVar26 + 2;
puVar12[0x25] = plVar3;
*plVar3 = (longlong)plVar18;
*(longlong **)(lVar15 + 8) = plVar18;
puVar16 = puVar12 + 0x26;
puVar13 = (undefined8 *)plVar26[3];
if ((longlong *)*puVar13 != plVar27) goto LAB_18001da84;
}
else {
LAB_18001da84:
puVar16 = (undefined8 *)0x3;
pcVar5 = (code *)swi(0x29);
puVar13 = (undefined8 *)(*pcVar5)();
puVar22 = auStackY_290;
}
puVar16[1] = puVar13;
*puVar16 = plVar27;
*puVar13 = puVar16;
lVar15 = *(longlong *)(puVar22 + 0x70);
plVar27[1] = (longlong)puVar16;
LOCK();
*(int *)(lVar15 + 0x20) = *(int *)(lVar15 + 0x20) + 1;
UNLOCK();
*(undefined8 *)(puVar22 + -8) = 0x18001dab1;
LsaIModifyPerformanceCounter(4,0,0);
param_1[0x7c] = (longlong)puVar12;
iVar28 = 0;
*(undefined4 *)(puVar12 + 0x15) = uVar34;
puVar23 = puVar22;
}
else {
FUN_180018fc0(puVar12,1);
puVar23 = auStackY_298;
}
}
if ((DAT_1800927f0 != 0) &&
(lVar15 = (((local_88 & 0xffffffff) % (ulonglong)*(uint *)(DAT_1800927f0 + 0x10)) /
(ulonglong)*(uint *)(DAT_1800927f0 + 0x34)) * 0x98 +
*(longlong *)(DAT_1800927f0 + 0x28), lVar15 != 0)) {
*(undefined8 *)(puVar23 + -8) = 0x18001db02;
RtlReleaseResource(lVar15 + 0x30);
}
puVar21 = puVar23;
if (iVar28 != 0) goto LAB_18001d86d;
uVar34 = *(undefined4 *)(param_1 + 8);
uVar14 = *(uint *)(puVar23 + 0x44);
puVar31 = *(uint **)(puVar23 + 0x68);
param_1[0xb] = param_1[0x7c];
puVar23[0x28] = *param_5;
*(undefined4 *)(puVar23 + 0x20) = uVar34;
*(undefined8 *)(puVar23 + -8) = 0x18001db46;
iVar28 = FUN_18001b0b0(&DAT_180092420,param_1,puVar31,uVar14,*(uint *)(puVar23 + 0x20),
puVar23[0x28]);
if (iVar28 != 0) {
FUN_1800314b4();
return;
}
}
*(undefined *)((longlong)param_1 + 0x22b) = 0;
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
*(undefined8 *)(puVar21 + -8) = 0x1800314d6;
FUN_18006fe4c((longlong)param_1);
}
LAB_18001d86d:
param_1[0x7a] = 0;
*(undefined4 *)(param_1 + 0x7b) = 0;
if (*(undefined **)(puVar21 + 0x68) != local_198) {
*(undefined8 *)(puVar21 + -8) = 0x1800314f6;

}
LAB_18001d88f:
*(undefined8 *)(puVar21 + -8) = 0x18001d89e;
FUN_180028070(local_48 ^ (ulonglong)puVar21);
return;
}
=========================================
Function at address: 0x18001d8eb
Called functions addresses: 0x18001b0b0 0x1800314b4 0xEXTERNAL:000000c0 0x180006b5c 0xEXTERNAL:0000016f 0xEXTERNAL:0000018b 0xEXTERNAL:000000bc 0x1800069c4 0x18002a7c0


void FUN_18001d8eb(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
undefined4 param_5,undefined1 param_6,undefined param_7,undefined param_8,
undefined param_9,undefined param_10,undefined4 param_11,longlong param_12,
undefined8 param_13)

{
longlong *plVar1;
undefined4 uVar2;
uint uVar3;
longlong *plVar4;
uint *puVar5;
ulonglong uVar6;
ulonglong uVar7;
code *pcVar8;
NTSTATUS NVar9;
int iVar10;
undefined8 *puVar11;
undefined8 *puVar12;
longlong lVar13;
undefined8 *puVar14;
longlong unaff_RBP;
longlong *plVar15;
longlong *plVar16;
undefined *unaff_R13;
longlong *unaff_R14;
undefined auStackX_8 [32];

if ((((ulonglong)unaff_R14[0x11] >> 0xb & 1) != 0) && (*(int *)(unaff_R14 + 0x7b) != 0)) {
unaff_R14[0x11] = unaff_R14[0x11] | 0x400000;
}
NVar9 = BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,(PUCHAR)(unaff_RBP + 0x110),0x20,2);
if ((NVar9 < 0) && (iVar10 = RtlNtStatusToDosError(NVar9), iVar10 != 0)) goto LAB_18001d86d;
if ((DAT_1800927f0 != 0) &&
(lVar13 = (((ulonglong)*(uint *)(unaff_RBP + 0x110) %
(ulonglong)*(uint *)(DAT_1800927f0 + 0x10)) /
(ulonglong)*(uint *)(DAT_1800927f0 + 0x34)) * 0x98 +
*(longlong *)(DAT_1800927f0 + 0x28), lVar13 != 0)) {
RtlAcquireResourceExclusive(lVar13 + 0x30);
}
iVar10 = DAT_1800919f4;
uVar2 = *(undefined4 *)(unaff_R14 + 8);
uVar7 = (ulonglong)*(uint *)(unaff_RBP + 0x110) % (ulonglong)*(uint *)(param_12 + 0x10);
*(undefined4 *)(unaff_RBP + -0x78) = *(undefined4 *)(unaff_RBP + 0x110);
*(undefined4 *)(unaff_RBP + -0x74) = *(undefined4 *)(unaff_RBP + 0x114);
*(undefined4 *)(unaff_RBP + -0x70) = *(undefined4 *)(unaff_RBP + 0x118);
*(undefined4 *)(unaff_RBP + -0x6c) = *(undefined4 *)(unaff_RBP + 0x11c);
*(int *)(unaff_RBP + -0x78) = (int)uVar7;
*(undefined4 *)(unaff_RBP + -0x68) = *(undefined4 *)(unaff_RBP + 0x120);
*(undefined4 *)(unaff_RBP + -100) = *(undefined4 *)(unaff_RBP + 0x124);
*(undefined4 *)(unaff_RBP + -0x60) = *(undefined4 *)(unaff_RBP + 0x128);
*(undefined4 *)(unaff_RBP + -0x5c) = *(undefined4 *)(unaff_RBP + 300);
if (iVar10 != -1) {
*(int *)(unaff_RBP + -0x74) = iVar10;
}

if (puVar11 == (undefined8 *)0x0) {
iVar10 = 0xe;
}
else {
FUN_180006b5c(puVar11,*(undefined4 *)(param_12 + 0x18),(undefined4 *)(unaff_RBP + -0x78));
*(undefined4 *)(puVar11 + 0x1b) = 0x80090325;
*puVar11 = &PTR_FUN_18007c330;
puVar11[0x2a] = 0;
puVar11[0x2b] = 0;
*(undefined4 *)(puVar11 + 0x2c) = 0;
iVar10 = *(int *)((longlong)puVar11 + 0x44);
if (iVar10 == 0) {
uVar3 = *(uint *)(param_12 + 0x34);
uVar6 = uVar7 / uVar3;
plVar15 = (longlong *)(uVar6 * 0x98 + *(longlong *)(param_12 + 0x28));
FUN_1800069c4(uVar6,(longlong)puVar11);
puVar11[0x1c] = plVar15;
plVar1 = puVar11 + 0x24;
lVar13 = (uVar7 % (ulonglong)uVar3) * 0x10 + *plVar15;
plVar4 = *(longlong **)(lVar13 + 8);
plVar16 = plVar15;
if (*plVar4 == lVar13) {
*plVar1 = lVar13;
plVar16 = plVar15 + 2;
puVar11[0x25] = plVar4;
*plVar4 = (longlong)plVar1;
*(longlong **)(lVar13 + 8) = plVar1;
puVar14 = puVar11 + 0x26;
puVar12 = (undefined8 *)plVar15[3];
if ((longlong *)*puVar12 != plVar16) goto LAB_18001da84;
}
else {
LAB_18001da84:
puVar14 = (undefined8 *)0x3;
pcVar8 = (code *)swi(0x29);
puVar12 = (undefined8 *)(*pcVar8)();
register0x00000020 = (BADSPACEBASE *)auStackX_8;
}
puVar14[1] = puVar12;
*puVar14 = plVar16;
*puVar12 = puVar14;
lVar13 = *(longlong *)((longlong)register0x00000020 + 0x70);
plVar16[1] = (longlong)puVar14;
LOCK();
*(int *)(lVar13 + 0x20) = *(int *)(lVar13 + 0x20) + 1;
UNLOCK();
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001dab1;
LsaIModifyPerformanceCounter(4,0,0);
unaff_R14[0x7c] = (longlong)puVar11;
iVar10 = 0;
*(undefined4 *)(puVar11 + 0x15) = uVar2;
}
else {
FUN_180018fc0(puVar11,1);
}
}
if ((DAT_1800927f0 != 0) &&
(lVar13 = (((ulonglong)*(uint *)(unaff_RBP + 0x110) %
(ulonglong)*(uint *)(DAT_1800927f0 + 0x10)) /
(ulonglong)*(uint *)(DAT_1800927f0 + 0x34)) * 0x98 +
*(longlong *)(DAT_1800927f0 + 0x28), lVar13 != 0)) {
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001db02;
RtlReleaseResource(lVar13 + 0x30);
}
if (iVar10 == 0) {
uVar2 = *(undefined4 *)(unaff_R14 + 8);
uVar3 = *(uint *)((longlong)register0x00000020 + 0x44);
puVar5 = *(uint **)((longlong)register0x00000020 + 0x68);
unaff_R14[0xb] = unaff_R14[0x7c];
*(undefined *)((longlong)register0x00000020 + 0x28) = *unaff_R13;
*(undefined4 *)((longlong)register0x00000020 + 0x20) = uVar2;
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001db46;
iVar10 = FUN_18001b0b0(&DAT_180092420,unaff_R14,puVar5,uVar3,
*(uint *)((longlong)register0x00000020 + 0x20),
*(byte *)((longlong)register0x00000020 + 0x28));
if (iVar10 != 0) {
FUN_1800314b4();
return;
}
*(undefined *)((longlong)unaff_R14 + 0x22b) = 0;
if (*(char *)((longlong)unaff_R14 + 0xe9) != '\0') {
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x1800314d6;
FUN_18006fe4c((longlong)unaff_R14);
}
}
LAB_18001d86d:
unaff_R14[0x7a] = 0;
*(undefined4 *)(unaff_R14 + 0x7b) = 0;
if (*(longlong *)((longlong)register0x00000020 + 0x68) != unaff_RBP) {
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x1800314f6;

}
uVar7 = *(ulonglong *)(unaff_RBP + 0x150);
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001d89e;
FUN_180028070(uVar7 ^ (ulonglong)register0x00000020);
return;
}
=========================================
Function at address: 0x18001db80
Called functions addresses: 0xEXTERNAL:0000003f 0x180020df0 0x1800592e8 0xEXTERNAL:000000c2 0x18000629c 0x180028070 0x18002a7c0 0x180006300 0x18002a77b 0x18001b0b0 0xEXTERNAL:000000c0 0x180028d90 0x18000eb9c 0x18000a1f4 0x180041cb0 0x1800077a0 0x18005b470


/* WARNING: Removing unreachable block (ram,0x000180031678) */
/* WARNING: Removing unreachable block (ram,0x000180031847) */

void FUN_18001db80(longlong *param_1,void *param_2,uint param_3)

{
undefined4 uVar1;
ulonglong uBytes;
int iVar2;
void *_Dst;
undefined8 uVar3;
undefined2 *puVar4;
longlong lVar5;
uint uVar6;
uint *puVar7;
byte bVar8;
uint uVar9;
undefined **ppuVar10;
uint uVar11;
ushort uVar12;
longlong lVar13;
undefined auStackY_1d8 [32];
uint local_178 [68];
uint local_68 [8];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_1d8;
uBytes = (ulonglong)param_3;
lVar13 = 0xc;
uVar9 = 4;
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar9 = 0xc;
}
if (((param_2 == (void *)0x0) || (param_3 < uVar9)) || (param_1[10] == 0)) goto LAB_18001e092;
memset(local_178,0,0x110);
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(uint *)(param_1 + 0x6d) = param_3;
if (*(longlong *)(param_1[0x10] + 0x18) == 0) {
if (DAT_180092620 == 0) {
_Dst = LocalAlloc(0x40,uBytes);
}
else {

}
}
else {

(*(longlong *)(param_1[0x10] + 0x18),uBytes,1);
}
param_1[0x6e] = (longlong)_Dst;
if (_Dst == (void *)0x0) goto LAB_18001e092;
memcpy(_Dst,param_2,(ulonglong)*(uint *)(param_1 + 0x6d));
RtlAcquireResourceShared(&DAT_180092428);
*(undefined2 *)((longlong)param_1 + 0x1da) = 0;
*(undefined2 *)((longlong)param_1 + 0x1fc) = 0;
uVar6 = (uint)DAT_1800925e8;
if (uVar6 < 0x11) {
*(ushort *)((longlong)param_1 + 0x1da) = DAT_1800925e8;
*(undefined2 *)((longlong)param_1 + 0x1fc) = DAT_18009260a;
memcpy((void *)((longlong)param_1 + 0x1dc),&DAT_1800925ea,(ulonglong)uVar6 * 2);
}
RtlReleaseResource(&DAT_180092428);
puVar7 = *(uint **)(param_1[10] + 200);
if ((puVar7 != (uint *)0x0) && (uVar6 = *(uint *)(param_1[10] + 0xc4), uVar6 != 0)) {
ppuVar10 = &PTR_DAT_18007c3b0;
*(undefined2 *)((longlong)param_1 + 0x1da) = 0;
bVar8 = 0;
do {
if (bVar8 < 0xc) {
uVar11 = 1 << (bVar8 & 0x1f);
if ((*(ushort *)((longlong)param_1 + 0x1fc) & uVar11) != 0) {
*(ushort *)((longlong)param_1 + 0x1fc) =
*(ushort *)((longlong)param_1 + 0x1fc) & ~(ushort)(1 << (bVar8 & 0x1f));
uVar3 = FUN_1800077a0(puVar7,uVar6,4,(wchar_t *)ppuVar10[2],(wchar_t *)0x0,0,0,'\x01');
if ((((char)uVar3 == '\0') &&
(uVar3 = FUN_1800077a0(puVar7,uVar6,4,(wchar_t *)*ppuVar10,(wchar_t *)0x0,0,0,'\x01'),
(char)uVar3 == '\0')) &&
(((uVar11 & *(ushort *)((longlong)param_1 + 0x1fc)) == 0 &&
(*(ushort *)((longlong)param_1 + 0x1da) < 0x10)))) {
*(ushort *)
((longlong)param_1 + (ulonglong)*(ushort *)((longlong)param_1 + 0x1da) * 2 + 0x1dc) =
(ushort)(&DAT_18007c390)[(ulonglong)bVar8 * 0x24] >> 8 |
(&DAT_18007c390)[(ulonglong)bVar8 * 0x24] << 8;
*(short *)((longlong)param_1 + 0x1da) = *(short *)((longlong)param_1 + 0x1da) + 1;
*(ushort *)((longlong)param_1 + 0x1fc) =
*(ushort *)((longlong)param_1 + 0x1fc) | (ushort)(1 << (bVar8 & 0x1f));
}
}
}
ppuVar10 = ppuVar10 + 9;
bVar8 = bVar8 + 1;
lVar13 = lVar13 + -1;
} while (lVar13 != 0);
if (*(short *)((longlong)param_1 + 0x1da) == 0) goto LAB_18001e092;
}
*(undefined *)((longlong)param_1 + 0x39d) = 0;

(param_1,(longlong)param_2 + (ulonglong)uVar9,param_3 - uVar9,
(longlong)param_1 + 0x4e1);
lVar13 = DAT_1800927f0;
if (iVar2 != 0) {
if ((iVar2 != -0x7ff6fcba) && (iVar2 != -0x7ff6fc99)) {
FUN_18005b470(param_1,0x4b0,0x80090308,10);
}
goto LAB_18001e092;
}
if (param_1[10] == 0) goto LAB_18001e092;
if ((*(uint *)(param_1[10] + 0x98) & *(uint *)(param_1 + 8) & 0x51550) == 0) {
LAB_1800315c3:
FUN_18005b470(param_1,0xb,0x80090331,0x46);
goto LAB_18001e092;
}
if ((*(uint *)(param_1 + 8) >> 0xc & 1) != 0) {
*(undefined *)((longlong)param_1 + 0x501) = 0;
if (lVar13 != 0) {
while( true ) {
if ((*(uint *)(param_1 + 0x11) >> 0xf & 1) == 0) {
bVar8 = 1;
lVar5 = param_1[0x7c];
if (lVar5 == 0) goto LAB_18001e092;
}
else {
puVar7 = local_68;
bVar8 = 0;
local_68[0] = 0;
local_68[1] = 0;
local_68[2] = 0;
local_68[3] = 0;
local_68[4] = 0;
local_68[5] = 0;
local_68[6] = 0;
local_68[7] = 0;
uVar3 = FUN_18000eb9c((PUCHAR)puVar7,0x20);
if ((int)uVar3 != 0) goto LAB_18001e092;
FUN_18000629c(puVar7,(byte *)0x0,local_68);
lVar5 = lVar13;
iVar2 = FUN_1800592e8(lVar13,*(undefined4 *)(param_1 + 8),local_68,param_1 + 0x7c);
FUN_180006300(lVar5,(byte *)0x0,local_68);
if (iVar2 != 0) goto LAB_18001e092;
lVar5 = param_1[0x7c];
}
uVar1 = *(undefined4 *)((longlong)param_1 + 0x44);
param_1[0xb] = lVar5;
iVar2 = FUN_18001b0b0(&DAT_180092420,param_1,local_178,0x44,*(uint *)(param_1 + 8),bVar8);
if (bVar8 == 0) goto LAB_18001e092;
if (iVar2 == 0) break;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x41,&DAT_180082c30);
}
*(undefined2 *)(param_1 + 0xc) = 0;
*(undefined4 *)((longlong)param_1 + 0x44) = uVar1;
*(undefined *)(param_1[0x7c] + 0xec) = 0;
param_1[0x11] = param_1[0x11] | 0x8000;

param_1[0xb] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x40,&DAT_180082c30);
}
lVar13 = param_1[0xf];
if ((lVar13 != 0) && (DAT_1800927ac != '\0')) {
*(ushort *)(lVar13 + 0x40) = *(ushort *)(lVar13 + 0x40) | 4;
*(undefined4 *)(lVar13 + 0x18) = 1;
}
}
goto LAB_18001e092;
}
if (*(int *)((longlong)param_1 + 0x44) == 0x47) goto LAB_1800315c3;
param_1[0x11] = param_1[0x11] & 0xffffffffffff7fff;

if (lVar13 == 0) goto LAB_18001e092;
*(undefined8 *)(lVar13 + 8) = 0;
FUN_180020df0((undefined8 *)(lVar13 + 0x28),(longlong)param_1);
*(undefined ***)(lVar13 + 0x28) = &PTR_FUN_18007c6f0;
*(longlong *)(lVar13 + 0x3c8) = param_1[0x74];
*(longlong *)(lVar13 + 0x3d0) = param_1[0x75];
*(longlong *)(lVar13 + 0x3d8) = param_1[0x76];
*(undefined2 *)(lVar13 + 0x3e0) = *(undefined2 *)(param_1 + 0x77);
*(longlong *)(lVar13 + 1000) = param_1[0x78];
*(longlong *)(lVar13 + 0x3f0) = param_1[0x79];
*(longlong *)(lVar13 + 0x3f8) = param_1[0x7a];
*(undefined4 *)(lVar13 + 0x400) = *(undefined4 *)(param_1 + 0x7b);
*(undefined *)(lVar13 + 0x404) = *(undefined *)((longlong)param_1 + 0x3dc);
*(longlong *)(lVar13 + 0x408) = param_1[0x7c];
param_1[0x74] = 0;
param_1[0x75] = 0;
param_1[0x76] = 0;
*(undefined2 *)(param_1 + 0x77) = 0;
param_1[0x78] = 0;
param_1[0x79] = 0;
param_1[0x7a] = 0;
*(undefined4 *)(param_1 + 0x7b) = 0;
*(undefined *)((longlong)param_1 + 0x3dc) = 0;
param_1[0x7c] = 0;
if (DAT_180092dd8 == 0) {
if (DAT_180092de4 != '\0') {
puVar4 = (undefined2 *)FUN_18000a1f4(0x800);
*(undefined *)(lVar13 + 0x20) = 1;
iVar2 = 0x800;
goto LAB_18003161d;
}
}
else {

iVar2 = DAT_180092dc0;
LAB_18003161d:
if ((puVar4 != (undefined2 *)0x0) && (iVar2 != 0)) {
*(undefined8 *)(lVar13 + 0x418) = 0;
*(undefined8 *)(lVar13 + 0x410) = &PTR_FUN_18007d508;
uVar12 = (ushort)iVar2;
*(ushort *)(lVar13 + 0x420) = uVar12;
*(undefined4 *)(lVar13 + 0x422) = 0;
if (4 < uVar12) {
*(undefined2 **)(lVar13 + 0x418) = puVar4;
*puVar4 = 0;
*(ushort *)(*(longlong *)(lVar13 + 0x418) + 2) = uVar12 - 4;
}
*(undefined8 **)(lVar13 + 0x18) = (undefined8 *)(lVar13 + 0x410);
}
}
*(longlong *)(lVar13 + 8) = lVar13 + 0x28;
*(longlong *)(lVar13 + 0xa8) = lVar13;
*(undefined8 *)(param_1[0x10] + 0x10) = *(undefined8 *)(lVar13 + 8);
param_1[0x11] = param_1[0x11] | 0x40000;
LAB_18001e092:
FUN_180028070(local_48 ^ (ulonglong)auStackY_1d8);
return;
}
=========================================
Function at address: 0x18001e0c0
Called functions addresses: 0xEXTERNAL:0000003f 0x1800174c8 0xEXTERNAL:00000075 0x18001e185 0x180041d20 0x18002a7c0 0x18002a77b 0x180041cdc 0x180031d40 0x18002a548 0x180041cb0 0x180062c20 0x180062aa8 0x18005b470 0x18000eb08 0x18000ad34 0x180031e93 0x18002a76f


void FUN_18001e0c0(longlong param_1,int param_2,byte *param_3,ushort param_4)

{
uint *puVar1;
byte *pbVar2;
ulonglong *puVar3;
undefined8 *puVar4;
longlong *plVar5;
uint uVar6;
int iVar7;
ulonglong uVar8;
undefined **ppuVar9;
longlong lVar10;
HLOCAL pvVar11;
ulonglong uVar12;
ulonglong uVar13;
undefined8 uVar14;
longlong *plVar15;
uint uVar16;
byte *pbVar17;
byte *pbVar18;
byte bVar19;
byte bVar20;
ushort uVar21;
undefined2 uVar22;
ushort *puVar23;
undefined8 unaff_RBX;
ushort *puVar24;
byte *pbVar25;
byte *_Src;
undefined uVar26;
undefined uVar27;
undefined uVar28;
undefined *puVar29;
undefined uVar30;
undefined uVar31;
ulonglong uVar32;
byte *pbVar33;
byte *pbVar34;
undefined auStack_c8 [32];
undefined in_stack_ffffffffffffff60;
undefined uVar35;
ushort in_stack_ffffffffffffff68;
uint local_94;
byte *_Dst;
undefined uVar36;
undefined8 in_stack_ffffffffffffff78;
longlong *plVar37;
undefined uVar38;
byte *in_stack_ffffffffffffff80;
undefined uVar39;
longlong lVar40;
ushort local_68;
ushort local_66 [19];

uVar38 = SUB81(in_stack_ffffffffffffff80,0);
uVar36 = (undefined)in_stack_ffffffffffffff78;
uVar35 = (undefined)in_stack_ffffffffffffff68;
uVar13 = (ulonglong)param_4;
uVar31 = (undefined)param_4;
uVar30 = (undefined)param_2;
uVar8 = DAT_180091970 ^ (ulonglong)auStack_c8;
pbVar34 = (byte *)0x0;
_Dst = (byte *)0x0;
if (param_2 == 0xff01) {
plVar15 = *(longlong **)(param_1 + 8);
if ((*(int *)(plVar15 + 0x34) != 0) && (*(char *)((longlong)plVar15 + 0x229) == '\0')) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x40,&DAT_180082c68);
plVar15 = *(longlong **)(param_1 + 8);
}
FUN_18005b470(plVar15,0x4b7,0x80090346,0x28);
lVar10 = *(longlong *)(param_1 + 8);
*(undefined4 *)(lVar10 + 0x44) = 0x60;
*(undefined2 *)(lVar10 + 0x60) = 0x2802;
goto LAB_18001e187;
}
*(undefined *)((longlong)plVar15 + 0x229) = 1;
plVar15 = *(longlong **)(param_1 + 8);
uVar6 = *(uint *)(plVar15 + 0x34);
if (param_4 == 0) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18001e187;
uVar22 = 0x41;
goto LAB_180031e1e;
}
uVar16 = (uint)*param_3;
if ((ushort)(*param_3 + 1) != param_4) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0)) {
FUN_180041d20(DAT_180091000[2],0x42,&DAT_180082c68,uVar16,uVar31);
}
goto LAB_18001e187;
}
if (param_4 == 1) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x43,&DAT_180082c68);
}
if (uVar6 != 0) {
FUN_180031e93((longlong)DAT_180091000);
return;
}
goto LAB_18001e187;
}
if (uVar16 == uVar6) {
lVar10 = param_1;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0) {
FUN_180041cb0(DAT_180091000[2],0x46,&DAT_180082c68);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x800) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x47,&DAT_180082c68);
}
}
puVar4 = DAT_180091000;
uVar28 = (undefined)lVar10;
uVar30 = SUB81(_Dst,0);
iVar7 = memcmp(param_3 + 1,(void *)((longlong)plVar15 + 0x179),(ulonglong)uVar6);
if (iVar7 == 0) {
uVar27 = 1;
uVar26 = 1;
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
FUN_18000ad34(lVar10,1,0xff01);
FUN_18001e185((char)lVar10,uVar27,uVar26,uVar31,in_stack_ffffffffffffff60,uVar35,uVar30,
uVar36,uVar38,uVar28,uVar8,unaff_RBX);
return;
}
if (((undefined8 **)puVar4 != &DAT_180091000) &&
((*(byte *)((longlong)puVar4 + 0x1c) & 1) != 0)) {
FUN_180041cb0(puVar4[2],0x48,&DAT_180082c68);
}
LAB_180031edf:
plVar15 = *(longlong **)(param_1 + 8);
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041d20(DAT_180091000[2],0x45,&DAT_180082c68,uVar16,(char)uVar6);
goto LAB_180031edf;
}
FUN_18005b470(plVar15,0x4b7,0x80090346,0x28);
lVar10 = *(longlong *)(param_1 + 8);
*(undefined4 *)(lVar10 + 0x44) = 0x60;
*(undefined2 *)(lVar10 + 0x60) = 0x2802;
goto LAB_18001e187;
}
uVar27 = 0;
uVar26 = 0;
uVar28 = (undefined)
(&switchD_18001e135::switchdataD_18001e7ec)
[(&switchD_18001e135::switchdataD_18001e81c)[param_2]];
uVar39 = (undefined)param_1;
switch(param_2) {
case 0:
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x50);
lVar40 = param_1;
uVar14 = FUN_180075fac(param_1,param_3,(uint)param_4);
uVar28 = (undefined)lVar40;
uVar30 = SUB81(_Dst,0);
if (((int)uVar14 == 0) && ((*(uint *)(lVar10 + 0x9c) & 0x100) != 0)) {
puVar3 = (ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
*puVar3 = *puVar3 | 0x200000;
}
uVar26 = 0;
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
uVar27 = 1;
FUN_18000ad34(lVar10,1,0);
FUN_18001e185((char)lVar10,uVar27,uVar26,uVar31,in_stack_ffffffffffffff60,uVar35,uVar30,uVar36,
uVar38,uVar28,uVar8,unaff_RBX);
return;
default:
uVar28 = 0;
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
FUN_1800174c8(lVar10,param_2);
FUN_18001e185((char)lVar10,uVar30,uVar28,uVar31,in_stack_ffffffffffffff60,uVar35,(char)_Dst,
uVar36,uVar38,(char)param_1,uVar8,unaff_RBX);
return;
case 5:
if ((param_4 != 0) && (*param_3 == 1)) {
uVar30 = 1;
puVar3 = (ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
*puVar3 = *puVar3 | 0x20000;
uVar28 = 5;
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
FUN_18000ad34(lVar10,1,5);
FUN_18001e185((char)lVar10,uVar30,uVar28,uVar31,in_stack_ffffffffffffff60,uVar35,(char)_Dst,
uVar36,uVar38,(char)param_1,uVar8,unaff_RBX);
return;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
uVar14 = DAT_180091000[2];
uVar28 = 0x68;
uVar30 = 0x38;
FUN_180041cb0(uVar14,0x38,&DAT_180082c68);
FUN_18001e185((char)uVar14,uVar30,uVar28,uVar31,in_stack_ffffffffffffff60,uVar35,(char)_Dst,
uVar36,uVar38,(char)param_1,uVar8,unaff_RBX);
return;
}
break;
case 6:
bVar20 = *param_3;
pbVar25 = param_3 + 1;
if ((uint)bVar20 == param_4 - 1) {
lVar10 = param_1;
if (bVar20 != 0) {
do {
if (*pbVar25 == 0x40) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x36,&DAT_180082c68);
}
*(undefined *)(*(longlong *)(param_1 + 8) + 0x39a) = 1;
break;
}
uVar6 = (int)pbVar34 + 1;
pbVar34 = (byte *)(ulonglong)uVar6;
pbVar25 = pbVar25 + 1;
} while (uVar6 < bVar20);
}
uVar26 = (undefined)lVar10;
uVar27 = SUB81(_Dst,0);
uVar30 = 1;
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
uVar28 = 6;
FUN_18000ad34(lVar10,1,6);
FUN_18001e185((char)lVar10,uVar30,uVar28,uVar31,in_stack_ffffffffffffff60,uVar35,uVar27,uVar36
,uVar38,uVar26,uVar8,unaff_RBX);
return;
}
break;
case 10:
uVar6 = (uint)param_4;
if (1 < uVar6) {
bVar20 = param_3[1];
pbVar25 = param_3 + 2;
lVar10 = *(longlong *)(param_1 + 8);
uVar21 = CONCAT11(*param_3,bVar20);
lVar40 = param_1;
if (*(longlong *)(lVar10 + 0x390) != 0) {
uVar27 = 0;

lVar10 = *(longlong *)(param_1 + 8);
}
uVar32 = (ulonglong)uVar21;
if (*(longlong *)(*(longlong *)(lVar10 + 0x80) + 0x18) == 0) {
if (DAT_180092620 == (byte *)0x0) {
pvVar11 = LocalAlloc(0x40,uVar32);
bVar19 = (byte)uVar32;
}
else {

bVar19 = (byte)uVar32;
}
}
else {
uVar27 = 1;

bVar19 = (byte)uVar32;
}
uVar28 = (undefined)lVar40;
uVar38 = SUB81(in_stack_ffffffffffffff80,0);
uVar36 = (undefined)in_stack_ffffffffffffff78;
uVar35 = SUB81(_Dst,0);
uVar31 = (undefined)in_stack_ffffffffffffff68;
uVar30 = (undefined)uVar13;
*(HLOCAL *)(*(longlong *)(param_1 + 8) + 0x390) = pvVar11;
lVar10 = *(longlong *)(param_1 + 8);
if ((((*(longlong *)(lVar10 + 0x390) != 0) && (1 < uVar21)) && (uVar6 - 2 == (uint)uVar21)) &&
((bVar20 & 1) == 0)) {
if (1 < uVar6 - 2) {
uVar32 = (ulonglong)((uVar6 - 4 >> 1) + 1);
do {
puVar29 = (undefined *)((longlong)pbVar34 * 2);
bVar19 = pbVar25[1];
*(ushort *)(puVar29 + *(longlong *)(*(longlong *)(param_1 + 8) + 0x390)) =
CONCAT11(*pbVar25,bVar19);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar24 = (ushort *)(puVar29 + *(longlong *)(*(longlong *)(param_1 + 8) + 0x390));
uVar13 = (ulonglong)*puVar24;
bVar19 = 0x1b;
puVar29 = &DAT_180082c68;
FUN_180041cdc(DAT_180091000[2],0x1b,&DAT_180082c68,(uint)*puVar24);
}
uVar28 = (undefined)lVar40;
uVar38 = SUB81(in_stack_ffffffffffffff80,0);
uVar36 = (undefined)in_stack_ffffffffffffff78;
uVar35 = SUB81(_Dst,0);
uVar31 = (undefined)in_stack_ffffffffffffff68;
uVar30 = (undefined)uVar13;
uVar27 = SUB81(puVar29,0);
pbVar34 = (byte *)(ulonglong)((int)pbVar34 + 1);
pbVar25 = pbVar25 + 2;
uVar32 = uVar32 - 1;
} while (uVar32 != 0);
lVar10 = *(longlong *)(param_1 + 8);
}
*(ushort *)(lVar10 + 0x398) = uVar21 >> 1;
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
if ((lVar10 != 0) && (DAT_1800927ac != '\0')) {
*(uint *)(lVar10 + 0x48) = *(uint *)(lVar10 + 0x48) | 0x80;
FUN_18001e185((char)lVar10,bVar19,uVar27,uVar30,in_stack_ffffffffffffff60,uVar31,uVar35,
uVar36,uVar38,uVar28,uVar8,unaff_RBX);
return;
}
}
}
break;
case 0xb:
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
if ((lVar10 != 0) && (DAT_1800927ac != '\0')) {
*(uint *)(lVar10 + 0x48) = *(uint *)(lVar10 + 0x48) | 0x100;
FUN_18001e185((char)lVar10,uVar30,0,uVar31,in_stack_ffffffffffffff60,uVar35,0,uVar36,uVar38,
uVar39,uVar8,unaff_RBX);
return;
}
break;
case 0xd:
lVar10 = *(longlong *)(param_1 + 8);
lVar40 = param_1;
if ((*(uint *)(lVar10 + 0x40) & 0x41400) != 0) {
local_68 = 0;
local_66[0] = 0;
local_66[1] = 0;
local_66[2] = 0;
local_66[3] = 0;
local_66[4] = 0;
local_66[5] = 0;
local_66[6] = 0;
local_66[7] = 0;
local_66[8] = 0;
local_66[9] = 0;
local_66[10] = 0;
local_66[0xb] = 0;
local_66[0xc] = 0;
local_66[0xd] = 0;
local_66[0xe] = 0;
local_66[0xf] = 0;
if (((*(char *)(lVar10 + 0x39d) != '\0') || (param_3 == (byte *)0x0)) ||
(uVar6 = (uint)param_4, uVar6 < 2)) break;
uVar13 = 0;
puVar24 = (ushort *)(param_3 + 2);
uVar21 = CONCAT11(*param_3,param_3[1]);
local_68 = 0;
local_66[0x10] = 0;
uVar16 = (uint)(uVar21 >> 1);
if (((uVar6 - 2 < (uint)uVar21) || ((param_3[1] & 1) != 0)) ||
((0x4f < uVar16 - 1 || (uVar16 == 0)))) break;
uVar32 = (ulonglong)uVar16;
do {
uVar12 = 0;
ppuVar9 = (undefined **)&DAT_18007c390;
do {
if ((ushort)(*puVar24 >> 8 | *puVar24 << 8) == *(ushort *)ppuVar9) {
if ((((byte)uVar12 < 0xc) &&
((((uint)uVar13 & 0xffff) >> ((uint)uVar12 & 0x1f) & 1) == 0)) &&
((ushort)pbVar34 < 0x10)) {
local_66[(longlong)pbVar34] =
(ushort)(&DAT_18007c390)[uVar12 * 0x24] >> 8 |
(&DAT_18007c390)[uVar12 * 0x24] << 8;
local_68 = local_68 + 1;
pbVar34 = (byte *)(ulonglong)local_68;
uVar16 = (uint)local_66[0x10] | 1 << ((uint)uVar12 & 0x1f);
uVar13 = (ulonglong)uVar16;
local_66[0x10] = (ushort)uVar16;
}
break;
}
ppuVar9 = ppuVar9 + 9;
uVar12 = (ulonglong)(byte)((byte)uVar12 + 1);
} while (ppuVar9 < &PTR_FUN_18007c6f0);
puVar24 = puVar24 + 1;
uVar32 = uVar32 - 1;
} while (uVar32 != 0);
if (((short)pbVar34 == 0) || (uVar6 != uVar21 + 2)) break;
FUN_18000eb08((ushort *)(lVar10 + 0x1fe),(ushort *)(lVar10 + 0x1da));
uVar31 = (undefined)uVar13;
puVar23 = &local_68;
uVar6 = *(uint *)(*(longlong *)(param_1 + 8) + 0x40);
uVar26 = (undefined)uVar6;
puVar24 = (ushort *)(*(longlong *)(param_1 + 8) + 0x1fe);
FUN_18002a548(puVar24,(longlong)puVar23,uVar6);
uVar28 = SUB81(puVar24,0);
uVar30 = SUB81(puVar23,0);
*(undefined *)(*(longlong *)(param_1 + 8) + 0x39d) = 1;
lVar10 = *(longlong *)(param_1 + 8);
}
if ((*(longlong *)(lVar10 + 0x78) != 0) && (DAT_1800927ac != '\0')) {
puVar1 = (uint *)(*(longlong *)(lVar10 + 0x78) + 0x48);
*puVar1 = *puVar1 | 0x200;
FUN_18001e185(uVar28,uVar30,uVar26,uVar31,in_stack_ffffffffffffff60,uVar35,(char)_Dst,uVar36,
uVar38,(char)lVar40,uVar8,unaff_RBX);
return;
}
break;
case 0xe:
plVar15 = *(longlong **)(param_1 + 0x20);
if ((*(char *)((longlong)plVar15 + 0xe9) == '\0') || (plVar15[100] == 0)) break;
if (param_4 < 5) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) break;
uVar22 = 0x3b;
}
else {
uVar21 = CONCAT11(*param_3,param_3[1]);
uVar13 = (ulonglong)uVar21;
if (uVar13 + 1 <= (ulonglong)(ushort)(param_4 - 2)) {
bVar20 = param_3[uVar13 + 2];
if (bVar20 != 0) {
if ((ushort)(((param_4 - 2) - uVar21) - 1) < (ushort)bVar20) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) break;
uVar22 = 0x3d;
goto LAB_180031e1e;
}
pbVar34 = param_3 + uVar13 + 3;
}
lVar10 = param_1;
uVar13 = FUN_180062aa8(plVar15,(short *)(param_3 + 2),uVar21,pbVar34,bVar20);
uVar28 = (undefined)lVar10;
uVar31 = SUB81(_Dst,0);
uVar30 = SUB81(pbVar34,0);
if ((int)uVar13 == 0) {
uVar27 = 1;
uVar26 = 0xe;
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
FUN_18000ad34(lVar10,1,0xe);
FUN_18001e185((char)lVar10,uVar27,uVar26,uVar30,in_stack_ffffffffffffff60,uVar35,uVar31,
uVar36,uVar38,uVar28,uVar8,unaff_RBX);
return;
}
break;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) break;
uVar22 = 0x3c;
}
goto LAB_180031e1e;
case 0x10:
lVar10 = *(longlong *)(param_1 + 8);
if (*(longlong *)(lVar10 + 0x310) == 0) break;
if (param_4 < 4) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) break;
uVar22 = 0x39;
}
else {
bVar20 = param_3[1];
uVar21 = CONCAT11(*param_3,bVar20);
pbVar25 = (byte *)(ulonglong)uVar21;
uVar30 = (undefined)(param_4 - 2);
if ((uint)uVar21 == param_4 - 2) {
plVar15 = *(longlong **)(param_1 + 0x20);
pbVar2 = param_3 + 2;
plVar37 = plVar15;
lVar40 = param_1;
if (plVar15[0x79] == 0) {
in_stack_ffffffffffffff68 = 0;
uVar6 = 0;
if (pbVar2 == (byte *)0x0) break;
if (0xfffb < (ushort)(uVar21 - 2)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar22 = 0x4a;
LAB_180031b1e:
FUN_180041cb0(DAT_180091000[2],uVar22,&DAT_180082c58);
}
break;
}
pbVar33 = pbVar2 + uVar21;
for (pbVar17 = pbVar2; pbVar17 < pbVar33; pbVar17 = pbVar17 + *pbVar17 + 1) {
if ((*pbVar17 == 0) || (pbVar33 <= pbVar17 + *pbVar17)) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18001e187;
uVar22 = 0x4c;
goto LAB_180031b1e;
}
}
lVar10 = plVar15[0x62];
if (lVar10 == 0) break;
pbVar17 = (byte *)(lVar10 + 6);
local_94 = 0;
in_stack_ffffffffffffff80 = pbVar17 + *(ushort *)(lVar10 + 4);
do {
pbVar18 = pbVar17;
_Src = pbVar17;
uVar16 = (uint)pbVar34;
plVar5 = plVar37;
if (pbVar17 < in_stack_ffffffffffffff80) {
do {
param_1 = lVar40;
plVar15 = plVar5;
bVar20 = *_Src;
uVar32 = (ulonglong)bVar20;
pbVar34 = pbVar2;
if (pbVar2 < pbVar33) {
do {
bVar19 = *pbVar34;
if (bVar20 == bVar19) {
pbVar25 = pbVar34 + 1;
pbVar18 = _Src + 1;
uVar12 = RtlCompareMemory(pbVar18,pbVar25,uVar32);
if (uVar12 == uVar32) {
uVar6 = bVar20 + 1;
if (plVar37[0x79] == 0) {
in_stack_ffffffffffffff68 = in_stack_ffffffffffffff68 + (short)uVar6;
uVar6 = (uint)in_stack_ffffffffffffff68;
goto LAB_18001e6bb;
}
pbVar18 = _Dst;
pbVar25 = _Src;
memcpy(_Dst,_Src,(ulonglong)uVar6);
_Dst = _Dst + uVar6;
break;
}
}
pbVar34 = pbVar34 + (ulonglong)bVar19 + 1;
} while (pbVar34 < pbVar33);
uVar6 = (uint)in_stack_ffffffffffffff68;
}
LAB_18001e6bb:
_Src = _Src + uVar32 + 1;
uVar16 = local_94;
plVar5 = plVar15;
lVar40 = param_1;
} while (_Src < in_stack_ffffffffffffff80);
}
plVar37 = plVar5;
uVar30 = SUB81(pbVar18,0);
if ((short)uVar6 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x41,&DAT_180082bd8);
}
FUN_18005b470(plVar15,0x4b8,0x80090367,0x78);
*(undefined4 *)((longlong)plVar15 + 0x44) = 0x60;
*(undefined2 *)(plVar15 + 0xc) = 0x7802;
goto LAB_18001e187;
}
if (plVar15[0x79] == 0) {
if (DAT_180092620 == (byte *)0x0) {
pbVar25 = (byte *)(ulonglong)(uVar6 + 6);
uVar30 = 0x40;
pvVar11 = LocalAlloc(0x40,(SIZE_T)pbVar25);
}
else {
uVar30 = (undefined)(uVar6 + 6);
pbVar25 = DAT_180092620;

}
plVar15[0x79] = (longlong)pvVar11;
if (pvVar11 == (HLOCAL)0x0) goto LAB_18001e187;
*(short *)((longlong)pvVar11 + 4) = (short)uVar6;
_Dst = (byte *)(plVar15[0x79] + 6);
}
uVar31 = (undefined)uVar13;
bVar20 = (byte)pbVar25;
local_94 = uVar16 + 1;
pbVar34 = (byte *)(ulonglong)local_94;
} while (local_94 < 2);
lVar10 = *(longlong *)(param_1 + 8);
}
if ((*(longlong *)(lVar10 + 0x78) != 0) && (DAT_1800927ac != '\0')) {
puVar1 = (uint *)(*(longlong *)(lVar10 + 0x78) + 0x48);
*puVar1 = *puVar1 | 0x800;
FUN_18001e185(uVar30,bVar20,(char)lVar10,uVar31,in_stack_ffffffffffffff60,
(char)in_stack_ffffffffffffff68,(char)_Dst,(char)plVar37,
(char)in_stack_ffffffffffffff80,(char)lVar40,uVar8,unaff_RBX);
return;
}
break;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) break;
uVar22 = 0x3a;
}
goto LAB_180031e1e;
case 0x17:
if ((DAT_1800927b4 == 0) && ((*(uint *)(*(longlong *)(param_1 + 0x20) + 0x40) & 0x51540) != 0))
{
puVar3 = (ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
*puVar3 = *puVar3 | 0x8000000;
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
if ((lVar10 != 0) && (DAT_1800927ac != '\0')) {
puVar1 = (uint *)(lVar10 + 0x48);
*puVar1 = *puVar1 | 0x1000;
}
}
else {
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
if ((lVar10 != 0) && (DAT_1800927ac != '\0')) {
*(ushort *)(lVar10 + 0x42) = *(ushort *)(lVar10 + 0x42) | 0x10;
FUN_18001e185((char)lVar10,uVar30,0,uVar31,in_stack_ffffffffffffff60,uVar35,0,uVar36,uVar38,
uVar39,uVar8,unaff_RBX);
return;
}
}
break;
case 0x18:
if ((*(longlong **)(param_1 + 0x20))[0x66] == 0) break;
if (param_4 < 4) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) break;
uVar22 = 0x3e;
}
else {
if ((ushort)param_3[2] <= (ushort)(param_4 - 3)) {
pbVar34 = param_3 + 3;
lVar10 = param_1;
uVar13 = FUN_180062c20(*(longlong **)(param_1 + 0x20),*param_3,param_3[1],(char *)pbVar34,
(ushort)param_3[2]);
uVar28 = (undefined)lVar10;
uVar31 = SUB81(_Dst,0);
uVar30 = SUB81(pbVar34,0);
if ((int)uVar13 == 0) {
uVar27 = 1;
uVar26 = 0x18;
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
FUN_18000ad34(lVar10,1,0x18);
FUN_18001e185((char)lVar10,uVar27,uVar26,uVar30,in_stack_ffffffffffffff60,uVar35,uVar31,
uVar36,uVar38,uVar28,uVar8,unaff_RBX);
return;
}
break;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) break;
uVar22 = 0x3f;
}
LAB_180031e1e:
FUN_180041cb0(DAT_180091000[2],uVar22,&DAT_180082c68);
break;
case 0x23:
lVar10 = *(longlong *)(param_1 + 8);
if ((*(ulonglong *)(lVar10 + 0x88) >> 0xb & 1) != 0) {
if (param_4 == 0) {
*(ulonglong *)(lVar10 + 0x88) = *(ulonglong *)(lVar10 + 0x88) | 0x400000;
}
else {
*(uint *)(lVar10 + 0x3d8) = (uint)param_4;
*(byte **)(lVar10 + 0x3d0) = param_3;
}
}
lVar10 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
if ((lVar10 != 0) && (DAT_1800927ac != '\0')) {
*(uint *)(lVar10 + 0x48) = *(uint *)(lVar10 + 0x48) | 0x2000;
FUN_18001e185((char)lVar10,uVar30,0,uVar31,in_stack_ffffffffffffff60,uVar35,0,uVar36,uVar38,
uVar39,uVar8,unaff_RBX);
return;
}
}
LAB_18001e187:
FUN_180028070(uVar8 ^ (ulonglong)auStack_c8);
return;
}
=========================================
Function at address: 0x18001e185
Called functions addresses: 0x180028070


void FUN_18001e185(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
undefined param_5,undefined param_6,undefined param_7,undefined param_8,
undefined param_9,undefined param_10,ulonglong param_11,undefined8 param_12)

{
FUN_180028070(param_11 ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x18001e850
Called functions addresses: 0xEXTERNAL:000000a7 0xEXTERNAL:0000003c 0x18003201a 0x1800077a0 0x180032107 0x18001ecaf 0x180032092 0x18002a7c0


/* WARNING: Removing unreachable block (ram,0x00018001ed1d) */
/* WARNING: Removing unreachable block (ram,0x00018001eb0b) */
/* WARNING: Removing unreachable block (ram,0x00018001eb13) */
/* WARNING: Removing unreachable block (ram,0x00018001eb1b) */
/* WARNING: Removing unreachable block (ram,0x00018001eb2e) */
/* WARNING: Removing unreachable block (ram,0x00018001eb35) */
/* WARNING: Removing unreachable block (ram,0x00018001ed2c) */
/* WARNING: Removing unreachable block (ram,0x00018001ed38) */
/* WARNING: Removing unreachable block (ram,0x00018001ed40) */

ulonglong FUN_18001e850(undefined8 param_1,longlong *param_2,undefined *param_3,char param_4,
char param_5,longlong param_6,int *param_7,undefined *param_8)

{
uint uVar1;
ulonglong *puVar2;
uint *puVar3;
uint uVar4;
int iVar5;
undefined8 uVar6;
ulonglong uVar7;
uint uVar8;
wchar_t *_Str1;
undefined uVar9;
undefined2 uVar10;
uint *puVar11;
wchar_t *pwVar12;
int iVar13;
int *piVar14;
wchar_t *pwVar15;
uint uVar16;
uint uVar17;
char cVar18;
undefined4 in_stack_ffffffffffffff80;
longlong in_stack_ffffffffffffff88;
char in_stack_ffffffffffffff90;
int iVar19;
int iVar20;
int iVar21;

pwVar15 = (wchar_t *)(ulonglong)(byte)param_4;
if ((((param_2 != (longlong *)0x0) && (param_3 != (undefined *)0x0)) && (param_7 != (int *)0x0))
&& (param_8 != (undefined *)0x0)) {
uVar1 = *(uint *)(param_3 + 0x14);
uVar17 = 0;
cVar18 = (*(uint *)(param_2 + 8) & 0x1000) != 0;
*param_8 = 0;
*param_7 = 0;
if ((param_4 == '\0') || ((bool)cVar18)) {
puVar2 = *(ulonglong **)(param_3 + 0x350);
if (puVar2 != (ulonglong *)0x0) {
pwVar12 = (wchar_t *)*puVar2;
iVar13 = 0;
iVar20 = 0;
if (pwVar12 < pwVar12 + (ulonglong)*(uint *)(puVar2 + 1) * 0x186) {
do {
uVar4 = *(uint *)(param_2[10] + 0xc4);
puVar3 = *(uint **)(param_2[10] + 200);
if (((uVar4 == 0) || (puVar3 == (uint *)0x0)) || (pwVar12 == (wchar_t *)0x0)) {
LAB_18001ea38:
iVar5 = *(int *)(pwVar12 + 0x182);
iVar19 = iVar13;

if (((uVar4 != 0) && (uVar4 != 0x490)) && (uVar4 != 0x32)) {
return (ulonglong)uVar4;
}
iVar21 = iVar20;
if (uVar4 == 0x32) {
iVar5 = iVar19;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar10 = 0x31;
LAB_180032154:
param_3 = (undefined *)0x0;
pwVar15 = pwVar12;
FUN_180041d70(DAT_180091000[2],uVar10,&DAT_180085700,pwVar12);
iVar5 = iVar19;
iVar21 = iVar20;
}
}
else {
uVar8 = (*(uint *)(pwVar12 + 0x180) & 1) + *(uint *)(pwVar12 + 0x180) >> 1;
uVar16 = uVar17;
if (uVar4 == 0x490) {
if ((iVar13 == 0) &&
((iVar20 != 0 ||
((*(int *)((longlong)param_2 + 0x44) == 0 &&
(uVar16 = uVar8, iVar21 = iVar5, cVar18 != '\0')))))) goto LAB_18001eaad;
iVar5 = iVar19;
iVar21 = iVar20;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar10 = 0x32;
goto LAB_180032154;
}
}
else if (iVar13 == 0) {
iVar21 = 0;
iVar13 = iVar5;
uVar16 = uVar8;
if (uVar8 == uVar1) break;
LAB_18001eaba:
if ((uVar16 < uVar1) && (uVar16 < uVar8)) {
code_r0x00018001ecaf:
uVar17 = uVar8;
if (iVar13 == 0) {
if (iVar21 != 0) {
iVar21 = *(int *)(pwVar12 + 0x182);
}
}
else {
iVar5 = *(int *)(pwVar12 + 0x182);
if (uVar8 == uVar1) break;
}
}
else {
uVar17 = uVar16;
if ((uVar1 < uVar16) && ((uVar8 < uVar16 && (uVar1 < uVar8)))) {
uVar7 = FUN_18001ecaf(uVar8,(char)uVar4,(char)param_3,(char)pwVar15,
(char)in_stack_ffffffffffffff80,
(char)in_stack_ffffffffffffff88,
in_stack_ffffffffffffff90,cVar18,(char)iVar21,0,iVar5);
return uVar7;
}
}
}
else {
LAB_18001eaad:
uVar17 = uVar16;
iVar5 = iVar19;
if (uVar16 != uVar1) {
if (uVar8 != uVar1) goto LAB_18001eaba;
goto code_r0x00018001ecaf;
}
}
}
}
else {
uVar16 = *(uint *)(pwVar12 + 0x180);
for (puVar11 = puVar3; puVar11 < puVar3 + (ulonglong)uVar4 * 10;
puVar11 = puVar11 + 10) {
if (puVar11[5] != 0) {
if (*puVar11 == 0) {
LAB_18001eb6e:
if (((param_5 == '\0') || ((*(byte *)(puVar11 + 8) & 1) == 0)) &&
(piVar14 = *(int **)(puVar11 + 6),
piVar14 < piVar14 + (ulonglong)puVar11[5] * 0xc)) {
do {
if ((*piVar14 == 0) && (*(short *)(piVar14 + 2) == 8)) {
_Str1 = *(wchar_t **)(piVar14 + 4);
uVar9 = 0xd8;
param_3 = (undefined *)0x4;
iVar5 = wcsncmp(_Str1,L"ECDH",4);
if (iVar5 == 0) {
iVar21 = iVar20;
iVar5 = iVar13;
if (((piVar14[6] == 0) && (piVar14[10] == 0)) && (piVar14[0xb] == 0)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000)
goto LAB_18001eadc;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar15 = L"ECDH";
param_3 = &DAT_180082b78;
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDH",0);
}
goto LAB_1800320ac;
}
if (uVar16 != 0) {
if (piVar14[10] == 0) {
if (piVar14[0xb] != 0) {
uVar7 = FUN_18003201a((char)_Str1,uVar9,(char)param_3,
(char)pwVar15,in_stack_ffffffffffffff80);
return uVar7;
}
}
else {
if (uVar16 < (uint)piVar14[10]) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000)
goto LAB_18001eadc;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar15 = L"ECDH";
in_stack_ffffffffffffff80 = 0;
param_3 = &DAT_180082b78;
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDH",
(char)uVar16,0);
}
goto LAB_1800320ac;
}
if (piVar14[0xb] != 0) {
uVar7 = FUN_18003201a((char)_Str1,uVar9,(char)param_3,
(char)pwVar15,in_stack_ffffffffffffff80);
return uVar7;
}
}
}
}
}
piVar14 = piVar14 + 0xc;
} while (piVar14 < (int *)((ulonglong)puVar11[5] * 0x30 +
*(longlong *)(puVar11 + 6)));
}
}
else if (param_6 != 0) {
uVar7 = 0;
do {
iVar5 = RtlCompareUnicodeString
(uVar7 * 0x10 + *(longlong *)(puVar11 + 2),param_6);
if (iVar5 == 0) goto LAB_18001eb6e;
uVar8 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar8;
} while (uVar8 < *puVar11);
}
}
}
param_3 = (undefined *)0x0;
in_stack_ffffffffffffff80 = 0;
pwVar15 = pwVar12;
in_stack_ffffffffffffff88 = param_6;
in_stack_ffffffffffffff90 = param_5;
uVar6 = FUN_1800077a0(puVar3,uVar4,0,pwVar12,(wchar_t *)0x0,0,param_6,param_5);
if ((char)uVar6 == '\0') {
iVar5 = *(int *)(pwVar12 + 0x182);
if (iVar5 == 0x17) {
pwVar15 = L"ECDH_P256";
}
else {
if (iVar5 != 0x18) {
if (iVar5 == 0x19) {
uVar7 = FUN_180032092();
return uVar7;
}
goto LAB_18001ea38;
}
pwVar15 = L"ECDH_P384";
}
param_3 = (undefined *)0x0;
in_stack_ffffffffffffff80 = 0;
in_stack_ffffffffffffff88 = param_6;
in_stack_ffffffffffffff90 = param_5;
uVar6 = FUN_1800077a0(puVar3,uVar4,0,pwVar15,(wchar_t *)0x0,0,param_6,param_5);
if ((char)uVar6 == '\0') goto LAB_18001ea38;
}
LAB_1800320ac:
iVar5 = iVar13;
iVar21 = iVar20;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_3 = (undefined *)0x0;
pwVar15 = pwVar12;
FUN_180041d70(DAT_180091000[2],0x2f,&DAT_180085700,pwVar12);
iVar5 = iVar13;
iVar21 = iVar20;
}
}
LAB_18001eadc:
pwVar12 = pwVar12 + 0x186;
iVar13 = iVar5;
iVar20 = iVar21;
} while (pwVar12 < (wchar_t *)((ulonglong)*(uint *)(puVar2 + 1) * 0x30c + *puVar2));
if ((iVar5 != 0) || (iVar21 != 0)) {
if ((iVar5 == 0) && (iVar21 != 0)) {
*param_8 = 1;
}
else {
*param_8 = 0;
iVar21 = iVar5;
}
*param_7 = iVar21;
return 0;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x33,&DAT_180085700);
}
return 0x80090331;
}
}
else {

}
}
return 0x80090304;
}
=========================================
Function at address: 0x18001ecaf
Called functions addresses: 0x18003201a 0x1800321f7 0x180041cb0


ulonglong FUN_18001ecaf(uint param_1,undefined param_2,undefined param_3,byte param_4,
undefined param_5,byte param_6,char param_7,char param_8,undefined param_9,
undefined param_10,int param_11)

{
uint *puVar1;
int iVar2;
uint uVar3;
int iVar4;
undefined8 uVar5;
ulonglong uVar6;
wchar_t *_Str1;
undefined uVar7;
undefined2 uVar8;
uint *puVar9;
wchar_t *pwVar10;
wchar_t *unaff_RBP;
int unaff_ESI;
uint unaff_EDI;
uint uVar11;
int *piVar12;
undefined7 in_register_00000081;
undefined *puVar13;
wchar_t *pwVar14;
char unaff_R12B;
uint uVar15;
uint uVar16;
longlong unaff_R14;
undefined3 in_stack_00000029;
undefined3 in_stack_00000049;
undefined3 in_stack_00000051;
uint in_stack_00000058;
longlong *in_stack_00000060;
char in_stack_000000b0;
longlong in_stack_000000b8;
char in_stack_000000d0;
ulonglong in_stack_000000d8;
int *in_stack_000000e0;
undefined *in_stack_000000e8;

_param_6 = (ulonglong)param_6;
pwVar14 = (wchar_t *)(ulonglong)param_4;
puVar13 = (undefined *)CONCAT71(in_register_00000081,param_3);
code_r0x00018001ecaf:
pwVar10 = unaff_RBP;
uVar16 = param_1;
if (unaff_ESI == 0) {
if (_param_9 != 0) {
_param_9 = *(int *)(unaff_RBP + 0x182);
}
}
else {
iVar4 = *(int *)(unaff_RBP + 0x182);
param_11 = iVar4;
if (param_1 == unaff_EDI) {
LAB_18001ec41:
if ((iVar4 == 0) && (_param_9 == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x33,&DAT_180085700);
}
uVar6 = 0x80090331;
}
else {
if ((unaff_R12B != '\0') && (iVar4 != _param_10)) {
uVar6 = FUN_1800321f7();
return uVar6;
}
if ((iVar4 == 0) && (_param_9 != 0)) {
*in_stack_000000e8 = 1;
}
else {
*in_stack_000000e8 = 0;
_param_9 = iVar4;
}
uVar6 = 0;
*in_stack_000000e0 = _param_9;
}
return uVar6;
}
}
LAB_18001eadc:
unaff_RBP = pwVar10 + 0x186;
iVar4 = param_11;
if (unaff_RBP <
(wchar_t *)((ulonglong)*(uint *)(in_stack_00000060 + 1) * 0x30c + *in_stack_00000060)) {
uVar3 = *(uint *)(*(longlong *)(unaff_R14 + 0x50) + 0xc4);
puVar1 = *(uint **)(*(longlong *)(unaff_R14 + 0x50) + 200);
unaff_R14 = in_stack_000000b8;
unaff_R12B = in_stack_000000b0;
if (((uVar3 != 0) && (puVar1 != (uint *)0x0)) && (unaff_RBP != (wchar_t *)0x0))
goto code_r0x00018001e962;
goto LAB_18001ea38;
}
goto LAB_18001ec41;
code_r0x00018001e962:
uVar15 = *(uint *)(pwVar10 + 0x306);
for (puVar9 = puVar1; puVar9 < puVar1 + (ulonglong)uVar3 * 10; puVar9 = puVar9 + 10) {
if (puVar9[5] != 0) {
if (*puVar9 == 0) {
LAB_18001eb6e:
if (((in_stack_000000d0 == '\0') || ((*(byte *)(puVar9 + 8) & 1) == 0)) &&
(piVar12 = *(int **)(puVar9 + 6), piVar12 < piVar12 + (ulonglong)puVar9[5] * 0xc)) {
do {
if ((*piVar12 == 0) && (*(short *)(piVar12 + 2) == 8)) {
_Str1 = *(wchar_t **)(piVar12 + 4);
uVar7 = 0xd8;
puVar13 = (undefined *)0x4;
iVar4 = wcsncmp(_Str1,L"ECDH",4);
if (iVar4 == 0) {
if (((piVar12[6] == 0) && (piVar12[10] == 0)) && (piVar12[0xb] == 0)) {
pwVar10 = unaff_RBP;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18001eadc;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar14 = L"ECDH";
puVar13 = &DAT_180082b78;
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDH",0);
}
goto LAB_1800320ac;
}
if (uVar15 != 0) {
if (piVar12[10] == 0) {
if (piVar12[0xb] != 0) {
uVar6 = FUN_18003201a((char)_Str1,uVar7,(char)puVar13,(char)pwVar14,_param_5);
return uVar6;
}
}
else {
if (uVar15 < (uint)piVar12[10]) {
pwVar10 = unaff_RBP;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18001eadc;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar14 = L"ECDH";
_param_5 = 0;
puVar13 = &DAT_180082b78;
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDH",(char)uVar15,0);
}
goto LAB_1800320ac;
}
if (piVar12[0xb] != 0) {
uVar6 = FUN_18003201a((char)_Str1,uVar7,(char)puVar13,(char)pwVar14,_param_5);
return uVar6;
}
}
}
}
}
piVar12 = piVar12 + 0xc;
} while (piVar12 < (int *)((ulonglong)puVar9[5] * 0x30 + *(longlong *)(puVar9 + 6)));
}
}
else if (in_stack_000000d8 != 0) {
uVar6 = 0;
do {
iVar4 = RtlCompareUnicodeString
(uVar6 * 0x10 + *(longlong *)(puVar9 + 2),in_stack_000000d8);
if (iVar4 == 0) goto LAB_18001eb6e;
uVar11 = (int)uVar6 + 1;
uVar6 = (ulonglong)uVar11;
} while (uVar11 < *puVar9);
}
}
}
puVar13 = (undefined *)0x0;
pwVar14 = unaff_RBP;
uVar5 = FUN_1800077a0(puVar1,uVar3,0,unaff_RBP,(wchar_t *)0x0,0,in_stack_000000d8,
in_stack_000000d0);
if ((char)uVar5 != '\0') goto LAB_18003209e;
iVar4 = *(int *)(pwVar10 + 0x308);
if (iVar4 == 0x17) {
pwVar14 = L"ECDH_P256";
LAB_18001ea0a:
puVar13 = (undefined *)0x0;
uVar5 = FUN_1800077a0(puVar1,uVar3,0,pwVar14,(wchar_t *)0x0,0,in_stack_000000d8,
in_stack_000000d0);
if ((char)uVar5 != '\0') {
LAB_18003209e:
param_7 = in_stack_000000d0;
_param_6 = in_stack_000000d8;
_param_5 = 0;
LAB_1800320ac:
pwVar10 = unaff_RBP;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar13 = &DAT_180085700;
pwVar14 = unaff_RBP;
FUN_180041d70(DAT_180091000[2],0x2f,&DAT_180085700,unaff_RBP);
}
goto LAB_18001eadc;
}
}
else {
if (iVar4 == 0x18) {
pwVar14 = L"ECDH_P384";
goto LAB_18001ea0a;
}
if (iVar4 == 0x19) {
uVar6 = FUN_180032092();
return uVar6;
}
}
param_7 = in_stack_000000d0;
_param_6 = in_stack_000000d8;
_param_5 = 0;
LAB_18001ea38:
iVar4 = *(int *)(pwVar10 + 0x308);

if (((uVar3 != 0) && (uVar3 != 0x490)) && (uVar3 != 0x32)) {
return (ulonglong)uVar3;
}
if (in_stack_000000b0 != '\0') {
if ((uVar3 == 0) && (iVar4 == _param_10)) goto LAB_18001ec41;
pwVar10 = unaff_RBP;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar6 = FUN_180032107(&DAT_180091000,(ulonglong)uVar3,puVar13,(char)pwVar14,_param_5);
return uVar6;
}
goto LAB_18001eadc;
}
if (uVar3 == 0x32) {
pwVar10 = unaff_RBP;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001eadc;
uVar8 = 0x31;
LAB_180032154:
puVar13 = &DAT_180085700;
pwVar14 = unaff_RBP;
FUN_180041d70(DAT_180091000[2],uVar8,&DAT_180085700,unaff_RBP);
pwVar10 = unaff_RBP;
goto LAB_18001eadc;
}
param_1 = (*(uint *)(pwVar10 + 0x306) & 1) + *(uint *)(pwVar10 + 0x306) >> 1;
uVar15 = uVar16;
iVar2 = _param_9;
unaff_EDI = in_stack_00000058;
if (uVar3 == 0x490) {
if ((param_11 != 0) ||
((_param_9 == 0 &&
((*(int *)(in_stack_000000b8 + 0x44) != 0 ||
(uVar15 = param_1, iVar2 = iVar4, param_8 == '\0')))))) {
pwVar10 = unaff_RBP;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001eadc;
uVar8 = 0x32;
goto LAB_180032154;
}
}
else if (param_11 == 0) {
_param_9 = 0;
uVar15 = param_1;
param_11 = iVar4;
if (param_1 == in_stack_00000058) goto LAB_18001ec41;
goto LAB_18001eaba;
}
_param_9 = iVar2;
pwVar10 = unaff_RBP;
uVar16 = uVar15;
if (uVar15 == in_stack_00000058) goto LAB_18001eadc;
unaff_ESI = param_11;
if (param_1 == in_stack_00000058) goto code_r0x00018001ecaf;
LAB_18001eaba:
if ((uVar15 < in_stack_00000058) && (unaff_ESI = param_11, uVar15 < param_1))
goto code_r0x00018001ecaf;
pwVar10 = unaff_RBP;
uVar16 = uVar15;
if ((in_stack_00000058 < uVar15) && ((param_1 < uVar15 && (in_stack_00000058 < param_1)))) {
uVar6 = FUN_18001ecaf(param_1,(char)uVar3,(char)puVar13,(char)pwVar14,param_5,param_6,param_7,
param_8,param_9,param_10,param_11);
return uVar6;
}
goto LAB_18001eadc;
}
=========================================
Function at address: 0x18001ed90
Called functions addresses: 0x1800329e7 0x180028d84 0x18000d7d0 0x18000d410 0x18001f7fa 0xEXTERNAL:00000083 0x1800327ba 0x18001f810 0x1800329aa 0x18000909c 0x18002a7c0


uint * FUN_18001ed90(longlong *param_1,int *param_2,longlong param_3,uint param_4,undefined8 param_5
,undefined8 *param_6,longlong param_7,undefined4 *param_8,undefined8 *param_9,
undefined *param_10,undefined4 *param_11)

{
int iVar1;
char cVar2;
ushort uVar3;
uint uVar4;
uint uVar5;
longlong lVar6;
ulonglong uVar7;
uint *puVar8;
undefined4 extraout_var;
undefined4 extraout_var_00;
ulonglong *puVar9;
undefined8 *puVar10;
undefined8 uVar11;
HLOCAL pvVar12;
uint *puVar13;
undefined8 *puVar14;
undefined uVar15;
uint *puVar16;
longlong *plVar17;
uint *puVar18;
longlong *plVar19;
ulonglong uVar20;
undefined uVar21;
undefined4 *puVar22;
undefined uVar23;
int **ppiVar24;
int *piVar25;
ulonglong uVar26;
ulonglong uVar27;
uint *puVar28;
bool bVar29;
undefined4 extraout_XMM0_Da;
undefined4 extraout_XMM0_Da_00;
undefined4 extraout_XMM0_Da_01;
undefined4 uVar30;
undefined4 extraout_XMM0_Da_02;
uint *local_res8;
uint local_res20;
undefined uVar31;
undefined8 *puVar32;
undefined uVar33;
undefined uVar34;
undefined uVar35;
longlong *plVar36;
undefined uVar37;
undefined uVar38;
int *piVar39;
int *piVar40;
ulonglong local_110;
uint *local_108 [2];
undefined8 local_f8;
longlong lStack_f0;
undefined4 *local_e8;
ulonglong local_e0;
ulonglong local_d8;
uint *local_d0;
undefined8 local_c8;
undefined8 uStack_c0;
undefined8 local_b8;
longlong lStack_b0;
uint *local_a8;
ULONG *local_a0;
undefined8 local_98;
undefined8 local_90;
undefined8 local_88;
longlong local_80 [4];
int *local_60;
ulonglong *local_58;

puVar10 = &local_88;
uVar20 = 0;
uVar26 = 0x1c;
uVar27 = (ulonglong)param_4;
local_res20 = 0;
piVar39 = (int *)0x0;
local_d0 = (uint *)0x0;
local_60 = (int *)0x0;
local_a0 = (ULONG *)0x0;
local_98 = 0;
local_88 = 0;
local_90 = 0;
local_80[0] = 0;
local_80[2] = 0;
local_80[1] = 0;
local_80[3] = 0;
local_a8 = (uint *)0x0;
local_b8 = 0;
lStack_b0 = 0;
local_110 = 0;
local_f8 = 0;
lStack_f0 = 0;
local_58 = (ulonglong *)0x0;
local_d8 = uVar27;
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_1800445a4(param_1,0,param_1,param_2);
}
puVar14 = DAT_180091000;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0) {
FUN_180041cb0(DAT_180091000[2],0x28,&DAT_180084d00);
}
puVar14 = DAT_180091000;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x29,&DAT_180084d00);
}
puVar14 = DAT_180091000;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x2a,&DAT_180084d00,param_1);
}
puVar14 = DAT_180091000;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x2b,&DAT_180084d00,param_2);
}
puVar14 = DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar14 = (undefined8 *)DAT_180091000[2];
FUN_180041cdc(puVar14,0x2c,&DAT_180084d00,param_4);
}
}
}
}
}
if (param_1 == (longlong *)0x0) {
uVar4 = FUN_18001f7fa(puVar14,0,0);
return (uint *)CONCAT44(extraout_var,uVar4);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x2d,&DAT_180084d00,*(undefined4 *)((longlong)param_1 + 0xd4));
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x2e,&DAT_180084d00,(wchar_t *)(param_1 + 0x1b));
}
}
puVar18 = (uint *)0x0;
local_res8 = (uint *)0x0;
local_108[0] = (uint *)0x0;
local_e8 = (undefined4 *)0x0;
puVar8 = puVar18;
puVar28 = puVar18;
if (*(uint *)(param_7 + 4) != 0) {
lVar6 = *(longlong *)(param_7 + 8);
puVar16 = (uint *)(lVar6 + 4);
puVar13 = puVar18;
local_res8 = puVar18;
do {
uVar4 = *puVar16 & 0xfffffff;
if (uVar4 == 0) {
if ((puVar28 == (uint *)0x0) && ((param_4 & 0x100) != 0)) {
LAB_18001f478:
puVar28 = (uint *)((longlong)puVar13 * 0x10 + lVar6);
}
}
else {
if (uVar4 == 2) goto LAB_18001f478;
if (uVar4 == 0x11) {
local_res8 = (uint *)((longlong)puVar13 * 0x10 + lVar6);
}
else if (uVar4 == 0x17) {
local_108[0] = (uint *)((longlong)puVar13 * 0x10 + lVar6);
}
else if (uVar4 == 0x1a) {
local_e8 = (undefined4 *)((longlong)puVar13 * 0x10 + lVar6);
}
else if (uVar4 == 0x1b) {
puVar8 = (uint *)((longlong)puVar13 * 0x10 + lVar6);
}
}
uVar4 = (int)puVar13 + 1;
puVar13 = (uint *)(ulonglong)uVar4;
puVar16 = puVar16 + 4;
} while (uVar4 < *(uint *)(param_7 + 4));
if (local_108[0] != (uint *)0x0) {
if ((param_4 & 0x100) == 0) {
if (*(longlong *)(local_108[0] + 2) == 0) {
puVar18 = (uint *)0xe;
}
}
else {
local_108[0][2] = 0;
local_108[0][3] = 0;
*local_108[0] = 0;
}
}
if (local_e8 != (undefined4 *)0x0) {
if ((param_4 & 0x100) == 0) {
if (*(longlong *)(local_e8 + 2) == 0) {
puVar18 = (uint *)0xe;
}
}
else {
*(undefined8 *)(local_e8 + 2) = 0;
*local_e8 = 0;
}
}
if (puVar8 != (uint *)0x0) {
if ((param_4 & 0x100) == 0) {
if (*(longlong *)(puVar8 + 2) == 0) {
puVar18 = (uint *)0xe;
}
else if (*puVar8 < 8) {
*puVar8 = 8;
puVar18 = (uint *)0x80090321;
}
}
else {
puVar8[2] = 0;
puVar8[3] = 0;
*puVar8 = 0;
}
}
if (local_res8 != (uint *)0x0) {
if ((param_4 & 0x100) == 0) {
lStack_b0 = *(longlong *)(local_res8 + 2);
if (*(longlong *)(local_res8 + 2) == 0) {
puVar18 = (uint *)0xe;
lStack_b0 = 0;
}
}
else {
local_res8[2] = 0;
local_res8[3] = 0;
*local_res8 = 0;
lStack_b0 = 0;
}
local_b8 = (ulonglong)*local_res8;
}
}
lVar6 = 0;
uVar7 = (ulonglong)(param_4 & 0x100);
if (puVar28 == (uint *)0x0) {
LAB_1800324eb:
uVar4 = FUN_18001f7fa(uVar7,0,0);
return (uint *)CONCAT44(extraout_var_00,uVar4);
}
puVar28[1] = 2;
if (uVar7 == 0) {
lVar6 = *(longlong *)(puVar28 + 2);
if (lVar6 == 0) goto LAB_1800324eb;
}
else {
puVar28[2] = 0;
puVar28[3] = 0;
*puVar28 = 0;
}
local_f8 = (ulonglong)*puVar28;
lStack_f0 = lVar6;
if ((int)puVar18 == 0) {
if ((param_4 & 2) != 0) {
uVar20 = 0x100;
local_110 = 0x100;
}
if ((DAT_1800927b0 == 1) || ((DAT_1800927b0 != 2 && ((param_4 & 0x40) != 0)))) {
uVar20 = uVar20 | 0x800;
local_110 = uVar20;
}
if ((param_4 >> 0x18 & 1) != 0) {
uVar20 = uVar20 | 0x10000;
uVar26 = 0x100001c;
local_110 = uVar20;
}
if (uVar7 != 0) {
uVar26 = uVar26 | 0x100;
}
if ((param_4 >> 0xf & 1) != 0) {
uVar26 = uVar26 | 0x8000;
uVar20 = uVar20 | 0x200;
local_110 = uVar20;
}
if ((param_4 >> 0xb & 1) == 0) {
uVar26 = uVar26 | 0x10000;
local_e0 = uVar26;
}
else {
uVar26 = uVar26 | 0x800;
uVar20 = uVar20 | 0x1000;
local_110 = uVar20;
local_e0 = uVar26;
if ((((param_4 >> 10 & 1) != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2f,&DAT_180084d00);
}
}
if ((*(byte *)((longlong)param_1 + 0x9c) & 1) != 0) {
uVar20 = uVar20 | 0x10000;
local_110 = uVar20;
}
ppiVar24 = &local_60;
plVar19 = local_80 + 1;
plVar17 = local_80 + 2;
plVar36 = local_80;
puVar14 = &local_90;
puVar32 = &local_98;
uVar7 = FUN_18000d410(param_3,&local_d0,(undefined4 *)&local_c8,ppiVar24,&local_a0,puVar32,
puVar10,puVar14,plVar36,plVar17,plVar19,local_80 + 3,(longlong *)&local_a8
);
uVar38 = SUB81(plVar19,0);
uVar37 = SUB81(plVar17,0);
uVar35 = SUB81(plVar36,0);
uVar34 = SUB81(puVar14,0);
uVar33 = SUB81(puVar10,0);
uVar31 = SUB81(puVar32,0);
uVar23 = SUB81(ppiVar24,0);
puVar18 = (uint *)(uVar7 & 0xffffffff);
if ((int)uVar7 == 0) {
puVar9 = local_58;
if (local_a8 != (uint *)0x0) {
if ((*(ulonglong **)(local_a8 + 2) == (ulonglong *)0x0) || (*local_a8 < 8)) {
puVar18 = (uint *)0x57;
uVar20 = 0;
param_2 = piVar39;
goto LAB_18001f35b;
}
uVar7 = **(ulonglong **)(local_a8 + 2);
if ((uVar7 & 0xfffffffeffffffff) != 0) {
puVar18 = (uint *)0x8009035d;
goto LAB_18001f344;
}
if ((uVar7 & 0x100000000) != 0) {
local_110 = uVar20 | 0x100000000;
uVar26 = uVar26 | 0x100000000;
local_e0 = uVar26;
}
uVar27 = uVar27 | uVar7;
local_d8 = uVar27;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x30,&DAT_180084d00,uVar7);
}
uVar23 = (undefined)uVar7;
puVar9 = local_58;
if ((puVar8 != (uint *)0x0) &&
(puVar9 = *(ulonglong **)(puVar8 + 2), *(ulonglong **)(puVar8 + 2) == (ulonglong *)0x0))
{
puVar9 = (ulonglong *)FUN_18000a1f4(8);
*(ulonglong **)(puVar8 + 2) = puVar9;
if (puVar9 == (ulonglong *)0x0) {
puVar18 = (uint *)0x80090300;
uVar20 = 0;
param_2 = piVar39;
goto LAB_18001f35b;
}
*puVar8 = 8;
}
}
local_58 = puVar9;
if ((local_d0 != (uint *)0x0) && ((local_d0[1] & 0xfffffff) != 2)) {
uStack_c0 = 0;
local_c8 = 0;
}
if (param_2 != (int *)0x0) {
plVar19 = *(longlong **)(param_2 + 2);
uVar20 = 1;
local_res20 = 1;
LOCK();
iVar1 = *param_2;
*param_2 = *param_2 + 1;
UNLOCK();
if (iVar1 == 0) {
if (((longlong *)plVar19[10] == (longlong *)0x0) || ((longlong *)plVar19[10] == param_1))
{
*(undefined2 *)((longlong)param_2 + 0x22) = 0;
param_2[9] = 0;
piVar39 = param_2;
goto LAB_18001f130;
}
puVar18 = (uint *)0x80090301;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x32,&DAT_180084d00,0x80090301);
uVar20 = 1;
}
}
else {
puVar18 = (uint *)0x78;
uVar20 = 1;
}
goto LAB_18001f35b;
}
plVar19 = (longlong *)&stack0xfffffffffffffee8;
puVar8 = puVar28;
plVar17 = param_1;
uVar20 = uVar27;
uVar7 = FUN_18001f810(0x180092da0,(longlong)&local_c8,(uint *)&local_f8,puVar28,local_a0,
(longlong)param_1,uVar27,plVar19);
uVar34 = SUB81(plVar19,0);
uVar33 = (undefined)uVar20;
uVar31 = SUB81(plVar17,0);
uVar23 = SUB81(puVar8,0);
puVar18 = (uint *)(uVar7 & 0xffffffff);
if ((int)uVar7 == 0) {
plVar19 = *(longlong **)(piVar39 + 2);
lVar6 = plVar19[0xf];
if ((lVar6 != 0) && (DAT_1800927ac != '\0')) {
*(undefined4 *)(lVar6 + 0xc) = 1;
QueryPerformanceCounter((LARGE_INTEGER *)(lVar6 + 0x50));
*(undefined4 *)(lVar6 + 0x18) = 0;
bVar29 = DAT_1800927ac != '\0';
*(bool *)(lVar6 + 0x1c) = *(int *)(lVar6 + 0xc) == 1;
*(int **)(lVar6 + 0x90) = piVar39;
*(ulonglong *)(lVar6 + 0x78) = uVar27;
*(longlong **)(lVar6 + 0x88) = param_1;
if (bVar29) {
uVar23 = 0xff;
_o_wcsncpy_s(lVar6 + 0x298,0x100);
}
}
LAB_18001f130:
if (*(longlong *)(piVar39 + 6) != 0) {

}
plVar17 = (longlong *)plVar19[10];
if (plVar17 != param_1) {
if (plVar17 != (longlong *)0x0) {
FUN_180003d4c(DAT_1800927e8,plVar17);

}
LOCK();
*(int *)(param_1 + 3) = *(int *)(param_1 + 3) + 1;
UNLOCK();
plVar19[10] = (longlong)param_1;
uVar4 = *(uint *)((longlong)param_1 + 0x9c);
if (((uVar4 & 4) != 0) && (((ulonglong)plVar19[0x11] >> 8 & 1) == 0)) {
plVar19[0x11] = plVar19[0x11] | 0x4000;
uVar4 = *(uint *)((longlong)param_1 + 0x9c);
}
if ((uVar4 >> 0xe & 1) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180082b68);
}
plVar19[0x11] = plVar19[0x11] | 0x200000000;
}
if (*(int *)((longlong)plVar19 + 0x44) == 0x5b) {
if (*(char *)((longlong)plVar19 + 0x10a) == '\0') {
FUN_18006049c(plVar19);
}
else {
*(undefined *)((longlong)plVar19 + 0x39b) = 1;
FUN_18000404c((longlong)plVar19,0);
}
}
else if (*(int *)((longlong)plVar19 + 0x44) == 0x65) {
puVar8 = (uint *)FUN_1800327ba();
return puVar8;
}
}
plVar19[0x11] = plVar19[0x11] | local_110;
if ((*(uint *)((longlong)plVar19 + 0x44) & 0xfffffffb) == 0) {

puVar18 = (uint *)(ulonglong)uVar4;
if (uVar4 == 0) {

puVar18 = (uint *)(ulonglong)uVar4;
if (uVar4 == 0) {

puVar18 = (uint *)(ulonglong)uVar4;
if (uVar4 == 0) goto LAB_18001f168;
}
}
}
else {
LAB_18001f168:

puVar18 = (uint *)(ulonglong)uVar4;
if (uVar4 == 0) {

puVar18 = (uint *)(ulonglong)uVar4;
if (uVar4 == 0) {
puVar22 = local_e8;

uVar21 = SUB81(puVar22,0);
uVar15 = (undefined)param_3;
puVar18 = (uint *)(ulonglong)uVar4;
if (uVar4 == 0) {
if ((uVar27 & 0x100) != 0) {
puVar18 = (uint *)0x1;
}

uVar23 = SUB81(puVar18,0);

puVar18 = (uint *)(ulonglong)uVar4;
if (uVar4 == 0) {
uVar21 = SUB81(&local_f8,0);
uVar15 = SUB81(&local_c8,0);

uVar30 = extraout_XMM0_Da_00;
if ((uVar4 != 0x54f) || ((*(uint *)(plVar19 + 0x11) >> 0x12 & 1) == 0))
goto LAB_18001f289;
piVar40 = piVar39;
if ((param_2 != (int *)0x0) ||
((plVar19 = *(longlong **)(piVar39 + 4), plVar19 == (longlong *)0x0 ||
(piVar40 = (int *)plVar19[0x10], piVar40 == (int *)0x0)))) {
puVar18 = (uint *)0x54f;
uVar20 = (ulonglong)local_res20;
uVar27 = local_d8;
param_2 = piVar40;
goto LAB_18001f35b;
}
lVar6 = *(longlong *)(piVar39 + 2);
piVar39[4] = 0;
piVar39[5] = 0;
uVar4 = *(uint *)(lVar6 + 0x40);
iVar1 = *(int *)(lVar6 + 0x44);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
piVar25 = piVar39;
FUN_180041e9c(DAT_180091000[2],0x12,&DAT_180082b58,piVar39);
uVar23 = SUB81(piVar25,0);
lVar6 = *(longlong *)(piVar39 + 2);
}
if (lVar6 != 0) {
uVar5 = *(uint *)(lVar6 + 0x40);

if ((uVar5 & 0x800a2aaa) != 0) {
FUN_18000909c(*(HLOCAL *)(piVar39 + 2));
}
piVar39[2] = 0;
piVar39[3] = 0;
}
if ((uVar4 & 0x51550) == 0) {
FUN_18000909c(piVar39);
}
else {
lVar6 = *(longlong *)(piVar39 + 6);
cVar2 = *(char *)(piVar39 + 8);
if (lVar6 != 0) {
if (iVar1 == 4) {

if (DAT_180092db8 <= uVar3) {
DAT_180092db8 = (uint)uVar3;
}
LOCK();
iVar1 = DAT_180092db4 + 1;
UNLOCK();
bVar29 = DAT_180092db4 == 99;
DAT_180092db4 = iVar1;
if ((bVar29) && (DAT_180092dd8 != (undefined8 *)0x0)) {
DAT_180092dc0 = DAT_180092db8;
if (DAT_180092de0 == 0) {
puVar10 = (undefined8 *)FUN_180029f58(0x50);
if (puVar10 != (undefined8 *)0x0) {
puVar10 = FUN_1800272fc(puVar10,DAT_180092dc0,1);
goto LAB_1800328e9;
}
}
else {
puVar10 = (undefined8 *)FUN_180029f58(0x80);
if (puVar10 != (undefined8 *)0x0) {
puVar10 = FUN_18005df3c(puVar10,DAT_180092dc0,DAT_180092de0);
LAB_1800328e9:
if (puVar10 != (undefined8 *)0x0) {
DAT_180092dd8 = puVar10;
}
}
}
}
}
puVar10 = DAT_180092dd8;
if (cVar2 == '\0') {


}
else {

FUN_18000909c(pvVar12);
}
}
piVar39[6] = 0;
piVar39[7] = 0;

uVar26 = local_e0;
}
uVar21 = SUB81(&local_f8,0);
uVar15 = SUB81(&local_c8,0);

uVar27 = local_d8;
uVar30 = extraout_XMM0_Da_01;
piVar39 = piVar40;
LAB_18001f289:
if (((ulonglong)plVar19[0x11] >> 0x1c & 1) != 0) {
uVar26 = uVar26 | 0x8000;
plVar19[0x11] = plVar19[0x11] & 0xffffffffefffffff;
}
if ((uVar4 != 0) && (piVar39[9] == 0)) {
puVar8 = (uint *)FUN_1800329aa();
return puVar8;
}
if (local_res8 != (uint *)0x0) {
puVar10 = &local_b8;
plVar17 = plVar19;
uVar20 = uVar27;
uVar30 = FUN_180044054(uVar4,plVar19,uVar27,(undefined4 *)puVar10);
uVar23 = SUB81(puVar10,0);
uVar21 = (undefined)uVar20;
uVar15 = SUB81(plVar17,0);
}
if ((uVar4 == 0x90320) && (local_108[0] != (uint *)0x0)) {
puVar8 = local_108[0];
FUN_180044114(plVar19,local_108[0]);
uVar15 = SUB81(puVar8,0);
uVar30 = extraout_XMM0_Da_02;
}
if ((param_2 == (int *)0x0) && (uVar4 != 0)) {
puVar8 = (uint *)FUN_1800329e7((uint)*(ushort *)((longlong)plVar19 + 0x22),
uVar15,uVar21,uVar23,uVar31,uVar33,uVar34,uVar35,
uVar37,uVar38,piVar39);
return puVar8;
}
*param_6 = piVar39;
uVar4 = FUN_18000d7d0(uVar30,plVar19,piVar39,param_11,local_60,local_d0,
(longlong)&local_c8,(int *)puVar28,(longlong)&local_f8,
uVar27,param_10,param_9);
puVar18 = (uint *)(ulonglong)uVar4;
if (((uVar4 == 0) && (plVar19 != (longlong *)0x0)) &&
(*(int *)((longlong)plVar19 + 0x44) == 4)) {
local_108[0] = (uint *)0x0;

if (*(longlong *)(local_108[0] + 0x56) != 0) {
uVar26 = uVar26 | 2;
}
uVar20 = (ulonglong)local_res20;
param_2 = piVar39;
if ((*(uint *)(plVar19 + 0x11) >> 0x16 & 1) != 0) {
uVar26 = uVar26 | 0x40;
}
goto LAB_18001f35b;
}
}
}
else if ((*(int *)((longlong)plVar19 + 0x44) == 4) && (uVar4 == 0x90316)) {
uVar4 = 0;
uVar30 = extraout_XMM0_Da;
goto LAB_18001f289;
}
}
}
}
}
}
LAB_18001f344:
uVar20 = (ulonglong)local_res20;
param_2 = piVar39;
}
else {
uVar20 = 0;
param_2 = piVar39;
}
LAB_18001f35b:
uVar4 = (uint)puVar18;
if (*puVar28 != 0) {
if ((local_f8._4_4_ <= (uint)local_f8) && (uVar4 != 0x8009036b)) {
if ((uVar27 >> 0xf & 1) != 0) {
uVar26 = uVar26 | 0x8000;
}
goto LAB_18001f389;
}
}
uVar26 = uVar26 & 0xffffffffffff7fff;
LAB_18001f389:
if (local_res8 != (uint *)0x0) {
*(longlong *)(local_res8 + 2) = lStack_b0;
*local_res8 = local_b8._4_4_;
}
if (param_8 != (undefined4 *)0x0) {
*param_8 = (int)uVar26;
}
if (local_58 != (ulonglong *)0x0) {
*local_58 = uVar26 & 0xffffffff00000000;
}
if (((int)uVar20 != 0) && (param_2 != (int *)0x0)) {
LOCK();
*param_2 = *param_2 + -1;
UNLOCK();
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar20 = 0x33;
FUN_180041cdc(DAT_180091000[2],0x33,&DAT_180084d00,uVar4);
}
if (((byte)DAT_180092f00 & 1) != 0) {
puVar8 = puVar18;
uVar5 = FUN_18000c3a8(uVar4);
FUN_180044528(puVar8,uVar20,*param_6,uVar5);
}
if ((uVar4 & 0x1fff0000) == 0x90000) {
if (uVar4 + 0x7ff6ffff < 0x2f) {
return (uint *)0x80090304;
}
if (((0x100e < uVar4 + 0x7ff6efff) && (0xfec < uVar4 + 0x7ff6dfec)) && (uVar4 != 0x80092011)) {
return puVar18;
}
}
else if (uVar4 == 0) {
return (uint *)0x0;
}
if (uVar4 < 0x80092005) {
if (uVar4 == 0x80092004) {
return (uint *)0x8009030d;
}
if (uVar4 == 0xe) {
return (uint *)0x80090300;
}
if (uVar4 == 0x57) {
return (uint *)0x8009035d;
}
if (uVar4 == 0x78) {
return (uint *)0x80090302;
}
if (uVar4 == 0x7a) {
return (uint *)0x80090321;
}
}
else {
if ((uVar4 == 0x800b0101) || (uVar4 == 0x800b0102)) {
return (uint *)0x80090328;
}
if (uVar4 == 0x800b0109) {
return (uint *)0x80090325;
}
if (uVar4 == 0x800b010c) {
return (uint *)0x80092010;
}
if (uVar4 == 0x800b010f) {
return (uint *)0x80090322;
}
}
return (uint *)0x80090304;
}
=========================================
Function at address: 0x18001f7fa
Called functions addresses: None


uint FUN_18001f7fa(undefined8 param_1,int param_2,uint param_3)

{
uint uVar1;
ulonglong uVar2;
undefined4 in_register_00000014;
undefined8 uVar3;
uint unaff_EBX;
longlong unaff_RBP;
longlong unaff_RSI;
undefined4 *in_R11;
ulonglong unaff_R12;
int *in_stack_00000070;

uVar3 = CONCAT44(in_register_00000014,param_2);
if (in_R11 != (undefined4 *)0x0) {
*(undefined8 *)(in_R11 + 2) = *(undefined8 *)(unaff_RBP + -0x28);
*in_R11 = *(undefined4 *)(unaff_RBP + -0x2c);
}
if (*(uint **)(unaff_RBP + 200) != (uint *)0x0) {
**(uint **)(unaff_RBP + 200) = (uint)unaff_R12 & 0xffff7fff;
}
if (*(ulonglong **)(unaff_RBP + 0x30) != (ulonglong *)0x0) {
**(ulonglong **)(unaff_RBP + 0x30) = unaff_R12 & 0xffffffff00000000;
}
if ((param_2 != 0) && (in_stack_00000070 != (int *)0x0)) {
LOCK();
*in_stack_00000070 = *in_stack_00000070 + -1;
UNLOCK();
}
if ((DAT_180091000 != unaff_RSI) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
uVar3 = 0x33;
FUN_180041cdc(*(undefined8 *)(DAT_180091000 + 0x10),0x33,&DAT_180084d00,unaff_EBX);
param_3 = 0;
}
if (((byte)DAT_180092f00 & 1) != 0) {
uVar2 = (ulonglong)unaff_EBX;
uVar1 = FUN_18000c3a8(unaff_EBX);
FUN_180044528(uVar2,uVar3,**(undefined8 **)(unaff_RBP + 0xb8),uVar1);
param_3 = 0;
}
if ((unaff_EBX & 0x1fff0000) == 0x90000) {
if (unaff_EBX + 0x7ff6ffff < 0x2f) {
return 0x80090304;
}
if (((0x100e < unaff_EBX + 0x7ff6efff) && (0xfec < unaff_EBX + 0x7ff6dfec)) &&
(unaff_EBX != 0x80092011)) {
return unaff_EBX;
}
}
else if (unaff_EBX == 0) {
return param_3;
}
if (unaff_EBX < 0x80092005) {
if (unaff_EBX == 0x80092004) {
return 0x8009030d;
}
if (unaff_EBX == 0xe) {
return 0x80090300;
}
if (unaff_EBX == 0x57) {
return 0x8009035d;
}
if (unaff_EBX == 0x78) {
return 0x80090302;
}
if (unaff_EBX == 0x7a) {
return 0x80090321;
}
}
else {
if ((unaff_EBX == 0x800b0101) || (unaff_EBX == 0x800b0102)) {
return 0x80090328;
}
if (unaff_EBX == 0x800b0109) {
return 0x80090325;
}
if (unaff_EBX == 0x800b010c) {
return 0x80092010;
}
if (unaff_EBX == 0x800b010f) {
return 0x80090322;
}
}
return 0x80090304;
}
=========================================
Function at address: 0x18001f810
Called functions addresses: 0x180028d90 0x18000a1f4 0x180043bf8 0x18000d31c 0x180041cb0 0x180029f58 0x1800432ec 0x18002a7c0


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

ulonglong FUN_18001f810(longlong param_1,longlong param_2,uint *param_3,uint *param_4,ULONG *param_5
,longlong param_6,ulonglong param_7,longlong *param_8)

{
undefined8 *puVar1;
char cVar2;
char cVar3;
char *pcVar4;
undefined8 uVar5;
char cVar6;
uint uVar7;
undefined4 uVar8;
uint uVar9;
longlong lVar10;
undefined **ppuVar11;
undefined8 *puVar12;
undefined8 *puVar13;
undefined8 *puVar14;
undefined2 *puVar15;
undefined2 uVar16;
uint uVar17;
ulonglong uVar18;
uint uVar19;
longlong lVar20;
ushort uVar21;
int iVar22;
undefined2 uVar23;
uint uVar24;
bool bVar25;
undefined4 local_res10;
undefined local_58 [8];
uint local_50;

bVar25 = false;
local_res10 = 0;
uVar18 = param_7 & 0x100000000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180082b58);
}
uVar24 = *(uint *)(param_2 + 4);
if ((uVar24 < 5) && (uVar18 == 0)) {
*(undefined4 *)(param_2 + 4) = 5;
return 0x80090318;
}
pcVar4 = *(char **)(param_2 + 8);
uVar9 = *(uint *)(param_6 + 0x98);
if (uVar18 != 0) {
if ((uVar9 & 0xffffefff) != 0) {
return 0x8009035d;
}
uVar7 = 0x303;
uVar24 = 0x400;
bVar25 = true;
goto LAB_18001f958;
}
if (*pcVar4 == '\x16') {
cVar6 = pcVar4[1];
if ((cVar6 == -2) && (CONCAT11(cVar6,pcVar4[2]) < 0xff00)) {
cVar2 = pcVar4[0xb];
uVar17 = 0xd;
cVar3 = pcVar4[0xc];
uVar19 = 0xc;
}
else {
cVar2 = pcVar4[3];
uVar17 = 5;
cVar3 = pcVar4[4];
uVar19 = 4;
}
if ((uint)CONCAT11(cVar2,cVar3) < uVar19 + 2) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
if ((cVar6 == -2) && (CONCAT11(cVar6,pcVar4[2]) < 0xff00)) {
cVar6 = pcVar4[0xb];
cVar2 = pcVar4[0xc];
}
else {
cVar6 = pcVar4[3];
cVar2 = pcVar4[4];
}
FUN_1800432ec(DAT_180091000[2],0xc,&DAT_180082b58,(uint)CONCAT11(cVar6,cVar2));
}
return 0x80090326;
}
uVar7 = uVar17 + 2 + uVar19;
if (uVar24 < uVar7) {
*(uint *)(param_2 + 4) = uVar7;
return 0x80090318;
}
uVar7 = (uint)CONCAT11(pcVar4[(ulonglong)uVar17 + (ulonglong)uVar19],
pcVar4[(ulonglong)uVar17 + 1 + (ulonglong)uVar19]);
if ((pcVar4[(ulonglong)uVar17 + (ulonglong)uVar19] == -2) && (uVar7 < 0xff00)) {
if (((0xfefd < uVar7) || (uVar24 = 0x40000, (uVar9 & 0x40000) == 0)) &&
(uVar24 = 0x10000, (uVar9 & 0x10000) == 0)) goto LAB_180032ca2;
uVar9 = FUN_180043bf8(*(uint *)(param_6 + 0xd4),param_6 + 0xd8,param_5,param_2,param_3);
if (uVar9 != 0) {
if (uVar9 == 0x90312) {
*(undefined8 *)(param_4 + 2) = *(undefined8 *)(param_3 + 2);
*param_4 = param_3[1];
}
return (ulonglong)uVar9;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180082b58);
}
}
else {
if (uVar7 < 0x303) {
if (0x301 < uVar7) goto LAB_180032d86;
if (0x300 < uVar7) goto LAB_180032d95;
LAB_180032d75:
if ((uVar9 & 0x10) == 0) {
return 0x80090331;
}
goto LAB_180032e6d;
}
if ((uVar9 & 0x1400) == 0) {
LAB_180032d86:
uVar24 = 0x100;
if ((uVar9 & 0x100) == 0) {
LAB_180032d95:
if ((uVar9 & 0x40) == 0) goto LAB_180032d75;
uVar24 = 0x40;
}
}
else {
bVar25 = (uVar9 >> 0xc & 1) != 0;
uVar24 = 0x400;
}
}
}
else {
uVar7 = (uint)CONCAT11(pcVar4[3],pcVar4[4]);
if (uVar7 < 0x300) goto LAB_180032ca2;
if (uVar24 < 0xe) {
*(undefined4 *)(param_2 + 4) = 0xe;
return 0x80090318;
}
if (CONCAT11(pcVar4[5],pcVar4[6]) == 0) {
return 0x80090331;
}
if ((pcVar4[3] == -2) && (uVar7 < 0xff00)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180082b58);
return 0x80090326;
}
if (uVar7 < 0x302) {
if (0x300 < uVar7) goto LAB_180032e7f;
}
else {
uVar24 = 0x100;
if ((uVar9 & 0x100) != 0) {
local_res10 = 0x14;
goto LAB_18001f958;
}
LAB_180032e7f:
if ((uVar9 & 0x40) != 0) {
local_res10 = 0x14;
uVar24 = 0x40;
goto LAB_18001f958;
}
}
if ((uVar9 & 0x10) == 0) {
LAB_180032ca2:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xe,&DAT_180082b58);
}
return 0x80090331;
}
local_res10 = 0x14;
LAB_180032e6d:
uVar24 = 0x10;
}
LAB_18001f958:

if (lVar10 == 0) {
return 0xe;
}
puVar1 = (undefined8 *)(lVar10 + 0x28);
*(undefined8 *)(lVar10 + 8) = 0;
if (bVar25) {
puVar13 = (undefined8 *)(lVar10 + 0x618);
lVar20 = 0x640;
if (uVar18 == 0) {
lVar20 = 0x650;
}
if ((puVar13 == (undefined8 *)0x0) || (puVar1 == (undefined8 *)0x0)) {

return 0xe;
}
if (uVar18 == 0) {
*(undefined4 *)(lVar10 + 0x66c) = 0x14;
*(undefined2 *)(lVar10 + 0x668) = 0x4000;
*(undefined2 *)(lVar10 + 0x672) = 0x4000;
ppuVar11 = &PTR_FUN_18007cf80;
*(undefined *)(lVar10 + 0x670) = 0;
}
else {
ppuVar11 = &PTR_FUN_18007d590;
}
*(undefined8 **)(lVar10 + 0x620) = puVar1;
*(undefined2 *)(lVar10 + 0x628) = 0;
*(undefined8 *)(lVar10 + 0x630) = 0;
*(undefined8 *)(lVar10 + 0x638) = 0;
*(undefined4 *)(lVar10 + 0x640) = 0;
*(undefined8 *)(lVar10 + 0x648) = 0;
*(undefined8 *)(lVar10 + 0x650) = 0;
*(undefined8 *)(lVar10 + 0x658) = 0;
*(undefined4 *)(lVar10 + 0x660) = 0;
*puVar13 = ppuVar11;
*puVar1 = &PTR_FUN_18007cdb8;
*(undefined8 *)(lVar10 + 0x30) = 0;
*(undefined8 *)(lVar10 + 0x38) = 0;
*(undefined8 *)(lVar10 + 0x40) = 0;
*(undefined2 *)(lVar10 + 0x48) = 0;
*(undefined4 *)(lVar10 + 0x4c) = 0;
*(undefined8 *)(lVar10 + 0x50) = 0;
*(undefined8 *)(lVar10 + 0x58) = 0;
*(undefined4 *)(lVar10 + 0x60) = 0;
*(undefined2 *)(lVar10 + 0x88) = 0;
*(undefined *)(lVar10 + 0x110) = 0;
*(undefined2 *)(lVar10 + 0x130) = 0;
*(undefined *)(lVar10 + 0x132) = 0;
*(uint *)(lVar10 + 0x68) = uVar24;
*(undefined8 *)(lVar10 + 0x6c) = 0;
*(undefined8 *)(lVar10 + 0x78) = 0;
*(undefined8 *)(lVar10 + 0x80) = 0;
*(undefined8 *)(lVar10 + 0x90) = 0;
*(undefined8 *)(lVar10 + 0x98) = 0;
*(undefined8 *)(lVar10 + 0xa0) = 0;
*(undefined8 *)(lVar10 + 0xa8) = 0;
*(undefined8 *)(lVar10 + 0xb0) = 0;
*(undefined8 *)(lVar10 + 0xb8) = 0;
*(undefined8 *)(lVar10 + 0xc0) = 0;
*(undefined8 *)(lVar10 + 200) = 0;
*(undefined8 *)(lVar10 + 0xd0) = 0;
*(undefined8 *)(lVar10 + 0xd8) = 0;
*(undefined8 *)(lVar10 + 0xe0) = 0;
*(undefined4 *)(lVar10 + 0xe8) = 0;
*(undefined8 *)(lVar10 + 0xf0) = 0;
*(undefined8 *)(lVar10 + 0xf8) = 0;
*(undefined4 *)(lVar10 + 0x100) = 0;
*(undefined2 *)(lVar10 + 0x104) = 0;
*(undefined8 *)(lVar10 + 0x108) = 0;
*(undefined2 *)(lVar10 + 0x112) = 0;
*(undefined8 *)(lVar10 + 0x118) = 0;
*(undefined8 *)(lVar10 + 0x120) = 0;
*(undefined8 *)(lVar10 + 0x128) = 0;

if (cVar6 != '\0') {
if ((local_50 & 1) != 0) {
*(ulonglong *)(lVar10 + 0xb0) = *(ulonglong *)(lVar10 + 0xb0) | 0x20000000;
}
*(bool *)(lVar10 + 0x132) = (local_50 & 0x11) == 0;
}
uVar18 = FUN_18000d31c(*(uint *)(lVar10 + 0x68));
*(short *)(lVar10 + 0x4a) = (short)uVar18;
if (((char)((uVar18 & 0xffff) >> 8) != -2) || (uVar8 = 0xd, 0xfeff < (uint)(uVar18 & 0xffff))) {
uVar8 = 5;
}
*(undefined4 *)(lVar10 + 100) = uVar8;
*(bool *)(lVar10 + 0x111) = (uVar24 & 0xf0000) != 0;
if ((((DAT_180091480 == 0) || ((_DAT_180091490 & 0x400000000000) == 0)) ||
((DAT_180091498 & 0x400000000000) != DAT_180091498)) ||
(puVar12 = (undefined8 *)FUN_18000a1f4(0x700), puVar12 == (undefined8 *)0x0)) {
puVar12 = (undefined8 *)0x0;
}
else {
*(undefined4 *)(puVar12 + 1) = 0;
*puVar12 = &PTR_FUN_18007cf58;
*(undefined *)(puVar12 + 2) = 0;
*(undefined4 *)((longlong)puVar12 + 0x14) = 1;
memset(puVar12 + 3,0,0x6e8);
}
puVar14 = (undefined8 *)0x0;
*(undefined8 **)(lVar10 + 0xa0) = puVar12;
memset((void *)(lVar10 + 0x138),0,0x40);
*(undefined4 *)(lVar10 + 0x178) = 0;
*(undefined *)(lVar10 + 0x17c) = 0;
memset((void *)(lVar10 + 0x17d),0,0x48);
*(undefined4 *)(lVar10 + 0x1c8) = 0;
*(undefined8 *)(lVar10 + 0x1cc) = 0;
*(undefined8 *)(lVar10 + 0x1d4) = 0;
*(undefined8 *)(lVar10 + 0x1dc) = 0;
*(undefined8 *)(lVar10 + 0x1e4) = 0;
*(undefined8 *)(lVar10 + 0x1ec) = 0;
*(undefined8 *)(lVar10 + 0x1f8) = 0;
*(undefined4 *)(lVar10 + 0x200) = 0;
*(undefined8 *)(lVar10 + 0x204) = 0;
*(undefined8 *)(lVar10 + 0x20c) = 0;
*(undefined8 *)(lVar10 + 0x214) = 0;
*(undefined8 *)(lVar10 + 0x21c) = 0;
*(undefined4 *)(lVar10 + 0x224) = 0;
*(undefined8 *)(lVar10 + 0x228) = 0;
*(undefined8 *)(lVar10 + 0x230) = 0;
*(undefined8 *)(lVar10 + 0x238) = 0;
*(undefined8 *)(lVar10 + 0x240) = 0;
uVar23 = 0;
*(undefined2 *)(lVar10 + 0x248) = 0;
*(undefined8 *)(lVar10 + 0x24c) = 0;
*(undefined *)(lVar10 + 0x254) = 0;
*(undefined8 *)(lVar10 + 600) = 0;
*(undefined8 *)(lVar10 + 0x260) = 0;
*(undefined8 *)(lVar10 + 0x268) = 0;
*(undefined8 *)(lVar10 + 0x270) = 0;
memset((void *)(lVar10 + 0x278),0,0x80);
*(undefined4 *)(lVar10 + 0x2f8) = 0;
*(undefined8 *)(lVar10 + 0x2fc) = 0;
*(undefined8 *)(lVar10 + 0x304) = 0;
*(undefined8 *)(lVar10 + 0x30c) = 0;
*(undefined8 *)(lVar10 + 0x314) = 0;
*(undefined8 *)(lVar10 + 0x31c) = 0;
*(undefined8 *)(lVar10 + 0x324) = 0;
*(undefined8 *)(lVar10 + 0x32c) = 0;
*(undefined4 *)(lVar10 + 0x334) = 0;
*(undefined8 *)(lVar10 + 0x338) = 0;
*(undefined8 *)(lVar10 + 0x340) = 0;
*(undefined8 *)(lVar10 + 0x348) = 0;
*(undefined8 *)(lVar10 + 0x350) = 0;
*(undefined8 *)(lVar10 + 0x358) = 0;
*(undefined8 *)(lVar10 + 0x360) = 0;
*(undefined8 *)(lVar10 + 0x368) = 0;
*(undefined8 *)(lVar10 + 0x370) = 0;
*(undefined8 *)(lVar10 + 0x378) = 0;
*(undefined8 *)(lVar10 + 0x380) = 0;
*(undefined8 *)(lVar10 + 0x388) = 0;
*(undefined4 *)(lVar10 + 0x390) = 0;
*(undefined8 *)(lVar10 + 0x398) = 0;
*(undefined4 *)(lVar10 + 0x3a0) = 0;
*(undefined8 *)(lVar10 + 0x3a8) = 0;
*(undefined8 *)(lVar10 + 0x3b0) = 0;
*(undefined8 *)(lVar10 + 0x3b8) = 0;
*(undefined4 *)(lVar10 + 0x3c0) = 0;
*(undefined2 *)(lVar10 + 0x3c4) = 0;
if (*(char *)(lVar10 + 0x111) == '\0') {
*(undefined4 *)(lVar10 + 0xe8) = 0xffffffff;
*(undefined8 *)(lVar10 + 0xf0) = 0;
*(undefined8 *)(lVar10 + 0xf8) = 0;
uVar16 = uVar23;
}
else {
uVar23 = 0x43b;
uVar16 = 0x448;
}
*(undefined2 *)(lVar10 + 0x100) = uVar16;
*(undefined2 *)(lVar10 + 0x102) = uVar23;
*(undefined8 *)(lVar10 + 0x3c8) = 0;
*(undefined8 *)(lVar10 + 0x3d0) = 0;
*(undefined8 *)(lVar10 + 0x3d8) = 0;
*(undefined2 *)(lVar10 + 0x3e0) = 0;
*(undefined8 *)(lVar10 + 1000) = 0;
*(undefined8 *)(lVar10 + 0x3f0) = 0;
*(undefined8 *)(lVar10 + 0x3f8) = 0;
*(undefined4 *)(lVar10 + 0x400) = 0;
*(undefined *)(lVar10 + 0x404) = 0;
*(undefined8 *)(lVar10 + 0x408) = 0;
*(undefined ***)(lVar10 + 0x420) = &PTR_FUN_18007cb58;
*(undefined8 **)(lVar10 + 0x428) = puVar13;
*(undefined *)(lVar10 + 0x418) = 0;
*(undefined *)(lVar10 + 0x430) = 0;
*(undefined8 *)(lVar10 + 0x438) = 0;
*(undefined8 *)(lVar10 + 0x440) = 0;
*(undefined8 *)(lVar10 + 0x448) = 0;
*(undefined8 *)(lVar10 + 0x450) = 0;
*(undefined8 *)(lVar10 + 0x458) = 0;
*(undefined8 *)(lVar10 + 0x460) = 0;
*(undefined8 *)(lVar10 + 0x468) = 0;
*(undefined8 *)(lVar10 + 0x470) = 0;
*(undefined8 *)(lVar10 + 0x478) = 0;
*(undefined8 *)(lVar10 + 0x480) = 0;
*(undefined *)(lVar10 + 0x488) = 0;
*(undefined *)(lVar10 + 0x498) = 0;
*(undefined8 *)(lVar10 + 0x490) = 0;
*(undefined8 *)(lVar10 + 0x4a0) = 0;
*(undefined8 *)(lVar10 + 0x4a8) = 0;
*(undefined8 *)(lVar10 + 0x4b0) = 0;
*(undefined8 *)(lVar10 + 0x4b8) = 0;
*(undefined8 *)(lVar10 + 0x4c0) = 0;
*(undefined8 *)(lVar10 + 0x4c8) = 0;
*(undefined8 *)(lVar10 + 0x4d0) = 0;
*(undefined *)(lVar10 + 0x4e8) = 0;
*(undefined2 *)(lVar10 + 0x4f8) = 0;
*(undefined *)(lVar10 + 0x508) = 0;
*(undefined2 *)(lVar10 + 0x4d8) = 0x100;
*(undefined8 **)(lVar10 + 0x4e0) = puVar13;
*(undefined8 *)(lVar10 + 0x4f0) = 0;
*(undefined8 *)(lVar10 + 0x500) = 0;
*(undefined8 *)(lVar10 + 0x509) = 0;
*(undefined8 *)(lVar10 + 0x511) = 0;
*(undefined8 *)(lVar10 + 0x519) = 0;
*(undefined8 *)(lVar10 + 0x521) = 0;
*(undefined2 *)(lVar10 + 0x529) = 0;
uVar5 = *(undefined8 *)(lVar10 + 0x4e0);
*puVar1 = &PTR_FUN_18007c928;
*(undefined ***)(lVar10 + 0x410) = &PTR_FUN_18007c920;

*(undefined8 **)(lVar10 + 0x538) = puVar1;
puVar13 = (undefined8 *)FUN_180029f58(0x30);
if (puVar13 != (undefined8 *)0x0) {
puVar13[1] = puVar1;
*puVar13 = &PTR_FUN_18007cb98;
puVar13[2] = 0;
*(undefined4 *)(puVar13 + 3) = 0;
puVar13[4] = puVar1;
puVar13[5] = puVar1;
puVar14 = puVar13;
}
*(undefined8 **)(lVar10 + 0x540) = puVar14;
*(undefined ***)(lVar10 + 0x530) = &PTR_FUN_18007cb80;
*(undefined8 *)(lVar10 + 0x548) = 0;
*(undefined8 *)(lVar10 + 0x550) = uVar5;
*(undefined4 *)(lVar10 + 0x558) = 0;
*(undefined2 *)(lVar10 + 0x55c) = 0;
*(undefined *)(lVar10 + 0x55e) = 0;
*(undefined4 *)(lVar10 + 0x560) = 0;
*(undefined2 *)(lVar10 + 0x564) = 0;
*(undefined *)(lVar10 + 0x566) = 0;
*(undefined8 *)(lVar10 + 0x568) = 0;
*(undefined2 *)(lVar10 + 0x570) = 0;
*(undefined8 *)(lVar10 + 0x578) = 0;
*(undefined4 *)(lVar10 + 0x580) = 0;
*(undefined8 *)(lVar10 + 0x588) = 0;
*(undefined8 *)(lVar10 + 0x590) = 0;
*(undefined4 *)(lVar10 + 0x598) = 0;
*(undefined8 *)(lVar10 + 0x5a0) = 0;
*(undefined8 *)(lVar10 + 0x5a8) = 0;
*(undefined8 *)(lVar10 + 0x5b0) = 0;
*(undefined8 *)(lVar10 + 0x5b8) = 0;
*(undefined8 *)(lVar10 + 0x5c0) = 0;
*(undefined4 *)(lVar10 + 0x5c8) = 0;
*(undefined2 *)(lVar10 + 0x5cc) = 0;
*(undefined8 *)(lVar10 + 0x5d0) = 0;
*(undefined4 *)(lVar10 + 0x5d8) = 0;
*(undefined2 *)(lVar10 + 0x5dc) = 0;
*(undefined8 *)(lVar10 + 0x5e0) = 0;
*(undefined4 *)(lVar10 + 0x5e8) = 0;
*(undefined2 *)(lVar10 + 0x5ec) = 0;
*(undefined8 *)(lVar10 + 0x5f0) = 0;
*(undefined2 *)(lVar10 + 0x5f8) = 0;
*(undefined8 *)(lVar10 + 0x600) = 0;
*(undefined2 *)(lVar10 + 0x608) = 0;
*(undefined *)(lVar10 + 0x60a) = 0;
*(undefined8 *)(lVar10 + 0x610) = 0;
}
else {
*(undefined8 *)(lVar10 + 0x30) = 0;
*puVar1 = &PTR_FUN_18007cdb8;
*(undefined8 *)(lVar10 + 0x38) = 0;
*(undefined8 *)(lVar10 + 0x40) = 0;
*(undefined2 *)(lVar10 + 0x48) = 0;
*(undefined4 *)(lVar10 + 0x4c) = 0;
*(undefined8 *)(lVar10 + 0x50) = 0;
*(undefined8 *)(lVar10 + 0x58) = 0;
*(undefined4 *)(lVar10 + 0x60) = 0;
*(undefined2 *)(lVar10 + 0x88) = 0;
*(undefined *)(lVar10 + 0x110) = 0;
*(undefined2 *)(lVar10 + 0x130) = 0;
*(undefined *)(lVar10 + 0x132) = 0;
*(uint *)(lVar10 + 0x68) = uVar24;
*(undefined8 *)(lVar10 + 0x6c) = 0;
*(undefined8 *)(lVar10 + 0x78) = 0;
*(undefined8 *)(lVar10 + 0x80) = 0;
*(undefined8 *)(lVar10 + 0x90) = 0;
*(undefined8 *)(lVar10 + 0x98) = 0;
*(undefined8 *)(lVar10 + 0xa0) = 0;
*(undefined8 *)(lVar10 + 0xa8) = 0;
*(undefined8 *)(lVar10 + 0xb0) = 0;
*(undefined8 *)(lVar10 + 0xb8) = 0;
*(undefined8 *)(lVar10 + 0xc0) = 0;
*(undefined8 *)(lVar10 + 200) = 0;
*(undefined8 *)(lVar10 + 0xd0) = 0;
*(undefined8 *)(lVar10 + 0xd8) = 0;
*(undefined8 *)(lVar10 + 0xe0) = 0;
*(undefined4 *)(lVar10 + 0xe8) = 0;
*(undefined8 *)(lVar10 + 0xf0) = 0;
*(undefined8 *)(lVar10 + 0xf8) = 0;
*(undefined4 *)(lVar10 + 0x100) = 0;
*(undefined2 *)(lVar10 + 0x104) = 0;
*(undefined8 *)(lVar10 + 0x108) = 0;
*(undefined2 *)(lVar10 + 0x112) = 0;
*(undefined8 *)(lVar10 + 0x118) = 0;
*(undefined8 *)(lVar10 + 0x120) = 0;
*(undefined8 *)(lVar10 + 0x128) = 0;

if (cVar6 != '\0') {
if ((local_50 & 1) != 0) {
*(ulonglong *)(lVar10 + 0xb0) = *(ulonglong *)(lVar10 + 0xb0) | 0x20000000;
}
*(bool *)(lVar10 + 0x132) = (local_50 & 0x11) == 0;
}
uVar18 = FUN_18000d31c(*(uint *)(lVar10 + 0x68));
*(short *)(lVar10 + 0x4a) = (short)uVar18;
if (((char)((uVar18 & 0xffff) >> 8) != -2) || (uVar8 = 0xd, 0xfeff < (uint)(uVar18 & 0xffff))) {
uVar8 = 5;
}
*(undefined4 *)(lVar10 + 100) = uVar8;
*(bool *)(lVar10 + 0x111) = (uVar24 & 0xf0000) != 0;
if ((((DAT_180091480 == 0) || ((_DAT_180091490 & 0x400000000000) == 0)) ||
((DAT_180091498 & 0x400000000000) != DAT_180091498)) ||
(puVar13 = (undefined8 *)FUN_18000a1f4(0x700), puVar13 == (undefined8 *)0x0)) {
puVar13 = (undefined8 *)0x0;
}
else {
*(undefined4 *)(puVar13 + 1) = 0;
*puVar13 = &PTR_FUN_18007cf58;
*(undefined *)(puVar13 + 2) = 0;
*(undefined4 *)((longlong)puVar13 + 0x14) = 1;
memset(puVar13 + 3,0,0x6e8);
}
*(undefined8 **)(lVar10 + 0xa0) = puVar13;
memset((void *)(lVar10 + 0x138),0,0x40);
*(undefined4 *)(lVar10 + 0x178) = 0;
*(undefined *)(lVar10 + 0x17c) = 0;
memset((void *)(lVar10 + 0x17d),0,0x48);
*(undefined4 *)(lVar10 + 0x1c8) = 0;
*(undefined8 *)(lVar10 + 0x1cc) = 0;
*(undefined8 *)(lVar10 + 0x1d4) = 0;
*(undefined8 *)(lVar10 + 0x1dc) = 0;
*(undefined8 *)(lVar10 + 0x1e4) = 0;
*(undefined8 *)(lVar10 + 0x1ec) = 0;
*(undefined8 *)(lVar10 + 0x1f8) = 0;
*(undefined4 *)(lVar10 + 0x200) = 0;
*(undefined8 *)(lVar10 + 0x204) = 0;
*(undefined8 *)(lVar10 + 0x20c) = 0;
*(undefined8 *)(lVar10 + 0x214) = 0;
*(undefined8 *)(lVar10 + 0x21c) = 0;
*(undefined4 *)(lVar10 + 0x224) = 0;
*(undefined8 *)(lVar10 + 0x228) = 0;
*(undefined8 *)(lVar10 + 0x230) = 0;
*(undefined8 *)(lVar10 + 0x238) = 0;
*(undefined8 *)(lVar10 + 0x240) = 0;
uVar23 = 0;
*(undefined2 *)(lVar10 + 0x248) = 0;
*(undefined8 *)(lVar10 + 0x24c) = 0;
*(undefined *)(lVar10 + 0x254) = 0;
*(undefined8 *)(lVar10 + 600) = 0;
*(undefined8 *)(lVar10 + 0x260) = 0;
*(undefined8 *)(lVar10 + 0x268) = 0;
*(undefined8 *)(lVar10 + 0x270) = 0;
memset((void *)(lVar10 + 0x278),0,0x80);
*(undefined4 *)(lVar10 + 0x2f8) = 0;
*(undefined8 *)(lVar10 + 0x2fc) = 0;
*(undefined8 *)(lVar10 + 0x304) = 0;
*(undefined8 *)(lVar10 + 0x30c) = 0;
*(undefined8 *)(lVar10 + 0x314) = 0;
*(undefined8 *)(lVar10 + 0x31c) = 0;
*(undefined8 *)(lVar10 + 0x324) = 0;
*(undefined8 *)(lVar10 + 0x32c) = 0;
*(undefined4 *)(lVar10 + 0x334) = 0;
*(undefined8 *)(lVar10 + 0x338) = 0;
*(undefined8 *)(lVar10 + 0x340) = 0;
*(undefined8 *)(lVar10 + 0x348) = 0;
*(undefined8 *)(lVar10 + 0x350) = 0;
*(undefined8 *)(lVar10 + 0x358) = 0;
*(undefined8 *)(lVar10 + 0x360) = 0;
*(undefined8 *)(lVar10 + 0x368) = 0;
*(undefined8 *)(lVar10 + 0x370) = 0;
*(undefined8 *)(lVar10 + 0x378) = 0;
*(undefined8 *)(lVar10 + 0x380) = 0;
*(undefined8 *)(lVar10 + 0x388) = 0;
*(undefined4 *)(lVar10 + 0x390) = 0;
*(undefined8 *)(lVar10 + 0x398) = 0;
*(undefined4 *)(lVar10 + 0x3a0) = 0;
*(undefined8 *)(lVar10 + 0x3a8) = 0;
*(undefined8 *)(lVar10 + 0x3b0) = 0;
*(undefined8 *)(lVar10 + 0x3b8) = 0;
*(undefined4 *)(lVar10 + 0x3c0) = 0;
*(undefined2 *)(lVar10 + 0x3c4) = 0;
if (*(char *)(lVar10 + 0x111) == '\0') {
*(undefined4 *)(lVar10 + 0xe8) = 0xffffffff;
*(undefined8 *)(lVar10 + 0xf0) = 0;
uVar16 = 0;
*(undefined8 *)(lVar10 + 0xf8) = 0;
}
else {
uVar23 = 0x43b;
uVar16 = 0x448;
}
*(undefined2 *)(lVar10 + 0x100) = uVar16;
lVar20 = 1000;
*(undefined2 *)(lVar10 + 0x102) = uVar23;
*puVar1 = &PTR_FUN_18007c6f0;
*(undefined8 *)(lVar10 + 0x3c8) = 0;
*(undefined8 *)(lVar10 + 0x3d0) = 0;
*(undefined8 *)(lVar10 + 0x3d8) = 0;
*(undefined2 *)(lVar10 + 0x3e0) = 0;
*(undefined8 *)(lVar10 + 1000) = 0;
*(undefined8 *)(lVar10 + 0x3f0) = 0;
*(undefined8 *)(lVar10 + 0x3f8) = 0;
*(undefined4 *)(lVar10 + 0x400) = 0;
*(undefined *)(lVar10 + 0x404) = 0;
*(undefined8 *)(lVar10 + 0x408) = 0;
}
puVar13 = (undefined8 *)(lVar20 + (longlong)puVar1);
if (*(longlong *)(param_1 + 0x38) == 0) {
if (*(char *)(param_1 + 0x44) == '\0') goto LAB_180020045;
iVar22 = 0x800;
puVar15 = (undefined2 *)FUN_18000a1f4(0x800);
*(undefined *)(lVar10 + 0x20) = 1;
}
else {

iVar22 = *(int *)(param_1 + 0x20);
}
if ((puVar15 != (undefined2 *)0x0) && (iVar22 != 0)) {
puVar13[1] = 0;
*puVar13 = &PTR_FUN_18007d508;
uVar21 = (ushort)iVar22;
*(ushort *)(puVar13 + 2) = uVar21;
*(undefined4 *)((longlong)puVar13 + 0x12) = 0;
if (4 < uVar21) {
puVar13[1] = puVar15;
*puVar15 = 0;
*(ushort *)(puVar13[1] + 2) = uVar21 - 4;
}
*(undefined8 **)(lVar10 + 0x18) = puVar13;
}
LAB_180020045:
*(undefined8 **)(lVar10 + 8) = puVar1;
*(longlong *)(lVar10 + 0xa8) = lVar10;
lVar20 = *(longlong *)(lVar10 + 8);
if (lVar20 == 0) {
uVar18 = 0x54f;
}
else {

if ((int)uVar18 == 0) {
*(undefined4 *)(lVar20 + 0x44) = local_res10;
*(uint *)(lVar20 + 0x24) = uVar7;
*param_8 = lVar10;
uVar18 = 0;
}
}
return uVar18;
}
=========================================
Function at address: 0x180020110
Called functions addresses: 0x180003df0 0x180028a7c 0x1800209e0 0xEXTERNAL:0000011c 0x1800726b8 0x180020cd0 0x18000909c 0x18006fe4c 0x180020b60 0x18002a7c0 0x180003d20 0x180003d4c 0x1800726f4 0x180014550 0x180003e7c 0x180003ce4 0x1800209bc 0x180020c30 0x180003700 0x180003ea4


longlong * FUN_180020110(longlong *param_1)

{
int *piVar1;
int iVar2;
HLOCAL pvVar3;
longlong lVar4;
longlong *plVar5;

*param_1 = (longlong)&PTR_FUN_18007c928;
param_1[0x7d] = (longlong)&PTR_FUN_18007c920;
if ((HLOCAL)param_1[0xbb] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0xbb]);
}
FUN_180020cd0(param_1);
FUN_180020c30(param_1 + 0xa1);
FUN_180020b60(param_1 + 0x7d);
*param_1 = (longlong)&PTR_FUN_18007c6f0;
FUN_1800209e0(param_1);
if ((HLOCAL)param_1[0x74] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x74]);
}
if ((HLOCAL)param_1[0x75] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x75]);
}
if ((HLOCAL)param_1[0x76] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x76]);
}
*param_1 = (longlong)&PTR_FUN_18007cba8;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
plVar5 = (longlong *)param_1[0x3a];
if (plVar5 != (longlong *)0x0) {
if ((*plVar5 != 0) && (plVar5[3] != 0)) {

plVar5[3] = 0;
*(undefined4 *)(plVar5 + 2) = 0;
plVar5 = (longlong *)param_1[0x3a];
}
FUN_180003700((longlong)param_1,plVar5);
}
}
else {
if ((HLOCAL)param_1[0x47] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x47]);
}
lVar4 = param_1[0x49];
if (lVar4 != 0) {
FUN_1800726b8(lVar4);
_o_free(lVar4);
param_1[0x49] = 0;
}
lVar4 = param_1[0x48];
if (lVar4 != 0) {
FUN_1800726f4(lVar4);
_o_free(lVar4);
param_1[0x48] = 0;
}
FUN_18006fe4c((longlong)param_1);
}
if ((HLOCAL)param_1[0x62] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x62]);
}
if ((HLOCAL)param_1[99] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[99]);
}
if ((HLOCAL)param_1[100] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[100]);
}
FUN_180003ea4(param_1);
if ((HLOCAL)param_1[0x66] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x66]);
}
FUN_180003e7c(param_1);
lVar4 = param_1[0x68];
if (lVar4 != 0) {
if (*(longlong *)(lVar4 + 8) != 0) {

lVar4 = param_1[0x68];
}

param_1[0x68] = 0;
}
pvVar3 = (HLOCAL)param_1[0x69];
if (pvVar3 != (HLOCAL)0x0) {
if (*(HLOCAL *)((longlong)pvVar3 + 8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)pvVar3 + 8));
pvVar3 = (HLOCAL)param_1[0x69];
}
if (*(HLOCAL *)((longlong)pvVar3 + 0x18) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)pvVar3 + 0x18));
pvVar3 = (HLOCAL)param_1[0x69];
}
FUN_18000909c(pvVar3);
param_1[0x69] = 0;
}
if ((HLOCAL)param_1[0x6a] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6a]);
}
if ((HLOCAL)param_1[0x6b] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6b]);
}
if ((HLOCAL)param_1[0x6c] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6c]);
}
FUN_180003df0((longlong)param_1);
*param_1 = (longlong)&PTR_FUN_18007cdb8;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
if (param_1[0x13] != 0) {
SslFreeObject(param_1[0x13],0);
}
if (param_1[0x14] != 0) {
SslFreeObject(param_1[0x14],0);
}
if (param_1[0x15] != 0) {
SslFreeObject(param_1[0x15],0);
}
if (param_1[0xe] != 0) {
SslFreeObject(param_1[0xe],0);
}
lVar4 = param_1[1];
if (lVar4 != 0) {
if (*(longlong *)(lVar4 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar4 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar4 + 0x358));
}
if ((longlong *)param_1[3] != (longlong *)0x0) {
FUN_1800209bc((longlong *)param_1[3]);
}
if ((((1 < *(int *)((longlong)param_1 + 0x44) - 3U) &&
(*(int *)((longlong)param_1 + 0x44) != 0x4f)) &&
((*(uint *)(param_1 + 0x11) >> 0x12 & 1) == 0)) && (param_1[0xb] != 0)) {
*(undefined *)(param_1[0xb] + 0xec) = 0;
}
if ((longlong *)param_1[10] != (longlong *)0x0) {
FUN_180003d4c(DAT_1800927e8,(longlong *)param_1[10]);
}
lVar4 = param_1[0xb];
if (lVar4 != 0) {
FUN_180014550(*(longlong *)(lVar4 + 0xe0),lVar4,'\x01','\0');
}
lVar4 = param_1[0xf];
if (lVar4 != 0) {
LOCK();
piVar1 = (int *)(lVar4 + 0x14);
iVar2 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar2 == 1) {

}
}
*param_1 = (longlong)&PTR_FUN_18007cfb8;
return param_1;
}
=========================================
Function at address: 0x180020590
Called functions addresses: 0x180003df0 0x180028a7c 0x1800209e0 0xEXTERNAL:0000011c 0x1800726b8 0x18000909c 0x18006fe4c 0x18002a7c0 0x180003d20 0x180003d4c 0x1800726f4 0x180014550 0x180003ce4 0x180003e7c 0x1800209bc 0x180003700 0x180003ea4


longlong * FUN_180020590(longlong *param_1)

{
int *piVar1;
int iVar2;
HLOCAL pvVar3;
longlong lVar4;
longlong *plVar5;

*param_1 = (longlong)&PTR_FUN_18007c6f0;
FUN_1800209e0(param_1);
if ((HLOCAL)param_1[0x74] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x74]);
}
if ((HLOCAL)param_1[0x75] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x75]);
}
if ((HLOCAL)param_1[0x76] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x76]);
}
*param_1 = (longlong)&PTR_FUN_18007cba8;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
plVar5 = (longlong *)param_1[0x3a];
if (plVar5 != (longlong *)0x0) {
if ((*plVar5 != 0) && (plVar5[3] != 0)) {

plVar5[3] = 0;
*(undefined4 *)(plVar5 + 2) = 0;
plVar5 = (longlong *)param_1[0x3a];
}
FUN_180003700((longlong)param_1,plVar5);
}
}
else {
if ((HLOCAL)param_1[0x47] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x47]);
}
lVar4 = param_1[0x49];
if (lVar4 != 0) {
FUN_1800726b8(lVar4);
_o_free(lVar4);
param_1[0x49] = 0;
}
lVar4 = param_1[0x48];
if (lVar4 != 0) {
FUN_1800726f4(lVar4);
_o_free(lVar4);
param_1[0x48] = 0;
}
FUN_18006fe4c((longlong)param_1);
}
if ((HLOCAL)param_1[0x62] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x62]);
}
if ((HLOCAL)param_1[99] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[99]);
}
if ((HLOCAL)param_1[100] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[100]);
}
FUN_180003ea4(param_1);
if ((HLOCAL)param_1[0x66] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x66]);
}
FUN_180003e7c(param_1);
lVar4 = param_1[0x68];
if (lVar4 != 0) {
if (*(longlong *)(lVar4 + 8) != 0) {

lVar4 = param_1[0x68];
}

param_1[0x68] = 0;
}
pvVar3 = (HLOCAL)param_1[0x69];
if (pvVar3 != (HLOCAL)0x0) {
if (*(HLOCAL *)((longlong)pvVar3 + 8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)pvVar3 + 8));
pvVar3 = (HLOCAL)param_1[0x69];
}
if (*(HLOCAL *)((longlong)pvVar3 + 0x18) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)pvVar3 + 0x18));
pvVar3 = (HLOCAL)param_1[0x69];
}
FUN_18000909c(pvVar3);
param_1[0x69] = 0;
}
if ((HLOCAL)param_1[0x6a] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6a]);
}
if ((HLOCAL)param_1[0x6b] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6b]);
}
if ((HLOCAL)param_1[0x6c] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6c]);
}
FUN_180003df0((longlong)param_1);
*param_1 = (longlong)&PTR_FUN_18007cdb8;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
if (param_1[0x13] != 0) {
SslFreeObject(param_1[0x13],0);
}
if (param_1[0x14] != 0) {
SslFreeObject(param_1[0x14],0);
}
if (param_1[0x15] != 0) {
SslFreeObject(param_1[0x15],0);
}
if (param_1[0xe] != 0) {
SslFreeObject(param_1[0xe],0);
}
lVar4 = param_1[1];
if (lVar4 != 0) {
if (*(longlong *)(lVar4 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar4 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar4 + 0x358));
}
if ((longlong *)param_1[3] != (longlong *)0x0) {
FUN_1800209bc((longlong *)param_1[3]);
}
if ((((1 < *(int *)((longlong)param_1 + 0x44) - 3U) &&
(*(int *)((longlong)param_1 + 0x44) != 0x4f)) &&
((*(uint *)(param_1 + 0x11) >> 0x12 & 1) == 0)) && (param_1[0xb] != 0)) {
*(undefined *)(param_1[0xb] + 0xec) = 0;
}
if ((longlong *)param_1[10] != (longlong *)0x0) {
FUN_180003d4c(DAT_1800927e8,(longlong *)param_1[10]);
}
lVar4 = param_1[0xb];
if (lVar4 != 0) {
FUN_180014550(*(longlong *)(lVar4 + 0xe0),lVar4,'\x01','\0');
}
lVar4 = param_1[0xf];
if (lVar4 != 0) {
LOCK();
piVar1 = (int *)(lVar4 + 0x14);
iVar2 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar2 == 1) {

}
}
*param_1 = (longlong)&PTR_FUN_18007cfb8;
return param_1;
}
=========================================
Function at address: 0x1800209bc
Called functions addresses: 0x18002a7c0


/* WARNING: Switch with 1 destination removed at 0x00018002a7c0 */
/* WARNING: Switch with 1 destination removed at 0x0001800333cf */

void FUN_1800209bc(longlong *param_1)

{
longlong *plVar1;
int iVar2;

LOCK();
plVar1 = param_1 + 3;
iVar2 = *(int *)plVar1;
*(int *)plVar1 = *(int *)plVar1 + -1;
UNLOCK();
if ((iVar2 == 1) && (param_1 != (longlong *)0x0)) {
/* WARNING: Could not recover jumptable at 0x00018002a7a0. Too many branches */

(**(code **)(*param_1 + 8))(param_1,1);
return;
}
return;
}
=========================================
Function at address: 0x1800209e0
Called functions addresses: 0x18000909c 0x18002a7c0


void FUN_1800209e0(longlong *param_1)

{
int *piVar1;
int iVar2;
longlong lVar3;
longlong *plVar4;

if (param_1[0x78] != 0) {

lVar3 = param_1[0x78];
if (lVar3 != 0) {
LOCK();
piVar1 = (int *)(lVar3 + 0x1c);
iVar2 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar2 == 1) {

}
}
param_1[0x78] = 0;
}
if (param_1[0x79] != 0) {

param_1[0x79] = 0;
}
if ((HLOCAL)param_1[0x70] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x70]);
param_1[0x70] = 0;
*(undefined4 *)(param_1 + 0x6f) = 0;
}
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(undefined4 *)(param_1 + 0x6d) = 0;
if (param_1[0x72] != 0) {

param_1[0x72] = 0;
*(undefined2 *)(param_1 + 0x73) = 0;
}
*(undefined2 *)((longlong)param_1 + 0x39b) = 0;
*(undefined *)(param_1 + 0x3b) = 0;
plVar4 = (longlong *)param_1[0x3a];
if (((plVar4 != (longlong *)0x0) && (*plVar4 != 0)) && (plVar4[3] != 0)) {

plVar4[3] = 0;
*(undefined4 *)(plVar4 + 2) = 0;
}
return;
}
=========================================
Function at address: 0x180020b60
Called functions addresses: 0xEXTERNAL:0000011c 0x18000909c 0x18002a7c0


void FUN_180020b60(undefined8 *param_1)

{
longlong lVar1;
undefined8 *puVar2;

*param_1 = &PTR_FUN_18007cb60;
if (param_1[9] != 0) {
SslFreeObject(param_1[9],0);
}
if (param_1[0xc] != 0) {
SslFreeObject(param_1[0xc],0);
}
if ((HLOCAL)param_1[0x14] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x14]);
}
if (param_1[10] != 0) {
SslFreeObject(param_1[10],0);
param_1[10] = 0;
}
if (param_1[0xb] != 0) {
SslFreeObject(param_1[0xb],0);
param_1[0xb] = 0;
}
param_1[0x12] = 0;
param_1[0x10] = 0;
puVar2 = param_1 + 0xe;
for (lVar1 = 8; lVar1 != 0; lVar1 = lVar1 + -1) {
*(undefined *)puVar2 = 0;
puVar2 = (undefined8 *)((longlong)puVar2 + 1);
}
*(undefined *)(param_1 + 0xf) = 0;
puVar2 = param_1 + 0x15;
for (lVar1 = 0x20; lVar1 != 0; lVar1 = lVar1 + -1) {
*(undefined *)puVar2 = 0;
puVar2 = (undefined8 *)((longlong)puVar2 + 1);
}
*(undefined *)(param_1 + 0x19) = 0;

param_1[2] = &PTR_FUN_18007cb58;
return;
}
=========================================
Function at address: 0x180020c30
Called functions addresses: 0xEXTERNAL:00000040 0x18000909c 0x18002a7c0


void FUN_180020c30(undefined8 *param_1)

{
*param_1 = &PTR_FUN_18007cb80;
if ((HLOCAL)param_1[0x16] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x16]);
}
if ((HLOCAL)param_1[0x18] != (HLOCAL)0x0) {
LocalFree((HLOCAL)param_1[0x18]);
}

if (param_1[2] != 0) {

}
if ((HLOCAL)param_1[7] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[7]);
}
if ((HLOCAL)param_1[0x12] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x12]);
}
return;
}
=========================================
Function at address: 0x180020cd0
Called functions addresses: 0xEXTERNAL:0000013c 0xEXTERNAL:0000011c 0x180016828 0x18000909c 0x18002a7c0


void FUN_180020cd0(longlong *param_1)

{
longlong *plVar1;

if ((PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)param_1[0xbd] != (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)0x0
) {
CertFreeServerOcspResponseContext((PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)param_1[0xbd]);
param_1[0xbd] = 0;
}
if (param_1[0x8a] != 0) {
SslFreeObject(param_1[0x8a],0);
param_1[0x8a] = 0;
}
if ((HLOCAL)param_1[0x99] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x99]);
param_1[0x99] = 0;
}
*(undefined *)(param_1 + 0x9a) = 0;
if (param_1[0x82] != 0) {
SslFreeObject(param_1[0x82],0);
param_1[0x82] = 0;
}
if (param_1[0x83] != 0) {
SslFreeObject(param_1[0x83],0);
param_1[0x83] = 0;
}
if (param_1[0x84] != 0) {
SslFreeObject(param_1[0x84],0);
param_1[0x84] = 0;
}
if (param_1[0x85] != 0) {
SslFreeObject(param_1[0x85],0);
param_1[0x85] = 0;
}
if (param_1[0x9b] != 0) {
SslFreeObject(param_1[0x9b],0);
param_1[0x9b] = 0;
}
if (param_1[0x78] != 0) {
plVar1 = param_1;

FUN_180016828(plVar1,(longlong *)param_1[0x78]);
param_1[0x78] = 0;
}
if (param_1[0x79] != 0) {

param_1[0x79] = 0;
}
if ((HLOCAL)param_1[0x70] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x70]);
param_1[0x70] = 0;
*(undefined4 *)(param_1 + 0x6f) = 0;
}
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(undefined4 *)(param_1 + 0x6d) = 0;
if (param_1[0x72] != 0) {

param_1[0x72] = 0;
*(undefined2 *)(param_1 + 0x73) = 0;
}
*(undefined2 *)((longlong)param_1 + 0x39b) = 0;
*(undefined *)(param_1 + 0x3b) = 0;
plVar1 = (longlong *)param_1[0x3a];
if (((plVar1 != (longlong *)0x0) && (*plVar1 != 0)) && (plVar1[3] != 0)) {

plVar1[3] = 0;
*(undefined4 *)(plVar1 + 2) = 0;
}
return;
}
=========================================
Function at address: 0x180020df0
Called functions addresses: 0x180028d90 0x1800212d0 0x180003700


undefined8 * FUN_180020df0(undefined8 *param_1,longlong param_2)

{
undefined8 uVar1;
longlong lVar2;

lVar2 = param_2;
FUN_1800212d0(param_1,param_2);
*param_1 = &PTR_FUN_18007cba8;
*(undefined4 *)(param_1 + 0x2a) = *(undefined4 *)(lVar2 + 0x150);
*(undefined *)((longlong)param_1 + 0x154) = *(undefined *)(lVar2 + 0x154);
*(undefined4 *)(param_1 + 0x34) = *(undefined4 *)(lVar2 + 0x1a0);
*(undefined4 *)(param_1 + 0x39) = *(undefined4 *)(lVar2 + 0x1c8);
param_1[0x3a] = *(undefined8 *)(lVar2 + 0x1d0);
*(undefined *)(param_1 + 0x3b) = *(undefined *)(lVar2 + 0x1d8);
*(undefined *)((longlong)param_1 + 0x1d9) = *(undefined *)(lVar2 + 0x1d9);
uVar1 = *(undefined8 *)(lVar2 + 0x1e2);
*(undefined8 *)((longlong)param_1 + 0x1da) = *(undefined8 *)(lVar2 + 0x1da);
*(undefined8 *)((longlong)param_1 + 0x1e2) = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x1f2);
*(undefined8 *)((longlong)param_1 + 0x1ea) = *(undefined8 *)(lVar2 + 0x1ea);
*(undefined8 *)((longlong)param_1 + 0x1f2) = uVar1;
*(undefined4 *)((longlong)param_1 + 0x1fa) = *(undefined4 *)(lVar2 + 0x1fa);
uVar1 = *(undefined8 *)(lVar2 + 0x206);
*(undefined8 *)((longlong)param_1 + 0x1fe) = *(undefined8 *)(lVar2 + 0x1fe);
*(undefined8 *)((longlong)param_1 + 0x206) = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x216);
*(undefined8 *)((longlong)param_1 + 0x20e) = *(undefined8 *)(lVar2 + 0x20e);
*(undefined8 *)((longlong)param_1 + 0x216) = uVar1;
*(undefined4 *)((longlong)param_1 + 0x21e) = *(undefined4 *)(lVar2 + 0x21e);
*(undefined4 *)((longlong)param_1 + 0x224) = *(undefined4 *)(lVar2 + 0x224);
*(undefined *)(param_1 + 0x45) = *(undefined *)(lVar2 + 0x228);
*(undefined *)((longlong)param_1 + 0x229) = *(undefined *)(lVar2 + 0x229);
*(undefined *)((longlong)param_1 + 0x22a) = *(undefined *)(lVar2 + 0x22a);
*(undefined *)((longlong)param_1 + 0x22b) = *(undefined *)(lVar2 + 0x22b);
*(undefined *)((longlong)param_1 + 0x22c) = *(undefined *)(lVar2 + 0x22c);
*(undefined4 *)(param_1 + 0x46) = *(undefined4 *)(lVar2 + 0x230);
*(undefined4 *)((longlong)param_1 + 0x234) = *(undefined4 *)(lVar2 + 0x234);
param_1[0x47] = *(undefined8 *)(lVar2 + 0x238);
param_1[0x48] = *(undefined8 *)(lVar2 + 0x240);
param_1[0x49] = *(undefined8 *)(lVar2 + 0x248);
param_1[0x62] = *(undefined8 *)(lVar2 + 0x310);
param_1[100] = *(undefined8 *)(lVar2 + 800);
param_1[0x65] = *(undefined8 *)(lVar2 + 0x328);
param_1[0x66] = *(undefined8 *)(lVar2 + 0x330);
param_1[0x67] = *(undefined8 *)(lVar2 + 0x338);
param_1[0x68] = *(undefined8 *)(lVar2 + 0x340);
param_1[0x69] = *(undefined8 *)(lVar2 + 0x348);
param_1[0x6a] = *(undefined8 *)(lVar2 + 0x350);
param_1[0x6b] = *(undefined8 *)(lVar2 + 0x358);
param_1[0x6c] = *(undefined8 *)(lVar2 + 0x360);
*(undefined4 *)(param_1 + 0x6d) = *(undefined4 *)(lVar2 + 0x368);
param_1[0x6e] = *(undefined8 *)(lVar2 + 0x370);
*(undefined4 *)(param_1 + 0x6f) = *(undefined4 *)(lVar2 + 0x378);
param_1[0x70] = *(undefined8 *)(lVar2 + 0x380);
param_1[0x71] = *(undefined8 *)(lVar2 + 0x388);
param_1[0x72] = *(undefined8 *)(lVar2 + 0x390);
*(undefined2 *)(param_1 + 0x73) = *(undefined2 *)(lVar2 + 0x398);
*(undefined *)((longlong)param_1 + 0x39a) = *(undefined *)(lVar2 + 0x39a);
*(undefined *)((longlong)param_1 + 0x39b) = *(undefined *)(lVar2 + 0x39b);
*(undefined *)((longlong)param_1 + 0x39c) = *(undefined *)(lVar2 + 0x39c);
*(undefined *)((longlong)param_1 + 0x39d) = *(undefined *)(lVar2 + 0x39d);
uVar1 = *(undefined8 *)(lVar2 + 0x2d8);
param_1[0x5a] = *(undefined8 *)(lVar2 + 0x2d0);
param_1[0x5b] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x2e8);
param_1[0x5c] = *(undefined8 *)(lVar2 + 0x2e0);
param_1[0x5d] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x2f8);
param_1[0x5e] = *(undefined8 *)(lVar2 + 0x2f0);
param_1[0x5f] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x308);
param_1[0x60] = *(undefined8 *)(lVar2 + 0x300);
param_1[0x61] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 600);
param_1[0x4a] = *(undefined8 *)(lVar2 + 0x250);
param_1[0x4b] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x268);
param_1[0x4c] = *(undefined8 *)(lVar2 + 0x260);
param_1[0x4d] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x278);
param_1[0x4e] = *(undefined8 *)(lVar2 + 0x270);
param_1[0x4f] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x288);
param_1[0x50] = *(undefined8 *)(lVar2 + 0x280);
param_1[0x51] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x298);
param_1[0x52] = *(undefined8 *)(lVar2 + 0x290);
param_1[0x53] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x2a8);
param_1[0x54] = *(undefined8 *)(lVar2 + 0x2a0);
param_1[0x55] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x2b8);
param_1[0x56] = *(undefined8 *)(lVar2 + 0x2b0);
param_1[0x57] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x2c8);
param_1[0x58] = *(undefined8 *)(lVar2 + 0x2c0);
param_1[0x59] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x1ac);
*(undefined8 *)((longlong)param_1 + 0x1a4) = *(undefined8 *)(lVar2 + 0x1a4);
*(undefined8 *)((longlong)param_1 + 0x1ac) = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x1bc);
*(undefined8 *)((longlong)param_1 + 0x1b4) = *(undefined8 *)(lVar2 + 0x1b4);
*(undefined8 *)((longlong)param_1 + 0x1bc) = uVar1;
*(undefined4 *)((longlong)param_1 + 0x1c4) = *(undefined4 *)(lVar2 + 0x1c4);
uVar1 = *(undefined8 *)(lVar2 + 0x181);
*(undefined8 *)((longlong)param_1 + 0x179) = *(undefined8 *)(lVar2 + 0x179);
*(undefined8 *)((longlong)param_1 + 0x181) = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x191);
*(undefined8 *)((longlong)param_1 + 0x189) = *(undefined8 *)(lVar2 + 0x189);
*(undefined8 *)((longlong)param_1 + 0x191) = uVar1;
*(undefined4 *)((longlong)param_1 + 0x199) = *(undefined4 *)(lVar2 + 0x199);
uVar1 = *(undefined8 *)(lVar2 + 0x15d);
*(undefined8 *)((longlong)param_1 + 0x155) = *(undefined8 *)(lVar2 + 0x155);
*(undefined8 *)((longlong)param_1 + 0x15d) = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x16d);
*(undefined8 *)((longlong)param_1 + 0x165) = *(undefined8 *)(lVar2 + 0x165);
*(undefined8 *)((longlong)param_1 + 0x16d) = uVar1;
*(undefined4 *)((longlong)param_1 + 0x175) = *(undefined4 *)(lVar2 + 0x175);
uVar1 = *(undefined8 *)(lVar2 + 0x118);
param_1[0x22] = *(undefined8 *)(lVar2 + 0x110);
param_1[0x23] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x128);
param_1[0x24] = *(undefined8 *)(lVar2 + 0x120);
param_1[0x25] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x138);
param_1[0x26] = *(undefined8 *)(lVar2 + 0x130);
param_1[0x27] = uVar1;
uVar1 = *(undefined8 *)(lVar2 + 0x148);
param_1[0x28] = *(undefined8 *)(lVar2 + 0x140);
param_1[0x29] = uVar1;
*(undefined8 *)(lVar2 + 0x380) = 0;
*(undefined4 *)(lVar2 + 0x378) = 0;
*(undefined8 *)(lVar2 + 0x370) = 0;
*(undefined4 *)(lVar2 + 0x368) = 0;
*(undefined8 *)(lVar2 + 0x390) = 0;
*(undefined2 *)(lVar2 + 0x398) = 0;
*(undefined8 *)(lVar2 + 0x1d0) = 0;
*(undefined8 *)(lVar2 + 0x230) = 0;
*(undefined8 *)(lVar2 + 0x238) = 0;
*(undefined8 *)(lVar2 + 0x248) = 0;
*(undefined8 *)(lVar2 + 0x240) = 0;
*(undefined8 *)(lVar2 + 0x310) = 0;
*(undefined8 *)(lVar2 + 800) = 0;
*(undefined8 *)(lVar2 + 0x328) = 0;
if (*(HLOCAL *)(lVar2 + 0x318) != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,*(HLOCAL *)(lVar2 + 0x318));
*(undefined8 *)(param_2 + 0x318) = 0;
}
*(undefined8 *)(param_2 + 0x330) = 0;
*(undefined8 *)(param_2 + 0x338) = 0;
*(undefined8 *)(param_2 + 0x340) = 0;
*(undefined8 *)(param_2 + 0x348) = 0;
*(undefined8 *)(param_2 + 0x350) = 0;
*(undefined8 *)(param_2 + 0x358) = 0;
*(undefined8 *)(param_2 + 0x360) = 0;
memset((undefined8 *)(lVar2 + 0x250),0,0x80);
memset((void *)(param_2 + 0x2d0),0,0x40);
*(undefined4 *)(param_2 + 0x224) = 0;
*(undefined2 *)(param_2 + 0x1da) = 0;
*(undefined4 *)(param_2 + 0x1fc) = 0;
*(undefined2 *)(param_2 + 0x220) = 0;
*(undefined *)(param_2 + 0x1d9) = 0;
return param_1;
}
=========================================
Function at address: 0x1800212d0
Called functions addresses: None


undefined8 * FUN_1800212d0(undefined8 *param_1,longlong param_2)

{
*param_1 = &PTR_FUN_18007cdb8;
param_1[1] = *(undefined8 *)(param_2 + 8);
*(undefined4 *)(param_1 + 2) = *(undefined4 *)(param_2 + 0x10);
*(undefined4 *)((longlong)param_1 + 0x14) = *(undefined4 *)(param_2 + 0x14);
param_1[3] = *(undefined8 *)(param_2 + 0x18);
*(undefined2 *)(param_1 + 4) = *(undefined2 *)(param_2 + 0x20);
*(undefined2 *)((longlong)param_1 + 0x22) = *(undefined2 *)(param_2 + 0x22);
*(undefined4 *)((longlong)param_1 + 0x24) = *(undefined4 *)(param_2 + 0x24);
*(undefined4 *)(param_1 + 5) = *(undefined4 *)(param_2 + 0x28);
*(undefined4 *)((longlong)param_1 + 0x2c) = *(undefined4 *)(param_2 + 0x2c);
*(undefined4 *)(param_1 + 6) = *(undefined4 *)(param_2 + 0x30);
*(undefined4 *)((longlong)param_1 + 0x34) = *(undefined4 *)(param_2 + 0x34);
*(undefined4 *)(param_1 + 7) = *(undefined4 *)(param_2 + 0x38);
*(undefined4 *)((longlong)param_1 + 0x3c) = *(undefined4 *)(param_2 + 0x3c);
*(undefined4 *)(param_1 + 8) = *(undefined4 *)(param_2 + 0x40);
*(undefined4 *)((longlong)param_1 + 0x44) = *(undefined4 *)(param_2 + 0x44);
*(undefined4 *)(param_1 + 9) = *(undefined4 *)(param_2 + 0x48);
param_1[10] = *(undefined8 *)(param_2 + 0x50);
param_1[0xb] = *(undefined8 *)(param_2 + 0x58);
*(undefined *)(param_1 + 0xc) = *(undefined *)(param_2 + 0x60);
*(undefined *)((longlong)param_1 + 0x61) = *(undefined *)(param_2 + 0x61);
param_1[0xd] = *(undefined8 *)(param_2 + 0x68);
param_1[0xe] = *(undefined8 *)(param_2 + 0x70);
param_1[0xf] = *(undefined8 *)(param_2 + 0x78);
param_1[0x10] = *(undefined8 *)(param_2 + 0x80);
param_1[0x11] = *(undefined8 *)(param_2 + 0x88);
param_1[0x12] = *(undefined8 *)(param_2 + 0x90);
param_1[0x13] = *(undefined8 *)(param_2 + 0x98);
param_1[0x14] = *(undefined8 *)(param_2 + 0xa0);
param_1[0x15] = *(undefined8 *)(param_2 + 0xa8);
param_1[0x16] = *(undefined8 *)(param_2 + 0xb0);
param_1[0x17] = *(undefined8 *)(param_2 + 0xb8);
*(undefined4 *)(param_1 + 0x18) = *(undefined4 *)(param_2 + 0xc0);
param_1[0x19] = *(undefined8 *)(param_2 + 200);
param_1[0x1a] = *(undefined8 *)(param_2 + 0xd0);
*(undefined2 *)(param_1 + 0x1b) = *(undefined2 *)(param_2 + 0xd8);
*(undefined2 *)((longlong)param_1 + 0xda) = *(undefined2 *)(param_2 + 0xda);
*(undefined2 *)((longlong)param_1 + 0xdc) = *(undefined2 *)(param_2 + 0xdc);
param_1[0x1c] = *(undefined8 *)(param_2 + 0xe0);
*(undefined *)(param_1 + 0x1d) = *(undefined *)(param_2 + 0xe8);
*(undefined *)((longlong)param_1 + 0xe9) = *(undefined *)(param_2 + 0xe9);
*(undefined2 *)((longlong)param_1 + 0xea) = *(undefined2 *)(param_2 + 0xea);
param_1[0x1e] = *(undefined8 *)(param_2 + 0xf0);
param_1[0x1f] = *(undefined8 *)(param_2 + 0xf8);
param_1[0x20] = *(undefined8 *)(param_2 + 0x100);
*(undefined *)(param_1 + 0x21) = *(undefined *)(param_2 + 0x108);
*(undefined *)((longlong)param_1 + 0x109) = *(undefined *)(param_2 + 0x109);
*(undefined *)((longlong)param_1 + 0x10a) = *(undefined *)(param_2 + 0x10a);
*(undefined8 *)(param_2 + 0x90) = 0;
*(undefined8 *)(param_2 + 0x98) = 0;
*(undefined8 *)(param_2 + 0xa0) = 0;
*(undefined8 *)(param_2 + 0xa8) = 0;
*(undefined8 *)(param_2 + 0x70) = 0;
*(undefined8 *)(param_2 + 8) = 0;
*(undefined8 *)(param_2 + 0x18) = 0;
*(undefined8 *)(param_2 + 0x58) = 0;
*(undefined8 *)(param_2 + 0x50) = 0;
*(undefined8 *)(param_2 + 0x78) = 0;
return param_1;
}
=========================================
Function at address: 0x180021510
Called functions addresses: 0x180028a7c


undefined8 * FUN_180021510(undefined8 *param_1,byte param_2)

{
*param_1 = &PTR_FUN_18007d038;
if ((param_2 & 1) != 0) {
_o_free();
}
return param_1;
}
=========================================
Function at address: 0x180021540
Called functions addresses: 0xEXTERNAL:00000072 0x18003f3d9 0x1800136a0 0x180027af0 0xEXTERNAL:00000071 0x1800293fb 0x180028070 0x1800234bc 0x18002a76f


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180021540(longlong param_1)

{
PSRWLOCK SRWLock;
int *piVar1;
longlong lVar2;
byte bVar3;
longlong *plVar4;
int iVar5;
longlong lVar6;
byte *pbVar7;
byte *pbVar8;
undefined8 uVar9;
ulonglong uVar10;
uint uVar11;
byte bVar12;
ulonglong *puVar13;
uint uVar14;
longlong lVar15;
ushort uVar16;
uint uVar17;
_EVENT_DATA_DESCRIPTOR *p_Var18;
ulonglong uVar19;
ulonglong uVar20;
undefined auStackY_5d8 [32];
undefined local_5a8;
undefined local_5a7 [7];
ulonglong local_5a0;
ushort local_598;
undefined2 local_596;
undefined2 local_594 [2];
undefined4 local_590;
undefined4 local_58c;
undefined4 local_588;
undefined4 local_584;
undefined4 local_580;
undefined4 local_57c;
undefined4 local_578;
undefined4 local_574;
undefined4 local_570;
undefined4 local_56c;
undefined4 local_568;
undefined4 local_564;
uint local_560 [2];
longlong local_558;
EVENT_DESCRIPTOR local_550;
undefined8 local_540;
ulonglong local_538;
ulonglong local_530;
ulonglong local_528;
ulonglong local_520;
ulonglong local_518;
ulonglong local_510;
ulonglong local_508;
ulonglong local_500;
ulonglong local_4f8;
ulonglong local_4f0;
ulonglong local_4e8;
ulonglong local_4e0;
ulonglong local_4d8;
ulonglong local_4d0;
ulonglong local_4c8;
ulonglong local_4c0;
ulonglong local_4b8;
ulonglong local_4b0;
ulonglong local_4a8;
ulonglong local_4a0;
ulonglong local_498;
ulonglong local_490;
ulonglong local_488;
ulonglong local_480;
ulonglong local_478;
ulonglong local_470;
ulonglong local_468;
ulonglong local_460;
ulonglong local_458;
ulonglong local_450;
ulonglong local_448;
ulonglong local_440;
undefined8 local_438;
undefined8 local_430;
longlong local_428;
ushort local_420 [4];
longlong local_418;
ushort local_410 [4];
undefined *local_408;
_EVENT_DATA_DESCRIPTOR local_3f8;
undefined *local_3e8;
undefined4 local_3e0;
undefined4 local_3dc;
undefined8 *local_3d8;
undefined8 local_3d0;
ulonglong *local_3c8;
undefined8 local_3c0;
ulonglong *local_3b8;
undefined8 local_3b0;
ulonglong *local_3a8;
undefined8 local_3a0;
ulonglong *local_398;
undefined8 local_390;
ulonglong *local_388;
undefined8 local_380;
ulonglong *local_378;
undefined8 local_370;
ulonglong *local_368;
undefined8 local_360;
ulonglong *local_358;
undefined8 local_350;
ulonglong *local_348;
undefined8 local_340;
ulonglong *local_338;
undefined8 local_330;
ulonglong *local_328;
undefined8 local_320;
ulonglong *local_318;
undefined8 local_310;
ulonglong *local_308;
undefined8 local_300;
ulonglong *local_2f8;
undefined8 local_2f0;
ulonglong *local_2e8;
undefined8 local_2e0;
ulonglong *local_2d8;
undefined8 local_2d0;
ulonglong *local_2c8;
undefined8 local_2c0;
ulonglong *local_2b8;
undefined8 local_2b0;
ulonglong *local_2a8;
undefined8 local_2a0;
ulonglong *local_298;
undefined8 local_290;
ulonglong *local_288;
undefined8 local_280;
ulonglong *local_278;
undefined8 local_270;
ulonglong *local_268;
undefined8 local_260;
ulonglong *local_258;
undefined8 local_250;
ulonglong *local_248;
undefined8 local_240;
ulonglong *local_238;
undefined8 local_230;
ulonglong *local_228;
undefined8 local_220;
ulonglong *local_218;
undefined8 local_210;
ulonglong *local_208;
undefined8 local_200;
ulonglong *local_1f8;
undefined8 local_1f0;
ulonglong *local_1e8;
undefined8 local_1e0;
ulonglong *local_1d8;
undefined8 local_1d0;
uint *local_1c8;
undefined8 local_1c0;
undefined *local_1b8;
int local_1b0;
undefined4 local_1ac;
undefined *local_1a8;
undefined8 local_1a0;
undefined8 *local_198;
undefined8 local_190;
undefined8 *local_188;
undefined8 local_180;
undefined2 *local_178;
undefined8 local_170;
undefined2 *local_168;
undefined8 local_160;
undefined4 *local_158;
undefined8 local_150;
undefined4 *local_148;
undefined8 local_140;
ushort *local_138;
undefined8 local_130;
longlong local_128;
int local_120;
undefined4 local_11c;
ushort *local_118;
undefined8 local_110;
undefined4 *local_108;
undefined8 local_100;
undefined4 *local_f8;
undefined8 local_f0;
undefined4 *local_e8;
undefined8 local_e0;
undefined4 *local_d8;
undefined8 local_d0;
undefined4 *local_c8;
undefined8 local_c0;
undefined4 *local_b8;
undefined8 local_b0;
undefined4 *local_a8;
undefined8 local_a0;
undefined *local_98;
undefined8 local_90;
undefined4 *local_88;
undefined8 local_80;
undefined4 *local_78;
undefined8 local_70;
ushort *local_68;
undefined8 local_60;
longlong local_58;
int local_50;
undefined4 local_4c;
undefined4 *local_48;
undefined8 local_40;
ulonglong local_38;

lVar15 = DAT_1800914b0;
local_38 = DAT_180091970 ^ (ulonglong)auStackY_5d8;
uVar17 = *(uint *)(param_1 + 0x20) >> 4;
uVar16 = 1 << ((byte)*(uint *)(param_1 + 0x20) & 0xf);
if (((5 < DAT_180091480) && ((_DAT_180091490 & 0x400000000000) != 0)) &&
((DAT_180091498 & 0x400000000000) == DAT_180091498)) {
local_590 = *(undefined4 *)(param_1 + 0x62c);
local_428 = param_1 + 0x498;
local_598 = *(ushort *)(param_1 + 0x6f8);
local_418 = param_1 + 0x630;
local_420[0] = *(ushort *)(param_1 + 0x628);
local_408 = (undefined *)(param_1 + 0x298);
uVar20 = 0;
local_58c = *(undefined4 *)(param_1 + 0x2c);
local_588 = *(undefined4 *)(param_1 + 0x70);
local_5a8 = *(undefined *)(param_1 + 0x6c);
local_584 = *(undefined4 *)(param_1 + 0x68);
local_580 = *(undefined4 *)(param_1 + 0x3c);
local_57c = *(undefined4 *)(param_1 + 0x38);
local_578 = *(undefined4 *)(param_1 + 0x34);
local_574 = *(undefined4 *)(param_1 + 0x30);
local_570 = *(undefined4 *)(param_1 + 0x28);
local_56c = *(undefined4 *)(param_1 + 0x24);
local_568 = *(undefined4 *)(param_1 + 0x48);
local_564 = *(undefined4 *)(param_1 + 0x44);
local_596 = *(undefined2 *)(param_1 + 0x42);
local_594[0] = *(undefined2 *)(param_1 + 0x40);
local_430 = *(undefined8 *)(param_1 + 0x80);
local_540 = *(undefined8 *)(param_1 + 0x78);
local_5a7[0] = *(undefined *)(param_1 + 0x18);
local_538 = uVar20;
if ((short)uVar16 < 0) {
local_538 = *(ulonglong *)(param_1 + 0x60);
}
local_530 = uVar20;
if ((uVar16 >> 0xe & 1) != 0) {
local_530 = *(ulonglong *)(param_1 + 0x60);
}
local_528 = uVar20;
if ((uVar16 >> 0xd & 1) != 0) {
local_528 = *(ulonglong *)(param_1 + 0x60);
}
local_520 = uVar20;
if ((uVar16 >> 0xc & 1) != 0) {
local_520 = *(ulonglong *)(param_1 + 0x60);
}
local_518 = uVar20;
if ((uVar16 >> 0xb & 1) != 0) {
local_518 = *(ulonglong *)(param_1 + 0x60);
}
local_510 = uVar20;
if ((uVar16 >> 10 & 1) != 0) {
local_510 = *(ulonglong *)(param_1 + 0x60);
}
local_508 = uVar20;
if ((uVar16 & 0x200) != 0) {
local_508 = *(ulonglong *)(param_1 + 0x60);
}
local_500 = uVar20;
if ((uVar16 & 0x100) != 0) {
local_500 = *(ulonglong *)(param_1 + 0x60);
}
local_4f8 = uVar20;
if ((char)uVar16 < '\0') {
local_4f8 = *(ulonglong *)(param_1 + 0x60);
}
local_4f0 = uVar20;
if ((uVar16 & 0x40) != 0) {
local_4f0 = *(ulonglong *)(param_1 + 0x60);
}
local_4e8 = uVar20;
if ((uVar16 & 0x20) != 0) {
local_4e8 = *(ulonglong *)(param_1 + 0x60);
}
local_4e0 = uVar20;
if ((uVar16 & 0x10) != 0) {
local_4e0 = *(ulonglong *)(param_1 + 0x60);
}
local_4d8 = uVar20;
if ((uVar16 & 8) != 0) {
local_4d8 = *(ulonglong *)(param_1 + 0x60);
}
local_4d0 = uVar20;
if ((uVar16 & 4) != 0) {
local_4d0 = *(ulonglong *)(param_1 + 0x60);
}
local_4c8 = uVar20;
if ((uVar16 & 2) != 0) {
local_4c8 = *(ulonglong *)(param_1 + 0x60);
}
local_4c0 = uVar20;
if ((uVar16 & 1) != 0) {
local_4c0 = *(ulonglong *)(param_1 + 0x60);
}
uVar11 = (uint)uVar16;
local_438 = 1;
local_4b8 = (ulonglong)(uVar11 & 0x8000);
local_40 = 4;
local_4b0 = (ulonglong)(uVar16 & 0x4000);
local_60 = 2;
local_4a8 = (ulonglong)(uVar11 & 0x2000);
local_58 = local_428;
local_4a0 = (ulonglong)(uVar11 & 0x1000);
local_4c = 0;
local_498 = (ulonglong)(uVar11 & 0x800);
local_70 = 4;
local_490 = (ulonglong)(uVar11 & 0x400);
local_80 = 4;
local_488 = (ulonglong)uVar11 & 0x200;
local_90 = 1;
local_480 = (ulonglong)uVar11 & 0x100;
local_a0 = 4;
local_478 = (ulonglong)(uVar11 & 0x80);
local_b0 = 4;
local_470 = (ulonglong)(uVar11 & 0x40);
local_c0 = 4;
local_468 = (ulonglong)(uVar11 & 0x20);
local_460 = (ulonglong)(uVar11 & 0x10);
local_458 = (ulonglong)(uVar11 & 8);
local_450 = (ulonglong)(uVar11 & 4);
local_448 = (ulonglong)(uVar11 & 2);
local_440 = (ulonglong)(uVar11 & 1);
local_48 = &local_590;
local_68 = local_420;
local_50 = (uint)local_420[0] << 2;
local_78 = &local_58c;
local_88 = &local_588;
local_98 = &local_5a8;
local_a8 = &local_584;
local_b8 = &local_580;
local_c8 = &local_57c;
local_d8 = &local_578;
local_d0 = 4;
local_e8 = &local_574;
local_f8 = &local_570;
local_108 = &local_56c;
local_118 = &local_598;
local_138 = local_410;
local_120 = (uint)local_598 << 2;
local_148 = &local_568;
local_158 = &local_564;
local_168 = &local_596;
local_178 = local_594;
local_188 = &local_430;
local_198 = &local_540;
local_1a8 = local_5a7;
local_e0 = 4;
local_f0 = 4;
local_100 = 4;
local_110 = 2;
local_130 = 2;
local_128 = local_418;
local_11c = 0;
local_140 = 4;
local_150 = 4;
local_160 = 2;
local_170 = 2;
local_180 = 8;
local_190 = 8;
local_1a0 = 1;
if (local_408 == (undefined *)0x0) {
local_1b8 = &DAT_18008233c;
local_1b0 = 2;
}
else {
lVar6 = -1;
do {
lVar2 = lVar6 * 2;
lVar6 = lVar6 + 1;
} while (*(short *)(param_1 + 0x29a + lVar2) != 0);
local_1b0 = (int)lVar6 * 2 + 2;
local_1b8 = local_408;
}
local_1c8 = local_560;
local_1d8 = &local_538;
local_1e8 = &local_530;
local_1f8 = &local_528;
local_208 = &local_520;
local_218 = &local_518;
local_228 = &local_510;
local_238 = &local_508;
local_248 = &local_500;
local_258 = &local_4f8;
local_268 = &local_4f0;
local_278 = &local_4e8;
local_288 = &local_4e0;
local_298 = &local_4d8;
local_2a8 = &local_4d0;
local_2b8 = &local_4c8;
local_2c8 = &local_4c0;
local_2d8 = &local_4b8;
local_2e8 = &local_4b0;
local_2f8 = &local_4a8;
local_308 = &local_4a0;
local_318 = &local_498;
local_328 = &local_490;
local_338 = &local_488;
local_348 = &local_480;
local_358 = &local_478;
local_1ac = 0;
local_1c0 = 4;
local_1d0 = 8;
local_1e0 = 8;
local_1f0 = 8;
local_200 = 8;
local_210 = 8;
local_220 = 8;
local_230 = 8;
local_240 = 8;
local_250 = 8;
local_260 = 8;
local_270 = 8;
local_280 = 8;
local_290 = 8;
local_2a0 = 8;
local_2b0 = 8;
local_2c0 = 8;
local_2d0 = 8;
local_2e0 = 8;
local_2f0 = 8;
local_300 = 8;
local_310 = 8;
local_320 = 8;
local_330 = 8;
local_340 = 8;
local_350 = 8;
local_360 = 8;
local_368 = &local_470;
local_370 = 8;
local_378 = &local_468;
local_388 = &local_460;
local_398 = &local_458;
local_3a8 = &local_450;
local_3b8 = &local_448;
local_3c8 = &local_440;
local_3d8 = &local_438;
local_550._4_4_ = ZEXT24(DAT_180083f62);
local_3f8.Ptr = (ULONGLONG)PTR_DAT_180091488;
local_380 = 8;
local_390 = 8;
local_3a0 = 8;
local_3b0 = 8;
local_3c0 = 8;
local_3d0 = 8;
local_550.Id = 0;
local_550.Version = '\0';
local_550.Channel = '\v';
local_550.Keyword = 0x400000000000;
local_3f8.Size = (uint)*(ushort *)PTR_DAT_180091488;
local_3e8 = &DAT_180083f6c;
local_3f8.Reserved = 2;
local_3e0 = 0x471;
local_3dc = 1;
local_5a0 = CONCAT44(local_5a0._4_4_,0xbe9);
local_560[0] = uVar17;
local_410[0] = local_598;
if (DAT_1800914a8 == FUN_180027af0) {
pbVar7 = &DAT_180083f6e;
do {
bVar12 = *pbVar7;
pbVar7 = pbVar7 + 1;
} while ((char)bVar12 < '\0');
do {
bVar12 = *pbVar7;
pbVar7 = pbVar7 + 1;
} while (bVar12 != 0);
uVar19 = 0;
if (pbVar7 < &DAT_1800843dd) {
while( true ) {
do {
pbVar8 = pbVar7;
uVar17 = (uint)uVar19;
pbVar7 = pbVar8 + 1;
} while (*pbVar8 != 0);
bVar12 = pbVar8[1];
if (-1 < (char)bVar12) break;
pbVar7 = pbVar8 + 3;
if (-1 < (char)pbVar8[2]) break;
bVar3 = *pbVar7;
while ((char)bVar3 < '\0') {
if (bVar3 != 0x80) goto LAB_180021eec;
pbVar8 = pbVar7 + 1;
pbVar7 = pbVar7 + 1;
bVar3 = *pbVar8;
}
if (((bVar12 & 0x7f) != 9) || (2 < (byte)(bVar3 + 0x8f))) break;
bVar12 = (char)uVar19 + 1;
uVar17 = (uint)bVar12;
*(byte *)((longlong)&local_3d0 + uVar19 * 0x10 + 5) = bVar3;
uVar19 = (ulonglong)bVar12;
if (&UNK_1800843dc < pbVar7) break;
}
LAB_180021eec:
if ((byte)uVar17 != 0) {
local_5a0 = 0;
local_558 = DAT_1800914b0;
uVar11 = 0x2e62a8e;
bVar12 = (byte)(uVar17 + 2);
if (bVar12 < 0x3c) {
p_Var18 = &local_3f8 + (uVar17 + 2 & 0xff);
uVar19 = (ulonglong)(byte)(0x3c - bVar12);
do {
uVar10 = uVar20;
if ((ulonglong)p_Var18->Size != 0) {
do {
pbVar7 = (byte *)(uVar10 + p_Var18->Ptr);
uVar10 = uVar10 + 1;
uVar11 = (*pbVar7 + uVar11) * 0x401;
uVar11 = uVar11 ^ uVar11 >> 6;
} while (uVar10 < p_Var18->Size);
}
p_Var18 = p_Var18 + 1;
uVar19 = uVar19 - 1;
} while (uVar19 != 0);
}
SRWLock = (PSRWLOCK)(DAT_1800914b0 + 0x108);
uVar11 = (uVar11 * 9 >> 0xb ^ uVar11 * 9) * 0x8001;
AcquireSRWLockShared(SRWLock);
puVar13 = (ulonglong *)(lVar15 + (ulonglong)(uVar11 & 0x1f) * 8);
do {
if (*puVar13 == 0) {
if (0x3ff < *(uint *)(lVar15 + 0x100)) {
*(int *)(lVar15 + 300) = *(int *)(lVar15 + 300) + 1;
goto LAB_18002211e;
}
if ((uVar20 == 0) &&
(uVar9 = FUN_1800136a0((undefined8 *)&local_550,0x3c,(longlong)&local_3f8,
(byte)uVar17,uVar11,&local_5a0), uVar20 = local_5a0,
local_5a0 == 0)) {
if ((int)uVar9 == 8) {
*(int *)(lVar15 + 0x130) = *(int *)(lVar15 + 0x130) + 1;
}
else {
*(int *)(lVar15 + 0x134) = *(int *)(lVar15 + 0x134) + 1;
}
goto LAB_18002211e;
}
LOCK();
uVar19 = *puVar13;
if (uVar19 == 0) {
*puVar13 = uVar20;
}
UNLOCK();
uVar20 = local_5a0;
if (uVar19 == 0) {
local_5a0 = 0;
LOCK();
piVar1 = (int *)(lVar15 + 0x100);
iVar5 = *piVar1;
*piVar1 = *piVar1 + 1;
UNLOCK();
if (iVar5 == 0) {
FUN_1800234bc(*(PTP_TIMER *)(lVar15 + 0x158),(ulonglong)*(uint *)(lVar15 + 0x160))
;
}
uVar20 = local_5a0;
if (*(uint *)(lVar15 + 0x120) < *(uint *)(lVar15 + 0x100)) {
FUN_18003f3d9();
return;
}
goto LAB_18002211e;
}
}
uVar19 = *puVar13;
if (uVar11 == *(uint *)(uVar19 + 0x28)) {
lVar6 = *(longlong *)(uVar19 + 0x10);
iVar5 = memcmp(&local_3e8,(void *)(lVar6 + 0x10),8);
if (iVar5 == 0) {
uVar14 = *(byte *)(uVar19 + 0x2d) + 2;
while( true ) {
if (0x3b < uVar14) goto LAB_1800220cc;
uVar10 = (ulonglong)uVar14;
iVar5 = (&local_3f8)[uVar10].Size - *(int *)(lVar6 + 8 + uVar10 * 0x10);
lVar15 = local_558;
if ((iVar5 != 0) ||
(iVar5 = memcmp((void *)(&local_3f8)[uVar10].Ptr,
*(void **)(lVar6 + uVar10 * 0x10),
(ulonglong)(&local_3f8)[uVar10].Size), lVar15 = local_558,
iVar5 != 0)) break;
uVar14 = uVar14 + 1;
}
}
}
else {
iVar5 = uVar11 - *(uint *)(uVar19 + 0x28);
if (iVar5 == 0) goto LAB_1800220cc;
}
puVar13 = (ulonglong *)(uVar19 + 0x20 + ((longlong)iVar5 >> 0x3f & 0xfffffffffffffff8U))
;
} while( true );
}
}
EventWriteTransfer(DAT_1800914a0,&local_550,(LPCGUID)0x0,(LPCGUID)0x0,0x3c,&local_3f8);
}
}
LAB_180022166:
FUN_180028070(local_38 ^ (ulonglong)auStackY_5d8);
return;
LAB_1800220cc:
if (uVar19 != 0) {
uVar10 = 2;
if (2 < uVar17 + 2) {
do {
lVar15 = *(longlong *)(&local_3f8)[uVar10].Ptr;
bVar12 = *(byte *)(*(longlong *)(uVar19 + 0x10) + 0xd + uVar10 * 0x10);
plVar4 = *(longlong **)(*(longlong *)(uVar19 + 0x10) + uVar10 * 0x10);
if (bVar12 == 0x71) {
LOCK();
*plVar4 = *plVar4 + lVar15;
UNLOCK();
}
else if (bVar12 - 0x72 < 2) {
do {
lVar6 = *plVar4;
if (bVar12 == 0x72) {
if (lVar6 <= lVar15) break;
}
else if (lVar15 <= lVar6) break;
LOCK();
lVar2 = *plVar4;
if (lVar6 == lVar2) {
*plVar4 = lVar15;
}
UNLOCK();
} while (lVar6 != lVar2);
}
bVar12 = (char)uVar10 + 1;
uVar10 = (ulonglong)bVar12;
uVar20 = local_5a0;
} while ((uint)bVar12 < uVar17 + 2);
}
}
LAB_18002211e:
ReleaseSRWLockShared(SRWLock);
if (uVar20 != 0) {
FUN_180023334(uVar20);
}
goto LAB_180022166;
}
=========================================
Function at address: 0x180022240
Called functions addresses: 0x180041cdc 0xEXTERNAL:00000075 0x180041cb0 0x18000a1d0 0x18005b470 0x1800432ec 0x18002a7c0 0x18002a77b


int FUN_180022240(longlong param_1,undefined *param_2,uint param_3,void *param_4,uint *param_5,
longlong *param_6,uint *param_7)

{
byte bVar1;
byte bVar2;
byte bVar3;
undefined4 uVar4;
undefined4 uVar5;
int iVar6;
ulonglong uVar7;
uint *_Src;
longlong *plVar8;
undefined4 uVar9;
uint *puVar10;
longlong lVar11;
uint uVar12;
undefined *_Src_00;
byte *pbVar13;
ushort uVar14;
ushort uVar15;
uint uVar16;
int iVar17;
byte *pbVar18;
ulonglong uVar19;
undefined8 *puVar20;
undefined uVar21;
undefined uVar22;
bool bVar23;

iVar6 = 0;
plVar8 = *(longlong **)(param_1 + 0x510);
bVar23 = *(int *)((longlong)plVar8 + 0x44) == 0x47;
if ((((param_2 == (undefined *)0x0) || (param_3 == 0)) || (param_5 == (uint *)0x0)) ||
((param_6 == (longlong *)0x0 || (param_7 == (uint *)0x0)))) {
return 0x57;
}
if (param_3 < 2) {
iVar6 = -0x7ff6fcf8;
}
else {
if (CONCAT11(*param_2,param_2[1]) < 0x300) {
uVar22 = 0x46;
uVar9 = 0x4b1;
}
else {
if (param_3 - 2 < 0x20) goto LAB_18003f4c6;
if (bVar23) {
lVar11 = RtlCompareMemory(param_2 + 2,plVar8 + 0x22,0x20);
if (lVar11 == 0x20) goto LAB_180022335;
LAB_18003f53a:
uVar22 = 0x2f;
plVar8 = *(longlong **)(param_1 + 0x510);
}
else {
uVar9 = *(undefined4 *)(param_2 + 6);
uVar4 = *(undefined4 *)(param_2 + 10);
uVar5 = *(undefined4 *)(param_2 + 0xe);
*(undefined4 *)(plVar8 + 0x22) = *(undefined4 *)(param_2 + 2);
*(undefined4 *)((longlong)plVar8 + 0x114) = uVar9;
*(undefined4 *)(plVar8 + 0x23) = uVar4;
*(undefined4 *)((longlong)plVar8 + 0x11c) = uVar5;
lVar11 = *(longlong *)(param_2 + 0x1a);
plVar8[0x24] = *(longlong *)(param_2 + 0x12);
plVar8[0x25] = lVar11;
LAB_180022335:
if (param_3 == 0x22) {
LAB_18003f4c2:
plVar8 = *(longlong **)(param_1 + 0x510);
}
else {
bVar1 = param_2[0x22];
uVar19 = (ulonglong)bVar1;
if (0x20 < bVar1) goto LAB_18003f4c2;
_Src_00 = param_2 + 0x23;
uVar16 = (uint)bVar1;
if (param_3 - 0x23 < uVar16) goto LAB_18003f4c2;
if ((bVar23) &&
(plVar8 = *(longlong **)(param_1 + 0x510), *(byte *)((longlong)plVar8 + 0x501) != bVar1
)) {
uVar22 = 0x2f;
goto LAB_18003f4c9;
}
if (bVar1 != 0) {
if (bVar23) {
lVar11 = *(longlong *)(param_1 + 0x510) + 0x4e1;
if (lVar11 == 0) {
iVar6 = -0x7ff6fcfc;
goto LAB_18003f4e7;
}
uVar7 = RtlCompareMemory(_Src_00,lVar11,uVar19);
if (uVar7 != uVar19) goto LAB_18003f53a;
}
memcpy(param_4,_Src_00,uVar19);
}
*param_5 = uVar16;
pbVar13 = _Src_00 + uVar19;
plVar8 = *(longlong **)(param_1 + 0x510);
uVar16 = (param_3 - 0x23) - uVar16;
if (*(char *)((longlong)plVar8 + 0xe9) == '\0') {
LAB_1800223b6:
if (1 < uVar16) {
uVar14 = CONCAT11(*pbVar13,pbVar13[1]);
if ((1 < uVar14) && ((pbVar13[1] & 1) == 0)) {
if ((uint)uVar14 <= uVar16 - 2) {
uVar15 = uVar14 >> 1;
uVar19 = (ulonglong)uVar15;
uVar12 = (uint)uVar15;
if ((uint)uVar15 < *param_7 || uVar12 == *param_7) {
_Src = (uint *)*param_6;
}
else {
_Src = (uint *)FUN_18000a1d0((longlong)plVar8,(uint)uVar15 << 2);
if (_Src == (uint *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x1f,&DAT_180082c10,(uint)uVar15 * 4);
}
iVar6 = 0xe;
goto LAB_18003f4e7;
}
}
puVar10 = _Src;
pbVar18 = pbVar13;
if (uVar15 != 0) {
do {
*puVar10 = (uint)CONCAT11(pbVar18[2],pbVar18[3]);
uVar19 = uVar19 - 1;
puVar10 = puVar10 + 1;
pbVar18 = pbVar18 + 2;
} while (uVar19 != 0);
}
lVar11 = *(longlong *)(*(longlong *)(param_1 + 0x510) + 0x78);
if ((lVar11 != 0) && (DAT_1800927ac != '\0')) {
*(uint *)(lVar11 + 0x62c) = uVar12;
if (100 < uVar12) {
uVar12 = 100;
}
memcpy((void *)(lVar11 + 0x498),_Src,(ulonglong)uVar12 << 2);
*(short *)(lVar11 + 0x628) = (short)uVar12;
}
iVar17 = (uVar16 - 2) - (uint)uVar14;
if (iVar17 == 0) {
LAB_18003f5f5:
FUN_18005b470(*(longlong **)(param_1 + 0x510),0x4b0,0x80090308,0x32);
iVar6 = -0x7ff6fcf8;
}
else {
bVar1 = pbVar13[(ulonglong)uVar14 + 2];
uVar19 = (ulonglong)bVar1;
if (bVar1 != 0) {
uVar16 = iVar17 - 1;
if (bVar1 <= uVar16) {
pbVar18 = pbVar13 + (ulonglong)uVar14 + 3;
if (pbVar13[(ulonglong)uVar14 + 3] != 0) {
do {
if (pbVar18 == pbVar13 + uVar19 + (ulonglong)uVar14 + 2)
goto LAB_18003f5f5;
pbVar18 = pbVar18 + 1;
} while (*pbVar18 != 0);
}
uVar16 = uVar16 - bVar1;
if (1 < uVar16) {
bVar1 = pbVar13[uVar19 + (ulonglong)uVar14 + 3];
bVar2 = pbVar13[uVar19 + (ulonglong)uVar14 + 4];
uVar12 = (uint)CONCAT11(bVar1,bVar2);
if (uVar12 <= uVar16) {
lVar11 = *(longlong *)(param_1 + 0x518);
pbVar13 = pbVar13 + uVar19 + 5 + (ulonglong)uVar14;
uVar21 = 0;
uVar22 = 0;
bVar3 = *(byte *)(*(longlong *)(lVar11 + 8) + 0x40);
*(undefined4 *)(lVar11 + 0x10) = 1;
*(undefined *)(*(longlong *)(lVar11 + 8) + 0x39a) = 0;
*(undefined *)(lVar11 + 0x1b) = 0;
puVar20 = DAT_180091000;
if (CONCAT11(bVar1,bVar2) != 0) {
do {
if (uVar12 < 4) {
LAB_18003f6a8:
iVar6 = -0x7ff6fcda;
LAB_18003f6ae:
FUN_18005b470(*(longlong **)(param_1 + 0x510),0x4b0,0x80090308,
0x32);
LAB_18003f6cd:
if (iVar6 == 0) goto LAB_180022621;
goto LAB_18003f6e6;
}
uVar14 = CONCAT11(pbVar13[2],pbVar13[3]);
uVar16 = (uint)CONCAT11(*pbVar13,pbVar13[1]);
if (((undefined8 **)puVar20 != &DAT_180091000) &&
((*(byte *)((longlong)puVar20 + 0x1c) & 4) != 0)) {
FUN_180041cdc(puVar20[2],0x49,&DAT_180082c68,uVar16);
puVar20 = DAT_180091000;
}
pbVar18 = pbVar13 + 4;
if (uVar12 - 4 < (uint)uVar14) {
if (((undefined8 **)puVar20 != &DAT_180091000) &&
((*(byte *)((longlong)puVar20 + 0x1c) & 2) != 0)) {
FUN_180041cb0(puVar20[2],0x4a,&DAT_180082c68);
}
goto LAB_18003f6a8;
}
pbVar13 = pbVar18 + uVar14;
uVar12 = (uVar12 - 4) - (uint)uVar14;
if (((bVar3 & 0x30) == 0) || (uVar16 == 0xff01)) {

(lVar11,uVar16,pbVar18,uVar14);
if (iVar6 == 0) {
puVar20 = DAT_180091000;
uVar22 = uVar21;
if (uVar16 == 0xff01) {
uVar21 = 1;
uVar22 = 1;
}
goto LAB_1800225e9;
}
if ((iVar6 != -0x7ff6fcba) && (iVar6 != -0x7ff6fc99))
goto LAB_18003f6ae;
goto LAB_18003f6cd;
}
LAB_1800225e9:
} while (uVar12 != 0);
}

(*(undefined8 *)(lVar11 + 8),uVar22);
iVar6 = 0;
}
}
LAB_180022621:
uVar16 = (uint)uVar15;
*param_6 = (longlong)_Src;
goto LAB_180022639;
}
goto LAB_18003f5f5;
}
iVar6 = -0x7ff6fcf8;
}
LAB_18003f6e6:
if ((_Src != (uint *)0x0) && (_Src != (uint *)*param_6)) {

}
goto LAB_18003f4e7;
}
}
}
}
else if (uVar16 != 0) {
bVar1 = *pbVar13;
if (bVar1 < 0x21) {
if ((uint)bVar1 <= uVar16 - 1) {
pbVar13 = pbVar13 + (ulonglong)bVar1 + 1;
uVar16 = (uVar16 - 1) - (uint)bVar1;
goto LAB_1800223b6;
}
}
}
}
LAB_18003f4c6:
uVar22 = 0x32;
}
LAB_18003f4c9:
uVar9 = 0x4b0;
}
FUN_18005b470(plVar8,uVar9,0x80090308,uVar22);
iVar6 = -0x7ff6fcf8;
}
LAB_18003f4e7:
uVar16 = 0;
LAB_180022639:
*param_7 = uVar16;
return iVar6;
}
=========================================
Function at address: 0x180022670
Called functions addresses: 0x18007037c 0x18006f914 0x180012184 0x1800432ec 0x1800451f4 0x18002a7c0 0x18003faed 0x180014b9c 0x18006ff64 0x180041cb0 0x18000172c 0x18000a1d0 0x18006a8f8


/* WARNING: Type propagation algorithm not settling */

ulonglong FUN_180022670(longlong *param_1,undefined8 param_2,byte *param_3,uint param_4)

{
longlong lVar1;
char cVar2;
uint uVar3;
undefined4 uVar4;
int iVar5;
longlong *plVar6;
ulonglong uVar7;
uint uVar8;
ulonglong uVar9;
uint uVar10;
longlong lVar11;
bool bVar12;
uint local_res8 [2];
char local_res10 [8];

uVar7 = (ulonglong)param_4;
iVar5 = (int)param_2;
uVar9 = 0x80090326;
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar9 = 0x90312;
}
if (iVar5 == 0x14) {
if (*(int *)((longlong)param_1 + 0x44) == 0x3d) {
if ((*(uint *)(param_1 + 0x11) >> 8 & 1) != 0) {
uVar7 = FUN_18003faed(param_1,param_2,(char *)param_3);
return uVar7;
}
}
else if ((*(int *)((longlong)param_1 + 0x44) - 0x3eU & 0xfffffffd) != 0) {
return uVar9;
}
if ((param_4 == 1) && (*param_3 == 1)) {
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 10;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
param_1[0x12] = param_1[0x14];
cVar2 = *(char *)((longlong)param_1 + 0xe9);
param_1[0x14] = 0;
if (cVar2 == '\0') {
param_1[0x16] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180082c58);
cVar2 = *(char *)((longlong)param_1 + 0xe9);
}
if (cVar2 != '\0') {
*(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + 1;
param_1[0x1a] = 0;
param_1[0x19] = 0;
}
uVar4 = 0x3f;
if (*(int *)((longlong)param_1 + 0x44) == 0x40) {
uVar4 = 0x41;
}
*(undefined4 *)((longlong)param_1 + 0x44) = uVar4;
return 0;
}
uVar4 = 0x388;
}
else {
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar8 = FUN_18006f914(param_1,iVar5,param_3,param_4);
return (ulonglong)uVar8;
}
plVar6 = (longlong *)param_1[0x3a];
bVar12 = true;
local_res8[0] = 0;
if ((plVar6 != (longlong *)0x0) && (*(int *)((longlong)plVar6 + 0x24) != 0)) {
if (iVar5 == 0x16) {
uVar7 = FUN_18007037c(plVar6,param_3,param_4,0,local_res8);
if ((int)uVar7 != 0) {
return uVar7 & 0xffffffff;
}
lVar11 = param_1[0x3a];
uVar8 = *(uint *)(lVar11 + 0x20);
uVar10 = 0xc;
if (*(int *)(lVar11 + 0x28) == 0) {
uVar10 = 4;
}
if ((uVar8 <= uVar10) || (*(uint *)(lVar11 + 0x24) < uVar8)) {
if (*(uint *)(lVar11 + 0x24) < uVar10) {
return 0;
}
lVar1 = *(longlong *)(lVar11 + 0x18);
if ((uint)*(byte *)(lVar1 + 2) * 0x100 + (uint)*(byte *)(lVar1 + 1) * 0x10000 +
(uint)*(byte *)(lVar1 + 3) != 0) {
return 0;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x45,&DAT_180082c58,uVar8);
lVar11 = param_1[0x3a];
}
uVar8 = FUN_180014b9c(param_1,*(undefined8 *)(lVar11 + 0x18),*(undefined4 *)(lVar11 + 0x20))
;
if (uVar8 != 0) {
return (ulonglong)uVar8;
}
*(undefined8 *)(param_1[0x3a] + 0x20) = 0;
param_3 = param_3 + local_res8[0];
uVar7 = (ulonglong)(param_4 - local_res8[0]);
bVar12 = param_4 - local_res8[0] != 0;
}
else if (iVar5 == 0x15) {
plVar6[4] = 0;
}
if (!bVar12) {
return 0;
}
}
if (iVar5 == 0x15) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x39,&DAT_180082c58);
}
uVar9 = FUN_18000172c(param_3,(int)uVar7,(byte *)((longlong)param_1 + 0x1d9),local_res10);
iVar5 = (int)uVar9;
uVar9 = uVar9 & 0xffffffff;
if (iVar5 != 0) {
if (((iVar5 != -0x7ff6fc99) && (0x301 < *(uint *)((longlong)param_1 + 0x24))) &&
((*(uint *)(param_1 + 8) & 0x800a00aa) != 0)) {
FUN_180012184((longlong)param_1,0xe,iVar5);
return 0x80090326;
}
if ((int)uVar7 != 2) {
return uVar9;
}
FUN_1800451f4(*(uint *)(param_1[10] + 0xd4),param_1[10] + 0xd8,*param_3);
return uVar9;
}
if (local_res10[0] == '\0') {
return uVar9;
}
*(undefined *)(param_1 + 0x45) = 1;
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4b;
return uVar9;
}
if (iVar5 != 0x16) {
return 0;
}
while (uVar8 = (uint)uVar7, 3 < uVar8) {
uVar10 = (uint)param_3[2] * 0x100 + (uint)param_3[1] * 0x10000 + (uint)param_3[3];
if (uVar7 < (ulonglong)uVar10 + 4) {
plVar6 = (longlong *)param_1[0x3a];
if (plVar6 != (longlong *)0x0) goto LAB_18003fa09;
uVar10 = DAT_1800919f0;
if (((*(uint *)(param_1 + 8) & 0x40051555) != 0) &&
(uVar10 = DAT_1800919ec, (*(uint *)(param_1 + 0x11) >> 8 & 1) != 0)) {
uVar3 = DAT_1800919e8;
if (DAT_1800919e8 < DAT_1800919ec) {
uVar3 = DAT_1800919ec;
}
if (uVar3 == 0) goto LAB_18003f915;
}
if (uVar10 != 0) {
plVar6 = (longlong *)FUN_18000a1d0((longlong)param_1,0x30);
goto joined_r0x00018003f9d7;
}
goto LAB_18003f915;
}
local_res8[0] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18006a8f8(DAT_180091000[2],0x3a,&DAT_180082c58,*(undefined4 *)(param_1 + 8),*param_3,
(char)*(undefined4 *)((longlong)param_1 + 0x44));
}

uVar9 = (ulonglong)uVar3;
if ((((uVar3 == 0) || (uVar3 == 0x90320)) && (*(int *)(param_1 + 0x6d) == 0)) &&
((local_res8[0] == 0 &&

uVar3 != 0)))) {
uVar9 = (ulonglong)uVar3;
}
if (*(char *)((longlong)param_1 + 0x39b) != '\0') {
*(undefined4 *)(param_1 + 9) = *(undefined4 *)((longlong)param_1 + 0x44);
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4d;
return 0x90312;
}
if ((int)uVar9 == 0x90320) {
*(undefined *)((longlong)param_1 + 0x39c) = 1;
return uVar9;
}
if ((int)uVar9 != 0) {
return uVar9;
}
param_3 = param_3 + (ulonglong)uVar10 + 4;
uVar8 = uVar8 + (-4 - uVar10);
uVar7 = (ulonglong)uVar8;
if (uVar8 == 0) {
return uVar9;
}
}
plVar6 = (longlong *)param_1[0x3a];
if (plVar6 != (longlong *)0x0) goto LAB_18003fa09;
uVar10 = DAT_1800919f0;
if (((*(uint *)(param_1 + 8) & 0x40051555) != 0) &&
(uVar10 = DAT_1800919ec, (*(uint *)(param_1 + 0x11) >> 8 & 1) != 0)) {
uVar3 = DAT_1800919e8;
if (DAT_1800919e8 < DAT_1800919ec) {
uVar3 = DAT_1800919ec;
}
if (uVar3 == 0) goto LAB_18003f915;
}
if (uVar10 != 0) {
plVar6 = (longlong *)FUN_18000a1d0((longlong)param_1,0x30);
joined_r0x00018003f9d7:
if (plVar6 == (longlong *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x44,&DAT_180082c58);
}
return 0xe;
}
*plVar6 = 0;
*(undefined8 *)((longlong)plVar6 + 0xc) = 0x100;
plVar6[3] = 0;
plVar6[4] = 0;
param_1[0x3a] = (longlong)plVar6;
FUN_18006ff64(plVar6,(longlong)param_1);
plVar6 = (longlong *)param_1[0x3a];
LAB_18003fa09:
local_res8[0] = 0;
uVar7 = FUN_18007037c(plVar6,param_3,uVar8,1,local_res8);
return uVar7 & 0xffffffff;
}
LAB_18003f915:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x43,&DAT_180082c58);
}
uVar4 = 0xc;
}
FUN_18005b470(param_1,uVar4,0x80090326,10);
return 0x80090326;
}
=========================================
Function at address: 0x1800228d0
Called functions addresses: 0x18003fb66


undefined8 FUN_1800228d0(longlong param_1,uint param_2)

{
ushort *puVar1;
ushort *puVar2;
undefined8 uVar3;

puVar2 = *(ushort **)(param_1 + 0x390);
puVar1 = puVar2 + *(ushort *)(param_1 + 0x398);
if (puVar2 < puVar1) {
while (*puVar2 != param_2) {
puVar2 = puVar2 + 1;
if (puVar1 <= puVar2) {
uVar3 = FUN_18003fb66();
return uVar3;
}
}
}
else if (*(ushort *)(param_1 + 0x398) != 0) {
return 0x32;
}
return 0;
}
=========================================
Function at address: 0x180022910
Called functions addresses: 0x18005b628 0x180028d90 0x180059d38 0x180072a90 0xEXTERNAL:00000083 0x1800124f0 0x18002a7c0 0x180053180


void FUN_180022910(longlong *param_1)

{
ushort uVar1;
undefined4 uVar2;
undefined2 uVar3;
undefined4 *puVar4;
longlong lVar5;
longlong lVar6;
char cVar7;
int iVar8;
longlong lVar9;
undefined local_708 [8];
undefined4 local_700;
undefined4 uStack_6fc;

*(undefined4 *)((longlong)param_1 + 0x44) = 4;

if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
uVar3 = FUN_18005b628((longlong)param_1,(uint)*(ushort *)(param_1 + 0x1b));
*(undefined2 *)((longlong)param_1 + 0xda) = uVar3;
FUN_180072a90(param_1[0x49]);
*(undefined4 *)param_1[0x48] = 0;
*(undefined2 *)((longlong)param_1 + 0xdc) = 0;
}
memset(local_708,0,0x6e8);
cVar7 = DAT_1800927ac;
lVar9 = param_1[1];
if (lVar9 == 0) {
local_700 = 0;
}
else {
local_700 = *(undefined4 *)(lVar9 + 0x1c);
}
uVar2 = local_700;
uStack_6fc = *(undefined4 *)(param_1 + 2);
uVar1 = *(ushort *)((longlong)param_1 + 0x22);
lVar6 = param_1[0x11];
if ((lVar9 != 0) && (param_1[0xb] != 0)) {
lVar5 = param_1[0xf];
iVar8 = *(int *)(lVar9 + 0x20);
if (((lVar5 != 0) && (DAT_1800927ac != '\0')) &&
(((*(undefined4 *)(lVar5 + 0x30) = *(undefined4 *)(param_1[0xb] + 8), iVar8 == 0xaa02 ||
(iVar8 == 0xa400)) && (puVar4 = FUN_180059d38(iVar8), puVar4 != (undefined4 *)0x0)))) {
*(undefined4 *)(lVar5 + 0x34) = puVar4[8];
*(undefined4 *)(lVar5 + 0x38) = puVar4[10];
if (iVar8 == 0xaa02) {
*(undefined4 *)(lVar5 + 0x3c) = puVar4[0xc];
}
}
}
lVar9 = param_1[0xf];
if (lVar9 != 0) {
if (cVar7 == '\0') {
return;
}
*(undefined4 *)(lVar9 + 0x24) = uStack_6fc;
*(undefined4 *)(lVar9 + 0x20) = uVar2;
*(uint *)(lVar9 + 0x28) = (uint)uVar1;
*(longlong *)(lVar9 + 0x80) = lVar6;
QueryPerformanceCounter((LARGE_INTEGER *)(lVar9 + 0x58));
lVar6 = (*(longlong *)(lVar9 + 0x58) - *(longlong *)(lVar9 + 0x50)) * 1000;
*(longlong *)(lVar9 + 0x60) = lVar6;
if (DAT_180092ed8 == 10000000) {
lVar5 = SUB168(SEXT816(-0x29406b2a1a85bd43) * SEXT816(lVar6),8) + lVar6;
lVar5 = (lVar5 >> 0x17) - (lVar5 >> 0x3f);
}
else {
lVar5 = lVar6 / DAT_180092ed8;
}
*(longlong *)(lVar9 + 0x60) = lVar5;
if (*(int *)(lVar9 + 0x68) == -0x7ff6fce8) {
*(undefined4 *)(lVar9 + 0x68) = 0;
*(undefined4 *)(lVar9 + 0x70) = 0;
}
FUN_1800124f0(lVar9,'\0',lVar6);
lVar9 = param_1[0xf];
cVar7 = DAT_1800927ac;
}
if (((lVar9 != 0) && (cVar7 != '\0')) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180053180(DAT_180091000[2],(ulonglong)*(ushort *)(lVar9 + 0x42),
(ulonglong)*(ushort *)(lVar9 + 0x40),L"Server",(wchar_t *)(lVar9 + 0x98),
(wchar_t *)(lVar9 + 0x298));
}
return;
}
=========================================
Function at address: 0x180022b10
Called functions addresses: 0x180022b30


void FUN_180022b10(longlong param_1,longlong param_2,uint *param_3)

{
FUN_180022b30(param_1 + 1000,param_2,param_3);
return;
}
=========================================
Function at address: 0x180022b30
Called functions addresses: 0x18000909c 0x18006d7ac 0x18002a77b


undefined8 FUN_180022b30(longlong param_1,longlong param_2,uint *param_3)

{
uint uVar1;
HLOCAL _Src;
undefined2 *puVar2;
char cVar3;
longlong lVar4;
uint *puVar5;
undefined8 uVar6;
int *piVar7;
undefined *puVar8;
int *piVar9;
ulonglong uVar10;
int *piVar11;

*(undefined8 *)(param_1 + 0x90) = 0;
*(undefined8 *)(param_1 + 0x80) = 0;
puVar8 = (undefined *)(param_1 + 0x70);
for (lVar4 = 8; lVar4 != 0; lVar4 = lVar4 + -1) {
*puVar8 = 0;
puVar8 = puVar8 + 1;
}
*(undefined *)(param_1 + 0x78) = 0;
_Src = *(HLOCAL *)(param_1 + 0xa0);
if (_Src != (HLOCAL)0x0) {
uVar1 = *(uint *)(param_1 + 0x98);
if ((uVar1 != 0) && (*(char *)(param_1 + 8) != '\0')) {
if (param_3 != (uint *)0x0) {
if (*param_3 == 0) {
*(HLOCAL *)(param_3 + 2) = _Src;
}
else {
if (*param_3 < uVar1) {
*param_3 = uVar1;
uVar6 = 0x8009036a;
goto LAB_18003fe1c;
}
memcpy(*(void **)(param_3 + 2),_Src,(ulonglong)uVar1);
FUN_18000909c(*(HLOCAL *)(param_1 + 0xa0));
}
uVar6 = 0x90316;
*param_3 = *(uint *)(param_1 + 0x98);
*(undefined8 *)(param_1 + 0xa0) = 0;
*(undefined4 *)(param_1 + 0x98) = 0;
*(undefined *)(param_1 + 0x88) = 0;
goto LAB_18003fe1c;
}
FUN_18000909c(_Src);
*(undefined8 *)(param_1 + 0xa0) = 0;
*(undefined4 *)(param_1 + 0x98) = 0;
*(undefined *)(param_1 + 0x88) = 0;
}
}
if (param_2 == 0) {
return 0;
}
puVar5 = *(uint **)(param_2 + 8);
if (puVar5 < puVar5 + (ulonglong)*(uint *)(param_2 + 4) * 4) {
do {
if ((puVar5[1] & 0xfffffff) == 0x19) {
uVar10 = (ulonglong)*(byte *)(param_1 + 0x78);
if ((*(byte *)(param_1 + 0x78) != 0) || (*puVar5 < 0xc)) goto LAB_18003fe17;
puVar2 = *(undefined2 **)(puVar5 + 2);
if ((*puVar5 < (ushort)puVar2[4] + 10) ||
(((0xffff < (ushort)puVar2[4] + 4 || (*(int *)(puVar2 + 2) != 0)) ||
(cVar3 = FUN_18006d7ac(*puVar2), cVar3 == '\0')))) goto LAB_18003fe17;
*(undefined2 **)(param_1 + 0x70 + uVar10 * 8) = puVar2;
*(char *)(param_1 + 0x78) = *(char *)(param_1 + 0x78) + '\x01';
}
else if ((puVar5[1] & 0xfffffff) == 0x1a) {
if ((*puVar5 < 0xc) || (*(longlong *)(param_1 + 0x80) != 0)) goto LAB_18003fe17;
piVar9 = *(int **)(puVar5 + 2);
uVar1 = piVar9[1];
if ((1 < uVar1 - 1) || ((*piVar9 != 0 || ((ulonglong)*puVar5 < (ulonglong)uVar1 * 4 + 8))))
goto LAB_18003fe17;
piVar7 = piVar9 + 2;
piVar11 = piVar9 + (ulonglong)uVar1 + 2;
if (piVar7 < piVar11) {
do {
cVar3 = FUN_18006d7ac(*(undefined2 *)piVar7);
if (cVar3 == '\0') goto LAB_18003fe17;
piVar7 = piVar7 + 1;
} while (piVar7 < piVar11);
}
*(int **)(param_1 + 0x80) = piVar9;
}
puVar5 = puVar5 + 4;
} while (puVar5 < (uint *)((ulonglong)*(uint *)(param_2 + 4) * 0x10 + *(longlong *)(param_2 + 8)
));
}
if ((*(longlong *)(param_1 + 0x80) == 0) || (param_3 != (uint *)0x0)) {
*(uint **)(param_1 + 0x90) = param_3;
return 0;
}
LAB_18003fe17:
uVar6 = 0x8009035d;
LAB_18003fe1c:
*(undefined8 *)(param_1 + 0x90) = 0;
*(undefined8 *)(param_1 + 0x80) = 0;
puVar8 = (undefined *)(param_1 + 0x70);
for (lVar4 = 8; lVar4 != 0; lVar4 = lVar4 + -1) {
*puVar8 = 0;
puVar8 = puVar8 + 1;
}
*(undefined *)(param_1 + 0x78) = 0;
return uVar6;
}
=========================================
Function at address: 0x180022c10
Called functions addresses: 0xEXTERNAL:0000011c 0x180073c88 0x180069a50 0x180069444 0x18006d958 0x180012184 0x18002a7c0 0x180041d20 0x18004f728 0xEXTERNAL:000000c0 0x180041cb0 0x180068ec4 0xEXTERNAL:000000f8 0xEXTERNAL:000000bc 0x18006987c


ulonglong FUN_180022c10(longlong *param_1,byte *param_2,int param_3,undefined4 *param_4)

{
longlong *plVar1;
char cVar2;
uint uVar3;
uint extraout_EAX;
undefined4 uVar4;
ulonglong uVar5;
ulonglong uVar6;
longlong lVar7;
undefined2 uVar8;
uint uVar9;
ushort *puVar10;
longlong lVar11;
int iVar12;
uint uVar13;
longlong lVar14;
ulonglong local_res8;
undefined local_res18 [8];
ushort *local_res20;

lVar11 = 0;
*param_4 = 0;
*(undefined *)((longlong)param_1 + 0x502) = 0;
local_res18[0] = 0;
if ((param_3 == 0) || (param_2 == (byte *)0x0)) {
return 0x57;
}
lVar7 = param_1[10];
if (lVar7 == 0) {
return 0x54f;
}
local_res20 = (ushort *)(param_2 + 4);
uVar3 = *(uint *)((longlong)param_1 + 0x44);
uVar13 = param_3 - 4;
uVar6 = (ulonglong)uVar13;
lVar14 = (ulonglong)*param_2 << 8;
uVar9 = uVar3 & 0xff | (uint)lVar14;
local_res8 = CONCAT44(local_res8._4_4_,uVar13);
if (uVar9 == 0x100) {
LAB_180022c9c:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2b,&DAT_180082c30);
uVar3 = *(uint *)((longlong)param_1 + 0x44);
}
param_1[0x11] = param_1[0x11] | 0x8000;

param_1[0xb] = 0;

uVar6 = (ulonglong)uVar13;
if (uVar13 != 0) {
return uVar6;
}
if (((ulonglong)param_1[0x11] >> 0x12 & 1) != 0) {
return uVar6;
}
*(undefined *)(param_1 + 0x45) = 0;
param_1[0x11] = param_1[0x11] & 0xffffffffffbfffff;
if (uVar3 != 0x47) {
uVar4 = 0x5d;
if (*(int *)((longlong)param_1 + 0x44) == 0x47) {
uVar4 = 0x62;
}
*(undefined4 *)((longlong)param_1 + 0x44) = uVar4;
return uVar6;
}
*(undefined4 *)((longlong)param_1 + 0x44) = 99;
return uVar6;
}
if (uVar9 < 0x143d) {
if (uVar9 == 0x143c) {
LAB_1800400f1:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x37,&DAT_180082c30);
uVar3 = *(uint *)((longlong)param_1 + 0x44);
}
if (((uVar3 == 0x3c) && ((*(uint *)(param_1 + 0x11) >> 8 & 1) != 0)) &&
(*(char *)(param_1 + 0x45) == '\0')) {
return 0x80090326;
}
uVar3 = FUN_18006987c((longlong)(param_1 + 0xa1),param_2 + 4,param_3 - 4);
if (uVar3 != 0) {
return (ulonglong)uVar3;
}

if (uVar3 != 0) {
return (ulonglong)uVar3;
}
*param_4 = 1;
if (((*(uint *)(param_1 + 0x11) & 0x2008000) == 0x2008000) &&
((*(byte *)(lVar7 + 0x9c) & 0x20) == 0)) {
if (param_1[0xb] == 0) {
return 0x54f;
}
local_res8 = 0;
lVar7 = lVar11;
if ((longlong *)param_1[1] != (longlong *)0x0) {
lVar7 = *(longlong *)param_1[1];
}
uVar3 = SslExpandResumptionMasterKey(lVar7,param_1[0x86],param_1[0x4a],&local_res8,0,0);
if (uVar3 != 0) {
FUN_180012184((longlong)param_1,0x265,uVar3);
return (ulonglong)uVar3;
}
RtlAcquireResourceExclusive(param_1[0xb] + 0x48,1);
lVar7 = param_1[0xb];
if (*(longlong *)(lVar7 + 0x10) != 0) {
SslFreeObject(*(longlong *)(lVar7 + 0x10),0);
lVar7 = param_1[0xb];
}
*(ulonglong *)(lVar7 + 0x10) = local_res8;
RtlReleaseResource(param_1[0xb] + 0x48);
*(undefined4 *)((longlong)param_1 + 0x44) = 0x66;
}
else {
*(undefined *)(param_1 + 0x98) = 3;

}
if (*(char *)((longlong)param_1 + 0x4d1) == '\0') {
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 10;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
param_1[0x12] = param_1[0x14];
param_1[0x14] = 0;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
param_1[0x16] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180082c58);
}
}
*(undefined *)((longlong)param_1 + 0x4d1) = 1;

if (cVar2 != '\0') {
return 0;
}
plVar1 = (longlong *)param_1[1];
lVar7 = lVar11;
if (plVar1 != (longlong *)0x0) {
lVar7 = *plVar1;
}
uVar3 = FUN_18006d958((longlong)(param_1 + 0x7d),lVar7,'\x01',3,(longlong)plVar1,0,0);
if (uVar3 != 0) {
FUN_180012184((longlong)param_1,0x264,uVar3);
return (ulonglong)uVar3;
}
plVar1 = (longlong *)param_1[1];
if (plVar1 != (longlong *)0x0) {
lVar11 = *plVar1;
}
uVar3 = FUN_18006d958((longlong)(param_1 + 0x7d),lVar11,'\0',3,(longlong)plVar1,0,0);
if (uVar3 != 0) {
FUN_180012184((longlong)param_1,0x263,uVar3);
return (ulonglong)uVar3;
}
return (ulonglong)uVar3;
}
if (uVar9 < 0xb50) {
if (uVar9 == 0xb4f) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x2c,&DAT_180082c30);
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0;
}
uVar8 = 0x2d;
LAB_18003ffb6:
FUN_180041cb0(DAT_180091000[2],uVar8,&DAT_180082c30);
return 0;
}
if (uVar9 == 0x147) goto LAB_180022c9c;
if ((uVar9 != 0xb46) && (uVar9 != 0xb4e)) goto LAB_18004045d;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2e,&DAT_180082c30);
uVar13 = (uint)local_res8;
}
if (*(int *)(param_1[1] + 0x30) == 4) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar8 = 0x2f;
}
else {
if (((*(uint *)(param_1 + 0x11) >> 8 & 1) != 0) &&
((*(int *)((longlong)param_1 + 0x44) != 0x4e || (*(char *)(param_1 + 0x9a) != '\0')))) {
uVar3 = FUN_180068ec4((longlong)(param_1 + 0xa1),(byte *)local_res20,uVar13);
if (uVar3 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x3c;
return (ulonglong)uVar3;
}
return (ulonglong)uVar3;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar8 = 0x30;
}
}
else {
if (uVar9 != 0xf3c) {
if (uVar9 == 0xf4f) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x31,&DAT_180082c30);
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0;
}
uVar8 = 0x32;
goto LAB_18003ffb6;
}
goto LAB_18004045d;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x33,&DAT_180082c30);
uVar6 = local_res8 & 0xffffffff;
}
if (*(int *)(param_1[1] + 0x30) != 4) {
puVar10 = local_res20;
uVar5 = FUN_180069444((longlong)(param_1 + 0xa1),local_res20,(uint)uVar6);
if ((int)uVar5 != 0) {
return uVar5 & 0xffffffff;
}
uVar6 = FUN_180073c88(param_1,puVar10,uVar6,lVar14);
if ((int)uVar6 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x3e;
return uVar6 & 0xffffffff;
}
return uVar6 & 0xffffffff;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar8 = 0x34;
}
FUN_180041cb0(DAT_180091000[2],uVar8,&DAT_180082c30);
}
else {
if (uVar9 < 0x1450) {
if (uVar9 == 0x144f) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x35,&DAT_180082c30);
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0;
}
uVar8 = 0x36;
goto LAB_18003ffb6;
}
if ((uVar9 == 0x143e) || (uVar9 == 0x1446)) goto LAB_1800400f1;
}
else if ((uVar9 == 0x1804) || ((0x184d < uVar9 && (uVar9 < 0x1850)))) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x38,&DAT_180082c30);
uVar13 = (uint)local_res8;
}
uVar6 = FUN_180069a50((longlong)(param_1 + 0xa1),(char *)local_res20,uVar13);
if ((int)uVar6 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],(short)uVar6 + 0x39,&DAT_180082c30);
}
if ((longlong *)param_1[1] != (longlong *)0x0) {
lVar11 = *(longlong *)param_1[1];
}
iVar12 = FUN_18004f728(lVar11,param_1 + 0x87,param_1 + 0x12,param_1 + 0x16);
lVar11 = CONCAT44((int)((ulonglong)param_1 >> 0x20),iVar12);
uVar6 = (ulonglong)extraout_EAX;
if (extraout_EAX == 0) {
if (*(int *)(lVar11 + 0x44) != 0x4f) {
*(undefined4 *)(lVar11 + 0x44) = 4;
return uVar6;
}
return uVar6;
}
return uVar6;
}
return uVar6 & 0xffffffff;
}
LAB_18004045d:
*(undefined4 *)((longlong)param_1 + 0x44) = 0x60;
*(undefined2 *)(param_1 + 0xc) = 0xa02;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],0x3a,&DAT_180082c30,(uint)lVar14,0x60);
}
}
return 0x80090326;
}
=========================================
Function at address: 0x180022d60
Called functions addresses: 0xEXTERNAL:0000003f 0x180028d90 0x18000a1f4 0xEXTERNAL:0000008d 0x18002a7c0 0x180022da0


/* WARNING: Switch with 1 destination removed at 0x000180022d99 */
/* WARNING: Switch with 1 destination removed at 0x00018002a7c0 */

void FUN_180022d60(longlong param_1)

{
PSLIST_ENTRY p_Var1;
longlong lVar2;

if (*(char *)(param_1 + 0x20) == '\0') {
if (DAT_180092620 == 0) {
LocalAlloc(0x40,(ulonglong)*(uint *)(param_1 + 0x24));
FUN_180022da0();
return;
}
/* WARNING: Could not recover jumptable at 0x00018002a7a0. Too many branches */

(**(code **)(DAT_180092620 + 0x28))();
return;
}
p_Var1 = InterlockedPopEntrySList((PSLIST_HEADER)(param_1 + 0x10));
if (p_Var1 == (PSLIST_ENTRY)0x0) {
lVar2 = FUN_18000a1f4((ulonglong)(*(uint *)(param_1 + 0x24) + 0x10));
if (lVar2 == 0) goto LAB_180040652;
LOCK();
*(int *)(param_1 + 0x44) = *(int *)(param_1 + 0x44) + 1;
UNLOCK();
}
else {
memset(p_Var1 + 2,0,(ulonglong)*(uint *)(param_1 + 0x24));
LOCK();
*(int *)(param_1 + 0x34) = *(int *)(param_1 + 0x34) + -1;
UNLOCK();
}
LOCK();
*(int *)(param_1 + 0x3c) = *(int *)(param_1 + 0x3c) + 1;
UNLOCK();
LAB_180040652:
FUN_180022da0();
return;
}
=========================================
Function at address: 0x180022da0
Called functions addresses: None


void FUN_180022da0(void)

{
return;
}
=========================================
Function at address: 0x180022db0
Called functions addresses: 0x18002a7c0


void FUN_180022db0(longlong *param_1,undefined8 *param_2,undefined4 *param_3)

{
longlong lVar1;

*param_2 = 0;
*param_3 = 0;

if (lVar1 != 0) {

*param_2 = *(undefined8 *)(lVar1 + 0x1d0);
*param_3 = *(undefined4 *)(lVar1 + 0x1d8);
}
return;
}
=========================================
Function at address: 0x180022e40
Called functions addresses: 0xEXTERNAL:00000040 0x180022e80 0xEXTERNAL:0000008b 0x18002a7c0


/* WARNING: Switch with 1 destination removed at 0x000180022e79 */
/* WARNING: Switch with 1 destination removed at 0x00018002a7c0 */

void FUN_180022e40(longlong param_1,HLOCAL param_2)

{
if (*(char *)(param_1 + 0x20) != '\0') {
InterlockedPushEntrySList
((PSLIST_HEADER)(param_1 + 0x10),(PSLIST_ENTRY)((longlong)param_2 + -0x10));
LOCK();
*(int *)(param_1 + 0x34) = *(int *)(param_1 + 0x34) + 1;
UNLOCK();
FUN_180022e80();
return;
}
if (DAT_180092620 == 0) {
LocalFree(param_2);
FUN_180022e80();
return;
}
/* WARNING: Could not recover jumptable at 0x00018002a7a0. Too many branches */

(**(code **)(DAT_180092620 + 0x30))(param_2);
return;
}
=========================================
Function at address: 0x180022e80
Called functions addresses: None


void FUN_180022e80(void)

{
return;
}
=========================================
Function at address: 0x180022e90
Called functions addresses: 0x180062430 0x180041cb0 0x18000e5b4


uint FUN_180022e90(longlong *param_1,longlong param_2)

{
uint uVar1;
ulonglong uVar2;
undefined4 uVar3;

uVar1 = 0;
if (*(int *)((longlong)param_1 + 0x44) == 4) {
if (*(int *)(param_2 + 4) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1c,&DAT_180082bd8);
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4c;
}
}
else {
uVar1 = 0;
if (*(int *)((longlong)param_1 + 0x44) == 0x14) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180082bd8);
}
if (*(uint *)(param_2 + 4) < 3) {
*(undefined4 *)(param_2 + 4) = 3;
uVar1 = 0x80090318;
}
else {
uVar1 = FUN_180062430(param_1,*(longlong *)(param_2 + 8),(ulonglong)*(uint *)(param_2 + 4));
uVar2 = FUN_18000e5b4(uVar1);
uVar3 = 0x5d;
if ((char)uVar2 != '\0') {
uVar3 = 0x60;
}
*(undefined4 *)((longlong)param_1 + 0x44) = uVar3;
}
}
}
return uVar1;
}
=========================================
Function at address: 0x180022ee0
Called functions addresses: None


undefined8 FUN_180022ee0(longlong param_1,undefined4 *param_2,undefined4 *param_3)

{
longlong lVar1;

if ((param_2 != (undefined4 *)0x0) && (param_3 != (undefined4 *)0x0)) {
if (*(longlong *)(*(longlong *)(param_1 + 0x50) + 0x350) != 0) {
lVar1 = *(longlong *)(param_1 + 0x3e0);
*param_2 = *(undefined4 *)(lVar1 + 0xd8);
*param_3 = *(undefined4 *)(lVar1 + 0xdc);
return 0;
}
*param_2 = 0;
*param_3 = 0;
return 0;
}
return 0x57;
}
=========================================
Function at address: 0x180022f30
Called functions addresses: None


ulonglong FUN_180022f30(longlong param_1,undefined8 param_2,undefined8 param_3,uint *param_4,
uint param_5)

{
uint uVar1;
ulonglong uVar2;

uVar2 = (ulonglong)*(uint *)(param_1 + 0xa8);
if (((param_5 & *(uint *)(param_1 + 0xa8)) != 0) &&
(uVar2 = (ulonglong)*(uint *)(param_1 + 0xbc), *param_4 == *(uint *)(param_1 + 0xbc))) {
uVar1 = *(uint *)(param_1 + 0xc0);
uVar2 = (ulonglong)uVar1;
if (param_4[1] == uVar1) {
return CONCAT71((uint7)(uint3)(uVar1 >> 8),1);
}
}
return uVar2 & 0xffffffffffffff00;
}
=========================================
Function at address: 0x180022f70
Called functions addresses: 0x180043384


undefined8 FUN_180022f70(longlong param_1,longlong param_2)

{
undefined8 uVar1;

uVar1 = 0;
if ((param_2 == 0) || (param_1 == 0)) {
uVar1 = 0x8009035d;
}
else if ((*(int *)(param_1 + 0x44) == 4) && (*(int *)(param_2 + 4) != 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180043384(DAT_180091000[2],0x12,&DAT_180082c30,"server");
}
*(undefined4 *)(param_1 + 0x44) = 0x4e;
}
return uVar1;
}
=========================================
Function at address: 0x180022fb0
Called functions addresses: 0x180028a7c


undefined8 * FUN_180022fb0(undefined8 *param_1,byte param_2)

{
*param_1 = &PTR_FUN_18007d3f0;
if ((param_2 & 1) != 0) {
_o_free();
}
return param_1;
}
=========================================
Function at address: 0x180022ff0
Called functions addresses: None


undefined4 FUN_180022ff0(longlong param_1,longlong param_2,char param_3,char param_4)

{
longlong lVar1;
uint *puVar2;
undefined4 uVar3;
ulonglong uVar4;
undefined *puVar5;

uVar3 = 0;
if (param_3 == '\0') {
if (param_2 == 0) {
uVar3 = 0x8009035d;
}
else {
puVar5 = (undefined *)(param_1 + 0x490);
for (lVar1 = 0x20; lVar1 != 0; lVar1 = lVar1 + -1) {
*puVar5 = 0;
puVar5 = puVar5 + 1;
}
*(undefined *)(param_1 + 0x4b0) = 0;
uVar4 = 0;
puVar2 = *(uint **)(param_2 + 8);
if (puVar2 < puVar2 + (ulonglong)*(uint *)(param_2 + 4) * 4) {
do {
if (3 < (byte)uVar4) goto LAB_180040854;
if ((puVar2[1] & 0xfffffff) == 0x1c) {
if (param_4 == '\0') {
if (*(longlong *)(puVar2 + 2) == 0) {
uVar3 = 0xe;
goto LAB_18004081e;
}
if (*puVar2 < 0x1c0) {
*puVar2 = 0x1c0;
goto LAB_1800407ff;
}
}
else {
puVar2[2] = 0;
puVar2[3] = 0;
*puVar2 = 0;
}
*(uint **)(param_1 + 0x490 + uVar4 * 8) = puVar2;
uVar4 = (ulonglong)(byte)((byte)uVar4 + 1);
}
LAB_1800407ff:
puVar2 = puVar2 + 4;
} while (puVar2 < (uint *)((ulonglong)*(uint *)(param_2 + 4) * 0x10 +
*(longlong *)(param_2 + 8)));
if (3 < (byte)uVar4) {
LAB_180040854:
*(undefined *)(param_1 + 0x4b1) = 0;
return 0;
}
}
uVar3 = 0x8009036b;
LAB_18004081e:
puVar5 = (undefined *)(param_1 + 0x490);
for (lVar1 = 0x20; lVar1 != 0; lVar1 = lVar1 + -1) {
*puVar5 = 0;
puVar5 = puVar5 + 1;
}
*(undefined *)(param_1 + 0x4b0) = 0;
}
}
return uVar3;
}
=========================================
Function at address: 0x180023030
Called functions addresses: None


ulonglong FUN_180023030(longlong param_1)

{
return CONCAT71((uint7)((ulonglong)*(undefined8 *)(param_1 + 0x88) >> 0x28),
~(byte)((ulonglong)*(undefined8 *)(param_1 + 0x88) >> 0x20)) & 0xffffffffffffff01;
}
=========================================
Function at address: 0x180023050
Called functions addresses: None


void FUN_180023050(longlong param_1,undefined8 param_2,longlong param_3)

{
int *piVar1;
longlong lVar2;

if ((*(longlong *)(param_3 + 0x50) != 0) &&
((*(byte *)(*(longlong *)(param_3 + 0x50) + 0x9c) & 0x20) != 0)) {
*(undefined2 *)(param_1 + 0xec) = 0x100;
}
lVar2 = *(longlong *)(param_3 + 8);
*(longlong *)(param_1 + 0xb0) = lVar2;
*(undefined4 *)(param_1 + 0xb8) = *(undefined4 *)(param_3 + 0x10);
if (*(longlong *)(lVar2 + 0x350) != 0) {
LOCK();
piVar1 = (int *)(*(longlong *)(*(longlong *)(lVar2 + 0x350) + 0x10) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
}
LOCK();
piVar1 = (int *)(*(longlong *)(lVar2 + 0x358) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
return;
}
=========================================
Function at address: 0x1800230b0
Called functions addresses: 0x18005abd8 0x180029f58


undefined8 FUN_1800230b0(longlong param_1)

{
uint *puVar1;
longlong lVar2;
int iVar3;
uint *puVar4;
uint *puVar5;
undefined8 *puVar6;
undefined8 uVar7;

iVar3 = DAT_1800919a4;
if (*(char *)(param_1 + 0xe9) == '\0') {
LAB_1800230d0:
uVar7 = 0;
}
else {
*(ulonglong *)(param_1 + 0xb8) = (ulonglong)(DAT_1800919a4 != 0);
puVar4 = (uint *)FUN_180029f58(0x60);
if (puVar4 == (uint *)0x0) {
puVar4 = (uint *)0x0;
}
else {
puVar4[2] = 10;
*(longlong *)(puVar4 + 0x16) = param_1;
puVar4[1] = 0;
*puVar4 = (uint)(iVar3 != 0);
puVar1 = puVar4 + 6;
*(uint **)(puVar4 + 8) = puVar1;
*(uint **)puVar1 = puVar1;
puVar1 = puVar4 + 10;
puVar5 = puVar4 + 0xe;
*(uint **)(puVar4 + 0xc) = puVar1;
*(uint **)puVar1 = puVar1;
*(uint **)(puVar4 + 0x10) = puVar5;
*(uint **)puVar5 = puVar5;
puVar1 = puVar4 + 0x12;
*(uint **)(puVar4 + 0x14) = puVar1;
*(uint **)puVar1 = puVar1;
}
*(uint **)(param_1 + 0x240) = puVar4;
if (puVar4 != (uint *)0x0) {
puVar6 = (undefined8 *)FUN_180029f58(0x30);
if (puVar6 != (undefined8 *)0x0) {
uVar7 = *(undefined8 *)(param_1 + 0x240);
*(undefined4 *)(puVar6 + 1) = 0;
*(undefined4 *)((longlong)puVar6 + 0xc) = 0;
puVar6[2] = 0;
puVar6[3] = 0;
*(undefined4 *)(puVar6 + 4) = 0;
*puVar6 = uVar7;
puVar6[5] = param_1;
*(int *)((longlong)puVar6 + 0x24) = (int)*(short *)(param_1 + 0xc0);
}
lVar2 = *(longlong *)(param_1 + 0x240);
*(undefined8 **)(param_1 + 0x248) = puVar6;
if (puVar6 != (undefined8 *)0x0) {
*(longlong *)(param_1 + 0xe0) = lVar2;
if (iVar3 != 0) {
*(short *)(param_1 + 0xdc) = *(short *)(param_1 + 0xdc) + 1;
}
goto LAB_1800230d0;
}
if (lVar2 != 0) {
FUN_18005abd8(lVar2);
}
}
uVar7 = 0xe;
}
return uVar7;
}
=========================================
Function at address: 0x1800230f0
Called functions addresses: 0x180014550


void FUN_1800230f0(longlong param_1)

{
longlong lVar1;

lVar1 = *(longlong *)(param_1 + 0x3e0);
if (lVar1 != 0) {
FUN_180014550(*(longlong *)(lVar1 + 0xe0),lVar1,'\x01','\0');
*(undefined8 *)(param_1 + 0x3e0) = 0;
}
return;
}
=========================================
Function at address: 0x180023120
Called functions addresses: 0x18002a7c0


/* WARNING: Switch with 1 destination removed at 0x000180023139 */
/* WARNING: Switch with 1 destination removed at 0x00018002a7c0 */

undefined8 FUN_180023120(longlong *param_1,ulonglong param_2)

{
undefined8 uVar1;

if (param_2 != *(uint *)((longlong)param_1 + 0x24)) {
return 0;
}
/* WARNING: Could not recover jumptable at 0x00018002a7a0. Too many branches */

uVar1 = (**(code **)(*param_1 + 0x10))();
return uVar1;
}
=========================================
Function at address: 0x180023150
Called functions addresses: 0x180027b44 0x180023188 0x1800234bc


void FUN_180023150(undefined8 param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
if (*(char *)(param_2 + 0x164) == '\0') {
FUN_180023188(param_2);
}
else {
*(undefined *)(param_2 + 0x164) = 0;
FUN_180027b44(param_2,param_2,param_3,param_4);
}
if (*(int *)(param_2 + 0x100) != 0) {
FUN_1800234bc(*(PTP_TIMER *)(param_2 + 0x158),(ulonglong)*(uint *)(param_2 + 0x160));
}
return;
}
=========================================
Function at address: 0x180023188
Called functions addresses: 0x1800233b8 0x180023204


void FUN_180023188(longlong param_1)

{
uint uVar1;
int iVar2;
uint uVar3;
uint uVar4;

uVar4 = 0;
if (*(int *)(param_1 + 0x100) != 0) {
uVar1 = *(uint *)(param_1 + 0x104);
uVar3 = uVar1;
do {
if (*(longlong *)(param_1 + (ulonglong)uVar3 * 8) != 0) {
iVar2 = FUN_180023204(param_1,(ulonglong)uVar3);
uVar4 = uVar4 + iVar2;
}
uVar3 = uVar3 + 1 & 0x1f;
} while ((uVar3 != uVar1) && (uVar4 < 0x10));
*(uint *)(param_1 + 0x104) = uVar3;
FUN_1800233b8(param_1,uVar4);
}
return;
}
=========================================
Function at address: 0x180023204
Called functions addresses: 0x180023370 0xEXTERNAL:0000006e 0x18002329c 0xEXTERNAL:0000006f


int FUN_180023204(longlong param_1,ulonglong param_2)

{
PCEVENT_DESCRIPTOR pEVar1;
int iVar2;
ulonglong uVar3;

uVar3 = param_2 & 0xffffffff;
if (*(longlong *)(param_1 + uVar3 * 8) == 0) {
iVar2 = 0;
}
else {
AcquireSRWLockExclusive((PSRWLOCK)(param_1 + 0x108));
pEVar1 = *(PCEVENT_DESCRIPTOR *)(param_1 + uVar3 * 8);
*(undefined8 *)(param_1 + uVar3 * 8) = 0;
iVar2 = FUN_180023370((longlong)pEVar1);
*(int *)(param_1 + 0x100) = *(int *)(param_1 + 0x100) - iVar2;
ReleaseSRWLockExclusive((PSRWLOCK)(param_1 + 0x108));
FUN_18002329c(*(REGHANDLE *)(*(longlong *)(param_1 + 0x148) + 0x20),pEVar1);
}
return iVar2;
}
=========================================
Function at address: 0x18002329c
Called functions addresses: 0x180023334 0x1800293fb


void FUN_18002329c(REGHANDLE param_1,PCEVENT_DESCRIPTOR param_2)

{
PCEVENT_DESCRIPTOR pEVar1;
longlong lVar2;
int iVar3;

if (param_2 != (PCEVENT_DESCRIPTOR)0x0) {
do {
iVar3 = 2;
if (2 < *(byte *)((longlong)&param_2[2].Keyword + 5) + 2) {
lVar2 = 0x20;
do {
iVar3 = iVar3 + 1;
*(undefined *)(lVar2 + 0xd + *(longlong *)(param_2 + 1)) = 0;
lVar2 = lVar2 + 0x10;
} while (iVar3 < (int)(*(byte *)((longlong)&param_2[2].Keyword + 5) + 2));
}
EventWriteTransfer(param_1,param_2,(LPCGUID)0x0,(LPCGUID)0x0,
(uint)*(byte *)((longlong)&param_2[2].Keyword + 4),
*(PEVENT_DATA_DESCRIPTOR *)(param_2 + 1));
pEVar1 = (PCEVENT_DESCRIPTOR)param_2[1].Keyword;
FUN_180023334((longlong)param_2);
param_2 = pEVar1;
} while (pEVar1 != (PCEVENT_DESCRIPTOR)0x0);
}
return;
}
=========================================
Function at address: 0x180023334
Called functions addresses: 0xEXTERNAL:000000e6 0xEXTERNAL:000000e8


void FUN_180023334(longlong param_1)

{
LPVOID lpMem;
HANDLE hHeap;

if (param_1 != 0) {
lpMem = *(LPVOID *)(param_1 + 0x10);
hHeap = GetProcessHeap();
HeapFree(hHeap,0,lpMem);
}
return;
}
=========================================
Function at address: 0x180023370
Called functions addresses: None


int FUN_180023370(longlong param_1)

{
longlong lVar1;
int iVar2;
longlong lVar3;
longlong *plVar4;
longlong *plVar5;
longlong local_res8 [4];

local_res8[0] = param_1;
plVar4 = local_res8;
iVar2 = 0;
while (param_1 != 0) {
lVar1 = *(longlong *)(param_1 + 0x20);
*(undefined8 *)(param_1 + 0x20) = 0;
plVar4 = (longlong *)(*plVar4 + 0x18);
lVar3 = *plVar4;
plVar5 = plVar4;
while (lVar3 != 0) {
plVar5 = (longlong *)(lVar3 + 0x20);
lVar3 = *plVar5;
}
*plVar5 = lVar1;
iVar2 = iVar2 + 1;
param_1 = *plVar4;
}
return iVar2;
}
=========================================
Function at address: 0x1800233b8
Called functions addresses: None


void FUN_1800233b8(longlong param_1,uint param_2)

{
longlong *plVar1;
longlong lVar2;

if (param_2 != 0) {
plVar1 = (longlong *)(param_1 + 0x118);
if ((param_2 < *(uint *)(param_1 + 0x128)) || (lVar2 = *plVar1, lVar2 == 0)) {
lVar2 = *plVar1;
*(uint *)(param_1 + 0x128) = param_2;
}
if (*(uint *)(param_1 + 0x124) < param_2) {
*(uint *)(param_1 + 0x124) = param_2;
}
*plVar1 = lVar2 + 1;
*(longlong *)(param_1 + 0x110) = *(longlong *)(param_1 + 0x110) + (ulonglong)param_2;
}
return;
}
=========================================
Function at address: 0x180023408
Called functions addresses: 0xEXTERNAL:000000c0 0xEXTERNAL:0000010b 0xEXTERNAL:000000c2 0x180023480


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180023408(undefined8 param_1,longlong param_2,longlong *param_3)

{
int iVar1;
undefined *puVar2;

puVar2 = &DAT_180092428;
RtlAcquireResourceShared(&DAT_180092428,1);
if ((param_2 != 0) && (*param_3 != param_2)) {
FUN_180023480(puVar2,param_3);
iVar1 = SslIncrementProviderReferenceCount(param_2);
if (-1 < iVar1) {
LOCK();
_DAT_1800925a0 = _DAT_1800925a0 + 1;
UNLOCK();
*param_3 = param_2;
}
}
/* WARNING: Could not recover jumptable at 0x00018002346d. Too many branches */

RtlReleaseResource(&DAT_180092428);
return;
}
=========================================
Function at address: 0x180023480
Called functions addresses: 0xEXTERNAL:00000111


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180023480(undefined8 param_1,longlong *param_2)

{
if ((param_2 != (longlong *)0x0) && (*param_2 != 0)) {
SslDecrementProviderReferenceCount();
LOCK();
_DAT_1800925a0 = _DAT_1800925a0 + -1;
UNLOCK();
*param_2 = 0;
}
return;
}
=========================================
Function at address: 0x1800234bc
Called functions addresses: 0xEXTERNAL:000000ec


void FUN_1800234bc(PTP_TIMER param_1,ulonglong param_2)

{
_FILETIME local_res8 [4];

if ((param_1 != (PTP_TIMER)0x0) &&
(local_res8[0] = (_FILETIME)((param_2 & 0xffffffff) * -10000), DAT_180092de8 == 0)) {
SetThreadpoolTimer(param_1,local_res8,0,5000);
}
return;
}
=========================================
Function at address: 0x180023520
Called functions addresses: 0xEXTERNAL:0000006d 0x180041cdc 0xEXTERNAL:000000b2 0x1800237c0 0x180026410 0x180026560 0x1800236b0 0xEXTERNAL:0000016a 0x180025130 0x18004d070


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined8 FUN_180023520(void)

{
NTSTATUS NVar1;
undefined8 uVar2;
undefined8 *puVar3;

DAT_180092680 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
_DAT_180092698 = FUN_180025130;
_DAT_180092690 = L"System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel";
_DAT_1800926a8 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
_DAT_1800926c0 = FUN_180026560;
_DAT_1800926b8 = L"System\\CurrentControlSet\\Control\\Lsa";
_DAT_1800926d0 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
_DAT_1800926e8 = FUN_180026410;
_DAT_1800926e0 = L"Software\\Policies\\Microsoft\\Cryptography\\Configuration\\SSL\\00010002";
_DAT_180092658 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
_DAT_180092670 = FUN_1800236b0;
_DAT_180092668 =
L"System\\CurrentControlSet\\Control\\Cryptography\\Configuration\\Local\\SSL\\00010002";
FUN_180025130(&DAT_180092678);
FUN_180026560(&DAT_1800926a0,'\x01');
FUN_180026410((longlong *)&DAT_1800926c8);
FUN_1800236b0((longlong *)&DAT_180092650,'\x01');
NVar1 = BCryptRegisterConfigChangeNotify((HANDLE *)&DAT_180092ed0);
if (NVar1 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180085338,NVar1);
}
uVar2 = 0;
}
else {
puVar3 = &DAT_180092ec8;
RtlRegisterWait(&DAT_180092ec8,DAT_180092ed0,FUN_18004d070,0,0xffffffff,0);
FUN_1800237c0(puVar3);
uVar2 = 1;
}
return uVar2;
}
=========================================
Function at address: 0x1800236b0
Called functions addresses: 0xEXTERNAL:0000003f 0xEXTERNAL:00000040 0xEXTERNAL:0000004f 0x1800237c0 0x18002647c 0x18002516c 0x18002a76f


void FUN_1800236b0(longlong *param_1,char param_2)

{
LSTATUS LVar1;
int iVar2;
HKEY lpData;
HKEY hKey;
HKEY hMem;
DWORD local_res8 [2];
DWORD local_res18 [2];

local_res8[0] = 0;
LVar1 = FUN_18002647c(param_1);
if (LVar1 != 0) goto LAB_180023794;
LVar1 = RegQueryValueExW((HKEY)param_1[2],L"EccCurves",(LPDWORD)0x0,local_res18,(LPBYTE)0x0,
local_res8);
if (((LVar1 != 0) || (local_res8[0] == 0)) || (local_res18[0] != 7)) goto LAB_180023794;
lpData = (HKEY)LocalAlloc(0x40,(ulonglong)local_res8[0]);
if (lpData == (HKEY)0x0) goto LAB_180023794;
hKey = (HKEY)param_1[2];
LVar1 = RegQueryValueExW(hKey,L"EccCurves",(LPDWORD)0x0,local_res18,(LPBYTE)lpData,local_res8);
hMem = DAT_180092798;
if (LVar1 == 0) {
if ((DAT_180092798 != (HKEY)0x0) && (DAT_180092790 != 0)) {
if (DAT_180092790 == local_res8[0]) {
iVar2 = memcmp(DAT_180092798,lpData,(ulonglong)local_res8[0]);
if (iVar2 == 0) goto LAB_18002aa6b;
}
LocalFree(hMem);
hKey = hMem;
}
DAT_180092790 = local_res8[0];
DAT_180092798 = lpData;
if (param_2 == '\0') {
FUN_1800237c0(hKey);
}
}
else {
LAB_18002aa6b:
LocalFree(lpData);
}
LAB_180023794:
FUN_18002516c(DAT_180083f40);
return;
}
=========================================
Function at address: 0x1800237c0
Called functions addresses: 0x1800595e0 0xEXTERNAL:000000c0 0x1800238ac 0x180024f64 0xEXTERNAL:000000bc 0xEXTERNAL:00000100 0x180058e30 0x180024dc4


int FUN_1800237c0(undefined8 param_1)

{
int iVar1;
undefined *puVar2;
undefined8 local_res8 [4];

if (DAT_180092420 == '\0') {
iVar1 = 0xe;
}
else {
local_res8[0] = param_1;
if (DAT_1800927f0 != 0) {
FUN_1800595e0(DAT_1800927f0,0x30000,0,0,0);
}
puVar2 = &DAT_180092428;
RtlAcquireResourceExclusive();
FUN_180024f64(puVar2,'\0');
iVar1 = FUN_180024dc4((ulonglong)puVar2,(char *)local_res8);
if ((iVar1 == 0) &&
(((DAT_1800925a8 != 0 ||
(iVar1 = NCryptOpenStorageProvider
((NCRYPT_PROV_HANDLE *)&DAT_1800925a8,
L"Microsoft Software Key Storage Provider",0), iVar1 == 0)) &&
(iVar1 = FUN_1800238ac(), iVar1 == 0)))) {
RtlReleaseResource(&DAT_180092428);
if (DAT_1800927f0 != 0) {
FUN_1800595e0(DAT_1800927f0,0x30000,0,0,0);
}
if (((char)local_res8[0] != '\0') && (DAT_1800927e8 != 0)) {
FUN_180058e30(DAT_1800927e8);
}
}
else {
RtlReleaseResource(&DAT_180092428);
}
}
return iVar1;
}
=========================================
Function at address: 0x1800238ac
Called functions addresses: 0xEXTERNAL:00000173 0x1800281b8 0xEXTERNAL:00000172 0x180061ebc 0x18000909c 0x180028070 0x180028d30 0xEXTERNAL:00000176 0x180006ccc 0x180062074 0xEXTERNAL:000000c7 0xEXTERNAL:000000fb 0x180024700 0xEXTERNAL:00000120 0x18002492c 0x180061c24 0x180027150 0x180024898 0x180061f30 0x180024d20 0x180026ce8 0xEXTERNAL:000000fe 0x180028d78 0x180024b84 0x180028d90 0x18000a1f4 0xEXTERNAL:000000f9 0x180006da4 0x1800248e0 0xEXTERNAL:0000016c


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_1800238ac(void)

{
HLOCAL pvVar1;
code *pcVar2;
undefined4 uVar3;
undefined4 uVar4;
undefined8 uVar5;
undefined8 uVar6;
undefined8 uVar7;
bool bVar8;
byte bVar9;
int iVar10;
NTSTATUS NVar11;
int iVar12;
longlong lVar13;
undefined8 *puVar14;
undefined8 uVar15;
ulonglong uVar16;
uint *puVar17;
longlong *plVar18;
uint uVar19;
undefined8 *puVar20;
ulonglong uVar21;
undefined8 *puVar22;
WCHAR *pWVar23;
longlong lVar24;
undefined8 *puVar25;
undefined4 uVar26;
int *piVar27;
uint uVar28;
uint uVar29;
int *piVar31;
ulonglong uVar32;
ulonglong uVar33;
uint uVar34;
WCHAR *pWVar35;
int *piVar36;
undefined8 *puVar37;
undefined8 *puVar38;
PCRYPT_CONTEXT_FUNCTION_PROVIDERS p_Var39;
uint uVar40;
undefined auStackY_818 [32];
BOOLEAN local_7d8 [4];
uint local_7d4;
uint local_7d0;
uint local_7cc;
ULONG local_7c8;
uint local_7c4;
uint local_7c0;
PCRYPT_CONTEXT_FUNCTION_PROVIDERS local_7b8;
PCRYPT_CONTEXT_FUNCTIONS local_7b0;
int *local_7a8;
int *local_7a0;
int *local_798;
int *local_790;
longlong *local_788;
undefined8 *local_780;
int *local_778;
longlong local_770;
ULONG local_768;
ULONG local_764;
longlong *local_760;
longlong *local_758;
PCRYPT_CONTEXT_FUNCTIONS local_750;
undefined8 local_748 [98];
longlong local_438;
uint local_430 [2];
char acStack_428 [752];
WCHAR local_138 [64];
WCHAR local_b8 [64];
ulonglong local_38;
int *piVar30;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_818;
piVar31 = (int *)0x0;
uVar34 = 0;
local_764 = 0;
local_7d4 = 0;
local_7b0 = (PCRYPT_CONTEXT_FUNCTIONS)0x0;
local_7c8 = 0;
local_7b8 = (PCRYPT_CONTEXT_FUNCTION_PROVIDERS)0x0;
local_778 = (int *)0x0;
local_770 = 0;
local_7c4 = 0;
local_7c0 = 0;
local_758 = (longlong *)0x0;
local_760 = (longlong *)0x0;
local_768 = 0;
local_750 = (PCRYPT_CONTEXT_FUNCTIONS)0x0;
local_798 = (int *)0x0;
local_7cc = 0;
local_7d8[0] = '\0';
local_790 = (int *)0x0;
local_7a0 = (int *)0x0;
local_7d0 = 0;
memset(&local_438,0,0x300);
memset(local_138,0,0x80);
memset(local_b8,0,0x80);
_DAT_180092488 = _DAT_180092488 + 1;
local_780 = (undefined8 *)0x0;
DAT_1800925d4 = 0xd;
local_788 = (longlong *)FUN_18000a1f4(0xc800);
if (local_788 == (longlong *)0x0) goto LAB_180024615;
piVar27 = piVar31;
piVar30 = piVar31;
piVar36 = piVar31;
if (DAT_180092498 != 0) {
do {
bVar8 = false;
local_7a8 = (int *)0x0;
if ((uint)piVar27 < 0xc80) {
plVar18 = local_788 + (longlong)piVar27 * 2;
do {
if (bVar8) {
LAB_180023a20:
iVar10 = SslEnumCipherSuites((&DAT_1800924a0)[(longlong)piVar30],0,&local_780,&local_7a8
);
}
else {
iVar10 = SslEnumCipherSuitesEx((&DAT_1800924a0)[(longlong)piVar30],0,plVar18,&local_7a8)
;
if (iVar10 == -0x7ff6ffd7) {
bVar8 = true;
goto LAB_180023a20;
}
bVar8 = false;
}
*(int *)(plVar18 + 1) = (int)piVar30;
*(bool *)((longlong)plVar18 + 0xc) = bVar8;
if (iVar10 == -0x7ff6ffd6) break;
if (iVar10 != 0) {
*plVar18 = 0;
*(undefined4 *)(plVar18 + 1) = 0;
SslFreeBuffer(local_7a8);
piVar36 = local_798;
goto LAB_180024597;
}
if (bVar8 != false) {
lVar13 = FUN_18000a1f4(0x328);
*plVar18 = lVar13;
if (lVar13 == 0) goto LAB_1800245cf;
lVar24 = 5;
puVar22 = local_780;
puVar25 = (undefined8 *)(lVar13 + 4);
do {
puVar20 = puVar25;
puVar14 = puVar22;
uVar15 = puVar14[1];
*puVar20 = *puVar14;
puVar20[1] = uVar15;
uVar15 = puVar14[3];
puVar20[2] = puVar14[2];
puVar20[3] = uVar15;
uVar15 = puVar14[5];
puVar20[4] = puVar14[4];
puVar20[5] = uVar15;
uVar15 = puVar14[7];
puVar20[6] = puVar14[6];
puVar20[7] = uVar15;
uVar15 = puVar14[9];
puVar20[8] = puVar14[8];
puVar20[9] = uVar15;
uVar15 = puVar14[0xb];
puVar20[10] = puVar14[10];
puVar20[0xb] = uVar15;
uVar15 = puVar14[0xd];
puVar20[0xc] = puVar14[0xc];
puVar20[0xd] = uVar15;
uVar15 = puVar14[0xf];
puVar20[0xe] = puVar14[0xe];
puVar20[0xf] = uVar15;
lVar24 = lVar24 + -1;
puVar22 = puVar14 + 0x10;
puVar25 = puVar20 + 0x10;
} while (lVar24 != 0);
uVar26 = *(undefined4 *)((longlong)puVar14 + 0x84);
uVar3 = *(undefined4 *)(puVar14 + 0x11);
uVar4 = *(undefined4 *)((longlong)puVar14 + 0x8c);
*(undefined4 *)(puVar20 + 0x10) = *(undefined4 *)(puVar14 + 0x10);
*(undefined4 *)((longlong)puVar20 + 0x84) = uVar26;
*(undefined4 *)(puVar20 + 0x11) = uVar3;
*(undefined4 *)((longlong)puVar20 + 0x8c) = uVar4;
uVar26 = *(undefined4 *)((longlong)puVar14 + 0x94);
uVar3 = *(undefined4 *)(puVar14 + 0x13);
uVar4 = *(undefined4 *)((longlong)puVar14 + 0x9c);
*(undefined4 *)(puVar20 + 0x12) = *(undefined4 *)(puVar14 + 0x12);
*(undefined4 *)((longlong)puVar20 + 0x94) = uVar26;
*(undefined4 *)(puVar20 + 0x13) = uVar3;
*(undefined4 *)((longlong)puVar20 + 0x9c) = uVar4;
*(undefined4 *)(puVar20 + 0x14) = *(undefined4 *)(puVar14 + 0x14);
SslFreeBuffer(local_780);
local_780 = (undefined8 *)0x0;
}
plVar18 = plVar18 + 2;
local_7d4 = local_7d4 + 1;
} while (local_7d4 < 0xc80);
if (local_7a8 != (int *)0x0) {
SslFreeBuffer();
}
}
iVar10 = SslEnumEccCurves((&DAT_1800924a0)[(longlong)piVar30],
local_430 + (longlong)piVar30 * 6,&local_438 + (longlong)piVar30 * 3
,0);
uVar28 = local_7d4;
if (iVar10 == 0) {
acStack_428[(longlong)piVar30 * 0x18] = '\x01';
}
else {
acStack_428[(longlong)piVar30 * 0x18] = '\0';
FUN_180061c24(0,local_788 + (longlong)piVar27 * 2,local_7d4 - (uint)piVar27,
(int *)(local_430 + (longlong)piVar30 * 6),&local_438 + (longlong)piVar30 * 3)
;
}
piVar27 = (int *)(ulonglong)uVar28;
uVar28 = (int)piVar30 + 1;
piVar30 = (int *)(ulonglong)uVar28;
piVar36 = local_790;
} while (uVar28 < DAT_180092498);
}
uVar33 = 0;
DAT_1800925e8 = 0;
DAT_18009260a = 0;
NVar11 = BCryptEnumContextFunctions(1,L"SSL",0x10003,&local_768,&local_750);
if ((NVar11 < 0) ||
(bVar9 = FUN_180006ccc(&DAT_1800925e8,local_750->rgpszFunctions,local_750->cFunctions,'\x01'),
bVar9 == 0)) {
DAT_1800925e8 = 0;
bVar9 = 0;
DAT_18009260a = 0;
do {
FUN_180006da4(&DAT_1800925e8,bVar9);
bVar9 = bVar9 + 1;
} while (bVar9 < 0xc);
FUN_180027150();
}
NVar11 = BCryptEnumContextFunctions(1,L"SSL",0x10002,&local_764,&local_7b0);
if (NVar11 < 0) {
iVar10 = RtlNtStatusToDosError(NVar11);
LAB_180024588:
piVar36 = local_798;
if (iVar10 != 0) {
LAB_180024597:
if (local_760 != (longlong *)0x0) {
FUN_180026ce8(local_7c4,(longlong)piVar31,local_760);
}
if (local_758 != (longlong *)0x0) {
FUN_180026ce8(local_7c0,local_770,local_758);
goto LAB_1800245c2;
}
}
}
else {
uVar15 = FUN_180024d20();
uVar28 = 0;
if (((int)uVar15 == 0) || (uVar15 = FUN_180062074(), uVar28 = 0, (int)uVar15 != 0)) {
LAB_180023d20:
local_798 = (int *)0x0;
FUN_180024b84(&local_798,&local_7cc);
piVar27 = local_798;
uVar40 = DAT_180092498;
if (local_798 != (int *)0x0) {
local_7cc = DAT_180092498;
local_7a0 = local_798;
if (DAT_180092498 != 0) {
puVar17 = local_430;
uVar21 = (ulonglong)DAT_180092498;
do {
uVar34 = (int)piVar31 + *puVar17;
piVar31 = (int *)(ulonglong)uVar34;
puVar17 = puVar17 + 6;
uVar21 = uVar21 - 1;
} while (uVar21 != 0);
}
local_7a8 = (int *)FUN_18000a1f4((ulonglong)(uVar34 * 4));
if (local_7a8 != (int *)0x0) {
lVar13 = -1;
do {
lVar13 = lVar13 + 1;
piVar31 = piVar27;
} while (*(short *)((longlong)piVar27 + lVar13 * 2) != 0);
while (lVar13 != 0) {
uVar28 = 0;
if (uVar40 != 0) {
puVar17 = local_430;
LAB_180023db7:
uVar21 = 0;
if (*(longlong *)(puVar17 + -2) != 0) {
if (*puVar17 != 0) {
do {
lVar24 = uVar21 * 0x30c + *(longlong *)(puVar17 + -2);
iVar10 = _o__wcsicmp(local_7a0);
uVar32 = 0;
uVar40 = local_7cc;
if (iVar10 == 0) {
uVar29 = (uint)uVar33;
if (uVar29 == 0) goto LAB_180023e0d;
goto LAB_180023dfe;
}
uVar29 = (int)uVar21 + 1;
uVar21 = (ulonglong)uVar29;
} while (uVar29 < *puVar17);
}
goto LAB_180023e29;
}
goto LAB_180023e2e;
}
LAB_180023e43:
piVar27 = local_798;
if ((uint)uVar33 == uVar34) break;
local_7a0 = (int *)((longlong)piVar31 + lVar13 * 2 + 2);
lVar13 = -1;
do {
lVar13 = lVar13 + 1;
piVar31 = local_7a0;
} while (*(short *)((longlong)local_7a0 + lVar13 * 2) != 0);
}
LAB_180023e74:
uVar28 = (uint)uVar33;
local_7d0 = uVar28;
local_790 = local_7a8;
}
piVar36 = local_790;
FUN_18000909c(piVar27);
}
}
else {
FUN_180061f30(&local_7b0->cFunctions,(longlong *)&local_7a0,&local_7d0);
local_790 = local_7a0;
piVar36 = local_7a0;
uVar28 = local_7d0;
if (local_7d0 == 0) goto LAB_180023d20;
}
if ((piVar36 == (int *)0x0) || (uVar28 == 0)) {
LAB_1800240ce:
uVar33 = 0;
uVar34 = DAT_180092498;
if (DAT_180092498 != 0) {
do {
pvVar1 = (HLOCAL)(&local_438)[uVar33 * 3];
local_430[uVar33 * 6] = 0;
if (pvVar1 != (HLOCAL)0x0) {
if (acStack_428[uVar33 * 0x18] == '\0') {
FUN_18000909c(pvVar1);
}
else {
SslFreeBuffer();
}
(&local_438)[uVar33 * 3] = 0;
uVar34 = DAT_180092498;
}
uVar28 = (int)uVar33 + 1;
uVar33 = (ulonglong)uVar28;
} while (uVar28 < uVar34);
}
}
else {
NVar11 = BCryptGetFipsAlgorithmMode(local_7d8);
if ((-1 < NVar11) && (local_7d8[0] != '\0')) {
FUN_180061ebc((longlong)piVar36,&local_7d0);
uVar28 = local_7d0;
}
if (uVar28 == 0) goto LAB_1800240ce;
uVar34 = DAT_180092498;
if (DAT_180092498 != 0) {
plVar18 = &local_438;
uVar33 = (ulonglong)DAT_180092498;
lVar13 = 6;
do {
uVar21 = 0;
if (*plVar18 != 0) {
uVar26 = 0;
if (uVar28 != 0) {
uVar32 = (ulonglong)uVar28;
piVar31 = piVar36;
do {
uVar16 = 0;
if (*(int *)(plVar18 + 1) != 0) {
do {
puVar22 = (undefined8 *)(uVar16 * 0x30c + *plVar18);
if (*piVar31 == *(int *)((longlong)puVar22 + 0x304)) {
puVar25 = (undefined8 *)(uVar21 * 0x30c + *plVar18);
if ((int)uVar21 != (int)uVar16) {
lVar24 = lVar13;
puVar14 = puVar25;
puVar20 = local_748;
do {
puVar38 = puVar20;
puVar37 = puVar14;
uVar15 = puVar37[1];
uVar5 = puVar37[2];
uVar6 = puVar37[3];
*puVar38 = *puVar37;
puVar38[1] = uVar15;
uVar15 = puVar37[4];
uVar7 = puVar37[5];
puVar38[2] = uVar5;
puVar38[3] = uVar6;
uVar5 = puVar37[6];
uVar6 = puVar37[7];
puVar38[4] = uVar15;
puVar38[5] = uVar7;
uVar15 = puVar37[8];
uVar7 = puVar37[9];
puVar38[6] = uVar5;
puVar38[7] = uVar6;
uVar5 = puVar37[10];
uVar6 = puVar37[0xb];
puVar38[8] = uVar15;
puVar38[9] = uVar7;
uVar15 = puVar37[0xc];
uVar7 = puVar37[0xd];
puVar38[10] = uVar5;
puVar38[0xb] = uVar6;
uVar5 = puVar37[0xe];
uVar6 = puVar37[0xf];
puVar38[0xc] = uVar15;
puVar38[0xd] = uVar7;
puVar38[0xe] = uVar5;
puVar38[0xf] = uVar6;
lVar24 = lVar24 + -1;
puVar14 = puVar37 + 0x10;
puVar20 = puVar38 + 0x10;
} while (lVar24 != 0);
puVar38[0x10] = puVar37[0x10];
*(undefined4 *)(puVar38 + 0x11) = *(undefined4 *)(puVar37 + 0x11);
lVar24 = lVar13;
puVar14 = puVar22;
do {
puVar37 = puVar14;
puVar20 = puVar25;
uVar15 = puVar37[1];
*puVar20 = *puVar37;
puVar20[1] = uVar15;
uVar15 = puVar37[3];
puVar20[2] = puVar37[2];
puVar20[3] = uVar15;
uVar15 = puVar37[5];
puVar20[4] = puVar37[4];
puVar20[5] = uVar15;
uVar15 = puVar37[7];
puVar20[6] = puVar37[6];
puVar20[7] = uVar15;
uVar15 = puVar37[9];
puVar20[8] = puVar37[8];
puVar20[9] = uVar15;
uVar15 = puVar37[0xb];
puVar20[10] = puVar37[10];
puVar20[0xb] = uVar15;
uVar15 = puVar37[0xd];
puVar20[0xc] = puVar37[0xc];
puVar20[0xd] = uVar15;
uVar15 = puVar37[0xf];
puVar20[0xe] = puVar37[0xe];
puVar20[0xf] = uVar15;
lVar24 = lVar24 + -1;
puVar25 = puVar20 + 0x10;
puVar14 = puVar37 + 0x10;
} while (lVar24 != 0);
puVar20[0x10] = puVar37[0x10];
*(undefined4 *)(puVar20 + 0x11) = *(undefined4 *)(puVar37 + 0x11);
lVar24 = lVar13;
puVar25 = local_748;
do {
puVar20 = puVar25;
puVar14 = puVar22;
uVar15 = puVar20[1];
uVar5 = puVar20[2];
uVar6 = puVar20[3];
*puVar14 = *puVar20;
puVar14[1] = uVar15;
uVar15 = puVar20[4];
uVar7 = puVar20[5];
puVar14[2] = uVar5;
puVar14[3] = uVar6;
uVar5 = puVar20[6];
uVar6 = puVar20[7];
puVar14[4] = uVar15;
puVar14[5] = uVar7;
uVar15 = puVar20[8];
uVar7 = puVar20[9];
puVar14[6] = uVar5;
puVar14[7] = uVar6;
uVar5 = puVar20[10];
uVar6 = puVar20[0xb];
puVar14[8] = uVar15;
puVar14[9] = uVar7;
uVar15 = puVar20[0xc];
uVar7 = puVar20[0xd];
puVar14[10] = uVar5;
puVar14[0xb] = uVar6;
uVar5 = puVar20[0xe];
uVar6 = puVar20[0xf];
puVar14[0xc] = uVar15;
puVar14[0xd] = uVar7;
puVar14[0xe] = uVar5;
puVar14[0xf] = uVar6;
lVar24 = lVar24 + -1;
puVar22 = puVar14 + 0x10;
puVar25 = puVar20 + 0x10;
} while (lVar24 != 0);
puVar14[0x10] = puVar20[0x10];
*(undefined4 *)(puVar14 + 0x11) = *(undefined4 *)(puVar20 + 0x11);
}
uVar21 = (ulonglong)((int)uVar21 + 1);
}
uVar34 = (int)uVar16 + 1;
uVar16 = (ulonglong)uVar34;
} while (uVar34 < *(uint *)(plVar18 + 1));
}
uVar26 = (undefined4)uVar21;
piVar31 = piVar31 + 1;
uVar32 = uVar32 - 1;
} while (uVar32 != 0);
}
*(undefined4 *)(plVar18 + 1) = uVar26;
}
plVar18 = plVar18 + 3;
uVar33 = uVar33 - 1;
uVar34 = DAT_180092498;
} while (uVar33 != 0);
}
}
piVar36 = (int *)0x0;
iVar10 = 0;
if (uVar34 != 0) {
puVar17 = local_430;
uVar33 = (ulonglong)uVar34;
iVar10 = 0;
do {
iVar10 = iVar10 + *puVar17;
puVar17 = puVar17 + 6;
uVar33 = uVar33 - 1;
} while (uVar33 != 0);
}
plVar18 = (longlong *)FUN_18000a1f4((ulonglong)(iVar10 * 0x30c + uVar34 * 0x20 + 0x10));
if (plVar18 == (longlong *)0x0) {
piVar36 = (int *)0x0;
LAB_1800245c2:
if (piVar36 != (int *)0x0) {
FUN_18000909c(piVar36);
}
}
else {
DAT_1800925c8 =
FUN_18002492c(plVar18,(longlong)(plVar18 + 2),
(longlong)(plVar18 + 2 + (ulonglong)uVar34 * 4),(longlong)&local_438,
DAT_180092498);
local_798 = piVar36;
uVar15 = FUN_1800248e0(local_7b0->cFunctions,(longlong *)&local_760,(longlong *)&local_778);
piVar31 = local_778;
if (((int)uVar15 != 0) ||
(uVar15 = FUN_1800248e0(local_7b0->cFunctions,(longlong *)&local_758,&local_770),
piVar31 = local_778, (int)uVar15 != 0)) goto LAB_180024597;
uVar33 = 0;
_DAT_1800925c0 = 0;
if (local_7b0->cFunctions != 0) {
do {
p_Var39 = (PCRYPT_CONTEXT_FUNCTION_PROVIDERS)0x0;
if (local_7b8 != (PCRYPT_CONTEXT_FUNCTION_PROVIDERS)0x0) {
BCryptFreeBuffer(local_7b8);
local_7b8 = p_Var39;
}
_o_wcscpy_s(local_138,0x40,local_7b0->rgpszFunctions[uVar33]);
uVar21 = 0xffffffffffffffff;
do {
uVar32 = uVar21;
uVar21 = uVar32 + 1;
} while (local_138[uVar21] != L'\0');
if (5 < (uint)uVar21) {
uVar34 = 0;
do {
iVar10 = _o__wcsicmp(local_138 + ((uVar21 & 0xffffffff) - 5));
if (iVar10 == 0) {
p_Var39 = (PCRYPT_CONTEXT_FUNCTION_PROVIDERS)0x1;
break;
}
uVar34 = uVar34 + 1;
} while (uVar34 < 3);
}
uVar21 = 0;
iVar10 = (int)p_Var39;
pWVar23 = (WCHAR *)0x1;
iVar12 = BCryptEnumContextFunctionProviders
(1,(LPCWSTR)0x0,0x10002,local_138,&local_7c8,&local_7b8);
if (iVar12 == -0x3ffffddb) {
pWVar23 = (WCHAR *)0x1;
iVar12 = BCryptEnumContextFunctionProviders
(1,L"SSL",0x10002,local_138,&local_7c8,&local_7b8);
if (iVar12 != -0x3ffffddb) goto LAB_1800243a0;
if (iVar10 != 0) {
uVar32 = (ulonglong)((int)uVar32 - 4);
if (0x7f < uVar32 * 2) goto LAB_1800246f1;
local_138[uVar32] = L'\0';
pWVar23 = (WCHAR *)0x1;
iVar12 = BCryptEnumContextFunctionProviders
(1,(LPCWSTR)0x0,0x10002,local_138,&local_7c8,&local_7b8);
iVar10 = 0;
if (iVar12 == -0x3ffffddb) {
pWVar23 = (WCHAR *)0x1;
iVar12 = BCryptEnumContextFunctionProviders
(1,L"SSL",0x10002,local_138,&local_7c8,&local_7b8);
}
goto LAB_1800243a0;
}
}
else {
LAB_1800243a0:
if (iVar12 < 0) {
if (iVar12 != -0x3ffffddb) {
iVar10 = RtlNtStatusToDosError(iVar12);
goto LAB_180024588;
}
}
else {
if (iVar10 == 0) {
pWVar35 = local_138;
}
else {
_o_wcscpy_s(local_b8,0x40,local_138);
lVar13 = -1;
do {
lVar24 = lVar13;
lVar13 = lVar24 + 1;
} while (local_b8[lVar13] != L'\0');
uVar32 = (ulonglong)((int)lVar24 - 4);
pWVar23 = (WCHAR *)(uVar32 * 2);
if ((WCHAR *)0x7f < pWVar23) {
LAB_1800246f1:
FUN_1800281b8();
pcVar2 = (code *)swi(3);
(*pcVar2)();
return;
}
local_b8[uVar32] = L'\0';
pWVar35 = local_b8;
}
uVar34 = local_7c4;
uVar32 = (ulonglong)local_7c4;
if (local_7c4 != 0) {
do {
pWVar23 = pWVar35;
iVar12 = _o__wcsicmp(pWVar35,(longlong)piVar31 + uVar21 * 0x360 + 0x4a);
if (iVar12 == 0) goto LAB_1800243b6;
uVar28 = (int)uVar21 + 1;
uVar21 = (ulonglong)uVar28;
} while (uVar28 < uVar34);
}
plVar18 = local_788;
uVar28 = local_7d4;
uVar29 = FUN_180024700((ulonglong)pWVar23,&local_7b8->cProviders,1,local_788,local_7d4
,(longlong)(piVar31 + uVar32 * 0xd8),(longlong)local_138,iVar10
);
uVar40 = local_7c0;
if (uVar29 == 0) {
DAT_1800925c0 = DAT_1800925c0 | (piVar31 + uVar32 * 0xd8)[2];
local_7c4 = uVar34 + 1;
}
lVar13 = (ulonglong)local_7c0 * 0x360 + local_770;
uVar34 = FUN_180024700((ulonglong)pWVar23,&local_7b8->cProviders,2,plVar18,uVar28,
lVar13,(longlong)local_138,iVar10);
if (uVar34 == 0) {
DAT_1800925c4 = DAT_1800925c4 | *(uint *)(lVar13 + 8);
local_7c0 = uVar40 + 1;
}
}
}
LAB_1800243b6:
uVar34 = (int)uVar33 + 1;
uVar33 = (ulonglong)uVar34;
} while (uVar34 < local_7b0->cFunctions);
}
lVar13 = 0;
DAT_1800925b0 = FUN_180024898(local_760,(longlong)piVar31,local_7c4);
DAT_1800925b8 = FUN_180024898(local_758,local_770,local_7c0);
DAT_1800925d0 = 0;
if (DAT_180092498 != 0) {
uVar33 = (ulonglong)DAT_180092498;
do {
lVar13 = lVar13 + 0x20;
DAT_1800925d0 = DAT_1800925d0 + *(short *)(*DAT_1800925c8 + -0x18 + lVar13);
uVar33 = uVar33 - 1;
} while (uVar33 != 0);
}
}
}
LAB_1800245cf:
if (local_7d4 != 0) {
uVar33 = (ulonglong)local_7d4;
plVar18 = local_788;
do {
if ((HLOCAL)*plVar18 != (HLOCAL)0x0) {
if (*(char *)((longlong)plVar18 + 0xc) == '\0') {
SslFreeBuffer();
}
else {
FUN_18000909c((HLOCAL)*plVar18);
}
}
plVar18 = plVar18 + 2;
uVar33 = uVar33 - 1;
} while (uVar33 != 0);
}
FUN_18000909c(local_788);
piVar31 = local_790;
LAB_180024615:
uVar33 = 0;
if (DAT_180092498 != 0) {
do {
if ((HLOCAL)(&local_438)[uVar33 * 3] != (HLOCAL)0x0) {
if (acStack_428[uVar33 * 0x18] == '\0') {
FUN_18000909c((HLOCAL)(&local_438)[uVar33 * 3]);
}
else {
SslFreeBuffer();
}
}
uVar34 = (int)uVar33 + 1;
uVar33 = (ulonglong)uVar34;
} while (uVar34 < DAT_180092498);
}
if (piVar31 != (int *)0x0) {
FUN_18000909c(piVar31);
}
if (local_7b8 != (PCRYPT_CONTEXT_FUNCTION_PROVIDERS)0x0) {
BCryptFreeBuffer(local_7b8);
}
if (local_7b0 != (PCRYPT_CONTEXT_FUNCTIONS)0x0) {
BCryptFreeBuffer(local_7b0);
}
if (local_750 != (PCRYPT_CONTEXT_FUNCTIONS)0x0) {
BCryptFreeBuffer(local_750);
}
if (local_780 != (undefined8 *)0x0) {
SslFreeBuffer();
}
FUN_180028070(local_38 ^ (ulonglong)auStackY_818);
return;
while (uVar19 = (int)uVar32 + 1, uVar32 = (ulonglong)uVar19, uVar19 < uVar29) {
LAB_180023dfe:
if (local_7a8[uVar32] == *(int *)(lVar24 + 0x304)) goto LAB_180023e29;
}
LAB_180023e0d:
local_7a8[uVar33] = *(int *)(lVar24 + 0x304);
uVar33 = (ulonglong)(uVar29 + 1);
LAB_180023e29:
piVar27 = local_798;
if ((uint)uVar33 == uVar34) goto LAB_180023e74;
LAB_180023e2e:
uVar28 = uVar28 + 1;
puVar17 = puVar17 + 6;
piVar31 = local_7a0;
if (uVar40 <= uVar28) goto LAB_180023e43;
goto LAB_180023db7;
}
=========================================
Function at address: 0x180024700
Called functions addresses: 0xEXTERNAL:00000173 0x18002488a 0xEXTERNAL:00000174 0x180028d3c 0x1800265b0


uint FUN_180024700(ulonglong param_1,uint *param_2,ULONG param_3,longlong *param_4,uint param_5,
longlong param_6,longlong param_7,int param_8)

{
NTSTATUS NVar1;
int iVar2;
uint uVar3;
longlong lVar4;
uint uVar5;
ulonglong uVar7;
ulonglong local_res8;
PCRYPT_PROVIDER_REG local_res10;
ulonglong uVar6;

uVar7 = 0;
local_res8 = param_1 & 0xffffffff00000000;
uVar3 = 0xffffffff;
uVar6 = uVar7;
if (*param_2 != 0) {
do {
if (uVar3 != 0xffffffff) goto LAB_1800247bf;
local_res10 = (PCRYPT_PROVIDER_REG)0x0;
NVar1 = BCryptQueryProviderRegistration
(*(LPCWSTR *)(*(longlong *)(param_2 + 2) + uVar6 * 8),param_3,0x10002,
(ULONG *)&local_res8,&local_res10);
if ((-1 < NVar1) &&
(((param_3 == 1 && (local_res10->pUM != (PCRYPT_IMAGE_REG)0x0)) ||
((param_3 == 2 && (local_res10->pKM != (PCRYPT_IMAGE_REG)0x0)))))) {
uVar3 = (uint)uVar6;
}
if (local_res10 != (PCRYPT_PROVIDER_REG)0x0) {
BCryptFreeBuffer(local_res10);
}
uVar5 = (uint)uVar6 + 1;
uVar6 = (ulonglong)uVar5;
} while (uVar5 < *param_2);
if (uVar3 != 0xffffffff) {
LAB_1800247bf:
if ((param_8 != 0) &&
(iVar2 = _o__wcsnicmp(*(undefined8 *)(*(longlong *)(param_2 + 2) + (ulonglong)uVar3 * 8),
L"Microsoft SSL Protocol Provider",0x40), iVar2 == 0)) {
lVar4 = -1;
do {
lVar4 = lVar4 + 1;
} while (*(short *)(param_7 + lVar4 * 2) != 0);
*(undefined2 *)(param_7 + (ulonglong)((int)lVar4 - 5) * 2) = 0;
}
if (DAT_180092498 != 0) {
uVar6 = uVar7;
while( true ) {
iVar2 = _o__wcsnicmp(*(undefined8 *)(DAT_180092490 + uVar6 * 0x10),
*(undefined8 *)(*(longlong *)(param_2 + 2) + (ulonglong)uVar3 * 8),
0x40);
if (iVar2 == 0) break;
uVar5 = (int)uVar6 + 1;
uVar6 = (ulonglong)uVar5;
if (DAT_180092498 <= uVar5) {
uVar3 = FUN_18002488a();
return uVar3;
}
}
if ((int)uVar6 != -1) {
uVar7 = uVar6 * 0x20 + *DAT_1800925c8;
}
}
uVar3 = FUN_1800265b0((ulonglong)uVar3,param_4,param_5,param_6,
*(longlong *)(*(longlong *)(param_2 + 2) + (ulonglong)uVar3 * 8),param_7
,uVar7);
return uVar3;
}
}
return 0x490;
}
=========================================
Function at address: 0x18002488a
Called functions addresses: None


void FUN_18002488a(void)

{
longlong unaff_RBP;
ulonglong unaff_RSI;
longlong *unaff_R12;
longlong unaff_R13;
undefined8 unaff_R14;
uint in_stack_000000a0;
longlong in_stack_000000a8;

FUN_1800265b0(unaff_RSI & 0xffffffff,unaff_R12,in_stack_000000a0,in_stack_000000a8,
*(longlong *)(*(longlong *)(unaff_RBP + 8) + (unaff_RSI & 0xffffffff) * 8),unaff_R14
,unaff_R13);
return;
}
=========================================
Function at address: 0x180024898
Called functions addresses: None


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

longlong * FUN_180024898(longlong *param_1,longlong param_2,undefined4 param_3)

{
ulonglong uVar1;
uint uVar2;

*param_1 = param_2;
*(undefined4 *)(param_1 + 1) = param_3;
*(undefined4 *)((longlong)param_1 + 0xc) = 1;
LOCK();
_DAT_180092d90 = _DAT_180092d90 + 1;
UNLOCK();
uVar2 = 0;
if (*(int *)(param_1 + 1) != 0) {
do {
uVar1 = (ulonglong)uVar2;
uVar2 = uVar2 + 1;
*(longlong **)(uVar1 * 0x360 + 0x358 + *param_1) = param_1;
} while (uVar2 < *(uint *)(param_1 + 1));
}
return param_1;
}
=========================================
Function at address: 0x1800248e0
Called functions addresses: 0x18000a1f4


undefined8 FUN_1800248e0(uint param_1,longlong *param_2,longlong *param_3)

{
longlong lVar1;

if (param_1 <= param_1 * 0x360) {
lVar1 = FUN_18000a1f4((ulonglong)(param_1 * 0x360 + 0x10));
*param_2 = lVar1;
if (lVar1 != 0) {
*param_3 = lVar1 + 0x10;
return 0;
}
}
return 0xe;
}
=========================================
Function at address: 0x18002492c
Called functions addresses: None


longlong *
FUN_18002492c(longlong *param_1,longlong param_2,longlong param_3,longlong param_4,uint param_5)

{
uint uVar1;
undefined8 uVar2;
longlong lVar3;
uint uVar4;
ulonglong uVar5;
ulonglong uVar6;
undefined8 *puVar7;
undefined8 *puVar8;
uint *puVar9;

*(undefined4 *)((longlong)param_1 + 0xc) = 1;
*(uint *)(param_1 + 1) = param_5;
*param_1 = param_2;
if (param_5 != 0) {
lVar3 = 0;
puVar9 = (uint *)(param_4 + 8);
uVar6 = (ulonglong)param_5;
do {
*(uint *)(lVar3 + 8 + *param_1) = *puVar9;
*(undefined *)(lVar3 + 0x18 + *param_1) = *(undefined *)(puVar9 + 2);
*(longlong **)(lVar3 + 0x10 + *param_1) = param_1;
if (*puVar9 != 0) {
uVar5 = 0;
*(longlong *)(lVar3 + *param_1) = param_3;
uVar1 = *puVar9;
if (uVar1 != 0) {
do {
puVar7 = (undefined8 *)(*(longlong *)(puVar9 + -2) + uVar5 * 0x30c);
uVar2 = puVar7[1];
puVar8 = (undefined8 *)(*(longlong *)(lVar3 + *param_1) + uVar5 * 0x30c);
*puVar8 = *puVar7;
puVar8[1] = uVar2;
uVar2 = puVar7[3];
puVar8[2] = puVar7[2];
puVar8[3] = uVar2;
uVar2 = puVar7[5];
puVar8[4] = puVar7[4];
puVar8[5] = uVar2;
uVar2 = puVar7[7];
puVar8[6] = puVar7[6];
puVar8[7] = uVar2;
uVar2 = puVar7[9];
puVar8[8] = puVar7[8];
puVar8[9] = uVar2;
uVar2 = puVar7[0xb];
puVar8[10] = puVar7[10];
puVar8[0xb] = uVar2;
uVar2 = puVar7[0xd];
puVar8[0xc] = puVar7[0xc];
puVar8[0xd] = uVar2;
uVar2 = puVar7[0xf];
puVar8[0xe] = puVar7[0xe];
puVar8[0xf] = uVar2;
uVar2 = puVar7[0x11];
puVar8[0x10] = puVar7[0x10];
puVar8[0x11] = uVar2;
uVar2 = puVar7[0x13];
puVar8[0x12] = puVar7[0x12];
puVar8[0x13] = uVar2;
uVar2 = puVar7[0x15];
puVar8[0x14] = puVar7[0x14];
puVar8[0x15] = uVar2;
uVar2 = puVar7[0x17];
puVar8[0x16] = puVar7[0x16];
puVar8[0x17] = uVar2;
uVar2 = puVar7[0x19];
puVar8[0x18] = puVar7[0x18];
puVar8[0x19] = uVar2;
uVar2 = puVar7[0x1b];
puVar8[0x1a] = puVar7[0x1a];
puVar8[0x1b] = uVar2;
uVar2 = puVar7[0x1d];
puVar8[0x1c] = puVar7[0x1c];
puVar8[0x1d] = uVar2;
puVar8[0x1e] = puVar7[0x1e];
*(undefined4 *)(puVar8 + 0x1f) = *(undefined4 *)(puVar7 + 0x1f);
*(undefined2 *)((longlong)puVar8 + 0xfc) = *(undefined2 *)((longlong)puVar7 + 0xfc);
*(undefined *)((longlong)puVar8 + 0xfe) = *(undefined *)((longlong)puVar7 + 0xfe);
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x206);
*(undefined8 *)((longlong)puVar8 + 0x1fe) = *(undefined8 *)((longlong)puVar7 + 0x1fe);
*(undefined8 *)((longlong)puVar8 + 0x206) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x216);
*(undefined8 *)((longlong)puVar8 + 0x20e) = *(undefined8 *)((longlong)puVar7 + 0x20e);
*(undefined8 *)((longlong)puVar8 + 0x216) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x226);
*(undefined8 *)((longlong)puVar8 + 0x21e) = *(undefined8 *)((longlong)puVar7 + 0x21e);
*(undefined8 *)((longlong)puVar8 + 0x226) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x236);
*(undefined8 *)((longlong)puVar8 + 0x22e) = *(undefined8 *)((longlong)puVar7 + 0x22e);
*(undefined8 *)((longlong)puVar8 + 0x236) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x246);
*(undefined8 *)((longlong)puVar8 + 0x23e) = *(undefined8 *)((longlong)puVar7 + 0x23e);
*(undefined8 *)((longlong)puVar8 + 0x246) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x256);
*(undefined8 *)((longlong)puVar8 + 0x24e) = *(undefined8 *)((longlong)puVar7 + 0x24e);
*(undefined8 *)((longlong)puVar8 + 0x256) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x266);
*(undefined8 *)((longlong)puVar8 + 0x25e) = *(undefined8 *)((longlong)puVar7 + 0x25e);
*(undefined8 *)((longlong)puVar8 + 0x266) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x276);
*(undefined8 *)((longlong)puVar8 + 0x26e) = *(undefined8 *)((longlong)puVar7 + 0x26e);
*(undefined8 *)((longlong)puVar8 + 0x276) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x286);
*(undefined8 *)((longlong)puVar8 + 0x27e) = *(undefined8 *)((longlong)puVar7 + 0x27e);
*(undefined8 *)((longlong)puVar8 + 0x286) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x296);
*(undefined8 *)((longlong)puVar8 + 0x28e) = *(undefined8 *)((longlong)puVar7 + 0x28e);
*(undefined8 *)((longlong)puVar8 + 0x296) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x2a6);
*(undefined8 *)((longlong)puVar8 + 0x29e) = *(undefined8 *)((longlong)puVar7 + 0x29e);
*(undefined8 *)((longlong)puVar8 + 0x2a6) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x2b6);
*(undefined8 *)((longlong)puVar8 + 0x2ae) = *(undefined8 *)((longlong)puVar7 + 0x2ae);
*(undefined8 *)((longlong)puVar8 + 0x2b6) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x2c6);
*(undefined8 *)((longlong)puVar8 + 0x2be) = *(undefined8 *)((longlong)puVar7 + 0x2be);
*(undefined8 *)((longlong)puVar8 + 0x2c6) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x2d6);
*(undefined8 *)((longlong)puVar8 + 0x2ce) = *(undefined8 *)((longlong)puVar7 + 0x2ce);
*(undefined8 *)((longlong)puVar8 + 0x2d6) = uVar2;
uVar2 = *(undefined8 *)((longlong)puVar7 + 0x2e6);
*(undefined8 *)((longlong)puVar8 + 0x2de) = *(undefined8 *)((longlong)puVar7 + 0x2de);
*(undefined8 *)((longlong)puVar8 + 0x2e6) = uVar2;
uVar4 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar4;
*(undefined8 *)((longlong)puVar8 + 0x2ee) = *(undefined8 *)((longlong)puVar7 + 0x2ee);
*(undefined4 *)((longlong)puVar8 + 0x2f6) = *(undefined4 *)((longlong)puVar7 + 0x2f6);
*(undefined2 *)((longlong)puVar8 + 0x2fa) = *(undefined2 *)((longlong)puVar7 + 0x2fa);
*(undefined *)((longlong)puVar8 + 0x2fc) = *(undefined *)((longlong)puVar7 + 0x2fc);
*(undefined4 *)((longlong)puVar8 + 0x304) = *(undefined4 *)((longlong)puVar7 + 0x304);
*(undefined4 *)(puVar8 + 0x60) = *(undefined4 *)(puVar7 + 0x60);
*(undefined4 *)(puVar8 + 0x61) = *(undefined4 *)(puVar7 + 0x61);
uVar1 = *puVar9;
} while (uVar4 < uVar1);
}
param_3 = param_3 + (ulonglong)uVar1 * 0x30c;
}
puVar9 = puVar9 + 6;
lVar3 = lVar3 + 0x20;
uVar6 = uVar6 - 1;
} while (uVar6 != 0);
}
return param_1;
}
=========================================
Function at address: 0x180024b84
Called functions addresses: 0x180024bec


LSTATUS FUN_180024b84(undefined8 *param_1,undefined4 *param_2)

{
LSTATUS LVar1;
undefined4 *puVar2;

if (param_2 != (undefined4 *)0x0) {
*param_2 = 0;
}
if (param_1 == (undefined8 *)0x0) {
LVar1 = -0x3ffffff3;
}
else {
puVar2 = param_2;
LVar1 = FUN_180024bec(L"Software\\Policies\\Microsoft\\Cryptography\\Configuration\\SSL\\00010002"
,(ulonglong)param_2,param_1);
if (LVar1 == 0) {
*param_2 = 1;
LVar1 = 0;
}
else {
LVar1 = FUN_180024bec(L"System\\CurrentControlSet\\Control\\Cryptography\\Configuration\\Local\\SSL\\00010002"
,(ulonglong)puVar2,param_1);
if (LVar1 == 0) {
*param_2 = 0;
}
}
}
return LVar1;
}
=========================================
Function at address: 0x180024bec
Called functions addresses: 0x18000a1f4 0xEXTERNAL:0000004f 0xEXTERNAL:0000004d 0x18000909c 0xEXTERNAL:0000004b


LSTATUS FUN_180024bec(LPCWSTR param_1,ulonglong param_2,undefined8 *param_3)

{
LSTATUS LVar1;
LPBYTE lpData;
ulonglong local_res10;
DWORD local_res18 [2];
HKEY local_res20;

lpData = (LPBYTE)0x0;
local_res20 = (HKEY)0x0;
local_res10 = param_2 & 0xffffffff00000000;
if (param_3 == (undefined8 *)0x0) {
return -0x3ffffff3;
}
*param_3 = 0;
LVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,param_1,0,0x20119,&local_res20);
if (LVar1 == 0) {
LVar1 = RegQueryValueExW(local_res20,L"EccCurves",(LPDWORD)0x0,local_res18,(LPBYTE)0x0,
(LPDWORD)&local_res10);
if ((LVar1 != 0) || (local_res18[0] != 7)) goto LAB_180024cea;
lpData = (LPBYTE)FUN_18000a1f4((ulonglong)((uint)local_res10 + 4));
if (lpData == (LPBYTE)0x0) goto LAB_180024cea;
LVar1 = RegQueryValueExW(local_res20,L"EccCurves",(LPDWORD)0x0,local_res18,lpData,
(LPDWORD)&local_res10);
if ((LVar1 != 0) || (local_res18[0] != 7)) {
FUN_18000909c(lpData);
goto LAB_180024cea;
}
(lpData + (ulonglong)((uint)local_res10 >> 1) * 2)[0] = '\0';
(lpData + (ulonglong)((uint)local_res10 >> 1) * 2)[1] = '\0';
(lpData + (ulonglong)((uint)local_res10 >> 1) * 2 + 2)[0] = '\0';
(lpData + (ulonglong)((uint)local_res10 >> 1) * 2 + 2)[1] = '\0';
}
*param_3 = lpData;
LAB_180024cea:
if (local_res20 != (HKEY)0x0) {
RegCloseKey(local_res20);
}
return LVar1;
}
=========================================
Function at address: 0x180024d20
Called functions addresses: 0xEXTERNAL:0000004f 0xEXTERNAL:0000004d 0xEXTERNAL:0000004b 0x180024db5


undefined8 FUN_180024d20(void)

{
LSTATUS LVar1;
undefined8 uVar2;
DWORD local_res8 [2];
DWORD local_res10 [2];
HKEY local_res18 [2];

local_res18[0] = (HKEY)0x0;
uVar2 = 0;
LVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,
L"Software\\Policies\\Microsoft\\Cryptography\\Configuration\\SSL\\00010002"
,0,0x20119,local_res18);
if (LVar1 == 0) {
LVar1 = RegQueryValueExW(local_res18[0],L"Functions",(LPDWORD)0x0,local_res8,(LPBYTE)0x0,
local_res10);
if ((LVar1 == 0) && (local_res8[0] == 1)) {
uVar2 = FUN_180024db5();
return uVar2;
}
}
else {
uVar2 = 1;
}
if (local_res18[0] != (HKEY)0x0) {
RegCloseKey(local_res18[0]);
}
return uVar2;
}
=========================================
Function at address: 0x180024db5
Called functions addresses: None


undefined8 FUN_180024db5(void)

{
HKEY in_stack_00000050;

if (in_stack_00000050 != (HKEY)0x0) {
RegCloseKey(in_stack_00000050);
}
return 1;
}
=========================================
Function at address: 0x180024dc4
Called functions addresses: 0xEXTERNAL:000000fd 0x180024fd0 0xEXTERNAL:0000010d 0xEXTERNAL:000000fe


int FUN_180024dc4(ulonglong param_1,char *param_2)

{
short sVar1;
short sVar2;
bool bVar3;
int iVar4;
ulonglong uVar5;
uint uVar6;
short *psVar7;
uint uVar8;
ulonglong uVar9;
longlong lVar10;
ulonglong local_res8;
longlong local_res10;

local_res8 = param_1 & 0xffffffff00000000;
local_res10 = 0;
*param_2 = '\0';
bVar3 = true;
iVar4 = SslEnumProtocolProviders(&local_res8,&local_res10);
if (iVar4 == 0) {
if ((uint)local_res8 - 1 < 0x20) {
if ((uint)local_res8 == DAT_180092498) {
uVar5 = 0;
uVar6 = 0;
if ((uint)local_res8 != 0) {
do {
uVar6 = (uint)uVar5;
if (!bVar3) break;
uVar9 = 0;
bVar3 = false;
if (DAT_180092498 != 0) {
do {
if (bVar3) break;
psVar7 = *(short **)(local_res10 + uVar5 * 0x10);
lVar10 = *(longlong *)(DAT_180092490 + uVar9 * 0x10) - (longlong)psVar7;
do {
sVar1 = *psVar7;
sVar2 = *(short *)((longlong)psVar7 + lVar10);
if (sVar1 != sVar2) break;
psVar7 = psVar7 + 1;
} while (sVar2 != 0);
if (sVar1 == sVar2) {
bVar3 = true;
}
uVar8 = (int)uVar9 + 1;
uVar9 = (ulonglong)uVar8;
} while (uVar8 < DAT_180092498);
}
uVar6 = uVar6 + 1;
uVar5 = (ulonglong)uVar6;
} while (uVar6 < (uint)local_res8);
}
if (uVar6 != (uint)local_res8) goto LAB_180024edd;
if (*param_2 != '\0') goto LAB_180024ee0;
}
else {
LAB_180024edd:
*param_2 = '\x01';
LAB_180024ee0:
FUN_180024fd0();
DAT_180092490 = local_res10;
DAT_180092498 = (uint)local_res8;
uVar5 = 0;
local_res10 = 0;
if ((uint)local_res8 != 0) {
do {
lVar10 = *(longlong *)(DAT_180092490 + uVar5 * 0x10);
if (lVar10 == 0) goto LAB_18002ab52;
iVar4 = SslOpenProvider(&DAT_1800924a0 + uVar5,lVar10,0);
if (iVar4 != 0) goto LAB_18002ab57;
uVar6 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar6;
} while (uVar6 < DAT_180092498);
}
}
iVar4 = 0;
goto LAB_180024eb2;
}
LAB_18002ab52:
iVar4 = 0x54f;
}
LAB_18002ab57:
FUN_180024fd0();
LAB_180024eb2:
if (local_res10 != 0) {
SslFreeBuffer();
}
return iVar4;
}
=========================================
Function at address: 0x180024f64
Called functions addresses: 0x180003ce4 0xEXTERNAL:00000108 0x180024fd0 0x180003d20


void FUN_180024f64(undefined8 param_1,char param_2)

{
if (param_2 != '\0') {
FUN_180024fd0();
if (DAT_1800925a8 != 0) {
NCryptFreeObject(DAT_1800925a8);
DAT_1800925a8 = 0;
}
}
if (DAT_1800925b0 != (longlong *)0x0) {
FUN_180003ce4(DAT_1800925b0);
DAT_1800925b0 = (longlong *)0x0;
}
if (DAT_1800925b8 != (longlong *)0x0) {
FUN_180003ce4(DAT_1800925b8);
DAT_1800925b8 = (longlong *)0x0;
}
if (DAT_1800925c8 != (HLOCAL)0x0) {
FUN_180003d20(DAT_1800925c8);
DAT_1800925c8 = (HLOCAL)0x0;
}
DAT_1800925d0 = 0;
return;
}
=========================================
Function at address: 0x180024fd0
Called functions addresses: 0xEXTERNAL:0000011c 0xEXTERNAL:000000fe


void FUN_180024fd0(void)

{
uint uVar1;
ulonglong uVar2;

uVar2 = 0;
if (DAT_180092498 != 0) {
do {
SslFreeObject((&DAT_1800924a0)[uVar2],0);
(&DAT_1800924a0)[uVar2] = 0;
uVar1 = (int)uVar2 + 1;
uVar2 = (ulonglong)uVar1;
} while (uVar1 < DAT_180092498);
}
if (DAT_180092490 != 0) {
SslFreeBuffer();
DAT_180092490 = 0;
}
DAT_180092498 = 0;
return;
}
=========================================
Function at address: 0x18002501c
Called functions addresses: 0x1800260e0 0xEXTERNAL:000000a2 0x180025b58 0xEXTERNAL:00000068 0x18007a134 0xEXTERNAL:00000064 0x18002623c 0xEXTERNAL:0000008f 0x18007a5c0 0xEXTERNAL:000000a0


void FUN_18002501c(void)

{
uint uVar1;
longlong lVar2;
HANDLE Timer;
code *pcVar3;
int iVar4;
BOOL BVar5;
undefined4 *Parameter;
undefined in_CL;
longlong *plVar6;
undefined in_DL;
undefined *puVar7;
undefined *puVar8;
longlong *unaff_RDI;
undefined in_R8B;
ULONG DueTime;
undefined in_R9B;
longlong *local_res20;
undefined auStackY_48 [8];
undefined auStackY_40 [24];
undefined in_stack_ffffffffffffffd8;
undefined in_stack_ffffffffffffffe0;

puVar7 = auStackY_48;
local_res20 = (longlong *)0x0;
if ((*(byte *)((longlong)ProcessEnvironmentBlock + 3) & 2) != 0) {
DAT_180092d88 = (longlong *)0x0;
return;
}
if (((longlong)DAT_180092d88 + 1U & 0xfffffffffffffffe) != 0) {
return;
}
iVar4 = FUN_180025b58(in_CL,in_DL,in_R8B,in_R9B,in_stack_ffffffffffffffd8,
in_stack_ffffffffffffffe0,&local_res20);
plVar6 = local_res20;
puVar8 = auStackY_48;
if ((iVar4 == 0) ||
(Parameter = FUN_18002623c(), plVar6 = local_res20, puVar8 = auStackY_48,
Parameter == (undefined4 *)0x0)) goto LAB_180025104;
EnterCriticalSection((LPCRITICAL_SECTION)(Parameter + 0x14));
plVar6 = *(longlong **)(Parameter + 0xc);
if ((undefined4 *)*plVar6 == Parameter + 10) {
*local_res20 = (longlong)(Parameter + 10);
local_res20[1] = (longlong)plVar6;
*plVar6 = (longlong)local_res20;
*(longlong **)(Parameter + 0xc) = local_res20;
Parameter[8] = Parameter[8] + 1;
puVar8 = auStackY_48;
unaff_RDI = local_res20;
if (*(longlong *)(Parameter + 0x10) == 0) goto LAB_18002abee;
LAB_1800250ca:
uVar1 = Parameter[0xf];
if (uVar1 < (uint)(Parameter[8] * 10)) {
iVar4 = Parameter[8] + 6;
DueTime = iVar4 * 10000;
Parameter[0xf] = iVar4 * 10;
Timer = *(HANDLE *)(Parameter + 0x12);
*(undefined8 *)(puVar7 + -8) = 0x18002ac82;
BVar5 = ChangeTimerQueueTimer((HANDLE)0x0,Timer,DueTime,DueTime);
if (BVar5 == 0) {
Parameter[0xf] = uVar1;
}
}
}
else {
pcVar3 = (code *)swi(0x29);
(*pcVar3)(3);
puVar8 = auStackY_40;
LAB_18002abee:
puVar7 = puVar8;
if (*(char *)(Parameter + 0xe) == '\0') {
*(undefined8 *)(puVar7 + -8) = 0x18002abfb;
BVar5 = IsDebuggerPresent();
if (BVar5 == 0) {
if (*(longlong *)(Parameter + 0x10) != 0) goto LAB_1800250ca;
goto LAB_1800250dd;
}
}
*(undefined4 *)(puVar7 + 0x30) = 0;
*(undefined4 *)(puVar7 + 0x28) = 60000;
Parameter[0xf] = 0x3c;
*(undefined4 *)(puVar7 + 0x20) = 180000;
*(undefined8 *)(puVar7 + -8) = 0x18002ac4a;
BVar5 = CreateTimerQueueTimer
((PHANDLE)(Parameter + 0x12),(HANDLE)0x0,FUN_18007a5c0,Parameter,
*(DWORD *)(puVar7 + 0x20),*(DWORD *)(puVar7 + 0x28),*(ULONG *)(puVar7 + 0x30)
);
if (BVar5 != 0) {
*(code **)(Parameter + 0x10) = FUN_18007a5c0;
}
}
LAB_1800250dd:
*(undefined8 *)(puVar7 + -8) = 0x1800250e8;
LeaveCriticalSection((LPCRITICAL_SECTION)(Parameter + 0x14));
lVar2 = unaff_RDI[0x1d];
*(undefined8 *)(puVar7 + -8) = 0x1800250fb;
FUN_1800260e0(lVar2,1);
plVar6 = (longlong *)0x0;
puVar8 = puVar7;
DAT_180092d88 = unaff_RDI;
LAB_180025104:
if (plVar6 != (longlong *)0x0) {
*(undefined8 *)(puVar8 + -8) = 0x180025124;
FUN_18007a134(plVar6);
}
return;
}
=========================================
Function at address: 0x180025130
Called functions addresses: 0x18002518c 0x18002647c 0x18002516c


void FUN_180025130(longlong *param_1)

{
longlong lVar1;
LSTATUS LVar2;

lVar1 = param_1[2];
LVar2 = FUN_18002647c(param_1);
if (LVar2 == 0) {
FUN_18002518c((uint)(lVar1 == 0));
FUN_18002516c(DAT_180083f48);
}
return;
}
=========================================
Function at address: 0x18002516c
Called functions addresses: 0xEXTERNAL:000000b0


undefined8 FUN_18002516c(undefined8 param_1)

{
if (DAT_18009278c != 0) {
RtlPublishWnfStateData(param_1,0,0,0,0);
}
return 0;
}
=========================================
Function at address: 0x18002518c
Called functions addresses: 0xEXTERNAL:000000b1 0x1800595e0 0x180055070 0x1800263ac 0x180041cb0 0xEXTERNAL:0000004f 0xEXTERNAL:00000051 0xEXTERNAL:0000004d 0xEXTERNAL:0000004b 0x180025ad4 0x1800279e8


undefined8 FUN_18002518c(int param_1)

{
uint *puVar1;
bool bVar2;
bool bVar3;
bool bVar4;
bool bVar5;
bool bVar6;
bool bVar7;
bool bVar8;
LSTATUS LVar9;
uint uVar10;
undefined7 extraout_var;
undefined7 extraout_var_00;
undefined7 extraout_var_01;
undefined7 extraout_var_02;
undefined7 extraout_var_03;
undefined7 extraout_var_04;
undefined7 extraout_var_05;
undefined7 extraout_var_06;
HKEY pHVar11;
uint uVar12;
longlong lVar13;
HKEY pHVar14;
uint *puVar15;
longlong lVar16;
bool bVar17;
bool bVar18;
bool bVar19;
uint local_res10 [2];
uint local_res18 [2];
DWORD local_res20 [2];
DWORD local_68 [2];
HKEY local_60;
HKEY local_58;
HKEY local_50 [2];

pHVar14 = (HKEY)0x0;
local_60 = (HKEY)0x0;
local_res10[0] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180085338);
}
LVar9 = RegOpenKeyExW((HKEY)0xffffffff80000002,
L"System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel",0,0x2001b
,local_50);
if (LVar9 != 0) {
local_50[0] = pHVar14;
}
bVar2 = FUN_180025ad4(DAT_180092688,local_50[0],L"EventLogging",(int *)&DAT_1800919b0,1);
bVar3 = FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"LogLevel",(int *)&DAT_180092ec0,0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"ManualCredValidation",(int *)local_res10,0);
bVar17 = (local_res10[0] != 0) != DAT_180092f04;
if (bVar17) {
DAT_180092f04 = (uint)(local_res10[0] != 0);
}
bVar4 = FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"ClientCacheTime",&DAT_1800919d0,36000000);
bVar5 = FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"ServerCacheTime",&DAT_1800919cc,36000000);
bVar6 = FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"SessionTicketTime",&DAT_1800919c8,36000000);
bVar7 = FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"SessionTicketTimeSkew",&DAT_1800919c4,300000);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"DisableRenegoOnClient",(int *)local_res10,0);
DAT_1800927c4 = (uint)(local_res10[0] != 0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"DisableRenegoOnServer",(int *)local_res10,0);
DAT_1800927c0 = (uint)(local_res10[0] != 0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"MaximumCacheSize",&DAT_1800919c0,20000);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"IgnoreExponentOfOne",(int *)local_res10,0);
bVar18 = (local_res10[0] != 0) != DAT_180092f1c;
if (bVar18) {
DAT_180092f1c = (uint)(local_res10[0] != 0);
}
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"SendTrustedIssuerList",(int *)local_res10,0);
bVar19 = (local_res10[0] != 0) != DAT_180092f08;
if (bVar19) {
DAT_180092f08 = (uint)(local_res10[0] != 0);
}
bVar8 = FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"CertificateMappingMethods",(int *)&DAT_1800919b4,
0x1f);
lVar16 = 0xe;
lVar13 = 8;
bVar2 = bVar19 || (bVar18 ||
((int)CONCAT71(extraout_var_04,bVar7) != 0 ||
((int)CONCAT71(extraout_var_03,bVar6) != 0 ||
((int)CONCAT71(extraout_var_02,bVar5) != 0 ||
((int)CONCAT71(extraout_var_01,bVar4) != 0 ||
(bVar17 ||
((int)CONCAT71(extraout_var_00,bVar3) != 0 ||
(int)CONCAT71(extraout_var,bVar2) != 0)))))));
if ((int)CONCAT71(extraout_var_05,bVar8) != 0) {
bVar2 = true;
if ((((DAT_1800919b4 & 1) == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180085338);
}
if ((((DAT_1800919b4 & 2) == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xe,&DAT_180085338);
}
if ((((DAT_1800919b4 & 4) == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180085338);
}
if ((((DAT_1800919b4 & 8) == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x10,&DAT_180085338);
}
if ((((DAT_1800919b4 & 0x10) == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x11,&DAT_180085338);
bVar2 = true;
}
}
if (local_50[0] != (HKEY)0x0) {
RegCloseKey(local_50[0]);
local_50[0] = (HKEY)0x0;
}
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"IssuerCacheTime",&DAT_1800926f8,600000);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"IssuerCacheSize",&DAT_180092700,100);
if (param_1 != 0) {
DAT_1800926fc = DAT_180092700;
}
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"MaxEncryptedRecordsBeforeKeyUpdate",(int *)&DAT_1800919bc,
0x16a09e6);
if (0x16a09e6 < DAT_1800919bc) {
DAT_1800919bc = 0x16a09e6;
}
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"AllowInsecureRenegoClients",(int *)local_res10,1);
DAT_1800919ac = (uint)(local_res10[0] != 0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"AllowInsecureRenegoServers",(int *)local_res10,1);
DAT_1800919a8 = (uint)(local_res10[0] != 0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"EnableOcspStaplingForSni",(int *)local_res10,0);
DAT_1800927a8 = (uint)(local_res10[0] != 0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"DisableOcspStapling",(int *)local_res10,0);
DAT_1800927a4 = (uint)(local_res10[0] != 0);
if (param_1 != 0) {
FUN_1800263ac(DAT_180092688);
}
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"ClientAuthTrustMode",(int *)local_res10,0);
if (local_res10[0] < 3) {
DAT_180092788 = local_res10[0];
}
bVar3 = FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"CleanupPeriod",&DAT_1800919b8,300);
if ((int)CONCAT71(extraout_var_06,bVar3) != 0) {
FUN_180055070();
FUN_1800279e8();
}
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"SendExtraRecord",(int *)local_res10,0);
DAT_1800927bc = local_res10[0];
if (1 < local_res10[0] - 1) {
DAT_1800927bc = 0;
}
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"EnableConfigChangeNotification",(int *)local_res10,0);
DAT_18009278c = (uint)(local_res10[0] != 0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"HelloVerifyRequestEnabled",(int *)local_res10,1);
DAT_1800919a4 = (uint)(local_res10[0] != 0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"HelloRetryRequestEnabled",(int *)local_res10,0);
DAT_1800927a0 = (uint)(local_res10[0] != 0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"EnableSessionTicket",(int *)local_res10,0);
DAT_1800927b0 = local_res10[0];
if (1 < local_res10[0] - 1) {
DAT_1800927b0 = 0;
}
WinSqmSetDWORD(0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"DisableClientExtendedMasterSecret",(int *)local_res10,0);
DAT_1800927b8 = (uint)(local_res10[0] != 0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"DisableServerExtendedMasterSecret",(int *)local_res10,0);
DAT_1800927b4 = (uint)(local_res10[0] != 0);
FUN_180025ad4(DAT_180092688,(HKEY)0x0,L"MachineID",(int *)local_res10,-1);
local_res10[0] =
local_res10[0] >> 0x18 | (local_res10[0] & 0xff0000) >> 8 | (local_res10[0] & 0xff00) << 8 |
local_res10[0] << 0x18;
if (local_res10[0] != DAT_1800919f4) {
bVar2 = true;
DAT_1800919f4 = local_res10[0];
}
LVar9 = RegOpenKeyExW(DAT_180092688,L"Protocols",0,0x20019,&local_60);
uVar12 = 0x400f3fc0;
uVar10 = 0x30;
if (LVar9 == 0) {
puVar15 = &DAT_18007f098;
do {
LVar9 = RegOpenKeyExW(local_60,*(LPCWSTR *)(puVar15 + -2),0,0x20019,&local_58);
if (LVar9 == 0) {
local_res20[0] = 4;
LVar9 = RegQueryValueExW(local_58,L"Enabled",(LPDWORD)0x0,local_68,(LPBYTE)local_res18,
local_res20);
if (LVar9 == 0) {
if (local_res18[0] == 0) {
uVar12 = uVar12 & ~*puVar15;
}
else {
uVar12 = uVar12 | *puVar15;
}
}
local_res20[0] = 4;
LVar9 = RegQueryValueExW(local_58,L"DisabledByDefault",(LPDWORD)0x0,local_68,
(LPBYTE)local_res18,local_res20);
if (LVar9 == 0) {
if (local_res18[0] == 0) {
uVar10 = uVar10 & ~*puVar15;
}
else {
uVar10 = uVar10 | *puVar15;
}
}
RegCloseKey(local_58);
}
puVar15 = puVar15 + 4;
lVar16 = lVar16 + -1;
} while (lVar16 != 0);
RegCloseKey(local_60);
bVar3 = true;
if (DAT_1800919f8 != uVar12) {
DAT_1800919f8 = uVar12;
bVar2 = bVar3;
}
if (DAT_1800919fc == uVar10) goto LAB_18002585f;
}
else {
DAT_1800919f8 = 0x400f3fc0;
bVar3 = bVar2;
}
DAT_1800919fc = uVar10;
bVar2 = bVar3;
LAB_18002585f:
LVar9 = RegOpenKeyExW(DAT_180092688,L"Ciphers",0,0x20019,&local_60);
puVar15 = &DAT_1800910e4;
pHVar11 = local_60;
if (LVar9 != 0) {
pHVar11 = pHVar14;
local_60 = pHVar14;
}
do {
uVar12 = puVar15[-1];
uVar10 = *puVar15;
puVar15[-1] = uVar10;
if (pHVar11 != (HKEY)0x0) {
local_res18[0] = uVar10;
LVar9 = RegOpenKeyExA(pHVar11,*(LPCSTR *)(puVar15 + 3),0,0x20019,&local_58);
if (LVar9 == 0) {
local_res20[0] = 4;
LVar9 = RegQueryValueExW(local_58,L"Enabled",(LPDWORD)0x0,local_68,(LPBYTE)local_res18,
local_res20);
if (LVar9 != 0) {
local_res18[0] = *puVar15;
}
RegCloseKey(local_58);
}
uVar10 = puVar15[1] & local_res18[0];
puVar15[-1] = uVar10;
pHVar11 = local_60;
}
if (uVar10 != uVar12) {
bVar2 = true;
}
puVar15 = puVar15 + 0xe;
lVar13 = lVar13 + -1;
} while (lVar13 != 0);
if (pHVar11 != (HKEY)0x0) {
RegCloseKey(pHVar11);
}
LVar9 = RegOpenKeyExW(DAT_180092688,L"Hashes",0,0x20019,&local_60);
puVar15 = (uint *)&DAT_180091010;
lVar13 = 5;
pHVar11 = local_60;
if (LVar9 != 0) {
pHVar11 = pHVar14;
local_60 = pHVar14;
}
do {
uVar12 = *puVar15;
uVar10 = puVar15[1];
*puVar15 = uVar10;
if (pHVar11 != (HKEY)0x0) {
local_res18[0] = uVar10;
LVar9 = RegOpenKeyExA(pHVar11,*(LPCSTR *)(puVar15 + 2),0,0x20019,&local_58);
if (LVar9 == 0) {
local_res20[0] = 4;
LVar9 = RegQueryValueExW(local_58,L"Enabled",(LPDWORD)0x0,local_68,(LPBYTE)local_res18,
local_res20);
if (LVar9 != 0) {
local_res18[0] = puVar15[1];
}
RegCloseKey(local_58);
}
uVar10 = *puVar15 & local_res18[0];
*puVar15 = uVar10;
pHVar11 = local_60;
}
if (uVar12 != uVar10) {
bVar2 = true;
}
puVar15 = puVar15 + 10;
lVar13 = lVar13 + -1;
} while (lVar13 != 0);
if (pHVar11 != (HKEY)0x0) {
RegCloseKey(pHVar11);
}
LVar9 = RegOpenKeyExW(DAT_180092688,L"KeyExchangeAlgorithms",0,0x20019,&local_60);
puVar15 = &DAT_1800914c8;
pHVar11 = local_60;
if (LVar9 != 0) {
pHVar11 = pHVar14;
local_60 = pHVar14;
}
do {
puVar1 = puVar15 + 10;
uVar12 = puVar15[-1];
uVar10 = *puVar15;
puVar15[6] = puVar15[7];
puVar15[8] = puVar15[9];
*puVar1 = puVar15[0xb];
puVar15[0xc] = puVar15[0xd];
puVar15[-1] = uVar10;
if (pHVar11 != (HKEY)0x0) {
local_res18[0] = uVar10;
LVar9 = RegOpenKeyExA(pHVar11,*(LPCSTR *)(puVar15 + 2),0,0x20019,&local_58);
if (LVar9 == 0) {
FUN_180025ad4(local_58,(HKEY)0x0,L"Enabled",(int *)local_res18,*puVar15);
FUN_180025ad4(local_58,(HKEY)0x0,L"ClientMinKeyBitLength",(int *)(puVar15 + 6),puVar15[7]);
FUN_180025ad4(local_58,(HKEY)0x0,L"ClientMaxKeyBitLength",(int *)(puVar15 + 8),puVar15[9]);
FUN_180025ad4(local_58,(HKEY)0x0,L"ServerMinKeyBitLength",(int *)puVar1,puVar15[0xb]);
if (puVar15[-2] == 0xaa02) {
uVar10 = 0x400;
if (((0x400 < *puVar1) && (uVar10 = 0x800, 0x800 < *puVar1)) &&
(uVar10 = 0x1000, *puVar1 < 0xc01)) {
uVar10 = 0xc00;
}
*puVar1 = uVar10;
LAB_18002b07f:
FUN_180025ad4(local_58,(HKEY)0x0,L"EphemKeyReuseTime",(int *)(puVar15 + 0xc),puVar15[0xd])
;
}
else if (puVar15[-2] == 0xae06) goto LAB_18002b07f;
RegCloseKey(local_58);
}
puVar15[-1] = puVar15[-1] & local_res18[0];
uVar10 = puVar15[-1];
pHVar11 = local_60;
}
if (uVar12 != uVar10) {
bVar2 = true;
}
puVar1 = puVar15 + 0xe;
puVar15 = puVar15 + 0x10;
if ((uint *)0x1800915bf < puVar1) {
if (pHVar11 != (HKEY)0x0) {
RegCloseKey(pHVar11);
}
LVar9 = RegOpenKeyExW(DAT_180092688,L"Messaging",0,0x20019,&local_60);
if (LVar9 == 0) {
FUN_180025ad4(local_60,(HKEY)0x0,L"MessageLimitClient",&DAT_1800919f0,0x8000);
FUN_180025ad4(local_60,(HKEY)0x0,L"MessageLimitServer",&DAT_1800919ec,0x4000);
FUN_180025ad4(local_60,(HKEY)0x0,L"MessageLimitServerClientAuth",&DAT_1800919e8,0x8000);
RegCloseKey(local_60);
}
if (((param_1 == 0) && (bVar2)) && (DAT_1800927f0 != 0)) {
FUN_1800595e0(DAT_1800927f0,0x30000,0,0,0);
}
return 1;
}
} while( true );
}
=========================================
Function at address: 0x180025ad4
Called functions addresses: 0xEXTERNAL:00000052 0xEXTERNAL:0000004f


bool FUN_180025ad4(HKEY param_1,HKEY param_2,LPCWSTR param_3,int *param_4,int param_5)

{
int iVar1;
LSTATUS LVar2;
DWORD local_res20 [2];
DWORD local_28 [4];

iVar1 = *param_4;
local_res20[0] = 4;
LVar2 = RegQueryValueExW(param_1,param_3,(LPDWORD)0x0,local_28,(LPBYTE)param_4,local_res20);
if ((LVar2 != 0) && (*param_4 = param_5, param_2 != (HKEY)0x0)) {
RegSetValueExW(param_2,param_3,0,4,(BYTE *)param_4,4);
}
return iVar1 != *param_4;
}
=========================================
Function at address: 0x180025b58
Called functions addresses: 0xEXTERNAL:00000069 0xEXTERNAL:000000d9 0xEXTERNAL:000000c8 0xEXTERNAL:00000064 0xEXTERNAL:00000058 0xEXTERNAL:0000004d 0x18007a5c0 0x180028070 0xEXTERNAL:0000009e 0xEXTERNAL:000000d3 0x180018910 0xEXTERNAL:000000c7 0xEXTERNAL:00000041 0xEXTERNAL:000000cb 0xEXTERNAL:0000006d 0x1800260e0 0x180028d90 0xEXTERNAL:00000068 0x18007a134 0x18002623c 0xEXTERNAL:00000053


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180025b58(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
undefined param_5,undefined param_6,undefined8 *param_7)

{
longlong lVar1;
undefined8 uVar2;
undefined8 uVar3;
int iVar4;
DWORD DVar5;
LSTATUS LVar6;
void *_Dst;
HMODULE hModule;
undefined4 *puVar7;
HANDLE pvVar8;
undefined auStackY_268 [32];
ushort local_238 [8];
WCHAR local_228 [260];
undefined2 local_20;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_268;
_Dst = (void *)RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,0xf0);
if (_Dst == (void *)0x0) goto LAB_180025df9;
memset(_Dst,0,0xf0);
InitializeCriticalSection((LPCRITICAL_SECTION)((longlong)_Dst + 0xc0));
*(undefined4 *)((longlong)_Dst + 0x10) = 0x73797364;
*(undefined4 *)((longlong)_Dst + 0x14) = 0x6c727463;
RtlInitUnicodeString(local_238,L"schannel");
if (0x103 < (local_238[0] & 0xfffe)) goto LAB_18002b1c0;
iVar4 = RtlDuplicateUnicodeString(3,local_238,(longlong)_Dst + 0x38);
if (iVar4 < 0) {
LAB_18002b19b:
RtlNtStatusToDosError(iVar4);
}
else {
local_20 = 0;
hModule = GetModuleHandleW(L"schannel.dll");
if ((hModule == (HMODULE)0x0) ||
(DVar5 = GetModuleFileNameW(hModule,local_228,0x104), DVar5 == 0)) {
LAB_18002b1b2:
GetLastError();
}
else {
RtlInitUnicodeString(local_238,local_228);
iVar4 = RtlDuplicateUnicodeString(3,local_238,(longlong)_Dst + 0x28);
if (iVar4 < 0) goto LAB_18002b19b;
LVar6 = RegOpenKeyExW((HKEY)0xffffffff80000002,
L"System\\CurrentControlSet\\Control\\SecurityProviders\\Schannel",0,
0x2000000,(PHKEY)((longlong)_Dst + 0xa8));
if (LVar6 == 0) {
RtlInitUnicodeString((longlong)_Dst + 0xb0,L"LogLevel");
uVar3 = _UNK_180081fa0;
uVar2 = _DAT_180081f98;
*(code **)((longlong)_Dst + 0x90) = FUN_18007a5c0;
*(undefined8 *)((longlong)_Dst + 0x70) = uVar2;
*(undefined8 *)((longlong)_Dst + 0x78) = uVar3;
puVar7 = FUN_18002623c();
if (puVar7 != (undefined4 *)0x0) {
EnterCriticalSection((LPCRITICAL_SECTION)(puVar7 + 0x14));
lVar1 = *(longlong *)(puVar7 + 0x1e);
*(longlong *)(puVar7 + 0x1e) = lVar1 + 1;
*(longlong *)((longlong)_Dst + 0xe8) = lVar1;
LeaveCriticalSection((LPCRITICAL_SECTION)(puVar7 + 0x14));
if (*(char *)(puVar7 + 0xe) != '\0') {
*(undefined4 *)((longlong)_Dst + 0x20) = 3;
}
*(code **)((longlong)_Dst + 0x88) = FUN_180018910;
pvVar8 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCWSTR)0x0);
*(HANDLE *)((longlong)_Dst + 0x98) = pvVar8;
if (pvVar8 != (HANDLE)0x0) {
pvVar8 = RegisterWaitForSingleObjectEx
(pvVar8,FUN_1800260e0,*(PVOID *)((longlong)_Dst + 0xe8),0xffffffff,
0x80);
*(HANDLE *)((longlong)_Dst + 0xa0) = pvVar8;
if (pvVar8 != (HANDLE)0x0) {
NtQuerySystemTime((longlong)_Dst + 0x18);
*param_7 = _Dst;
goto LAB_180025df9;
}
}
goto LAB_18002b1b2;
}
}
}
}
LAB_18002b1c0:
FUN_18007a134(_Dst);
LAB_180025df9:
FUN_180028070(local_18 ^ (ulonglong)auStackY_268);
return;
}
=========================================
Function at address: 0x180025e40
Called functions addresses: 0xEXTERNAL:00000063 0xEXTERNAL:000000c8 0xEXTERNAL:00000028 0x18002a7c0


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined8 FUN_180025e40(int param_1,undefined8 *param_2)

{
LPWSTR lpBuffer;
UINT UVar1;
undefined4 *puVar2;
undefined8 uVar3;

if (param_1 == 2) {

if (puVar2 == (undefined4 *)0x0) {
uVar3 = 0x80090300;
goto LAB_180025f12;
}
*puVar2 = 2;
puVar2[2] = 0xc;
uVar3 = _UNK_180083d28;
*(undefined8 *)(puVar2 + 3) = _DAT_180083d20;
*(undefined8 *)(puVar2 + 5) = uVar3;
uVar3 = _UNK_180083d38;
*(undefined8 *)(puVar2 + 7) = _DAT_180083d30;
*(undefined8 *)(puVar2 + 9) = uVar3;
uVar3 = _UNK_180083d48;
*(undefined8 *)(puVar2 + 0xb) = _DAT_180083d40;
*(undefined8 *)(puVar2 + 0xd) = uVar3;
LAB_180025f10:
uVar3 = 0;
}
else {
if (param_1 != 4) {
uVar3 = 0x80090302;
puVar2 = (undefined4 *)0x0;
goto LAB_180025f12;
}

if (puVar2 == (undefined4 *)0x0) {
uVar3 = 0xc000009a;
goto LAB_180025f12;
}
lpBuffer = (LPWSTR)(puVar2 + 0xe);
UVar1 = GetSystemWow64DirectoryW(lpBuffer,0x104);
if (UVar1 == 0) {
uVar3 = 0x80090302;
}
else {
if ((ulonglong)(UVar1 + 1) + 0xc < 0x104) {
_o_wcscat_s(lpBuffer,0x104,&DAT_1800820b4);
_o_wcscat_s(lpBuffer,0x104,L"schannel.dll");
*puVar2 = 4;
RtlInitUnicodeString(puVar2 + 2,lpBuffer);
goto LAB_180025f10;
}
uVar3 = 0xc000009a;
}

}
LAB_180025f12:
*param_2 = puVar2;
return uVar3;
}
=========================================
Function at address: 0x180025f94
Called functions addresses: 0x180026354 0xEXTERNAL:000000d1 0xEXTERNAL:000000c3 0xEXTERNAL:000000cf 0x18002a2c4 0xEXTERNAL:000000c8 0x180028070


void FUN_180025f94(undefined4 *param_1,undefined8 *param_2)

{
int iVar1;
undefined auStack_2b8 [32];
undefined2 *local_298;
undefined8 local_288;
undefined8 local_280;
undefined8 uStack_278;
undefined4 local_270 [2];
undefined8 local_268;
undefined8 *local_260;
undefined4 local_258;
undefined8 local_250;
undefined8 uStack_248;
wchar_t local_238 [259];
undefined2 local_32;
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_2b8;
local_280 = 0;
uStack_278 = 0;
*param_1 = 0;
local_32 = 0;
local_298 = FUN_180026354();
FID_conflict__snprintf_s(local_238,0x104,0x103,L"\\DSYSDBG.%s");
RtlInitUnicodeString(&local_280,local_238);
local_260 = &local_280;
local_270[0] = 0x30;
local_268 = 0;
local_258 = 0;
local_298 = (undefined2 *)((ulonglong)local_298 & 0xffffffffffffff00);
local_250 = 0;
uStack_248 = 0;
iVar1 = NtCreateEvent(param_2,0x100002,local_270,0);
if (((iVar1 == -0x3fffffcb) || (iVar1 == 0x40000000)) &&
(iVar1 = NtOpenEvent(param_2,0x100000,local_270), -1 < iVar1)) {
local_288 = 0xffffffffdc3cba00;
iVar1 = NtWaitForSingleObject(*param_2,0,&local_288);
if (iVar1 == 0) {
*param_1 = 1;
}
}
FUN_180028070(local_28 ^ (ulonglong)auStack_2b8);
return;
}
=========================================
Function at address: 0x1800260e0
Called functions addresses: 0xEXTERNAL:0000004e 0xEXTERNAL:00000068 0x1800261cc 0xEXTERNAL:00000064 0x18002623c


void FUN_1800260e0(longlong param_1,byte param_2)

{
undefined4 *puVar1;
undefined8 *puVar2;

puVar1 = FUN_18002623c();
if (puVar1 != (undefined4 *)0x0) {
EnterCriticalSection((LPCRITICAL_SECTION)(puVar1 + 0x14));
for (puVar2 = *(undefined8 **)(puVar1 + 10); puVar2 != (undefined8 *)(puVar1 + 10);
puVar2 = (undefined8 *)*puVar2) {
if (puVar2[0x1d] == param_1) {
EnterCriticalSection((LPCRITICAL_SECTION)(puVar2 + 0x18));
FUN_1800261cc((longlong)puVar2,(uint)param_2);
RegNotifyChangeKeyValue((HKEY)puVar2[0x15],0,4,(HANDLE)puVar2[0x13],1);
LeaveCriticalSection((LPCRITICAL_SECTION)(puVar2 + 0x18));
break;
}
}
LeaveCriticalSection((LPCRITICAL_SECTION)(puVar1 + 0x14));
}
return;
}
=========================================
Function at address: 0x1800261cc
Called functions addresses: 0xEXTERNAL:00000068 0x180079a10 0xEXTERNAL:0000004f 0xEXTERNAL:00000064


LSTATUS FUN_1800261cc(longlong param_1,int param_2)

{
LSTATUS LVar1;
DWORD local_res8 [2];
DWORD local_res18 [2];
uint local_res20 [2];

local_res8[0] = 4;
LVar1 = RegQueryValueExW(*(HKEY *)(param_1 + 0xa8),*(LPCWSTR *)(param_1 + 0xb8),(LPDWORD)0x0,
local_res18,(LPBYTE)local_res20,local_res8);
if (LVar1 == 2) {
LVar1 = 0;
}
else if (LVar1 == 0) {
if ((local_res8[0] < 4) || (local_res18[0] != 4)) {
LVar1 = 0x491;
}
else {
EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xc0));
LVar1 = FUN_180079a10(param_1,local_res20[0],param_2);
LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0xc0));
}
}
return LVar1;
}
=========================================
Function at address: 0x18002623c
Called functions addresses: 0x180026354 0xEXTERNAL:00000069 0xEXTERNAL:0000005a 0xEXTERNAL:00000060 0xEXTERNAL:000000d2 0xEXTERNAL:0000005f 0xEXTERNAL:0000005e 0x180028d90 0xEXTERNAL:00000084 0x180025f94 0xEXTERNAL:00000061 0xEXTERNAL:00000062 0xEXTERNAL:000000ce 0xEXTERNAL:000000c5


undefined4 * FUN_18002623c(void)

{
undefined4 *puVar1;
int iVar2;
LPCWSTR pWVar3;
HANDLE hFileMappingObject;
undefined4 *lpAddress;
undefined4 *_Dst;
int local_res8 [2];
undefined local_res10 [8];
longlong local_res18;
_SYSTEM_INFO local_48;

hFileMappingObject = (HANDLE)0x0;
local_res18 = 0;
pWVar3 = FUN_180026354();
local_res8[0] = 0;
if (DAT_180092810 == (undefined4 *)0x0) {
iVar2 = FUN_180025f94(local_res8,&local_res18);
lpAddress = (undefined4 *)0x0;
if (-1 < iVar2) {
GetSystemInfo(&local_48);
if (local_res8[0] == 0) {
pWVar3 = FUN_180026354();
hFileMappingObject =
CreateFileMappingW((HANDLE)0xffffffffffffffff,(LPSECURITY_ATTRIBUTES)0x0,0x4000004,0,
local_48.dwAllocationGranularity,pWVar3);
lpAddress = (undefined4 *)0x0;
if (((hFileMappingObject != (HANDLE)0x0) &&
(lpAddress = (undefined4 *)
MapViewOfFileEx(hFileMappingObject,6,0,0,
(ulonglong)local_48.dwAllocationGranularity,(LPVOID)0x0),
lpAddress != (undefined4 *)0x0)) &&
(_Dst = (undefined4 *)VirtualAlloc(lpAddress,(ulonglong)local_48.dwPageSize,0x1000,4),
_Dst != (undefined4 *)0x0)) {
memset(_Dst,0,0x80);
puVar1 = _Dst + 10;
*_Dst = 0x6c727463;
*(undefined4 **)(_Dst + 0xc) = puVar1;
*(undefined4 **)puVar1 = puVar1;
*(undefined4 **)(_Dst + 2) = _Dst;
NtQuerySystemInformation(0x23,_Dst + 0xe,2);
InitializeCriticalSection((LPCRITICAL_SECTION)(_Dst + 0x14));
iVar2 = NtSetEvent(local_res18,local_res10);
if (-1 < iVar2) {
lpAddress = (undefined4 *)0x0;
*(longlong *)(_Dst + 6) = local_res18;
local_res18 = 0;
*(HANDLE *)(_Dst + 4) = hFileMappingObject;
hFileMappingObject = (HANDLE)0x0;
*(undefined8 *)(_Dst + 0x12) = 0;
DAT_180092810 = _Dst;
}
}
}
else {
hFileMappingObject = OpenFileMappingW(0xf001f,0,pWVar3);
if (((hFileMappingObject != (HANDLE)0x0) &&
(lpAddress = (undefined4 *)
MapViewOfFileEx(hFileMappingObject,6,0,0,
(ulonglong)local_48.dwAllocationGranularity,(LPVOID)0x0),
lpAddress != (undefined4 *)0x0)) &&
(DAT_180092810 = lpAddress, lpAddress != *(undefined4 **)(lpAddress + 2))) {
DAT_180092810 = *(undefined4 **)(lpAddress + 2);
}
}
}
if (local_res18 != 0) {
NtClose();
}
if (lpAddress != (undefined4 *)0x0) {
UnmapViewOfFile(lpAddress);
}
if (hFileMappingObject != (HANDLE)0x0) {
CloseHandle(hFileMappingObject);
}
}
return DAT_180092810;
}
=========================================
Function at address: 0x180026354
Called functions addresses: 0xEXTERNAL:0000007a 0x18002a2c4


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined2 * FUN_180026354(void)

{
DWORD DVar1;

if (DAT_180092820 == 0) {
_DAT_180092a26 = 0;
DVar1 = GetCurrentProcessId();
FID_conflict__snprintf_s(&DAT_180092820,0x104,0x103,L"Debug.Trace.Memory.%x",DVar1);
}
return &DAT_180092820;
}
=========================================
Function at address: 0x1800263ac
Called functions addresses: 0xEXTERNAL:0000003f 0xEXTERNAL:00000040 0xEXTERNAL:0000004f


void FUN_1800263ac(HKEY param_1)

{
LPBYTE pBVar1;
LSTATUS LVar2;
LPBYTE lpData;
DWORD local_res10 [2];
DWORD local_res18 [4];

local_res10[0] = 0;
local_res18[0] = 0;
LVar2 = RegQueryValueExW(param_1,L"OcspReadDirectory",(LPDWORD)0x0,local_res18,(LPBYTE)0x0,
local_res10);
pBVar1 = DAT_180092f48;
if ((((LVar2 == 0) && (local_res10[0] != 0)) && (local_res18[0] == 1)) &&
((lpData = (LPBYTE)LocalAlloc(0x40,(ulonglong)local_res10[0]), pBVar1 = DAT_180092f48,
lpData != (LPBYTE)0x0 &&
(LVar2 = RegQueryValueExW(param_1,L"OcspReadDirectory",(LPDWORD)0x0,local_res18,lpData,
local_res10), pBVar1 = lpData, LVar2 != 0)))) {
LocalFree(lpData);
pBVar1 = DAT_180092f48;
}
DAT_180092f48 = pBVar1;
return;
}
=========================================
Function at address: 0x180026410
Called functions addresses: 0xEXTERNAL:0000003f 0xEXTERNAL:00000040 0xEXTERNAL:0000004f 0x18002647c


void FUN_180026410(longlong *param_1)

{
LSTATUS LVar1;
DWORD local_res8 [4];
DWORD local_res18 [4];

local_res8[0] = 0;
LVar1 = FUN_18002647c(param_1);
if (LVar1 == 0) {
if (DAT_180092f10 != (LPBYTE)0x0) {
LocalFree(DAT_180092f10);
DAT_180092f10 = (LPBYTE)0x0;
}
LVar1 = RegQueryValueExW((HKEY)param_1[2],L"UserMappingSafeDomains",(LPDWORD)0x0,local_res18,
DAT_180092f10,local_res8);
if (((LVar1 == 0) && (local_res8[0] != 0)) && (local_res18[0] == 1)) {
DAT_180092f10 = (LPBYTE)LocalAlloc(0x40,(ulonglong)local_res8[0]);
if (DAT_180092f10 != (LPBYTE)0x0) {
LVar1 = RegQueryValueExW((HKEY)param_1[2],L"UserMappingSafeDomains",(LPDWORD)0x0,local_res18
,DAT_180092f10,local_res8);
if (LVar1 != 0) {
LocalFree(DAT_180092f10);
DAT_180092f10 = (LPBYTE)0x0;
}
}
}
}
return;
}
=========================================
Function at address: 0x18002647c
Called functions addresses: 0xEXTERNAL:00000050 0xEXTERNAL:0000004e 0xEXTERNAL:000000b2 0xEXTERNAL:000000df


LSTATUS FUN_18002647c(longlong *param_1)

{
PHKEY phkResult;
LSTATUS LVar1;
int iVar2;
DWORD local_res8 [2];

if (param_1 != (longlong *)0x0) {
phkResult = (PHKEY)(param_1 + 2);
if ((*phkResult == (HKEY)0x0) &&
(LVar1 = RegCreateKeyExW((HKEY)0xffffffff80000002,(LPCWSTR)param_1[3],0,L"",0,0x20019,
(LPSECURITY_ATTRIBUTES)0x0,phkResult,local_res8), LVar1 != 0)) {
return LVar1;
}
LVar1 = RegNotifyChangeKeyValue(*phkResult,1,0x10000005,(HANDLE)param_1[1],1);
if (*param_1 != 0) {
iVar2 = RtlDeregisterWait();
*param_1 = 0;
if (iVar2 < 0) {
return 0;
}
}
if (LVar1 == 0) {
RtlRegisterWait(param_1,param_1[1],param_1[4],param_1,0xffffffff,0x48);
}
}
return 0;
}
=========================================
Function at address: 0x180026560
Called functions addresses: 0x180041cb0 0x1800237c0 0x18002647c 0xEXTERNAL:0000016c


void FUN_180026560(longlong *param_1,char param_2)

{
LSTATUS LVar1;
NTSTATUS NVar2;
uint uVar3;
byte *pfEnabled;
byte local_res18 [16];

local_res18[0] = 0;
LVar1 = FUN_18002647c(param_1);
if (LVar1 == 0) {
pfEnabled = local_res18;
NVar2 = BCryptGetFipsAlgorithmMode(pfEnabled);
if (NVar2 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180085338);
}
}
else {
uVar3 = (uint)local_res18[0];
if ((uVar3 != DAT_180092f18) && (DAT_180092f18 = uVar3, param_2 == '\0')) {
FUN_1800237c0(pfEnabled);
}
}
}
return;
}
=========================================
Function at address: 0x1800265b0
Called functions addresses: 0x180026908 0x180028d30 0x18002a763 0x180005fc4


uint FUN_1800265b0(undefined8 param_1,longlong *param_2,uint param_3,longlong param_4,
longlong param_5,undefined8 param_6,longlong param_7)

{
wchar_t *_Str1;
short sVar1;
short sVar2;
longlong lVar3;
int iVar4;
undefined8 uVar5;
ulonglong uVar6;
uint uVar7;
short *psVar8;
uint uVar9;
longlong lVar10;
ulonglong uVar11;
ulonglong uVar12;

uVar6 = 0;
uVar12 = (ulonglong)param_3;
uVar11 = uVar6;
if (DAT_180092498 != 0) {
do {
psVar8 = *(short **)(DAT_180092490 + uVar11 * 0x10);
lVar10 = param_5 - (longlong)psVar8;
do {
sVar1 = *psVar8;
sVar2 = *(short *)((longlong)psVar8 + lVar10);
if (sVar1 != sVar2) break;
psVar8 = psVar8 + 1;
} while (sVar2 != 0);
if (sVar1 == sVar2) {
lVar10 = (&DAT_1800924a0)[uVar11];
if (param_3 != 0) {
do {
lVar3 = *param_2;
iVar4 = _o__wcsicmp(param_6,lVar3 + 0x10);
uVar9 = DAT_1800925d8;
if (iVar4 == 0) {
if (uVar6 == 0) {
uVar6 = FUN_180026908(param_4,lVar10,lVar3,0);
}
iVar4 = 0;
uVar5 = FUN_180005fc4(*(int *)(lVar3 + 4));
*(uint *)(uVar6 + 8) = *(uint *)(uVar6 + 8) | (uint)uVar5;
if ((param_7 != 0) && (*(int *)(param_7 + 8) != iVar4)) {
_Str1 = (wchar_t *)(lVar3 + 0x19c);
iVar4 = wcscmp(_Str1,L"ECDH");
if (((iVar4 == 0) ||
(((iVar4 = wcscmp(_Str1,L"ECDH_P256"), iVar4 == 0 ||
(iVar4 = wcscmp(_Str1,L"ECDH_P384"), iVar4 == 0)) ||
(iVar4 = wcscmp(_Str1,L"ECDH_P521"), iVar4 == 0)))) || (*_Str1 == L'\0')) {
*(longlong *)(uVar6 + 0x350) = param_7;
}
}
uVar9 = *(uint *)(lVar3 + 0x198) >> 3;
uVar7 = uVar9 + 3;
if (uVar7 < DAT_1800925d4) {
uVar7 = DAT_1800925d4;
}
uVar9 = uVar9 + *(int *)(lVar3 + 0x114);
DAT_1800925d4 = uVar7;
if (uVar9 < DAT_1800925d8) {
uVar9 = DAT_1800925d8;
}
}
DAT_1800925d8 = uVar9;
param_2 = param_2 + 2;
uVar12 = uVar12 - 1;
} while (uVar12 != 0);
}
return ~-(uint)(uVar6 != 0) & 0x490;
}
uVar9 = (int)uVar11 + 1;
uVar11 = (ulonglong)uVar9;
} while (uVar9 < DAT_180092498);
}
return 0x490;
}
=========================================
Function at address: 0x180026774
Called functions addresses: 0x18000a1f4 0xEXTERNAL:000000aa 0x18005988c 0x180026888 0xEXTERNAL:000000c7


int FUN_180026774(longlong *param_1)

{
uint uVar1;
int iVar2;
longlong lVar3;
longlong *plVar4;
uint uVar5;
ulonglong uVar6;
uint uVar7;
uint uVar8;

uVar8 = *(uint *)(param_1 + 2);
*(uint *)(param_1 + 6) =
((uVar8 - 1) + *(int *)((longlong)param_1 + 0x34)) / *(uint *)((longlong)param_1 + 0x34);
lVar3 = FUN_18000a1f4((ulonglong)(uVar8 << 4));
param_1[1] = lVar3;
if (lVar3 != 0) {
plVar4 = (longlong *)FUN_18000a1f4((ulonglong)(uint)(*(int *)(param_1 + 6) * 0x98));
param_1[5] = (longlong)plVar4;
if (plVar4 != (longlong *)0x0) {
uVar1 = *(uint *)(param_1 + 6);
uVar7 = 0;
lVar3 = param_1[1];
if (uVar1 != 0) {
uVar5 = *(uint *)((longlong)param_1 + 0x34);
do {
if (uVar8 <= uVar5) {
uVar5 = uVar8;
}
FUN_180026888(plVar4,lVar3,uVar5);
uVar5 = *(uint *)((longlong)param_1 + 0x34);
uVar7 = uVar7 + 1;
plVar4 = plVar4 + 0x13;
uVar8 = uVar8 - uVar5;
lVar3 = lVar3 + (ulonglong)uVar5 * 0x10;
uVar1 = *(uint *)(param_1 + 6);
} while (uVar7 < uVar1);
}
uVar6 = 0;
if (uVar1 != 0) {
do {
if (*(char *)(uVar6 * 0x98 + 0x90 + param_1[5]) == '\0') goto LAB_1800409ac;
uVar8 = (int)uVar6 + 1;
uVar6 = (ulonglong)uVar8;
} while (uVar8 < *(uint *)(param_1 + 6));
}
iVar2 = RtlInitializeCriticalSection(param_1 + 7);
if (iVar2 < 0) {
iVar2 = RtlNtStatusToDosError(iVar2);
}
else {
*(undefined *)(param_1 + 0xc) = 1;
}
if (iVar2 == 0) {
return 0;
}
goto LAB_1800409b1;
}
}
LAB_1800409ac:
iVar2 = 0xe;
LAB_1800409b1:
FUN_18005988c(param_1);
DAT_1800927f0 = 0;
return iVar2;
}
=========================================
Function at address: 0x180026888
Called functions addresses: 0xEXTERNAL:000000b5


longlong * FUN_180026888(longlong *param_1,longlong param_2,uint param_3)

{
longlong *plVar1;
longlong lVar2;
longlong lVar3;
ulonglong uVar4;

*param_1 = param_2;
*(uint *)(param_1 + 1) = param_3;
plVar1 = param_1 + 2;
param_1[3] = (longlong)plVar1;
*plVar1 = (longlong)plVar1;
plVar1 = param_1 + 4;
param_1[5] = (longlong)plVar1;
*plVar1 = (longlong)plVar1;
lVar3 = 0;
if (param_3 != 0) {
uVar4 = (ulonglong)param_3;
do {
lVar2 = *param_1 + lVar3;
*(longlong *)(lVar2 + 8) = lVar2;
*(longlong *)lVar2 = lVar2;
lVar3 = lVar3 + 0x10;
uVar4 = uVar4 - 1;
} while (uVar4 != 0);
}
RtlInitializeResource(param_1 + 6);
*(undefined *)(param_1 + 0x12) = 1;
return param_1;
}
=========================================
Function at address: 0x180026908
Called functions addresses: 0x180028d30 0x18000f120 0x18000f1fc 0x180026c74 0x18001529c 0x180023408 0x180026c20 0x180028d78 0x18000f0cc 0x180026b60


longlong FUN_180026908(longlong param_1,longlong param_2,longlong param_3,undefined8 param_4)

{
undefined4 *puVar1;
undefined4 uVar2;
int iVar3;
longlong *plVar4;
longlong lVar5;
ulonglong uVar6;
uint uVar7;
undefined **ppuVar8;
ulonglong uVar9;
ulonglong uVar10;
undefined uVar11;

uVar9 = 0;
puVar1 = (undefined4 *)(param_1 + 0x30);
*(undefined4 *)(param_1 + 8) = 0;
*(undefined4 *)(param_1 + 0xc) = *(undefined4 *)(param_3 + 0x114);
*(uint *)(param_1 + 0x10) = *(uint *)(param_3 + 0x198) >> 3;
*(undefined4 *)(param_1 + 0x14) = *(undefined4 *)(param_3 + 0x110);
*(undefined4 *)(param_1 + 0x18) = *(undefined4 *)(param_3 + 0x21c);
*(undefined4 *)(param_1 + 0x1c) = *(undefined4 *)(param_3 + 8);
*puVar1 = 0;
*(undefined4 *)(param_1 + 0x34) = 0;
uVar11 = 0;
*(undefined *)(param_1 + 0x38) = 0;
*(undefined8 *)(param_1 + 0x40) = 0;
*(undefined8 *)(param_1 + 0x350) = 0;
*(undefined8 *)(param_1 + 0x358) = 0;
lVar5 = param_1;
FUN_180023408(param_1,param_2,(longlong *)param_1);
uVar2 = FUN_18000f0cc(param_3,param_2);
*(undefined4 *)(param_1 + 0x20) = uVar2;
uVar2 = FUN_180026c20(param_3,param_2);
*(undefined4 *)(param_1 + 0x24) = uVar2;
uVar2 = FUN_18000f1fc(param_3,param_2,lVar5);
*(undefined4 *)(param_1 + 0x28) = uVar2;
uVar2 = FUN_18000f120(param_3,param_2,lVar5,param_4);
*(undefined4 *)(param_1 + 0x2c) = uVar2;
_o_wcscpy_s(param_1 + 0xca,0x40,param_3 + 0x90);
_o_wcscpy_s(param_1 + 0x14a,0x40,param_3 + 0x19c);
_o_wcscpy_s(param_1 + 0x1ca,0x40,(LPCWSTR)(param_3 + 0x224));
_o_wcscpy_s(param_1 + 0x24a,0x40,param_3 + 0x118);
_o_wcscpy_s(param_1 + 0x2ca,0x40,param_3 + 0x2a8);
if (*(int *)(param_3 + 4) != 0x304) {
if (puVar1 != (undefined4 *)0x0) {
*puVar1 = 0;
}
uVar10 = (ulonglong)DAT_1800923b0;
uVar6 = uVar9;
if (DAT_1800923b0 != 0) {
plVar4 = &DAT_1800923c0;
do {
lVar5 = *plVar4;
if ((lVar5 != 0) && (*(int *)(lVar5 + 0xc) == *(int *)(param_1 + 0x20))) {
FUN_18001529c(lVar5,uVar6,uVar10,(undefined4 *)0x0,puVar1);
break;
}
uVar7 = (int)uVar6 + 1;
uVar6 = (ulonglong)uVar7;
plVar4 = plVar4 + 1;
} while (uVar7 < DAT_1800923b0);
}
FUN_180026c74(*(int *)(param_1 + 0x24),uVar6,uVar10,(undefined4 *)0x0,
(undefined4 *)(param_1 + 0x34));
}
FUN_180026b60((LPCWSTR)(param_3 + 0x224),(undefined *)(param_1 + 0x38),
(NCRYPT_PROV_HANDLE *)(param_1 + 0x40));
uVar7 = *(uint *)(param_3 + 8);
if ((uVar7 == 3) || ((0x61 < uVar7 && ((uVar7 < 0x65 || (uVar7 == 0x20080)))))) {
uVar11 = 1;
}
*(undefined *)(param_1 + 0x48) = uVar11;
_o_wcscpy_s(param_1 + 0x4a,0x40,param_3 + 0x10);
lVar5 = -1;
uVar6 = 0xffffffffffffffff;
do {
uVar6 = uVar6 + 1;
} while (*(short *)(param_1 + 0x4a + uVar6 * 2) != 0);
if (5 < uVar6) {
do {
lVar5 = lVar5 + 1;
} while (*(short *)(param_1 + 0x4a + lVar5 * 2) != 0);
lVar5 = param_1 + lVar5 * 2;
ppuVar8 = &PTR_u__P256_18007f170;
do {
iVar3 = _o__wcsicmp(lVar5 + 0x40,*ppuVar8);
if (iVar3 == 0) {
*(undefined2 *)(lVar5 + 0x40) = 0;
return param_1;
}
uVar7 = (int)uVar9 + 1;
uVar9 = (ulonglong)uVar7;
ppuVar8 = ppuVar8 + 99;
} while (uVar7 < 3);
}
return param_1;
}
=========================================
Function at address: 0x180026b60
Called functions addresses: 0x180028d30 0xEXTERNAL:00000100 0xEXTERNAL:00000172 0xEXTERNAL:00000173


NTSTATUS FUN_180026b60(LPCWSTR param_1,undefined *param_2,NCRYPT_PROV_HANDLE *param_3)

{
NTSTATUS NVar1;
int iVar2;
uint uVar3;
ulonglong uVar4;
ULONG local_res20 [2];
PCRYPT_CONTEXT_FUNCTION_PROVIDERS local_18 [2];

local_res20[0] = 0;
local_18[0] = (PCRYPT_CONTEXT_FUNCTION_PROVIDERS)0x0;
NVar1 = BCryptEnumContextFunctionProviders(1,(LPCWSTR)0x0,3,param_1,local_res20,local_18);
if ((-1 < NVar1) && (uVar4 = 0, local_18[0]->cProviders != 0)) {
do {
iVar2 = _o__wcsicmp(local_18[0]->rgpszProviders[uVar4],L"Microsoft Primitive Provider");
if (iVar2 == 0) {
NVar1 = 0;
*param_3 = DAT_1800925a8;
*param_2 = 0;
break;
}
NVar1 = NCryptOpenStorageProvider(param_3,local_18[0]->rgpszProviders[uVar4],0);
if (-1 < NVar1) {
*param_2 = 1;
break;
}
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
} while (uVar3 < local_18[0]->cProviders);
}
if (local_18[0] != (PCRYPT_CONTEXT_FUNCTION_PROVIDERS)0x0) {
BCryptFreeBuffer(local_18[0]);
}
return NVar1;
}
=========================================
Function at address: 0x180026c20
Called functions addresses: 0x180015504 0x180040a26


undefined4 FUN_180026c20(longlong param_1,undefined8 param_2)

{
undefined4 uVar1;
undefined8 uVar2;
undefined4 local_res8 [8];

local_res8[0] = 0;
uVar2 = FUN_180015504(param_1 + 0x224,param_2,local_res8);
if ((((int)uVar2 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar1 = FUN_180040a26((longlong)DAT_180091000);
return uVar1;
}
return local_res8[0];
}
=========================================
Function at address: 0x180026c74
Called functions addresses: 0x1800155b4


undefined8
FUN_180026c74(int param_1,undefined8 param_2,undefined8 param_3,undefined4 *param_4,
undefined4 *param_5)

{
longlong lVar1;
undefined8 uVar2;
uint uVar3;
ulonglong uVar4;
longlong *plVar5;

if (param_4 != (undefined4 *)0x0) {
*param_4 = 0;
}
if (param_5 != (undefined4 *)0x0) {
*param_5 = 0;
}
uVar4 = 0;
if (DAT_180092218 != 0) {
plVar5 = &DAT_180092220;
do {
lVar1 = *plVar5;
if ((lVar1 != 0) && (*(int *)(lVar1 + 0xc) == param_1)) {
uVar2 = FUN_1800155b4(lVar1,uVar4,plVar5,(undefined4 *)0x0,param_4,param_5);
return uVar2;
}
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
plVar5 = plVar5 + 1;
} while (uVar3 < DAT_180092218);
}
return 0x490;
}
=========================================
Function at address: 0x180026ce8
Called functions addresses: 0x180026d38 0x18000909c


void FUN_180026ce8(uint param_1,longlong param_2,HLOCAL param_3)

{
ulonglong uVar1;

if (param_1 != 0) {
uVar1 = (ulonglong)param_1;
do {
FUN_180026d38(param_2);
param_2 = param_2 + 0x360;
uVar1 = uVar1 - 1;
} while (uVar1 != 0);
}
FUN_18000909c(param_3);
return;
}
=========================================
Function at address: 0x180026d38
Called functions addresses: 0xEXTERNAL:00000108 0x180023480


void FUN_180026d38(longlong param_1)

{
FUN_180023480(param_1,(longlong *)param_1);
if ((*(char *)(param_1 + 0x38) != '\0') && (*(NCRYPT_HANDLE *)(param_1 + 0x40) != 0)) {
NCryptFreeObject(*(NCRYPT_HANDLE *)(param_1 + 0x40));
*(undefined8 *)(param_1 + 0x40) = 0;
}
return;
}
=========================================
Function at address: 0x180026d60
Called functions addresses: 0x18000a1f4 0x180026e25 0x180028d90 0xEXTERNAL:000000b5


/* WARNING: Removing unreachable block (ram,0x000180026e25) */

undefined4 FUN_180026d60(void)

{
undefined4 uVar1;
longlong lVar2;
uint uVar3;

memset(&DAT_1800926f0,0,0x90);
DAT_1800926f8 = 600000;
DAT_1800926fc = 100;
DAT_180092700 = 100;
DAT_180092710 = &DAT_180092708;
DAT_180092708 = &DAT_180092708;
RtlInitializeResource(&DAT_180092718);
DAT_180092778 = 1;
DAT_1800926f0 = FUN_18000a1f4((ulonglong)(DAT_1800926fc << 4));
if (DAT_1800926f0 == 0) {
uVar1 = FUN_180026e25();
return uVar1;
}
uVar3 = 0;
if (DAT_1800926fc != 0) {
do {
lVar2 = (ulonglong)uVar3 * 0x10 + DAT_1800926f0;
*(longlong *)(lVar2 + 8) = lVar2;
*(longlong *)lVar2 = lVar2;
uVar3 = uVar3 + 1;
} while (uVar3 < DAT_1800926fc);
}
return 0;
}
=========================================
Function at address: 0x180026e25
Called functions addresses: 0x18005de98


undefined4 FUN_180026e25(void)

{
undefined4 unaff_EBX;

FUN_18005de98();
return unaff_EBX;
}
=========================================
Function at address: 0x180026e34
Called functions addresses: 0x180026f1c 0x180027af0 0xEXTERNAL:0000006e 0x180027078 0x180017e50 0x18007b21c 0x180026fcc 0xEXTERNAL:0000006f


ulonglong FUN_180026e34(void)

{
undefined4 uVar1;
uint uVar2;
LPVOID pvVar3;
longlong lVar4;
ulonglong uVar5;
longlong *plVar6;

pvVar3 = FUN_180027078('\x01');
if (pvVar3 == (LPVOID)0x0) {
uVar5 = FUN_180026f1c(&DAT_180091480,0,0);
}
else {
*(undefined8 *)((longlong)pvVar3 + 0x138) = 0;
*(undefined8 *)((longlong)pvVar3 + 0x140) = 0;
*(undefined4 **)((longlong)pvVar3 + 0x148) = &DAT_180091480;
uVar1 = FUN_180026fcc((ulonglong)pvVar3);
*(undefined4 *)((longlong)pvVar3 + 0x160) = uVar1;
uVar2 = FUN_180026f1c(&DAT_180091480,FUN_180027af0,pvVar3);
uVar5 = (ulonglong)uVar2;
if ((int)uVar2 < 0) {
DAT_1800914a8 = 0;
FUN_18007b21c(pvVar3);
}
else {
AcquireSRWLockExclusive((PSRWLOCK)&DAT_180092d70);
if (DAT_180092ee8 == 0) {
FUN_180026f1c(&DAT_180091870,FUN_180017e50,0);
}
plVar6 = &DAT_180092ee8;
lVar4 = DAT_180092ee8;
while (lVar4 != 0) {
if (*(undefined4 **)(lVar4 + 0x148) == &DAT_180091480) goto LAB_180026eed;
plVar6 = (longlong *)(lVar4 + 0x150);
lVar4 = *plVar6;
}
*plVar6 = (longlong)pvVar3;
LAB_180026eed:
ReleaseSRWLockExclusive((PSRWLOCK)&DAT_180092d70);
uVar5 = 0;
}
}
return uVar5;
}
=========================================
Function at address: 0x180026f1c
Called functions addresses: 0xEXTERNAL:00000092 0x180017d80 0x180028070 0xEXTERNAL:00000093


void FUN_180026f1c(PVOID param_1,undefined8 param_2,undefined8 param_3)

{
PREGHANDLE RegHandle;
undefined2 uVar1;
longlong lVar2;
undefined2 *puVar3;
ULONGLONG UVar4;
code *pcVar5;
ULONG UVar6;
undefined *puVar7;
undefined auStack_48 [8];
undefined auStack_40 [24];
undefined4 local_28;
undefined4 uStack_24;
undefined4 uStack_20;
undefined4 uStack_1c;
ulonglong local_18;

puVar7 = auStack_48;
local_18 = DAT_180091970 ^ (ulonglong)auStack_48;
lVar2 = *(longlong *)((longlong)param_1 + 8);
RegHandle = (PREGHANDLE)((longlong)param_1 + 0x20);
local_28 = *(undefined4 *)(lVar2 + -0x10);
uStack_24 = *(undefined4 *)(lVar2 + -0xc);
uStack_20 = *(undefined4 *)(lVar2 + -8);
uStack_1c = *(undefined4 *)(lVar2 + -4);
if (*RegHandle != 0) {
pcVar5 = (code *)swi(0x29);
(*pcVar5)(5);
puVar7 = auStack_40;
}
*(undefined8 *)((longlong)param_1 + 0x28) = param_2;
*(undefined8 *)((longlong)param_1 + 0x30) = param_3;
*(undefined8 *)(puVar7 + -8) = 0x180026f7a;
UVar6 = EventRegister((LPCGUID)(puVar7 + 0x20),FUN_180017d80,param_1,RegHandle);
if (UVar6 == 0) {
puVar3 = *(undefined2 **)((longlong)param_1 + 8);
UVar4 = *RegHandle;
uVar1 = *puVar3;
*(undefined8 *)(puVar7 + -8) = 0x180026f9e;
EventSetInformation(UVar4,2,puVar3,uVar1);
}
*(undefined8 *)(puVar7 + -8) = 0x180026fb2;
FUN_180028070(*(ulonglong *)(puVar7 + 0x30) ^ (ulonglong)puVar7);
return;
}
=========================================
Function at address: 0x180026fcc
Called functions addresses: 0x180012d94 0x180028070


void FUN_180026fcc(ulonglong param_1)

{
longlong lVar1;
undefined auStack_58 [32];
uint local_38 [2];
ulonglong local_30;
undefined8 local_28;
undefined8 uStack_20;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_58;
local_38[0] = 0;
local_30 = param_1 >> 4;
lVar1 = *(longlong *)(*(longlong *)(param_1 + 0x148) + 8);
local_28 = *(undefined8 *)(lVar1 + -0x10);
uStack_20 = *(undefined8 *)(lVar1 + -8);
FUN_180012d94(local_38,(longlong)&local_28,0x10);
FUN_180012d94(local_38,(longlong)&local_30,8);
FUN_180028070(local_18 ^ (ulonglong)auStack_58);
return;
}
=========================================
Function at address: 0x180027078
Called functions addresses: 0xEXTERNAL:000000e7 0x18007b21c 0x180023150 0xEXTERNAL:000000e8 0xEXTERNAL:0000006b 0xEXTERNAL:000000eb


LPVOID FUN_180027078(char param_1)

{
bool bVar1;
HANDLE hHeap;
LPVOID pv;
PTP_TIMER p_Var2;

bVar1 = false;
hHeap = GetProcessHeap();
pv = HeapAlloc(hHeap,8,0x168);
if (pv == (LPVOID)0x0) goto LAB_18002712b;
InitializeSRWLock((PSRWLOCK)((longlong)pv + 0x108));
if (param_1 != '\0') {
if (DAT_180092de8 != 0) goto LAB_18002712b;
p_Var2 = CreateThreadpoolTimer(FUN_180023150,pv,(PTP_CALLBACK_ENVIRON)0x0);
*(PTP_TIMER *)((longlong)pv + 0x158) = p_Var2;
if (*(longlong *)((longlong)pv + 0x158) == 0) goto LAB_18002712b;
}
bVar1 = true;
LAB_18002712b:
if (!bVar1) {
FUN_18007b21c(pv);
pv = (LPVOID)0x0;
}
return pv;
}
=========================================
Function at address: 0x180027150
Called functions addresses: None


void FUN_180027150(void)

{
int iVar1;
uint uVar2;
longlong lVar3;
int *piVar4;
uint uVar5;
uint uVar6;
uint uVar7;

uVar7 = (uint)DAT_180092808;
uVar2 = 0;
uVar6 = (uint)DAT_180092804;
uVar5 = (uint)DAT_180092800;
if (((DAT_180092808 == 0) || (DAT_180092804 == 0)) || (DAT_180092800 == 0)) {
piVar4 = &DAT_18007c3b8;
lVar3 = 0xc;
do {
if (piVar4[-3] == 1) {
iVar1 = *piVar4;
if (iVar1 == 4) {
uVar7 = uVar7 & 0xffff | 1 << (uVar2 & 0x1f);
DAT_180092808 = (ushort)uVar7;
}
else if (iVar1 == 5) {
uVar6 = uVar6 & 0xffff | 1 << (uVar2 & 0x1f);
DAT_180092804 = (ushort)uVar6;
}
else if (iVar1 == 6) {
uVar5 = uVar5 & 0xffff | 1 << (uVar2 & 0x1f);
DAT_180092800 = (ushort)uVar5;
}
}
piVar4 = piVar4 + 0x12;
uVar2 = (uint)(byte)((char)uVar2 + 1);
lVar3 = lVar3 + -1;
} while (lVar3 != 0);
}
return;
}
=========================================
Function at address: 0x180027204
Called functions addresses: 0x1800272fc 0x18005df3c 0x180029f58 0x18002a7c0 0x180027298


byte FUN_180027204(void)

{
uint uVar1;
int iVar2;
uint uVar3;
byte bVar4;
undefined8 *puVar5;

uVar3 = DAT_180092f74;
iVar2 = DAT_180092f70;
bVar4 = (byte)DAT_180092f74;
uVar1 = DAT_180092f74 & 1;
if (DAT_180092dd0 != (undefined8 *)0x0) {

}
if ((uVar1 == 0) || (iVar2 == 0)) {
puVar5 = (undefined8 *)FUN_180029f58(0x50);
if (puVar5 != (undefined8 *)0x0) {
DAT_180092dd0 = FUN_1800272fc(puVar5,0x678,bVar4 & 1);
goto LAB_18002725c;
}
}
else {
DAT_180092de0 = iVar2;
puVar5 = (undefined8 *)FUN_180029f58(0x80);
if (puVar5 != (undefined8 *)0x0) {
DAT_180092dd0 = FUN_18005df3c(puVar5,0x678,iVar2);
goto LAB_18002725c;
}
}
DAT_180092dd0 = (undefined8 *)0x0;
LAB_18002725c:
if (DAT_180092dd0 == (undefined8 *)0x0) {
bVar4 = 0xe;
}
else {
bVar4 = FUN_180027298((byte)(uVar3 >> 2) & 1);
}
return bVar4;
}
=========================================
Function at address: 0x180027298
Called functions addresses: 0x1800272fc 0x180029f58 0x18002a7c0


byte FUN_180027298(undefined param_1)

{
undefined8 *puVar1;
undefined8 *puVar2;

puVar2 = (undefined8 *)0x0;
if (DAT_1800927f8 != (undefined8 *)0x0) {

}
puVar1 = (undefined8 *)FUN_180029f58(0x50);
if (puVar1 != (undefined8 *)0x0) {
puVar2 = FUN_1800272fc(puVar1,0x168,param_1);
}
DAT_1800927f8 = puVar2;
return ~-(puVar2 != (undefined8 *)0x0) & 0xe;
}
=========================================
Function at address: 0x1800272fc
Called functions addresses: 0xEXTERNAL:0000008e


undefined8 * FUN_1800272fc(undefined8 *param_1,undefined4 param_2,undefined param_3)

{
*(undefined *)(param_1 + 4) = param_3;
*param_1 = &PTR_FUN_18007d428;
*(undefined4 *)((longlong)param_1 + 0x24) = param_2;
*(undefined4 *)(param_1 + 5) = 0x14;
param_1[6] = 0x14;
param_1[7] = 0;
param_1[8] = 0;
*(undefined4 *)(param_1 + 9) = 0;
*(undefined4 *)((longlong)param_1 + 0x2c) = 0x100000;
InitializeSListHead((PSLIST_HEADER)(param_1 + 2));
*(undefined *)((longlong)param_1 + 0x21) = 5;
return param_1;
}
=========================================
Function at address: 0x180027360
Called functions addresses: 0x180041cdc 0x18002501c 0x180027498 0xEXTERNAL:000000bb 0xEXTERNAL:00000049 0xEXTERNAL:00000187 0xEXTERNAL:000000c8 0x180048860 0xEXTERNAL:000000b5


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined8 FUN_180027360(undefined8 param_1,longlong param_2,undefined8 param_3)

{
undefined8 uVar1;
int iVar2;

uVar1 = param_1;
if (DAT_180092780 == 0) {
_DAT_180092638 = 0x6c656e6e61686353;
DAT_180092620 = param_3;

FUN_180027498((ushort *)&DAT_180092e20,(ushort *)(param_2 + 0x18));
FUN_180027498((ushort *)&DAT_180092e30,(ushort *)(param_2 + 0x28));
RtlInitUnicodeString(&DAT_180092ea0,L"Schannel");
RtlInitUnicodeString(&DAT_180092e10,L"Microsoft Unified Security Protocol Provider");
DAT_180092648 = ~(*(uint *)(param_2 + 4) >> 4) & 1;
RtlInitString(&DAT_180092eb0,"Schannel");
RtlInitializeResource(&DAT_180092e40);
iVar2 = LsaIRegisterPolicyChangeNotificationCallback(FUN_180048860,4);
if (((iVar2 < 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x5c,&DAT_180085178,iVar2);
}
FUN_18002501c();
DAT_180092780 = 1;
DAT_180092628 = param_1;
uVar1 = DAT_180092630;
}
DAT_180092630 = uVar1;
return 0;
}
=========================================
Function at address: 0x180027498
Called functions addresses: 0x18000a1f4 0x18002a77b


undefined8 FUN_180027498(ushort *param_1,ushort *param_2)

{
void *_Dst;
undefined8 uVar1;

_Dst = (void *)FUN_18000a1f4((ulonglong)(*param_2 + 2));
*(void **)(param_1 + 4) = _Dst;
if (_Dst == (void *)0x0) {
uVar1 = 0xc0000017;
}
else {
*param_1 = *param_2;
param_1[1] = *param_2 + 2;
memcpy(_Dst,*(void **)(param_2 + 4),(ulonglong)*param_2);
*(undefined2 *)(*(longlong *)(param_1 + 4) + (ulonglong)(*param_1 >> 1) * 2) = 0;
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x180027520
Called functions addresses: 0xEXTERNAL:00000050 0xEXTERNAL:00000041 0xEXTERNAL:00000056 0xEXTERNAL:0000004c 0x18002763c 0xEXTERNAL:00000052 0xEXTERNAL:0000004b 0xEXTERNAL:00000054 0xEXTERNAL:000000bf


DWORD FUN_180027520(void)

{
DWORD DVar1;
HMODULE hLibModule;
DWORD local_res8 [2];
HKEY local_res10;

DVar1 = RegCreateKeyExW((HKEY)0xffffffff80000002,
L"System\\CurrentControlSet\\Services\\EventLog\\System\\Schannel",0,L"",0
,0x20006,(LPSECURITY_ATTRIBUTES)0x0,&local_res10,local_res8);
if (DVar1 == 0) {
if (local_res8[0] == 1) {
RegSetValueExW(local_res10,L"EventMessageFile",0,2,
(BYTE *)L"%SystemRoot%\\system32\\lsasrv.dll",0x42);
local_res8[0] = 7;
RegSetValueExW(local_res10,L"TypesSupported",0,4,(BYTE *)local_res8,4);
RegFlushKey(local_res10);
}
RegCloseKey(local_res10);
hLibModule = LoadLibraryExW(L"lsasrv.dll",(HANDLE)0x0,0);
if (hLibModule == (HMODULE)0x0) {
DVar1 = GetLastError();
}
else {
FUN_18002763c(hLibModule,0x80009080,(LPWSTR)&DAT_180092df8);
FUN_18002763c(hLibModule,0x80009081,(LPWSTR)&DAT_180092df0);
FreeLibrary(hLibModule);
DVar1 = EtwEventRegister(&DAT_180082688,0,0,&DAT_180092d80);
if (DVar1 != 0) {
DAT_180092d80 = 0;
}
}
}
return DVar1;
}
=========================================
Function at address: 0x18002763c
Called functions addresses: 0xEXTERNAL:00000059


undefined8 FUN_18002763c(LPCVOID param_1,DWORD param_2,LPWSTR param_3)

{
DWORD DVar1;
undefined8 uVar2;

param_3[0] = L'\0';
param_3[1] = L'\0';
param_3[2] = L'\0';
param_3[3] = L'\0';
DVar1 = FormatMessageW(0x900,param_1,param_2,0,param_3,0,(va_list *)0x0);
if ((DVar1 == 0) || (*(longlong *)param_3 == 0)) {
uVar2 = 0x714;
}
else {
*(undefined2 *)(*(longlong *)param_3 + (ulonglong)(DVar1 - 2) * 2) = 0;
uVar2 = 0;
}
return uVar2;
}
=========================================
Function at address: 0x1800276a4
Called functions addresses: 0xEXTERNAL:000000b9 0xEXTERNAL:000000ba 0xEXTERNAL:000000b8 0xEXTERNAL:000000bb 0xEXTERNAL:000000cd 0xEXTERNAL:0000015c 0xEXTERNAL:0000003f 0xEXTERNAL:000000b7 0x180028070 0xEXTERNAL:0000015f 0xEXTERNAL:000000c7


void FUN_1800276a4(void)

{
char cVar1;
NTSTATUS NVar2;
uint uVar3;
undefined4 *puVar4;
undefined auStack_a8 [32];
int local_88;
ULONG local_84;
_LSA_STRING local_80;
undefined4 local_70;
undefined2 local_6c;
undefined local_68 [80];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_a8;
if ((DAT_180092e08 != (HANDLE)0x0) ||
(NVar2 = LsaRegisterLogonProcess((PLSA_STRING)&DAT_180092eb0,&DAT_180092e08,&local_84),
-1 < NVar2)) {
RtlInitString(&local_80,"Kerberos");
NVar2 = LsaLookupAuthenticationPackage(DAT_180092e08,&local_80,&DAT_180092e04);
if (-1 < NVar2) {
RtlInitString(&local_80,"MICROSOFT_AUTHENTICATION_PACKAGE_V1_0");
NVar2 = LsaLookupAuthenticationPackage(DAT_180092e08,&local_80,&DAT_180092e00);
if (-1 < NVar2) {
if (DAT_180092610 == (undefined4 *)0x0) {
local_70 = 0;
local_6c = 0x500;
RtlInitializeSid(local_68,&local_70,2);
puVar4 = (undefined4 *)RtlSubAuthoritySid(local_68,0);
*puVar4 = 0x40;
puVar4 = (undefined4 *)RtlSubAuthoritySid(local_68,1);
*puVar4 = 0xe;
uVar3 = RtlLengthSid(local_68);
puVar4 = (undefined4 *)LocalAlloc(0x40,(ulonglong)uVar3 + 0x18);
DAT_180092610 = puVar4;
if (puVar4 == (undefined4 *)0x0) goto LAB_180027861;
*puVar4 = 1;
*(undefined4 **)(puVar4 + 2) = puVar4 + 6;
puVar4[4] = 7;
RtlCopySid(uVar3,puVar4 + 6,local_68);
}
DAT_180092784 = 1;
cVar1 = RtlGetNtProductType(&local_88);
if (cVar1 == '\0') {
DAT_1800919a0 = 1;
}
else {
DAT_1800919a0 = (uint)(local_88 == 2);
}
goto LAB_180027861;
}
}
}
RtlNtStatusToDosError(NVar2);
LAB_180027861:
FUN_180028070(local_18 ^ (ulonglong)auStack_a8);
return;
}
=========================================
Function at address: 0x180027890
Called functions addresses: 0xEXTERNAL:00000140 0xEXTERNAL:00000066 0xEXTERNAL:000000aa 0xEXTERNAL:00000128 0xEXTERNAL:00000179


ulonglong FUN_180027890(longlong param_1)

{
longlong lVar1;
BOOL BVar2;
ulonglong uVar3;
HANDLE pvVar4;
HCERTSTORE pvVar5;
undefined4 extraout_var;

uVar3 = RtlInitializeCriticalSection(param_1 + 8);
if ((int)uVar3 < 0) {
uVar3 = uVar3 & 0xffffffffffffff00;
}
else {
lVar1 = param_1 + 0x30;
*(longlong *)(param_1 + 0x38) = lVar1;
*(longlong *)lVar1 = lVar1;
pvVar4 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0);
*(HANDLE *)(param_1 + 0x40) = pvVar4;
if (pvVar4 != (HANDLE)0x0) {
RegisterGPNotification(pvVar4,1);
}
pvVar5 = CertOpenStore((LPCSTR)0xa,1,0,0x20020000,&DAT_18008275c);
*(HCERTSTORE *)(param_1 + 0x48) = pvVar5;
if (pvVar5 != (HCERTSTORE)0x0) {
pvVar5 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0);
*(undefined8 *)(param_1 + 0x50) = pvVar5;
if (pvVar5 != (HANDLE)0x0) {
BVar2 = CertControlStore(*(HCERTSTORE *)(param_1 + 0x48),0,2,(undefined8 *)(param_1 + 0x50))
;
pvVar5 = (HCERTSTORE)CONCAT44(extraout_var,BVar2);
}
}
uVar3 = CONCAT71((int7)((ulonglong)pvVar5 >> 8),1);
}
return uVar3;
}
=========================================
Function at address: 0x18002796c
Called functions addresses: 0x18000a1f4


undefined8 * FUN_18002796c(void)

{
undefined4 uVar1;

if (DAT_1800927f0 == (undefined8 *)0x0) {
DAT_1800927f0 = (undefined8 *)FUN_18000a1f4(0x68);
if (DAT_1800927f0 == (undefined8 *)0x0) {
DAT_1800927f0 = (undefined8 *)0x0;
}
else {
DAT_1800927f0[1] = 0;
*DAT_1800927f0 = &PTR_FUN_18007d450;
*(undefined4 *)(DAT_1800927f0 + 2) = 20000;
*(undefined4 *)((longlong)DAT_1800927f0 + 0x14) = DAT_1800919d0;
*(undefined4 *)(DAT_1800927f0 + 3) = DAT_1800919cc;
uVar1 = DAT_1800919c0;
DAT_1800927f0[5] = 0;
*(undefined4 *)((longlong)DAT_1800927f0 + 0x1c) = uVar1;
*(undefined4 *)((longlong)DAT_1800927f0 + 0x34) = 1000;
}
}
return DAT_1800927f0;
}
=========================================
Function at address: 0x1800279e8
Called functions addresses: 0xEXTERNAL:00000041 0x180055070 0x180017090 0xEXTERNAL:00000066 0xEXTERNAL:0000009e


DWORD FUN_1800279e8(void)

{
int iVar1;
uint uVar2;
DWORD DVar3;

LOCK();
iVar1 = DAT_180092ee0 + 1;
UNLOCK();
uVar2 = DAT_180092ee0 + 1;
DVar3 = 0;
DAT_180092ee0 = iVar1;
if ((uVar2 < 2) &&
(((DAT_1800927e0 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0),
DAT_1800927e0 == (HANDLE)0x0 ||
(DAT_1800927d8 =
RegisterWaitForSingleObjectEx
(DAT_1800927e0,FUN_180017090,(PVOID)0x0,DAT_1800919b8 * 1000,0), DVar3 = 0,
DAT_1800927d8 == (HANDLE)0x0)) && (DVar3 = GetLastError(), DVar3 != 0)))) {
FUN_180055070();
}
LOCK();
DAT_180092ee0 = DAT_180092ee0 + -1;
UNLOCK();
return DVar3;
}
=========================================
Function at address: 0x180027a84
Called functions addresses: 0xEXTERNAL:00000041 0x180041cdc 0xEXTERNAL:00000066 0x180054fc4


DWORD FUN_180027a84(void)

{
DWORD DVar1;
undefined2 uVar2;

DAT_1800927d0 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0);
if (DAT_1800927d0 == (HANDLE)0x0) {
DVar1 = GetLastError();
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180040ced;
uVar2 = 0xb;
}
else {
DAT_1800927c8 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0);
if (DAT_1800927c8 != (HANDLE)0x0) {
return 0;
}
DVar1 = GetLastError();
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180040ced;
uVar2 = 0xc;
}
FUN_180041cdc(DAT_180091000[2],uVar2,&DAT_180085528,DVar1);
LAB_180040ced:
if (DVar1 != 0) {
FUN_180054fc4();
}
return DVar1;
}
=========================================
Function at address: 0x180027af0
Called functions addresses: 0x18002a7c0 0x180027b44 0x180023188


void FUN_180027af0(undefined8 param_1,ulonglong param_2,undefined8 param_3,undefined8 param_4,
undefined8 param_5,undefined8 param_6,longlong param_7)

{
ulonglong uVar1;
ulonglong uVar2;

uVar2 = param_2 & 0xffffffff;
uVar1 = param_2;
if (*(longlong *)(param_7 + 0x138) != 0) {

uVar1 = uVar2;
}
if ((int)param_2 == 1) {
FUN_180027b44(param_7,uVar1,param_3,param_4);
}
else if ((int)param_2 == 2) {
FUN_180023188(param_7);
}
return;
}
=========================================
Function at address: 0x180027b44
Called functions addresses: 0x18007b0bc 0x1800233b8 0x180023204 0x180028070


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180027b44(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
longlong lVar1;
longlong lVar2;
uint uVar3;
ulonglong uVar4;
undefined auStackY_f8 [32];
undefined4 local_88;
undefined4 local_84;
undefined4 local_80;
undefined4 local_7c;
undefined4 local_78 [2];
longlong local_70;
ulonglong local_68;
undefined8 local_60;
undefined8 *local_58 [5];
undefined8 local_30;
undefined8 local_28;
undefined8 uStack_20;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_f8;
uVar4 = 0;
if (*(uint *)(param_1 + 0x100) != 0) {
lVar2 = param_1;
FUN_1800233b8(param_1,*(uint *)(param_1 + 0x100));
if (*(longlong *)(lVar2 + 0x110) != 0) {
if (((5 < DAT_180091870) && ((_DAT_180091880 & 0x200000000000) != 0)) &&
((DAT_180091888 & 0x200000000000) == DAT_180091888)) {
lVar1 = *(longlong *)(*(longlong *)(lVar2 + 0x148) + 8);
local_88 = *(undefined4 *)(param_1 + 0x134);
local_28 = *(undefined8 *)(lVar1 + -0x10);
uStack_20 = *(undefined8 *)(lVar1 + -8);
local_84 = *(undefined4 *)(param_1 + 0x130);
local_80 = *(undefined4 *)(param_1 + 300);
local_7c = *(undefined4 *)(param_1 + 0x128);
local_78[0] = *(undefined4 *)(param_1 + 0x124);
local_68 = (ulonglong)*(uint *)(param_1 + 0x120);
local_60 = *(undefined8 *)(param_1 + 0x118);
local_58[0] = &local_28;
local_70 = *(longlong *)(lVar2 + 0x110);
FUN_18007b0bc(lVar1,&DAT_1800849d8,0x200000000000,param_4,local_58,&local_60,&local_68,
&local_70,local_78,&local_7c,&local_80,&local_84,&local_88);
}
*(undefined8 *)(param_1 + 0x110) = 0;
*(undefined8 *)(param_1 + 0x118) = 0;
local_30 = 0;
*(undefined8 *)(param_1 + 0x120) = 0;
*(undefined8 *)(param_1 + 0x128) = 0;
*(undefined8 *)(param_1 + 0x130) = 0;
}
do {
FUN_180023204(param_1,uVar4);
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
} while (uVar3 < 0x20);
}
FUN_180028070(local_18 ^ (ulonglong)auStackY_f8);
return;
}
=========================================
Function at address: 0x180027bb0
Called functions addresses: None


undefined8
SpLsaModeInitialize(undefined8 param_1,undefined4 *param_2,undefined8 *param_3,undefined4 *param_4)

{
/* 0x27bb0  1  SpLsaModeInitialize */
*param_2 = 0x40000;
*param_3 = &DAT_1800915c0;
*param_4 = 2;
return 0;
}
=========================================
Function at address: 0x180027bd4
Called functions addresses: None


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined * FUN_180027bd4(void)

{
_DAT_180092da0 = &PTR_FUN_18007d3e8;
_DAT_180092da8 = 0;
_DAT_180092db0 = 0;
_DAT_180092db8 = 0;
_DAT_180092dc0 = 0;
_DAT_180092dc8 = 0;
DAT_180092de0 = 0;
DAT_180092de4 = 0;
DAT_180092dd0 = 0;
DAT_180092dd8 = 0;
return &DAT_180092da0;
}
=========================================
Function at address: 0x180027c30
Called functions addresses: 0x180027c54 0x180027c64


undefined8 FUN_180027c30(void)

{
ulonglong *puVar1;

puVar1 = (ulonglong *)FUN_180027c54();
*puVar1 = *puVar1 | 4;
puVar1 = (ulonglong *)FUN_180027c64();
*puVar1 = *puVar1 | 2;
return 0;
}
=========================================
Function at address: 0x180027c54
Called functions addresses: None


undefined * FUN_180027c54(void)

{
return &DAT_180091a20;
}
=========================================
Function at address: 0x180027c64
Called functions addresses: None


undefined * FUN_180027c64(void)

{
return &DAT_180091a28;
}
=========================================
Function at address: 0x180027c80
Called functions addresses: 0x180027c54 0x180027c64


undefined8 FUN_180027c80(void)

{
ulonglong *puVar1;

puVar1 = (ulonglong *)FUN_180027c54();
*puVar1 = *puVar1 | 0x18;
puVar1 = (ulonglong *)FUN_180027c64();
*puVar1 = *puVar1 | 4;
return 0;
}
=========================================
Function at address: 0x180027cb0
Called functions addresses: 0x180028470 0x1800284b0 0x180028508 0x1800285c4 0x180028878 0x180028c56 0x18002a7c0 0x1800289cc 0x1800284ec 0x1800286fc 0x180028438 0x180028c62 0x180028618 0x180028a18 0x180028538 0x18002879c 0x18002844c 0x180028858 0x180028424 0x1800285fc 0x1800287c8


ulonglong FUN_180027cb0(undefined8 param_1,int param_2,longlong param_3)

{
code *pcVar1;
bool bVar2;
byte bVar3;
bool bVar4;
char cVar5;
int iVar6;
uint uVar7;
undefined8 uVar8;
undefined8 uVar9;
longlong *plVar10;
ulonglong uVar11;
undefined7 uVar12;

if (param_2 == 0) {
uVar12 = (undefined7)((ulonglong)param_1 >> 8);
if (DAT_180091a30 < 1) {
uVar7 = 0;
}
else {
DAT_180091a30 = DAT_180091a30 + -1;
uVar8 = __scrt_acquire_startup_lock();
if (DAT_180091fc0 != 2) {
FUN_180028878(7);
pcVar1 = (code *)swi(3);
uVar11 = (*pcVar1)();
return uVar11;
}
__scrt_dllmain_uninitialize_c();
FUN_180028438();
FUN_180028a18();
DAT_180091fc0 = 0;
__scrt_release_startup_lock((char)uVar8);
cVar5 = __scrt_uninitialize_crt(CONCAT71(uVar12,param_3 != 0),'\0');
uVar7 = -(uint)(cVar5 != '\0') & 1;
FUN_1800285fc();
}
return (ulonglong)uVar7;
}
if (param_2 != 1) {
if (param_2 == 2) {
bVar3 = FUN_180028508();
}
else {
if (param_2 != 3) {
return 1;
}
bVar3 = FUN_180028538();
}
return (ulonglong)bVar3;
}
uVar8 = __scrt_initialize_crt(0);
if ((char)uVar8 != '\0') {
uVar8 = __scrt_acquire_startup_lock();
bVar2 = true;
if (DAT_180091fc0 != 0) {
FUN_180028878(7);
pcVar1 = (code *)swi(3);
uVar11 = (*pcVar1)();
return uVar11;
}
DAT_180091fc0 = 1;
bVar4 = __scrt_dllmain_before_initialize_c();
if (bVar4) {
FUN_1800289cc();
FUN_180028424();
FUN_18002844c();
iVar6 = _initterm_e(&DAT_180081008,&DAT_180081028);
if ((iVar6 == 0) && (uVar9 = __scrt_dllmain_after_initialize_c(), (char)uVar9 != '\0')) {
_initterm(&DAT_180080fe8,&DAT_180081000);
DAT_180091fc0 = 2;
bVar2 = false;
}
}
__scrt_release_startup_lock((char)uVar8);
if (!bVar2) {
plVar10 = (longlong *)FUN_180028858();
if ((*plVar10 != 0) &&
(uVar11 = __scrt_is_nonwritable_in_current_image((longlong)plVar10), (char)uVar11 != '\0'))
{

}
DAT_180091a30 = DAT_180091a30 + 1;
return 1;
}
}
return 0;
}
=========================================
Function at address: 0x180027ebc
Called functions addresses: 0x18002a428 0x180027cb0 0x18002a7c0


ulonglong FUN_180027ebc(HMODULE param_1,int param_2,longlong param_3)

{
uint uVar1;
ulonglong uVar2;
ulonglong uVar3;

if ((param_2 == 0) && (DAT_180091a30 < 1)) {
uVar2 = 0;
}
else {
if (param_2 - 1U < 2) {
if (DAT_180082768 != 0) {

if (uVar1 == 0) {
return (ulonglong)uVar1;
}
}
uVar3 = FUN_180027cb0(param_1,param_2,param_3);
if ((int)uVar3 == 0) {
return uVar3 & 0xffffffff;
}
}
uVar3 = FUN_18002a428(param_1,param_2);
uVar2 = uVar3 & 0xffffffff;
if ((param_2 == 1) && ((int)uVar3 == 0)) {
FUN_18002a428(param_1,0);
FUN_180027cb0(param_1,0,param_3);
if (DAT_180082768 != 0) {

}
}
if ((param_2 == 0) || (param_2 == 3)) {
uVar3 = FUN_180027cb0(param_1,param_2,param_3);
uVar2 = uVar3 & 0xffffffff;
if ((int)uVar3 != 0) {
if (DAT_180082768 == 0) {
uVar2 = 1;
}
else {

uVar2 = (ulonglong)uVar1;
}
}
}
}
return uVar2;
}
=========================================
Function at address: 0x180028020
Called functions addresses: 0x180028370 0x180027ebc


void entry(HMODULE param_1,int param_2,longlong param_3)

{
if (param_2 == 1) {
__security_init_cookie();
}
FUN_180027ebc(param_1,param_2,param_3);
return;
}
=========================================
Function at address: 0x180028070
Called functions addresses: 0x1800280e0


void FUN_180028070(longlong param_1)

{
if ((param_1 == DAT_180091970) && ((short)((ulonglong)param_1 >> 0x30) == 0)) {
return;
}
FUN_1800280e0();
return;
}
=========================================
Function at address: 0x180028098
Called functions addresses: 0xEXTERNAL:0000007f 0xEXTERNAL:00000043 0xEXTERNAL:00000042


/* Library Function - Single Match
__raise_securityfailure

Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

void __raise_securityfailure(_EXCEPTION_POINTERS *param_1)

{
HANDLE pvVar1;

SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
UnhandledExceptionFilter(param_1);
pvVar1 = GetCurrentProcess();
/* WARNING: Could not recover jumptable at 0x0001800280c5. Too many branches */

TerminateProcess(pvVar1,0xc0000409);
return;
}
=========================================
Function at address: 0x1800280e0
Called functions addresses: 0x180028098 0xEXTERNAL:00000081 0x1800282ec


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_1800280e0(void)

{
code *pcVar1;
BOOL BVar2;
undefined *puVar3;
undefined auStack_38 [8];
undefined auStack_30 [48];

puVar3 = auStack_38;
BVar2 = IsProcessorFeaturePresent(0x17);
if (BVar2 != 0) {
pcVar1 = (code *)swi(0x29);
(*pcVar1)(2);
puVar3 = auStack_30;
}
*(undefined8 *)(puVar3 + -8) = 0x18002810b;
capture_previous_context((PCONTEXT)&DAT_180091ae0);
_DAT_180091a50 = *(undefined8 *)(puVar3 + 0x38);
_DAT_180091b78 = puVar3 + 0x40;
_DAT_180091b60 = *(undefined8 *)(puVar3 + 0x40);
_DAT_180091a40 = 0xc0000409;
_DAT_180091a44 = 1;
_DAT_180091a58 = 1;
DAT_180091a60 = 2;
*(undefined8 *)(puVar3 + 0x20) = DAT_180091970;
*(undefined8 *)(puVar3 + 0x28) = DAT_180091978;
*(undefined8 *)(puVar3 + -8) = 0x1800281ad;
DAT_180091bd8 = _DAT_180091a50;
__raise_securityfailure((_EXCEPTION_POINTERS *)&PTR_DAT_18007d4a0);
return;
}
=========================================
Function at address: 0x1800281b8
Called functions addresses: 0x1800281d4


void FUN_1800281b8(void)

{
FUN_1800281d4(8);
return;
}
=========================================
Function at address: 0x1800281d4
Called functions addresses: 0x180028278 0x180028098 0xEXTERNAL:00000081


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_1800281d4(undefined4 param_1)

{
code *pcVar1;
BOOL BVar2;
undefined *puVar3;
undefined auStack_28 [8];
undefined auStack_20 [32];

puVar3 = auStack_28;
BVar2 = IsProcessorFeaturePresent(0x17);
if (BVar2 != 0) {
pcVar1 = (code *)swi(0x29);
(*pcVar1)(param_1);
puVar3 = auStack_20;
}
*(undefined8 *)(puVar3 + -8) = 0x1800281ff;
capture_current_context((PCONTEXT)&DAT_180091ae0);
_DAT_180091a50 = *(undefined8 *)(puVar3 + 0x28);
_DAT_180091b78 = puVar3 + 0x30;
_DAT_180091a40 = 0xc0000409;
_DAT_180091a44 = 1;
_DAT_180091a58 = 1;
DAT_180091a60 = (ulonglong)*(uint *)(puVar3 + 0x30);
*(undefined8 *)(puVar3 + -8) = 0x18002826b;
DAT_180091bd8 = _DAT_180091a50;
__raise_securityfailure((_EXCEPTION_POINTERS *)&PTR_DAT_18007d4a0);
return;
}
=========================================
Function at address: 0x180028278
Called functions addresses: 0xEXTERNAL:00000078 0xEXTERNAL:00000077 0xEXTERNAL:00000076


/* Library Function - Single Match
capture_current_context

Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

void capture_current_context(PCONTEXT param_1)

{
DWORD64 ControlPc;
PRUNTIME_FUNCTION FunctionEntry;
DWORD64 local_res8;
ulonglong local_res10;
PVOID local_res18;

RtlCaptureContext();
ControlPc = param_1->Rip;
FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,&local_res18,&local_res10,
(PKNONVOLATILE_CONTEXT_POINTERS)0x0);
}
return;
}
=========================================
Function at address: 0x1800282ec
Called functions addresses: 0xEXTERNAL:00000078 0xEXTERNAL:00000077 0xEXTERNAL:00000076


/* Library Function - Single Match
capture_previous_context

Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

void capture_previous_context(PCONTEXT param_1)

{
DWORD64 ControlPc;
PRUNTIME_FUNCTION FunctionEntry;
int iVar1;
DWORD64 local_res8;
ulonglong local_res10;
PVOID local_res18 [2];

RtlCaptureContext();
ControlPc = param_1->Rip;
iVar1 = 0;
do {
FunctionEntry = RtlLookupFunctionEntry(ControlPc,&local_res8,(PUNWIND_HISTORY_TABLE)0x0);
if (FunctionEntry == (PRUNTIME_FUNCTION)0x0) {
return;
}
RtlVirtualUnwind(0,local_res8,ControlPc,FunctionEntry,param_1,local_res18,&local_res10,
(PKNONVOLATILE_CONTEXT_POINTERS)0x0);
iVar1 = iVar1 + 1;
} while (iVar1 < 2);
return;
}
=========================================
Function at address: 0x180028364
Called functions addresses: 0x180028a7c


void _o_free(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d54. Too many branches */

_o_free();
return;
}
=========================================
Function at address: 0x180028370
Called functions addresses: 0xEXTERNAL:0000007a 0xEXTERNAL:00000089 0xEXTERNAL:00000083 0xEXTERNAL:0000007d


/* Library Function - Single Match
__security_init_cookie

Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release */

void __cdecl __security_init_cookie(void)

{
DWORD DVar1;
_FILETIME local_res8;
_FILETIME local_res10;
LARGE_INTEGER local_res18;

if (DAT_180091970 == 0x2b992ddfa232) {
local_res10.dwLowDateTime = 0;
local_res10.dwHighDateTime = 0;
GetSystemTimeAsFileTime(&local_res10);
local_res8 = local_res10;
DVar1 = GetCurrentThreadId();
local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
DVar1 = GetCurrentProcessId();
local_res8 = (_FILETIME)((ulonglong)local_res8 ^ (ulonglong)DVar1);
QueryPerformanceCounter(&local_res18);
DAT_180091970 =
((ulonglong)local_res18.s.LowPart << 0x20 ^
CONCAT44(local_res18.s.HighPart,local_res18.s.LowPart) ^ (ulonglong)local_res8 ^
(ulonglong)&local_res8) & 0xffffffffffff;
if (DAT_180091970 == 0x2b992ddfa232) {
DAT_180091970 = 0x2b992ddfa233;
}
}
DAT_180091978 = ~DAT_180091970;
return;
}
=========================================
Function at address: 0x180028424
Called functions addresses: 0xEXTERNAL:0000008e


void FUN_180028424(void)

{
/* WARNING: Could not recover jumptable at 0x00018002842b. Too many branches */

InitializeSListHead((PSLIST_HEADER)&DAT_180091fb0);
return;
}
=========================================
Function at address: 0x180028438
Called functions addresses: 0x180028c7a


void FUN_180028438(void)

{
_o___std_type_info_destroy_list(&DAT_180091fb0);
return;
}
=========================================
Function at address: 0x18002844c
Called functions addresses: 0x180027c54 0x180027c64


void FUN_18002844c(void)

{
ulonglong *puVar1;

puVar1 = (ulonglong *)FUN_180027c54();
*puVar1 = *puVar1 | 0x24;
puVar1 = (ulonglong *)FUN_180027c64();
*puVar1 = *puVar1 | 2;
return;
}
=========================================
Function at address: 0x180028470
Called functions addresses: 0x180028c3c


/* Library Function - Single Match
__scrt_acquire_startup_lock

Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

ulonglong __scrt_acquire_startup_lock(void)

{
ulonglong uVar1;
bool bVar2;
undefined7 extraout_var;
ulonglong uVar3;

bVar2 = __scrt_is_ucrt_dll_in_use();
uVar3 = CONCAT71(extraout_var,bVar2);
if ((int)uVar3 == 0) {
LAB_18002849e:
uVar3 = uVar3 & 0xffffffffffffff00;
}
else {
do {
uVar3 = 0;
LOCK();
bVar2 = DAT_180091fc8 == 0;
uVar1 = *(ulonglong *)((longlong)Self + 8);
if (!bVar2) {
uVar3 = DAT_180091fc8;
uVar1 = DAT_180091fc8;
}
DAT_180091fc8 = uVar1;
UNLOCK();
if (bVar2) goto LAB_18002849e;
} while (*(ulonglong *)((longlong)Self + 8) != uVar3);
uVar3 = CONCAT71((int7)(uVar3 >> 8),1);
}
return uVar3;
}
=========================================
Function at address: 0x1800284b0
Called functions addresses: 0x180028a88 0x180028cb6 0x180028c3c 0x180028c30 0x180028cda


/* Library Function - Single Match
__scrt_dllmain_after_initialize_c

Library: Visual Studio 2019 Release */

undefined8 __scrt_dllmain_after_initialize_c(void)

{
bool bVar1;
undefined7 extraout_var;
undefined8 uVar2;
ulonglong uVar3;

bVar1 = __scrt_is_ucrt_dll_in_use();
if ((int)CONCAT71(extraout_var,bVar1) == 0) {
uVar3 = FUN_180028c30();
uVar3 = _o__configure_narrow_argv(uVar3 & 0xffffffff);
if ((int)uVar3 != 0) {
return uVar3 & 0xffffffffffffff00;
}
uVar2 = _o__initialize_narrow_environment();
}
else {
uVar2 = __isa_available_init();
}
return CONCAT71((int7)((ulonglong)uVar2 >> 8),1);
}
=========================================
Function at address: 0x1800284ec
Called functions addresses: 0x180028668


/* Library Function - Single Match
__scrt_dllmain_before_initialize_c

Library: Visual Studio 2019 Release */

bool __scrt_dllmain_before_initialize_c(void)

{
undefined8 uVar1;

uVar1 = __scrt_initialize_onexit_tables(0);
return (char)uVar1 != '\0';
}
=========================================
Function at address: 0x180028508
Called functions addresses: 0x18002a3ec


undefined FUN_180028508(void)

{
char cVar1;

cVar1 = FUN_18002a3ec();
if (cVar1 != '\0') {
cVar1 = FUN_18002a3ec();
if (cVar1 != '\0') {
return 1;
}
FUN_18002a3ec();
}
return 0;
}
=========================================
Function at address: 0x180028538
Called functions addresses: 0x18002a3ec


undefined FUN_180028538(void)

{
FUN_18002a3ec();
FUN_18002a3ec();
return 1;
}
=========================================
Function at address: 0x180028554
Called functions addresses: 0x180028d18 0x18002a7c0 0x180028c3c


void FUN_180028554(undefined8 param_1,int param_2,undefined8 param_3,undefined *param_4,
undefined4 param_5,undefined8 param_6)

{
bool bVar1;
undefined7 extraout_var;

bVar1 = __scrt_is_ucrt_dll_in_use();
if (((int)CONCAT71(extraout_var,bVar1) == 0) && (param_2 == 1)) {

}
_o__seh_filter_dll(param_5,param_6);
return;
}
=========================================
Function at address: 0x1800285c4
Called functions addresses: 0x180028caa 0x18002a404 0x180028c3c 0x180028cce


/* Library Function - Single Match
__scrt_dllmain_uninitialize_c

Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

void __scrt_dllmain_uninitialize_c(void)

{
bool bVar1;
undefined7 extraout_var;
undefined8 uVar2;

bVar1 = __scrt_is_ucrt_dll_in_use();
if ((int)CONCAT71(extraout_var,bVar1) != 0) {
_o__execute_onexit_table(&DAT_180091fd0);
return;
}
uVar2 = FUN_18002a404();
if ((int)uVar2 == 0) {
_o__cexit();
}
return;
}
=========================================
Function at address: 0x1800285fc
Called functions addresses: 0x18002a3f8


void FUN_1800285fc(void)

{
FUN_18002a3f8();
FUN_18002a3f8();
return;
}
=========================================
Function at address: 0x180028618
Called functions addresses: 0x180028a88 0x18002a3f8 0x18002a3ec


/* Library Function - Single Match
__scrt_initialize_crt

Library: Visual Studio 2019 Release */

ulonglong __scrt_initialize_crt(int param_1)

{
ulonglong uVar1;
undefined8 uVar2;

if (param_1 == 0) {
DAT_180092001 = 1;
}
__isa_available_init();
uVar1 = FUN_18002a3ec();
if ((char)uVar1 != '\0') {
uVar2 = FUN_18002a3ec();
if ((char)uVar2 != '\0') {
return CONCAT71((int7)((ulonglong)uVar2 >> 8),1);
}
uVar1 = FUN_18002a3f8();
}
return uVar1 & 0xffffffffffffff00;
}
=========================================
Function at address: 0x180028668
Called functions addresses: 0x180028ce6 0x180028878 0x180028c3c


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* Library Function - Single Match
__scrt_initialize_onexit_tables

Library: Visual Studio 2019 Release */

undefined8 __scrt_initialize_onexit_tables(uint param_1)

{
code *pcVar1;
bool bVar2;
ulonglong in_RAX;
undefined7 extraout_var;
undefined8 uVar3;

if (DAT_180092000 == '\0') {
if (1 < param_1) {
FUN_180028878(5);
pcVar1 = (code *)swi(3);
uVar3 = (*pcVar1)();
return uVar3;
}
bVar2 = __scrt_is_ucrt_dll_in_use();
if (((int)CONCAT71(extraout_var,bVar2) == 0) || (param_1 != 0)) {
in_RAX = 0xffffffffffffffff;
DAT_180091fd0 = _DAT_180082770;
uRam0000000180091fd8 = _UNK_180082778;
_DAT_180091fe0 = 0xffffffffffffffff;
_DAT_180091fe8 = _DAT_180082770;
uRam0000000180091ff0 = _UNK_180082778;
_DAT_180091ff8 = 0xffffffffffffffff;
}
else {
in_RAX = _o__initialize_onexit_table(&DAT_180091fd0);
if (((int)in_RAX != 0) ||
(in_RAX = _o__initialize_onexit_table(&DAT_180091fe8), (int)in_RAX != 0)) {
return in_RAX & 0xffffffffffffff00;
}
}
DAT_180092000 = '\x01';
}
return CONCAT71((int7)(in_RAX >> 8),1);
}
=========================================
Function at address: 0x1800286fc
Called functions addresses: None


/* Library Function - Single Match
__scrt_is_nonwritable_in_current_image

Library: Visual Studio 2019 Release */

ulonglong __scrt_is_nonwritable_in_current_image(longlong param_1)

{
ulonglong uVar1;
uint7 uVar2;
longlong lVar3;
longlong lVar4;

uVar1 = 0x5a4d;
if (((IMAGE_DOS_HEADER_180000000.e_magic == (char  [2])0x5a4d) &&
(lVar3 = (longlong)(int)IMAGE_DOS_HEADER_180000000.e_lfanew,
*(int *)(lVar3 + 0x180000000) == 0x4550)) &&
(uVar1 = 0x20b, *(short *)((longlong)IMAGE_DOS_HEADER_180000000.e_res_4_ + lVar3 + -4) == 0x20b
)) {
lVar4 = lVar3 + 0x180000018 +
(ulonglong)*(ushort *)((longlong)IMAGE_DOS_HEADER_180000000.e_res_4_ + lVar3 + -8);
uVar1 = (ulonglong)*(ushort *)(IMAGE_DOS_HEADER_180000000.e_magic + lVar3 + 6);
lVar3 = lVar4 + uVar1 * 0x28;
for (; lVar4 != lVar3; lVar4 = lVar4 + 0x28) {
if (((ulonglong)*(uint *)(lVar4 + 0xc) <= param_1 - 0x180000000U) &&
(uVar1 = (ulonglong)(*(int *)(lVar4 + 8) + *(uint *)(lVar4 + 0xc)),
param_1 - 0x180000000U < uVar1)) goto LAB_180028772;
}
lVar4 = 0;
LAB_180028772:
if (lVar4 == 0) {
uVar1 = uVar1 & 0xffffffffffffff00;
}
else {
uVar2 = (uint7)(uVar1 >> 8);
if (*(int *)(lVar4 + 0x24) < 0) {
uVar1 = (ulonglong)uVar2 << 8;
}
else {
uVar1 = CONCAT71(uVar2,1);
}
}
}
else {
uVar1 = uVar1 & 0xffffffffffffff00;
}
return uVar1;
}
=========================================
Function at address: 0x18002879c
Called functions addresses: 0x180028c3c


/* Library Function - Single Match
__scrt_release_startup_lock

Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

void __scrt_release_startup_lock(char param_1)

{
bool bVar1;
undefined3 extraout_var;

bVar1 = __scrt_is_ucrt_dll_in_use();
if ((CONCAT31(extraout_var,bVar1) != 0) && (param_1 == '\0')) {
LOCK();
DAT_180091fc8 = 0;
UNLOCK();
}
return;
}
=========================================
Function at address: 0x1800287c8
Called functions addresses: 0x18002a3f8


/* Library Function - Single Match
__scrt_uninitialize_crt

Library: Visual Studio 2019 Release */

undefined __scrt_uninitialize_crt(undefined8 param_1,char param_2)

{
if ((DAT_180092001 == '\0') || (param_2 == '\0')) {
FUN_18002a3f8();
FUN_18002a3f8();
}
return 1;
}
=========================================
Function at address: 0x1800287f8
Called functions addresses: 0x180028d0c 0x180028cc2


/* Library Function - Single Match
_onexit

Library: Visual Studio 2019 Release */

_onexit_t __cdecl _onexit(_onexit_t _Func)

{
int iVar1;
_onexit_t p_Var2;

if (DAT_180091fd0 == -1) {
iVar1 = _o__crt_atexit();
}
else {
iVar1 = _o__register_onexit_function(&DAT_180091fd0);
}
p_Var2 = (_onexit_t)0x0;
if (iVar1 == 0) {
p_Var2 = _Func;
}
return p_Var2;
}
=========================================
Function at address: 0x180028838
Called functions addresses: 0x1800287f8


/* Library Function - Single Match
atexit

Library: Visual Studio 2019 Release */

int __cdecl atexit(_func_5014 *param_1)

{
_onexit_t p_Var1;

p_Var1 = _onexit((_onexit_t)param_1);
return (p_Var1 != (_onexit_t)0x0) - 1;
}
=========================================
Function at address: 0x180028858
Called functions addresses: None


undefined * FUN_180028858(void)

{
return &DAT_1800920d8;
}
=========================================
Function at address: 0x180028868
Called functions addresses: None


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180028868(void)

{
_DAT_180092004 = 0;
return;
}
=========================================
Function at address: 0x180028878
Called functions addresses: 0xEXTERNAL:00000078 0xEXTERNAL:00000077 0xEXTERNAL:00000081 0xEXTERNAL:00000043 0x180028d90 0xEXTERNAL:00000076 0xEXTERNAL:00000042 0x180028868 0xEXTERNAL:0000008f


void FUN_180028878(undefined4 param_1)

{
code *pcVar1;
BOOL BVar2;
LONG LVar3;
PRUNTIME_FUNCTION FunctionEntry;
undefined *puVar4;
undefined8 unaff_retaddr;
DWORD64 local_res10;
undefined local_res18 [8];
undefined local_res20 [8];
undefined auStack_5c8 [8];
undefined auStack_5c0 [232];
undefined local_4d8 [152];
undefined *local_440;
DWORD64 local_3e0;

puVar4 = auStack_5c8;
BVar2 = IsProcessorFeaturePresent(0x17);
if (BVar2 != 0) {
pcVar1 = (code *)swi(0x29);
(*pcVar1)(param_1);
puVar4 = auStack_5c0;
}
*(undefined8 *)(puVar4 + -8) = 0x1800288ac;
FUN_180028868();
*(undefined8 *)(puVar4 + -8) = 0x1800288bd;
memset(local_4d8,0,0x4d0);
*(undefined8 *)(puVar4 + -8) = 0x1800288c7;
RtlCaptureContext(local_4d8);
*(undefined8 *)(puVar4 + -8) = 0x1800288e1;
FunctionEntry = RtlLookupFunctionEntry(local_3e0,&local_res10,(PUNWIND_HISTORY_TABLE)0x0);
if (FunctionEntry != (PRUNTIME_FUNCTION)0x0) {
*(undefined8 *)(puVar4 + 0x38) = 0;
*(undefined **)(puVar4 + 0x30) = local_res18;
*(undefined **)(puVar4 + 0x28) = local_res20;
*(undefined **)(puVar4 + 0x20) = local_4d8;
*(undefined8 *)(puVar4 + -8) = 0x180028922;
RtlVirtualUnwind(0,local_res10,local_3e0,FunctionEntry,*(PCONTEXT *)(puVar4 + 0x20),
*(PVOID **)(puVar4 + 0x28),*(PDWORD64 *)(puVar4 + 0x30),
*(PKNONVOLATILE_CONTEXT_POINTERS *)(puVar4 + 0x38));
}
local_440 = &stack0x00000008;
*(undefined8 *)(puVar4 + -8) = 0x180028954;
memset(puVar4 + 0x50,0,0x98);
*(undefined8 *)(puVar4 + 0x60) = unaff_retaddr;
*(undefined4 *)(puVar4 + 0x50) = 0x40000015;
*(undefined4 *)(puVar4 + 0x54) = 1;
*(undefined8 *)(puVar4 + -8) = 0x180028976;
BVar2 = IsDebuggerPresent();
*(undefined **)(puVar4 + 0x40) = puVar4 + 0x50;
*(undefined **)(puVar4 + 0x48) = local_4d8;
*(undefined8 *)(puVar4 + -8) = 0x180028997;
SetUnhandledExceptionFilter((LPTOP_LEVEL_EXCEPTION_FILTER)0x0);
*(undefined8 *)(puVar4 + -8) = 0x1800289a2;
LVar3 = UnhandledExceptionFilter((_EXCEPTION_POINTERS *)(puVar4 + 0x40));
if ((LVar3 == 0) && (BVar2 != 1)) {
*(undefined8 *)(puVar4 + -8) = 0x1800289b2;
FUN_180028868();
}
return;
}
=========================================
Function at address: 0x1800289cc
Called functions addresses: 0x18002a7c0


void FUN_1800289cc(void)

{
longlong *plVar1;

for (plVar1 = &DAT_1800871a0; plVar1 < &DAT_1800871a0; plVar1 = plVar1 + 1) {
if (*plVar1 != 0) {

}
}
return;
}
=========================================
Function at address: 0x180028a18
Called functions addresses: 0x18002a7c0


void FUN_180028a18(void)

{
longlong *plVar1;

for (plVar1 = &DAT_1800871b0; plVar1 < &DAT_1800871b0; plVar1 = plVar1 + 1) {
if (*plVar1 != 0) {

}
}
return;
}
=========================================
Function at address: 0x180028a70
Called functions addresses: None




{
return;
}
=========================================
Function at address: 0x180028a7c
Called functions addresses: 0x180028d54


void _o_free(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d54. Too many branches */

_o_free();
return;
}
=========================================
Function at address: 0x180028a88
Called functions addresses: None


/* WARNING: Removing unreachable block (ram,0x000180028b47) */
/* WARNING: Removing unreachable block (ram,0x000180028ac2) */
/* WARNING: Removing unreachable block (ram,0x000180028a9b) */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */
/* Library Function - Single Match
__isa_available_init

Library: Visual Studio 2019 Release */

undefined8 __isa_available_init(void)

{
int *piVar1;
uint *puVar2;
longlong lVar3;
uint uVar4;
uint uVar5;
uint uVar6;
byte in_XCR0;

piVar1 = (int *)cpuid_basic_info(0);
uVar6 = 0;
puVar2 = (uint *)cpuid_Version_info(1);
uVar4 = puVar2[3];
if ((piVar1[1] == 0x756e6547 && piVar1[3] == 0x6c65746e) && piVar1[2] == 0x49656e69) {
_DAT_180091988 = 0xffffffffffffffff;
uVar5 = *puVar2 & 0xfff3ff0;
if ((((uVar5 == 0x106c0) || (uVar5 == 0x20660)) || (uVar5 == 0x20670)) ||
((uVar5 - 0x30650 < 0x21 &&
((0x100010001U >> ((ulonglong)(uVar5 - 0x30650) & 0x3f) & 1) != 0)))) {
DAT_180092008 = DAT_180092008 | 1;
}
}
if (6 < *piVar1) {
lVar3 = cpuid_Extended_Feature_Enumeration_info(7);
uVar6 = *(uint *)(lVar3 + 4);
if ((uVar6 >> 9 & 1) != 0) {
DAT_180092008 = DAT_180092008 | 2;
}
}
_DAT_180091980 = 1;
DAT_180091984 = 2;
if ((uVar4 >> 0x14 & 1) != 0) {
_DAT_180091980 = 2;
DAT_180091984 = 6;
if ((((uVar4 >> 0x1b & 1) != 0) && ((uVar4 >> 0x1c & 1) != 0)) && ((in_XCR0 & 6) == 6)) {
DAT_180091984 = 0xe;
_DAT_180091980 = 3;
if ((uVar6 & 0x20) != 0) {
_DAT_180091980 = 5;
DAT_180091984 = 0x2e;
if (((uVar6 & 0xd0030000) == 0xd0030000) && ((in_XCR0 & 0xe0) == 0xe0)) {
DAT_180091984 = 0x6e;
_DAT_180091980 = 6;
}
}
}
}
return 0;
}
=========================================
Function at address: 0x180028c30
Called functions addresses: None


undefined8 FUN_180028c30(void)

{
return 1;
}
=========================================
Function at address: 0x180028c3c
Called functions addresses: None


/* Library Function - Single Match
__scrt_is_ucrt_dll_in_use

Library: Visual Studio 2019 Release */

bool __scrt_is_ucrt_dll_in_use(void)

{
return DAT_180091994 != 0;
}
=========================================
Function at address: 0x180028c56
Called functions addresses: 0xEXTERNAL:00000019


void _initterm(void)

{
/* WARNING: Could not recover jumptable at 0x000180028c56. Too many branches */

_initterm();
return;
}
=========================================
Function at address: 0x180028c62
Called functions addresses: 0xEXTERNAL:0000001a


void _initterm_e(void)

{
/* WARNING: Could not recover jumptable at 0x000180028c62. Too many branches */

_initterm_e();
return;
}
=========================================
Function at address: 0x180028c6e
Called functions addresses: 0xEXTERNAL:00000033




EXCEPTION_DISPOSITION
__C_specific_handler
(_EXCEPTION_RECORD *ExceptionRecord,void *EstablisherFrame,_CONTEXT *ContextRecord,
_DISPATCHER_CONTEXT *DispatcherContext)

{
EXCEPTION_DISPOSITION EVar1;

/* WARNING: Could not recover jumptable at 0x000180028c6e. Too many branches */

EVar1 = __C_specific_handler(ExceptionRecord,EstablisherFrame,ContextRecord,DispatcherContext);
return EVar1;
}
=========================================
Function at address: 0x180028c7a
Called functions addresses: 0xEXTERNAL:00000031


void _o___std_type_info_destroy_list(void)

{
/* WARNING: Could not recover jumptable at 0x000180028c7a. Too many branches */

_o___std_type_info_destroy_list();
return;
}
=========================================
Function at address: 0x180028c86
Called functions addresses: 0xEXTERNAL:00000030


void _o___stdio_common_vsnwprintf_s(void)

{
/* WARNING: Could not recover jumptable at 0x000180028c86. Too many branches */

_o___stdio_common_vsnwprintf_s();
return;
}
=========================================
Function at address: 0x180028c92
Called functions addresses: 0xEXTERNAL:0000002f


void _o___stdio_common_vswprintf(void)

{
/* WARNING: Could not recover jumptable at 0x000180028c92. Too many branches */

_o___stdio_common_vswprintf();
return;
}
=========================================
Function at address: 0x180028c9e
Called functions addresses: 0xEXTERNAL:0000002e




{
/* WARNING: Could not recover jumptable at 0x000180028c9e. Too many branches */


return;
}
=========================================
Function at address: 0x180028caa
Called functions addresses: 0xEXTERNAL:0000002d


void _o__cexit(void)

{
/* WARNING: Could not recover jumptable at 0x000180028caa. Too many branches */

_o__cexit();
return;
}
=========================================
Function at address: 0x180028cb6
Called functions addresses: 0xEXTERNAL:0000002c


void _o__configure_narrow_argv(void)

{
/* WARNING: Could not recover jumptable at 0x000180028cb6. Too many branches */

_o__configure_narrow_argv();
return;
}
=========================================
Function at address: 0x180028cc2
Called functions addresses: 0xEXTERNAL:0000002b


void _o__crt_atexit(void)

{
/* WARNING: Could not recover jumptable at 0x000180028cc2. Too many branches */

_o__crt_atexit();
return;
}
=========================================
Function at address: 0x180028cce
Called functions addresses: 0xEXTERNAL:00000021


void _o__execute_onexit_table(void)

{
/* WARNING: Could not recover jumptable at 0x000180028cce. Too many branches */

_o__execute_onexit_table();
return;
}
=========================================
Function at address: 0x180028cda
Called functions addresses: 0xEXTERNAL:0000001b


void _o__initialize_narrow_environment(void)

{
/* WARNING: Could not recover jumptable at 0x000180028cda. Too many branches */

_o__initialize_narrow_environment();
return;
}
=========================================
Function at address: 0x180028ce6
Called functions addresses: 0xEXTERNAL:0000001c


void _o__initialize_onexit_table(void)

{
/* WARNING: Could not recover jumptable at 0x000180028ce6. Too many branches */

_o__initialize_onexit_table();
return;
}
=========================================
Function at address: 0x180028d00
Called functions addresses: 0xEXTERNAL:0000001d




{
/* WARNING: Could not recover jumptable at 0x000180028d00. Too many branches */


return;
}
=========================================
Function at address: 0x180028d0c
Called functions addresses: 0xEXTERNAL:0000001e


void _o__register_onexit_function(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d0c. Too many branches */

_o__register_onexit_function();
return;
}
=========================================
Function at address: 0x180028d18
Called functions addresses: 0xEXTERNAL:0000001f


void _o__seh_filter_dll(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d18. Too many branches */

_o__seh_filter_dll();
return;
}
=========================================
Function at address: 0x180028d24
Called functions addresses: 0xEXTERNAL:00000020


void _o__stricmp(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d24. Too many branches */

_o__stricmp();
return;
}
=========================================
Function at address: 0x180028d30
Called functions addresses: 0xEXTERNAL:00000023


void _o__wcsicmp(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d30. Too many branches */

_o__wcsicmp();
return;
}
=========================================
Function at address: 0x180028d3c
Called functions addresses: 0xEXTERNAL:00000024


void _o__wcsnicmp(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d3c. Too many branches */

_o__wcsnicmp();
return;
}
=========================================
Function at address: 0x180028d48
Called functions addresses: 0xEXTERNAL:00000025


void _o__wsplitpath_s(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d48. Too many branches */

_o__wsplitpath_s();
return;
}
=========================================
Function at address: 0x180028d54
Called functions addresses: 0xEXTERNAL:00000026


void _o_free(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d54. Too many branches */

_o_free();
return;
}
=========================================
Function at address: 0x180028d60
Called functions addresses: 0xEXTERNAL:00000027


void _o_malloc(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d60. Too many branches */

_o_malloc();
return;
}
=========================================
Function at address: 0x180028d6c
Called functions addresses: 0xEXTERNAL:00000028


void _o_wcscat_s(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d6c. Too many branches */

_o_wcscat_s();
return;
}
=========================================
Function at address: 0x180028d78
Called functions addresses: 0xEXTERNAL:00000029


void _o_wcscpy_s(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d78. Too many branches */

_o_wcscpy_s();
return;
}
=========================================
Function at address: 0x180028d84
Called functions addresses: 0xEXTERNAL:0000002a


void _o_wcsncpy_s(void)

{
/* WARNING: Could not recover jumptable at 0x000180028d84. Too many branches */

_o_wcsncpy_s();
return;
}
=========================================
Function at address: 0x180028d90
Called functions addresses: 0xEXTERNAL:00000039


void * __cdecl memset(void *_Dst,int _Val,size_t _Size)

{
void *pvVar1;

/* WARNING: Could not recover jumptable at 0x000180028d90. Too many branches */

pvVar1 = memset(_Dst,_Val,_Size);
return pvVar1;
}
=========================================
Function at address: 0x180028d9c
Called functions addresses: 0x180028da8


void DelayLoad_SslImportKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028da8
Called functions addresses: 0x180017510


void FUN_180028da8(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 in_RAX;
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008be50,in_RAX);
/* WARNING: Could not recover jumptable at 0x000180028e1f. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028e27
Called functions addresses: 0x180028e33


void DelayLoad_CertSerializeCertificateStoreElement
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028e33
Called functions addresses: 0x180017510


void FUN_180028e33(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 in_RAX;
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008be70,in_RAX);
/* WARNING: Could not recover jumptable at 0x000180028eaa. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028eb2
Called functions addresses: 0x180028e33


void DelayLoad_CertSaveStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028ec4
Called functions addresses: 0x180028e33


void DelayLoad_CertOpenStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028ed6
Called functions addresses: 0x180028e33


void DelayLoad_CertCloseStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028ee8
Called functions addresses: 0x180028e33


void DelayLoad_CertAddSerializedElementToStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028efa
Called functions addresses: 0x180028e33


void DelayLoad_CertFreeCertificateContext
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028f0c
Called functions addresses: 0x180028e33


void DelayLoad_CertEnumCertificatesInStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028f1e
Called functions addresses: 0x180028e33


void DelayLoad_CertAddCertificateContextToStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028f30
Called functions addresses: 0x180028e33


void DelayLoad_CertFindCertificateInStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028f42
Called functions addresses: 0x180028f4e


void DelayLoad_CredIsMarshaledCredentialW
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028f4e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028f4e
Called functions addresses: 0x180017510


void FUN_180028f4e(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 in_RAX;
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008be90,in_RAX);
/* WARNING: Could not recover jumptable at 0x000180028fc5. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028fcd
Called functions addresses: 0x180028f4e


void DelayLoad_CredUnmarshalCredentialW
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028f4e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028fdf
Called functions addresses: 0x180028f4e


void DelayLoad_CredFree(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028f4e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180028ff1
Called functions addresses: 0x180028e33


void DelayLoad_CertFindCTLInStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029003
Called functions addresses: 0x180028e33


void DelayLoad_CertFreeCTLContext
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029015
Called functions addresses: 0x180028da8


void DelayLoad_SslFreeObject
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029027
Called functions addresses: 0x180028e33


void DelayLoad_CertNameToStrW
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029039
Called functions addresses: 0x180028e33


void DelayLoad_CertCreateCertificateContext
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002904b
Called functions addresses: 0x180028e33


void DelayLoad_CertNameToStrA
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002905d
Called functions addresses: 0x180028e33


void DelayLoad_CertGetPublicKeyLength
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002906f
Called functions addresses: 0x180028e33


void DelayLoad_CertDuplicateCertificateContext
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029081
Called functions addresses: 0x180028e33


void DelayLoad_CertSetCertificateContextProperty
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029093
Called functions addresses: 0x180028da8


void DelayLoad_SslComputeEapKeyBlock
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800290a5
Called functions addresses: 0x180028da8


void DelayLoad_SslExportKeyingMaterial
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800290b7
Called functions addresses: 0x1800290c3


void DelayLoad_LsaRegisterLogonProcess
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_1800290c3(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800290c3
Called functions addresses: 0x180017510


void FUN_1800290c3(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 in_RAX;
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008beb0,in_RAX);
/* WARNING: Could not recover jumptable at 0x00018002913a. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029142
Called functions addresses: 0x1800290c3


void DelayLoad_LsaLookupAuthenticationPackage
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_1800290c3(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029154
Called functions addresses: 0x180028e33


void DelayLoad_CryptDecodeObjectEx
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029166
Called functions addresses: 0x180028e33


void DelayLoad_CertGetNameStringW
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029178
Called functions addresses: 0x1800290c3


void DelayLoad_LsaLogonUser
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_1800290c3(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002918a
Called functions addresses: 0x1800290c3


void DelayLoad_LsaFreeReturnBuffer
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_1800290c3(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002919c
Called functions addresses: 0x180028e33


void DelayLoad_CertGetCertificateChain
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800291ae
Called functions addresses: 0x180028e33


void DelayLoad_CertFreeCertificateChain
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800291c0
Called functions addresses: 0x180028e33


void DelayLoad_CertCompareCertificateName
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800291d2
Called functions addresses: 0x1800290c3


void DelayLoad_LsaCallAuthenticationPackage
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_1800290c3(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800291e4
Called functions addresses: 0x1800290c3


void DelayLoad_LsaConnectUntrusted
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_1800290c3(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800291f6
Called functions addresses: 0x1800290c3


void DelayLoad_LsaDeregisterLogonProcess
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_1800290c3(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029208
Called functions addresses: 0x180028e33


void DelayLoad_CertFreeCertificateChainEngine
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002921a
Called functions addresses: 0x180029226


void DelayLoad_BCryptRegisterConfigChangeNotify
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029226
Called functions addresses: 0x180017510


void FUN_180029226(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 in_RAX;
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008bed0,in_RAX);
/* WARNING: Could not recover jumptable at 0x00018002929d. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800292a5
Called functions addresses: 0x180029226


void DelayLoad_BCryptUnregisterConfigChangeNotify
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800292b7
Called functions addresses: 0x180029226


void DelayLoad_BCryptGetFipsAlgorithmMode
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800292c9
Called functions addresses: 0x180029226


void DelayLoad_BCryptOpenAlgorithmProvider
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800292db
Called functions addresses: 0x180029226


void DelayLoad_BCryptCloseAlgorithmProvider
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800292ed
Called functions addresses: 0x180028da8


void DelayLoad_SslExportKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800292ff
Called functions addresses: 0x180028da8


void DelayLoad_SslExpandWriteKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029311
Called functions addresses: 0x180028da8


void DelayLoad_SslDecrementProviderReferenceCount
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029323
Called functions addresses: 0x180028da8


void DelayLoad_SslLookupCipherSuiteInfo
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029335
Called functions addresses: 0x180028da8


void DelayLoad_SslEncryptPacket
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029347
Called functions addresses: 0x180028da8


void DelayLoad_SslExpandNextGenTrafficKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029359
Called functions addresses: 0x180028da8


void DelayLoad_SslOpenProvider
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002936b
Called functions addresses: 0x180028da8


void DelayLoad_SslLookupCipherLengths
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002937d
Called functions addresses: 0x180028da8


void DelayLoad_SslIncrementProviderReferenceCount
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002938f
Called functions addresses: 0x180028da8


void DelayLoad_SslDecryptPacket
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800293a1
Called functions addresses: 0x180028da8


void DelayLoad_NCryptSignHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800293b3
Called functions addresses: 0x180028da8


void DelayLoad_NCryptFreeObject
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800293c5
Called functions addresses: 0x180028e33


void DelayLoad_CertGetCertificateContextProperty
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800293d7
Called functions addresses: 0x180028da8


void DelayLoad_NCryptSetProperty
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800293e9
Called functions addresses: 0x180029226


void DelayLoad_BCryptGenRandom
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800293fb
Called functions addresses: 0xEXTERNAL:00000094



EventWriteTransfer(REGHANDLE RegHandle,PCEVENT_DESCRIPTOR EventDescriptor,LPCGUID ActivityId,
LPCGUID RelatedActivityId,ULONG UserDataCount,PEVENT_DATA_DESCRIPTOR UserData)

{
ULONG UVar1;

/* WARNING: Could not recover jumptable at 0x0001800293fb. Too many branches */

UVar1 = EventWriteTransfer(RegHandle,EventDescriptor,ActivityId,RelatedActivityId,UserDataCount,
UserData);
return UVar1;
}
=========================================
Function at address: 0x180029407
Called functions addresses: 0x180028e33


void DelayLoad_CertAddEncodedCertificateToStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029419
Called functions addresses: 0x180028e33


void DelayLoad_CryptDecodeObject
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002942b
Called functions addresses: 0x180028e33


void DelayLoad_CryptFindOIDInfo
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002943d
Called functions addresses: 0x180028e33


void DelayLoad_CertVerifyCertificateChainPolicy
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002944f
Called functions addresses: 0x180028e33


void DelayLoad_CryptMemFree
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029461
Called functions addresses: 0x180028e33


void DelayLoad_CertGetEnhancedKeyUsage
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029473
Called functions addresses: 0x180028e33


void DelayLoad_CryptHashCertificate2
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029485
Called functions addresses: 0x1800290c3


void DelayLoad_GetUserNameExW
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_1800290c3(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029497
Called functions addresses: 0x180028e33


void DelayLoad_CertControlStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800294a9
Called functions addresses: 0x180028e33


void DelayLoad_CertDuplicateStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800294bb
Called functions addresses: 0x180017510


void DelayLoad_ConvertSidToStringSidW
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE =
(code *)FUN_180017510(&ImgDelayDescr_18008bef0,&ConvertSidToStringSidW_exref);
/* WARNING: Could not recover jumptable at 0x00018002953e. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029546
Called functions addresses: 0x180028e33


void DelayLoad_CertFindChainInStore
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029558
Called functions addresses: 0x180028e33


void DelayLoad_CertFindExtension
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002956a
Called functions addresses: 0x180029576


void DelayLoad_RegisterGPNotification
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029576(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029576
Called functions addresses: 0x180017510


void FUN_180029576(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 in_RAX;
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008bf10,in_RAX);
/* WARNING: Could not recover jumptable at 0x0001800295ed. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800295f5
Called functions addresses: 0x180029576


void DelayLoad_UnregisterGPNotification
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029576(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029607
Called functions addresses: 0x180029226


void DelayLoad_BCryptEnumContextFunctionProviders
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029619
Called functions addresses: 0x180028da8


void DelayLoad_NCryptOpenStorageProvider
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002962b
Called functions addresses: 0x180029226


void DelayLoad_BCryptFreeBuffer
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002963d
Called functions addresses: 0x180028da8


void DelayLoad_SslFreeBuffer
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002964f
Called functions addresses: 0x180028da8


void DelayLoad_SslEnumProtocolProviders
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029661
Called functions addresses: 0x180029226


void DelayLoad_BCryptQueryProviderRegistration
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029673
Called functions addresses: 0x180028da8


void DelayLoad_SslEnumCipherSuitesEx
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029685
Called functions addresses: 0x180028da8


void DelayLoad_SslEnumCipherSuites
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029697
Called functions addresses: 0x180028da8


void DelayLoad_SslEnumEccCurves
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800296a9
Called functions addresses: 0x180029226


void DelayLoad_BCryptEnumContextFunctions
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800296bb
Called functions addresses: 0x180028da8


void DelayLoad_SslOpenPrivateKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800296cd
Called functions addresses: 0x180028da8


void DelayLoad_NCryptImportKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800296df
Called functions addresses: 0x180028da8


void DelayLoad_SslCreateHandshakeHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800296f1
Called functions addresses: 0x180028da8


void DelayLoad_SslGetCipherSuitePRFHashAlgorithm
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029703
Called functions addresses: 0x180028da8


void DelayLoad_SslCreateClientAuthHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029715
Called functions addresses: 0x180028da8


void DelayLoad_SslHashHandshake
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029727
Called functions addresses: 0x180029226


void DelayLoad_BCryptGetProperty
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029739
Called functions addresses: 0x180029226


void DelayLoad_BCryptCreateHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002974b
Called functions addresses: 0x180029226


void DelayLoad_BCryptHashData
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002975d
Called functions addresses: 0x180029226


void DelayLoad_BCryptFinishHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002976f
Called functions addresses: 0x180029226


void DelayLoad_BCryptDestroyHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029781
Called functions addresses: 0x180028e33


void DelayLoad_CryptImportPublicKeyInfoEx
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029793
Called functions addresses: 0x180028da8


void DelayLoad_NCryptExportKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800297a5
Called functions addresses: 0x180029226


void DelayLoad_BCryptImportKeyPair
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800297b7
Called functions addresses: 0x180028e33


void DelayLoad_CryptImportPublicKeyInfoEx2
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800297c9
Called functions addresses: 0x180028da8


void DelayLoad_SslComputeClientAuthHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800297db
Called functions addresses: 0x180029226


void DelayLoad_BCryptVerifySignature
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800297ed
Called functions addresses: 0x180029226


void DelayLoad_BCryptDestroyKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800297ff
Called functions addresses: 0x180028da8


void DelayLoad_NCryptOpenKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029811
Called functions addresses: 0x180028e33


void DelayLoad_CertGetIntendedKeyUsage
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029823
Called functions addresses: 0x180029226


void DelayLoad_BCryptHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029226(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029835
Called functions addresses: 0x180028e33


void DelayLoad_CertOpenServerOcspResponse
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029847
Called functions addresses: 0x180028e33


void DelayLoad_CertCloseServerOcspResponse
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029859
Called functions addresses: 0x180028e33


void DelayLoad_CryptEncodeObject
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002986b
Called functions addresses: 0x180028e33


void DelayLoad_CertGetServerOcspResponseContext
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002987d
Called functions addresses: 0x180028e33


void DelayLoad_CertFreeServerOcspResponseContext
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002988f
Called functions addresses: 0x180028da8


void DelayLoad_SslDuplicateTranscriptHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800298a1
Called functions addresses: 0x180028da8


void DelayLoad_SslCreateEphemeralKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800298b3
Called functions addresses: 0x180028da8


void DelayLoad_SslSignHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800298c5
Called functions addresses: 0x180028da8


void DelayLoad_SslComputeFinishedHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800298d7
Called functions addresses: 0x180028da8


void DelayLoad_SslComputeSessionHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800298e9
Called functions addresses: 0x180028da8


void DelayLoad_SslExpandTrafficKeys
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800298fb
Called functions addresses: 0x180028da8


void DelayLoad_SslExtractEarlyKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002990d
Called functions addresses: 0x180028da8


void DelayLoad_SslExtractHandshakeKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002991f
Called functions addresses: 0x180028da8


void DelayLoad_SslExtractMasterKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029931
Called functions addresses: 0x180028da8


void DelayLoad_SslExpandExporterMasterKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029943
Called functions addresses: 0x180028da8


void DelayLoad_SslExpandPreSharedKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029955
Called functions addresses: 0x180028da8


void DelayLoad_SslExpandBinderKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029967
Called functions addresses: 0x180028da8


void DelayLoad_SslExpandResumptionMasterKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029979
Called functions addresses: 0x180028da8


void DelayLoad_SslGetKeyProperty
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002998b
Called functions addresses: 0x180028da8


void DelayLoad_SslGeneratePreMasterKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002999d
Called functions addresses: 0x180028da8


void DelayLoad_SslGenerateMasterKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800299af
Called functions addresses: 0x180028da8


void DelayLoad_SslImportMasterKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800299c1
Called functions addresses: 0x180028da8


void DelayLoad_NCryptVerifySignature
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800299d3
Called functions addresses: 0x180028e33


void DelayLoad_CertCreateCertificateChainEngine
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800299e5
Called functions addresses: 0x180028da8


void DelayLoad_SslGenerateSessionKeys
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028da8(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x1800299f7
Called functions addresses: 0x180017510


void DelayLoad_SampUsingDsData
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008bf30,&SampUsingDsData_exref);
/* WARNING: Could not recover jumptable at 0x000180029a7a. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029a82
Called functions addresses: 0x180029a8e


void DelayLoad_CryptAcquireContextW
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029a8e
Called functions addresses: 0x180017510


void FUN_180029a8e(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 in_RAX;
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008bf50,in_RAX);
/* WARNING: Could not recover jumptable at 0x000180029b05. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029b0d
Called functions addresses: 0x180029a8e


void DelayLoad_CryptReleaseContext
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029b1f
Called functions addresses: 0x180029a8e


void DelayLoad_CryptSignHashW
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029b31
Called functions addresses: 0x180029a8e


void DelayLoad_CryptDestroyHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029b43
Called functions addresses: 0x180029a8e


void DelayLoad_CryptSetHashParam
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029b55
Called functions addresses: 0x180029a8e


void DelayLoad_CryptHashData
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029b67
Called functions addresses: 0x180029a8e


void DelayLoad_CryptCreateHash
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029b79
Called functions addresses: 0x180029a8e


void DelayLoad_CryptSetProvParam
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029b8b
Called functions addresses: 0x180029a8e


void DelayLoad_CryptGetProvParam
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029b9d
Called functions addresses: 0x180029a8e


void DelayLoad_CryptExportKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029baf
Called functions addresses: 0x180029a8e


void DelayLoad_CryptDestroyKey
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029a8e(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029bc4
Called functions addresses: 0x18002a3e0


undefined FUN_180029bc4(void)

{
undefined uVar1;
int iVar2;

if (DAT_180092058 == 1) {
uVar1 = 1;
}
else {
if ((DAT_180092058 != 2) && (iVar2 = ApiSetQueryApiSetPresence(&DAT_18007d4b0), -1 < iVar2)) {
DAT_180092058 = 2;
return 0;
}
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x180029c18
Called functions addresses: 0x180017510


void DelayLoad_CrackSingleName
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008bf70,&CrackSingleName_exref);
/* WARNING: Could not recover jumptable at 0x000180029c9b. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029ca3
Called functions addresses: 0x180028e33


void DelayLoad_CryptObjectLocatorFree
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029cb5
Called functions addresses: 0x180028e33


void DelayLoad_CryptObjectLocatorGet
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029cc7
Called functions addresses: 0x180028e33


void DelayLoad_CryptObjectLocatorGetContent
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029cd9
Called functions addresses: 0x180028e33


void DelayLoad_I_CertWnfEnableFlushCache
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029ceb
Called functions addresses: 0x180028e33


void DelayLoad_I_CertProcessSslHandshake
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029cfd
Called functions addresses: 0x180028e33


void DelayLoad_I_CertFinishSslHandshake
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029d0f
Called functions addresses: 0x180028e33


void DelayLoad_CryptObjectLocatorInitialize
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029d21
Called functions addresses: 0x180028e33


void DelayLoad_CryptObjectLocatorRelease
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029d33
Called functions addresses: 0x180028e33


void DelayLoad_CryptObjectLocatorIsChanged
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029d45
Called functions addresses: 0x180028e33


void DelayLoad_CryptObjectLocatorGetUpdated
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180028e33(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029d57
Called functions addresses: 0x180029d63


void DelayLoad_LsaISetTokenDacl
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029d63(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029d63
Called functions addresses: 0x180017510


void FUN_180029d63(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 in_RAX;
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008bf90,in_RAX);
/* WARNING: Could not recover jumptable at 0x000180029dda. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029de2
Called functions addresses: 0x180029d63


void DelayLoad_LsaIIsDomainWithinForest
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029d63(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029df4
Called functions addresses: 0x180029d63


void DelayLoad_LsaIQueryInformationPolicyTrusted
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029d63(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029e06
Called functions addresses: 0x180029d63


void DelayLoad_LsaIFree_LSAPR_POLICY_INFORMATION
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029d63(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029e18
Called functions addresses: 0x180029d63


void DelayLoad_LsaIRegisterPolicyChangeNotificationCallback
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029d63(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029e2a
Called functions addresses: 0x180029d63


void DelayLoad_LsaIFilterSids
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029d63(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029e3c
Called functions addresses: 0x180029d63


void DelayLoad_LsaIModifyPerformanceCounter
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029d63(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029e4e
Called functions addresses: 0x180029e5a


void DelayLoad_I_RpcMapWin32Status
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029e5a(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029e5a
Called functions addresses: 0x180017510


void FUN_180029e5a(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 in_RAX;
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008bfb0,in_RAX);
/* WARNING: Could not recover jumptable at 0x000180029ed1. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029ed9
Called functions addresses: 0x180029e5a


void DelayLoad_MesHandleFree
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029e5a(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029eeb
Called functions addresses: 0x180029e5a


void DelayLoad_MesEncodeIncrementalHandleCreate
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029e5a(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029efd
Called functions addresses: 0x180029e5a


void DelayLoad_MesDecodeIncrementalHandleCreate
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029e5a(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029f0f
Called functions addresses: 0x180029e5a


void DelayLoad_MesIncrementalHandleReset
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029e5a(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029f21
Called functions addresses: 0x180029e5a


void DelayLoad_NdrMesTypeDecode3
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029e5a(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029f33
Called functions addresses: 0x180029e5a


void DelayLoad_NdrMesTypeEncode3
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029e5a(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029f45
Called functions addresses: 0x180029e5a


void DelayLoad_NdrMesTypeAlignSize3
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_180029e5a(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x180029f58
Called functions addresses: 0x180028c9e 0x180028d60


longlong FUN_180029f58(undefined8 param_1)

{
int iVar1;
longlong lVar2;

do {
lVar2 = _o_malloc(param_1);
if (lVar2 != 0) {
return lVar2;
}

} while (iVar1 != 0);
return 0;
}
=========================================
Function at address: 0x180029fa0
Called functions addresses: 0xEXTERNAL:00000055 0x180028668 0x180028838 0xEXTERNAL:0000006d 0x180028878 0xEXTERNAL:00000058 0x18002a080 0xEXTERNAL:00000070


undefined8 FUN_180029fa0(void)

{
code *pcVar1;
HMODULE hModule;
FARPROC pFVar2;
FARPROC pFVar3;
undefined8 uVar4;

InitializeCriticalSectionAndSpinCount((LPCRITICAL_SECTION)&DAT_180092090,4000);
hModule = GetModuleHandleW(L"api-ms-win-core-synch-l1-2-0.dll");
if ((hModule != (HMODULE)0x0) ||
(hModule = GetModuleHandleW(L"kernel32.dll"), hModule != (HMODULE)0x0)) {
pFVar2 = GetProcAddress(hModule,"SleepConditionVariableCS");
pFVar3 = GetProcAddress(hModule,"WakeAllConditionVariable");
if ((((pFVar2 != (FARPROC)0x0) && (pFVar3 != (FARPROC)0x0)) ||
(DAT_180092088 = CreateEventW((LPSECURITY_ATTRIBUTES)0x0,1,0,(LPCWSTR)0x0),
pFVar2 = DAT_1800920b8, pFVar3 = DAT_1800920c0, DAT_180092088 != (HANDLE)0x0)) &&
(DAT_1800920c0 = pFVar3, DAT_1800920b8 = pFVar2, uVar4 = __scrt_initialize_onexit_tables(0),
(char)uVar4 != '\0')) {
atexit(FUN_18002a080);
return 0;
}
}
FUN_180028878(7);
pcVar1 = (code *)swi(3);
uVar4 = (*pcVar1)();
return uVar4;
}
=========================================
Function at address: 0x18002a080
Called functions addresses: 0xEXTERNAL:0000006a 0xEXTERNAL:00000062


void FUN_18002a080(void)

{
DeleteCriticalSection((LPCRITICAL_SECTION)&DAT_180092090);
if (DAT_180092088 != (HANDLE)0x0) {
CloseHandle(DAT_180092088);
}
return;
}
=========================================
Function at address: 0x18002a0b0
Called functions addresses: 0xEXTERNAL:00000068 0xEXTERNAL:00000064 0x18002a188


/* Library Function - Single Match
_Init_thread_footer

Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

void _Init_thread_footer(int *param_1)

{
ulonglong uVar1;

EnterCriticalSection((LPCRITICAL_SECTION)&DAT_180092090);
uVar1 = (ulonglong)_tls_index;
DAT_180091990 = DAT_180091990 + 1;
*param_1 = DAT_180091990;
*(int *)(*(longlong *)((longlong)ThreadLocalStoragePointer + uVar1 * 8) + 4) = DAT_180091990;
LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_180092090);
FUN_18002a188();
return;
}
=========================================
Function at address: 0x18002a118
Called functions addresses: 0xEXTERNAL:00000068 0xEXTERNAL:00000064 0x18002a1dc


/* Library Function - Single Match
_Init_thread_header

Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

void _Init_thread_header(int *param_1)

{
EnterCriticalSection((LPCRITICAL_SECTION)&DAT_180092090);
do {
if (*param_1 == 0) {
*param_1 = -1;
LAB_18002a16c:
/* WARNING: Could not recover jumptable at 0x00018002a178. Too many branches */

LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_180092090);
return;
}
if (*param_1 != -1) {
*(undefined4 *)
(*(longlong *)((longlong)ThreadLocalStoragePointer + (ulonglong)_tls_index * 8) + 4) =
DAT_180091990;
goto LAB_18002a16c;
}
FUN_18002a1dc(100);
} while( true );
}
=========================================
Function at address: 0x18002a188
Called functions addresses: 0x18002a7c0 0xEXTERNAL:00000073


/* WARNING: Switch with 1 destination removed at 0x00018002a1ad */
/* WARNING: Switch with 1 destination removed at 0x00018002a7c0 */

void FUN_18002a188(void)

{
if (DAT_1800920c0 == (code *)0x0) {
SetEvent(DAT_180092088);
/* WARNING: Could not recover jumptable at 0x00018002a1cc. Too many branches */

ResetEvent(DAT_180092088);
return;
}
/* WARNING: Could not recover jumptable at 0x00018002a7a0. Too many branches */

(*DAT_1800920c0)(&DAT_180092080);
return;
}
=========================================
Function at address: 0x18002a1dc
Called functions addresses: 0xEXTERNAL:00000068 0xEXTERNAL:00000064 0xEXTERNAL:00000067 0x18002a7c0


/* WARNING: Switch with 1 destination removed at 0x00018002a210 */
/* WARNING: Switch with 1 destination removed at 0x00018002a7c0 */

void FUN_18002a1dc(DWORD param_1)

{
if (DAT_1800920b8 == (code *)0x0) {
LeaveCriticalSection((LPCRITICAL_SECTION)&DAT_180092090);
WaitForSingleObjectEx(DAT_180092088,param_1,0);
/* WARNING: Could not recover jumptable at 0x00018002a242. Too many branches */

EnterCriticalSection((LPCRITICAL_SECTION)&DAT_180092090);
return;
}
/* WARNING: Could not recover jumptable at 0x00018002a7a0. Too many branches */

(*DAT_1800920b8)(&DAT_180092080,&DAT_180092090,param_1);
return;
}
=========================================
Function at address: 0x18002a24f
Called functions addresses: 0xEXTERNAL:000000e1


__time32_t __cdecl _time32(__time32_t *_Time)

{
__time32_t _Var1;

/* WARNING: Could not recover jumptable at 0x00018002a24f. Too many branches */

_Var1 = _time32(_Time);
return _Var1;
}
=========================================
Function at address: 0x18002a25c
Called functions addresses: 0x180028c92 0x180027c54


/* Library Function - Multiple Matches With Different Base Names
_vsnprintf
_vsnwprintf

Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

int __cdecl FID_conflict__vsnprintf(wchar_t *_Dest,size_t _Count,wchar_t *_Format,va_list _Args)

{
int iVar1;
ulonglong *puVar2;

puVar2 = (ulonglong *)FUN_180027c54();
iVar1 = _o___stdio_common_vswprintf(*puVar2 | 1,_Dest,_Count,_Format,0,_Args);
if (iVar1 < 0) {
iVar1 = -1;
}
return iVar1;
}
=========================================
Function at address: 0x18002a2c4
Called functions addresses: 0x180028c86 0x180027c54


/* Library Function - Multiple Matches With Different Base Names
_snprintf_s
_snwprintf_s

Libraries: Visual Studio 2015 Release, Visual Studio 2017 Release, Visual Studio 2019 Release */

int __cdecl
FID_conflict__snprintf_s(wchar_t *_DstBuf,size_t _SizeInWords,size_t _MaxCount,wchar_t *_Format,...)

{
int iVar1;
undefined8 *puVar2;

puVar2 = (undefined8 *)FUN_180027c54();
iVar1 = _o___stdio_common_vsnwprintf_s
(*puVar2,_DstBuf,_SizeInWords,_MaxCount,_Format,0,&stack0x00000028);
if (iVar1 < 0) {
iVar1 = -1;
}
return iVar1;
}
=========================================
Function at address: 0x18002a324
Called functions addresses: 0x18002a330


void DelayLoad_EnableTraceEx2
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_18002a330(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002a330
Called functions addresses: 0x180017510


void FUN_18002a330(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 in_RAX;
code *UNRECOVERED_JUMPTABLE;

UNRECOVERED_JUMPTABLE = (code *)FUN_180017510(&ImgDelayDescr_18008bfd0,in_RAX);
/* WARNING: Could not recover jumptable at 0x00018002a3a7. Too many branches */

(*UNRECOVERED_JUMPTABLE)(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002a3af
Called functions addresses: 0x18002a330


void DelayLoad_ControlTraceW
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_18002a330(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002a3c1
Called functions addresses: 0x18002a330


void DelayLoad_StartTraceW
(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
FUN_18002a330(param_1,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18002a3e0
Called functions addresses: 0xEXTERNAL:000000ef


void ApiSetQueryApiSetPresence(void)

{
/* WARNING: Could not recover jumptable at 0x00018002a3e0. Too many branches */

ApiSetQueryApiSetPresence();
return;
}
=========================================
Function at address: 0x18002a3ec
Called functions addresses: None


undefined FUN_18002a3ec(void)

{
return 1;
}
=========================================
Function at address: 0x18002a3f8
Called functions addresses: None


undefined FUN_18002a3f8(void)

{
return 1;
}
=========================================
Function at address: 0x18002a404
Called functions addresses: None


undefined8 FUN_18002a404(void)

{
return 0;
}
=========================================
Function at address: 0x18002a410
Called functions addresses: None


undefined8 * FUN_18002a410(undefined8 *param_1)

{
*param_1 = &PTR_FUN_18007d4e0;
return param_1;
}
=========================================
Function at address: 0x18002a428
Called functions addresses: 0xEXTERNAL:000000a9 0x180001a64 0x180017638 0xEXTERNAL:000000aa 0x180017230 0x180017bbc 0x180017d1c 0xEXTERNAL:00000057 0x180015fc8 0x180017e30 0x180017ccc 0x1800155ec 0x180017bfc


ulonglong FUN_18002a428(HMODULE param_1,int param_2)

{
int iVar1;
undefined8 uVar2;
ulonglong uVar3;

if (param_2 == 1) {
DAT_1800921e0 = param_1;
DisableThreadLibraryCalls(param_1);
iVar1 = RtlInitializeCriticalSection(&DAT_180092cc8);
if (-1 < iVar1) {
DAT_180092199 = '\x01';
iVar1 = RtlInitializeCriticalSection(&DAT_180092ca0);
if (-1 < iVar1) {
DAT_180092198 = '\x01';
uVar2 = FUN_1800155ec();
if (-1 < (int)uVar2) {
FUN_180015fc8();
FUN_180017bbc();
FUN_180017638();
DAT_180091000 = &DAT_180092a60;
DAT_180092a88 = &DAT_180084b70;
FUN_180001a64();
goto LAB_18002a4bf;
}
}
}
uVar3 = 0;
}
else {
if (param_2 == 0) {
uVar3 = FUN_180017230();
if (DAT_180092199 != '\0') {
RtlDeleteCriticalSection(&DAT_180092cc8);
}
if (DAT_180092198 != '\0') {
RtlDeleteCriticalSection(&DAT_180092ca0);
}
FUN_180017e30();
FUN_180017d1c();
FUN_180017ccc();
FUN_180017bfc();
return uVar3 & 0xffffffff;
}
LAB_18002a4bf:
uVar3 = 1;
}
return uVar3;
}
=========================================
Function at address: 0x18002a530
Called functions addresses: None


undefined4 FUN_18002a530(undefined8 param_1,char param_2)

{
undefined4 uVar1;

uVar1 = DAT_1800925c0;
if (param_2 != '\0') {
uVar1 = DAT_1800925c4;
}
return uVar1;
}
=========================================
Function at address: 0x18002a548
Called functions addresses: 0x180006da4


bool FUN_18002a548(ushort *param_1,longlong param_2,uint param_3)

{
ushort *puVar1;
byte bVar2;

if (param_2 != 0) {
puVar1 = param_1 + 0x11;
*puVar1 = *puVar1 & *(ushort *)(param_2 + 0x22);
*param_1 = 0;
if (*puVar1 != 0) {
bVar2 = 0;
do {
if (((param_1[0x11] >> (bVar2 & 0x1f) & 1) != 0) &&
((param_1[0x11] = param_1[0x11] & ~(ushort)(1 << (bVar2 & 0x1f)), (param_3 & 0x3000) == 0
|| ((&DAT_18007c3ac)[(ulonglong)bVar2 * 0x12] != 2)))) {
FUN_180006da4(param_1,bVar2);
}
bVar2 = bVar2 + 1;
} while (bVar2 < 0xc);
return *param_1 != 0;
}
}
return false;
}
=========================================
Function at address: 0x18002a5d4
Called functions addresses: 0x18002a5f8


/* Library Function - Single Match
__GSHandlerCheck

Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release */

undefined8
__GSHandlerCheck(undefined8 param_1,ulonglong param_2,undefined8 param_3,longlong param_4)

{
__GSHandlerCheckCommon(param_2,param_4,*(uint **)(param_4 + 0x38));
return 1;
}
=========================================
Function at address: 0x18002a5f8
Called functions addresses: 0x180028070


/* Library Function - Single Match
__GSHandlerCheckCommon

Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release */

void __GSHandlerCheckCommon(ulonglong param_1,longlong param_2,uint *param_3)

{
ulonglong uVar1;
ulonglong uVar2;

uVar2 = param_1;
if ((*(byte *)param_3 & 4) != 0) {
uVar2 = (longlong)(int)param_3[1] + param_1 & (longlong)(int)-param_3[2];
}
uVar1 = (ulonglong)*(uint *)(*(longlong *)(param_2 + 0x10) + 8);
if ((*(byte *)(uVar1 + 3 + *(longlong *)(param_2 + 8)) & 0xf) != 0) {
param_1 = param_1 + (*(byte *)(uVar1 + 3 + *(longlong *)(param_2 + 8)) & 0xfffffff0);
}
FUN_180028070(param_1 ^ *(ulonglong *)((longlong)(int)(*param_3 & 0xfffffff8) + uVar2));
return;
}
=========================================
Function at address: 0x18002a65c
Called functions addresses: 0x180028c6e 0x18002a5f8


/* Library Function - Single Match
__GSHandlerCheck_SEH

Libraries: Visual Studio 2017 Release, Visual Studio 2019 Release */

void __GSHandlerCheck_SEH
(_EXCEPTION_RECORD *param_1,void *param_2,_CONTEXT *param_3,
_DISPATCHER_CONTEXT *param_4)

{
uint uVar1;
uint *puVar2;

puVar2 = *(uint **)(param_4 + 0x38);
uVar1 = *puVar2;
__GSHandlerCheckCommon((ulonglong)param_2,(longlong)param_4,puVar2 + (ulonglong)uVar1 * 4 + 1);
if ((puVar2[(ulonglong)uVar1 * 4 + 1] & ((param_1->ExceptionFlags & 0x66) != 0) + 1) != 0) {
__C_specific_handler(param_1,param_2,param_3,param_4);
}
return;
}
=========================================
Function at address: 0x18002a700
Called functions addresses: None


/* WARNING: This is an inlined function */
/* Library Function - Single Match
_alloca_probe

Libraries: Visual Studio 2015, Visual Studio 2017, Visual Studio 2019 */

void _alloca_probe(void)

{
undefined *in_RAX;
undefined *puVar1;
undefined *puVar2;
undefined local_res8 [32];

puVar1 = local_res8 + -(longlong)in_RAX;
if (local_res8 < in_RAX) {
puVar1 = (undefined *)0x0;
}
if (puVar1 < StackLimit) {
puVar2 = (undefined *)StackLimit;
do {
puVar2 = puVar2 + -0x1000;
*puVar2 = 0;
} while ((undefined *)((ulonglong)puVar1 & 0xfffffffffffff000) != puVar2);
}
return;
}
=========================================
Function at address: 0x18002a757
Called functions addresses: 0xEXTERNAL:0000003a


int __cdecl strcmp(char *_Str1,char *_Str2)

{
int iVar1;

/* WARNING: Could not recover jumptable at 0x00018002a757. Too many branches */

iVar1 = strcmp(_Str1,_Str2);
return iVar1;
}
=========================================
Function at address: 0x18002a763
Called functions addresses: 0xEXTERNAL:00000038


int __cdecl wcscmp(wchar_t *_Str1,wchar_t *_Str2)

{
int iVar1;

/* WARNING: Could not recover jumptable at 0x00018002a763. Too many branches */

iVar1 = wcscmp(_Str1,_Str2);
return iVar1;
}
=========================================
Function at address: 0x18002a76f
Called functions addresses: 0xEXTERNAL:00000034


int __cdecl memcmp(void *_Buf1,void *_Buf2,size_t _Size)

{
int iVar1;

/* WARNING: Could not recover jumptable at 0x00018002a76f. Too many branches */

iVar1 = memcmp(_Buf1,_Buf2,_Size);
return iVar1;
}
=========================================
Function at address: 0x18002a77b
Called functions addresses: 0xEXTERNAL:00000035


void * __cdecl memcpy(void *_Dst,void *_Src,size_t _Size)

{
void *pvVar1;

/* WARNING: Could not recover jumptable at 0x00018002a77b. Too many branches */

pvVar1 = memcpy(_Dst,_Src,_Size);
return pvVar1;
}
=========================================
Function at address: 0x18002a787
Called functions addresses: 0xEXTERNAL:00000022


void * __cdecl memmove(void *_Dst,void *_Src,size_t _Size)

{
void *pvVar1;

/* WARNING: Could not recover jumptable at 0x00018002a787. Too many branches */

pvVar1 = memmove(_Dst,_Src,_Size);
return pvVar1;
}
=========================================
Function at address: 0x18002a7a0
Called functions addresses: None


/* WARNING: This is an inlined function */



{
code *UNRECOVERED_JUMPTABLE;

/* WARNING: Could not recover jumptable at 0x00018002a7a0. Too many branches */

(*UNRECOVERED_JUMPTABLE)();
return;
}
=========================================
Function at address: 0x18002a7c0
Called functions addresses: 0x18002a7a0


/* WARNING: This is an inlined function */
/* WARNING: Switch with 1 destination removed at 0x00018002a7c0 */



{
code *UNRECOVERED_JUMPTABLE;

/* WARNING: Could not recover jumptable at 0x00018002a7a0. Too many branches */

(*UNRECOVERED_JUMPTABLE)();
return;
}
=========================================
Function at address: 0x18002a7e0
Called functions addresses: 0x18005aaf0


void FUN_18002a7e0(longlong param_1,undefined8 param_2,uint param_3)

{
FUN_18005aaf0((longlong *)(param_1 + -0x558),param_2,param_3);
return;
}
=========================================
Function at address: 0x18002a800
Called functions addresses: 0x180020110


void FUN_18002a800(longlong param_1)

{
FUN_180020110((longlong *)(param_1 + -1000));
return;
}
=========================================
Function at address: 0x18002a812
Called functions addresses: None


bool FUN_18002a812(undefined8 *param_1)

{
return *(int *)*param_1 == -0x3fffff03;
}
=========================================
Function at address: 0x18002a838
Called functions addresses: None


void FUN_18002a838(void)

{
return;
}
=========================================
Function at address: 0x18002a84e
Called functions addresses: None


bool FUN_18002a84e(undefined8 *param_1,longlong param_2)

{
int iVar1;

*(undefined8 **)(param_2 + 0x28) = param_1;
iVar1 = *(int *)*param_1;
*(int *)(param_2 + 0x20) = iVar1;
return iVar1 == -0x3ffffff3;
}
=========================================
Function at address: 0x18002a87b
Called functions addresses: None


bool FUN_18002a87b(undefined8 *param_1,longlong param_2)

{
int iVar1;

*(undefined8 **)(param_2 + 0x28) = param_1;
iVar1 = *(int *)*param_1;
*(int *)(param_2 + 0x20) = iVar1;
return iVar1 == -0x3ffffff3;
}
=========================================
Function at address: 0x18002a8a8
Called functions addresses: 0x18002879c


void FUN_18002a8a8(undefined8 param_1,longlong param_2)

{
__scrt_release_startup_lock(*(char *)(param_2 + 0x40));
return;
}
=========================================
Function at address: 0x18002a8c5
Called functions addresses: 0x18002879c


void FUN_18002a8c5(undefined8 param_1,longlong param_2)

{
__scrt_release_startup_lock(*(char *)(param_2 + 0x20));
return;
}
=========================================
Function at address: 0x18002a8de
Called functions addresses: 0x1800285fc


void FUN_18002a8de(void)

{
FUN_1800285fc();
return;
}
=========================================
Function at address: 0x18002a8f8
Called functions addresses: 0x180027cb0 0x180028554


void FUN_18002a8f8(undefined8 *param_1,longlong param_2)

{
FUN_180028554(*(undefined8 *)(param_2 + 0x60),*(int *)(param_2 + 0x68),
*(undefined8 *)(param_2 + 0x70),FUN_180027cb0,*(undefined4 *)*param_1,param_1);
return;
}
=========================================
Function at address: 0x18002a934
Called functions addresses: None


bool FUN_18002a934(undefined8 *param_1)

{
return *(int *)*param_1 == -0x3ffffffb;
}
=========================================
Function at address: 0x18002a960
Called functions addresses: 0x180017e08


void FUN_18002a960(void)

{
FUN_180017e08(&DAT_180092420);
return;
}
=========================================
Function at address: 0x18002a980
Called functions addresses: 0x180017c90


void FUN_18002a980(void)

{
FUN_180017c90((undefined8 *)&DAT_180092da0);
return;
}
=========================================
Function at address: 0x18002c9e0
Called functions addresses: None


undefined8
FUN_18002c9e0(undefined8 param_1,int param_2,uint param_3,longlong *param_4,longlong *param_5)

{
ulonglong *puVar1;
longlong lVar2;
longlong *plVar3;
ulonglong uVar4;
ulonglong *puVar5;
longlong **pplVar6;
code *pcVar7;
undefined8 uVar8;
longlong *in_RAX;
longlong ***ppplVar9;
uint uVar10;
longlong *unaff_RBX;
int *unaff_RBP;
uint unaff_EDI;
char unaff_R13B;
longlong *unaff_R14;
int unaff_R15D;
longlong **pplStackX_20;

ppplVar9 = (longlong ***)(ulonglong)(param_2 - 1U);
if (param_2 - 1U < param_3) goto LAB_180002e2a;
LAB_18002c9ec:
*(undefined2 *)((longlong)in_RAX + -0x54) = 0;
ppplVar9 = (longlong ***)((ulonglong)ppplVar9 & 0xffffffffffffff00);
do {
if (unaff_R15D < *unaff_RBP) {
*(undefined2 *)((longlong)in_RAX + -0x54) = 0;
LAB_180002e49:
if (*(char *)((longlong)in_RAX + -0x53) != '\x01') {
lVar2 = in_RAX[-4];
if ((*(longlong **)(lVar2 + 8) != in_RAX + -4) ||
(plVar3 = (longlong *)in_RAX[-3], (longlong *)*plVar3 != in_RAX + -4))
goto LAB_180002f81;
*plVar3 = lVar2;
puVar1 = (ulonglong *)(in_RAX + -2);
*(longlong **)(lVar2 + 8) = plVar3;
uVar4 = *puVar1;
if ((*(ulonglong **)(uVar4 + 8) != puVar1) ||
(puVar5 = (ulonglong *)in_RAX[-1], (ulonglong *)*puVar5 != puVar1)) goto LAB_180002f81;
*puVar5 = uVar4;
*(ulonglong **)(uVar4 + 8) = puVar5;
lVar2 = *param_4;
if ((*(longlong **)(lVar2 + 8) != param_4) ||
(plVar3 = (longlong *)param_4[1], (longlong *)*plVar3 != param_4)) goto LAB_180002f81;
*plVar3 = lVar2;
*(longlong **)(lVar2 + 8) = plVar3;
LOCK();
*unaff_RBP = *unaff_RBP + -1;
UNLOCK();
LsaIModifyPerformanceCounter(4);
if ((longlong ***)*param_5 != &pplStackX_20) goto LAB_180002f81;
in_RAX[-1] = (longlong)param_5;
ppplVar9 = &pplStackX_20;
*puVar1 = (ulonglong)ppplVar9;
*param_5 = (longlong)puVar1;
param_5 = (longlong *)puVar1;
if ((*unaff_RBP < unaff_R15D) && (unaff_R13B != '\0')) {
LAB_180002dbd:
RtlReleaseResource();
if ((longlong ***)pplStackX_20 != &pplStackX_20) {
do {
ppplVar9 = (longlong ***)*pplStackX_20;
if ((ppplVar9[1] != pplStackX_20) ||
(pplVar6 = ((longlong ***)pplStackX_20)[1], (longlong **)*pplVar6 != pplStackX_20))
{
LAB_180002f81:
pcVar7 = (code *)swi(0x29);
(*pcVar7)(3);
pcVar7 = (code *)swi(3);
uVar8 = (*pcVar7)();
return uVar8;
}
*pplVar6 = (longlong *)ppplVar9;
ppplVar9[1] = pplVar6;
if ((longlong ***)pplStackX_20 + -0x26 != (longlong ***)0x0) {

;
}
pplStackX_20 = (longlong **)ppplVar9;
} while (ppplVar9 != &pplStackX_20);
}
return CONCAT71((int7)((ulonglong)&pplStackX_20 >> 8),1);
}
}
}
else if ((char)ppplVar9 != '\x01') goto LAB_180002e49;
do {
in_RAX = unaff_RBX;
if (in_RAX == unaff_R14) goto LAB_180002dbd;
unaff_RBX = (longlong *)*in_RAX;
} while (1 < *(int *)(in_RAX + -0xb));
uVar10 = unaff_EDI - *(int *)((longlong)in_RAX + -0x2c);
param_4 = in_RAX;
if (*(uint *)((longlong)in_RAX + -0x2c) < unaff_EDI) {
if (*(uint *)(in_RAX + -5) < uVar10) goto LAB_18002c9ec;
}
else if (unaff_EDI < *(uint *)((longlong)in_RAX + -0x2c)) {
uVar8 = FUN_18002c9e0(ppplVar9,uVar10,*(uint *)(in_RAX + -5),in_RAX,param_5);
return uVar8;
}
LAB_180002e2a:
ppplVar9 = (longlong ***)(ulonglong)*(byte *)((longlong)in_RAX + -0x54);
} while( true );
}
=========================================
Function at address: 0x18002ca26
Called functions addresses: 0x18004312c 0x18000329b


void FUN_18002ca26(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined param_4,
undefined param_5,undefined param_6,undefined param_7,undefined param_8,
undefined param_9,undefined param_10,undefined param_11)

{
undefined uVar1;
undefined uVar2;
undefined8 in_stack_00000068;
undefined1 in_stack_00000070;
undefined8 in_stack_00000088;
undefined8 in_stack_00000090;

uVar2 = (undefined)param_3;
uVar1 = (undefined)param_1;
if (((byte)DAT_180092f00 & 1) != 0) {
param_4 = 1;
param_2._0_1_ = 0xc0;
FUN_18004312c(param_1,&DAT_180084bc0,param_3,1,(undefined8 *)&param_11);
}
FUN_18000329b(uVar1,(undefined)param_2,uVar2,param_4,param_5,param_6,param_7,param_8,param_9,
param_10,in_stack_00000068,in_stack_00000070,in_stack_00000088,in_stack_00000090);
return;
}
=========================================
Function at address: 0x18002ca56
Called functions addresses: 0x1800032dc


undefined8 FUN_18002ca56(undefined8 param_1,undefined8 param_2,uint param_3)

{
int in_EAX;
undefined8 uVar1;

if (param_3 <= in_EAX - 1U) {
uVar1 = FUN_1800032dc();
return uVar1;
}
return 0;
}
=========================================
Function at address: 0x18002ce90
Called functions addresses: 0x180004740


undefined8 FUN_18002ce90(void)

{
longlong lVar1;
undefined8 uVar2;
uint uVar3;
ulonglong uVar4;
int unaff_ESI;
longlong unaff_RDI;
uint uVar5;
ulonglong in_R9;
uint in_R10D;
longlong *in_R11;

do {
uVar5 = (int)in_R9 + 1;
in_R9 = (ulonglong)uVar5;
if (in_R10D <= uVar5) {
uVar2 = FUN_180004740();
return uVar2;
}
uVar4 = 0;
uVar5 = *(uint *)(in_R9 * 0x20 + 8 + unaff_RDI);
} while (uVar5 == 0);
do {
lVar1 = uVar4 * 0x30c + *(longlong *)(in_R9 * 0x20 + unaff_RDI);
if (*(int *)(lVar1 + 0x304) == unaff_ESI) {
*in_R11 = lVar1;
return 0;
}
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
} while (uVar3 < uVar5);
uVar2 = FUN_18002ce90();
return uVar2;
}
=========================================
Function at address: 0x18002cf90
Called functions addresses: 0x18005b470


void FUN_18002cf90(void)

{
ulonglong unaff_RBP;
longlong *unaff_RDI;

FUN_18005b470(unaff_RDI,0x321,0x80090308,0x28);
if (*(longlong *)(unaff_RBP + 0x18) != 0) {
SslFreeObject(*(longlong *)(unaff_RBP + 0x18),0);
}
if (*(longlong *)(unaff_RBP + 0x10) != 0) {
SslFreeObject(*(longlong *)(unaff_RBP + 0x10),0);
}
FUN_180028070(*(ulonglong *)(unaff_RBP + 0x60) ^ unaff_RBP);
return;
}
=========================================
Function at address: 0x18002cfe8
Called functions addresses: None


void FUN_18002cfe8(void)

{
undefined4 in_EAX;
ulonglong unaff_RBP;
longlong *unaff_RDI;

FUN_18005b470(unaff_RDI,0x323,in_EAX,0x33);
if (*(longlong *)(unaff_RBP + 0x18) != 0) {
SslFreeObject(*(longlong *)(unaff_RBP + 0x18),0);
}
if (*(longlong *)(unaff_RBP + 0x10) != 0) {
SslFreeObject(*(longlong *)(unaff_RBP + 0x10),0);
}
FUN_180028070(*(ulonglong *)(unaff_RBP + 0x60) ^ unaff_RBP);
return;
}
=========================================
Function at address: 0x18002d68a
Called functions addresses: 0x1800051b3


undefined8 FUN_18002d68a(void)

{
longlong lVar1;
undefined8 uVar2;
uint uVar3;
int unaff_ESI;
longlong unaff_RDI;
uint uVar4;
ulonglong in_R9;
undefined4 *in_R10;
uint in_R11D;

do {
uVar4 = (int)in_R9 + 1;
in_R9 = (ulonglong)uVar4;
if (in_R11D <= uVar4) {
uVar2 = FUN_1800051b3();
return uVar2;
}
uVar3 = 0;
uVar4 = *(uint *)(in_R9 * 0x20 + 8 + unaff_RDI);
} while (uVar4 == 0);
lVar1 = *(longlong *)(in_R9 * 0x20 + unaff_RDI);
do {
if (*(int *)((ulonglong)uVar3 * 0x30c + 0x304 + lVar1) == unaff_ESI) {
*in_R10 = *(undefined4 *)((ulonglong)uVar3 * 0x30c + 0x300 + lVar1);
return 0;
}
uVar3 = uVar3 + 1;
} while (uVar3 < uVar4);
uVar2 = FUN_18002d68a();
return uVar2;
}
=========================================
Function at address: 0x18002d884
Called functions addresses: 0x180041cb0 0x18005b470


void FUN_18002d884(longlong param_1)

{
longlong *unaff_RDI;
ulonglong in_stack_00000080;

FUN_180041cb0(*(undefined8 *)(param_1 + 0x10),0x1a,&DAT_180085810);
FUN_18005b470(unaff_RDI,400,0x80090326,10);
FUN_180028070(in_stack_00000080 ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x18002da9a
Called functions addresses: None


void FUN_18002da9a(void)

{
ulonglong in_stack_00000080;

FUN_180028070(in_stack_00000080 ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x18002dd40
Called functions addresses: 0x18005b470


void FUN_18002dd40(void)

{
undefined4 *puVar1;
int iVar2;
longlong in_RAX;
longlong lVar3;
longlong unaff_RBP;
undefined4 unaff_ESI;
longlong *unaff_RDI;
undefined4 unaff_R15D;

if (DAT_1800927ac != '\0') {
*(undefined4 *)(in_RAX + 0x18) = unaff_R15D;
*(ushort *)(in_RAX + 0x40) = *(ushort *)(in_RAX + 0x40) | 2;
}
lVar3 = unaff_RDI[0xa5] + 0x48;
RtlReleaseResource();
FUN_180006300(lVar3,*(byte **)(unaff_RDI[0xa5] + 0x170),(uint *)0x0);
iVar2 = FUN_1800087d0(lVar3,unaff_RDI,*(int *)(unaff_RBP + -0x45));
if (iVar2 == 0) {

if (iVar2 == 0) {
*(undefined *)((longlong)unaff_RDI + 0x154) = 0;

if (unaff_RDI[0x6e] != 0) {

unaff_RDI[0x6e] = 0;
}
puVar1 = *(undefined4 **)(unaff_RBP + -0x39);
*(undefined4 *)(unaff_RDI + 0x6d) = 0;
*puVar1 = unaff_ESI;
}
}
else {
FUN_18005b470(unaff_RDI,0x6b,iVar2,0x28);
}
FUN_180028070(*(ulonglong *)(unaff_RBP + 0x17) ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x18002de02
Called functions addresses: None


ulonglong FUN_18002de02(undefined8 param_1,undefined8 param_2,uint param_3,byte *param_4)

{
longlong unaff_RBX;
int in_R10D;

if (in_R10D != 1) {
if (in_R10D != 2) {
if (in_R10D != 3) {
if (in_R10D != 4) {
if (in_R10D != 5) {
if (in_R10D != 6) {
if (in_R10D != 7) goto LAB_18000640c;
param_3 = param_3 * 0x25 + (uint)*param_4;
param_4 = param_4 + 1;
}
param_3 = param_3 * 0x25 + (uint)*param_4;
param_4 = param_4 + 1;
}
param_3 = param_3 * 0x25 + (uint)*param_4;
param_4 = param_4 + 1;
}
param_3 = param_3 * 0x25 + (uint)*param_4;
param_4 = param_4 + 1;
}
param_3 = param_3 * 0x25 + (uint)*param_4;
param_4 = param_4 + 1;
}
param_3 = param_3 * 0x25 + (uint)*param_4;
param_4 = param_4 + 1;
}
param_3 = param_3 * 0x25 + (uint)*param_4;
LAB_18000640c:
return (ulonglong)param_3 % (ulonglong)*(uint *)(unaff_RBX + 0x10);
}
=========================================
Function at address: 0x18002e97b
Called functions addresses: 0x18002a7c0


undefined8
FUN_18002e97b(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
undefined param_5,undefined param_6,undefined param_7,undefined param_8,
undefined param_9,undefined param_10,undefined8 param_11)

{
undefined4 in_R10D;
longlong *in_R11;
longlong unaff_R13;
undefined4 *in_stack_000000d0;

if ((unaff_R13 != 0) && (unaff_R13 != *in_R11)) {

in_R10D = 0;
}
*in_stack_000000d0 = in_R10D;
return 0x80090308;
}
=========================================
Function at address: 0x18002fe39
Called functions addresses: 0x180003ce4 0x18005a2a4 0x180041cb0 0x1800209bc 0x180044bcc 0x18005b470 0x18005c318 0x1800432ec 0x180003d20 0x18005a1f4


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_18002fe39(wchar_t *param_1,undefined8 param_2,longlong param_3)

{
int *piVar1;
wchar_t *pwVar2;
byte bVar3;
wchar_t wVar4;
undefined4 uVar5;
longlong lVar6;
undefined4 uVar7;
undefined4 uVar8;
undefined4 uVar9;
wchar_t *pwVar10;
undefined8 uVar11;
char cVar12;
int iVar13;
int iVar14;
undefined4 uVar15;
uint uVar16;
ulonglong uVar17;
longlong lVar18;
longlong *plVar19;
ulonglong uVar20;
undefined4 *puVar21;
longlong lVar22;
uint uVar23;
byte *pbVar24;
byte bVar25;
undefined2 uVar26;
longlong *unaff_RBX;
wchar_t *unaff_RBP;
uint *puVar27;
uint *puVar28;
wchar_t *unaff_RSI;
uint unaff_EDI;
longlong *plVar29;
undefined8 *puVar30;
uint *_Size;
char *pcVar31;
uint unaff_R12D;
byte *pbVar32;
longlong unaff_R13;
byte *pbVar33;
byte *unaff_R14;
byte *pbVar34;
undefined4 extraout_XMM0_Da;
undefined4 extraout_XMM0_Da_00;
byte in_stack_00000060;
char in_stack_00000061;
char in_stack_00000062;
int in_stack_00000064;
longlong in_stack_00000068;
uint in_stack_00000070;
int in_stack_00000074;
longlong *in_stack_00000078;

code_r0x00018002fe39:
param_1 = param_1 + -1;
LAB_18001b678:
*param_1 = L'\0';
uVar16 = *unaff_R14 + 1;
if (uVar16 <= unaff_EDI) {
in_stack_00000070 = unaff_EDI - uVar16;
unaff_R14 = unaff_R14 + uVar16;
puVar30 = DAT_180091000;
LAB_18001b211:
uVar17 = (ulonglong)in_stack_00000060;
do {
if (((undefined8 **)puVar30 != &DAT_180091000) &&
((*(byte *)((longlong)puVar30 + 0x1c) & 4) != 0)) {
param_1 = (wchar_t *)puVar30[2];
pcVar31 = "strict";
if ((char)uVar17 == '\0') {
pcVar31 = "all";
}
FUN_18005a1f4(param_1,uVar17,param_3,pcVar31,unaff_RBP);
uVar17 = (ulonglong)in_stack_00000060;
}
bVar25 = (byte)uVar17;
iVar14 = (int)unaff_R13;
if ((iVar14 != 0) && (unaff_RSI != (wchar_t *)0x0)) {
param_1 = (wchar_t *)(unaff_R13 * 5);
pwVar2 = unaff_RSI + unaff_R13 * 0x14;
pwVar10 = *(wchar_t **)(unaff_RBP + -0x28);
while (bVar25 = (byte)uVar17, pwVar10 < pwVar2) {
if ((*(uint *)(unaff_RSI + 8) & unaff_R12D) != 0) {
if (*(uint *)unaff_RSI == 0) {
LAB_18002fe9c:
bVar25 = (byte)uVar17;
if ((bVar25 == 0) || ((*(byte *)(unaff_RSI + 0x10) & 1) == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0xf,&DAT_180082b78,unaff_R12D);
bVar25 = in_stack_00000060;
}
puVar27 = *(uint **)(unaff_RBP + -0x38);
iVar13 = -0x7ff6fccf;
plVar19 = *(longlong **)(unaff_RBP + -0x40);
puVar28 = *(uint **)(unaff_RBP + -0x3c);
puVar30 = DAT_180091000;
goto LAB_18001b57a;
}
}
else if (*(longlong *)(unaff_RBP + -0x2c) != 0) {
param_1 = unaff_RSI;
uVar16 = FUN_18005c318((uint *)unaff_RSI,*(longlong *)(unaff_RBP + -0x2c));
uVar17 = (ulonglong)in_stack_00000060;
if ((char)uVar16 != '\0') goto LAB_18002fe9c;
}
}
unaff_RSI = unaff_RSI + 0x14;
pwVar10 = unaff_RSI;
}
}
bVar3 = *(byte *)(unaff_RBP + 0x23c);
_Size = *(uint **)(unaff_RBP + -0x10);
plVar19 = unaff_RBX;
uVar17 = FUN_18001c410(param_1,unaff_RBX,_Size,*(uint *)(unaff_RBP + -0x30),bVar3,
*(longlong *)(unaff_RBP + -0x2c),bVar25,&stack0x00000078,
(longlong *)(unaff_RBP + -0x38),&stack0x00000074,&stack0x00000062);
iVar13 = (int)uVar17;
if (iVar13 == 0) {
if (bVar3 == 0) {
if (in_stack_00000060 != 0) {
plVar19 = *(longlong **)(unaff_RBP + -0x40);
if (plVar19 != (longlong *)0x0) goto LAB_18002ff8b;
puVar28 = *(uint **)(unaff_RBP + -0x38);
in_stack_00000068 = *(longlong *)(unaff_RBP + -0x34);
*(longlong **)(unaff_RBP + -0x40) = in_stack_00000078;
*(uint **)(unaff_RBP + -0x3c) = puVar28;
in_stack_00000061 = in_stack_00000062;
in_stack_00000064 = in_stack_00000074;
plVar19 = in_stack_00000078;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180085700);
goto LAB_18002ff82;
}
goto LAB_18001b55a;
}
puVar28 = *(uint **)(unaff_RBP + -0x38);
in_stack_00000061 = in_stack_00000062;
LAB_18001b85a:
puVar27 = puVar28;
if (in_stack_00000061 == '\0') goto LAB_18001b862;
}
LAB_18001b2c8:
plVar19 = in_stack_00000078;
iVar14 = 0;
if (in_stack_00000078[0x6a] != 0) {
LOCK();
piVar1 = (int *)(*(longlong *)(in_stack_00000078[0x6a] + 0x10) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
}
LOCK();
*(int *)(in_stack_00000078[0x6b] + 0xc) = *(int *)(in_stack_00000078[0x6b] + 0xc) + 1;
UNLOCK();

lVar22 = unaff_RBX[1];
if (lVar22 != 0) {
if (*(longlong *)(lVar22 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar22 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar22 + 0x358));
}
if ((longlong *)unaff_RBX[3] != (longlong *)0x0) {
FUN_1800209bc((longlong *)unaff_RBX[3]);
unaff_RBX[3] = 0;
}
plVar29 = in_stack_00000078;
if (lVar18 == 0) goto LAB_18001b39e;
lVar22 = *in_stack_00000078;
RtlAcquireResourceShared(lVar18 + 0x228,1);
_Size = (uint *)0x0;
if (*(uint *)(lVar18 + 0x60) == 0) goto LAB_18001b388;
goto LAB_18001b362;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
pcVar31 = "strict";
if (in_stack_00000060 == 0) {
pcVar31 = "all";
}
FUN_18005a2a4(DAT_180091000[2],plVar19,_Size,pcVar31,unaff_RBP);
}
LAB_18002ff82:
plVar19 = *(longlong **)(unaff_RBP + -0x40);
LAB_18002ff8b:
puVar28 = *(uint **)(unaff_RBP + -0x3c);
LAB_18001b55a:
puVar30 = DAT_180091000;
puVar27 = (uint *)0x0;
in_stack_00000078 = (longlong *)0x0;
unaff_RBP[-0x38] = L'\0';
unaff_RBP[-0x37] = L'\0';
unaff_RBP[-0x36] = L'\0';
unaff_RBP[-0x35] = L'\0';
in_stack_00000074 = 0;
in_stack_00000062 = '\0';
bVar25 = in_stack_00000060;
LAB_18001b57a:
uVar11 = _DAT_180083d10;
if ((iVar14 == 0) ||
((in_stack_00000070 == 0 && ((plVar19 == (longlong *)0x0 || (bVar25 == 0)))))) {
_Size = puVar28;
if (iVar13 != 0) {
if (plVar19 != (longlong *)0x0) {
*(uint **)(unaff_RBP + -0x38) = puVar28;
*(longlong *)(unaff_RBP + -0x34) = in_stack_00000068;
in_stack_00000062 = in_stack_00000061;
in_stack_00000074 = in_stack_00000064;
in_stack_00000078 = plVar19;
if (((undefined8 **)puVar30 != &DAT_180091000) &&
((*(byte *)((longlong)puVar30 + 0x1c) & 4) != 0)) {
_Size = (uint *)&DAT_180085700;
FUN_180041cb0(puVar30[2],0x1f,&DAT_180085700);
}
goto LAB_18001b85a;
}
if ((unaff_RBX[0x79] == 0) || (*(short *)(unaff_RBX[0x79] + 4) == 0)) {
if ((iVar13 == -0x7ff6fccf) &&
((FUN_180044bcc(*(uint *)(*(longlong *)(unaff_RBP + -0x1c) + 0xd4),
*(longlong *)(unaff_RBP + -0x1c) + 0xd8,unaff_R12D),
(undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)))) {
FUN_180041cb0(DAT_180091000[2],0x22,&DAT_180085700);
}
break;
}
if (iVar14 == 0) {
if (((undefined8 **)puVar30 == &DAT_180091000) ||
((*(byte *)((longlong)puVar30 + 0x1c) & 1) == 0)) goto LAB_180030083;
uVar26 = 0x21;
}
else {
if (((undefined8 **)puVar30 == &DAT_180091000) ||
((*(byte *)((longlong)puVar30 + 0x1c) & 4) == 0)) goto LAB_180030083;
uVar26 = 0x20;
}
FUN_180041cb0(puVar30[2],uVar26,&DAT_180085700);
goto LAB_180030083;
}
LAB_18001b862:
in_stack_00000068 = 0;

if (in_stack_00000068 != 0) {
RtlAcquireResourceExclusive(in_stack_00000068 + 0x48,1);
lVar22 = *(longlong *)(unaff_RBP + -0x1c);
*(uint **)(in_stack_00000068 + 0x150) = puVar27;
*(undefined8 *)(in_stack_00000068 + 0xbc) = *(undefined8 *)(lVar22 + 0x2f8);
RtlReleaseResource(in_stack_00000068 + 0x48);
goto LAB_18001b2c8;
}
break;
}
unaff_RSI = *(wchar_t **)(unaff_RBP + -0x28);
param_1 = unaff_RBP + 7;
uVar17 = 0;
*(undefined4 *)(unaff_RBP + 4) = DAT_180083d18;
param_3 = 0x1f2;
unaff_RBP[6] = DAT_180083d1c;
*(undefined8 *)unaff_RBP = uVar11;
memset(param_1,0,0x1f2);
unaff_EDI = in_stack_00000070;
if ((*(longlong *)(unaff_RBP + -0x40) == 0) || (in_stack_00000060 == 0)) goto LAB_18001b208;
uVar17 = uVar17 & 0xffffffffffffff00;
in_stack_00000060 = 0;
} while( true );
}
goto LAB_18001b488;
LAB_18001b208:
if ((unaff_R14 == (byte *)0x0) || (in_stack_00000070 == 0)) goto LAB_18001b211;
*(byte **)(unaff_RBP + -0x34) = unaff_R14;
unaff_RBP[-0x16] = L'\0';
unaff_RBP[-0x15] = L'\0';
*(wchar_t **)(unaff_RBP + -0x2c) = unaff_RBP + -0x24;
if ((*(longlong *)(unaff_RBP + -0x20) == 0) ||
(bVar25 = *unaff_R14, in_stack_00000070 - 1 < (uint)bVar25)) goto LAB_18001b488;
unaff_RBP[-0x18] = (ushort)bVar25;
unaff_RBP[-0x17] = (ushort)bVar25;
*(byte **)(unaff_RBP + -0x14) = unaff_R14 + 1;
uVar15 = RtlAnsiStringToUnicodeString(unaff_RBP + -0x24,unaff_RBP + -0x18,0);
iVar14 = RtlNtStatusToDosError(uVar15);
if (iVar14 != 0) goto LAB_18001b488;
wVar4 = unaff_RBP[-0x24];
lVar22 = 0x200;
param_3 = *(longlong *)(unaff_RBP + -0x20) - (longlong)unaff_RBP;
param_1 = unaff_RBP;
while (((ulonglong)(ushort)wVar4 - 0x200) + lVar22 != 0) {
if (*(wchar_t *)(param_3 + (longlong)param_1) == L'\0') {
if (lVar22 == 0) goto code_r0x00018002fe39;
break;
}
*param_1 = *(wchar_t *)(param_3 + (longlong)param_1);
param_1 = param_1 + 1;
lVar22 = lVar22 + -1;
if (lVar22 == 0) {
FUN_18002fe39(param_1,0,param_3);
return;
}
}
goto LAB_18001b678;
while (uVar16 = (int)_Size + 1, _Size = (uint *)(ulonglong)uVar16,
uVar16 < *(uint *)(lVar18 + 0x60)) {
LAB_18001b362:
lVar6 = *(longlong *)(*(longlong *)(lVar18 + 0x58) + (longlong)_Size * 8);
if (*(longlong *)(lVar6 + 0x10) == lVar22) {
LOCK();
piVar1 = (int *)(lVar6 + 0x18);
*piVar1 = *piVar1 + 1;
UNLOCK();
unaff_RBX[3] = *(longlong *)(*(longlong *)(lVar18 + 0x58) + (longlong)_Size * 8);
plVar29 = in_stack_00000078;
break;
}
}
LAB_18001b388:
RtlReleaseResource(lVar18 + 0x228);
LAB_18001b39e:
uVar17 = 0;
if ((*(uint *)(unaff_RBX + 8) & 0xf3f00) == 0) {
uVar16 = *(uint *)((longlong)plVar29 + 0xc);
uVar15 = *(undefined4 *)(plVar29 + 2);
unaff_RBP[-0xc] = L'\x14';
unaff_RBP[-0xb] = L'\0';
unaff_RBP[-10] = L'\0';
unaff_RBP[-9] = L'\0';
unaff_RBP[-6] = L'\0';
unaff_RBP[-5] = L'\0';
unaff_RBP[-4] = L'\0';
unaff_RBP[-3] = L'\0';
*(undefined4 *)(unaff_RBP + -8) = uVar15;
if (1 < uVar16) {
*(uint *)(unaff_RBP + -4) = *(uint *)(unaff_RBP + -4) | 1;
*(uint *)(unaff_RBP + -6) = uVar16;
}
LAB_18001b3e3:
if ((*(byte *)(unaff_RBX + 4) & 1) != 0) {
_Size = (uint *)0x14;
lVar22 = RtlCompareMemory(unaff_RBP + -0xc,unaff_RBX + 5);
if (lVar22 != 0x14) {
*(ushort *)(unaff_RBX + 4) = *(ushort *)(unaff_RBX + 4) | 1;
unaff_RBX[1] = (longlong)plVar29;
goto LAB_18001b488;
}
}
uVar15 = *(undefined4 *)(unaff_RBP + -0xc);
uVar7 = *(undefined4 *)(unaff_RBP + -10);
uVar8 = *(undefined4 *)(unaff_RBP + -8);
uVar9 = *(undefined4 *)(unaff_RBP + -6);
uVar5 = *(undefined4 *)(unaff_RBP + -4);
*(undefined4 *)(unaff_RBX + 5) = uVar15;
*(undefined4 *)((longlong)unaff_RBX + 0x2c) = uVar7;
*(undefined4 *)(unaff_RBX + 6) = uVar8;
*(undefined4 *)((longlong)unaff_RBX + 0x34) = uVar9;
*(undefined4 *)(unaff_RBX + 7) = uVar5;
}
else {
_Size = (uint *)(ulonglong)*(uint *)((longlong)plVar29 + 0x1c);
iVar14 = SslLookupCipherLengths
(*plVar29,*(undefined2 *)((longlong)unaff_RBX + 0x22),_Size,
*(undefined4 *)(unaff_RBX + 2),unaff_RBP + -0xc);
uVar15 = extraout_XMM0_Da;
if (iVar14 == 0) goto LAB_18001b3e3;
}
cVar12 = in_stack_00000062;
*(ushort *)(unaff_RBX + 4) = *(ushort *)(unaff_RBX + 4) | 1;
unaff_RBX[1] = (longlong)plVar29;
if (iVar14 == 0) {
if (((*(char *)(unaff_RBP + 0x23c) == '\0') && (*(int *)(plVar29 + 6) == 3)) ||
(uVar16 = *(uint *)(unaff_RBP + 0x238), (uVar16 >> 0xc & 1) != 0)) {
*(int *)(unaff_RBX + 2) = in_stack_00000074;
plVar19 = (longlong *)plVar19[0x6a];
if (plVar19 != (longlong *)0x0) {
uVar16 = *(uint *)(plVar19 + 1);
_Size = (uint *)(ulonglong)uVar16;
if (uVar16 != 0) {
do {
if (*(int *)(uVar17 * 0x30c + 0x304 + *plVar19) == in_stack_00000074) {
lVar22 = uVar17 * 0x30c + *plVar19;
if (lVar22 != 0) {
*(undefined4 *)((longlong)unaff_RBX + 0x14) = *(undefined4 *)(lVar22 + 0x308);
}
break;
}
uVar23 = (int)uVar17 + 1;
uVar17 = (ulonglong)uVar23;
} while (uVar23 < uVar16);
}
}
uVar16 = *(uint *)(unaff_RBP + 0x238);
}
if ((in_stack_00000062 == '\0') && ((uVar16 >> 0xc & 1) != 0)) {
_Size = (uint *)*plVar29;

if (iVar14 != 0) goto LAB_18001b488;
}
pbVar33 = *(byte **)(unaff_RBP + -0x34);
if (pbVar33 == (byte *)0x0) {
pbVar33 = (byte *)0x0;
LAB_18001b456:
if (cVar12 == '\0') {
if (*(char *)(unaff_RBP + 0x23c) == '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18003030b((longlong)DAT_180091000,pbVar33,_Size);
return;
}
goto LAB_18001b488;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001b488;
uVar26 = 0x24;
}
else {
*(undefined4 *)((longlong)unaff_RBX + 0x44) = 0x47;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001b488;
uVar26 = 0x23;
}
FUN_18005a04c(DAT_180091000[2],uVar26,_Size,*(undefined4 *)((longlong)plVar29 + 0x1c),
(wchar_t *)((longlong)plVar29 + 0x4a));
}
else if ((ushort)(*pbVar33 + 1) < 2) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar26 = 0x4a;
LAB_1800302c1:
FUN_180041cb0(DAT_180091000[2],uVar26,&DAT_180082c58);
}
}
else {
pbVar34 = pbVar33 + (ushort)(*pbVar33 + 1);
for (pbVar24 = pbVar33; pbVar24 < pbVar34; pbVar24 = pbVar24 + *pbVar24 + 1) {
if ((*pbVar24 == 0) || (pbVar34 <= pbVar24 + *pbVar24)) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18001b488;
uVar26 = 0x4c;
goto LAB_1800302c1;
}
}
lVar22 = unaff_RBX[0x62];
if (lVar22 != 0) {
pbVar24 = (byte *)(lVar22 + 6);
if (pbVar24 != (byte *)0x0) {
pbVar32 = pbVar24 + *(ushort *)(lVar22 + 4);
for (; pbVar24 < pbVar32; pbVar24 = pbVar24 + (ulonglong)*pbVar24 + 1) {
if (pbVar33 < pbVar34) {
uVar17 = (ulonglong)*pbVar24;
do {
if ((byte)uVar17 == *pbVar33) {
uVar20 = RtlCompareMemory(pbVar24 + 1,pbVar33 + 1,uVar17);
uVar17 = (ulonglong)*pbVar24;
if (uVar20 == uVar17) {
puVar21 = (undefined4 *)unaff_RBX[99];
if (puVar21 == (undefined4 *)0x0) {
puVar21 = (undefined4 *)

(extraout_XMM0_Da_00,0x108);
unaff_RBX[99] = (longlong)puVar21;
if (puVar21 == (undefined4 *)0x0) goto LAB_18001b488;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3d,&DAT_180082bd8);
puVar21 = (undefined4 *)unaff_RBX[99];
}
*puVar21 = 1;
pbVar33 = pbVar24 + 1;
*(undefined4 *)(unaff_RBX[99] + 4) = 2;
*(byte *)(unaff_RBX[99] + 8) = *pbVar24;
_Size = (uint *)(ulonglong)*pbVar24;
memcpy((void *)(unaff_RBX[99] + 9),pbVar33,(size_t)_Size);
goto LAB_18001b456;
}
}
pbVar33 = pbVar33 + (ulonglong)*pbVar33 + 1;
} while (pbVar33 < pbVar34);
pbVar33 = *(byte **)(unaff_RBP + -0x34);
}
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180082bd8);
}
LAB_180030083:
FUN_18005b470(unaff_RBX,0x4b8,0x80090367,0x78);
*(undefined4 *)((longlong)unaff_RBX + 0x44) = 0x60;
*(undefined2 *)(unaff_RBX + 0xc) = 0x7802;
}
}
}
LAB_18001b488:
RtlReleaseResource(&DAT_180092428);
if (unaff_RBX[0x79] != 0) {

unaff_RBX[0x79] = 0;
}
FUN_180028070(*(ulonglong *)(unaff_RBP + 0x200) ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x18003030b
Called functions addresses: 0x18005a04c


void FUN_18003030b(longlong param_1,undefined8 param_2,undefined8 param_3)

{
wchar_t *in_RAX;
longlong unaff_RBX;
longlong unaff_RBP;
longlong unaff_RDI;

FUN_18005a04c(*(undefined8 *)(param_1 + 0x10),0x25,param_3,*(undefined4 *)(unaff_RDI + 0x1c),
in_RAX);
RtlReleaseResource(&DAT_180092428);
if (*(longlong *)(unaff_RBX + 0x3c8) != 0) {

*(undefined8 *)(unaff_RBX + 0x3c8) = 0;
}
FUN_180028070(*(ulonglong *)(unaff_RBP + 0x400) ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x180030595
Called functions addresses: 0x180041cdc 0x18005cc0c 0x18005a174 0x180041d20


undefined8
FUN_180030595(undefined8 param_1,undefined8 param_2,uint param_3,byte param_4,undefined4 param_5)

{
uint *puVar1;
BOOL BVar2;
int iVar3;
uint in_EAX;
undefined8 uVar4;
ushort uVar5;
wchar_t *_Str1;
uint *puVar6;
undefined *puVar7;
uint *unaff_RBX;
uint uVar8;
ulonglong uVar9;
int *unaff_RBP;
uint uVar10;
wchar_t *unaff_RSI;
longlong unaff_RDI;
byte bVar11;
ulonglong uVar12;
uint unaff_R12D;
longlong unaff_R13;
uint *unaff_R14;
uint *unaff_R15;
int in_stack_00000040;
uint in_stack_00000048;
uint in_stack_00000090;
int in_stack_000000a0;
uint in_stack_000000a8;
longlong in_stack_000000b0;
char in_stack_000000d0;

uVar12 = (ulonglong)param_4;
if (in_EAX < param_3) {
LAB_18003059e:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"RSA",(char)param_3,1);
}
return 0;
}
LAB_18001bdb6:
do {
do {
do {
do {
unaff_RBP = unaff_RBP + 0xc;
uVar10 = (uint)unaff_RSI;
if ((int *)((ulonglong)unaff_RBX[5] * 0x30 + *(longlong *)(unaff_RBX + 6)) <= unaff_RBP) {
LAB_18001bad5:
do {
puVar6 = unaff_RBX;
unaff_RBX = puVar6 + 10;
if (unaff_R14 <= unaff_RBX) {
uVar4 = FUN_1800077a0(unaff_R15,unaff_R12D,4,(wchar_t *)(unaff_RDI + 0x90),unaff_RSI
,uVar10,(longlong)unaff_RSI,'\x01');
if ((char)uVar4 != '\0') {
return 0;
}
uVar4 = FUN_1800077a0(unaff_R15,unaff_R12D,4,(wchar_t *)(unaff_RDI + 0x110),
unaff_RSI,uVar10,(longlong)unaff_RSI,'\x01');
if ((char)uVar4 != '\0') {
return 0;
}
if (in_stack_000000b0 != 0) {
iVar3 = *(int *)(unaff_RDI + 0x84);
if (iVar3 == 0xa400) {
LAB_18001bb90:
in_stack_00000048 = 1;
uVar8 = in_stack_00000048;
}
else if (iVar3 == 0x2200) {
in_stack_00000048 = 2;
uVar8 = in_stack_00000048;
}
else {
if (iVar3 != 0x2203) {
if (iVar3 != 0x2400) {
return 0;
}
goto LAB_18001bb90;
}
uVar8 = 3;
}
bVar11 = 0;
puVar6 = &DAT_18007c3a8;
while (((((puVar6[1] != uVar8 || ((*puVar6 & in_stack_000000a8) == 0)) ||
((*(uint *)(unaff_RDI + 0x1ac) != 0 &&
(((uVar8 == 1 && (puVar6[9] == 8)) &&
(*(uint *)(unaff_RDI + 0x1ac) >> 3 <
(uint)*(byte *)(puVar6 + 8) * 2 + 2)))))) ||
((((in_stack_000000a8 & 0x3000) != 0 && (puVar6[1] == 3)) &&
(puVar6[10] != *(uint *)(unaff_RDI + 0x8c))))) ||
((0xb < bVar11 ||
(uVar5 = *(ushort *)(in_stack_000000b0 + 0x22),
(uVar5 >> (bVar11 & 0x1f) & 1) == 0))))) {
bVar11 = bVar11 + 1;
puVar1 = puVar6 + 0xc;
puVar6 = puVar6 + 0x12;
uVar8 = in_stack_00000048;
if (&UNK_18007c6ef < puVar1) {
return 0;
}
}
if ((short *)(unaff_RDI + 0x200) == (short *)0x0) {
return 2;
}
if (*(short *)(unaff_RDI + 0x200) == (short)unaff_RSI) {
return 2;
}
if (*(ushort *)(unaff_RDI + 0x222) == 0) {
return 2;
}
uVar8 = uVar10;
if ((uVar5 & DAT_180092808) != 0) {
uVar8 = (uint)DAT_180092808;
}
uVar5 = uVar5 | (ushort)uVar8;
uVar8 = uVar10;
if ((uVar5 & DAT_180092804) != 0) {
uVar8 = (uint)DAT_180092804;
}
uVar5 = uVar5 | (ushort)uVar8;
uVar8 = uVar10;
if ((uVar5 & DAT_180092800) != 0) {
uVar8 = (uint)DAT_180092800;
}
if (((uint)*(ushort *)(unaff_RDI + 0x222) & ~(uVar5 | uVar8)) != 0) {
return 2;
}
}
if (*(longlong *)(unaff_RDI + 0x20) == 0) {
return 2;
}
if (in_stack_00000040 != 0x2400) goto LAB_18001bd16;
if (in_stack_000000a0 == 0xae06) {
LAB_18001bcb1:
uVar8 = 0x80;
}
else {
if (in_stack_000000a0 != 0xa400) {
if (in_stack_000000a0 != 0xaa02) goto LAB_18001bd16;
goto LAB_18001bcb1;
}
uVar8 = 0x20;
}
in_stack_00000090 = uVar10;
BVar2 = CertGetIntendedKeyUsage
(0x10001,*(PCERT_INFO *)(*(longlong *)(unaff_RDI + 0x20) + 0x18),
(BYTE *)&stack0x00000090,4);
if (BVar2 != 0) {
if ((uVar8 & in_stack_00000090) != 0) {
uVar10 = 1;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041d20(DAT_180091000[2],0x14,&DAT_180082b78,in_stack_00000090,(char)uVar8
);
}
if (uVar10 == 0) {
return 2;
}
}
LAB_18001bd16:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2e,&DAT_180082ba8,in_stack_00000040);
}
return 1;
}
} while (puVar6[0xf] == uVar10);
if (uVar10 < *unaff_RBX) {
if (unaff_R13 != 0) {
uVar9 = (ulonglong)unaff_RSI & 0xffffffff;
do {
iVar3 = RtlCompareUnicodeString(uVar9 * 0x10 + *(longlong *)(puVar6 + 0xc));
if (iVar3 == 0) goto LAB_18001bd7f;
uVar8 = (int)uVar9 + 1;
uVar9 = (ulonglong)uVar8;
} while (uVar8 < *unaff_RBX);
}
goto LAB_18001bad5;
}
LAB_18001bd7f:
if (((in_stack_000000d0 != (char)unaff_RSI) && ((*(byte *)(puVar6 + 0x12) & 1) != 0)) ||
(unaff_RBP = *(int **)(puVar6 + 0x10),
unaff_RBP + (ulonglong)puVar6[0xf] * 0xc <= unaff_RBP)) goto LAB_18001bad5;
}
} while ((*unaff_RBP != 1) || (*(short *)(unaff_RBP + 2) != 6));
_Str1 = *(wchar_t **)(unaff_RBP + 4);
puVar7 = &DAT_1800822a0;
iVar3 = wcsncmp(_Str1,L"RSA",3);
} while (iVar3 != 0);
if (((unaff_RBP[6] == uVar10) && (unaff_RBP[10] == uVar10)) && (unaff_RBP[0xb] == uVar10)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0;
}
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"RSA",1);
return 0;
}
} while (in_stack_00000090 == 0);
if (unaff_RBP[10] != 0) {
param_3 = in_stack_00000090;
if (in_stack_00000090 < (uint)unaff_RBP[10]) goto LAB_18003059e;
if (unaff_RBP[0xb] != 0) {
uVar4 = FUN_180030595(_Str1,puVar7,in_stack_00000090,(char)uVar12,param_5);
return uVar4;
}
goto LAB_18001bdb6;
}
if (uVar10 < (uint)unaff_RBP[0xb]) {
uVar4 = FUN_180030595(_Str1,puVar7,in_stack_00000090,(char)uVar12,param_5);
return uVar4;
}
} while( true );
}
=========================================
Function at address: 0x180030871
Called functions addresses: 0x180075c88 0x180002a40 0x18005b470


/* WARNING: Removing unreachable block (ram,0x00018001c1cb) */
/* WARNING: Removing unreachable block (ram,0x00018001c1d4) */
/* WARNING: Removing unreachable block (ram,0x0001800308c5) */
/* WARNING: Removing unreachable block (ram,0x0001800308eb) */
/* WARNING: Removing unreachable block (ram,0x00018001c1e0) */
/* WARNING: Removing unreachable block (ram,0x00018001c1ed) */
/* WARNING: Removing unreachable block (ram,0x0001800308bd) */
/* WARNING: Removing unreachable block (ram,0x00018001c1fe) */
/* WARNING: Removing unreachable block (ram,0x00018001c201) */
/* WARNING: Removing unreachable block (ram,0x00018001c231) */
/* WARNING: Removing unreachable block (ram,0x00018003089d) */
/* WARNING: Removing unreachable block (ram,0x0001800308a4) */

void FUN_180030871(void)

{
int iVar1;
undefined8 uVar2;
longlong *unaff_RBP;
uint uVar3;
int unaff_ESI;
PUCHAR pUVar4;
ULONG UVar5;
uint in_R9D;
undefined2 unaff_R12W;
int unaff_R13D;
int unaff_R14D;
byte unaff_R15B;
byte in_stack_00000040;
UCHAR UStack0000000000000044;
byte in_stack_00000048;
int in_stack_0000004c;
int in_stack_00000058;
int in_stack_0000005c;
int iStack0000000000000060;
uint *in_stack_00000068;
longlong in_stack_00000070;
void *in_stack_00000078;
ulonglong in_stack_000000c0;

if (in_R9D < 0x8d) {
in_R9D = 0x8c;
}
uVar3 = unaff_ESI + in_R9D;
if (_iStack0000000000000060 == (PUCHAR)0x0) {
*in_stack_00000068 = uVar3;
goto LAB_18001c262;
}
if (*in_stack_00000068 < uVar3) {
*in_stack_00000068 = uVar3;
goto LAB_18001c262;
}
iVar1 = FUN_180001604(*(longlong *)(unaff_RBP[10] + 0x2f0),&stack0x0000005c);
if (iVar1 == 0) {
*_iStack0000000000000060 = '\x03';
pUVar4 = _iStack0000000000000060 + 4;
_iStack0000000000000060[1] = (UCHAR)((uint)*(undefined4 *)(unaff_RBP + 2) >> 8);
_iStack0000000000000060[2] = *(UCHAR *)(unaff_RBP + 2);
if ((*(byte *)((longlong)unaff_RBP + 0x14) & 8) == 0) {
if (*(uint *)(in_stack_00000070 + 4) < 0x80) {
in_stack_00000040 = (char)*(uint *)(in_stack_00000070 + 4) * '\x02' + 1;
if (pUVar4 != (PUCHAR)0x0) {
if (unaff_R15B < in_stack_00000040) {
unaff_R14D = -0x7ff6fcdf;
}
else {
*pUVar4 = '\x04';
memcpy(_iStack0000000000000060 + 5,(void *)(in_stack_00000070 + 8),
(ulonglong)in_stack_00000040 - 1);
}
}
}
else {
unaff_R14D = 0x54f;
in_stack_00000040 = in_stack_00000048;
}
}
else {
uVar2 = FUN_180002a40(in_stack_00000070,pUVar4,&stack0x00000040);
unaff_R14D = (int)uVar2;
}
if (unaff_R14D == 0) {
_iStack0000000000000060[3] = in_stack_00000040;
uVar3 = uVar3 + (-4 - (uint)in_stack_00000040);
pUVar4 = _iStack0000000000000060 + (ulonglong)(in_stack_00000040 + 1) + 3;
UVar5 = (int)pUVar4 - iStack0000000000000060;
if ((*(uint *)(unaff_RBP + 8) & 0x40400) != 0) {
if (uVar3 < 2) goto LAB_18001c3e3;
*(undefined2 *)pUVar4 = unaff_R12W;
pUVar4 = pUVar4 + 2;
uVar3 = uVar3 - 2;
}
_UStack0000000000000044 = uVar3 - 2;
if (unaff_R13D == 1) {
iVar1 = FUN_18001a450(unaff_RBP,_iStack0000000000000060,UVar5,in_stack_00000078,
in_stack_0000004c,in_stack_00000058,pUVar4 + 2,
(undefined4 *)&stack0x00000044);
LAB_18001c3b4:
if (iVar1 != 0) goto LAB_18001c3e3;
}
else if (unaff_R13D == 3) {
iVar1 = FUN_180075c88(unaff_RBP,_iStack0000000000000060,UVar5,in_stack_0000004c,pUVar4 + 2,
(uint *)&stack0x00000044);
goto LAB_18001c3b4;
}
*pUVar4 = (UCHAR)(_UStack0000000000000044 >> 8);
pUVar4[1] = UStack0000000000000044;
*in_stack_00000068 = _UStack0000000000000044 + 2 + ((int)pUVar4 - iStack0000000000000060);
}
}
LAB_18001c3e3:
if (in_stack_0000005c != 0) {
RevertToSelf();
}
LAB_18001c262:
FUN_180028070(in_stack_000000c0 ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x180030a4e
Called functions addresses: 0x18005a0dc


ulonglong FUN_180030a4e(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined param_4,
undefined4 param_5,byte param_6,byte param_7,byte param_8,undefined param_9,
undefined param_10,char param_11)

{
uint *puVar1;
uint uVar2;
uint uVar3;
uint *puVar4;
longlong *plVar5;
ulonglong uVar6;
undefined8 *unaff_RBX;
longlong unaff_RBP;
undefined *puVar7;
undefined *unaff_RSI;
undefined7 in_register_00000089;
undefined8 *in_R10;
undefined4 in_R11D;
byte unaff_R12B;
undefined8 *unaff_R13;
uint *unaff_R14;
longlong *unaff_R15;
uint in_stack_00000054;
uint in_stack_00000058;
int in_stack_0000005c;
int in_stack_00000060;
longlong in_stack_00000068;
undefined *in_stack_00000070;
longlong in_stack_00000078;
undefined *in_stack_00000080;
undefined in_stack_000000d8;
longlong in_stack_000000f8;
byte in_stack_00000100;
longlong *in_stack_00000110;
int *in_stack_00000118;
undefined *in_stack_00000120;

_param_8 = (undefined *)(ulonglong)param_8;
_param_7 = (int *)(ulonglong)param_7;
_param_6 = (longlong *)(ulonglong)param_6;
uVar3 = (uint)CONCAT71(in_register_00000089,param_4);
if (param_11 != '\0') goto LAB_18001c665;
if ((in_R10 != unaff_RBX) && ((*(byte *)((longlong)in_R10 + 0x1c) & 4) != 0)) {
param_1 = in_R10[2];
param_5._0_1_ = (undefined)in_R11D;
FUN_18005a0dc(param_1,0x27,param_3,(wchar_t *)(unaff_RSI + 0x4a),(char)param_3,
(undefined)param_5);
in_R10 = DAT_180091000;
param_5 = in_R11D;
}
LAB_18001c634:
uVar3 = 0x80090331;
puVar7 = unaff_RSI;
LAB_18001c639:
do {
unaff_RSI = puVar7 + 0x360;
if (in_stack_00000080 <= unaff_RSI) {
if (uVar3 != 0) {
if (in_stack_00000070 == (undefined *)0x0) {
*unaff_R13 = 0;
*in_stack_00000110 = 0;
*in_stack_00000118 = 0;
*in_stack_00000120 = 0;
}
else {
uVar3 = 0;
*unaff_R13 = in_stack_00000070;
*in_stack_00000110 = in_stack_00000078;
*in_stack_00000118 = in_stack_00000060;
*in_stack_00000120 = param_10;
}
}
goto LAB_18001c729;
}
uVar2 = *(uint *)(puVar7 + 0x37c);
in_stack_00000068 = 0;
in_stack_0000005c = 0;
in_stack_000000d8 = 0;
if ((uVar2 == 0) || (puVar1 = unaff_R14 + unaff_RBP, puVar4 = unaff_R14, puVar1 <= unaff_R14))
goto LAB_18001c624;
while (uVar2 != *puVar4) {
puVar4 = puVar4 + 1;
if (puVar1 <= puVar4) goto LAB_18001c624;
}
uVar3 = in_stack_00000058;
if ((unaff_R12B != 0) && (in_stack_00000054 != uVar2)) {
uVar6 = FUN_180030a4e(param_1,puVar1,(ulonglong)uVar2,(char)in_stack_00000058,param_5,param_6,
param_7,param_8,param_9,param_10,param_11);
return uVar6;
}
LAB_18001c665:
_param_8 = &stack0x000000d8;
_param_7 = &stack0x0000005c;
_param_6 = (longlong *)(ulonglong)uVar3;
param_5 = CONCAT31(param_5._1_3_,in_stack_00000100);
uVar3 = FUN_18001cbe0(param_1,unaff_R15,unaff_RSI,unaff_R12B,in_stack_000000f8,in_stack_00000100
,uVar3,_param_7,_param_8);
puVar7 = unaff_RSI;
in_R10 = DAT_180091000;
} while (uVar3 != 0);
if (*(int *)(unaff_RSI + 0x30) == 4) {
*unaff_R13 = unaff_RSI;
}
else {
_param_6 = &stack0x00000068;
param_5 = CONCAT31(param_5._1_3_,in_stack_00000100);
plVar5 = FUN_18001c7b0(param_1,unaff_R15,unaff_RSI,(ulonglong)unaff_R12B,in_stack_000000f8,
in_stack_00000100,_param_6);
uVar3 = (uint)plVar5;
if (uVar3 != 0) {
in_R10 = DAT_180091000;
if (((uVar3 == 0x80090331) && (in_stack_00000068 != 0)) &&
(in_stack_00000070 == (undefined *)0x0)) {
in_stack_00000078 = in_stack_00000068;
in_stack_00000060 = in_stack_0000005c;
param_10 = in_stack_000000d8;
in_stack_00000070 = unaff_RSI;
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar6 = FUN_180030ac4();
return uVar6;
}
goto LAB_18001c639;
}
*unaff_R13 = unaff_RSI;
*in_stack_00000110 = in_stack_00000068;
*in_stack_00000118 = in_stack_0000005c;
*in_stack_00000120 = in_stack_000000d8;
}
LAB_18001c729:
return (ulonglong)uVar3;
LAB_18001c624:
if (((undefined8 **)in_R10 != &DAT_180091000) && ((*(byte *)((longlong)in_R10 + 0x1c) & 4) != 0))
{
param_1 = in_R10[2];
FUN_180041d70(param_1,0x26,&DAT_180085700,(wchar_t *)(puVar7 + 0x3aa));
in_R10 = DAT_180091000;
}
goto LAB_18001c634;
}
=========================================
Function at address: 0x180030ac4
Called functions addresses: 0x180041d70


ulonglong FUN_180030ac4(void)

{
uint *puVar1;
uint uVar2;
uint *puVar3;
longlong *plVar4;
ulonglong uVar5;
undefined8 uVar6;
uint unaff_EBX;
longlong unaff_RBP;
undefined *puVar7;
undefined *unaff_RSI;
undefined8 *puVar8;
longlong in_R10;
byte unaff_R12B;
undefined8 *unaff_R13;
uint *unaff_R14;
longlong *unaff_R15;
undefined4 in_stack_00000028;
undefined uStack0000000000000030;
undefined uStack0000000000000038;
undefined uStack0000000000000040;
undefined in_stack_00000048;
undefined in_stack_00000050;
uint in_stack_00000054;
uint in_stack_00000058;
int iStack000000000000005c;
int in_stack_00000060;
longlong lStack0000000000000068;
undefined *in_stack_00000070;
longlong in_stack_00000078;
undefined *in_stack_00000080;
undefined1 in_stack_000000d0;
undefined uStack00000000000000d8;
longlong in_stack_000000f8;
byte in_stack_00000100;
longlong *in_stack_00000110;
int *in_stack_00000118;
undefined *in_stack_00000120;

uVar6 = *(undefined8 *)(in_R10 + 0x10);
FUN_180041d70(uVar6,0x28,&DAT_180085700,(wchar_t *)(unaff_RSI + 0x4a));
puVar8 = DAT_180091000;
LAB_18001c639:
do {
puVar7 = unaff_RSI;
unaff_RSI = puVar7 + 0x360;
if (in_stack_00000080 <= unaff_RSI) {
if (unaff_EBX != 0) {
if (in_stack_00000070 == (undefined *)0x0) {
*unaff_R13 = 0;
*in_stack_00000110 = 0;
*in_stack_00000118 = 0;
*in_stack_00000120 = 0;
}
else {
unaff_EBX = 0;
*unaff_R13 = in_stack_00000070;
*in_stack_00000110 = in_stack_00000078;
*in_stack_00000118 = in_stack_00000060;
*in_stack_00000120 = in_stack_00000050;
}
}
LAB_18001c729:
return (ulonglong)unaff_EBX;
}
uVar2 = *(uint *)(puVar7 + 0x37c);
lStack0000000000000068 = 0;
iStack000000000000005c = 0;
uStack00000000000000d8 = 0;
if ((uVar2 != 0) && (puVar1 = unaff_R14 + unaff_RBP, puVar3 = unaff_R14, unaff_R14 < puVar1)) {
do {
if (uVar2 == *puVar3) {
if ((unaff_R12B != 0) && (in_stack_00000054 != uVar2)) {
uVar5 = FUN_180030a4e(uVar6,puVar1,(ulonglong)uVar2,(char)in_stack_00000058,
in_stack_00000028,uStack0000000000000030,uStack0000000000000038,
uStack0000000000000040,in_stack_00000048,in_stack_00000050,
in_stack_000000d0);
return uVar5;
}
_uStack0000000000000040 = &stack0x000000d8;
_uStack0000000000000038 = &stack0x0000005c;
_uStack0000000000000030 = (longlong *)(ulonglong)in_stack_00000058;
in_stack_00000028 = CONCAT31(in_stack_00000028._1_3_,in_stack_00000100);
unaff_EBX = FUN_18001cbe0(uVar6,unaff_R15,unaff_RSI,unaff_R12B,in_stack_000000f8,
in_stack_00000100,in_stack_00000058,_uStack0000000000000038,
_uStack0000000000000040);
puVar8 = DAT_180091000;
if (unaff_EBX != 0) goto LAB_18001c639;
if (*(int *)(puVar7 + 0x390) == 4) {
*unaff_R13 = unaff_RSI;
goto LAB_18001c729;
}
_uStack0000000000000030 = &stack0x00000068;
in_stack_00000028 = CONCAT31(in_stack_00000028._1_3_,in_stack_00000100);
plVar4 = FUN_18001c7b0(uVar6,unaff_R15,unaff_RSI,(ulonglong)unaff_R12B,in_stack_000000f8,
in_stack_00000100,_uStack0000000000000030);
unaff_EBX = (uint)plVar4;
if (unaff_EBX == 0) {
*unaff_R13 = unaff_RSI;
*in_stack_00000110 = lStack0000000000000068;
*in_stack_00000118 = iStack000000000000005c;
*in_stack_00000120 = uStack00000000000000d8;
goto LAB_18001c729;
}
puVar8 = DAT_180091000;
if (((unaff_EBX == 0x80090331) && (lStack0000000000000068 != 0)) &&
(in_stack_00000070 == (undefined *)0x0)) {
in_stack_00000078 = lStack0000000000000068;
in_stack_00000060 = iStack000000000000005c;
in_stack_00000050 = uStack00000000000000d8;
in_stack_00000070 = unaff_RSI;
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar5 = FUN_180030ac4();
return uVar5;
}
goto LAB_18001c639;
}
puVar3 = puVar3 + 1;
} while (puVar3 < puVar1);
}
if (((undefined8 **)puVar8 != &DAT_180091000) && ((*(byte *)((longlong)puVar8 + 0x1c) & 4) != 0)
) {
uVar6 = puVar8[2];
FUN_180041d70(uVar6,0x26,&DAT_180085700,(wchar_t *)(puVar7 + 0x3aa));
puVar8 = DAT_180091000;
}
unaff_EBX = 0x80090331;
} while( true );
}
=========================================
Function at address: 0x180030b7a
Called functions addresses: 0x180041cb0


undefined4 FUN_180030b7a(longlong param_1)

{
undefined4 unaff_ESI;

FUN_180041cb0(*(undefined8 *)(param_1 + 0x10),0x35,&DAT_180085700);
return unaff_ESI;
}
=========================================
Function at address: 0x180030ea4
Called functions addresses: 0x180078054


void FUN_180030ea4(longlong param_1)

{
undefined *unaff_RBP;
ushort unaff_SI;

FUN_180078054(param_1,unaff_RBP,unaff_SI);
return;
}
=========================================
Function at address: 0x180031341
Called functions addresses: 0x18006fe4c 0x180041e9c


void FUN_180031341(int param_1,uint param_2)

{
int *piVar1;
undefined4 uVar2;
longlong *plVar3;
ulonglong uVar4;
code *pcVar5;
undefined4 uVar6;
undefined4 uVar7;
undefined4 uVar8;
byte bVar9;
char cVar10;
int iVar11;
NTSTATUS NVar12;
longlong lVar13;
longlong lVar14;
longlong *plVar15;
undefined8 *puVar16;
longlong lVar17;
longlong *plVar18;
undefined uVar19;
uint uVar20;
byte *pbVar22;
byte *unaff_RBX;
longlong unaff_RBP;
byte unaff_SIL;
longlong *plVar23;
longlong *plVar24;
uint uVar25;
longlong *unaff_RDI;
undefined uVar26;
uint *puVar27;
ulonglong uVar28;
longlong *in_R8;
byte bVar29;
longlong in_R9;
longlong *unaff_R12;
byte *unaff_R13;
longlong *unaff_R14;
byte *unaff_R15;
undefined auStackX_8 [24];
undefined uStack0000000000000028;
undefined3 uStack0000000000000029;
undefined in_stack_00000030;
undefined in_stack_00000038;
undefined in_stack_00000040;
uint in_stack_00000044;
undefined uStack0000000000000048;
undefined4 in_stack_0000004c;
undefined uStack0000000000000050;
byte *in_stack_00000060;
longlong in_stack_00000068;
longlong in_stack_00000070;
undefined8 in_stack_00000078;
byte *pbVar21;

pbVar22 = (byte *)(ulonglong)param_2;
if (param_2 <= param_1 - 1U) goto LAB_18001d8ba;
do {
if ((uint)unaff_RDI == (uint)*(ushort *)(unaff_RBX + 0xee)) {
pbVar22 = unaff_RBX + 0xf0;
in_R8 = unaff_RDI;
iVar11 = memcmp((void *)(unaff_RBP + 0x130),pbVar22,(size_t)unaff_RDI);
if ((iVar11 == 0) && (*(int *)(unaff_RBX + 0x110) == _uStack0000000000000048)) {
*(undefined8 *)(unaff_RBP + -0x80) = *(undefined8 *)(unaff_R14[10] + 0x2f8);
in_R9 = unaff_RBP + -0x80;
in_R8 = (longlong *)0x0;
pbVar22 = (byte *)0x0;

(unaff_RBX,0,0,in_R9,*(undefined4 *)(unaff_R14 + 8));
if (cVar10 != '\0') {
LOCK();
pbVar21 = unaff_RBX + 0xe8;
iVar11 = *(int *)pbVar21;
*(int *)pbVar21 = *(int *)pbVar21 + 1;
UNLOCK();
uVar25 = iVar11 + 1;
plVar15 = (longlong *)(ulonglong)uVar25;
if (uVar25 == 2) {
LsaIModifyPerformanceCounter(iVar11 + 4);
RtlReleaseResource(unaff_RBX + 0x48);
LAB_18001d4b3:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],10,&DAT_180082b48,unaff_RBX);
}
if (uVar25 == 2) {
pbVar22 = unaff_RBX + 0x140;
lVar17 = *(longlong *)pbVar22;
plVar24 = plVar15;
if ((*(byte **)(lVar17 + 8) != pbVar22) ||
(plVar18 = *(longlong **)(unaff_RBX + 0x148), (byte *)*plVar18 != pbVar22))
goto LAB_18001da84;
*plVar18 = lVar17;
*(longlong **)(lVar17 + 8) = plVar18;
}
pbVar22 = (byte *)0x0;
in_R8 = (longlong *)0x0;
LsaIModifyPerformanceCounter(9);
}
else {
RtlReleaseResource(unaff_RBX + 0x48);
if (uVar25 != 0) goto LAB_18001d4b3;
unaff_RBX = *(byte **)(unaff_RBP + -0x80);
}
RtlReleaseResource(in_stack_00000078);
if ((int)uVar25 < 1) {
unaff_R14[0x7c] = 0;
}
else {
unaff_R14[0x7c] = (longlong)unaff_RBX;
}
*in_stack_00000060 = (int)uVar25 >= 1;
lVar17 = unaff_R14[0xf];
if ((lVar17 != 0) && (DAT_1800927ac != '\0')) {
*(ushort *)(lVar17 + 0x40) = *(ushort *)(lVar17 + 0x40) | 1;
*(undefined4 *)(lVar17 + 0x18) = 1;
}
bVar29 = *in_stack_00000060;
if (bVar29 == 0) goto code_r0x00018001d8eb;
uVar28 = 0;
uVar25 = 0;
if (in_stack_00000044 == 0) goto LAB_18001d83f;
pbVar22 = *(byte **)(unaff_R14[0x7c] + 0xb0);
break;
}
}
}
LAB_18001d8ba:
do {
do {
pbVar21 = unaff_R15;
uVar19 = SUB81(pbVar22,0);
RtlReleaseResource(unaff_RBX + 0x48);
if (pbVar21 == unaff_R13 + *unaff_R12) {
FUN_18003136f((char)(unaff_R13 + *unaff_R12),uVar19,(char)in_R8,(char)in_R9,
uStack0000000000000028,in_stack_00000030,in_stack_00000038,in_stack_00000040
,uStack0000000000000048,uStack0000000000000050,in_stack_00000078);
return;
}
unaff_RBX = pbVar21 + -0x120;
pbVar22 = (byte *)0x1;
unaff_R15 = *(byte **)pbVar21;
RtlAcquireResourceShared(pbVar21 + -0xd8);
} while (pbVar21[-0x34] == unaff_SIL);
uVar25 = *(uint *)(pbVar21 + -0xc);
uVar20 = *(uint *)(pbVar21 + -8);
pbVar22 = (byte *)(ulonglong)uVar20;
if (_uStack0000000000000050 <= uVar25) {
if (_uStack0000000000000050 < uVar25) {
FUN_180031341(_uStack0000000000000050 - uVar25,uVar20);
return;
}
break;
}
} while (uVar20 < _uStack0000000000000050 - uVar25);
} while( true );
while( true ) {
uVar25 = uVar25 + 1;
uVar28 = (ulonglong)uVar25;
if (in_stack_00000044 <= uVar25) break;
uVar25 = (uint)uVar28;
uVar20 = 0;
if (pbVar22 != (byte *)0x0) {
uVar20 = *(uint *)(pbVar22 + 0x1c);
}
in_R8 = (longlong *)(uVar28 * 4);
if (*(uint *)((longlong)in_R8 + in_stack_00000068) == uVar20) {
puVar27 = (uint *)((longlong)in_R8 + in_stack_00000068);
uVar2 = *(undefined4 *)((longlong)unaff_R14 + 0x44);
_uStack0000000000000028 = CONCAT31(uStack0000000000000029,bVar29);
plVar15 = unaff_R14;
bVar9 = 1;
iVar11 = FUN_18001b0b0(&DAT_180092420,unaff_R14,puVar27,1,*(uint *)(unaff_R14 + 8),bVar29);
bVar29 = bVar9;
uVar19 = SUB81(plVar15,0);
uVar26 = SUB81(puVar27,0);
if (iVar11 != 0) {
*(undefined2 *)(unaff_R14 + 0xc) = 0;
*(undefined4 *)((longlong)unaff_R14 + 0x44) = uVar2;
goto LAB_1800313a8;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x30,&DAT_180082bd8);
}
pbVar22 = (byte *)0x1;
unaff_R14[0xb] = unaff_R14[0x7c];
RtlAcquireResourceExclusive(unaff_R14[0x7c] + 0x48);
lVar17 = unaff_R14[0xb];
lVar14 = *(longlong *)(lVar17 + 0xb0);
lVar13 = *(longlong *)(lVar14 + 0x350);
if (lVar13 != 0) {
LOCK();
piVar1 = (int *)(*(longlong *)(lVar13 + 0x10) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
}
LOCK();
piVar1 = (int *)(*(longlong *)(lVar14 + 0x358) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
plVar15 = *(longlong **)(lVar17 + 0xb0);

lVar14 = unaff_R14[1];
if (lVar14 != 0) {
if (*(longlong *)(lVar14 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar14 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar14 + 0x358));
}
if (unaff_R14[3] != 0) {
LOCK();
piVar1 = (int *)(unaff_R14[3] + 0x18);
iVar11 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar11 == 1) {
pbVar22 = (byte *)0x1;

}
unaff_R14[3] = 0;
}
if (lVar13 == 0) goto LAB_18001d72a;
lVar14 = *plVar15;
pbVar22 = (byte *)0x1;
RtlAcquireResourceShared(lVar13 + 0x228);
uVar28 = 0;
if (*(uint *)(lVar13 + 0x60) == 0) goto LAB_18001d714;
pbVar22 = *(byte **)(lVar13 + 0x58);
goto LAB_18001d6f3;
}
}
goto LAB_18001d83f;
while (uVar20 = (int)uVar28 + 1, uVar28 = (ulonglong)uVar20, uVar20 < *(uint *)(lVar13 + 0x60)) {
LAB_18001d6f3:
if (*(longlong *)(*(longlong *)(pbVar22 + uVar28 * 8) + 0x10) == lVar14) {
LOCK();
piVar1 = (int *)(*(longlong *)(pbVar22 + uVar28 * 8) + 0x18);
*piVar1 = *piVar1 + 1;
UNLOCK();
unaff_R14[3] = *(longlong *)(*(longlong *)(lVar13 + 0x58) + uVar28 * 8);
break;
}
}
LAB_18001d714:
RtlReleaseResource(lVar13 + 0x228);
LAB_18001d72a:
pbVar21 = (byte *)0x0;
if ((*(uint *)(unaff_R14 + 8) & 0xf3f00) == 0) {
uVar20 = *(uint *)((longlong)plVar15 + 0xc);
uVar2 = *(undefined4 *)(plVar15 + 2);
*(undefined8 *)(unaff_RBP + -0x40) = 0x14;
*(undefined8 *)(unaff_RBP + -0x34) = 0;
*(undefined4 *)(unaff_RBP + -0x38) = uVar2;
if (1 < uVar20) {
*(uint *)(unaff_RBP + -0x30) = *(uint *)(unaff_RBP + -0x30) | 1;
*(uint *)(unaff_RBP + -0x34) = uVar20;
}
LAB_18001d76e:
if ((*(byte *)(unaff_R14 + 4) & 1) != 0) {
pbVar22 = (byte *)(unaff_R14 + 5);
lVar14 = RtlCompareMemory(unaff_RBP + -0x40,pbVar22,0x14);
if (lVar14 != 0x14) goto LAB_18001d7a5;
}
uVar6 = *(undefined4 *)(unaff_RBP + -0x3c);
uVar7 = *(undefined4 *)(unaff_RBP + -0x38);
uVar8 = *(undefined4 *)(unaff_RBP + -0x34);
uVar2 = *(undefined4 *)(unaff_RBP + -0x30);
*(undefined4 *)(unaff_R14 + 5) = *(undefined4 *)(unaff_RBP + -0x40);
*(undefined4 *)((longlong)unaff_R14 + 0x2c) = uVar6;
*(undefined4 *)(unaff_R14 + 6) = uVar7;
*(undefined4 *)((longlong)unaff_R14 + 0x34) = uVar8;
*(undefined4 *)(unaff_R14 + 7) = uVar2;
}
else {
pbVar22 = (byte *)(ulonglong)*(ushort *)((longlong)unaff_R14 + 0x22);
in_stack_00000030 = 0;
_uStack0000000000000028 = 0x14;
iVar11 = SslLookupCipherLengths
(*plVar15,pbVar22,*(undefined4 *)((longlong)plVar15 + 0x1c),
*(undefined4 *)(unaff_R14 + 2),unaff_RBP + -0x40);
if (iVar11 == 0) goto LAB_18001d76e;
}
LAB_18001d7a5:
*(ushort *)(unaff_R14 + 4) = *(ushort *)(unaff_R14 + 4) | 1;
unaff_R14[1] = (longlong)plVar15;
iVar11 = *(int *)(lVar17 + 0xb8);
bVar29 = (byte)iVar11;
*(int *)(unaff_R14 + 2) = iVar11;
in_R8 = (longlong *)plVar15[0x6a];
if ((in_R8 != (longlong *)0x0) &&
(puVar27 = (uint *)(in_R8 + 1), pbVar22 = pbVar21, *puVar27 != 0)) {
in_R8 = (longlong *)*in_R8;
do {
if (*(int *)((longlong)in_R8 + (longlong)pbVar21 * 0x30c + 0x304) == iVar11) {
lVar17 = (longlong)in_R8 + (longlong)pbVar21 * 0x30c;
pbVar22 = pbVar21;
if (lVar17 != 0) {
*(undefined4 *)((longlong)unaff_R14 + 0x14) = *(undefined4 *)(lVar17 + 0x308);
}
break;
}
uVar20 = (int)pbVar21 + 1;
pbVar21 = (byte *)(ulonglong)uVar20;
pbVar22 = pbVar21;
} while (uVar20 < *puVar27);
}
RtlReleaseResource(unaff_R14[0xb] + 0x48);
lVar17 = unaff_R14[0xf];
if ((lVar17 != 0) && (DAT_1800927ac != '\0')) {
*(ushort *)(lVar17 + 0x40) = *(ushort *)(lVar17 + 0x40) | 4;
*(undefined4 *)(lVar17 + 0x18) = 1;
}
LAB_18001d83f:
uVar19 = SUB81(pbVar22,0);
uVar26 = SUB81(in_R8,0);
if (uVar25 == in_stack_00000044) {
LAB_1800313a8:
*(undefined *)(unaff_R14[0x7c] + 0xec) = 0;

*in_stack_00000060 = 0;
FUN_18001d8eb((char)unaff_R14,uVar19,uVar26,bVar29,_uStack0000000000000028,in_stack_00000030,
in_stack_00000038,in_stack_00000040,uStack0000000000000048,uStack0000000000000050,
in_stack_0000004c,in_stack_00000070,in_stack_00000078);
return;
}
if (*in_stack_00000060 == 0) {
code_r0x00018001d8eb:
if ((((ulonglong)unaff_R14[0x11] >> 0xb & 1) != 0) && (*(int *)(unaff_R14 + 0x7b) != 0)) {
unaff_R14[0x11] = unaff_R14[0x11] | 0x400000;
}
NVar12 = BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,(PUCHAR)(unaff_RBP + 0x110),0x20,2);
if ((NVar12 < 0) && (iVar11 = RtlNtStatusToDosError(NVar12), iVar11 != 0)) goto LAB_18001d86d;
if ((DAT_1800927f0 != 0) &&
(lVar17 = (((ulonglong)*(uint *)(unaff_RBP + 0x110) %
(ulonglong)*(uint *)(DAT_1800927f0 + 0x10)) /
(ulonglong)*(uint *)(DAT_1800927f0 + 0x34)) * 0x98 +
*(longlong *)(DAT_1800927f0 + 0x28), lVar17 != 0)) {
RtlAcquireResourceExclusive(lVar17 + 0x30);
}
iVar11 = DAT_1800919f4;
uVar25 = *(uint *)(unaff_R14 + 8);
unaff_R12 = (longlong *)(ulonglong)uVar25;
uVar28 = (ulonglong)*(uint *)(unaff_RBP + 0x110) %
(ulonglong)*(uint *)(in_stack_00000070 + 0x10);
*(undefined4 *)(unaff_RBP + -0x78) = *(undefined4 *)(unaff_RBP + 0x110);
*(undefined4 *)(unaff_RBP + -0x74) = *(undefined4 *)(unaff_RBP + 0x114);
*(undefined4 *)(unaff_RBP + -0x70) = *(undefined4 *)(unaff_RBP + 0x118);
*(undefined4 *)(unaff_RBP + -0x6c) = *(undefined4 *)(unaff_RBP + 0x11c);
*(int *)(unaff_RBP + -0x78) = (int)uVar28;
*(undefined4 *)(unaff_RBP + -0x68) = *(undefined4 *)(unaff_RBP + 0x120);
*(undefined4 *)(unaff_RBP + -100) = *(undefined4 *)(unaff_RBP + 0x124);
*(undefined4 *)(unaff_RBP + -0x60) = *(undefined4 *)(unaff_RBP + 0x128);
*(undefined4 *)(unaff_RBP + -0x5c) = *(undefined4 *)(unaff_RBP + 300);
if (iVar11 != -1) {
*(int *)(unaff_RBP + -0x74) = iVar11;
}

if (plVar15 == (longlong *)0x0) {
iVar11 = 0xe;
}
else {
FUN_180006b5c(plVar15,*(undefined4 *)(in_stack_00000070 + 0x18),
(undefined4 *)(unaff_RBP + -0x78));
*(undefined4 *)(plVar15 + 0x1b) = 0x80090325;
*plVar15 = (longlong)&PTR_FUN_18007c330;
plVar15[0x2a] = 0;
plVar15[0x2b] = 0;
*(undefined4 *)(plVar15 + 0x2c) = 0;
iVar11 = *(int *)((longlong)plVar15 + 0x44);
if (iVar11 == 0) {
uVar20 = *(uint *)(in_stack_00000070 + 0x34);
uVar4 = uVar28 / uVar20;
plVar23 = (longlong *)(uVar4 * 0x98 + *(longlong *)(in_stack_00000070 + 0x28));
FUN_1800069c4(uVar4,(longlong)plVar15);
plVar15[0x1c] = (longlong)plVar23;
plVar18 = plVar15 + 0x24;
lVar17 = (uVar28 % (ulonglong)uVar20) * 0x10 + *plVar23;
plVar3 = *(longlong **)(lVar17 + 8);
plVar24 = plVar23;
unaff_R13 = in_stack_00000060;
if (*plVar3 == lVar17) {
*plVar18 = lVar17;
plVar24 = plVar23 + 2;
plVar15[0x25] = (longlong)plVar3;
*plVar3 = (longlong)plVar18;
*(longlong **)(lVar17 + 8) = plVar18;
plVar18 = plVar15 + 0x26;
puVar16 = (undefined8 *)plVar23[3];
if ((longlong *)*puVar16 != plVar24) goto LAB_18001da84;
}
else {
LAB_18001da84:
uVar25 = (uint)unaff_R12;
plVar18 = (longlong *)0x3;
pcVar5 = (code *)swi(0x29);
puVar16 = (undefined8 *)(*pcVar5)();
register0x00000020 = (BADSPACEBASE *)auStackX_8;
in_stack_00000060 = unaff_R13;
}
plVar18[1] = (longlong)puVar16;
*plVar18 = (longlong)plVar24;
*puVar16 = plVar18;
lVar17 = *(longlong *)((longlong)register0x00000020 + 0x70);
plVar24[1] = (longlong)plVar18;
LOCK();
*(int *)(lVar17 + 0x20) = *(int *)(lVar17 + 0x20) + 1;
UNLOCK();
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001dab1;
LsaIModifyPerformanceCounter(4,0,0);
unaff_R14[0x7c] = (longlong)plVar15;
iVar11 = 0;
*(uint *)(plVar15 + 0x15) = uVar25;
}
else {
FUN_180018fc0(plVar15,1);
}
}
if ((DAT_1800927f0 != 0) &&
(lVar17 = (((ulonglong)*(uint *)(unaff_RBP + 0x110) %
(ulonglong)*(uint *)(DAT_1800927f0 + 0x10)) /
(ulonglong)*(uint *)(DAT_1800927f0 + 0x34)) * 0x98 +
*(longlong *)(DAT_1800927f0 + 0x28), lVar17 != 0)) {
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001db02;
RtlReleaseResource(lVar17 + 0x30);
}
if (iVar11 != 0) goto LAB_18001d86d;
uVar2 = *(undefined4 *)(unaff_R14 + 8);
uVar25 = *(uint *)((longlong)register0x00000020 + 0x44);
puVar27 = *(uint **)((longlong)register0x00000020 + 0x68);
unaff_R14[0xb] = unaff_R14[0x7c];
*(byte *)((longlong)register0x00000020 + 0x28) = *in_stack_00000060;
*(undefined4 *)((longlong)register0x00000020 + 0x20) = uVar2;
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001db46;
iVar11 = FUN_18001b0b0(&DAT_180092420,unaff_R14,puVar27,uVar25,
*(uint *)((longlong)register0x00000020 + 0x20),
*(byte *)((longlong)register0x00000020 + 0x28));
if (iVar11 != 0) {
FUN_1800314b4();
return;
}
}
*(undefined *)((longlong)unaff_R14 + 0x22b) = 0;
if (*(char *)((longlong)unaff_R14 + 0xe9) != '\0') {
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x1800314d6;
FUN_18006fe4c((longlong)unaff_R14);
}
LAB_18001d86d:
unaff_R14[0x7a] = 0;
*(undefined4 *)(unaff_R14 + 0x7b) = 0;
if (*(longlong *)((longlong)register0x00000020 + 0x68) != unaff_RBP) {
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x1800314f6;

}
uVar28 = *(ulonglong *)(unaff_RBP + 0x150);
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001d89e;
FUN_180028070(uVar28 ^ (ulonglong)register0x00000020);
return;
}
=========================================
Function at address: 0x18003136f
Called functions addresses: 0x180018fc0 0x18001d8eb 0xEXTERNAL:000000c0 0x180041cb0 0x18002a7c0 0xEXTERNAL:000000c7


void FUN_18003136f(undefined param_1,byte param_2,byte param_3,undefined param_4,undefined param_5,
undefined param_6,undefined param_7,undefined param_8,undefined param_9,
undefined param_10,undefined8 param_11)

{
int *piVar1;
undefined4 uVar2;
ulonglong uVar3;
code *pcVar4;
undefined4 uVar5;
undefined4 uVar6;
undefined4 uVar7;
byte bVar8;
NTSTATUS NVar9;
int iVar10;
longlong lVar11;
longlong lVar12;
undefined8 *puVar13;
undefined8 *puVar14;
longlong lVar15;
undefined8 *puVar16;
undefined uVar17;
uint uVar18;
longlong *plVar20;
longlong unaff_RBP;
longlong *plVar21;
undefined uVar22;
uint *puVar23;
ulonglong uVar24;
longlong *plVar25;
byte bVar26;
longlong *unaff_R14;
uint uVar27;
undefined auStackX_8 [24];
undefined3 in_stack_00000029;
uint in_stack_00000044;
undefined4 in_stack_0000004c;
byte *in_stack_00000060;
longlong in_stack_00000068;
longlong in_stack_00000070;
longlong *plVar19;

plVar25 = (longlong *)(ulonglong)param_3;
plVar20 = (longlong *)(ulonglong)param_2;
RtlReleaseResource(param_11);
unaff_R14[0x7c] = 0;
*in_stack_00000060 = 0;
lVar15 = unaff_R14[0xf];
if ((lVar15 != 0) && (DAT_1800927ac != '\0')) {
*(ushort *)(lVar15 + 0x40) = *(ushort *)(lVar15 + 0x40) | 1;
*(undefined4 *)(lVar15 + 0x18) = 1;
}
bVar26 = *in_stack_00000060;
if (bVar26 != 0) {
uVar24 = 0;
uVar27 = 0;
if (in_stack_00000044 != 0) {
plVar20 = *(longlong **)(unaff_R14[0x7c] + 0xb0);
do {
uVar27 = (uint)uVar24;
uVar18 = 0;
if (plVar20 != (longlong *)0x0) {
uVar18 = *(uint *)((longlong)plVar20 + 0x1c);
}
plVar25 = (longlong *)(uVar24 * 4);
if (*(uint *)((longlong)plVar25 + in_stack_00000068) == uVar18) {
puVar23 = (uint *)((longlong)plVar25 + in_stack_00000068);
uVar2 = *(undefined4 *)((longlong)unaff_R14 + 0x44);
_param_5 = CONCAT31(in_stack_00000029,bVar26);
plVar20 = unaff_R14;
bVar8 = 1;
iVar10 = FUN_18001b0b0(&DAT_180092420,unaff_R14,puVar23,1,*(uint *)(unaff_R14 + 8),bVar26)
;
bVar26 = bVar8;
uVar17 = SUB81(plVar20,0);
uVar22 = SUB81(puVar23,0);
if (iVar10 != 0) {
*(undefined2 *)(unaff_R14 + 0xc) = 0;
*(undefined4 *)((longlong)unaff_R14 + 0x44) = uVar2;
goto LAB_1800313a8;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x30,&DAT_180082bd8);
}
plVar20 = (longlong *)0x1;
unaff_R14[0xb] = unaff_R14[0x7c];
RtlAcquireResourceExclusive(unaff_R14[0x7c] + 0x48);
lVar15 = unaff_R14[0xb];
lVar12 = *(longlong *)(lVar15 + 0xb0);
lVar11 = *(longlong *)(lVar12 + 0x350);
if (lVar11 != 0) {
LOCK();
piVar1 = (int *)(*(longlong *)(lVar11 + 0x10) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
}
LOCK();
piVar1 = (int *)(*(longlong *)(lVar12 + 0x358) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
plVar25 = *(longlong **)(lVar15 + 0xb0);

lVar12 = unaff_R14[1];
if (lVar12 != 0) {
if (*(longlong *)(lVar12 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar12 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar12 + 0x358));
}
if (unaff_R14[3] != 0) {
LOCK();
piVar1 = (int *)(unaff_R14[3] + 0x18);
iVar10 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar10 == 1) {
plVar20 = (longlong *)0x1;

}
unaff_R14[3] = 0;
}
if (lVar11 == 0) goto LAB_18001d72a;
lVar12 = *plVar25;
plVar20 = (longlong *)0x1;
RtlAcquireResourceShared(lVar11 + 0x228);
uVar24 = 0;
if (*(uint *)(lVar11 + 0x60) == 0) goto LAB_18001d714;
plVar20 = *(longlong **)(lVar11 + 0x58);
goto LAB_18001d6f3;
}
uVar27 = uVar27 + 1;
uVar24 = (ulonglong)uVar27;
} while (uVar27 < in_stack_00000044);
}
goto LAB_18001d83f;
}
code_r0x00018001d8eb:
if ((((ulonglong)unaff_R14[0x11] >> 0xb & 1) != 0) && (*(int *)(unaff_R14 + 0x7b) != 0)) {
unaff_R14[0x11] = unaff_R14[0x11] | 0x400000;
}
NVar9 = BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,(PUCHAR)(unaff_RBP + 0x110),0x20,2);
if ((NVar9 < 0) && (iVar10 = RtlNtStatusToDosError(NVar9), iVar10 != 0)) goto LAB_18001d86d;
if ((DAT_1800927f0 != 0) &&
(lVar15 = (((ulonglong)*(uint *)(unaff_RBP + 0x110) %
(ulonglong)*(uint *)(DAT_1800927f0 + 0x10)) /
(ulonglong)*(uint *)(DAT_1800927f0 + 0x34)) * 0x98 +
*(longlong *)(DAT_1800927f0 + 0x28), lVar15 != 0)) {
RtlAcquireResourceExclusive(lVar15 + 0x30);
}
iVar10 = DAT_1800919f4;
uVar2 = *(undefined4 *)(unaff_R14 + 8);
uVar24 = (ulonglong)*(uint *)(unaff_RBP + 0x110) % (ulonglong)*(uint *)(in_stack_00000070 + 0x10);
*(undefined4 *)(unaff_RBP + -0x78) = *(undefined4 *)(unaff_RBP + 0x110);
*(undefined4 *)(unaff_RBP + -0x74) = *(undefined4 *)(unaff_RBP + 0x114);
*(undefined4 *)(unaff_RBP + -0x70) = *(undefined4 *)(unaff_RBP + 0x118);
*(undefined4 *)(unaff_RBP + -0x6c) = *(undefined4 *)(unaff_RBP + 0x11c);
*(int *)(unaff_RBP + -0x78) = (int)uVar24;
*(undefined4 *)(unaff_RBP + -0x68) = *(undefined4 *)(unaff_RBP + 0x120);
*(undefined4 *)(unaff_RBP + -100) = *(undefined4 *)(unaff_RBP + 0x124);
*(undefined4 *)(unaff_RBP + -0x60) = *(undefined4 *)(unaff_RBP + 0x128);
*(undefined4 *)(unaff_RBP + -0x5c) = *(undefined4 *)(unaff_RBP + 300);
if (iVar10 != -1) {
*(int *)(unaff_RBP + -0x74) = iVar10;
}
lVar15 = in_stack_00000070;

if (puVar13 == (undefined8 *)0x0) {
iVar10 = 0xe;
}
else {
FUN_180006b5c(puVar13,*(undefined4 *)(in_stack_00000070 + 0x18),
(undefined4 *)(unaff_RBP + -0x78));
*(undefined4 *)(puVar13 + 0x1b) = 0x80090325;
*puVar13 = &PTR_FUN_18007c330;
puVar13[0x2a] = 0;
puVar13[0x2b] = 0;
*(undefined4 *)(puVar13 + 0x2c) = 0;
iVar10 = *(int *)((longlong)puVar13 + 0x44);
if (iVar10 == 0) {
uVar27 = *(uint *)(in_stack_00000070 + 0x34);
uVar3 = uVar24 / uVar27;
plVar21 = (longlong *)(uVar3 * 0x98 + *(longlong *)(lVar15 + 0x28));
FUN_1800069c4(uVar3,(longlong)puVar13);
puVar13[0x1c] = plVar21;
plVar20 = puVar13 + 0x24;
lVar15 = (uVar24 % (ulonglong)uVar27) * 0x10 + *plVar21;
plVar25 = *(longlong **)(lVar15 + 8);
plVar19 = plVar21;
if (*plVar25 == lVar15) {
*plVar20 = lVar15;
plVar19 = plVar21 + 2;
puVar13[0x25] = plVar25;
*plVar25 = (longlong)plVar20;
*(longlong **)(lVar15 + 8) = plVar20;
puVar16 = puVar13 + 0x26;
puVar14 = (undefined8 *)plVar21[3];
if ((longlong *)*puVar14 != plVar19) goto LAB_18001da84;
}
else {
LAB_18001da84:
puVar16 = (undefined8 *)0x3;
pcVar4 = (code *)swi(0x29);
puVar14 = (undefined8 *)(*pcVar4)();
register0x00000020 = (BADSPACEBASE *)auStackX_8;
}
puVar16[1] = puVar14;
*puVar16 = plVar19;
*puVar14 = puVar16;
lVar15 = *(longlong *)((longlong)register0x00000020 + 0x70);
plVar19[1] = (longlong)puVar16;
LOCK();
*(int *)(lVar15 + 0x20) = *(int *)(lVar15 + 0x20) + 1;
UNLOCK();
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001dab1;
LsaIModifyPerformanceCounter(4,0,0);
unaff_R14[0x7c] = (longlong)puVar13;
iVar10 = 0;
*(undefined4 *)(puVar13 + 0x15) = uVar2;
}
else {
FUN_180018fc0(puVar13,1);
}
}
if ((DAT_1800927f0 != 0) &&
(lVar15 = (((ulonglong)*(uint *)(unaff_RBP + 0x110) %
(ulonglong)*(uint *)(DAT_1800927f0 + 0x10)) /
(ulonglong)*(uint *)(DAT_1800927f0 + 0x34)) * 0x98 +
*(longlong *)(DAT_1800927f0 + 0x28), lVar15 != 0)) {
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001db02;
RtlReleaseResource(lVar15 + 0x30);
}
if (iVar10 != 0) goto LAB_18001d86d;
uVar2 = *(undefined4 *)(unaff_R14 + 8);
uVar27 = *(uint *)((longlong)register0x00000020 + 0x44);
puVar23 = *(uint **)((longlong)register0x00000020 + 0x68);
unaff_R14[0xb] = unaff_R14[0x7c];
*(byte *)((longlong)register0x00000020 + 0x28) = *in_stack_00000060;
*(undefined4 *)((longlong)register0x00000020 + 0x20) = uVar2;
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001db46;
iVar10 = FUN_18001b0b0(&DAT_180092420,unaff_R14,puVar23,uVar27,
*(uint *)((longlong)register0x00000020 + 0x20),
*(byte *)((longlong)register0x00000020 + 0x28));
if (iVar10 != 0) {
FUN_1800314b4();
return;
}
goto LAB_18001d853;
while (uVar18 = (int)uVar24 + 1, uVar24 = (ulonglong)uVar18, uVar18 < *(uint *)(lVar11 + 0x60)) {
LAB_18001d6f3:
if (*(longlong *)(plVar20[uVar24] + 0x10) == lVar12) {
LOCK();
piVar1 = (int *)(plVar20[uVar24] + 0x18);
*piVar1 = *piVar1 + 1;
UNLOCK();
unaff_R14[3] = *(longlong *)(*(longlong *)(lVar11 + 0x58) + uVar24 * 8);
break;
}
}
LAB_18001d714:
RtlReleaseResource(lVar11 + 0x228);
LAB_18001d72a:
plVar19 = (longlong *)0x0;
if ((*(uint *)(unaff_R14 + 8) & 0xf3f00) == 0) {
uVar18 = *(uint *)((longlong)plVar25 + 0xc);
uVar2 = *(undefined4 *)(plVar25 + 2);
*(undefined8 *)(unaff_RBP + -0x40) = 0x14;
*(undefined8 *)(unaff_RBP + -0x34) = 0;
*(undefined4 *)(unaff_RBP + -0x38) = uVar2;
if (1 < uVar18) {
*(uint *)(unaff_RBP + -0x30) = *(uint *)(unaff_RBP + -0x30) | 1;
*(uint *)(unaff_RBP + -0x34) = uVar18;
}
LAB_18001d76e:
if ((*(byte *)(unaff_R14 + 4) & 1) != 0) {
plVar20 = unaff_R14 + 5;
lVar12 = RtlCompareMemory(unaff_RBP + -0x40,plVar20,0x14);
if (lVar12 != 0x14) goto LAB_18001d7a5;
}
uVar5 = *(undefined4 *)(unaff_RBP + -0x3c);
uVar6 = *(undefined4 *)(unaff_RBP + -0x38);
uVar7 = *(undefined4 *)(unaff_RBP + -0x34);
uVar2 = *(undefined4 *)(unaff_RBP + -0x30);
*(undefined4 *)(unaff_R14 + 5) = *(undefined4 *)(unaff_RBP + -0x40);
*(undefined4 *)((longlong)unaff_R14 + 0x2c) = uVar5;
*(undefined4 *)(unaff_R14 + 6) = uVar6;
*(undefined4 *)((longlong)unaff_R14 + 0x34) = uVar7;
*(undefined4 *)(unaff_R14 + 7) = uVar2;
}
else {
plVar20 = (longlong *)(ulonglong)*(ushort *)((longlong)unaff_R14 + 0x22);
param_6 = 0;
_param_5 = 0x14;
iVar10 = SslLookupCipherLengths
(*plVar25,plVar20,*(undefined4 *)((longlong)plVar25 + 0x1c),
*(undefined4 *)(unaff_R14 + 2),unaff_RBP + -0x40);
if (iVar10 == 0) goto LAB_18001d76e;
}
LAB_18001d7a5:
*(ushort *)(unaff_R14 + 4) = *(ushort *)(unaff_R14 + 4) | 1;
unaff_R14[1] = (longlong)plVar25;
iVar10 = *(int *)(lVar15 + 0xb8);
bVar26 = (byte)iVar10;
*(int *)(unaff_R14 + 2) = iVar10;
plVar25 = (longlong *)plVar25[0x6a];
if ((plVar25 != (longlong *)0x0) &&
(puVar23 = (uint *)(plVar25 + 1), plVar20 = plVar19, *puVar23 != 0)) {
plVar25 = (longlong *)*plVar25;
do {
if (*(int *)((longlong)plVar25 + (longlong)plVar19 * 0x30c + 0x304) == iVar10) {
lVar15 = (longlong)plVar25 + (longlong)plVar19 * 0x30c;
plVar20 = plVar19;
if (lVar15 != 0) {
*(undefined4 *)((longlong)unaff_R14 + 0x14) = *(undefined4 *)(lVar15 + 0x308);
}
break;
}
uVar18 = (int)plVar19 + 1;
plVar19 = (longlong *)(ulonglong)uVar18;
plVar20 = plVar19;
} while (uVar18 < *puVar23);
}
RtlReleaseResource(unaff_R14[0xb] + 0x48);
lVar15 = unaff_R14[0xf];
if ((lVar15 != 0) && (DAT_1800927ac != '\0')) {
*(ushort *)(lVar15 + 0x40) = *(ushort *)(lVar15 + 0x40) | 4;
*(undefined4 *)(lVar15 + 0x18) = 1;
}
LAB_18001d83f:
uVar17 = SUB81(plVar20,0);
uVar22 = SUB81(plVar25,0);
if (uVar27 == in_stack_00000044) {
LAB_1800313a8:
*(undefined *)(unaff_R14[0x7c] + 0xec) = 0;

*in_stack_00000060 = 0;
FUN_18001d8eb((char)unaff_R14,uVar17,uVar22,bVar26,_param_5,param_6,param_7,param_8,param_9,
param_10,in_stack_0000004c,in_stack_00000070,param_11);
return;
}
if (*in_stack_00000060 == 0) goto code_r0x00018001d8eb;
LAB_18001d853:
*(undefined *)((longlong)unaff_R14 + 0x22b) = 0;
if (*(char *)((longlong)unaff_R14 + 0xe9) != '\0') {
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x1800314d6;
FUN_18006fe4c((longlong)unaff_R14);
}
LAB_18001d86d:
unaff_R14[0x7a] = 0;
*(undefined4 *)(unaff_R14 + 0x7b) = 0;
if (*(longlong *)((longlong)register0x00000020 + 0x68) != unaff_RBP) {
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x1800314f6;

}
uVar24 = *(ulonglong *)(unaff_RBP + 0x150);
*(undefined8 *)((longlong)register0x00000020 + -8) = 0x18001d89e;
FUN_180028070(uVar24 ^ (ulonglong)register0x00000020);
return;
}
=========================================
Function at address: 0x1800314b4
Called functions addresses: 0x18005b470 0x18002a7c0


void FUN_1800314b4(void)

{
undefined4 in_EAX;
longlong unaff_RBP;
longlong *unaff_R14;
longlong in_stack_00000068;

FUN_18005b470(unaff_R14,0x4b5,in_EAX,0x28);
unaff_R14[0x7a] = 0;
*(undefined4 *)(unaff_R14 + 0x7b) = 0;
if (in_stack_00000068 != unaff_RBP) {

}
FUN_180028070(*(ulonglong *)(unaff_RBP + 0x150) ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x180031d40
Called functions addresses: 0x18001e185 0x18000ad34 0x180075fac


void switchD_18001e135::caseD_0(void)

{
ulonglong *puVar1;
undefined8 uVar2;
longlong lVar3;
undefined uVar4;
undefined *unaff_RDI;
undefined uVar5;
undefined uVar6;
ushort in_R9W;
longlong unaff_R14;
undefined in_stack_00000028;
undefined in_stack_00000030;
undefined in_stack_00000038;
undefined in_stack_00000040;
undefined in_stack_00000048;
undefined in_stack_00000050;
undefined8 in_stack_00000088;
undefined8 in_stack_000000d8;

lVar3 = *(longlong *)(*(longlong *)(unaff_R14 + 8) + 0x50);
uVar2 = FUN_180075fac(unaff_R14,unaff_RDI,(uint)in_R9W);
uVar6 = (undefined)in_R9W;
if (((int)uVar2 == 0) && ((*(uint *)(lVar3 + 0x9c) & 0x100) != 0)) {
puVar1 = (ulonglong *)(*(longlong *)(unaff_R14 + 8) + 0x88);
*puVar1 = *puVar1 | 0x200000;
}
uVar5 = 0;
lVar3 = *(longlong *)(*(longlong *)(unaff_R14 + 8) + 0x78);
uVar4 = 1;
FUN_18000ad34(lVar3,1,0);
FUN_18001e185((char)lVar3,uVar4,uVar5,uVar6,in_stack_00000028,in_stack_00000030,in_stack_00000038,
in_stack_00000040,in_stack_00000048,in_stack_00000050,in_stack_00000088,
in_stack_000000d8);
return;
}
=========================================
Function at address: 0x180031e93
Called functions addresses: 0x18005b470 0x180041d20


void FUN_180031e93(longlong param_1)

{
longlong lVar1;
undefined1 unaff_BL;
undefined4 unaff_EBP;
longlong unaff_RSI;
longlong unaff_R14;
ulonglong in_stack_00000088;

if ((param_1 != unaff_RSI) && ((*(byte *)(param_1 + 0x1c) & 1) != 0)) {
FUN_180041d20(*(undefined8 *)(param_1 + 0x10),0x44,&DAT_180082c68,unaff_EBP,unaff_BL);
}
FUN_18005b470(*(longlong **)(unaff_R14 + 8),0x4b7,0x80090346,0x28);
lVar1 = *(longlong *)(unaff_R14 + 8);
*(undefined4 *)(lVar1 + 0x44) = 0x60;
*(undefined2 *)(lVar1 + 0x60) = 0x2802;
FUN_180028070(in_stack_00000088 ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x18003201a
Called functions addresses: 0x18005cc0c 0x18005a174


ulonglong FUN_18003201a(undefined param_1,undefined param_2,undefined param_3,byte param_4,
undefined4 param_5)

{
int iVar1;
uint uVar2;
int iVar3;
uint in_EAX;
undefined8 uVar4;
ulonglong uVar5;
uint uVar6;
wchar_t *pwVar7;
undefined uVar8;
undefined2 uVar9;
uint *unaff_RBX;
wchar_t *unaff_RBP;
uint *unaff_RSI;
int *unaff_RDI;
undefined7 in_register_00000081;
undefined *puVar10;
wchar_t *pwVar11;
uint unaff_R12D;
uint uVar12;
uint unaff_R13D;
uint *unaff_R14;
ulonglong unaff_R15;
undefined uStack0000000000000030;
char in_stack_00000038;
char in_stack_00000040;
int in_stack_00000044;
undefined uStack0000000000000048;
undefined uStack0000000000000050;
uint in_stack_00000058;
longlong *in_stack_00000060;
char in_stack_000000b0;
longlong in_stack_000000b8;
char in_stack_000000d0;
longlong in_stack_000000d8;
int *in_stack_000000e0;
undefined *in_stack_000000e8;

pwVar11 = (wchar_t *)(ulonglong)param_4;
puVar10 = (undefined *)CONCAT71(in_register_00000081,param_3);
if (unaff_R12D <= in_EAX) goto LAB_18001eba5;
LAB_180032023:
pwVar7 = unaff_RBP;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18001eadc;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar11 = L"ECDH";
param_5 = 0;
puVar10 = &DAT_180082b78;
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDH",(char)unaff_R12D,0);
}
LAB_1800320ac:
pwVar7 = unaff_RBP;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar10 = &DAT_180085700;
pwVar11 = unaff_RBP;
FUN_180041d70(DAT_180091000[2],0x2f,&DAT_180085700,unaff_RBP);
}
LAB_18001eadc:
unaff_RBP = pwVar7 + 0x186;
iVar3 = in_stack_00000044;
if ((wchar_t *)((ulonglong)*(uint *)(in_stack_00000060 + 1) * 0x30c + *in_stack_00000060) <=
unaff_RBP) goto LAB_18001ec41;
uVar2 = *(uint *)(*(longlong *)(in_stack_000000b8 + 0x50) + 0xc4);
unaff_R15 = (ulonglong)uVar2;
unaff_RBX = *(uint **)(*(longlong *)(in_stack_000000b8 + 0x50) + 200);
if (((uVar2 != 0) && (unaff_RBX != (uint *)0x0)) && (unaff_RBP != (wchar_t *)0x0))
goto code_r0x00018001e962;
goto LAB_18001ea38;
code_r0x00018001e962:
unaff_R12D = *(uint *)(pwVar7 + 0x306);
unaff_RSI = unaff_RBX + unaff_R15 * 10;
unaff_R14 = unaff_RBX;
if (unaff_RBX < unaff_RSI) {
do {
if (unaff_RBX[5] != 0) {
if (*unaff_RBX == 0) {
LAB_18001eb6e:
if (((in_stack_000000d0 == '\0') || ((*(byte *)(unaff_RBX + 8) & 1) == 0)) &&
(unaff_RDI = *(int **)(unaff_RBX + 6),
unaff_RDI < unaff_RDI + (ulonglong)unaff_RBX[5] * 0xc)) {
do {
if ((*unaff_RDI == 0) && (*(short *)(unaff_RDI + 2) == 8)) {
pwVar7 = *(wchar_t **)(unaff_RDI + 4);
uVar8 = 0xd8;
puVar10 = (undefined *)0x4;
iVar3 = wcsncmp(pwVar7,L"ECDH",4);
if (iVar3 == 0) {
if (((unaff_RDI[6] == 0) && (unaff_RDI[10] == 0)) && (unaff_RDI[0xb] == 0)) {
pwVar7 = unaff_RBP;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18001eadc;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar11 = L"ECDH";
puVar10 = &DAT_180082b78;
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDH",0);
}
goto LAB_1800320ac;
}
if (unaff_R12D != 0) {
if (unaff_RDI[10] == 0) {
if (unaff_RDI[0xb] != 0) {
uVar5 = FUN_18003201a((char)pwVar7,uVar8,(char)puVar10,(char)pwVar11,param_5
);
return uVar5;
}
}
else {
if (unaff_R12D < (uint)unaff_RDI[10]) goto LAB_180032023;
if (unaff_RDI[0xb] != 0) {
uVar5 = FUN_18003201a((char)pwVar7,uVar8,(char)puVar10,(char)pwVar11,param_5
);
return uVar5;
}
}
}
}
}
LAB_18001eba5:
unaff_RDI = unaff_RDI + 0xc;
} while (unaff_RDI <
(int *)((ulonglong)unaff_RBX[5] * 0x30 + *(longlong *)(unaff_RBX + 6)));
}
}
else if (in_stack_000000d8 != 0) {
uVar5 = 0;
do {
iVar3 = RtlCompareUnicodeString
(uVar5 * 0x10 + *(longlong *)(unaff_RBX + 2),in_stack_000000d8);
if (iVar3 == 0) goto LAB_18001eb6e;
uVar2 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar2;
} while (uVar2 < *unaff_RBX);
}
}
uVar2 = (uint)unaff_R15;
unaff_RBX = unaff_RBX + 10;
} while (unaff_RBX < unaff_RSI);
}
puVar10 = (undefined *)0x0;
pwVar11 = unaff_RBP;
uVar4 = FUN_1800077a0(unaff_R14,uVar2,0,unaff_RBP,(wchar_t *)0x0,0,in_stack_000000d8,
in_stack_000000d0);
if ((char)uVar4 != '\0') goto LAB_18003209e;
iVar3 = *(int *)(unaff_RBP + 0x182);
if (iVar3 == 0x17) {
pwVar11 = L"ECDH_P256";
LAB_18001ea0a:
puVar10 = (undefined *)0x0;
uVar4 = FUN_1800077a0(unaff_R14,uVar2,0,pwVar11,(wchar_t *)0x0,0,in_stack_000000d8,
in_stack_000000d0);
if ((char)uVar4 != '\0') {
LAB_18003209e:
in_stack_00000038 = in_stack_000000d0;
_uStack0000000000000030 = in_stack_000000d8;
param_5 = 0;
goto LAB_1800320ac;
}
}
else {
if (iVar3 == 0x18) {
pwVar11 = L"ECDH_P384";
goto LAB_18001ea0a;
}
if (iVar3 == 0x19) {
uVar5 = FUN_180032092();
return uVar5;
}
}
in_stack_00000038 = in_stack_000000d0;
_uStack0000000000000030 = in_stack_000000d8;
param_5 = 0;
LAB_18001ea38:
iVar3 = *(int *)(unaff_RBP + 0x182);

if (((uVar2 != 0) && (uVar2 != 0x490)) && (uVar2 != 0x32)) {
return (ulonglong)uVar2;
}
pwVar7 = unaff_RBP;
if (in_stack_000000b0 != '\0') {
if ((uVar2 != 0) || (iVar3 != _uStack0000000000000050)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar5 = FUN_180032107(&DAT_180091000,(ulonglong)uVar2,puVar10,(char)pwVar11,param_5);
return uVar5;
}
goto LAB_18001eadc;
}
goto LAB_18001ec41;
}
if (uVar2 == 0x32) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001eadc;
uVar9 = 0x31;
LAB_180032154:
puVar10 = &DAT_180085700;
pwVar11 = unaff_RBP;
FUN_180041d70(DAT_180091000[2],uVar9,&DAT_180085700,unaff_RBP);
goto LAB_18001eadc;
}
uVar6 = (*(uint *)(unaff_RBP + 0x180) & 1) + *(uint *)(unaff_RBP + 0x180) >> 1;
uVar12 = unaff_R13D;
iVar1 = _uStack0000000000000048;
if (uVar2 == 0x490) {
if ((in_stack_00000044 != 0) ||
((_uStack0000000000000048 == 0 &&
((*(int *)(in_stack_000000b8 + 0x44) != 0 ||
(uVar12 = uVar6, iVar1 = iVar3, in_stack_00000040 == '\0')))))) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18001eadc;
uVar9 = 0x32;
goto LAB_180032154;
}
LAB_18001eaad:
_uStack0000000000000048 = iVar1;
unaff_R13D = uVar12;
if (uVar12 == in_stack_00000058) goto LAB_18001eadc;
if (uVar6 != in_stack_00000058) goto LAB_18001eaba;
}
else {
if (in_stack_00000044 != 0) goto LAB_18001eaad;
_uStack0000000000000048 = 0;
uVar12 = uVar6;
in_stack_00000044 = iVar3;
if (uVar6 == in_stack_00000058) goto LAB_18001ec41;
LAB_18001eaba:
if ((in_stack_00000058 <= uVar12) || (uVar6 <= uVar12)) {
unaff_R13D = uVar12;
if ((in_stack_00000058 < uVar12) && ((uVar6 < uVar12 && (in_stack_00000058 < uVar6)))) {
uVar5 = FUN_18001ecaf(uVar6,(char)uVar2,(char)puVar10,(char)pwVar11,(undefined)param_5,
uStack0000000000000030,in_stack_00000038,in_stack_00000040,
uStack0000000000000048,uStack0000000000000050,in_stack_00000044);
return uVar5;
}
goto LAB_18001eadc;
}
}
unaff_R13D = uVar6;
if (in_stack_00000044 == 0) {
if (_uStack0000000000000048 != 0) {
_uStack0000000000000048 = *(int *)(unaff_RBP + 0x182);
}
goto LAB_18001eadc;
}
iVar3 = *(int *)(unaff_RBP + 0x182);
in_stack_00000044 = iVar3;
if (uVar6 != in_stack_00000058) goto LAB_18001eadc;
LAB_18001ec41:
if ((iVar3 == 0) && (_uStack0000000000000048 == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x33,&DAT_180085700);
}
uVar5 = 0x80090331;
}
else {
if ((in_stack_000000b0 != '\0') && (iVar3 != _uStack0000000000000050)) {
uVar5 = FUN_1800321f7();
return uVar5;
}
if ((iVar3 == 0) && (_uStack0000000000000048 != 0)) {
*in_stack_000000e8 = 1;
}
else {
*in_stack_000000e8 = 0;
_uStack0000000000000048 = iVar3;
}
uVar5 = 0;
*in_stack_000000e0 = _uStack0000000000000048;
}
return uVar5;
}
=========================================
Function at address: 0x180032092
Called functions addresses: 0x180041d70


ulonglong FUN_180032092(void)

{
int iVar1;
uint uVar2;
int iVar3;
undefined8 uVar4;
ulonglong uVar5;
uint uVar6;
wchar_t *_Str1;
undefined uVar7;
undefined2 uVar8;
uint *puVar9;
longlong unaff_RBX;
wchar_t *pwVar10;
wchar_t *unaff_RBP;
char unaff_SIL;
uint uVar11;
uint unaff_EDI;
int *piVar12;
undefined *puVar13;
wchar_t *pwVar14;
wchar_t *unaff_R12;
uint uVar15;
uint unaff_R13D;
uint *unaff_R14;
ulonglong unaff_R15;
uint uVar16;
char in_stack_00000040;
int in_stack_00000044;
undefined uStack0000000000000048;
undefined uStack0000000000000050;
uint in_stack_00000058;
longlong *in_stack_00000060;
char in_stack_000000b0;
longlong in_stack_000000b8;
char in_stack_000000d0;
longlong in_stack_000000d8;
int *in_stack_000000e0;
undefined *in_stack_000000e8;

pwVar14 = L"ECDH_P521";
LAB_18001ea0a:
do {
puVar13 = (undefined *)0x0;
uVar16 = (uint)unaff_R12;
uVar4 = FUN_1800077a0(unaff_R14,(uint)unaff_R15,0,pwVar14,unaff_R12,uVar16,unaff_RBX,unaff_SIL);
uVar11 = unaff_EDI;
if ((char)uVar4 != '\0') goto LAB_1800320ac;
LAB_18001ea38:
iVar3 = *(int *)(unaff_RBP + 0x182);

if (((uVar2 != 0) && (uVar2 != 0x490)) && (uVar2 != 0x32)) {
return (ulonglong)uVar2;
}
pwVar10 = unaff_RBP;
if (in_stack_000000b0 == '\0') {
if (uVar2 == 0x32) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar8 = 0x31;
LAB_180032154:
puVar13 = &DAT_180085700;
pwVar14 = unaff_RBP;
FUN_180041d70(DAT_180091000[2],uVar8,&DAT_180085700,unaff_RBP);
}
}
else {
uVar6 = (*(uint *)(unaff_RBP + 0x180) & 1) + *(uint *)(unaff_RBP + 0x180) >> 1;
uVar15 = unaff_R13D;
iVar1 = _uStack0000000000000048;
if (uVar2 == 0x490) {
if ((in_stack_00000044 == 0) &&
((_uStack0000000000000048 != 0 ||
((*(int *)(in_stack_000000b8 + 0x44) == 0 &&
(uVar15 = uVar6, iVar1 = iVar3, in_stack_00000040 != '\0')))))) goto LAB_18001eaad;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar8 = 0x32;
goto LAB_180032154;
}
}
else if (in_stack_00000044 == 0) {
_uStack0000000000000048 = 0;
uVar15 = uVar6;
in_stack_00000044 = iVar3;
if (uVar6 == uVar11) goto LAB_18001ec41;
LAB_18001eaba:
if ((uVar15 < uVar11) && (uVar15 < uVar6)) {
code_r0x00018001ecaf:
unaff_R13D = uVar6;
if (in_stack_00000044 == 0) {
if (_uStack0000000000000048 != 0) {
_uStack0000000000000048 = *(int *)(unaff_RBP + 0x182);
}
}
else {
iVar3 = *(int *)(unaff_RBP + 0x182);
in_stack_00000044 = iVar3;
if (uVar6 == uVar11) {
LAB_18001ec41:
if ((iVar3 == 0) && (_uStack0000000000000048 == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x33,&DAT_180085700);
}
uVar5 = 0x80090331;
}
else {
if ((in_stack_000000b0 != '\0') && (iVar3 != _uStack0000000000000050)) {
uVar5 = FUN_1800321f7();
return uVar5;
}
if ((iVar3 == 0) && (_uStack0000000000000048 != 0)) {
*in_stack_000000e8 = 1;
}
else {
*in_stack_000000e8 = 0;
_uStack0000000000000048 = iVar3;
}
uVar5 = 0;
*in_stack_000000e0 = _uStack0000000000000048;
}
return uVar5;
}
}
}
else {
unaff_R13D = uVar15;
if ((uVar11 < uVar15) && ((uVar6 < uVar15 && (uVar11 < uVar6)))) {
uVar5 = FUN_18001ecaf(uVar6,(char)uVar2,(char)puVar13,(char)pwVar14,(char)uVar16,
(char)unaff_RBX,unaff_SIL,in_stack_00000040,
uStack0000000000000048,uStack0000000000000050,in_stack_00000044)
;
return uVar5;
}
}
}
else {
LAB_18001eaad:
_uStack0000000000000048 = iVar1;
unaff_R13D = uVar15;
if (uVar15 != uVar11) {
if (uVar6 != uVar11) goto LAB_18001eaba;
goto code_r0x00018001ecaf;
}
}
}
}
else {
if ((uVar2 == 0) && (iVar3 == _uStack0000000000000050)) goto LAB_18001ec41;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar5 = FUN_180032107(&DAT_180091000,(ulonglong)uVar2,puVar13,(char)pwVar14,uVar16);
return uVar5;
}
}
LAB_18001eadc:
unaff_RBP = pwVar10 + 0x186;
iVar3 = in_stack_00000044;
if ((wchar_t *)((ulonglong)*(uint *)(in_stack_00000060 + 1) * 0x30c + *in_stack_00000060) <=
unaff_RBP) goto LAB_18001ec41;
uVar2 = *(uint *)(*(longlong *)(in_stack_000000b8 + 0x50) + 0xc4);
unaff_R15 = (ulonglong)uVar2;
unaff_R14 = *(uint **)(*(longlong *)(in_stack_000000b8 + 0x50) + 200);
uVar11 = in_stack_00000058;
if (((uVar2 == 0) || (unaff_R14 == (uint *)0x0)) || (unaff_RBP == (wchar_t *)0x0))
goto LAB_18001ea38;
uVar15 = *(uint *)(pwVar10 + 0x306);
for (puVar9 = unaff_R14; puVar9 < unaff_R14 + unaff_R15 * 10; puVar9 = puVar9 + 10) {
if (puVar9[5] != 0) {
if (*puVar9 == 0) {
LAB_18001eb6e:
if (((in_stack_000000d0 == '\0') || ((*(byte *)(puVar9 + 8) & 1) == 0)) &&
(piVar12 = *(int **)(puVar9 + 6), piVar12 < piVar12 + (ulonglong)puVar9[5] * 0xc)) {
do {
if ((*piVar12 == 0) && (*(short *)(piVar12 + 2) == 8)) {
_Str1 = *(wchar_t **)(piVar12 + 4);
uVar7 = 0xd8;
puVar13 = (undefined *)0x4;
iVar3 = wcsncmp(_Str1,L"ECDH",4);
if (iVar3 == 0) {
if (((piVar12[6] == 0) && (piVar12[10] == 0)) && (piVar12[0xb] == 0)) {
pwVar10 = unaff_RBP;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18001eadc;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar14 = L"ECDH";
puVar13 = &DAT_180082b78;
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDH",0);
}
goto LAB_1800320ac;
}
if (uVar15 != 0) {
if (piVar12[10] == 0) {
if (piVar12[0xb] != 0) {
uVar5 = FUN_18003201a((char)_Str1,uVar7,(char)puVar13,(char)pwVar14,uVar16);
return uVar5;
}
}
else {
if (uVar15 < (uint)piVar12[10]) {
pwVar10 = unaff_RBP;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18001eadc;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar14 = L"ECDH";
uVar16 = 0;
puVar13 = &DAT_180082b78;
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDH",(char)uVar15,0);
}
goto LAB_1800320ac;
}
if (piVar12[0xb] != 0) {
uVar5 = FUN_18003201a((char)_Str1,uVar7,(char)puVar13,(char)pwVar14,uVar16);
return uVar5;
}
}
}
}
}
piVar12 = piVar12 + 0xc;
} while (piVar12 < (int *)((ulonglong)puVar9[5] * 0x30 + *(longlong *)(puVar9 + 6)));
}
}
else if (in_stack_000000d8 != 0) {
uVar5 = 0;
do {
iVar3 = RtlCompareUnicodeString
(uVar5 * 0x10 + *(longlong *)(puVar9 + 2),in_stack_000000d8);
if (iVar3 == 0) goto LAB_18001eb6e;
uVar6 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar6;
} while (uVar6 < *puVar9);
}
}
}
unaff_R12 = (wchar_t *)0x0;
puVar13 = (undefined *)0x0;
uVar16 = 0;
pwVar14 = unaff_RBP;
unaff_RBX = in_stack_000000d8;
unaff_SIL = in_stack_000000d0;
uVar4 = FUN_1800077a0(unaff_R14,uVar2,0,unaff_RBP,(wchar_t *)0x0,0,in_stack_000000d8,
in_stack_000000d0);
if ((char)uVar4 != '\0') {
LAB_1800320ac:
pwVar10 = unaff_RBP;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar13 = &DAT_180085700;
pwVar14 = unaff_RBP;
FUN_180041d70(DAT_180091000[2],0x2f,&DAT_180085700,unaff_RBP);
}
goto LAB_18001eadc;
}
iVar3 = *(int *)(pwVar10 + 0x308);
unaff_EDI = in_stack_00000058;
if (iVar3 == 0x17) {
pwVar14 = L"ECDH_P256";
unaff_RBX = in_stack_000000d8;
unaff_SIL = in_stack_000000d0;
goto LAB_18001ea0a;
}
if (iVar3 != 0x18) {
if (iVar3 == 0x19) {
uVar5 = FUN_180032092();
return uVar5;
}
goto LAB_18001ea38;
}
pwVar14 = L"ECDH_P384";
unaff_RBX = in_stack_000000d8;
unaff_SIL = in_stack_000000d0;
} while( true );
}
=========================================
Function at address: 0x180032107
Called functions addresses: 0x18005a0dc 0x18001ecaf 0x180041d70


ulonglong FUN_180032107(undefined8 param_1,undefined8 param_2,undefined *param_3,undefined param_4,
undefined4 param_5)

{
uint *puVar1;
int iVar2;
uint uVar3;
int iVar4;
undefined4 in_EAX;
undefined8 uVar5;
ulonglong uVar6;
uint uVar7;
wchar_t *_Str1;
undefined uVar8;
undefined2 uVar9;
undefined1 unaff_BL;
uint *puVar10;
wchar_t *pwVar11;
wchar_t *unaff_RBP;
int *piVar12;
wchar_t *pwVar13;
longlong in_R10;
char cVar14;
char unaff_R12B;
uint uVar15;
uint unaff_R13D;
longlong lVar16;
longlong unaff_R14;
undefined uStack0000000000000030;
char in_stack_00000038;
char in_stack_00000040;
int in_stack_00000044;
undefined uStack0000000000000048;
undefined uStack0000000000000050;
uint in_stack_00000058;
longlong *in_stack_00000060;
char in_stack_000000b0;
longlong in_stack_000000b8;
char in_stack_000000d0;
longlong in_stack_000000d8;
int *in_stack_000000e0;
undefined *in_stack_000000e8;

param_5._0_1_ = (undefined)in_EAX;
pwVar13 = unaff_RBP;
FUN_18005a0dc(*(undefined8 *)(in_R10 + 0x10),0x30,param_3,unaff_RBP,unaff_BL,(undefined)param_5);
lVar16 = unaff_R14;
cVar14 = unaff_R12B;
param_5 = in_EAX;
LAB_18001eadc:
pwVar11 = unaff_RBP;
unaff_RBP = pwVar11 + 0x186;
iVar4 = in_stack_00000044;
if ((wchar_t *)((ulonglong)*(uint *)(in_stack_00000060 + 1) * 0x30c + *in_stack_00000060) <=
unaff_RBP) goto LAB_18001ec41;
uVar3 = *(uint *)(*(longlong *)(lVar16 + 0x50) + 0xc4);
puVar1 = *(uint **)(*(longlong *)(lVar16 + 0x50) + 200);
lVar16 = in_stack_000000b8;
cVar14 = in_stack_000000b0;
if (((uVar3 != 0) && (puVar1 != (uint *)0x0)) && (unaff_RBP != (wchar_t *)0x0)) {
uVar15 = *(uint *)(pwVar11 + 0x306);
for (puVar10 = puVar1; puVar10 < puVar1 + (ulonglong)uVar3 * 10; puVar10 = puVar10 + 10) {
if (puVar10[5] != 0) {
if (*puVar10 == 0) {
LAB_18001eb6e:
if (((in_stack_000000d0 == '\0') || ((*(byte *)(puVar10 + 8) & 1) == 0)) &&
(piVar12 = *(int **)(puVar10 + 6), piVar12 < piVar12 + (ulonglong)puVar10[5] * 0xc)) {
do {
if ((*piVar12 == 0) && (*(short *)(piVar12 + 2) == 8)) {
_Str1 = *(wchar_t **)(piVar12 + 4);
uVar8 = 0xd8;
param_3 = (undefined *)0x4;
iVar4 = wcsncmp(_Str1,L"ECDH",4);
if (iVar4 == 0) {
if (((piVar12[6] == 0) && (piVar12[10] == 0)) && (piVar12[0xb] == 0)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18001eadc;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar13 = L"ECDH";
param_3 = &DAT_180082b78;
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDH",0);
}
goto LAB_1800320ac;
}
if (uVar15 != 0) {
if (piVar12[10] == 0) {
if (piVar12[0xb] != 0) {
uVar6 = FUN_18003201a((char)_Str1,uVar8,(char)param_3,(char)pwVar13,param_5)
;
return uVar6;
}
}
else {
if (uVar15 < (uint)piVar12[10]) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18001eadc;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar13 = L"ECDH";
param_5 = 0;
param_3 = &DAT_180082b78;
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDH",(char)uVar15,0);
}
goto LAB_1800320ac;
}
if (piVar12[0xb] != 0) {
uVar6 = FUN_18003201a((char)_Str1,uVar8,(char)param_3,(char)pwVar13,param_5)
;
return uVar6;
}
}
}
}
}
piVar12 = piVar12 + 0xc;
} while (piVar12 < (int *)((ulonglong)puVar10[5] * 0x30 + *(longlong *)(puVar10 + 6)));
}
}
else if (in_stack_000000d8 != 0) {
uVar6 = 0;
do {
iVar4 = RtlCompareUnicodeString
(uVar6 * 0x10 + *(longlong *)(puVar10 + 2),in_stack_000000d8);
if (iVar4 == 0) goto LAB_18001eb6e;
uVar7 = (int)uVar6 + 1;
uVar6 = (ulonglong)uVar7;
} while (uVar7 < *puVar10);
}
}
}
param_3 = (undefined *)0x0;
pwVar13 = unaff_RBP;
uVar5 = FUN_1800077a0(puVar1,uVar3,0,unaff_RBP,(wchar_t *)0x0,0,in_stack_000000d8,
in_stack_000000d0);
if ((char)uVar5 != '\0') {
LAB_18003209e:
in_stack_00000038 = in_stack_000000d0;
_uStack0000000000000030 = in_stack_000000d8;
param_5 = 0;
LAB_1800320ac:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_3 = &DAT_180085700;
pwVar13 = unaff_RBP;
FUN_180041d70(DAT_180091000[2],0x2f,&DAT_180085700,unaff_RBP);
}
goto LAB_18001eadc;
}
iVar4 = *(int *)(pwVar11 + 0x308);
if (iVar4 == 0x17) {
pwVar13 = L"ECDH_P256";
LAB_18001ea0a:
param_3 = (undefined *)0x0;
uVar5 = FUN_1800077a0(puVar1,uVar3,0,pwVar13,(wchar_t *)0x0,0,in_stack_000000d8,
in_stack_000000d0);
if ((char)uVar5 != '\0') goto LAB_18003209e;
}
else {
if (iVar4 == 0x18) {
pwVar13 = L"ECDH_P384";
goto LAB_18001ea0a;
}
if (iVar4 == 0x19) {
uVar6 = FUN_180032092();
return uVar6;
}
}
in_stack_00000038 = in_stack_000000d0;
_uStack0000000000000030 = in_stack_000000d8;
param_5 = 0;
}
iVar4 = *(int *)(pwVar11 + 0x308);

if (((uVar3 != 0) && (uVar3 != 0x490)) && (uVar3 != 0x32)) {
return (ulonglong)uVar3;
}
if (in_stack_000000b0 == '\0') {
if (uVar3 == 0x32) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar9 = 0x31;
LAB_180032154:
param_3 = &DAT_180085700;
pwVar13 = unaff_RBP;
FUN_180041d70(DAT_180091000[2],uVar9,&DAT_180085700,unaff_RBP);
}
}
else {
uVar7 = (*(uint *)(pwVar11 + 0x306) & 1) + *(uint *)(pwVar11 + 0x306) >> 1;
uVar15 = unaff_R13D;
iVar2 = _uStack0000000000000048;
if (uVar3 == 0x490) {
if ((in_stack_00000044 == 0) &&
((_uStack0000000000000048 != 0 ||
((*(int *)(in_stack_000000b8 + 0x44) == 0 &&
(uVar15 = uVar7, iVar2 = iVar4, in_stack_00000040 != '\0')))))) {
LAB_18001eaad:
_uStack0000000000000048 = iVar2;
unaff_R13D = uVar15;
if (uVar15 != in_stack_00000058) {
if (uVar7 != in_stack_00000058) goto LAB_18001eaba;
code_r0x00018001ecaf:
unaff_R13D = uVar7;
if (in_stack_00000044 == 0) {
if (_uStack0000000000000048 != 0) {
_uStack0000000000000048 = *(int *)(pwVar11 + 0x308);
}
}
else {
iVar4 = *(int *)(pwVar11 + 0x308);
in_stack_00000044 = iVar4;
if (uVar7 == in_stack_00000058) {
LAB_18001ec41:
if ((iVar4 == 0) && (_uStack0000000000000048 == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x33,&DAT_180085700);
}
uVar6 = 0x80090331;
}
else {
if ((cVar14 != '\0') && (iVar4 != _uStack0000000000000050)) {
uVar6 = FUN_1800321f7();
return uVar6;
}
if ((iVar4 == 0) && (_uStack0000000000000048 != 0)) {
*in_stack_000000e8 = 1;
}
else {
*in_stack_000000e8 = 0;
_uStack0000000000000048 = iVar4;
}
uVar6 = 0;
*in_stack_000000e0 = _uStack0000000000000048;
}
return uVar6;
}
}
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar9 = 0x32;
goto LAB_180032154;
}
}
else {
if (in_stack_00000044 != 0) goto LAB_18001eaad;
_uStack0000000000000048 = 0;
uVar15 = uVar7;
in_stack_00000044 = iVar4;
if (uVar7 == in_stack_00000058) goto LAB_18001ec41;
LAB_18001eaba:
if ((uVar15 < in_stack_00000058) && (uVar15 < uVar7)) goto code_r0x00018001ecaf;
unaff_R13D = uVar15;
if ((in_stack_00000058 < uVar15) && ((uVar7 < uVar15 && (in_stack_00000058 < uVar7)))) {
uVar6 = FUN_18001ecaf(uVar7,(char)uVar3,(char)param_3,(char)pwVar13,(undefined)param_5,
uStack0000000000000030,in_stack_00000038,in_stack_00000040,
uStack0000000000000048,uStack0000000000000050,in_stack_00000044);
return uVar6;
}
}
}
}
else {
if ((uVar3 == 0) && (iVar4 == _uStack0000000000000050)) goto LAB_18001ec41;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar6 = FUN_180032107(&DAT_180091000,(ulonglong)uVar3,param_3,(char)pwVar13,param_5);
return uVar6;
}
}
goto LAB_18001eadc;
}
=========================================
Function at address: 0x1800321f7
Called functions addresses: 0x180041d20


undefined8 FUN_1800321f7(void)

{
undefined1 in_AL;
undefined4 unaff_EBX;
undefined8 *in_R10;

if ((in_R10 != &DAT_180091000) && ((*(byte *)((longlong)in_R10 + 0x1c) & 4) != 0)) {
FUN_180041d20(in_R10[2],0x34,&DAT_180085700,unaff_EBX,in_AL);
}
return 0x80090331;
}
=========================================
Function at address: 0x1800327ba
Called functions addresses: 0x18000909c 0x1800272fc 0x18005df3c 0x180029f58 0x18006049c 0x18000404c 0x18002a7c0 0x180041e9c


ulonglong FUN_1800327ba(void)

{
int iVar1;
int *piVar2;
char cVar3;
ushort uVar4;
uint uVar5;
uint uVar6;
ulonglong uVar7;
undefined8 *puVar8;
undefined8 uVar9;
HLOCAL pvVar10;
longlong lVar11;
ulonglong uVar12;
char cVar13;
longlong *plVar14;
ulonglong uVar16;
undefined8 *unaff_RBP;
longlong *unaff_RSI;
undefined8 unaff_RDI;
char cVar17;
undefined in_R9B;
int *piVar18;
undefined4 *puVar19;
ulonglong unaff_R12;
ulonglong unaff_R14;
int *unaff_R15;
bool bVar20;
undefined4 extraout_XMM0_Da;
undefined4 extraout_XMM0_Da_00;
undefined4 uVar21;
undefined4 extraout_XMM0_Da_01;
undefined4 extraout_XMM0_Da_02;
undefined4 extraout_XMM0_Da_03;
undefined4 extraout_XMM0_Da_04;
undefined4 extraout_XMM0_Da_05;
undefined in_stack_00000028;
undefined in_stack_00000030;
undefined in_stack_00000038;
undefined in_stack_00000040;
undefined in_stack_00000048;
undefined in_stack_00000050;
int *in_stack_00000070;
ulonglong in_stack_00000078;
uint *puVar15;

if (*(char *)((longlong)unaff_RSI + 0x10a) == '\0') {
FUN_18006049c(unaff_RSI);
}
else {
*(undefined *)((longlong)unaff_RSI + 0x39b) = 1;
FUN_18000404c((longlong)unaff_RSI,0);
}
unaff_RSI[0x11] = unaff_RSI[0x11] | in_stack_00000078;
if ((*(uint *)((longlong)unaff_RSI + 0x44) & 0xfffffffb) == 0) {

uVar7 = (ulonglong)uVar5;
if (uVar5 == 0) {

uVar7 = (ulonglong)uVar5;
if (uVar5 == 0) {

uVar7 = (ulonglong)uVar5;
if (uVar5 == 0) goto LAB_18001f168;
}
}
LAB_18001f344:
puVar19 = (undefined4 *)unaff_RBP[0x12];
uVar5 = *(uint *)(unaff_RBP + 0x15);
}
else {
LAB_18001f168:

uVar7 = (ulonglong)uVar5;
if (uVar5 != 0) goto LAB_18001f344;

uVar7 = (ulonglong)uVar5;
if (uVar5 != 0) goto LAB_18001f344;
cVar17 = (char)unaff_RBP[-0xc];
cVar13 = (char)unaff_RBP[0x14];

uVar7 = (ulonglong)uVar5;
if (uVar5 != 0) {
if ((*(int *)((longlong)unaff_RSI + 0x44) == 4) && (uVar5 == 0x90316)) {
uVar5 = (uint)unaff_RDI;
uVar21 = extraout_XMM0_Da_00;
LAB_18001f289:
if (((ulonglong)unaff_RSI[0x11] >> 0x1c & 1) != 0) {
unaff_R12 = unaff_R12 | 0x8000;
unaff_RSI[0x11] = unaff_RSI[0x11] & 0xffffffffefffffff;
}
if ((uVar5 != 0) && (in_stack_00000070[9] == 0)) {
uVar7 = FUN_1800329aa();
return uVar7;
}
if (unaff_RBP[0x12] != 0) {
puVar8 = unaff_RBP + -6;
plVar14 = unaff_RSI;
uVar7 = unaff_R14;
uVar21 = FUN_180044054(uVar5,unaff_RSI,unaff_R14,(undefined4 *)puVar8);
in_R9B = SUB81(puVar8,0);
cVar17 = (char)uVar7;
cVar13 = (char)plVar14;
}
if ((uVar5 == 0x90320) && (puVar15 = (uint *)unaff_RBP[-0x10], puVar15 != (uint *)0x0)) {
FUN_180044114(unaff_RSI,puVar15);
cVar13 = (char)puVar15;
uVar21 = extraout_XMM0_Da_05;
}
if ((unaff_RBP[0x13] == 0) && (uVar5 != 0)) {
uVar7 = FUN_1800329e7((uint)*(ushort *)((longlong)unaff_RSI + 0x22),cVar13,cVar17,in_R9B,
in_stack_00000028,in_stack_00000030,in_stack_00000038,
in_stack_00000040,in_stack_00000048,in_stack_00000050,
in_stack_00000070);
return uVar7;
}
*(int **)unaff_RBP[0x17] = in_stack_00000070;
uVar5 = FUN_18000d7d0(uVar21,unaff_RSI,in_stack_00000070,(undefined4 *)unaff_RBP[0x1c],
(int *)unaff_RBP[5],(uint *)unaff_RBP[-9],(longlong)(unaff_RBP + -8),
unaff_R15,(longlong)(unaff_RBP + -0xe),unaff_R14,
(undefined *)unaff_RBP[0x1b],(undefined8 *)unaff_RBP[0x1a]);
uVar7 = (ulonglong)uVar5;
if (((uVar5 == 0) && (unaff_RSI != (longlong *)0x0)) &&
(*(int *)((longlong)unaff_RSI + 0x44) == 4)) {
unaff_RBP[-0x10] = unaff_RDI;

if (*(longlong *)(unaff_RBP[-0x10] + 0x158) != 0) {
unaff_R12 = unaff_R12 | 2;
}
puVar19 = (undefined4 *)unaff_RBP[0x12];
uVar16 = (ulonglong)*(uint *)(unaff_RBP + 0x15);
if ((*(uint *)(unaff_RSI + 0x11) >> 0x16 & 1) != 0) {
unaff_R12 = unaff_R12 | 0x40;
}
goto LAB_18001f35b;
}
}
goto LAB_18001f344;
}
if ((unaff_R14 & 0x100) != 0) {
uVar7 = 1;
}

in_R9B = (undefined)uVar7;

uVar7 = (ulonglong)uVar5;
if (uVar5 != 0) goto LAB_18001f344;
cVar3 = (char)unaff_RBP;
cVar17 = cVar3 + -0x70;
cVar13 = cVar3 + -0x40;

if ((uVar5 != 0x54f) || ((*(uint *)(unaff_RSI + 0x11) >> 0x12 & 1) == 0)) {
unaff_RDI = 0;
uVar21 = extraout_XMM0_Da_01;
goto LAB_18001f289;
}
piVar2 = in_stack_00000070;
if (((unaff_RBP[0x13] == 0) &&
(unaff_RSI = *(longlong **)(in_stack_00000070 + 4), unaff_RSI != (longlong *)0x0)) &&
(piVar2 = (int *)unaff_RSI[0x10], piVar2 != (int *)0x0)) {
lVar11 = *(longlong *)(in_stack_00000070 + 2);
in_stack_00000070[4] = 0;
in_stack_00000070[5] = 0;
uVar5 = *(uint *)(lVar11 + 0x40);
iVar1 = *(int *)(lVar11 + 0x44);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
piVar18 = in_stack_00000070;
FUN_180041e9c(DAT_180091000[2],0x12,&DAT_180082b58,in_stack_00000070);
in_R9B = SUB81(piVar18,0);
lVar11 = *(longlong *)(in_stack_00000070 + 2);
}
if (lVar11 != 0) {
uVar6 = *(uint *)(lVar11 + 0x40);

if ((uVar6 & 0x800a2aaa) != 0) {
FUN_18000909c(*(HLOCAL *)(in_stack_00000070 + 2));
}
in_stack_00000070[2] = 0;
in_stack_00000070[3] = 0;
}
if ((uVar5 & 0x51550) == 0) {
FUN_18000909c(in_stack_00000070);
}
else {
lVar11 = *(longlong *)(in_stack_00000070 + 6);
cVar13 = *(char *)(in_stack_00000070 + 8);
if (lVar11 != 0) {
if (iVar1 == 4) {

if (DAT_180092db8 <= uVar4) {
DAT_180092db8 = (uint)uVar4;
}
LOCK();
iVar1 = DAT_180092db4 + 1;
UNLOCK();
bVar20 = DAT_180092db4 == 99;
DAT_180092db4 = iVar1;
if ((bVar20) && (DAT_180092dd8 != (undefined8 *)0x0)) {
DAT_180092dc0 = DAT_180092db8;
if (DAT_180092de0 == 0) {
puVar8 = (undefined8 *)FUN_180029f58(0x50);
if (puVar8 != (undefined8 *)0x0) {
puVar8 = FUN_1800272fc(puVar8,DAT_180092dc0,1);
goto LAB_1800328e9;
}
}
else {
puVar8 = (undefined8 *)FUN_180029f58(0x80);
if (puVar8 != (undefined8 *)0x0) {
puVar8 = FUN_18005df3c(puVar8,DAT_180092dc0,DAT_180092de0);
LAB_1800328e9:
if (puVar8 != (undefined8 *)0x0) {
DAT_180092dd8 = puVar8;
}
}
}
}
}
puVar8 = DAT_180092dd8;
if (cVar13 == '\0') {


}
else {

FUN_18000909c(pvVar10);
}
}
in_stack_00000070[6] = 0;
in_stack_00000070[7] = 0;

unaff_R12 = unaff_RBP[-0xb];
}
unaff_RDI = 0;
cVar17 = cVar3 + -0x70;
cVar13 = cVar3 + -0x40;

unaff_R14 = unaff_RBP[-10];
uVar21 = extraout_XMM0_Da_04;
in_stack_00000070 = piVar2;
goto LAB_18001f289;
}
in_stack_00000070 = piVar2;
unaff_R14 = unaff_RBP[-10];
uVar7 = 0x54f;
puVar19 = (undefined4 *)unaff_RBP[0x12];
uVar5 = *(uint *)(unaff_RBP + 0x15);
}
uVar16 = (ulonglong)uVar5;
LAB_18001f35b:
uVar5 = (uint)uVar7;
if (((*unaff_R15 == 0) || (*(uint *)(unaff_RBP + -0xe) < *(uint *)((longlong)unaff_RBP + -0x6c)))
|| (uVar5 == 0x8009036b)) {
unaff_R12 = unaff_R12 & 0xffffffffffff7fff;
}
else if ((unaff_R14 >> 0xf & 1) != 0) {
unaff_R12 = unaff_R12 | 0x8000;
}
if (puVar19 != (undefined4 *)0x0) {
*(undefined8 *)(puVar19 + 2) = unaff_RBP[-5];
*puVar19 = *(undefined4 *)((longlong)unaff_RBP + -0x2c);
}
if ((undefined4 *)unaff_RBP[0x19] != (undefined4 *)0x0) {
*(undefined4 *)unaff_RBP[0x19] = (int)unaff_R12;
}
if ((ulonglong *)unaff_RBP[6] != (ulonglong *)0x0) {
*(ulonglong *)unaff_RBP[6] = unaff_R12 & 0xffffffff00000000;
}
if (((int)uVar16 != 0) && (in_stack_00000070 != (int *)0x0)) {
LOCK();
*in_stack_00000070 = *in_stack_00000070 + -1;
UNLOCK();
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar16 = 0x33;
FUN_180041cdc(DAT_180091000[2],0x33,&DAT_180084d00,uVar5);
}
if (((byte)DAT_180092f00 & 1) != 0) {
uVar12 = uVar7;
uVar6 = FUN_18000c3a8(uVar5);
FUN_180044528(uVar12,uVar16,*(undefined8 *)unaff_RBP[0x17],uVar6);
}
if ((uVar5 & 0x1fff0000) == 0x90000) {
if (uVar5 + 0x7ff6ffff < 0x2f) {
return 0x80090304;
}
if (((0x100e < uVar5 + 0x7ff6efff) && (0xfec < uVar5 + 0x7ff6dfec)) && (uVar5 != 0x80092011)) {
return uVar7;
}
}
else if (uVar5 == 0) {
return 0;
}
if (uVar5 < 0x80092005) {
if (uVar5 == 0x80092004) {
return 0x8009030d;
}
if (uVar5 == 0xe) {
return 0x80090300;
}
if (uVar5 == 0x57) {
return 0x8009035d;
}
if (uVar5 == 0x78) {
return 0x80090302;
}
if (uVar5 == 0x7a) {
return 0x80090321;
}
}
else {
if ((uVar5 == 0x800b0101) || (uVar5 == 0x800b0102)) {
return 0x80090328;
}
if (uVar5 == 0x800b0109) {
return 0x80090325;
}
if (uVar5 == 0x800b010c) {
return 0x80092010;
}
if (uVar5 == 0x800b010f) {
return 0x80090322;
}
}
return 0x80090304;
}
=========================================
Function at address: 0x1800329aa
Called functions addresses: 0x180044054 0x180044114


ulonglong FUN_1800329aa(void)

{
uint uVar1;
uint uVar2;
longlong in_RAX;
ulonglong uVar3;
undefined in_DL;
longlong *plVar4;
uint *puVar5;
ulonglong uVar6;
uint unaff_EBX;
longlong unaff_RBP;
longlong *unaff_RSI;
undefined8 unaff_RDI;
undefined in_R8B;
undefined in_R9B;
undefined4 *puVar7;
ulonglong unaff_R12;
ulonglong unaff_R14;
int *unaff_R15;
undefined4 in_XMM0_Da;
undefined4 extraout_XMM0_Da;
undefined in_stack_00000028;
undefined in_stack_00000030;
undefined in_stack_00000038;
undefined in_stack_00000040;
undefined in_stack_00000048;
undefined in_stack_00000050;
int *in_stack_00000070;

*(uint *)(in_RAX + 0x24) = unaff_EBX;
if (*(longlong *)(unaff_RBP + 0x90) != 0) {
puVar7 = (undefined4 *)(unaff_RBP + -0x30);
plVar4 = unaff_RSI;
uVar6 = unaff_R14;
in_XMM0_Da = FUN_180044054(unaff_EBX,unaff_RSI,unaff_R14,puVar7);
in_R9B = SUB81(puVar7,0);
in_R8B = (undefined)uVar6;
in_DL = SUB81(plVar4,0);
}
if ((unaff_EBX == 0x90320) && (puVar5 = *(uint **)(unaff_RBP + -0x80), puVar5 != (uint *)0x0)) {
FUN_180044114(unaff_RSI,puVar5);
in_DL = SUB81(puVar5,0);
in_XMM0_Da = extraout_XMM0_Da;
}
if ((*(longlong *)(unaff_RBP + 0x98) == 0) && (unaff_EBX != 0)) {
uVar6 = FUN_1800329e7((uint)*(ushort *)((longlong)unaff_RSI + 0x22),in_DL,in_R8B,in_R9B,
in_stack_00000028,in_stack_00000030,in_stack_00000038,in_stack_00000040,
in_stack_00000048,in_stack_00000050,in_stack_00000070);
return uVar6;
}
**(undefined8 **)(unaff_RBP + 0xb8) = in_stack_00000070;
uVar1 = FUN_18000d7d0(in_XMM0_Da,unaff_RSI,in_stack_00000070,*(undefined4 **)(unaff_RBP + 0xe0),
*(int **)(unaff_RBP + 0x28),*(uint **)(unaff_RBP + -0x48),unaff_RBP + -0x40,
unaff_R15,unaff_RBP + -0x70,unaff_R14,*(undefined **)(unaff_RBP + 0xd8),
*(undefined8 **)(unaff_RBP + 0xd0));
if (((uVar1 == 0) && (unaff_RSI != (longlong *)0x0)) &&
(*(int *)((longlong)unaff_RSI + 0x44) == 4)) {
*(undefined8 *)(unaff_RBP + -0x80) = unaff_RDI;

if (*(longlong *)(*(longlong *)(unaff_RBP + -0x80) + 0x158) != 0) {
unaff_R12 = unaff_R12 | 2;
}
puVar7 = *(undefined4 **)(unaff_RBP + 0x90);
uVar6 = (ulonglong)*(uint *)(unaff_RBP + 0xa8);
if ((*(uint *)(unaff_RSI + 0x11) >> 0x16 & 1) != 0) {
unaff_R12 = unaff_R12 | 0x40;
}
}
else {
puVar7 = *(undefined4 **)(unaff_RBP + 0x90);
uVar6 = (ulonglong)*(uint *)(unaff_RBP + 0xa8);
}
if (((*unaff_R15 == 0) || (*(uint *)(unaff_RBP + -0x70) < *(uint *)(unaff_RBP + -0x6c))) ||
(uVar1 == 0x8009036b)) {
unaff_R12 = unaff_R12 & 0xffffffffffff7fff;
}
else if ((unaff_R14 >> 0xf & 1) != 0) {
unaff_R12 = unaff_R12 | 0x8000;
}
if (puVar7 != (undefined4 *)0x0) {
*(undefined8 *)(puVar7 + 2) = *(undefined8 *)(unaff_RBP + -0x28);
*puVar7 = *(undefined4 *)(unaff_RBP + -0x2c);
}
if (*(undefined4 **)(unaff_RBP + 200) != (undefined4 *)0x0) {
**(undefined4 **)(unaff_RBP + 200) = (int)unaff_R12;
}
if (*(ulonglong **)(unaff_RBP + 0x30) != (ulonglong *)0x0) {
**(ulonglong **)(unaff_RBP + 0x30) = unaff_R12 & 0xffffffff00000000;
}
if (((int)uVar6 != 0) && (in_stack_00000070 != (int *)0x0)) {
LOCK();
*in_stack_00000070 = *in_stack_00000070 + -1;
UNLOCK();
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar6 = 0x33;
FUN_180041cdc(DAT_180091000[2],0x33,&DAT_180084d00,uVar1);
}
if (((byte)DAT_180092f00 & 1) != 0) {
uVar3 = (ulonglong)uVar1;
uVar2 = FUN_18000c3a8(uVar1);
FUN_180044528(uVar3,uVar6,**(undefined8 **)(unaff_RBP + 0xb8),uVar2);
}
if ((uVar1 & 0x1fff0000) == 0x90000) {
if (0x2e < uVar1 + 0x7ff6ffff) {
if (((0x100e < uVar1 + 0x7ff6efff) && (0xfec < uVar1 + 0x7ff6dfec)) && (uVar1 != 0x80092011))
goto LAB_18001f462;
goto LAB_180032ae2;
}
}
else {
if (uVar1 == 0) {
return 0;
}
LAB_180032ae2:
if (uVar1 < 0x80092005) {
if (uVar1 == 0x80092004) {
uVar1 = 0x8009030d;
goto LAB_18001f462;
}
if (uVar1 == 0xe) {
uVar1 = 0x80090300;
goto LAB_18001f462;
}
if (uVar1 == 0x57) {
uVar1 = 0x8009035d;
goto LAB_18001f462;
}
if (uVar1 == 0x78) {
uVar1 = 0x80090302;
goto LAB_18001f462;
}
if (uVar1 == 0x7a) {
uVar1 = 0x80090321;
goto LAB_18001f462;
}
}
else {
if ((uVar1 == 0x800b0101) || (uVar1 == 0x800b0102)) {
uVar1 = 0x80090328;
goto LAB_18001f462;
}
if (uVar1 == 0x800b0109) {
uVar1 = 0x80090325;
goto LAB_18001f462;
}
if (uVar1 == 0x800b010c) {
uVar1 = 0x80092010;
goto LAB_18001f462;
}
if (uVar1 == 0x800b010f) {
uVar1 = 0x80090322;
goto LAB_18001f462;
}
}
}
uVar1 = 0x80090304;
LAB_18001f462:
return (ulonglong)uVar1;
}
=========================================
Function at address: 0x1800329e7
Called functions addresses: 0x180041cdc 0x180044528 0x18005aecc 0x18002a7c0 0x18000c3a8


/* WARNING: Variable defined which should be unmapped: param_9 */
/* WARNING: Variable defined which should be unmapped: param_7 */

ulonglong FUN_1800329e7(uint param_1,undefined param_2,undefined param_3,undefined param_4,
undefined param_5,undefined param_6,undefined param_7,undefined param_8,
undefined param_9,undefined param_10,int *param_11)

{
uint uVar1;
uint uVar2;
ulonglong uVar3;
ulonglong uVar4;
int unaff_EBX;
longlong unaff_RBP;
longlong *unaff_RSI;
longlong *unaff_RDI;
undefined4 *puVar5;
ulonglong unaff_R12;
ulonglong unaff_R14;
int *unaff_R15;
undefined4 in_XMM0_Da;

if (((unaff_EBX == 0x90316) || (unaff_EBX == -0x7ff6fc96)) ||
(((char)(param_1 >> 8) == -2 && ((param_1 < 0xff00 && (unaff_EBX == 0x90364)))))) {
**(undefined8 **)(unaff_RBP + 0xb8) = param_11;
}
else {
if (((unaff_R14 & 0x100) != 0) && (*(longlong *)(unaff_RBP + -0x68) != 0)) {

*(longlong **)(unaff_RBP + -0x68) = unaff_RDI;
}
in_XMM0_Da = FUN_18005aecc(0x180092da0,param_11);
unaff_RSI = unaff_RDI;
}
uVar1 = FUN_18000d7d0(in_XMM0_Da,unaff_RSI,param_11,*(undefined4 **)(unaff_RBP + 0xe0),
*(int **)(unaff_RBP + 0x28),*(uint **)(unaff_RBP + -0x48),unaff_RBP + -0x40,
unaff_R15,unaff_RBP + -0x70,unaff_R14,*(undefined **)(unaff_RBP + 0xd8),
*(undefined8 **)(unaff_RBP + 0xd0));
if (((uVar1 == 0) && (unaff_RSI != (longlong *)0x0)) &&
(*(int *)((longlong)unaff_RSI + 0x44) == 4)) {
*(longlong **)(unaff_RBP + -0x80) = unaff_RDI;

if (*(longlong *)(*(longlong *)(unaff_RBP + -0x80) + 0x158) != 0) {
unaff_R12 = unaff_R12 | 2;
}
puVar5 = *(undefined4 **)(unaff_RBP + 0x90);
uVar4 = (ulonglong)*(uint *)(unaff_RBP + 0xa8);
if ((*(uint *)(unaff_RSI + 0x11) >> 0x16 & 1) != 0) {
unaff_R12 = unaff_R12 | 0x40;
}
}
else {
puVar5 = *(undefined4 **)(unaff_RBP + 0x90);
uVar4 = (ulonglong)*(uint *)(unaff_RBP + 0xa8);
}
if (((*unaff_R15 == 0) || (*(uint *)(unaff_RBP + -0x70) < *(uint *)(unaff_RBP + -0x6c))) ||
(uVar1 == 0x8009036b)) {
unaff_R12 = unaff_R12 & 0xffffffffffff7fff;
}
else if ((unaff_R14 >> 0xf & 1) != 0) {
unaff_R12 = unaff_R12 | 0x8000;
}
if (puVar5 != (undefined4 *)0x0) {
*(undefined8 *)(puVar5 + 2) = *(undefined8 *)(unaff_RBP + -0x28);
*puVar5 = *(undefined4 *)(unaff_RBP + -0x2c);
}
if (*(undefined4 **)(unaff_RBP + 200) != (undefined4 *)0x0) {
**(undefined4 **)(unaff_RBP + 200) = (int)unaff_R12;
}
if (*(ulonglong **)(unaff_RBP + 0x30) != (ulonglong *)0x0) {
**(ulonglong **)(unaff_RBP + 0x30) = unaff_R12 & 0xffffffff00000000;
}
if (((int)uVar4 != 0) && (param_11 != (int *)0x0)) {
LOCK();
*param_11 = *param_11 + -1;
UNLOCK();
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar4 = 0x33;
FUN_180041cdc(DAT_180091000[2],0x33,&DAT_180084d00,uVar1);
}
if (((byte)DAT_180092f00 & 1) != 0) {
uVar3 = (ulonglong)uVar1;
uVar2 = FUN_18000c3a8(uVar1);
FUN_180044528(uVar3,uVar4,**(undefined8 **)(unaff_RBP + 0xb8),uVar2);
}
if ((uVar1 & 0x1fff0000) == 0x90000) {
if (0x2e < uVar1 + 0x7ff6ffff) {
if (((0x100e < uVar1 + 0x7ff6efff) && (0xfec < uVar1 + 0x7ff6dfec)) && (uVar1 != 0x80092011))
goto LAB_18001f462;
goto LAB_180032ae2;
}
}
else {
if (uVar1 == 0) {
return 0;
}
LAB_180032ae2:
if (uVar1 < 0x80092005) {
if (uVar1 == 0x80092004) {
uVar1 = 0x8009030d;
goto LAB_18001f462;
}
if (uVar1 == 0xe) {
uVar1 = 0x80090300;
goto LAB_18001f462;
}
if (uVar1 == 0x57) {
uVar1 = 0x8009035d;
goto LAB_18001f462;
}
if (uVar1 == 0x78) {
uVar1 = 0x80090302;
goto LAB_18001f462;
}
if (uVar1 == 0x7a) {
uVar1 = 0x80090321;
goto LAB_18001f462;
}
}
else {
if ((uVar1 == 0x800b0101) || (uVar1 == 0x800b0102)) {
uVar1 = 0x80090328;
goto LAB_18001f462;
}
if (uVar1 == 0x800b0109) {
uVar1 = 0x80090325;
goto LAB_18001f462;
}
if (uVar1 == 0x800b010c) {
uVar1 = 0x80092010;
goto LAB_18001f462;
}
if (uVar1 == 0x800b010f) {
uVar1 = 0x80090322;
goto LAB_18001f462;
}
}
}
uVar1 = 0x80090304;
LAB_18001f462:
return (ulonglong)uVar1;
}
=========================================
Function at address: 0x1800336b4
Called functions addresses: None


ulonglong FUN_1800336b4(undefined8 param_1,ulonglong param_2,undefined8 param_3,ulonglong param_4)

{
uint uVar1;
uint uVar2;
uint *puVar3;
undefined8 uVar4;
undefined4 extraout_var;
uint *in_RAX;
uint uVar5;
uint uVar6;
ulonglong uVar7;
uint *puVar8;
undefined2 uVar9;
longlong unaff_RBX;
uint in_R10D;
uint in_R11D;
int *unaff_R12;
wchar_t *unaff_R13;
uint unaff_R14D;
ulonglong unaff_R15;
bool bVar10;
bool bVar11;
uint in_stack_000000a0;
uint in_stack_000000a8;
longlong in_stack_000000c0;
uint *in_stack_000000c8;
uint in_stack_000000d0;
char in_stack_000000d8;

if ((int)in_RAX == 0x1fe) {
if (((uint **)DAT_180091000 != &DAT_180091000) && ((*(byte *)(DAT_180091000 + 7) & 4) != 0)) {
uVar4 = FUN_1800336c4((longlong)DAT_180091000);
return uVar4;
}
goto LAB_180007718;
}
if ((*(char *)(unaff_RBX + 0x48) != (char)param_2) || (*(int *)(unaff_RBX + 0x2c) == 0x8003))
goto LAB_180007718;
in_RAX = (uint *)(ulonglong)in_stack_000000a8;
if (in_stack_000000a8 == 0) {
if (in_stack_000000a0 != 0) goto LAB_1800074a8;
if (*(int *)(unaff_RBX + 0x28) == 0x6000) goto LAB_1800074be;
if (((uint **)DAT_180091000 == &DAT_180091000) || ((*(byte *)(DAT_180091000 + 7) & 4) == 0))
goto LAB_180007718;
uVar9 = 0xc;
LAB_1800339b8:
in_RAX = (uint *)FUN_180041d70(*(undefined8 *)(DAT_180091000 + 4),uVar9,&DAT_180085700,unaff_R13
);
}
else {
if (in_stack_000000a0 == 0) {
LAB_1800074b5:
if (*(uint *)(unaff_RBX + 0x14) < in_stack_000000a8) {
if (((uint **)DAT_180091000 != &DAT_180091000) && ((*(byte *)(DAT_180091000 + 7) & 4) != 0))
{
uVar2 = FUN_180033741((longlong)DAT_180091000);
return CONCAT44(extraout_var,uVar2);
}
goto LAB_180007718;
}
LAB_1800074be:
uVar2 = *(uint *)(unaff_RBX + 0x20);
puVar3 = &DAT_1800914c0;
uVar7 = param_2 & 0xffffffff;
do {
if (*puVar3 == uVar2) {
in_RAX = &DAT_1800914c0 + uVar7 * 0x10;
if ((in_RAX != (uint *)0x0) && (((&DAT_1800914c4)[uVar7 * 0x10] & in_R10D) == 0)) {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar9 = 0xf;
goto LAB_1800339b8;
}
break;
}
uVar5 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar5;
puVar3 = puVar3 + 0x10;
} while (uVar5 < 4);
in_stack_000000a0 = *(uint *)(unaff_RBX + 0x2c);
puVar3 = &DAT_180091028;
uVar7 = param_2 & 0xffffffff;
do {
if (*puVar3 == in_stack_000000a0) {
in_RAX = (uint *)(&DAT_180091010 + uVar7 * 5);
if ((in_RAX != (uint *)0x0) && ((*in_RAX & in_R10D) == 0)) {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar9 = 0x10;
goto LAB_1800339b8;
}
break;
}
uVar5 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar5;
puVar3 = puVar3 + 10;
} while (uVar5 < 5);
uVar5 = *(uint *)(unaff_RBX + 0x28);
puVar3 = &DAT_180091100;
uVar7 = param_2 & 0xffffffff;
do {
if (*puVar3 == uVar5) {
if ((&DAT_1800910e0 + uVar7 * 0xe != (uint *)0x0) &&
(in_RAX = (uint *)(ulonglong)(in_R11D >> 1),
((&DAT_1800910e0)[uVar7 * 0xe] & in_R11D) <= in_R11D >> 1)) {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar9 = 0x11;
in_stack_000000a0 = in_R11D;
goto LAB_1800339e7;
}
break;
}
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
puVar3 = puVar3 + 0xe;
} while (uVar6 < 8);
uVar6 = *(uint *)(unaff_RBX + 0x24);
puVar8 = &DAT_1800913ec;
puVar3 = (uint *)(param_2 & 0xffffffff);
do {
if (*puVar8 == uVar6) {
in_RAX = &DAT_1800913d0;
if ((&DAT_1800913d0 + (longlong)puVar3 * 8 != (uint *)0x0) &&
(((&DAT_1800913d0)[(longlong)puVar3 * 8] & in_R10D) == 0)) {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar9 = 0x12;
in_stack_000000a0 = in_R11D;
goto LAB_1800339e7;
}
break;
}
uVar1 = (int)puVar3 + 1;
in_RAX = (uint *)(ulonglong)uVar1;
puVar8 = puVar8 + 8;
puVar3 = in_RAX;
} while (uVar1 < 5);
if (unaff_R14D == 0) {
if (in_stack_000000d0 == 0) {
LAB_18000769f:
return CONCAT71((int7)((ulonglong)in_RAX >> 8),1);
}
in_RAX = (uint *)FUN_1800077a0(in_stack_000000c8,in_stack_000000d0,0,
(wchar_t *)(unaff_RBX + 0x14a),(wchar_t *)param_2,
(uint)param_2,in_stack_000000c0,in_stack_000000d8);
if ((char)in_RAX != '\0') {
if (((uint **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)(DAT_180091000 + 7) & 4) != 0)) {
uVar4 = FUN_18003393b((longlong)DAT_180091000);
return uVar4;
}
goto LAB_180007718;
}
in_RAX = (uint *)FUN_1800077a0(in_stack_000000c8,in_stack_000000d0,1,
(wchar_t *)(unaff_RBX + 0x1ca),(wchar_t *)0x0,0,
in_stack_000000c0,in_stack_000000d8);
if ((char)in_RAX == '\0') {
in_RAX = (uint *)FUN_1800077a0(in_stack_000000c8,in_stack_000000d0,2,
(wchar_t *)(unaff_RBX + 0xca),
(wchar_t *)(unaff_RBX + 0x2ca),*(uint *)(unaff_RBX + 0x14),
in_stack_000000c0,in_stack_000000d8);
if ((char)in_RAX == '\0') {
in_RAX = (uint *)FUN_1800077a0(in_stack_000000c8,in_stack_000000d0,3,
(wchar_t *)(unaff_RBX + 0x24a),(wchar_t *)0x0,0,
in_stack_000000c0,in_stack_000000d8);
if ((char)in_RAX == '\0') goto LAB_18000769f;
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar9 = 0x1a;
}
else {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar9 = 0x19;
}
}
else {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar9 = 0x18;
}
goto LAB_1800339b8;
}
bVar10 = (param_4 & 0x3000) != 0;
bVar11 = (unaff_R15 & 4) != 0;
in_RAX = (uint *)CONCAT71((int7)((ulonglong)in_RAX >> 8),bVar11);
if ((bVar10 || !bVar11) ||
(in_RAX = (uint *)FUN_180059c68(unaff_R12,unaff_R14D,uVar2), (char)in_RAX != '\0')) {
bVar11 = (unaff_R15 & 1) != 0;
in_RAX = (uint *)CONCAT71((int7)((ulonglong)in_RAX >> 8),bVar11);
if ((bVar10 || !bVar11) ||
(in_RAX = (uint *)FUN_180059c68(unaff_R12,unaff_R14D,uVar6), (char)in_RAX != '\0')) {
if (((unaff_R15 & 8) == 0) ||
(in_RAX = (uint *)FUN_180059c68(unaff_R12,unaff_R14D,uVar5), (char)in_RAX != '\0')) {
if (((unaff_R15 & 2) == 0) ||
(in_RAX = (uint *)FUN_180059c68(unaff_R12,unaff_R14D,in_stack_000000a0),
(char)in_RAX != '\0')) goto LAB_18000769f;
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar9 = 0x16;
}
else {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar9 = 0x15;
in_stack_000000a0 = uVar5;
}
}
else {
if (((uint **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)(DAT_180091000 + 7) & 4) == 0)) goto LAB_180007718;
uVar9 = 0x14;
in_stack_000000a0 = uVar6;
}
}
else {
if (((uint **)DAT_180091000 == &DAT_180091000) || ((*(byte *)(DAT_180091000 + 7) & 4) == 0))
goto LAB_180007718;
uVar9 = 0x13;
in_stack_000000a0 = uVar2;
}
LAB_1800339e7:
uVar4 = *(undefined8 *)(DAT_180091000 + 4);
}
else {
LAB_1800074a8:
if (*(uint *)(unaff_RBX + 0x14) <= in_stack_000000a0) {
if (in_stack_000000a8 == 0) goto LAB_1800074be;
goto LAB_1800074b5;
}
in_RAX = DAT_180091000;
if (((uint **)DAT_180091000 == &DAT_180091000) || ((*(byte *)(DAT_180091000 + 7) & 4) == 0))
goto LAB_180007718;
uVar9 = 0xd;
uVar4 = *(undefined8 *)(DAT_180091000 + 4);
}
in_RAX = (uint *)FUN_180041dd8(uVar4,uVar9,&DAT_180085700,unaff_R13,(char)in_stack_000000a0);
}
LAB_180007718:
return (ulonglong)in_RAX & 0xffffffffffffff00;
}
=========================================
Function at address: 0x1800336c4
Called functions addresses: None


undefined FUN_1800336c4(longlong param_1)

{
wchar_t *unaff_R13;

FUN_180041d70(*(undefined8 *)(param_1 + 0x10),0xb,&DAT_180085700,unaff_R13);
return 0;
}
=========================================
Function at address: 0x180033741
Called functions addresses: 0x180041dd8


uint FUN_180033741(longlong param_1)

{
undefined1 in_AL;
uint uVar1;
wchar_t *unaff_R13;

uVar1 = FUN_180041dd8(*(undefined8 *)(param_1 + 0x10),0xe,&DAT_180085700,unaff_R13,in_AL);
return uVar1 & 0xffffff00;
}
=========================================
Function at address: 0x18003393b
Called functions addresses: 0x180041d70


undefined FUN_18003393b(longlong param_1)

{
wchar_t *unaff_R13;

FUN_180041d70(*(undefined8 *)(param_1 + 0x10),0x17,&DAT_180085700,unaff_R13);
return 0;
}
=========================================
Function at address: 0x180033a0f
Called functions addresses: 0x18005cc0c 0x18005cb48 0x18005a174


undefined8
FUN_180033a0f(undefined param_1,undefined param_2,undefined param_3,byte param_4,undefined4 param_5)

{
int iVar1;
uint in_EAX;
ulonglong uVar2;
longlong lVar3;
undefined8 uVar4;
undefined8 **ppuVar5;
undefined uVar6;
undefined uVar7;
wchar_t *unaff_RBX;
uint *unaff_RBP;
uint uVar9;
ulonglong uVar10;
int *unaff_RSI;
uint *puVar11;
uint *unaff_RDI;
undefined uVar12;
ulonglong uVar13;
wchar_t *unaff_R12;
uint unaff_R13D;
longlong unaff_R14;
int unaff_R15D;
ushort *puVar14;
int in_stack_00000070;
char in_stack_00000098;
wchar_t *_Str1;
wchar_t *pwVar8;

uVar13 = (ulonglong)param_4;
if (in_EAX < unaff_R13D) {
LAB_180033a18:
ppuVar5 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_5._0_1_ = (undefined)unaff_R15D;
ppuVar5 = (undefined8 **)
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,unaff_RBX,(char)unaff_R13D,
(undefined)param_5);
}
LAB_1800079dd:
return CONCAT71((int7)((ulonglong)ppuVar5 >> 8),1);
}
do {
do {
do {
do {
uVar2 = (ulonglong)unaff_RDI[5];
unaff_RSI = unaff_RSI + 0xc;
if ((int *)(uVar2 * 0x30 + *(longlong *)(unaff_RDI + 6)) <= unaff_RSI) {
do {
do {
while( true ) {
do {
puVar11 = unaff_RDI;
unaff_RDI = puVar11 + 10;
if (unaff_RBP <= unaff_RDI) {
return uVar2 & 0xffffffffffffff00;
}
} while (puVar11[0xf] == 0);
if (*unaff_RDI == 0) break;
if (unaff_R14 != 0) {
uVar10 = 0;
do {
uVar2 = RtlCompareUnicodeString(uVar10 * 0x10 + *(longlong *)(puVar11 + 0xc));
if ((int)uVar2 == 0) goto LAB_180007876;
uVar9 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar9;
} while (uVar9 < *unaff_RDI);
}
}
LAB_180007876:
} while ((in_stack_00000098 != '\0') && ((*(byte *)(puVar11 + 0x12) & 1) != 0));
unaff_RSI = *(int **)(puVar11 + 0x10);
uVar2 = (ulonglong)puVar11[0xf];
} while (unaff_RSI + uVar2 * 0xc <= unaff_RSI);
}
} while (*unaff_RSI != unaff_R15D);
lVar3 = -1;
do {
lVar3 = lVar3 + 1;
} while (unaff_RBX[lVar3] != L'\0');
} while (lVar3 * 2 != (ulonglong)*(ushort *)(unaff_RSI + 2));
_Str1 = *(wchar_t **)(unaff_RSI + 4);
uVar2 = (ulonglong)(*(ushort *)(unaff_RSI + 2) >> 1);
pwVar8 = unaff_RBX;
iVar1 = wcsncmp(_Str1,unaff_RBX,uVar2);
uVar12 = (undefined)uVar2;
uVar7 = SUB81(pwVar8,0);
uVar6 = SUB81(_Str1,0);
} while (iVar1 != 0);
if (((unaff_RSI[6] == 0) && (unaff_RSI[10] == 0)) && (unaff_RSI[0xb] == 0)) {
ppuVar5 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
ppuVar5 = (undefined8 **)
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,unaff_RBX,(char)unaff_R15D);
}
goto LAB_1800079dd;
}
if ((unaff_R12 != (wchar_t *)0x0) &&
(puVar14 = *(ushort **)(unaff_RSI + 8), unaff_R15D = in_stack_00000070,
puVar14 < puVar14 + (ulonglong)(uint)unaff_RSI[6] * 8)) {
do {
uVar2 = (ulonglong)*puVar14;
lVar3 = -1;
do {
lVar3 = lVar3 + 1;
} while (unaff_R12[lVar3] != L'\0');
if (lVar3 * 2 == uVar2) {
_Str1 = *(wchar_t **)(puVar14 + 4);
uVar2 = (ulonglong)(*puVar14 >> 1);
pwVar8 = unaff_R12;
iVar1 = wcsncmp(_Str1,unaff_R12,uVar2);
if (iVar1 == 0) {
ppuVar5 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
ppuVar5 = (undefined8 **)
FUN_18005cb48(DAT_180091000[2],pwVar8,uVar2,unaff_RBX,unaff_R12);
}
goto LAB_1800079dd;
}
}
uVar12 = (undefined)uVar2;
uVar7 = SUB81(pwVar8,0);
uVar6 = SUB81(_Str1,0);
puVar14 = puVar14 + 8;
} while (puVar14 < (ushort *)
((ulonglong)(uint)unaff_RSI[6] * 0x10 + *(longlong *)(unaff_RSI + 8)));
}
if (unaff_R13D != 0) {
if (unaff_RSI[10] == 0) {
if (unaff_RSI[0xb] != 0) {
uVar4 = FUN_180033a0f(uVar6,uVar7,uVar12,(byte)uVar13,param_5);
return uVar4;
}
}
else {
if (unaff_R13D < (uint)unaff_RSI[10]) goto LAB_180033a18;
if (unaff_RSI[0xb] != 0) {
uVar4 = FUN_180033a0f(uVar6,uVar7,uVar12,(byte)uVar13,param_5);
return uVar4;
}
}
}
} while( true );
}
=========================================
Function at address: 0x180033ad3
Called functions addresses: 0x18005cc0c 0x18005a174


undefined8
FUN_180033ad3(undefined8 param_1,undefined8 param_2,uint param_3,byte param_4,undefined4 param_5)

{
int iVar1;
undefined8 uVar2;
undefined8 *puVar3;
int *piVar4;
wchar_t *_Str1;
wchar_t *pwVar5;
uint uVar6;
ulonglong uVar7;
int *unaff_RBX;
uint unaff_EBP;
wchar_t *unaff_RSI;
uint *puVar8;
uint *unaff_RDI;
undefined4 in_register_00000084;
wchar_t *pwVar9;
wchar_t *pwVar10;
ulonglong uVar11;
longlong unaff_R12;
char unaff_R13B;
uint *unaff_R14;
uint unaff_R15D;
uint *in_stack_00000040;

uVar11 = (ulonglong)param_4;
pwVar9 = (wchar_t *)CONCAT44(in_register_00000084,param_3);
pwVar10 = pwVar9;
if ((uint)unaff_RBX[0xb] < unaff_R15D) {
LAB_180033add:
puVar3 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_5._0_1_ = SUB81(pwVar9,0);
puVar3 = (undefined8 *)
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDH",(char)unaff_R15D,
(undefined)param_5);
}
LAB_180007c11:
return CONCAT71((int7)((ulonglong)puVar3 >> 8),1);
}
LAB_180007b70:
do {
do {
do {
do {
unaff_RBX = unaff_RBX + 0xc;
piVar4 = (int *)((ulonglong)unaff_RDI[5] * 0x30 + *(longlong *)(unaff_RDI + 6));
while (piVar4 <= unaff_RBX) {
do {
while( true ) {
do {
puVar8 = unaff_RDI;
unaff_RDI = puVar8 + 10;
uVar6 = (uint)pwVar10;
if (in_stack_00000040 <= unaff_RDI) {
puVar3 = (undefined8 *)
FUN_1800077a0(unaff_R14,unaff_EBP,0,unaff_RSI,pwVar10,uVar6,unaff_R12,
unaff_R13B);
if ((char)puVar3 == '\0') {
iVar1 = *(int *)(unaff_RSI + 0x182);
if (iVar1 == 0x17) {
pwVar10 = L"ECDH_P256";
}
else if (iVar1 == 0x18) {
pwVar10 = L"ECDH_P384";
}
else {
if (iVar1 != 0x19) {
return (ulonglong)puVar3 & 0xffffffffffffff00;
}
pwVar10 = L"ECDH_P521";
}
uVar2 = FUN_1800077a0(unaff_R14,unaff_EBP,0,pwVar10,(wchar_t *)0x0,0,unaff_R12
,unaff_R13B);
return uVar2;
}
goto LAB_180007c11;
}
} while (puVar8[0xf] == uVar6);
if (*unaff_RDI <= uVar6) break;
if (unaff_R12 != 0) {
uVar7 = (ulonglong)pwVar10 & 0xffffffff;
do {
iVar1 = RtlCompareUnicodeString(uVar7 * 0x10 + *(longlong *)(puVar8 + 0xc));
pwVar10 = (wchar_t *)0x0;
if (iVar1 == 0) goto LAB_180007b45;
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
} while (uVar6 < *unaff_RDI);
}
}
LAB_180007b45:
} while ((unaff_R13B != '\0') && ((*(byte *)(puVar8 + 0x12) & 1) != 0));
unaff_RBX = *(int **)(puVar8 + 0x10);
piVar4 = unaff_RBX + (ulonglong)puVar8[0xf] * 0xc;
}
} while ((*unaff_RBX != (int)pwVar10) || (*(short *)(unaff_RBX + 2) != 8));
_Str1 = *(wchar_t **)(unaff_RBX + 4);
pwVar5 = L"ECDH";
iVar1 = wcsncmp(_Str1,L"ECDH",4);
pwVar9 = (wchar_t *)0x0;
pwVar10 = pwVar9;
} while (iVar1 != 0);
if (((unaff_RBX[6] == 0) && (unaff_RBX[10] == 0)) && (unaff_RBX[0xb] == 0)) {
puVar3 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar3 = (undefined8 *)FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDH",0);
}
goto LAB_180007c11;
}
} while (unaff_R15D == 0);
if (unaff_RBX[10] == 0) {
pwVar10 = (wchar_t *)0x0;
if (unaff_RBX[0xb] == 0) goto LAB_180007b70;
}
else if (unaff_R15D < (uint)unaff_RBX[10]) goto LAB_180033add;
pwVar10 = pwVar9;
if (unaff_RBX[0xb] != 0) {
uVar2 = FUN_180033ad3(_Str1,pwVar5,0,(char)uVar11,param_5);
return uVar2;
}
} while( true );
}
=========================================
Function at address: 0x180033b6d
Called functions addresses: 0x18005cc0c 0x18005a174


undefined8
FUN_180033b6d(undefined8 param_1,uint param_2,undefined param_3,byte param_4,undefined4 param_5)

{
int iVar1;
undefined8 uVar2;
int *piVar3;
wchar_t *pwVar4;
wchar_t *pwVar5;
undefined4 in_register_00000014;
uint uVar6;
ulonglong uVar7;
int *unaff_RBX;
uint unaff_EBP;
int unaff_ESI;
uint *puVar8;
uint *unaff_RDI;
undefined uVar9;
ulonglong uVar10;
wchar_t *pwVar11;
longlong unaff_R12;
char unaff_R13B;
uint *unaff_R14;
uint unaff_R15D;
uint *in_stack_00000040;
wchar_t *in_stack_00000090;

uVar10 = (ulonglong)param_4;
pwVar4 = (wchar_t *)CONCAT44(in_register_00000014,param_2);
if ((uint)unaff_RBX[0xb] < unaff_EBP) {
LAB_180033b76:
in_stack_00000040 = (uint *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
in_stack_00000040 =
(uint *)FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"ECDSA",(char)unaff_EBP,1);
}
LAB_180007e40:
return CONCAT71((int7)((ulonglong)in_stack_00000040 >> 8),1);
}
LAB_180007da8:
do {
do {
do {
do {
unaff_RBX = unaff_RBX + 0xc;
piVar3 = (int *)((ulonglong)unaff_RDI[5] * 0x30 + *(longlong *)(unaff_RDI + 6));
while (piVar3 <= unaff_RBX) {
do {
while( true ) {
do {
puVar8 = unaff_RDI;
unaff_RDI = puVar8 + 10;
uVar6 = (uint)pwVar4;
if (in_stack_00000040 <= unaff_RDI) {
if (in_stack_00000090 != (wchar_t *)0x0) {
in_stack_00000040 =
(uint *)FUN_1800077a0(unaff_R14,unaff_R15D,1,in_stack_00000090,pwVar4,
uVar6,unaff_R12,unaff_R13B);
pwVar4 = (wchar_t *)0x0;
if ((char)in_stack_00000040 != '\0') goto LAB_180007e40;
}
if (unaff_ESI == 0x17) {
pwVar11 = L"ECDSA_P256";
}
else if (unaff_ESI == 0x18) {
pwVar11 = L"ECDSA_P384";
}
else {
if (unaff_ESI != 0x19) {
return (ulonglong)in_stack_00000040 & 0xffffffffffffff00;
}
pwVar11 = L"ECDSA_P521";
}
uVar2 = FUN_1800077a0(unaff_R14,unaff_R15D,1,pwVar11,pwVar4,(uint)pwVar4,
unaff_R12,unaff_R13B);
return uVar2;
}
} while (puVar8[0xf] == uVar6);
if (*unaff_RDI <= uVar6) break;
if (unaff_R12 != 0) {
uVar7 = (ulonglong)pwVar4 & 0xffffffff;
do {
iVar1 = RtlCompareUnicodeString(uVar7 * 0x10 + *(longlong *)(puVar8 + 0xc));
pwVar4 = (wchar_t *)0x0;
if (iVar1 == 0) goto LAB_180007d7d;
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
} while (uVar6 < *unaff_RDI);
}
}
LAB_180007d7d:
} while ((unaff_R13B != '\0') && ((*(byte *)(puVar8 + 0x12) & 1) != 0));
unaff_RBX = *(int **)(puVar8 + 0x10);
piVar3 = unaff_RBX + (ulonglong)puVar8[0xf] * 0xc;
}
} while ((*unaff_RBX != 1) || (*(short *)(unaff_RBX + 2) != 10));
pwVar11 = *(wchar_t **)(unaff_RBX + 4);
uVar9 = 5;
iVar1 = wcsncmp(pwVar11,L"ECDSA",5);
pwVar5 = (wchar_t *)0x0;
pwVar4 = pwVar5;
} while (iVar1 != 0);
if (((unaff_RBX[6] == 0) && (unaff_RBX[10] == 0)) && (unaff_RBX[0xb] == 0)) {
in_stack_00000040 = (uint *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
in_stack_00000040 = (uint *)FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"ECDSA",1);
}
goto LAB_180007e40;
}
} while (unaff_EBP == 0);
if (unaff_RBX[10] == 0) {
pwVar4 = (wchar_t *)0x0;
if (unaff_RBX[0xb] == 0) goto LAB_180007da8;
}
else if (unaff_EBP < (uint)unaff_RBX[10]) goto LAB_180033b76;
pwVar4 = pwVar5;
if (unaff_RBX[0xb] != 0) {
uVar2 = FUN_180033b6d(pwVar11,0,uVar9,(char)uVar10,param_5);
return uVar2;
}
} while( true );
}
=========================================
Function at address: 0x180034dc2
Called functions addresses: 0x180041d20


void FUN_180034dc2(void)

{
longlong unaff_RBP;
undefined4 *unaff_RDI;
undefined8 *unaff_R14;

*unaff_R14 = 0;
*unaff_RDI = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x44,&DAT_180084ce0,0x8009035d,0x5d);
}
FUN_180028070(*(ulonglong *)(unaff_RBP + -9) ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x180035a8c
Called functions addresses: 0x180041e9c


void FUN_180035a8c(longlong param_1)

{
undefined8 unaff_RBX;

FUN_180041e9c(*(undefined8 *)(param_1 + 0x10),0x1b,&DAT_180085418,unaff_RBX);
return;
}
=========================================
Function at address: 0x180035c6a
Called functions addresses: 0x180041cdc


undefined4 FUN_180035c6a(void)

{
undefined4 unaff_EBP;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xc,&DAT_180085388,unaff_EBP);
}
return unaff_EBP;
}
=========================================
Function at address: 0x180037e9d
Called functions addresses: 0x18006049c 0x18000404c


void FUN_180037e9d(void)

{
longlong *unaff_RBX;

if (*(char *)((longlong)unaff_RBX + 0x10a) == '\0') {
FUN_18006049c(unaff_RBX);
}
else {
*(undefined *)((longlong)unaff_RBX + 0x39b) = 1;
FUN_18000404c((longlong)unaff_RBX,0);
}
return;
}
=========================================
Function at address: 0x180037ec8
Called functions addresses: None


undefined8
switchD_18000d619::caseD_3
(undefined8 param_1,undefined8 param_2,uint *param_3,longlong param_4,undefined8 param_5,
undefined8 param_6,undefined8 param_7,undefined param_8,undefined param_9,
undefined param_10,undefined8 param_11)

{
uint uVar1;
undefined8 uVar2;
ulonglong in_RAX;
undefined4 *puVar3;
code *UNRECOVERED_JUMPTABLE;
undefined4 *puVar4;
undefined4 *unaff_RBX;
undefined8 unaff_RBP;
longlong unaff_RDI;
undefined4 uVar5;
longlong in_R10;
uint in_R11D;
undefined8 unaff_R12;
undefined8 unaff_R13;
longlong unaff_R14;
undefined8 unaff_R15;
undefined8 uStackX_20;
undefined8 *in_stack_00000098;
undefined4 *in_stack_000000a0;
longlong *in_stack_000000a8;
undefined8 *in_stack_000000b0;
longlong *in_stack_000000b8;
undefined8 *in_stack_000000c0;
undefined8 *in_stack_000000c8;
undefined8 *in_stack_000000d0;
undefined8 *in_stack_000000d8;
undefined8 *in_stack_000000e0;
undefined8 *in_stack_000000e8;
undefined8 *in_stack_000000f0;

puVar3 = (undefined4 *)((in_RAX & 0xffffffff) * 0x10 + param_4);
do {
while( true ) {
uVar1 = (int)in_RAX + 1;
in_RAX = (ulonglong)uVar1;
param_3 = param_3 + 4;
if (in_R11D <= uVar1) {
uVar5 = 0;
puVar4 = unaff_RBX;
if ((unaff_RBX == (undefined4 *)0x0) && (puVar4 = puVar3, puVar3 == (undefined4 *)0x0)) {
*(undefined8 *)(in_stack_000000a0 + 2) = 0;
*in_stack_000000a0 = 0;
}
else {
*(undefined8 *)(in_stack_000000a0 + 2) = *(undefined8 *)(puVar4 + 2);
*in_stack_000000a0 = *puVar4;
uVar5 = *puVar4;
unaff_RBX = puVar4;
}
in_stack_000000a0[1] = uVar5;
if (((unaff_RDI == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar2 = FUN_180037f5a((longlong)DAT_180091000);
return uVar2;
}
*in_stack_00000098 = unaff_RBX;
*in_stack_000000a8 = unaff_RDI;
*in_stack_000000b0 = unaff_RBP;
*in_stack_000000b8 = unaff_R14;
*in_stack_000000c0 = unaff_R15;
*in_stack_000000c8 = unaff_R12;
*in_stack_000000d0 = uStackX_20;
*in_stack_000000d8 = unaff_R13;
*in_stack_000000e0 = param_5;
*in_stack_000000e8 = param_6;
*in_stack_000000f0 = param_7;
return 0;
}
uVar1 = *param_3 & 0xfffffff;
if (uVar1 == 0) break;
if (uVar1 == 2) goto LAB_18000d4d2;
if (uVar1 == 0x12) {
unaff_R14 = in_RAX * 0x10 + param_4;
}
else {
uVar1 = uVar1 - 3;
if (uVar1 < 0x19) {
UNRECOVERED_JUMPTABLE =
(code *)((ulonglong)*(uint *)(in_R10 + 0xd63c + (ulonglong)uVar1 * 4) + in_R10);
/* WARNING: Could not recover jumptable at 0x00018000d619. Too many branches */

uVar2 = (*UNRECOVERED_JUMPTABLE)((ulonglong)uVar1,UNRECOVERED_JUMPTABLE);
return uVar2;
}
}
}
if (((unaff_RBX == (undefined4 *)0x0) && (puVar3 == (undefined4 *)0x0)) &&
((*param_3 >> 0x1e & 1) == 0)) {
LAB_18000d4d2:
unaff_RBX = (undefined4 *)(in_RAX * 0x10 + param_4);
}
else if (unaff_RDI == 0) {
unaff_RDI = in_RAX * 0x10 + param_4;
}
} while( true );
}
=========================================
Function at address: 0x180037f5a
Called functions addresses: 0x180041cb0


undefined8 FUN_180037f5a(longlong param_1)

{
undefined8 unaff_RBX;
undefined8 unaff_RBP;
undefined8 unaff_RDI;
undefined8 unaff_R12;
undefined8 unaff_R13;
undefined8 unaff_R14;
undefined8 unaff_R15;
undefined8 uStackX_20;
undefined8 in_stack_00000028;
undefined8 in_stack_00000030;
undefined8 in_stack_00000038;
undefined8 *in_stack_00000098;
undefined8 *in_stack_000000a8;
undefined8 *in_stack_000000b0;
undefined8 *in_stack_000000b8;
undefined8 *in_stack_000000c0;
undefined8 *in_stack_000000c8;
undefined8 *in_stack_000000d0;
undefined8 *in_stack_000000d8;
undefined8 *in_stack_000000e0;
undefined8 *in_stack_000000e8;
undefined8 *in_stack_000000f0;

FUN_180041cb0(*(undefined8 *)(param_1 + 0x10),0xf,&DAT_180084d00);
*in_stack_00000098 = unaff_RBX;
*in_stack_000000a8 = unaff_RDI;
*in_stack_000000b0 = unaff_RBP;
*in_stack_000000b8 = unaff_R14;
*in_stack_000000c0 = unaff_R15;
*in_stack_000000c8 = unaff_R12;
*in_stack_000000d0 = uStackX_20;
*in_stack_000000d8 = unaff_R13;
*in_stack_000000e0 = in_stack_00000028;
*in_stack_000000e8 = in_stack_00000030;
*in_stack_000000f0 = in_stack_00000038;
return 0;
}
=========================================
Function at address: 0x1800380b6
Called functions addresses: 0x1800432ec


int FUN_1800380b6(longlong param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4)

{
uint uVar1;
undefined4 *puVar2;
DWORD *pDVar3;
undefined8 *puVar4;
char cVar5;
int iVar6;
DWORD DVar7;
longlong lVar8;
undefined *puVar9;
LPWSTR psz;
undefined8 uVar10;
longlong unaff_RBX;
longlong unaff_RBP;
int unaff_ESI;
undefined *puVar11;
int unaff_EDI;
int iVar12;
uint *unaff_R12;
int unaff_R13D;
int *unaff_R14;
undefined *puVar13;
int *unaff_R15;
undefined4 uVar14;

uVar14 = FUN_1800432ec(*(undefined8 *)(param_1 + 0x10),0x10,&DAT_180084d00,param_4);
if ((((*unaff_R15 == 0) || (unaff_ESI != 0)) && ((*(ulonglong *)(unaff_RBP + 0x97) & 0x100) != 0))
&& (*(longlong *)(unaff_R15 + 2) != 0)) {
iVar6 = FUN_18003813b(uVar14);
return iVar6;
}
if (unaff_RBX == 0) {
return unaff_EDI;
}
if (unaff_ESI != 0) {
return 0;
}
if (((unaff_EDI != 0) && (unaff_EDI != 0x90316)) && (unaff_EDI != -0x7ff6fc96)) {
return unaff_EDI;
}
if (((unaff_R12 != (uint *)0x0) &&
(lVar8 = *(longlong *)(unaff_RBP + 0x7f), *(uint *)(lVar8 + 4) < *unaff_R12)) &&
(unaff_R14 != (int *)0x0)) {
unaff_R14[1] = 0x40000005;
*unaff_R14 = *unaff_R12 - *(int *)(lVar8 + 4);
unaff_R14[2] = 0;
unaff_R14[3] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
iVar6 = FUN_180038180((longlong)DAT_180091000);
return iVar6;
}
}
if (unaff_EDI != 0) {
return unaff_EDI;
}
iVar6 = *(int *)(unaff_RBX + 0x44);
iVar12 = 0;
if ((((iVar6 != 4) && (iVar6 != 0x33)) && (iVar6 != 0x4f)) ||
((*(uint *)(unaff_RBX + 0x88) >> 0x1e & 1) != 0)) goto LAB_18000dac0;
*(longlong *)(unaff_RBP + -0x29) = unaff_RBX;
*(undefined8 *)(unaff_RBP + -0x21) = 0;
*(undefined8 *)(unaff_RBP + -0x19) = 0;
*(undefined8 *)(unaff_RBP + -0x11) = 0;
**(undefined **)(unaff_RBP + 0x9f) = 1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180084d00);
}
iVar6 = FUN_18000dda0((undefined8 *)(unaff_RBP + -0x29),FUN_18004a500);
if (iVar6 != 0) {
return iVar6;
}
uVar14 = *(undefined4 *)(unaff_RBP + -0x11);

*(longlong *)(unaff_RBP + -0x21) = lVar8;
if (lVar8 == 0) {
return 0xe;
}
*(undefined4 *)(unaff_RBP + -0xd) = uVar14;
*(longlong *)(unaff_RBP + -0x19) = lVar8;
iVar6 = FUN_18000dda0((undefined8 *)(unaff_RBP + -0x29),FUN_18004a500);
if (iVar6 != 0) {

(*(undefined8 *)(unaff_RBP + -0x29),*(undefined8 *)(unaff_RBP + -0x21));
return iVar6;
}
puVar2 = *(undefined4 **)(unaff_RBP + 0x67);
*(undefined8 *)(puVar2 + 2) = *(undefined8 *)(unaff_RBP + -0x21);
*puVar2 = *(undefined4 *)(unaff_RBP + -0x11);
*(ulonglong *)(unaff_RBX + 0x88) = *(ulonglong *)(unaff_RBX + 0x88) | 0x40000000;
if ((*(int *)(unaff_RBX + 0x44) != 4) && (*(int *)(unaff_RBX + 0x44) != 0x4f)) {
if (*(longlong *)(unaff_RBX + 0x98) != 0) {
SslFreeObject(*(longlong *)(unaff_RBX + 0x98),0);
*(undefined8 *)(unaff_RBX + 0x98) = 0;
}
iVar12 = 1;
goto LAB_18000dac0;
}

if (*(char *)(unaff_RBX + 0x109) == '\0') {
puVar11 = (undefined *)0x0;
psz = (LPWSTR)0x0;


if (lVar8 != 0) {
puVar11 = *(undefined **)(lVar8 + 400);
}
RtlAcquireResourceShared(*(longlong *)(unaff_RBX + 0x58) + 0x48,1);
pDVar3 = *(DWORD **)(*(longlong *)(unaff_RBX + 0x58) + 0x30);
if (pDVar3 == (DWORD *)0x0) {
LAB_18000da48:
RtlReleaseResource(*(longlong *)(unaff_RBX + 0x58) + 0x48);
if (psz != (LPWSTR)0x0) goto LAB_18000dcdb;
*(undefined **)(unaff_RBP + -0x71) = &DAT_18008233c;
}
else {
DVar7 = CertNameToStrW(*pDVar3,(PCERT_NAME_BLOB)(*(longlong *)(pDVar3 + 6) + 0x50),0x20000003,
(LPWSTR)0x0,0);
*(DWORD *)(unaff_RBP + 0x57) = DVar7;
if ((DVar7 == 0) || (psz = (LPWSTR)FUN_18000a1f4((ulonglong)(DVar7 * 2)), psz == (LPWSTR)0x0))
goto LAB_18000da48;
CertNameToStrW(*pDVar3,(PCERT_NAME_BLOB)(*(longlong *)(pDVar3 + 6) + 0x50),0x20000003,psz,
*(DWORD *)(unaff_RBP + 0x57));
RtlReleaseResource(*(longlong *)(unaff_RBX + 0x58) + 0x48);
LAB_18000dcdb:
*(LPWSTR *)(unaff_RBP + -0x71) = psz;
}
puVar13 = &DAT_18008233c;
if (puVar11 != (undefined *)0x0) {
puVar13 = puVar11;
}
puVar11 = &DAT_18008233c;
if (puVar9 != (undefined *)0x0) {
puVar11 = puVar9;
}
*(undefined4 *)(unaff_RBP + 0x57) = *(undefined4 *)(*(longlong *)(unaff_RBX + 0x58) + 8);
if ((DAT_1800919b0 & 4) != 0) {
uVar1 = *(uint *)(unaff_RBX + 0x40);
FUN_1800452cc(uVar1,unaff_RBP + -0x39);
uVar10 = DAT_180092df8;
if ((uVar1 & 0x40051555) != 0) {
uVar10 = DAT_180092df0;
}
RtlInitUnicodeString(unaff_RBP + -0x29,uVar10);
RtlInitUnicodeString(unaff_RBP + -0x49,puVar11);
RtlInitUnicodeString(unaff_RBP + -0x59,puVar13);
RtlInitUnicodeString(unaff_RBP + -0x69,*(undefined8 *)(unaff_RBP + -0x71));
FUN_180045408((ushort *)&DAT_180082ac8,0x180082ab0,unaff_RBP + -0x29,unaff_RBP + -0x39);
}
if (psz != (LPWSTR)0x0) {
FUN_18000909c(psz);
}
}
else {
*(undefined *)(unaff_RBX + 0x109) = 0;
}
iVar12 = *(int *)(unaff_RBP + 0x4f);
LAB_18000dac0:
if ((*(int *)(unaff_RBX + 0x44) - 3U < 2) || (*(int *)(unaff_RBX + 0x44) == 0x4f)) {
unaff_R13D = 0;
}
else if (iVar12 == 0) {

if (cVar5 == '\0') {
iVar6 = FUN_1800382c8();
return iVar6;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180084d00);
}
unaff_R13D = 0x90366;
}
puVar4 = *(undefined8 **)(unaff_RBP + 0xa7);
if (puVar4 != (undefined8 *)0x0) {
lVar8 = *(longlong *)(unaff_RBX + 0x58);
if (lVar8 != 0) {
RtlAcquireResourceShared(lVar8 + 0x48,1);
if (*(longlong *)(lVar8 + 0x30) != 0) {
*puVar4 = *(undefined8 *)(*(longlong *)(*(longlong *)(lVar8 + 0x30) + 0x18) + 0x48);
RtlReleaseResource(lVar8 + 0x48);
return unaff_R13D;
}
RtlReleaseResource();
}
*puVar4 = 0x7fffff36d5969fff;
}
return unaff_R13D;
}
=========================================
Function at address: 0x18003810b
Called functions addresses: 0x18000dbdb


int FUN_18003810b(undefined4 param_1,undefined8 **param_2,int param_3)

{
undefined4 uVar1;
uint uVar2;
undefined4 *puVar3;
DWORD *pDVar4;
undefined8 *puVar5;
char cVar6;
DWORD DVar7;
int iVar8;
longlong lVar9;
undefined *puVar10;
LPWSTR psz;
undefined8 uVar11;
longlong unaff_RBX;
longlong unaff_RBP;
int unaff_ESI;
undefined *puVar12;
int unaff_EDI;
uint *unaff_R12;
int unaff_R13D;
int *unaff_R14;
undefined *puVar13;
int *unaff_R15;

if ((unaff_EDI != -0x7ff6fc96) && (unaff_EDI != -0x7ff6fc95)) {
iVar8 = FUN_18000dbdb(param_1,&DAT_180091000,param_3);
return iVar8;
}
if ((((*unaff_R15 == 0) || (unaff_ESI != 0)) && ((*(ulonglong *)(unaff_RBP + 0x97) & 0x100) != 0))
&& (*(longlong *)(unaff_R15 + 2) != 0)) {
iVar8 = FUN_18003813b(param_1);
return iVar8;
}
if (unaff_RBX == 0) {
return unaff_EDI;
}
if (unaff_ESI != 0) {
return 0;
}
if (((unaff_EDI != 0) && (unaff_EDI != 0x90316)) && (unaff_EDI != -0x7ff6fc96)) {
return unaff_EDI;
}
if (((unaff_R12 != (uint *)0x0) &&
(lVar9 = *(longlong *)(unaff_RBP + 0x7f), *(uint *)(lVar9 + 4) < *unaff_R12)) &&
(unaff_R14 != (int *)0x0)) {
unaff_R14[1] = 0x40000005;
*unaff_R14 = *unaff_R12 - *(int *)(lVar9 + 4);
unaff_R14[2] = 0;
unaff_R14[3] = 0;
if ((DAT_180091000 != param_2) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
iVar8 = FUN_180038180((longlong)DAT_180091000);
return iVar8;
}
}
if (unaff_EDI != 0) {
return unaff_EDI;
}
iVar8 = *(int *)(unaff_RBX + 0x44);
if ((((iVar8 != 4) && (iVar8 != 0x33)) && (iVar8 != 0x4f)) ||
((*(uint *)(unaff_RBX + 0x88) >> 0x1e & 1) != 0)) goto LAB_18000dac0;
*(longlong *)(unaff_RBP + -0x29) = unaff_RBX;
*(undefined8 *)(unaff_RBP + -0x21) = 0;
*(undefined8 *)(unaff_RBP + -0x19) = 0;
*(undefined8 *)(unaff_RBP + -0x11) = 0;
**(undefined **)(unaff_RBP + 0x9f) = 1;
if ((DAT_180091000 != param_2) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180084d00);
}
iVar8 = FUN_18000dda0((undefined8 *)(unaff_RBP + -0x29),FUN_18004a500);
if (iVar8 != 0) {
return iVar8;
}
uVar1 = *(undefined4 *)(unaff_RBP + -0x11);

*(longlong *)(unaff_RBP + -0x21) = lVar9;
if (lVar9 == 0) {
return 0xe;
}
*(undefined4 *)(unaff_RBP + -0xd) = uVar1;
*(longlong *)(unaff_RBP + -0x19) = lVar9;
iVar8 = FUN_18000dda0((undefined8 *)(unaff_RBP + -0x29),FUN_18004a500);
if (iVar8 != 0) {

(*(undefined8 *)(unaff_RBP + -0x29),*(undefined8 *)(unaff_RBP + -0x21));
return iVar8;
}
puVar3 = *(undefined4 **)(unaff_RBP + 0x67);
*(undefined8 *)(puVar3 + 2) = *(undefined8 *)(unaff_RBP + -0x21);
*puVar3 = *(undefined4 *)(unaff_RBP + -0x11);
*(ulonglong *)(unaff_RBX + 0x88) = *(ulonglong *)(unaff_RBX + 0x88) | 0x40000000;
if ((*(int *)(unaff_RBX + 0x44) == 4) || (*(int *)(unaff_RBX + 0x44) == 0x4f)) {

if (*(char *)(unaff_RBX + 0x109) == '\0') {
puVar12 = (undefined *)0x0;
psz = (LPWSTR)0x0;


if (lVar9 != 0) {
puVar12 = *(undefined **)(lVar9 + 400);
}
RtlAcquireResourceShared(*(longlong *)(unaff_RBX + 0x58) + 0x48,1);
pDVar4 = *(DWORD **)(*(longlong *)(unaff_RBX + 0x58) + 0x30);
if (pDVar4 == (DWORD *)0x0) {
LAB_18000da48:
RtlReleaseResource(*(longlong *)(unaff_RBX + 0x58) + 0x48);
if (psz != (LPWSTR)0x0) goto LAB_18000dcdb;
*(undefined **)(unaff_RBP + -0x71) = &DAT_18008233c;
}
else {
DVar7 = CertNameToStrW(*pDVar4,(PCERT_NAME_BLOB)(*(longlong *)(pDVar4 + 6) + 0x50),
0x20000003,(LPWSTR)0x0,0);
*(DWORD *)(unaff_RBP + 0x57) = DVar7;
if ((DVar7 == 0) ||
(psz = (LPWSTR)FUN_18000a1f4((ulonglong)(DVar7 * 2)), psz == (LPWSTR)0x0))
goto LAB_18000da48;
CertNameToStrW(*pDVar4,(PCERT_NAME_BLOB)(*(longlong *)(pDVar4 + 6) + 0x50),0x20000003,psz,
*(DWORD *)(unaff_RBP + 0x57));
RtlReleaseResource(*(longlong *)(unaff_RBX + 0x58) + 0x48);
LAB_18000dcdb:
*(LPWSTR *)(unaff_RBP + -0x71) = psz;
}
puVar13 = &DAT_18008233c;
if (puVar12 != (undefined *)0x0) {
puVar13 = puVar12;
}
puVar12 = &DAT_18008233c;
if (puVar10 != (undefined *)0x0) {
puVar12 = puVar10;
}
*(undefined4 *)(unaff_RBP + 0x57) = *(undefined4 *)(*(longlong *)(unaff_RBX + 0x58) + 8);
if ((DAT_1800919b0 & 4) != 0) {
uVar2 = *(uint *)(unaff_RBX + 0x40);
FUN_1800452cc(uVar2,unaff_RBP + -0x39);
uVar11 = DAT_180092df8;
if ((uVar2 & 0x40051555) != 0) {
uVar11 = DAT_180092df0;
}
RtlInitUnicodeString(unaff_RBP + -0x29,uVar11);
RtlInitUnicodeString(unaff_RBP + -0x49,puVar12);
RtlInitUnicodeString(unaff_RBP + -0x59,puVar13);
RtlInitUnicodeString(unaff_RBP + -0x69,*(undefined8 *)(unaff_RBP + -0x71));
FUN_180045408((ushort *)&DAT_180082ac8,0x180082ab0,unaff_RBP + -0x29,unaff_RBP + -0x39);
}
if (psz != (LPWSTR)0x0) {
FUN_18000909c(psz);
}
}
else {
*(undefined *)(unaff_RBX + 0x109) = 0;
}
param_3 = *(int *)(unaff_RBP + 0x4f);
}
else {
if (*(longlong *)(unaff_RBX + 0x98) != 0) {
SslFreeObject(*(longlong *)(unaff_RBX + 0x98),0);
*(undefined8 *)(unaff_RBX + 0x98) = 0;
}
param_3 = 1;
}
param_2 = &DAT_180091000;
LAB_18000dac0:
if ((*(int *)(unaff_RBX + 0x44) - 3U < 2) || (*(int *)(unaff_RBX + 0x44) == 0x4f)) {
unaff_R13D = 0;
}
else if (param_3 == 0) {

if (cVar6 == '\0') {
iVar8 = FUN_1800382c8();
return iVar8;
}
}
else {
if ((DAT_180091000 != param_2) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180084d00);
}
unaff_R13D = 0x90366;
}
puVar5 = *(undefined8 **)(unaff_RBP + 0xa7);
if (puVar5 != (undefined8 *)0x0) {
lVar9 = *(longlong *)(unaff_RBX + 0x58);
if (lVar9 != 0) {
RtlAcquireResourceShared(lVar9 + 0x48,1);
if (*(longlong *)(lVar9 + 0x30) != 0) {
*puVar5 = *(undefined8 *)(*(longlong *)(*(longlong *)(lVar9 + 0x30) + 0x18) + 0x48);
RtlReleaseResource(lVar9 + 0x48);
return unaff_R13D;
}
RtlReleaseResource();
}
*puVar5 = 0x7fffff36d5969fff;
}
return unaff_R13D;
}
=========================================
Function at address: 0x18003812f
Called functions addresses: 0x18000dbdb


void FUN_18003812f(undefined4 param_1,undefined8 param_2,int param_3)

{
FUN_18000dbdb(param_1,(undefined8 **)&DAT_180091000,param_3);
return;
}
=========================================
Function at address: 0x18003813b
Called functions addresses: 0x18002a7c0


int FUN_18003813b(undefined4 param_1)

{
int iVar1;
undefined4 uVar2;
uint uVar3;
undefined4 *puVar4;
DWORD *pDVar5;
undefined8 *puVar6;
char cVar7;
int iVar8;
DWORD DVar9;
longlong lVar10;
undefined *puVar11;
LPWSTR psz;
undefined8 uVar12;
longlong unaff_RBX;
longlong unaff_RBP;
int unaff_ESI;
undefined *puVar13;
int unaff_EDI;
uint *unaff_R12;
int unaff_R13D;
int *unaff_R14;
undefined *puVar14;
undefined8 *unaff_R15;

if (unaff_RBX == 0) {
return unaff_EDI;
}

iVar8 = *(int *)(unaff_RBP + 0x4f);
*unaff_R15 = 0;
unaff_R15[1] = 0;
if (unaff_ESI != 0) {
return 0;
}
if (((unaff_EDI != 0) && (unaff_EDI != 0x90316)) && (unaff_EDI != -0x7ff6fc96)) {
return unaff_EDI;
}
if (((unaff_R12 != (uint *)0x0) &&
(lVar10 = *(longlong *)(unaff_RBP + 0x7f), *(uint *)(lVar10 + 4) < *unaff_R12)) &&
(unaff_R14 != (int *)0x0)) {
unaff_R14[1] = 0x40000005;
*unaff_R14 = *unaff_R12 - *(int *)(lVar10 + 4);
unaff_R14[2] = 0;
unaff_R14[3] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
iVar8 = FUN_180038180((longlong)DAT_180091000);
return iVar8;
}
}
if (unaff_EDI != 0) {
return unaff_EDI;
}
iVar1 = *(int *)(unaff_RBX + 0x44);
if ((((iVar1 != 4) && (iVar1 != 0x33)) && (iVar1 != 0x4f)) ||
((*(uint *)(unaff_RBX + 0x88) >> 0x1e & 1) != 0)) goto LAB_18000dac0;
*(longlong *)(unaff_RBP + -0x29) = unaff_RBX;
*(undefined8 *)(unaff_RBP + -0x21) = 0;
*(undefined8 *)(unaff_RBP + -0x19) = 0;
*(undefined8 *)(unaff_RBP + -0x11) = 0;
**(undefined **)(unaff_RBP + 0x9f) = 1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180084d00);
}
iVar8 = FUN_18000dda0((undefined8 *)(unaff_RBP + -0x29),FUN_18004a500);
if (iVar8 != 0) {
return iVar8;
}
uVar2 = *(undefined4 *)(unaff_RBP + -0x11);

*(longlong *)(unaff_RBP + -0x21) = lVar10;
if (lVar10 == 0) {
return 0xe;
}
*(undefined4 *)(unaff_RBP + -0xd) = uVar2;
*(longlong *)(unaff_RBP + -0x19) = lVar10;
iVar8 = FUN_18000dda0((undefined8 *)(unaff_RBP + -0x29),FUN_18004a500);
if (iVar8 != 0) {

(*(undefined8 *)(unaff_RBP + -0x29),*(undefined8 *)(unaff_RBP + -0x21));
return iVar8;
}
puVar4 = *(undefined4 **)(unaff_RBP + 0x67);
*(undefined8 *)(puVar4 + 2) = *(undefined8 *)(unaff_RBP + -0x21);
*puVar4 = *(undefined4 *)(unaff_RBP + -0x11);
*(ulonglong *)(unaff_RBX + 0x88) = *(ulonglong *)(unaff_RBX + 0x88) | 0x40000000;
if ((*(int *)(unaff_RBX + 0x44) != 4) && (*(int *)(unaff_RBX + 0x44) != 0x4f)) {
if (*(longlong *)(unaff_RBX + 0x98) != 0) {
SslFreeObject(*(longlong *)(unaff_RBX + 0x98),0);
*(undefined8 *)(unaff_RBX + 0x98) = 0;
}
iVar8 = 1;
goto LAB_18000dac0;
}

if (*(char *)(unaff_RBX + 0x109) == '\0') {
puVar13 = (undefined *)0x0;
psz = (LPWSTR)0x0;


if (lVar10 != 0) {
puVar13 = *(undefined **)(lVar10 + 400);
}
RtlAcquireResourceShared(*(longlong *)(unaff_RBX + 0x58) + 0x48,1);
pDVar5 = *(DWORD **)(*(longlong *)(unaff_RBX + 0x58) + 0x30);
if (pDVar5 == (DWORD *)0x0) {
LAB_18000da48:
RtlReleaseResource(*(longlong *)(unaff_RBX + 0x58) + 0x48);
if (psz != (LPWSTR)0x0) goto LAB_18000dcdb;
*(undefined **)(unaff_RBP + -0x71) = &DAT_18008233c;
}
else {
DVar9 = CertNameToStrW(*pDVar5,(PCERT_NAME_BLOB)(*(longlong *)(pDVar5 + 6) + 0x50),0x20000003,
(LPWSTR)0x0,0);
*(DWORD *)(unaff_RBP + 0x57) = DVar9;
if ((DVar9 == 0) || (psz = (LPWSTR)FUN_18000a1f4((ulonglong)(DVar9 * 2)), psz == (LPWSTR)0x0))
goto LAB_18000da48;
CertNameToStrW(*pDVar5,(PCERT_NAME_BLOB)(*(longlong *)(pDVar5 + 6) + 0x50),0x20000003,psz,
*(DWORD *)(unaff_RBP + 0x57));
RtlReleaseResource(*(longlong *)(unaff_RBX + 0x58) + 0x48);
LAB_18000dcdb:
*(LPWSTR *)(unaff_RBP + -0x71) = psz;
}
puVar14 = &DAT_18008233c;
if (puVar13 != (undefined *)0x0) {
puVar14 = puVar13;
}
puVar13 = &DAT_18008233c;
if (puVar11 != (undefined *)0x0) {
puVar13 = puVar11;
}
*(undefined4 *)(unaff_RBP + 0x57) = *(undefined4 *)(*(longlong *)(unaff_RBX + 0x58) + 8);
if ((DAT_1800919b0 & 4) != 0) {
uVar3 = *(uint *)(unaff_RBX + 0x40);
FUN_1800452cc(uVar3,unaff_RBP + -0x39);
uVar12 = DAT_180092df8;
if ((uVar3 & 0x40051555) != 0) {
uVar12 = DAT_180092df0;
}
RtlInitUnicodeString(unaff_RBP + -0x29,uVar12);
RtlInitUnicodeString(unaff_RBP + -0x49,puVar13);
RtlInitUnicodeString(unaff_RBP + -0x59,puVar14);
RtlInitUnicodeString(unaff_RBP + -0x69,*(undefined8 *)(unaff_RBP + -0x71));
FUN_180045408((ushort *)&DAT_180082ac8,0x180082ab0,unaff_RBP + -0x29,unaff_RBP + -0x39);
}
if (psz != (LPWSTR)0x0) {
FUN_18000909c(psz);
}
}
else {
*(undefined *)(unaff_RBX + 0x109) = 0;
}
iVar8 = *(int *)(unaff_RBP + 0x4f);
LAB_18000dac0:
if ((*(int *)(unaff_RBX + 0x44) - 3U < 2) || (*(int *)(unaff_RBX + 0x44) == 0x4f)) {
unaff_R13D = 0;
}
else if (iVar8 == 0) {

if (cVar7 == '\0') {
iVar8 = FUN_1800382c8();
return iVar8;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180084d00);
}
unaff_R13D = 0x90366;
}
puVar6 = *(undefined8 **)(unaff_RBP + 0xa7);
if (puVar6 != (undefined8 *)0x0) {
lVar10 = *(longlong *)(unaff_RBX + 0x58);
if (lVar10 != 0) {
RtlAcquireResourceShared(lVar10 + 0x48,1);
if (*(longlong *)(lVar10 + 0x30) != 0) {
*puVar6 = *(undefined8 *)(*(longlong *)(*(longlong *)(lVar10 + 0x30) + 0x18) + 0x48);
RtlReleaseResource(lVar10 + 0x48);
return unaff_R13D;
}
RtlReleaseResource();
}
*puVar6 = 0x7fffff36d5969fff;
}
return unaff_R13D;
}
=========================================
Function at address: 0x180038180
Called functions addresses: 0x180045408 0x1800452cc 0x180041cb0


int FUN_180038180(longlong param_1)

{
int iVar1;
undefined4 uVar2;
uint uVar3;
undefined4 *puVar4;
DWORD *pDVar5;
undefined8 *puVar6;
char cVar7;
int iVar8;
DWORD DVar9;
longlong lVar10;
undefined *puVar11;
LPWSTR psz;
undefined8 uVar12;
longlong unaff_RBX;
longlong unaff_RBP;
undefined *puVar13;
int unaff_EDI;
int unaff_R13D;
undefined *puVar14;

FUN_180041cb0(*(undefined8 *)(param_1 + 0x10),0x13,&DAT_180084d00);
iVar8 = *(int *)(unaff_RBP + 0x4f);
if (unaff_EDI != 0) {
return unaff_EDI;
}
iVar1 = *(int *)(unaff_RBX + 0x44);
if ((((iVar1 != 4) && (iVar1 != 0x33)) && (iVar1 != 0x4f)) ||
((*(uint *)(unaff_RBX + 0x88) >> 0x1e & 1) != 0)) goto LAB_18000dac0;
*(longlong *)(unaff_RBP + -0x29) = unaff_RBX;
*(undefined8 *)(unaff_RBP + -0x21) = 0;
*(undefined8 *)(unaff_RBP + -0x19) = 0;
*(undefined8 *)(unaff_RBP + -0x11) = 0;
**(undefined **)(unaff_RBP + 0x9f) = 1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180084d00);
}
iVar8 = FUN_18000dda0((undefined8 *)(unaff_RBP + -0x29),FUN_18004a500);
if (iVar8 != 0) {
return iVar8;
}
uVar2 = *(undefined4 *)(unaff_RBP + -0x11);

*(longlong *)(unaff_RBP + -0x21) = lVar10;
if (lVar10 == 0) {
return 0xe;
}
*(undefined4 *)(unaff_RBP + -0xd) = uVar2;
*(longlong *)(unaff_RBP + -0x19) = lVar10;
iVar8 = FUN_18000dda0((undefined8 *)(unaff_RBP + -0x29),FUN_18004a500);
if (iVar8 != 0) {

(*(undefined8 *)(unaff_RBP + -0x29),*(undefined8 *)(unaff_RBP + -0x21));
return iVar8;
}
puVar4 = *(undefined4 **)(unaff_RBP + 0x67);
*(undefined8 *)(puVar4 + 2) = *(undefined8 *)(unaff_RBP + -0x21);
*puVar4 = *(undefined4 *)(unaff_RBP + -0x11);
*(ulonglong *)(unaff_RBX + 0x88) = *(ulonglong *)(unaff_RBX + 0x88) | 0x40000000;
if ((*(int *)(unaff_RBX + 0x44) != 4) && (*(int *)(unaff_RBX + 0x44) != 0x4f)) {
if (*(longlong *)(unaff_RBX + 0x98) != 0) {
SslFreeObject(*(longlong *)(unaff_RBX + 0x98),0);
*(undefined8 *)(unaff_RBX + 0x98) = 0;
}
iVar8 = 1;
goto LAB_18000dac0;
}

if (*(char *)(unaff_RBX + 0x109) == '\0') {
puVar13 = (undefined *)0x0;
psz = (LPWSTR)0x0;


if (lVar10 != 0) {
puVar13 = *(undefined **)(lVar10 + 400);
}
RtlAcquireResourceShared(*(longlong *)(unaff_RBX + 0x58) + 0x48,1);
pDVar5 = *(DWORD **)(*(longlong *)(unaff_RBX + 0x58) + 0x30);
if (pDVar5 == (DWORD *)0x0) {
LAB_18000da48:
RtlReleaseResource(*(longlong *)(unaff_RBX + 0x58) + 0x48);
if (psz != (LPWSTR)0x0) goto LAB_18000dcdb;
*(undefined **)(unaff_RBP + -0x71) = &DAT_18008233c;
}
else {
DVar9 = CertNameToStrW(*pDVar5,(PCERT_NAME_BLOB)(*(longlong *)(pDVar5 + 6) + 0x50),0x20000003,
(LPWSTR)0x0,0);
*(DWORD *)(unaff_RBP + 0x57) = DVar9;
if ((DVar9 == 0) || (psz = (LPWSTR)FUN_18000a1f4((ulonglong)(DVar9 * 2)), psz == (LPWSTR)0x0))
goto LAB_18000da48;
CertNameToStrW(*pDVar5,(PCERT_NAME_BLOB)(*(longlong *)(pDVar5 + 6) + 0x50),0x20000003,psz,
*(DWORD *)(unaff_RBP + 0x57));
RtlReleaseResource(*(longlong *)(unaff_RBX + 0x58) + 0x48);
LAB_18000dcdb:
*(LPWSTR *)(unaff_RBP + -0x71) = psz;
}
puVar14 = &DAT_18008233c;
if (puVar13 != (undefined *)0x0) {
puVar14 = puVar13;
}
puVar13 = &DAT_18008233c;
if (puVar11 != (undefined *)0x0) {
puVar13 = puVar11;
}
*(undefined4 *)(unaff_RBP + 0x57) = *(undefined4 *)(*(longlong *)(unaff_RBX + 0x58) + 8);
if ((DAT_1800919b0 & 4) != 0) {
uVar3 = *(uint *)(unaff_RBX + 0x40);
FUN_1800452cc(uVar3,unaff_RBP + -0x39);
uVar12 = DAT_180092df8;
if ((uVar3 & 0x40051555) != 0) {
uVar12 = DAT_180092df0;
}
RtlInitUnicodeString(unaff_RBP + -0x29,uVar12);
RtlInitUnicodeString(unaff_RBP + -0x49,puVar13);
RtlInitUnicodeString(unaff_RBP + -0x59,puVar14);
RtlInitUnicodeString(unaff_RBP + -0x69,*(undefined8 *)(unaff_RBP + -0x71));
FUN_180045408((ushort *)&DAT_180082ac8,0x180082ab0,unaff_RBP + -0x29,unaff_RBP + -0x39);
}
if (psz != (LPWSTR)0x0) {
FUN_18000909c(psz);
}
}
else {
*(undefined *)(unaff_RBX + 0x109) = 0;
}
iVar8 = *(int *)(unaff_RBP + 0x4f);
LAB_18000dac0:
if ((*(int *)(unaff_RBX + 0x44) - 3U < 2) || (*(int *)(unaff_RBX + 0x44) == 0x4f)) {
unaff_R13D = 0;
}
else if (iVar8 == 0) {

if (cVar7 == '\0') {
iVar8 = FUN_1800382c8();
return iVar8;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180084d00);
}
unaff_R13D = 0x90366;
}
puVar6 = *(undefined8 **)(unaff_RBP + 0xa7);
if (puVar6 != (undefined8 *)0x0) {
lVar10 = *(longlong *)(unaff_RBX + 0x58);
if (lVar10 != 0) {
RtlAcquireResourceShared(lVar10 + 0x48,1);
if (*(longlong *)(lVar10 + 0x30) != 0) {
*puVar6 = *(undefined8 *)(*(longlong *)(*(longlong *)(lVar10 + 0x30) + 0x18) + 0x48);
RtlReleaseResource(lVar10 + 0x48);
return unaff_R13D;
}
RtlReleaseResource();
}
*puVar6 = 0x7fffff36d5969fff;
}
return unaff_R13D;
}
=========================================
Function at address: 0x1800382c8
Called functions addresses: 0x180041cb0


undefined4 FUN_1800382c8(void)

{
undefined8 *puVar1;
longlong lVar2;
longlong unaff_RBX;
longlong unaff_RBP;
undefined4 unaff_R13D;

if (((*(uint *)(unaff_RBX + 0x40) & 0x1000) != 0) && (*(int *)(unaff_RBX + 0x44) == 0x46)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180084d00);
}
unaff_R13D = 0x90366;
}
puVar1 = *(undefined8 **)(unaff_RBP + 0xa7);
if (puVar1 != (undefined8 *)0x0) {
lVar2 = *(longlong *)(unaff_RBX + 0x58);
if (lVar2 != 0) {
RtlAcquireResourceShared(lVar2 + 0x48,1);
if (*(longlong *)(lVar2 + 0x30) != 0) {
*puVar1 = *(undefined8 *)(*(longlong *)(*(longlong *)(lVar2 + 0x30) + 0x18) + 0x48);
RtlReleaseResource(lVar2 + 0x48);
return unaff_R13D;
}
RtlReleaseResource();
}
*puVar1 = 0x7fffff36d5969fff;
}
return unaff_R13D;
}
=========================================
Function at address: 0x180038498
Called functions addresses: None


ulonglong FUN_180038498(int param_1)

{
uint uVar1;
ulonglong in_RAX;

if (param_1 != -0x7ff6fcdf) {
uVar1 = param_1 + 0x7ff6fc96;
in_RAX = (ulonglong)uVar1;
if (1 < uVar1) {
return CONCAT71((uint7)(uint3)(uVar1 >> 8),1);
}
}
return in_RAX & 0xffffffffffffff00;
}
=========================================
Function at address: 0x1800385e1
Called functions addresses: 0x180017230


undefined4 FUN_1800385e1(void)

{
undefined4 unaff_EBX;

FUN_180017230();
RtlLeaveCriticalSection(&DAT_180092cc8);
return unaff_EBX;
}
=========================================
Function at address: 0x180038668
Called functions addresses: 0x180041d70


undefined4 FUN_180038668(longlong param_1)

{
wchar_t *unaff_RBX;
undefined4 in_stack_00000030;

FUN_180041d70(*(undefined8 *)(param_1 + 0x10),10,&DAT_1800853f8,unaff_RBX);
return in_stack_00000030;
}
=========================================
Function at address: 0x180038686
Called functions addresses: 0x180041d70


undefined4 FUN_180038686(void)

{
undefined4 unaff_EBX;
wchar_t *unaff_RSI;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041d70(DAT_180091000[2],0xe,&DAT_1800853f8,unaff_RSI);
}
return unaff_EBX;
}
=========================================
Function at address: 0x180039a2e
Called functions addresses: 0x180011434 0x180057d84 0x180041cb0 0x180041d20 0x180003d4c 0x180041e9c


void FUN_180039a2e(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
undefined8 param_5,undefined param_6,undefined param_7,char param_8,
undefined param_9,undefined param_10,longlong param_11)

{
undefined8 *puVar1;
uint uVar2;
undefined8 *puVar3;
uint unaff_EBX;
longlong unaff_RBP;
undefined8 *puVar4;
longlong unaff_RDI;
char unaff_R15B;
undefined7 in_stack_00000049;
undefined3 in_stack_00000051;
undefined8 *in_stack_00000058;
undefined8 *in_stack_00000078;

if ((DAT_180091000 != unaff_RDI) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(*(undefined8 *)(DAT_180091000 + 0x10),0x3b,&DAT_180084ce0);
}
uVar2 = FUN_180057d84((undefined8 *)(unaff_RBP + -0x80),unaff_EBX,
(PCERT_CHAIN_POLICY_STATUS)(unaff_RBP + -0x70),param_11,
*(uint *)(unaff_RBP + -0x60),unaff_RBP + 0x50);
puVar1 = (undefined8 *)CONCAT71(in_stack_00000049,param_9);
puVar4 = in_stack_00000058;
if (uVar2 == 0) {
FUN_180010cb0(*(longlong *)(unaff_RBP + -0x80),puVar1);
*in_stack_00000058 = *(undefined8 *)(unaff_RBP + -0x80);
puVar4 = in_stack_00000058;
if (unaff_R15B == '\0') goto LAB_180010c1d;
if (DAT_180092620 != 0) {

(&param_10,unaff_RBP + -0x68,0,&stack0x00000070,0);
if ((-1 < (int)uVar2) && (_param_10 == 4)) {
*in_stack_00000078 = *in_stack_00000058;

(4,*(undefined8 *)(unaff_RBP + -0x68),4,&stack0x00000070,1);
if (-1 < (int)uVar2) {
uVar2 = 0x80090301;
param_8 = '\x01';
goto LAB_180010c28;
}
}
goto LAB_180010c1d;
}
uVar2 = 0x80090304;
}
else {
LAB_180010c1d:
uVar2 = FUN_18000c3a8(uVar2);
}
LAB_180010c28:
if ((param_11 == 0) || (param_8 != '\0')) {
if (uVar2 == 0) goto LAB_180010c3e;
}
else {
if (uVar2 == 0) goto LAB_180010c3e;
NtClose();
if ((DAT_180091000 != unaff_RDI) && ((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(*(undefined8 *)(DAT_180091000 + 0x10),0x3c,&DAT_180084ce0,param_11);
}
}
if (uVar2 != 0x80090301) {
puVar3 = (undefined8 *)0x0;
if (unaff_R15B == '\0') {
puVar3 = in_stack_00000078;
}
FUN_180011434((longlong)puVar3);
if (*(longlong **)(unaff_RBP + -0x80) != (longlong *)0x0) {
FUN_180003d4c(DAT_1800927e8,*(longlong **)(unaff_RBP + -0x80));
}
if (puVar4 != (undefined8 *)0x0) {
*puVar4 = 0;
}
if (puVar1 != (undefined8 *)0x0) {
*puVar1 = 0;
}
}
LAB_180010c3e:
if ((DAT_180091000 != unaff_RDI) &&
((((*(byte *)(DAT_180091000 + 0x1c) & 1) != 0 && (uVar2 != 0)) ||
((*(byte *)(DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(*(undefined8 *)(DAT_180091000 + 0x10),0x3d,&DAT_180084ce0,uVar2,(char)uVar2);
}
FUN_180028070(*(ulonglong *)(unaff_RBP + 0x260) ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x18003ac04
Called functions addresses: None


undefined8 FUN_18003ac04(void)

{
return 0xc00000e5;
}
=========================================
Function at address: 0x18003ad76
Called functions addresses: 0x180072adc 0x180011ff0 0x180041244 0x180012184 0x18002a7c0 0x180072f28 0x1800432ec 0x180041d20 0x180044ee8 0x180073a40 0x180011f40 0x180011c2d 0x180041cdc 0x18006f734 0x180044e9c 0x18006ffcc 0x180059d38 0x180041cb0 0x18006f874 0x18005b470 0x180070304 0x180053180 0x18006a8f8 0x180012e50


ulonglong FUN_18003ad76(undefined8 param_1,int param_2,ulonglong param_3)

{
byte bVar1;
ushort uVar2;
longlong lVar3;
byte bVar4;
int iVar5;
undefined4 in_EAX;
uint uVar6;
ulonglong uVar7;
undefined4 extraout_var;
byte *pbVar8;
undefined4 *puVar9;
uint uVar10;
undefined8 *puVar11;
undefined2 uVar12;
int iVar13;
undefined *puVar14;
longlong *unaff_RBX;
void *unaff_RBP;
uint uVar15;
byte *pbVar16;
uint *unaff_RSI;
char cVar17;
byte *unaff_RDI;
ulonglong uVar18;
char cVar19;
undefined *puVar20;
longlong lVar21;
longlong lVar22;
uint unaff_R12D;
undefined2 unaff_R14W;
byte *pbVar23;
uint uVar24;
uint uVar25;
longlong unaff_R15;
undefined4 uStack0000000000000030;
undefined8 uStack0000000000000038;
undefined8 uStack0000000000000040;
undefined4 uStack0000000000000048;
undefined4 uStack0000000000000050;
undefined4 uStack0000000000000058;
undefined4 uStack0000000000000060;
undefined4 uStack0000000000000068;
uint uStack0000000000000070;
uint uStack0000000000000078;
undefined8 uStack0000000000000080;
undefined4 uStack0000000000000088;
uint uStack0000000000000090;
undefined4 uStack0000000000000098;

cVar17 = (char)unaff_RDI;
switch(in_EAX) {
case 2:
case 4:
case 5:
case 0x5b:
case 0x5d:
case 0x5f:
case 0x60:
case 0x62:
case 99:
case 100:
case 0x65:
case 0x66:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180082c58);
}
if ((*(char *)((longlong)unaff_RBX + 0xe9) == cVar17) ||
(*(int *)((longlong)unaff_RBX + 0x44) != 0x5b)) {
uVar7 = FUN_180011f40(unaff_RBX,unaff_RSI);
return uVar7;
}
uVar7 = FUN_180011f40(unaff_RBX,(longlong)unaff_RBP + -0x58);
if ((int)uVar7 != 0) {
return uVar7;
}
if (*(byte **)((longlong)unaff_RBP + -0x50) != unaff_RDI) {
iVar5 = FUN_18006f874(unaff_RBX,(undefined4 *)((longlong)unaff_RBP + -0x58),unaff_RSI);
return CONCAT44(extraout_var,iVar5);
}
return uVar7;
}
puVar11 = DAT_180091000;
if ((((param_2 == 0x4c) && (*(char *)((longlong)unaff_RBX + 0x22b) == cVar17)) &&
(*(byte **)(unaff_R15 + 8) != unaff_RDI)) && ((*(uint *)(unaff_RBX + 8) & 0x50000) != 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180082c58);
param_3 = (ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
}
if (*(char *)((longlong)unaff_RBX + 0x10a) == cVar17) {
LAB_18003ae95:
uVar15 = FUN_180041244((longlong)unaff_RBX);
*(uint *)((longlong)unaff_RBP + -0x80) = uVar15;
param_3 = (ulonglong)uVar15;
if (uVar15 == 0x90312) {
*(undefined4 *)((longlong)unaff_RBX + 0x44) = 0x4d;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar12 = 0xc;
LAB_18003b9be:
FUN_180041cb0(DAT_180091000[2],uVar12,&DAT_180082c58);
}
return 0x90312;
}
if (uVar15 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],unaff_R14W,&DAT_180082c58);
param_3 = (ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
}
goto LAB_180011f0a;
}
}
else if (*(int *)(unaff_RBX + 9) != 0x4d) {
*(undefined4 *)(unaff_RBX + 9) = *(undefined4 *)((longlong)unaff_RBX + 0x44);
goto LAB_18003ae95;
}
puVar11 = DAT_180091000;
*(bool *)((longlong)unaff_RBP + 0x740) = *(char *)(unaff_RBX + 0x3b) == cVar17;
}
pbVar23 = *(byte **)(unaff_R15 + 8);
uVar15 = *(uint *)(unaff_R15 + 4);
*(byte **)((longlong)unaff_RBP + -0x60) = pbVar23;
*(uint *)((longlong)unaff_RBP + -0x6c) = uVar15;
while( true ) {
if (((undefined8 **)puVar11 != &DAT_180091000) &&
((*(byte *)((longlong)puVar11 + 0x1c) & 4) != 0)) {
FUN_180041cb0(puVar11[2],0xe,&DAT_180082c58);
param_3 = (ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
puVar11 = DAT_180091000;
}
uVar6 = (uint)unaff_RDI;
if (uVar15 < unaff_R12D) {
if (*(uint *)((longlong)unaff_RBP + -0x70) == uVar6) {
*(uint *)(unaff_R15 + 4) = unaff_R12D;
lVar21 = unaff_RBX[0x10];
if (*(short *)(lVar21 + 0x22) == (short)unaff_RDI) {
*(undefined2 *)(lVar21 + 0x22) = 0xd;
*(undefined4 *)(lVar21 + 0x24) = 0x80090318;
}
memset(unaff_RBP,0,0x6e8);
cVar17 = DAT_1800927ac;
lVar21 = unaff_RBX[1];
if (lVar21 != 0) {
unaff_RDI = (byte *)(ulonglong)*(uint *)(lVar21 + 0x1c);
}
uVar2 = *(ushort *)((longlong)unaff_RBX + 0x22);
lVar3 = unaff_RBX[0x11];
*(undefined4 *)((longlong)unaff_RBP + 0xc) = *(undefined4 *)(unaff_RBX + 2);
*(int *)((longlong)unaff_RBP + 8) = (int)unaff_RDI;
if ((lVar21 != 0) && (unaff_RBX[0xb] != 0)) {
lVar22 = unaff_RBX[0xf];
iVar5 = *(int *)(lVar21 + 0x20);
if (((lVar22 != 0) && (cVar17 != '\0')) &&
(((*(undefined4 *)(lVar22 + 0x30) = *(undefined4 *)(unaff_RBX[0xb] + 8),
iVar5 == 0xaa02 || (iVar5 == 0xa400)) &&
(puVar9 = FUN_180059d38(iVar5), puVar9 != (undefined4 *)0x0)))) {
*(undefined4 *)(lVar22 + 0x34) = puVar9[8];
*(undefined4 *)(lVar22 + 0x38) = puVar9[10];
if (iVar5 == 0xaa02) {
*(undefined4 *)(lVar22 + 0x3c) = puVar9[0xc];
}
}
}
lVar21 = unaff_RBX[0xf];
if ((lVar21 != 0) && (cVar17 != '\0')) {
*(int *)(lVar21 + 0x24) =
(int)((ulonglong)*(undefined8 *)((longlong)unaff_RBP + 8) >> 0x20);
*(undefined4 *)(lVar21 + 0x68) = 0x80090318;
*(undefined4 *)(lVar21 + 0x70) = 0xd;
*(int *)(lVar21 + 0x20) = (int)unaff_RDI;
*(uint *)(lVar21 + 0x28) = (uint)uVar2;
*(longlong *)(lVar21 + 0x80) = lVar3;
lVar21 = unaff_RBX[0xf];
}
if (((lVar21 != 0) && (cVar17 != '\0')) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
uStack0000000000000098 = *(undefined4 *)(lVar21 + 0x70);
uStack0000000000000088 = *(undefined4 *)(lVar21 + 0x68);
uStack0000000000000090 = (uint)*(byte *)(lVar21 + 0x6c);
uStack0000000000000080 = *(undefined8 *)(lVar21 + 0x60);
uStack0000000000000068 = *(undefined4 *)(lVar21 + 0x30);
uStack0000000000000078 = (uint)*(ushort *)(lVar21 + 0x42);
uStack0000000000000070 = (uint)*(ushort *)(lVar21 + 0x40);
uStack0000000000000060 = *(undefined4 *)(lVar21 + 0x2c);
uStack0000000000000058 = *(undefined4 *)(lVar21 + 0x28);
uStack0000000000000050 = *(undefined4 *)(lVar21 + 0x24);
uStack0000000000000048 = *(undefined4 *)(lVar21 + 0x20);
uStack0000000000000040 = *(undefined8 *)(lVar21 + 0x80);
uStack0000000000000038 = *(undefined8 *)(lVar21 + 0x78);
uStack0000000000000030 = *(undefined4 *)(lVar21 + 0x18);
FUN_180053180(DAT_180091000[2],(ulonglong)*(ushort *)(lVar21 + 0x42),
(ulonglong)*(ushort *)(lVar21 + 0x40),L"Error",(wchar_t *)(lVar21 + 0x98),
(wchar_t *)(lVar21 + 0x298));
}
return 0x80090318;
}
goto LAB_180011efd;
}
bVar4 = *pbVar23;
puVar20 = (undefined *)(ulonglong)bVar4;
*(uint *)((longlong)unaff_RBP + 0x758) = (uint)bVar4;
if (3 < bVar4 - 0x14) {
FUN_18005b470(unaff_RBX,10,0x80090308,10);
return 0x80090308;
}
bVar4 = pbVar23[1];
bVar1 = pbVar23[2];
if (((undefined8 **)puVar11 != &DAT_180091000) &&
((*(byte *)((longlong)puVar11 + 0x1c) & 4) != 0)) {
FUN_180041cdc(puVar11[2],0xf,&DAT_180082c58,(uint)CONCAT11(bVar4,bVar1));
puVar20 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
puVar11 = DAT_180091000;
}
if (CONCAT11(bVar4,bVar1) < 0x300) {
if ((0x301 < *(uint *)((longlong)unaff_RBX + 0x24)) &&
((*(uint *)(unaff_RBX + 8) & 0x800a00aa) != 0)) {
FUN_180012184((longlong)unaff_RBX,0xb,-0x7ff6fcda);
return 0x80090326;
}
FUN_18005b470(unaff_RBX,0xb,0x80090308,0x46);
return 0x80090308;
}
if ((pbVar23[1] == 0xfe) && (CONCAT11(pbVar23[1],pbVar23[2]) < 0xff00)) {
bVar4 = pbVar23[0xb];
bVar1 = pbVar23[0xc];
}
else {
bVar4 = pbVar23[3];
bVar1 = pbVar23[4];
}
uVar15 = (uint)CONCAT11(bVar4,bVar1);
*(uint *)((longlong)unaff_RBP + -0x7c) = uVar15;
if (((undefined8 **)puVar11 != &DAT_180091000) &&
((*(byte *)((longlong)puVar11 + 0x1c) & 4) != 0)) {
FUN_180041cdc(puVar11[2],0x10,&DAT_180082c58,uVar15);
puVar20 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
}
uVar10 = uVar15 + unaff_R12D;
*(uint *)((longlong)unaff_RBP + -0x48) = uVar10;
if (*(uint *)((longlong)unaff_RBP + -0x6c) < uVar10) break;
iVar5 = *(int *)((longlong)unaff_RBP + -0x70) + uVar10;
*(int *)(unaff_R15 + 4) = iVar5;
*(int *)((longlong)unaff_RBP + -0x70) = iVar5;
if (*(char *)((longlong)unaff_RBX + 0xe9) != cVar17) {
uVar2 = CONCAT11(pbVar23[3],pbVar23[4]);
*(uint *)((longlong)unaff_RBP + -0x80) = uVar6;
bVar4 = pbVar23[5];
*(byte **)((longlong)unaff_RBP + -0x78) = unaff_RDI;
*(ulonglong *)((longlong)unaff_RBP + -0x40) =
CONCAT71(CONCAT61(CONCAT51(CONCAT41(CONCAT31(CONCAT21(uVar2,bVar4),pbVar23[6]),pbVar23[7]
),pbVar23[8]),pbVar23[9]),pbVar23[10]);
uVar7 = (ulonglong)uVar2;
*(ulonglong *)((longlong)unaff_RBP + -0x68) = uVar7;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041d20(DAT_180091000[2],0x11,&DAT_180082c58,(uint)uVar2,
(char)*(undefined8 *)((longlong)unaff_RBP + -0x40));
puVar20 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
uVar7 = *(ulonglong *)((longlong)unaff_RBP + -0x68);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18006a8f8(DAT_180091000[2],0x12,&DAT_180082c58,*(undefined4 *)(unaff_RBX + 0x18),
(char)*(undefined2 *)((longlong)unaff_RBX + 0xdc),
(char)*(undefined4 *)unaff_RBX[0x1c]);
puVar20 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
uVar7 = *(ulonglong *)((longlong)unaff_RBP + -0x68);
}
}
uVar24 = (uint)uVar7;
cVar19 = (char)puVar20;
pbVar8 = unaff_RDI;
uVar25 = uVar6;
uVar10 = uVar6;
if (*(char *)((longlong)unaff_RBP + 0x740) != cVar17) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180082c58);
cVar19 = (char)*(undefined4 *)((longlong)unaff_RBP + 0x758);
uVar24 = (uint)*(undefined8 *)((longlong)unaff_RBP + -0x68);
}
if ((uVar24 < *(uint *)(unaff_RBX + 0x18)) && (cVar19 == '\x14')) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18003b86d;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
uVar12 = 0x14;
LAB_18003b835:
FUN_180041cb0(DAT_180091000[2],uVar12,&DAT_180082c58);
}
LAB_18003b84c:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1b,&DAT_180082c58);
}
LAB_18003b86d:
FUN_180044ee8(*(uint *)(unaff_RBX[10] + 0xd4));
FUN_180073a40(unaff_RBX[0x48]);
uVar7 = FUN_180070304((longlong)unaff_RBX);
uVar18 = uVar7 & 0xffffffff;
if ((int)uVar7 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar18;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cb0(DAT_180091000[2],0x1c,&DAT_180082c58);
return uVar18;
}
return uVar18;
}
unaff_RBX[0x11] = unaff_RBX[0x11] & 0xffffffffbfffffff;
iVar5 = *(int *)((longlong)unaff_RBP + -0x80);
*(undefined *)((longlong)unaff_RBX + 0x109) = 1;
*(undefined4 *)((longlong)unaff_RBX + 0x44) = 4;
if ((iVar5 == 0) && (*(char *)((longlong)unaff_RBX + 0x10a) == '\0')) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180082c58);
}
uVar15 = FUN_180012e50(unaff_RBX,1);
uVar7 = (ulonglong)uVar15;
if (uVar15 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar7;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cdc(DAT_180091000[2],0x1e,&DAT_180082c58,uVar15);
return uVar7;
}
return uVar7;
}
}
uVar7 = FUN_18006ffcc(unaff_RBX,*(uint **)((longlong)unaff_RBP + 0x750));
return uVar7;
}
if (uVar24 == *(uint *)(unaff_RBX + 0x18)) {
if (cVar19 == '\x17') {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18003b86d;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
uVar12 = 0x15;
goto LAB_18003b835;
}
goto LAB_18003b84c;
}
if ((((cVar19 == '\x16') && ((*(byte *)(unaff_RBX + 4) & 2) != 0)) && (unaff_RBX[1] != 0))
&& (*(uint *)(unaff_RBX[1] + 0x1c) != uVar6)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180082c58);
}
*(uint *)((longlong)unaff_RBP + -0x38) = uVar15 + unaff_R12D;
*(uint *)((longlong)unaff_RBP + -0x34) = uVar15 + unaff_R12D;
*(byte **)((longlong)unaff_RBP + -0x30) = pbVar23;
uVar7 = FUN_180011ff0(unaff_RBX,(int *)((longlong)unaff_RBP + -0x38));
if ((int)uVar7 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x90312;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x90312;
}
uVar12 = 0x17;
goto LAB_18003b9be;
}
bVar4 = *(byte *)(unaff_RBX + 4);
uVar10 = 1;
*(undefined4 *)((longlong)unaff_RBP + -0x80) = 1;
if ((bVar4 & 2) == 0) {
uVar7 = (ulonglong)unaff_RDI & 0xffffffff;
}
else {
uVar7 = (ulonglong)*(uint *)((longlong)unaff_RBX + 0x2c);
}
if ((pbVar23[1] == 0xfe) && (CONCAT11(pbVar23[1],pbVar23[2]) < 0xff00)) {
bVar4 = pbVar23[0xb];
bVar1 = pbVar23[0xc];
}
else {
bVar4 = pbVar23[3];
bVar1 = pbVar23[4];
}
uVar25 = (uint)CONCAT11(bVar4,bVar1);
if (uVar15 < uVar25 + unaff_R12D + (int)uVar7) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x18;
goto LAB_18003ba69;
}
pbVar8 = pbVar23 + uVar7 + unaff_R12D;
*(byte **)((longlong)unaff_RBP + -0x78) = pbVar8;
if (uVar25 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x19;
goto LAB_18003ba69;
}
if (*pbVar8 == 0x14) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) goto LAB_18003b86d;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
uVar12 = 0x1a;
goto LAB_18003b835;
}
goto LAB_18003b84c;
}
uVar24 = (uint)*(undefined8 *)((longlong)unaff_RBP + -0x68);
}
}
}
if ((*(int *)((longlong)unaff_RBX + 0x44) == 0x4c) &&
(*(char *)((longlong)unaff_RBX + 0xe9) != cVar17)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180082c58);
uVar10 = *(uint *)((longlong)unaff_RBP + -0x80);
uVar24 = (uint)*(undefined8 *)((longlong)unaff_RBP + -0x68);
}
*(int *)(unaff_RBX[0x49] + 0x24) =
(int)*(short *)(*(longlong *)(unaff_RBX[0x49] + 0x28) + 0xc0);
pbVar8 = *(byte **)((longlong)unaff_RBP + -0x78);
}
if ((((*(byte *)(unaff_RBX + 4) & 2) == 0) || (unaff_RBX[1] == 0)) ||
(*(uint *)(unaff_RBX[1] + 0x1c) == uVar6)) {
if (uVar10 == 0) {
LAB_18003b38f:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x24,&DAT_180082c58);
}
pbVar8 = pbVar23 + unaff_R12D;
uVar25 = uVar15;
}
}
else if (uVar10 == 0) {
if (uVar24 != *(uint *)(unaff_RBX[0x49] + 0x24)) goto LAB_18003b38f;
if (uVar24 < *(uint *)(unaff_RBX + 0x18)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x20,&DAT_180082c58);
}
FUN_180044e9c(*(uint *)(unaff_RBX[10] + 0xd4));
return 0x90312;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x21,&DAT_180082c58);
}
*(uint *)((longlong)unaff_RBP + -0x28) = uVar15 + unaff_R12D;
*(uint *)((longlong)unaff_RBP + -0x24) = uVar15 + unaff_R12D;
*(byte **)((longlong)unaff_RBP + -0x20) = pbVar23;
uVar7 = FUN_180011ff0(unaff_RBX,(int *)((longlong)unaff_RBP + -0x28));
if ((int)uVar7 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x90312;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x90312;
}
uVar12 = 0x22;
goto LAB_18003b9be;
}
if ((*(byte *)(unaff_RBX + 4) & 2) == 0) {
uVar7 = (ulonglong)unaff_RDI & 0xffffffff;
}
else {
uVar7 = (ulonglong)*(uint *)((longlong)unaff_RBX + 0x2c);
}
if ((pbVar23[1] == 0xfe) && (CONCAT11(pbVar23[1],pbVar23[2]) < 0xff00)) {
bVar4 = pbVar23[0xb];
bVar1 = pbVar23[0xc];
}
else {
bVar4 = pbVar23[3];
bVar1 = pbVar23[4];
}
if (uVar15 < CONCAT11(bVar4,bVar1) + unaff_R12D + (int)uVar7) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x23;
LAB_18003ba69:
FUN_180041cb0(DAT_180091000[2],uVar12,&DAT_180082c58);
return 0x80090326;
}
pbVar8 = pbVar23 + uVar7 + unaff_R12D;
uVar25 = (uint)CONCAT11(bVar4,bVar1);
}
FUN_180072adc((longlong *)unaff_RBX[0x49],(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758),
pbVar8,uVar25,*(ulonglong *)((longlong)unaff_RBP + -0x40));
puVar20 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
uVar10 = *(uint *)((longlong)unaff_RBP + -0x48);
}
uVar15 = *(uint *)(unaff_RBX + 8);
*(byte **)((longlong)unaff_RBP + -0x78) = unaff_RDI;
*(int *)((longlong)unaff_RBP + -0x80) = (int)puVar20;
uVar7 = (ulonglong)unaff_RDI & 0xffffffff;
if (((uVar15 & 0x3000) == 0) || ((char)puVar20 != '\x14')) {
if (*(char *)((longlong)unaff_RBX + 0xe9) == cVar17) {
uVar7 = (ulonglong)uVar10;
pbVar8 = unaff_RDI;
pbVar16 = pbVar23;
puVar14 = puVar20;
}
else {
pbVar8 = unaff_RDI;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar20 = &DAT_180082c58;
pbVar8 = (byte *)0x36;
FUN_180041cb0(DAT_180091000[2],0x36,&DAT_180082c58);
}
pbVar8 = (byte *)FUN_180072f28((undefined8 *)unaff_RBX[0x49],pbVar8,puVar20);
*(byte **)((longlong)unaff_RBP + -0x78) = pbVar8;
if (pbVar8 == (byte *)0x0) {
uVar15 = *(uint *)((longlong)unaff_RBP + -0x80);
pbVar16 = unaff_RDI;
}
else {
uVar15 = *(uint *)(pbVar8 + 0x40);
pbVar16 = *(byte **)(pbVar8 + 0x28);
uVar7 = (ulonglong)*(uint *)(pbVar8 + 0x14);
*(uint *)((longlong)unaff_RBP + -0x80) = uVar15;
}
puVar14 = (undefined *)(ulonglong)uVar15;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x37,&DAT_180082c58,uVar15);
puVar14 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
pbVar8 = *(byte **)((longlong)unaff_RBP + -0x78);
}
puVar20 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
}
uVar15 = (uint)uVar7;
if (pbVar16 != (byte *)0x0) {
while( true ) {
puVar11 = DAT_180091000;
uVar10 = (uint)puVar20;
if (((((*(byte *)(unaff_RBX + 4) & 2) == 0) || (unaff_RBX[1] == 0)) ||
(*(uint *)(unaff_RBX[1] + 0x1c) == uVar6)) ||
((*(char *)((longlong)unaff_RBX + 0xe9) != cVar17 &&
((pbVar8 == (byte *)0x0 || (*(uint *)(pbVar8 + 0x44) == uVar6)))))) {
if ((*(char *)((longlong)unaff_RBX + 0xe9) == cVar17) || ((int)puVar14 == 0x14)) {
pbVar16 = pbVar16 + unaff_R12D;
}
}
else {
iVar5 = *(int *)((longlong)unaff_RBX + 0x44);
uVar24 = (uint)uVar7;
*(uint *)((longlong)unaff_RBP + -0x18) = uVar24;
*(uint *)((longlong)unaff_RBP + -0x14) = uVar24;
*(byte **)((longlong)unaff_RBP + -0x10) = pbVar16;
if (((iVar5 - 0x4eU < 2) && (unaff_R12D < uVar15)) &&
((pbVar16 != (byte *)0x0 && (*pbVar16 == 0x16)))) {
if (((undefined8 **)puVar11 != &DAT_180091000) &&
((*(byte *)((longlong)puVar11 + 0x1c) & 4) != 0)) {
FUN_180041cb0(puVar11[2],0x25,&DAT_180082c58);
uVar10 = *(uint *)((longlong)unaff_RBP + 0x758);
puVar14 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
}
uVar2 = *(ushort *)(pbVar16 + ((ulonglong)uVar15 - 2));
if (uVar15 - unaff_R12D < (uint)uVar2) {
return 0x80090308;
}
bVar4 = (byte)(uVar2 >> 8);
if (*(char *)((longlong)unaff_RBX + 0xe9) == cVar17) {
pbVar16[3] = bVar4;
pbVar16[4] = (byte)uVar2;
}
else {
pbVar16[0xb] = bVar4;
pbVar16[0xc] = (byte)uVar2;
}
}
else {
if (((undefined8 **)puVar11 != &DAT_180091000) &&
((*(byte *)((longlong)puVar11 + 0x1c) & 4) != 0)) {
FUN_180041cb0(puVar11[2],0x26,&DAT_180082c58);
}
uVar7 = FUN_180011ff0(unaff_RBX,(int *)((longlong)unaff_RBP + -0x18));
if ((int)uVar7 != 0) {
if (*(char *)((longlong)unaff_RBX + 0xe9) == cVar17) {
return uVar7;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x27,&DAT_180082c58);
}
}
if ((*(uint *)(unaff_RBX + 8) & 0x3000) == 0) {
uVar10 = *(uint *)((longlong)unaff_RBP + 0x758);
puVar14 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
}
else {
bVar4 = *pbVar16;
uVar10 = (uint)bVar4;
*(uint *)((longlong)unaff_RBP + 0x758) = (uint)bVar4;
puVar14 = (undefined *)(ulonglong)(uint)bVar4;
if (bVar4 == 0x14) {
FUN_18005b470(unaff_RBX,0x388,0x80090326,10);
return 0x80090326;
}
}
}
uVar15 = uVar6;
if ((*(byte *)(unaff_RBX + 4) & 2) != 0) {
uVar15 = *(uint *)((longlong)unaff_RBX + 0x2c);
}
if ((pbVar16[1] == 0xfe) && (CONCAT11(pbVar16[1],pbVar16[2]) < 0xff00)) {
bVar4 = pbVar16[0xb];
bVar1 = pbVar16[0xc];
}
else {
bVar4 = pbVar16[3];
bVar1 = pbVar16[4];
}
if (uVar24 < CONCAT11(bVar4,bVar1) + unaff_R12D + uVar15) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar12 = 0x28;
goto LAB_18003ba69;
}
pbVar16 = pbVar16 + (unaff_R12D + uVar15);
}
if (((uVar10 - 0x14 & 0xfffffffc) == 0) && (uVar10 != 0x15)) {
*(char *)((longlong)unaff_RBX + 0x1d9) = cVar17;
}

uVar7 = (ulonglong)uVar15;
if (uVar15 != 0) {
if ((*(uint *)(unaff_RBX + 0x11) >> 0x12 & 1) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x29,&DAT_180082c58);
}
*(undefined4 *)(*(longlong *)((longlong)unaff_RBP + 0x748) + 4) =
*(undefined4 *)((longlong)unaff_RBP + -0x44);
return uVar7;
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cdc(DAT_180091000[2],0x2a,&DAT_180082c58,uVar15);
return uVar7;
}
return uVar7;
}
return uVar7;
}
if (*(HLOCAL *)((longlong)unaff_RBP + -0x78) != (HLOCAL)0x0) {
FUN_18006f734(*(HLOCAL *)((longlong)unaff_RBP + -0x78));
}
uVar10 = *(uint *)(unaff_RBX + 8);
uVar7 = (ulonglong)unaff_RDI & 0xffffffff;
*(int *)((longlong)unaff_RBP + -0x80) = *(int *)((longlong)unaff_RBP + 0x758);
uVar15 = uVar6;
if (((uVar10 & 0x3000) != 0) && (*(int *)((longlong)unaff_RBP + 0x758) == 0x14)) break;
if (*(char *)((longlong)unaff_RBX + 0xe9) == cVar17) goto LAB_180011c39;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
pbVar16 = &DAT_180082c58;
puVar14 = (undefined *)0x36;
FUN_180041cb0(DAT_180091000[2],0x36,&DAT_180082c58);
}
pbVar8 = (byte *)FUN_180072f28((undefined8 *)unaff_RBX[0x49],puVar14,pbVar16);
*(byte **)((longlong)unaff_RBP + -0x78) = pbVar8;
if (pbVar8 == (byte *)0x0) {
uVar10 = *(uint *)((longlong)unaff_RBP + -0x80);
pbVar16 = unaff_RDI;
}
else {
uVar10 = *(uint *)(pbVar8 + 0x40);
pbVar16 = *(byte **)(pbVar8 + 0x28);
uVar7 = (ulonglong)*(uint *)(pbVar8 + 0x14);
*(uint *)((longlong)unaff_RBP + -0x80) = uVar10;
}
uVar15 = (uint)uVar7;
puVar14 = (undefined *)(ulonglong)uVar10;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x37,&DAT_180082c58,uVar10);
uVar7 = FUN_180011c2d((longlong)DAT_180091000,*(byte **)((longlong)unaff_RBP + -0x78));
return uVar7;
}
if (pbVar16 == (byte *)0x0) goto LAB_180011c39;
puVar20 = (undefined *)(ulonglong)*(uint *)((longlong)unaff_RBP + 0x758);
}

if (uVar6 != 0) {
if ((uVar6 != 0x80090326) && (uVar6 != 0x80090308)) {
return (ulonglong)uVar6;
}
FUN_18005b470(unaff_RBX,0x388,uVar6,10);
return (ulonglong)uVar6;
}
LAB_180011c39:
pbVar23 = *(byte **)((longlong)unaff_RBP + -0x60);
}
uVar6 = uVar15;
iVar5 = *(int *)((longlong)unaff_RBP + -0x7c);
}
else {
iVar5 = *(int *)((longlong)unaff_RBP + -0x7c);

if (uVar15 != 0) {
if ((uVar15 == 0x80090326) || (uVar15 == 0x80090308)) {
FUN_18005b470(unaff_RBX,0x388,uVar15,10);
}
return (ulonglong)uVar15;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x2b,&DAT_180082c58,uVar6);
}
puVar11 = DAT_180091000;
iVar13 = *(int *)((longlong)unaff_RBX + 0x44);
pbVar23 = pbVar23 + (iVar5 + unaff_R12D);
uVar15 = *(int *)((longlong)unaff_RBP + -0x6c) - (iVar5 + unaff_R12D);
*(byte **)((longlong)unaff_RBP + -0x60) = pbVar23;
*(uint *)((longlong)unaff_RBP + -0x6c) = uVar15;
if (iVar13 - 0x5bU < 0xc) {
if (*(char *)((longlong)unaff_RBX + 0xe9) == cVar17) {
uVar7 = FUN_180011f40(unaff_RBX,*(undefined8 *)((longlong)unaff_RBP + 0x750));
return uVar7;
}
uVar7 = FUN_180011f40(unaff_RBX,(longlong)unaff_RBP + -0x58);
iVar13 = *(int *)((longlong)unaff_RBX + 0x44);
param_3 = uVar7 & 0xffffffff;
puVar11 = DAT_180091000;
}
else {
param_3 = (ulonglong)unaff_RDI & 0xffffffff;
}
*(int *)((longlong)unaff_RBP + -0x80) = (int)param_3;
if (((iVar13 == 4) || (iVar13 == 0x4f)) || (uVar15 == 0)) goto LAB_180011efd;
unaff_R15 = *(longlong *)((longlong)unaff_RBP + 0x748);
}
if (*(uint *)((longlong)unaff_RBP + -0x70) == uVar6) {
*(uint *)(unaff_R15 + 4) = uVar10;
FUN_180012184((longlong)unaff_RBX,0xd,-0x7ff6fce8);
return 0x80090318;
}
param_3 = (ulonglong)*(uint *)((longlong)unaff_RBP + -0x80);
LAB_180011efd:
if (((*(char *)((longlong)unaff_RBX + 0xe9) != cVar17) && ((int)param_3 == 0)) &&
(*(byte **)((longlong)unaff_RBP + -0x50) != unaff_RDI)) {
uVar15 = FUN_18006f874(unaff_RBX,(undefined4 *)((longlong)unaff_RBP + -0x58),
*(uint **)((longlong)unaff_RBP + 0x750));
param_3 = (ulonglong)uVar15;
}
LAB_180011f0a:
return param_3 & 0xffffffff;
}
=========================================
Function at address: 0x18003c04c
Called functions addresses: 0x18005b470 0x18003c04c


undefined8
FUN_18003c04c(ulonglong param_1,undefined param_2,undefined param_3,undefined param_4,
undefined param_5,undefined param_6,undefined param_7,undefined param_8,
undefined param_9,undefined param_10,undefined4 param_11)

{
longlong lVar1;
undefined uVar2;
undefined8 uVar3;
uint uVar4;
longlong *unaff_RBX;
longlong unaff_RBP;
longlong unaff_RDI;
char unaff_R15B;

do {
uVar4 = (int)param_1 - 1;
param_1 = (ulonglong)uVar4;
if (uVar4 == 0) break;
} while (*(char *)(param_1 + unaff_RBP) == unaff_R15B);
if (*(char *)(param_1 + unaff_RBP) == '\0') {
FUN_18005b470(unaff_RBX,0x3c0,0x80090308,10);
uVar3 = 0x80090308;
}
else {
**(char **)(unaff_RDI + 8) = *(char *)(param_1 + unaff_RBP);
lVar1 = *(longlong *)(unaff_RDI + 8);
uVar2 = (undefined)(uVar4 >> 8);
param_11._0_1_ = (undefined)uVar4;
if (*(char *)((longlong)unaff_RBX + 0xe9) == unaff_R15B) {
*(undefined *)(lVar1 + 3) = uVar2;
*(undefined *)(lVar1 + 4) = (undefined)param_11;
unaff_RBX[0x16] = unaff_RBX[0x16] + 1;
}
else {
*(undefined *)(lVar1 + 0xb) = uVar2;
*(undefined *)(lVar1 + 0xc) = (undefined)param_11;
}
uVar3 = 0;
}
return uVar3;
}
=========================================
Function at address: 0x18003d0c4
Called functions addresses: None


undefined8 FUN_18003d0c4(void)

{
char cVar1;
char cVar2;
undefined8 uVar3;
longlong lVar4;
longlong unaff_RBP;
longlong lVar5;
char *pcVar6;
uint uVar7;
ulonglong in_R9;
undefined4 *in_R10;
uint in_R11D;
longlong unaff_R15;

do {
uVar7 = (int)in_R9 + 1;
in_R9 = (ulonglong)uVar7;
if (in_R11D <= uVar7) {
return 0x490;
}
uVar7 = 0;
lVar4 = in_R9 * 0x20;
} while (*(int *)(lVar4 + 8 + unaff_RBP) == 0);
do {
pcVar6 = (char *)(*(longlong *)(lVar4 + unaff_RBP) + 0x1fe + (ulonglong)uVar7 * 0x30c);
lVar5 = unaff_R15 - (longlong)pcVar6;
do {
cVar1 = *pcVar6;
cVar2 = pcVar6[lVar5];
if (cVar1 != cVar2) break;
pcVar6 = pcVar6 + 1;
} while (cVar2 != '\0');
if (cVar1 == cVar2) {
*in_R10 = *(undefined4 *)((ulonglong)uVar7 * 0x30c + 0x304 + *(longlong *)(lVar4 + unaff_RBP))
;
return 0;
}
uVar7 = uVar7 + 1;
if (*(uint *)(lVar4 + 8 + unaff_RBP) <= uVar7) {
uVar3 = FUN_18003d0c4();
return uVar3;
}
} while( true );
}
=========================================
Function at address: 0x18003da05
Called functions addresses: 0x18005a174


void FUN_18003da05(int param_1)

{
undefined8 uVar1;
longlong *unaff_RBX;
int unaff_EBP;
undefined1 in_R10B;
uint unaff_R14D;
byte *unaff_R15;

if (param_1 == 2) {
if (((ulonglong)unaff_RBX[0x11] >> 0x18 & 1) != 0) {
FUN_18003da5d();
return;
}
uVar1 = FUN_180014c84(unaff_RBX,(char *)unaff_R15,unaff_R14D);
if ((int)uVar1 == 0) {
if ((*(int *)((longlong)unaff_RBX + 0x44) == 0x2f) ||
(*(int *)((longlong)unaff_RBX + 0x44) == 0x34)) {
*(undefined4 *)((longlong)unaff_RBX + 0x44) = 0x30;
}
else {
*(undefined4 *)((longlong)unaff_RBX + 0x44) = 0x2d;
}
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_18005a174(DAT_180091000[2],0xd,&DAT_180085810,*(wchar_t **)(unaff_RBX[0xa5] + 0x170),in_R10B
);
}
FUN_180014ab0(unaff_RBX,unaff_EBP,unaff_R15,(ulonglong)unaff_R14D);
return;
}
=========================================
Function at address: 0x18003da5d
Called functions addresses: 0x180041cdc 0xEXTERNAL:000000c0 0xEXTERNAL:000000c2 0x180001060 0x180041cb0 0x18005b470 0x180041d70


void FUN_18003da5d(void)

{
longlong lVar1;
int iVar2;
undefined8 uVar3;
ulonglong in_RAX;
longlong *unaff_RBX;
int unaff_EBP;
uint unaff_R14D;
byte *unaff_R15;

if ((in_RAX >> 0x1b & 1) == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180085810);
}
FUN_18005b470(unaff_RBX,0x6a,0x80090326,0x28);
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0xb,&DAT_180085810,*(wchar_t **)(unaff_RBX[0xa5] + 0x170));
}
lVar1 = unaff_RBX[0xf];
if ((lVar1 != 0) && (DAT_1800927ac != '\0')) {
*(undefined4 *)(lVar1 + 0x18) = 1;
*(ushort *)(lVar1 + 0x40) = *(ushort *)(lVar1 + 0x40) | 10;
}
unaff_RBX[0x11] = unaff_RBX[0x11] & 0xfffffffffeffffff;
RtlAcquireResourceShared(unaff_RBX[0xa5] + 0x48,1);
iVar2 = FUN_180001060(unaff_RBX,*(undefined8 *)(unaff_RBX[0xa5] + 0x10));
RtlReleaseResource(unaff_RBX[0xa5] + 0x48);
if (iVar2 == 0) {
uVar3 = FUN_180014c84(unaff_RBX,(char *)unaff_R15,unaff_R14D);
if ((int)uVar3 == 0) {
if ((*(int *)((longlong)unaff_RBX + 0x44) == 0x2f) ||
(*(int *)((longlong)unaff_RBX + 0x44) == 0x34)) {
*(undefined4 *)((longlong)unaff_RBX + 0x44) = 0x30;
}
else {
*(undefined4 *)((longlong)unaff_RBX + 0x44) = 0x2d;
}
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xc,&DAT_180085810,iVar2);
}
}
FUN_180014ab0(unaff_RBX,unaff_EBP,unaff_R15,(ulonglong)unaff_R14D);
return;
}
=========================================
Function at address: 0x18003e8c5
Called functions addresses: 0x18005cc0c


undefined FUN_18003e8c5(undefined param_1,undefined param_2,undefined param_3,byte param_4,
undefined4 param_5)

{
undefined uVar1;
int iVar2;
int *piVar3;
wchar_t *_Str1;
uint *puVar4;
uint *unaff_RBX;
uint unaff_EBP;
int unaff_ESI;
uint uVar5;
ulonglong uVar6;
int *unaff_RDI;
undefined uVar7;
ulonglong uVar8;
int unaff_R14D;
uint *unaff_R15;
longlong in_stack_00000070;
char in_stack_00000078;

uVar8 = (ulonglong)param_4;
if ((uint)unaff_RDI[0xb] < unaff_EBP) {
LAB_18003e8ce:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_5._0_1_ = (undefined)unaff_R14D;
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"RSA",(char)unaff_EBP,(undefined)param_5);
}
LAB_1800168d1:
return (char)unaff_ESI;
}
LAB_18001693f:
do {
do {
do {
do {
unaff_RDI = unaff_RDI + 0xc;
piVar3 = (int *)((ulonglong)unaff_RBX[5] * 0x30 + *(longlong *)(unaff_RBX + 6));
while (piVar3 <= unaff_RDI) {
do {
while( true ) {
do {
puVar4 = unaff_RBX;
unaff_RBX = puVar4 + 10;
if (unaff_R15 <= unaff_RBX) {
unaff_ESI = 0;
goto LAB_1800168d1;
}
} while (puVar4[0xf] == 0);
if (*unaff_RBX == 0) break;
if (in_stack_00000070 != 0) {
uVar6 = 0;
do {
iVar2 = RtlCompareUnicodeString
(uVar6 * 0x10 + *(longlong *)(puVar4 + 0xc),in_stack_00000070,
(byte)unaff_ESI);
if (iVar2 == 0) goto LAB_180016916;
uVar5 = (int)uVar6 + unaff_ESI;
uVar6 = (ulonglong)uVar5;
} while (uVar5 < *unaff_RBX);
}
}
LAB_180016916:
} while ((in_stack_00000078 != '\0') &&
((*(byte *)(puVar4 + 0x12) & (byte)unaff_ESI) != 0));
unaff_RDI = *(int **)(puVar4 + 0x10);
piVar3 = unaff_RDI + (ulonglong)puVar4[0xf] * 0xc;
}
} while ((*unaff_RDI != unaff_R14D) || (*(short *)(unaff_RDI + 2) != 6));
_Str1 = *(wchar_t **)(unaff_RDI + 4);
uVar1 = 0xa0;
uVar7 = 3;
iVar2 = wcsncmp(_Str1,L"RSA",3);
} while (iVar2 != 0);
if (((unaff_RDI[6] == 0) && (unaff_RDI[10] == 0)) && (unaff_RDI[0xb] == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar1 = FUN_18003e91a((longlong)DAT_180091000);
return uVar1;
}
goto LAB_1800168d1;
}
} while (unaff_EBP == 0);
if (unaff_RDI[10] == 0) {
if (unaff_RDI[0xb] == 0) goto LAB_18001693f;
}
else if (unaff_EBP < (uint)unaff_RDI[10]) goto LAB_18003e8ce;
if (unaff_RDI[0xb] != 0) {
uVar1 = FUN_18003e8c5((char)_Str1,uVar1,uVar7,(char)uVar8,param_5);
return uVar1;
}
} while( true );
}
=========================================
Function at address: 0x18003e91a
Called functions addresses: 0x18005a174


void FUN_18003e91a(longlong param_1)

{
undefined1 unaff_R14B;

FUN_18005a174(*(undefined8 *)(param_1 + 0x10),0xc,&DAT_180082b78,L"RSA",unaff_R14B);
return;
}
=========================================
Function at address: 0x18003e9e8
Called functions addresses: None


void FUN_18003e9e8(void)

{
DAT_1800920e8 = 0xfffffffffffffff7;
DAT_1800920f0 = FUN_18007af10;
DAT_1800920f8 = FUN_18007af40;
return;
}
=========================================
Function at address: 0x18003ee5c
Called functions addresses: None


void FUN_18003ee5c(longlong param_1,int param_2)

{
if (((param_2 < 0xd) || (0xe < param_2)) && (*(ushort *)(param_1 + 0x6f8) < 0x32)) {
*(int *)(param_1 + 0x630 + (ulonglong)*(ushort *)(param_1 + 0x6f8) * 4) = param_2;
*(short *)(param_1 + 0x6f8) = *(short *)(param_1 + 0x6f8) + 1;
return;
}
return;
}
=========================================
Function at address: 0x18003f3d9
Called functions addresses: 0x180023334


void FUN_18003f3d9(void)

{
undefined4 in_EAX;
longlong unaff_RBP;
longlong unaff_RDI;
PSRWLOCK unaff_R12;
longlong unaff_R13;

*(undefined4 *)(unaff_RDI + 0x120) = in_EAX;
ReleaseSRWLockShared(unaff_R12);
if (unaff_R13 != 0) {
FUN_180023334(unaff_R13);
}
FUN_180028070(*(ulonglong *)(unaff_RBP + 0x4a0) ^ (ulonglong)&stack0x00000000);
return;
}
=========================================
Function at address: 0x18003faed
Called functions addresses: 0x180041cb0 0x18005b470


undefined8 FUN_18003faed(longlong *param_1,undefined8 param_2,char *param_3)

{
char cVar1;
undefined4 uVar2;
longlong unaff_RBX;
int unaff_EBP;

if (*(char *)(param_1 + 0x45) != '\0') {
if ((unaff_EBP == 1) && (*param_3 == '\x01')) {
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 10;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
*(undefined8 *)(unaff_RBX + 0x90) = *(undefined8 *)(unaff_RBX + 0xa0);
cVar1 = *(char *)(unaff_RBX + 0xe9);
*(undefined8 *)(unaff_RBX + 0xa0) = 0;
if (cVar1 == '\0') {
*(undefined8 *)(unaff_RBX + 0xb0) = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180082c58);
cVar1 = *(char *)(unaff_RBX + 0xe9);
}
if (cVar1 != '\0') {
*(int *)(unaff_RBX + 0xc0) = *(int *)(unaff_RBX + 0xc0) + 1;
*(undefined8 *)(unaff_RBX + 0xd0) = 0;
*(undefined8 *)(unaff_RBX + 200) = 0;
}
uVar2 = 0x3f;
if (*(int *)(unaff_RBX + 0x44) == 0x40) {
uVar2 = 0x41;
}
*(undefined4 *)(unaff_RBX + 0x44) = uVar2;
return 0;
}
FUN_18005b470(param_1,0x388,0x80090326,10);
}
return 0x80090326;
}
=========================================
Function at address: 0x18003fb66
Called functions addresses: None


undefined8 FUN_18003fb66(void)

{
short in_R9W;

if (in_R9W != 0) {
return 0x32;
}
return 0;
}
=========================================
Function at address: 0x180040a26
Called functions addresses: 0x180041d70


undefined4 FUN_180040a26(longlong param_1)

{
wchar_t *unaff_RBX;
undefined4 in_stack_00000040;

FUN_180041d70(*(undefined8 *)(param_1 + 0x10),0xb,&DAT_1800853f8,unaff_RBX);
return in_stack_00000040;
}
=========================================
Function at address: 0x180040ea4
Called functions addresses: 0x180011434 0x180041cdc 0x180041cb0 0x18002a7c0 0x180041d20 0x180041e9c


int FUN_180040ea4(undefined8 param_1,undefined8 param_2,uint param_3)

{
char cVar1;
int iVar2;
ulonglong uVar3;
undefined8 *puVar4;
int unaff_EBX;
uint uVar5;
uint uVar6;
uint local_res18 [2];
undefined4 local_res20 [2];
uint *puVar7;
longlong local_68;
undefined8 local_60;
undefined8 *puStack_58;
uint local_50 [2];
undefined8 *local_48;
undefined local_40 [8];
uint local_38;

local_res20[0] = 0;
local_68 = 0;
local_res18[0] = param_3 & 0xffffff00;
local_60 = 0;
puStack_58 = (undefined8 *)0x0;
if (DAT_180092620 == 0) {
return unaff_EBX;
}

if (cVar1 == '\0') {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return unaff_EBX;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return unaff_EBX;
}
FUN_180041d20(DAT_180091000[2],0x14,&DAT_180084b60,0xc00000e5,0xe5);
return unaff_EBX;
}
uVar6 = local_38 & 0x40;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180084b60);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180084b60);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x17,&DAT_180084b60,param_1);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x18,&DAT_180084b60,param_2);
}
}
}
}
puVar7 = local_res18;

if (iVar2 < 0) {
return unaff_EBX;
}
local_50[1] = 1;
uVar5 = (-(uint)(uVar6 != 0) & 0xfffffff8) + 0x10;
if ((uint)local_60 == 0) {
local_60 = CONCAT44(local_60._4_4_,uVar5);

if (puStack_58 == (undefined8 *)0x0) {
return unaff_EBX;
}
}
puVar4 = puStack_58;
if (local_68 != 0) {
if ((ulonglong)(uint)local_60 < (local_68 + 1) * (ulonglong)uVar5) {
return unaff_EBX;
}
puVar4 = (undefined8 *)((ulonglong)uVar5 * local_68 + (longlong)puStack_58);
}
if (uVar6 == 0) {
*puVar4 = param_1;
}
else {
*(int *)puVar4 = (int)param_1;
}
uVar3 = -(ulonglong)(uVar6 != 0) & 0xfffffffffffffffc;
if (uVar6 == 0) {
*(undefined8 *)((longlong)puVar4 + uVar3 + 8) = param_2;
}
else {
*(int *)((longlong)puVar4 + uVar3 + 8) = (int)param_2;
}
local_68 = local_68 + 1;
local_50[0] = (uint)local_60;
local_48 = puStack_58;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x19,&DAT_180084b60);
}
if (DAT_180092620 == 0) {
iVar2 = -0x7ff6fcfc;
}
else {

(5,local_68,0,local_50,(ulonglong)puVar7 & 0xffffffffffffff00);
if (-1 < iVar2) goto LAB_1800411e5;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180084b60,iVar2);
}
FUN_180011434(0);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1a,&DAT_180084b60,iVar2);
}

LAB_1800411e5:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar2 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x1b,&DAT_180084b60,iVar2,(char)iVar2);
}
return unaff_EBX;
}
=========================================
Function at address: 0x180041244
Called functions addresses: 0x180041cdc 0x18000909c 0x180041cb0 0x180012fc4 0x18002a77b 0x18002a7c0


int FUN_180041244(longlong param_1)

{
byte bVar1;
char cVar2;
int iVar3;
int *piVar4;
uint local_48 [2];
void *local_40;
int local_38 [2];
undefined *puStack_30;
undefined local_28 [8];
byte local_20;

bVar1 = *(byte *)(param_1 + 0x10a);
local_38[0] = 0;
local_38[1] = 0;
puStack_30 = (undefined *)0x0;
if (DAT_180092620 == 0) {
iVar3 = 0x57;
}
else {
local_48[1] = 1;
local_40 = (void *)0x0;
local_48[0] = 0;

if (cVar2 == '\0') {
iVar3 = 0x54f;
}
else {
if ((local_20 & 0x40) != 0) {
local_48[0] = 8;
if (bVar1 == 0) {
local_40 = (void *)(param_1 + 0x80);
}
else {

if (local_40 == (void *)0x0) {
return 0xe;
}
memcpy(local_40,(void *)(param_1 + 0x80),(ulonglong)local_48[0]);
}
}
piVar4 = local_38;
if (bVar1 != 0) {
piVar4 = (int *)0x0;
}
iVar3 = FUN_180012fc4(9,*(undefined8 *)(param_1 + 0x80),-(ulonglong)(bVar1 != 0) & 8,local_48,
piVar4,(uint)(bVar1 == 0),(uint)bVar1,1);
if (iVar3 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2c,&DAT_180084b60,iVar3);
}
if ((bVar1 != 0) && (local_40 != (void *)0x0)) {

}
}
else if (bVar1 == 0) {
if (local_38[0] == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2d,&DAT_180084b60);
}
iVar3 = 0x57;
}
else {
iVar3 = 0;
*(undefined *)(param_1 + 0x1d8) = *puStack_30;
}
}
else {
iVar3 = 0x90312;
}
if (puStack_30 != (undefined *)0x0) {
FUN_18000909c(puStack_30);
}
}
}
return iVar3;
}
=========================================
Function at address: 0x180041460
Called functions addresses: 0xEXTERNAL:000000a3 0x180041cdc 0x180011434 0x180041cb0 0x18002a7c0 0x18002a77b


int FUN_180041460(LPCWSTR param_1,LPCWSTR param_2,undefined8 *param_3,int param_4,int param_5,
int param_6)

{
int *piVar1;
undefined8 uVar2;
int iVar3;
void *_Dst;
int unaff_EBX;
uint uVar4;
uint uVar5;
uint uVar6;
undefined4 local_68 [2];
size_t local_60;
longlong local_58;
ulonglong local_50;
void *pvStack_48;

uVar5 = 0;
local_68[0] = 0;
local_60 = 0;
local_58 = 0;
uVar6 = 0;
local_50 = 0;
pvStack_48 = (void *)0x0;
if ((DAT_180092620 != 0) &&

(local_68,&local_58,&local_60,&local_50,0), -1 < iVar3)) {
if (param_1 != (LPCWSTR)0x0) {
iVar3 = lstrlenW(param_1);
uVar5 = iVar3 * 2 + 2;
}
if (param_2 != (LPCWSTR)0x0) {
iVar3 = lstrlenW(param_2);
uVar6 = iVar3 * 2 + 2;
}
uVar4 = uVar5 + 0x2c + uVar6;
if (pvStack_48 == (void *)0x0) {
local_50 = CONCAT44(local_50._4_4_,uVar4 * 4 + 8);

if (pvStack_48 == (void *)0x0) {
return unaff_EBX;
}
local_60 = local_60 + 8;
}
else if ((local_50 & 0xffffffff) < uVar4 + local_60) {

if (_Dst == (void *)0x0) {
return unaff_EBX;
}
memcpy(_Dst,pvStack_48,local_60);

local_50 = CONCAT44(local_50._4_4_,(int)local_50 + uVar4 * 4);
pvStack_48 = _Dst;
}
piVar1 = (int *)((longlong)pvStack_48 + local_60);
*piVar1 = uVar4 - 4;
uVar2 = param_3[1];
*(undefined8 *)(piVar1 + 1) = *param_3;
*(undefined8 *)(piVar1 + 3) = uVar2;
piVar1[5] = *(int *)(param_3 + 2);
piVar1[6] = param_5;
piVar1[7] = param_6;
piVar1[8] = param_4;
piVar1[9] = uVar5;
piVar1[10] = uVar6;
memcpy(piVar1 + 0xb,param_1,(ulonglong)uVar5);
memcpy((void *)((ulonglong)uVar5 + (longlong)(piVar1 + 0xb)),param_2,(ulonglong)uVar6);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x12,&DAT_180084b60);
}
local_58 = local_58 + 1;
local_60 = uVar4 + local_60;
if (DAT_180092620 == 0) {
iVar3 = -0x7ff6fcfc;
}
else {

if (-1 < iVar3) {
return unaff_EBX;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180084b60,iVar3);
}
FUN_180011434(0);
}
if (pvStack_48 != (void *)0x0) {

}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x13,&DAT_180084b60,iVar3);
}
}
return unaff_EBX;
}
=========================================
Function at address: 0x180041794
Called functions addresses: 0x18000a1f4 0x180041cdc 0x18000909c 0x180012fc4 0x18002a7c0


int FUN_180041794(longlong param_1)

{
byte bVar1;
char cVar2;
int iVar3;
undefined8 *puVar4;
int *piVar5;
uint local_48 [2];
undefined8 *local_40;
int local_38 [4];
undefined local_28 [8];
byte local_20;

bVar1 = *(byte *)(param_1 + 0x10a);
if (DAT_180092620 == 0) {
iVar3 = 0x57;
}
else {
local_48[0] = 4;

if (cVar2 == '\0') {
iVar3 = 0x54f;
}
else {
if ((local_20 & 0x40) != 0) {
local_48[0] = local_48[0] + 8;
}
local_48[1] = 1;
if (bVar1 == 0) {
local_40 = (undefined8 *)FUN_18000a1f4((ulonglong)local_48[0]);
}
else {

}
if (local_40 == (undefined8 *)0x0) {
iVar3 = 0xe;
}
else {
puVar4 = local_40;
if ((local_20 & 0x40) != 0) {
*local_40 = *(undefined8 *)(param_1 + 0x80);
puVar4 = local_40 + 1;
}
*(undefined2 *)puVar4 = *(undefined2 *)(param_1 + 0xd8);
*(undefined2 *)((longlong)puVar4 + 2) = *(undefined2 *)(param_1 + 0xda);
piVar5 = local_38;
if (bVar1 != 0) {
piVar5 = (int *)0x0;
}
local_38[1] = 1;
local_38[0] = 0;
local_38[2] = 0;
local_38[3] = 0;
iVar3 = FUN_180012fc4(8,*(undefined8 *)(param_1 + 0x80),(ulonglong)(-(uint)(bVar1 != 0) & 8)
,local_48,piVar5,0,(uint)bVar1,0);
if (((iVar3 < 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2b,&DAT_180084b60,iVar3);
}
if (local_40 != (undefined8 *)0x0) {
if (bVar1 == 0) {
FUN_18000909c(local_40);
}
else if (iVar3 < 0) {

}
}
}
}
}
return iVar3;
}
=========================================
Function at address: 0x180041960
Called functions addresses: 0xEXTERNAL:000000a3 0x180011434 0x180041cdc 0x180041cb0 0x18002a7c0 0x18002a77b 0x180041d70 0x180041e9c


int FUN_180041960(longlong param_1,undefined8 param_2,longlong param_3,undefined4 param_4,
undefined4 param_5,undefined4 param_6,LPCWSTR param_7,LPCWSTR param_8,void *param_9
,uint param_10)

{
int iVar1;
size_t _Size;
undefined4 *_Dst;
void *_Dst_00;
uint uVar2;
bool bVar3;
int local_38 [2];
undefined4 *local_30;

_Size = 0;
uVar2 = 0;
if (DAT_180092620 == 0) {
iVar1 = 0x57;
}
else {
if (param_7 != (LPCWSTR)0x0) {
iVar1 = lstrlenW(param_7);
_Size = (size_t)(iVar1 * 2 + 2);
}
if (param_8 != (LPCWSTR)0x0) {
iVar1 = lstrlenW(param_8);
uVar2 = iVar1 * 2 + 2;
}
local_38[1] = 1;
local_38[0] = param_10 + 0x24 + uVar2 + (int)_Size;

if (local_30 == (undefined4 *)0x0) {
iVar1 = 0xe;
}
else {
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0xc,&DAT_180084b60,param_1);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0xd,&DAT_180084b60,param_3);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0xe,&DAT_180084b60,param_4);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0xf,&DAT_180084b60,param_7);
}
}
}
}
if (((param_8 != (LPCWSTR)0x0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x10,&DAT_180084b60,param_8);
}
local_30[5] = 0;
*local_30 = param_5;
local_30[1] = param_6;
*(undefined8 *)(local_30 + 3) = param_2;
local_30[2] = param_4;
local_30[6] = (int)_Size;
local_30[7] = uVar2;
local_30[8] = param_10;
_Dst = local_30 + 9;
memcpy(_Dst,param_7,_Size);
_Dst_00 = (void *)((longlong)_Dst + _Size);
if (uVar2 != 0) {
memcpy(_Dst_00,param_8,(ulonglong)uVar2);
_Dst_00 = (void *)((longlong)_Dst_00 + (ulonglong)uVar2);
}
memcpy(_Dst_00,param_9,(ulonglong)param_10);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x11,&DAT_180084b60);
}
if (DAT_180092620 == 0) {
iVar1 = -0x7ff6fcfc;
}
else {
bVar3 = param_3 != 0;
if (param_3 == 0) {
param_3 = param_1;
}

if (iVar1 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180084b60,iVar1);
}
FUN_180011434(0);
}
if (iVar1 == 0) {
return 0x90312;
}
}
if (local_30 != (undefined4 *)0x0) {

}
}
}
return iVar1;
}
=========================================
Function at address: 0x180041cb0
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180041cb0(undefined8 param_1,undefined2 param_2,undefined8 param_3)

{
EtwTraceMessage(param_1,0x2b,param_3,param_2,0);
return;
}
=========================================
Function at address: 0x180041cdc
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180041cdc(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,0);
return;
}
=========================================
Function at address: 0x180041d20
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180041d20(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,0);
return;
}
=========================================
Function at address: 0x180041d70
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180041d70(undefined8 param_1,undefined2 param_2,undefined8 param_3,wchar_t *param_4)

{
longlong lVar1;

if (param_4 == (wchar_t *)0x0) {
lVar1 = 10;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (param_4[lVar1] != L'\0');
lVar1 = lVar1 * 2 + 2;
}
if (param_4 == (wchar_t *)0x0) {
param_4 = L"NULL";
}
EtwTraceMessage(param_1,0x2b,param_3,param_2,param_4,lVar1,0);
return;
}
=========================================
Function at address: 0x180041dd8
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180041dd8(undefined8 param_1,undefined2 param_2,undefined8 param_3,wchar_t *param_4,
undefined param_5)

{
longlong lVar1;

if (param_4 == (wchar_t *)0x0) {
lVar1 = 10;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (param_4[lVar1] != L'\0');
lVar1 = lVar1 * 2 + 2;
}
if (param_4 == (wchar_t *)0x0) {
param_4 = L"NULL";
}
EtwTraceMessage(param_1,0x2b,param_3,param_2,param_4,lVar1,&param_5,4,0);
return;
}
=========================================
Function at address: 0x180041e58
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180041e58(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 local_res20;

local_res20 = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,0);
return;
}
=========================================
Function at address: 0x180041e9c
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180041e9c(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 local_res20;

local_res20 = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,0);
return;
}
=========================================
Function at address: 0x180041ee0
Called functions addresses: 0xEXTERNAL:000000c9 0xEXTERNAL:0000003f 0x18002a7c0 0xEXTERNAL:00000040


int FUN_180041ee0(longlong param_1,int param_2,char param_3,short *param_4)

{
int iVar1;
undefined2 *puVar2;
int iVar3;
uint uVar4;
short sVar5;
short local_38;
short local_36;
HLOCAL local_30;
short sVar6;

iVar3 = 0;
param_4[0] = 0;
param_4[1] = 0;
param_4[4] = 0;
param_4[5] = 0;
param_4[6] = 0;
param_4[7] = 0;
local_30 = (HLOCAL)0x0;
if (param_1 == 0) {
return 0;
}
if (param_2 == 0) {
puVar2 = (undefined2 *)LocalAlloc(0x40,2);
*(undefined2 **)(param_4 + 4) = puVar2;
if (puVar2 != (undefined2 *)0x0) {
param_4[1] = 2;
*puVar2 = 0;
goto LAB_180042023;
}
}
else {
iVar3 = (param_3 != '\0') + 1;
uVar4 = (param_2 + 1) * iVar3;
if ((0xffff < uVar4) || (0xffff < uVar4 - iVar3)) {
iVar3 = -0x3ffffff3;
goto LAB_180042023;
}
local_30 = LocalAlloc(0x40,(ulonglong)uVar4);
if (local_30 == (HLOCAL)0x0) {
return -0x3fffffe9;
}
sVar6 = (short)uVar4;
sVar5 = sVar6 - (short)iVar3;
local_38 = sVar5;
local_36 = sVar6;

if (iVar3 < 0) goto LAB_180042023;
if (param_3 != '\0') {
*(HLOCAL *)(param_4 + 4) = local_30;
*param_4 = sVar5;
param_4[1] = sVar6;
goto LAB_180042023;
}
iVar1 = RtlAnsiStringToUnicodeString(param_4,&local_38,1);
if (-1 < iVar1) goto LAB_180042023;
}
iVar3 = -0x3fffffe9;
LAB_180042023:
if ((local_30 != (HLOCAL)0x0) && ((param_3 == '\0' || (iVar3 < 0)))) {
LocalFree(local_30);
}
return iVar3;
}
=========================================
Function at address: 0x18004206c
Called functions addresses: 0x18000a1f4 0xEXTERNAL:00000023 0x180041cb0 0x180042d24 0x180041d20


uint * FUN_18004206c(uint param_1,longlong param_2,int param_3,longlong param_4,longlong param_5)

{
int iVar1;
uint *puVar2;
longlong lVar3;
PCCERT_CONTEXT pCVar4;
uint uVar5;
uint *puVar6;
uint uVar7;
uint *puVar8;
uint *puVar9;
uint *puVar10;
uint *puVar11;
wchar_t *local_48;
undefined8 local_40;

puVar2 = (uint *)0x0;
if (param_1 < 0x4924925) {
lVar3 = FUN_18000a1f4((ulonglong)(param_1 * 0x38));
*(longlong *)(param_5 + 8) = lVar3;
if (lVar3 == 0) {
puVar2 = (uint *)0xe;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x2d,&DAT_180084ce0,0xe,0xe);
}
}
else if (param_1 != 0) {
puVar10 = (uint *)(param_2 + 4);
puVar6 = puVar2;
puVar9 = puVar2;
puVar11 = puVar10;
do {
lVar3 = *(longlong *)(param_5 + 8);
local_48 = (wchar_t *)0x0;
uVar7 = 0;
local_40 = 0;
if (param_3 == 2) {
local_40 = *(undefined8 *)(puVar11 + 1);
uVar7 = *puVar11;
local_48 = (wchar_t *)(puVar11 + 8);
puVar8 = puVar11;
LAB_180042162:
uVar7 = uVar7 & 1;
puVar8 = puVar8 + 3;
uVar5 = 0x14;
}
else {
puVar8 = puVar2;
uVar5 = uVar7;
if (param_3 == 1) {
local_40 = *(undefined8 *)(puVar10 + 1);
uVar7 = *puVar10;
local_48 = L"MY";
puVar8 = puVar10;
goto LAB_180042162;
}
}
pCVar4 = FUN_180042d24(puVar8,uVar5,uVar7,local_48,param_4);
*(PCCERT_CONTEXT *)((longlong)puVar6 + lVar3) = pCVar4;
if (pCVar4 == (PCCERT_CONTEXT)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2e,&DAT_180084ce0);
}
return (uint *)0x8009030e;
}
if ((uVar7 != 0) && (iVar1 = _o__wcsicmp(local_48,&DAT_18008275c), iVar1 == 0)) {
puVar8 = (uint *)((longlong)puVar6 + lVar3 + 0x30);
*puVar8 = *puVar8 | 1;
}
uVar7 = (int)puVar9 + 1;
puVar9 = (uint *)(ulonglong)uVar7;
puVar11 = puVar11 + 0x4a;
*(undefined8 *)((longlong)puVar6 + lVar3 + 0x10) = local_40;
puVar10 = puVar10 + 10;
puVar6 = puVar6 + 0xe;
} while (uVar7 < param_1);
}
}
else {
puVar2 = (uint *)0x8009035d;
}
return puVar2;
}
=========================================
Function at address: 0x180042244
Called functions addresses: 0xEXTERNAL:00000041 0xEXTERNAL:00000126 0x180028070 0x18005512c 0x180041d20 0x180041cdc 0x18004312c 0xEXTERNAL:0000013e 0x180001604 0x180041cb0 0xEXTERNAL:00000047 0xEXTERNAL:00000150 0x180054298


void FUN_180042244(ushort *param_1,longlong param_2,longlong param_3,undefined8 param_4)

{
DWORD DVar1;
longlong lVar2;
undefined8 uVar3;
longlong lVar4;
ulonglong uVar5;
longlong lVar6;
undefined2 uVar7;
longlong lVar8;
undefined8 *puVar9;
longlong lVar10;
longlong lVar11;
undefined auStackY_98 [32];
int local_68 [2];
undefined8 local_60;
undefined8 uStack_58;
longlong local_50;
undefined8 local_48 [2];
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_98;
lVar8 = 0;
lVar10 = 0;
local_68[0] = 0;
local_60 = 0;
uStack_58 = 0;
local_50 = param_3;
if (*param_1 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x25,&DAT_180084ce0);
}
goto LAB_18004261c;
}
if ((DAT_180092f68 == 0) && (DVar1 = FUN_18005512c(), DVar1 != 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x26,&DAT_180084ce0,DVar1);
}
goto LAB_18004261c;
}
DVar1 = FUN_180001604(param_2,local_68);
lVar11 = lVar10;
if (DVar1 == 0) {
local_60 = CONCAT44(local_60._4_4_,(uint)*param_1);
uStack_58 = *(undefined8 *)(param_1 + 4);
if ((DAT_180092f00 & 1) != 0) {
param_4 = 1;
FUN_18004312c(param_2,&DAT_180084c50,param_3,1,local_48);
}
puVar9 = &local_60;
lVar4 = DAT_180092f68;
lVar2 = CryptObjectLocatorGet(DAT_180092f68,1);
if ((DAT_180092f00 & 1) != 0) {
param_4 = 1;
FUN_18004312c(lVar4,&DAT_180084c40,puVar9,1,local_48);
}
lVar4 = lVar2;
if (lVar2 == 0) {
DVar1 = GetLastError();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar7 = 0x28;
goto LAB_180042589;
}
}
else {
DVar1 = FUN_180054298(lVar2,local_50,puVar9,param_4);
if (DVar1 == 0) {
lVar4 = 0;
lVar2 = 0;
lVar11 = lVar8;
if (DAT_180092f60 != 0) {
local_60 = CONCAT44(local_60._4_4_,(uint)*param_1);
uStack_58 = *(undefined8 *)(param_1 + 4);
if ((DAT_180092f00 & 1) != 0) {
FUN_18004312c(DAT_180092f60,&DAT_180084c50,puVar9,1,local_48);
}
puVar9 = &local_60;
lVar10 = CryptObjectLocatorGet(DAT_180092f60,1);
uVar5 = (ulonglong)DAT_180092f00;
if ((DAT_180092f00 & 1) != 0) {
FUN_18004312c(uVar5,&DAT_180084c40,puVar9,1,local_48);
uVar5 = (ulonglong)DAT_180092f00;
}
lVar11 = lVar10;
if (lVar10 == 0) {
DVar1 = GetLastError();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2a,&DAT_180084ce0,DVar1);
}
DVar1 = 0;
lVar4 = lVar2;
}
else {
if ((uVar5 & 1) != 0) {
FUN_18004312c(uVar5,&DAT_180084c30,puVar9,1,local_48);
}
lVar6 = lVar10;
uVar3 = CryptObjectLocatorGetContent();
lVar8 = local_50;
*(undefined8 *)(local_50 + 0x30) = uVar3;
if ((DAT_180092f00 & 1) != 0) {
FUN_18004312c(lVar6,&DAT_180084c20,puVar9,1,local_48);
}
if (((*(longlong *)(lVar8 + 0x30) == 0) &&
(DVar1 = GetLastError(), lVar4 = lVar2,
(undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar7 = 0x2b;
goto LAB_180042589;
}
}
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar7 = 0x29;
goto LAB_180042589;
}
}
}
else {
lVar4 = lVar8;
lVar11 = lVar8;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(lVar4 = 0, lVar11 = lVar10, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar7 = 0x27;
lVar2 = lVar8;
lVar10 = lVar8;
LAB_180042589:
FUN_180041cdc(DAT_180091000[2],uVar7,&DAT_180084ce0,DVar1);
lVar4 = lVar2;
lVar11 = lVar10;
}
}
if (local_68[0] != 0) {
RevertToSelf();
}
if (lVar4 != 0) {
CryptObjectLocatorFree(lVar4);
}
if (lVar11 != 0) {
CryptObjectLocatorFree(lVar11);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041d20(DAT_180091000[2],0x2c,&DAT_180084ce0,DVar1,(char)DVar1);
}
LAB_18004261c:
FUN_180028070(local_38 ^ (ulonglong)auStackY_98);
return;
}
=========================================
Function at address: 0x180042648
Called functions addresses: 0x18000a1f4 0x18004206c 0x180041cb0 0x18002a77b 0x180028d90 0x180041d20 0x180010cf8 0x180042244


int FUN_180042648(int *param_1,ushort *param_2,longlong param_3,undefined4 *param_4)

{
uint uVar1;
int iVar2;
int iVar3;
uint *puVar4;
void *_Dst;
int unaff_EBX;
ulonglong uVar5;
undefined4 *puVar6;

puVar6 = param_4;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2f,&DAT_180084ce0);
}
memset(param_4,0,0x70);
if (param_1 == (int *)0x0) {
return unaff_EBX;
}
if (*param_1 != 4) {
return unaff_EBX;
}
*param_4 = 4;
if ((param_2 == (ushort *)0x0) || (*(longlong *)(param_2 + 4) == 0)) {
if (param_1[1] != 0) {
puVar4 = FUN_18004206c(param_1[1],*(longlong *)(param_1 + 2),param_1[0x13],param_3,
(longlong)param_4);
iVar3 = (int)puVar4;
if (iVar3 != 0) goto LAB_1800427cc;
param_4[1] = param_1[1];
}
LAB_180042713:
uVar1 = param_1[10];
if (uVar1 == 0) {
LAB_180042758:
iVar3 = 0;
if (param_1[0xe] != -1) {
iVar3 = param_1[0xe];
}
param_4[0x12] = iVar3;
param_4[0x13] = param_1[0xf];
param_4[0x14] = param_1[0x10];
param_4[0x15] = param_1[0x11];
param_4[0x16] = param_1[0x12];
iVar2 = param_1[0x13];
param_4[0x12] = param_4[0x12] & 0x3fffffff;
iVar3 = 0;
param_4[0x17] = iVar2;
goto LAB_18004278b;
}
param_4[0xe] = uVar1;
uVar5 = (ulonglong)uVar1 << 2;
if (uVar5 < 0x100000000) {
_Dst = (void *)FUN_18000a1f4(uVar5 & 0xffffffff);
*(void **)(param_4 + 0x10) = _Dst;
if (_Dst != (void *)0x0) {
memcpy(_Dst,*(void **)(param_1 + 0xc),uVar5 & 0xffffffff);
goto LAB_180042758;
}
iVar3 = 0xe;
}
else {
iVar3 = 0x216;
}
}
else {
iVar3 = FUN_180042244(param_2,param_3,(longlong)param_4,puVar6);
if (iVar3 == 0) goto LAB_180042713;
}
LAB_1800427cc:
FUN_180010cf8((undefined *)param_4,'\x01');
LAB_18004278b:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar3 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x30,&DAT_180084ce0,iVar3,(char)iVar3);
}
return unaff_EBX;
}
=========================================
Function at address: 0x180042800
Called functions addresses: 0x18004206c 0x180009ae4 0x180041d20 0x180042244 0x180010cf8


int FUN_180042800(longlong param_1,ushort *param_2,longlong param_3,undefined4 *param_4)

{
int iVar1;
int iVar2;
uint *puVar3;

*param_4 = 5;
if ((param_2 == (ushort *)0x0) || (*(longlong *)(param_2 + 4) == 0)) {
if (*(uint *)(param_1 + 8) != 0) {
puVar3 = FUN_18004206c(*(uint *)(param_1 + 8),*(longlong *)(param_1 + 0x10),
*(int *)(param_1 + 4),param_3,(longlong)param_4);
iVar1 = (int)puVar3;
if (iVar1 != 0) goto LAB_1800428a0;
param_4[1] = *(undefined4 *)(param_1 + 8);
}
LAB_180042868:
iVar2 = FUN_180009ae4(*(longlong *)(param_1 + 0x40),*(uint *)(param_1 + 0x38),0,'\0',
(longlong *)(param_4 + 0x1a),param_4 + 0x18);
if (iVar2 == 0) {
iVar1 = 0;
param_4[0x15] = *(undefined4 *)(param_1 + 0x30);
param_4[0x16] = *(undefined4 *)(param_1 + 0x34);
param_4[0x17] = *(undefined4 *)(param_1 + 4);
goto LAB_1800428c0;
}
iVar1 = 0xe;
if (iVar2 == -0x7ff6fca3) {
iVar1 = 0x57;
}
}
else {
iVar1 = FUN_180042244(param_2,param_3,(longlong)param_4,param_3);
if (iVar1 == 0) goto LAB_180042868;
}
LAB_1800428a0:
FUN_180010cf8((undefined *)param_4,'\x01');
LAB_1800428c0:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar1 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x31,&DAT_180084ce0,iVar1,(char)iVar1);
}
return iVar1;
}
=========================================
Function at address: 0x180042918
Called functions addresses: 0x18000a1f4 0x1800432a8 0xEXTERNAL:00000041 0xEXTERNAL:0000015a 0xEXTERNAL:00000129 0x18002a7c0 0x180028070 0xEXTERNAL:00000040 0xEXTERNAL:00000159 0x180041ee0 0x18000909c 0x180001604 0x180041cb0 0xEXTERNAL:00000128 0xEXTERNAL:00000047 0xEXTERNAL:000000c8 0xEXTERNAL:0000015b 0xEXTERNAL:0000012e


void FUN_180042918(undefined8 param_1,longlong param_2,longlong param_3)

{
byte bVar1;
char cVar2;
int iVar3;
undefined4 *puVar4;
HCERTSTORE hCertStore;
PCCERT_CONTEXT pCVar5;
undefined8 *puVar6;
ulonglong uVar7;
undefined2 uVar8;
uint uVar9;
undefined *puVar10;
HCERTSTORE pvVar11;
undefined auStackY_f8 [32];
int local_c8;
int local_c4;
longlong local_c0;
ushort local_b8 [4];
undefined *local_b0;
short local_a8 [4];
HLOCAL local_a0;
undefined4 local_98 [2];
longlong local_90;
undefined local_88 [8];
uint local_80;
undefined8 local_70;
undefined8 uStack_68;
undefined8 local_60;
undefined8 uStack_58;
ulonglong local_50;
undefined4 local_48;
ulonglong local_40;
HCERTSTORE hCertStore_00;

local_40 = DAT_180091970 ^ (ulonglong)auStackY_f8;
local_c0 = 0;
local_c8 = 0;
local_50 = 0;
local_48 = 0;
hCertStore_00 = (HCERTSTORE)0x0;
pvVar11 = (HCERTSTORE)0x0;
local_70 = 0;
uStack_68 = 0;
local_60 = 0;
uStack_58 = 0;

if (cVar2 == '\0') goto LAB_180042cf3;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x22,&DAT_180084ce0);
}
RtlInitUnicodeString(local_a8,0);
RtlInitUnicodeString(local_b8,0);
puVar4 = (undefined4 *)FUN_18000a1f4(0x48);
if (puVar4 != (undefined4 *)0x0) {
if ((local_80 & 0x40) == 0) {

hCertStore = pvVar11;
if (iVar3 == 0) goto LAB_180042ab8;
}
else {

hCertStore = hCertStore_00;
if (iVar3 == 0) {
*puVar4 = (undefined4)local_70;
uVar9 = 0x48;
if (0x47 < local_70._4_4_) {
uVar9 = local_70._4_4_;
}
puVar4[1] = uVar9;
puVar4[4] = uStack_68._4_4_;
*(ulonglong *)(puVar4 + 2) = uStack_68 & 0xffffffff;
puVar4[8] = local_60._4_4_;
*(ulonglong *)(puVar4 + 6) = local_60 & 0xffffffff;
puVar4[0xc] = uStack_58._4_4_;
*(ulonglong *)(puVar4 + 10) = uStack_58 & 0xffffffff;
puVar4[0xd] = (undefined4)local_50;
puVar4[0x10] = local_48;
*(ulonglong *)(puVar4 + 0xe) = local_50 >> 0x20;
LAB_180042ab8:
bVar1 = *(byte *)(puVar4 + 0xd);
if ((*(longlong *)(puVar4 + 2) == 0) ||
(iVar3 = FUN_180041ee0(*(longlong *)(puVar4 + 2),puVar4[4],~bVar1 & 1,local_a8),
iVar3 == 0)) {
if ((*(longlong *)(puVar4 + 10) == 0) ||
(iVar3 = FUN_180041ee0(*(longlong *)(puVar4 + 10),puVar4[0xc],~bVar1 & 1,
(short *)local_b8), iVar3 == 0)) {
iVar3 = CredIsMarshaledCredentialW(local_a0);
hCertStore = pvVar11;
if ((((iVar3 != 0) &&
(iVar3 = CredUnmarshalCredentialW(local_a0,&local_c4,&local_c0), iVar3 != 0)) &&
(local_c4 == 1)) && (iVar3 = FUN_180001604(param_3,&local_c8), iVar3 == 0)) {
hCertStore = CertOpenStore((LPCSTR)0xa,1,0,0x10004,&DAT_18008275c);
if (hCertStore != (HCERTSTORE)0x0) {
local_90 = local_c0 + 4;
local_98[0] = 0x14;
pCVar5 = CertFindCertificateInStore
(hCertStore,1,0,0x10000,local_98,(PCCERT_CONTEXT)0x0);
if (pCVar5 != (PCCERT_CONTEXT)0x0) {
puVar6 = (undefined8 *)FUN_18000a1f4(0x38);
*(undefined8 **)(param_2 + 8) = puVar6;
if (puVar6 != (undefined8 *)0x0) {
*puVar6 = pCVar5;
*(undefined **)(*(longlong *)(param_2 + 8) + 8) = local_b0;
local_b0 = (undefined *)0x0;
*(undefined4 *)(param_2 + 4) = 1;
}
goto LAB_180042c76;
}
}
GetLastError();
}
}
else {
hCertStore = pvVar11;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar8 = 0x24;
goto LAB_180042b0c;
}
}
}
else {
hCertStore = hCertStore_00;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar8 = 0x23;
LAB_180042b0c:
FUN_1800432a8(DAT_180091000[2],uVar8,&DAT_180084ce0,iVar3);
hCertStore = pvVar11;
}
}
}
}
LAB_180042c76:
FUN_18000909c(puVar4);
hCertStore_00 = hCertStore;
}
if (local_a0 != (HLOCAL)0x0) {
LocalFree(local_a0);
}
if (local_b0 != (undefined *)0x0) {
puVar10 = local_b0;
for (uVar7 = (ulonglong)local_b8[0]; uVar7 != 0; uVar7 = uVar7 - 1) {
*puVar10 = 0;
puVar10 = puVar10 + 1;
}
LocalFree(local_b0);
}
if (local_c0 != 0) {
CredFree();
}
if (hCertStore_00 != (HCERTSTORE)0x0) {
CertCloseStore(hCertStore_00,0);
}
if (local_c8 != 0) {
RevertToSelf();
}
LAB_180042cf3:
FUN_180028070(local_40 ^ (ulonglong)auStackY_f8);
return;
}
=========================================
Function at address: 0x180042d24
Called functions addresses: 0xEXTERNAL:00000041 0xEXTERNAL:0000012b 0xEXTERNAL:00000129 0x180041d70 0x180041e9c 0x180041cdc 0x180043330 0x180001604 0x180041cb0 0x180053810 0xEXTERNAL:00000128 0xEXTERNAL:00000047 0x180043384 0xEXTERNAL:0000012e


PCCERT_CONTEXT
FUN_180042d24(undefined8 param_1,undefined4 param_2,int param_3,wchar_t *param_4,longlong param_5)

{
DWORD DVar1;
int iVar2;
HCERTSTORE hCertStore;
PCCERT_CONTEXT pCertContext;
char *pcVar3;
int local_res18 [4];
PCCERT_CONTEXT local_48;
undefined4 local_40 [2];
undefined8 local_38;

local_res18[0] = 0;
pCertContext = (PCCERT_CONTEXT)0x0;
local_48 = (PCCERT_CONTEXT)0x0;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0) {
FUN_180041cb0(DAT_180091000[2],0x18,&DAT_180084ce0);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180043330(DAT_180091000[2],0x19,&DAT_180084ce0,param_1,(char)param_2);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pcVar3 = "LOCAL_MACHINE";
if (param_3 == 0) {
pcVar3 = "CURRENT_USER";
}
FUN_180043384(DAT_180091000[2],0x1a,&DAT_180084ce0,pcVar3);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x1b,&DAT_180084ce0,param_4);
}
}
}
}
if (param_3 == 0) {
DVar1 = 0x20010200;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1c,&DAT_180084ce0);
}
iVar2 = FUN_180001604(param_5,local_res18);
if (iVar2 != 0) goto LAB_180042fc9;
}
else {
DVar1 = 0x20020200;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180084ce0);
}
hCertStore = CertOpenStore((LPCSTR)0xa,1,0,DVar1,param_4);
if (hCertStore == (HCERTSTORE)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar1 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x1e,&DAT_180084ce0,DVar1);
}
}
else {
local_40[0] = param_2;
local_38 = param_1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180084ce0);
}
pCertContext = CertFindCertificateInStore(hCertStore,1,0,0x10000,local_40,(PCCERT_CONTEXT)0x0);
if (pCertContext == (PCCERT_CONTEXT)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar1 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x20,&DAT_180084ce0,DVar1);
}
}
else {
iVar2 = FUN_180053810(hCertStore,pCertContext,'\0',&local_48);
if (iVar2 != 0) {
CertFreeCertificateContext(pCertContext);
pCertContext = local_48;
}
}
CertCloseStore(hCertStore,0);
}
LAB_180042fc9:
if (local_res18[0] != 0) {
RevertToSelf();
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x21,&DAT_180084ce0,pCertContext);
}
return pCertContext;
}
=========================================
Function at address: 0x180043028
Called functions addresses: 0x180011434 0x180055d18


undefined8 FUN_180043028(longlong param_1,uint *param_2,char param_3)

{
undefined8 uVar1;
ulonglong uVar2;
ulonglong uVar3;
undefined8 uVar4;
uint uVar5;
longlong *plVar6;
int iVar7;
longlong local_res10;

local_res10 = 0;
iVar7 = 0;
uVar4 = 0;
if ((param_2 == (uint *)0x0) || (param_1 == 0)) {
uVar4 = 0x80090304;
}
else {
uVar5 = *param_2;
plVar6 = *(longlong **)(param_2 + 2);
while (uVar5 != 0) {
if (uVar5 < 0x14) {
LAB_180043102:
uVar4 = 0x80090304;
goto LAB_1800430e9;
}
uVar1 = FUN_180055d18(param_1,plVar6,0x14,&local_res10);
if ((int)uVar1 != 0) goto LAB_180043102;
if (local_res10 == 0) goto LAB_180043102;
if (param_3 == '\0') {
if (0xf < uVar5 - 0x14) {
uVar2 = *(ulonglong *)((longlong)plVar6 + 0x14);
uVar3 = *(ulonglong *)((longlong)plVar6 + 0x1c);
plVar6 = (longlong *)((longlong)plVar6 + 0x24);
uVar5 = uVar5 - 0x24;
goto LAB_1800430c9;
}
goto LAB_180043102;
}
if (uVar5 - 0x14 < 8) goto LAB_180043102;
uVar2 = (ulonglong)*(uint *)((longlong)plVar6 + 0x14);
uVar3 = (ulonglong)*(uint *)(plVar6 + 3);
plVar6 = (longlong *)((longlong)plVar6 + 0x1c);
uVar5 = uVar5 - 0x1c;
LAB_1800430c9:
if ((uVar2 == 0) && (uVar3 == 0)) goto LAB_180043102;
*(ulonglong *)(local_res10 + 0x68) = uVar2;
iVar7 = iVar7 + 1;
*(ulonglong *)(local_res10 + 0x70) = uVar3;
}
*(int *)(param_1 + 0x2e0) = iVar7;
LAB_1800430e9:
param_2[2] = 0;
param_2[3] = 0;
*param_2 = 0;
param_2[1] = 0;
FUN_180011434(0);
}
return uVar4;
}
=========================================
Function at address: 0x18004312c
Called functions addresses: 0xEXTERNAL:000000ca


void FUN_18004312c(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
undefined8 *param_5)

{
ushort *puVar1;
uint uVar2;
uint uVar3;

puVar1 = DAT_180091388;
uVar3 = 0;
if (DAT_180091388 == (ushort *)0x0) {
*param_5 = 0;
uVar2 = uVar3;
}
else {
*param_5 = DAT_180091388;
uVar2 = 2;
uVar3 = (uint)*puVar1;
}
*(uint *)(param_5 + 1) = uVar3;
*(uint *)((longlong)param_5 + 0xc) = uVar2;
EtwEventWriteTransfer(DAT_180091380,param_2,0,0,param_4,param_5);
return;
}
=========================================
Function at address: 0x180043190
Called functions addresses: 0x18004312c 0x180028070


void FUN_180043190(undefined8 param_1,undefined8 param_2,undefined8 param_3)

{
undefined4 local_res18 [4];
undefined auStackY_68 [32];
undefined8 local_38 [2];
undefined4 *local_28;
undefined4 local_20;
undefined4 local_1c;
ulonglong local_18;

local_res18[0] = (undefined4)param_3;
local_18 = DAT_180091970 ^ (ulonglong)auStackY_68;
local_28 = local_res18;
local_1c = 0;
local_20 = 4;
FUN_18004312c(param_1,&DAT_180084cc0,param_3,2,local_38);
FUN_180028070(local_18 ^ (ulonglong)auStackY_68);
return;
}
=========================================
Function at address: 0x1800431f4
Called functions addresses: 0x18004312c 0x180028070


void FUN_1800431f4(undefined8 param_1,undefined8 param_2,undefined8 param_3)

{
undefined8 local_res18 [2];
undefined auStackY_68 [32];
undefined8 local_38 [2];
undefined8 *local_28;
undefined4 local_20;
undefined4 local_1c;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_68;
local_28 = local_res18;
local_1c = 0;
local_20 = 8;
local_res18[0] = param_3;
FUN_18004312c(param_1,&DAT_180084bd0,param_3,2,local_38);
FUN_180028070(local_18 ^ (ulonglong)auStackY_68);
return;
}
=========================================
Function at address: 0x180043258
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180043258(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,0);
return;
}
=========================================
Function at address: 0x1800432a8
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_1800432a8(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,0);
return;
}
=========================================
Function at address: 0x1800432ec
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_1800432ec(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,0);
return;
}
=========================================
Function at address: 0x180043330
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180043330(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4,
undefined param_5)

{
undefined8 local_res20;

local_res20 = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,4,0);
return;
}
=========================================
Function at address: 0x180043384
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180043384(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined *param_4)

{
longlong lVar1;
longlong lVar2;

if (param_4 == (undefined *)0x0) {
lVar2 = 5;
}
else {
lVar1 = -1;
do {
lVar2 = lVar1;
lVar1 = lVar2 + 1;
} while (param_4[lVar1] != '\0');
lVar2 = lVar2 + 2;
}
if (param_4 == (undefined *)0x0) {
param_4 = &DAT_180083c6c;
}
EtwTraceMessage(param_1,0x2b,param_3,param_2,param_4,lVar2,0);
return;
}
=========================================
Function at address: 0x1800433e4
Called functions addresses: 0xEXTERNAL:00000041 0x180041dd8 0xEXTERNAL:00000133 0xEXTERNAL:00000128 0xEXTERNAL:00000129


PCCTL_CONTEXT FUN_1800433e4(wchar_t *param_1,wchar_t *param_2)

{
DWORD DVar1;
HCERTSTORE hCertStore;
longlong lVar2;
PCCTL_CONTEXT pCVar3;
undefined8 local_38;
undefined8 uStack_30;
undefined8 local_28;
undefined8 uStack_20;
wchar_t *local_18;
undefined8 uStack_10;

local_38 = 0;
uStack_30 = 0;
local_28 = 0;
uStack_20 = 0;
local_18 = (wchar_t *)0x0;
uStack_10 = 0;
hCertStore = CertOpenStore((LPCSTR)0xa,0,0,0x20000,param_1);
if (hCertStore == (HCERTSTORE)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar1 = GetLastError();
FUN_180041dd8(DAT_180091000[2],10,&DAT_180084cf0,param_1,(char)DVar1);
}
pCVar3 = (PCCTL_CONTEXT)0x0;
}
else {
local_38 = CONCAT44(local_38._4_4_,0x30);
lVar2 = -1;
do {
lVar2 = lVar2 + 1;
} while (param_2[lVar2] != L'\0');
uStack_20 = CONCAT44(uStack_20._4_4_,(int)lVar2 * 2 + 2);
local_18 = param_2;
pCVar3 = CertFindCTLInStore(hCertStore,0x10001,0,3,&local_38,(PCCTL_CONTEXT)0x0);
if (((pCVar3 == (PCCTL_CONTEXT)0x0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
DVar1 = GetLastError();
FUN_180041dd8(DAT_180091000[2],0xb,&DAT_180084cf0,param_2,(char)DVar1);
}
CertCloseStore(hCertStore,0);
}
return pCVar3;
}
=========================================
Function at address: 0x180043554
Called functions addresses: 0xEXTERNAL:00000041 0x180041dd8 0x1800433e4 0xEXTERNAL:00000128


undefined8 FUN_180043554(longlong param_1,undefined4 *param_2)

{
undefined4 uVar1;
wchar_t *pvPara;
undefined4 uVar2;
undefined4 uVar3;
DWORD DVar4;
PCCTL_CONTEXT pCVar5;
HCERTSTORE pvVar6;
undefined8 uVar7;

param_2[4] = *(undefined4 *)(param_1 + 0x14);
param_2[5] = *(undefined4 *)(param_1 + 0x18);
param_2[6] = *(undefined4 *)(param_1 + 0x1c);
param_2[7] = *(undefined4 *)(param_1 + 0x20);
uVar1 = *(undefined4 *)(param_1 + 8);
uVar2 = *(undefined4 *)(param_1 + 0xc);
uVar3 = *(undefined4 *)(param_1 + 0x10);
*param_2 = *(undefined4 *)(param_1 + 4);
param_2[1] = uVar1;
param_2[2] = uVar2;
param_2[3] = uVar3;
uVar1 = *(undefined4 *)(param_1 + 0x24);
*(undefined8 *)(param_2 + 10) = 0;
param_2[8] = uVar1;
pvPara = *(wchar_t **)(param_1 + 0x28);
if (*(wchar_t **)(param_1 + 0x30) == (wchar_t *)0x0) {
if (pvPara != (wchar_t *)0x0) {
pvVar6 = CertOpenStore((LPCSTR)0xa,0,0,0x24000,pvPara);
*(HCERTSTORE *)(param_2 + 0xc) = pvVar6;
if (pvVar6 == (HCERTSTORE)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar4 = GetLastError();
FUN_180041dd8(DAT_180091000[2],0xc,&DAT_180084cf0,*(wchar_t **)(param_1 + 0x28),
(char)DVar4);
}
goto LAB_18004363e;
}
}
LAB_1800435ba:
uVar7 = 0;
}
else {
if (pvPara != (wchar_t *)0x0) {
pCVar5 = FUN_1800433e4(pvPara,*(wchar_t **)(param_1 + 0x30));
*(PCCTL_CONTEXT *)(param_2 + 10) = pCVar5;
if (pCVar5 != (PCCTL_CONTEXT)0x0) goto LAB_1800435ba;
}
LAB_18004363e:
uVar7 = 0x8009030d;
}
return uVar7;
}
=========================================
Function at address: 0x180043650
Called functions addresses: 0x18000ff48 0x18000909c 0x180041cb0 0x18002a7c0 0x180059940 0x18002a77b 0x1800432ec 0xEXTERNAL:00000040 0x18000c3a8 0x180056124


uint FUN_180043650(longlong param_1,int param_2,int *param_3)

{
int iVar1;
HLOCAL _Src;
char cVar2;
uint uVar3;
undefined8 uVar4;
void *pvVar5;
longlong lVar6;
undefined8 *puVar7;
HLOCAL local_res8;
HLOCAL local_res20;
undefined local_38 [8];
byte local_30;

local_res20 = (HLOCAL)0x0;
local_res8 = (HLOCAL)((ulonglong)local_res8 & 0xffffffff00000000);
if (param_1 == 0) {
return 0x80090301;
}

if (cVar2 == '\0') {
return 0x80090304;
}
if (param_3 == (int *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xe,&DAT_180084cf0);
}
return 0x8009035d;
}
if (param_2 == 1) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x12,&DAT_180084cf0);
}
local_res8 = (HLOCAL)0x0;
uVar3 = FUN_180056124(param_1,&local_res8);
_Src = local_res8;
if (uVar3 == 0) {
lVar6 = -1;
do {
lVar6 = lVar6 + 1;
} while (*(short *)((longlong)local_res8 + lVar6 * 2) != 0);

*(void **)param_3 = pvVar5;
if (pvVar5 != (void *)0x0) {
memcpy(pvVar5,_Src,(ulonglong)((int)lVar6 * 2 + 2));
if (_Src == (HLOCAL)0x0) {
return 0;
}
LocalFree(_Src);
return 0;
}
if (_Src != (HLOCAL)0x0) {
LocalFree(_Src);
}
return 0x80090300;
}
return uVar3;
}
if (param_2 == 0x56) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180084cf0);
}
uVar4 = FUN_180059940(param_1,(longlong *)&local_res20,(uint *)&local_res8);
uVar3 = FUN_18000c3a8((uint)uVar4);
if (uVar3 == 0) {
iVar1 = (int)local_res8;
uVar3 = (int)local_res8 * 4;

*(void **)(param_3 + 2) = pvVar5;
if (pvVar5 != (void *)0x0) {
memcpy(pvVar5,local_res20,(ulonglong)uVar3);
*param_3 = iVar1;
FUN_18000909c(local_res20);
return 0;
}
FUN_18000909c(local_res20);
return 0x80090300;
}
return uVar3;
}
if (param_2 != 0x57) {
if (param_2 != 0x58) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x13,&DAT_180084cf0,param_2);
}
return 0x80090302;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x11,&DAT_180084cf0);
}
local_res20._0_4_ = *(int *)(param_1 + 0x98);
goto LAB_18004381d;
}
puVar7 = DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar7 = (undefined8 *)DAT_180091000[2];
FUN_180041cb0(puVar7,0x10,&DAT_180084cf0);
}
*param_3 = *(int *)(param_1 + 0xa4);
param_3[1] = *(int *)(param_1 + 0xa8);
if (*(int *)(param_1 + 0xa8) == 0) {
LAB_1800437d9:
if (*(int *)(param_1 + 0xa4) == 0) {
return 0;
}
}
else {
if (*(int *)(param_1 + 0xa4) != 0) {
return 0;
}
if (*(int *)(param_1 + 0xa8) == 0) goto LAB_1800437d9;
}
FUN_18000ff48(puVar7,local_30 & 1,(uint *)&local_res20,(uint *)&local_res8);
if (*(int *)(param_1 + 0xa8) == 0) {
param_3[1] = (int)local_res8;
}
if (*(int *)(param_1 + 0xa4) != 0) {
return 0;
}
LAB_18004381d:
*param_3 = (int)local_res20;
return 0;
}
=========================================
Function at address: 0x1800439c4
Called functions addresses: 0x18000a1f4 0x18000909c 0x180043554 0x180043a7c 0x1800570b0


ulonglong FUN_1800439c4(longlong param_1,short *param_2,uint param_3)

{
ulonglong uVar1;
undefined4 *puVar2;
ulonglong uVar3;

if ((param_3 != 0) && (uVar1 = FUN_180043a7c(param_2,param_3), (int)uVar1 != 0)) {
return uVar1;
}
puVar2 = (undefined4 *)FUN_18000a1f4(0x38);
if (puVar2 == (undefined4 *)0x0) {
uVar3 = 0x80090300;
}
else {
uVar1 = FUN_180043554((longlong)param_2,puVar2);
uVar3 = uVar1 & 0xffffffff;
if ((int)uVar1 == 0) {
if ((*(HCERTSTORE *)(param_1 + 0x330) != (HCERTSTORE)0x0) &&
(*(longlong *)(param_1 + 0x338) != 0)) {
FUN_1800570b0(param_2,*(HCERTSTORE *)(param_1 + 0x330),(longlong *)(param_1 + 0x338));
}
*(undefined8 *)(param_1 + 0x330) = *(undefined8 *)(puVar2 + 0xc);
*(undefined8 *)(puVar2 + 0xc) = 0;
}
else {
FUN_18000909c(puVar2);
puVar2 = (undefined4 *)0x0;
}
*(undefined4 **)(param_1 + 0x350) = puVar2;
}
return uVar3;
}
=========================================
Function at address: 0x180043a7c
Called functions addresses: 0x180043ae4


undefined8 FUN_180043a7c(short *param_1,uint param_2)

{
short *psVar1;
undefined8 uVar2;
short *psVar3;

if ((((param_2 < 0x38) || ((short *)((longlong)param_1 + (ulonglong)param_2) < param_1)) ||
(psVar1 = *(short **)(param_1 + 0x14), ((ulonglong)psVar1 & 1) != 0)) ||
(psVar3 = *(short **)(param_1 + 0x18), ((ulonglong)psVar3 & 1) != 0)) {
uVar2 = 0x8009035d;
}
else {
if ((psVar1 != (short *)0x0) && (uVar2 = FUN_180043ae4(psVar1,param_1,param_2), (int)uVar2 != 0)
) {
return uVar2;
}
if ((psVar3 != (short *)0x0) && (uVar2 = FUN_180043ae4(psVar3,param_1,param_2), (int)uVar2 != 0)
) {
return uVar2;
}
uVar2 = 0;
}
return uVar2;
}
=========================================
Function at address: 0x180043ae4
Called functions addresses: None


undefined8 FUN_180043ae4(short *param_1,short *param_2,uint param_3)

{
if (param_2 <= param_1) {
for (; param_1 <= (short *)((longlong)param_2 + ((ulonglong)param_3 - 2)); param_1 = param_1 + 1
) {
if (*param_1 == 0) {
return 0;
}
}
}
return 0x8009035d;
}
=========================================
Function at address: 0x180043b20
Called functions addresses: 0x1800439c4 0x180041cb0 0x18002a7c0


ulonglong FUN_180043b20(longlong param_1,int param_2,short *param_3,uint param_4)

{
char cVar1;
ulonglong uVar2;
undefined local_28 [8];
uint local_20;


if (cVar1 == '\0') {
return 0x80090304;
}
if ((local_20 & 1) != 0) {
if ((param_3 == (short *)0x0) || (param_1 == 0)) {
return 0x8009035d;
}
if ((local_20 & 0x10000) == 0) {
if (param_4 == 0) {
return 0x8009035d;
}
}
else {
param_4 = 0;
}
if (param_2 == 0x60) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180084cf0);
}
uVar2 = FUN_1800439c4(param_1,param_3,param_4);
return uVar2;
}
}
return 0x80090302;
}
=========================================
Function at address: 0x180043bf8
Called functions addresses: 0x18005baf8 0x18005b8dc 0x180045408 0x18005ba0c 0x18005ba60 0x180041cb0 0xEXTERNAL:000000c8 0xEXTERNAL:00000086 0x180028070 0x180043fa0 0x1800441c4 0xEXTERNAL:000000c7


void FUN_180043bf8(uint param_1,undefined8 param_2,ULONG *param_3,longlong param_4,uint *param_5)

{
PUCHAR pUVar1;
byte bVar2;
ULONG UVar3;
char *pcVar4;
PUCHAR pUVar5;
ULONG *pUVar6;
ulonglong uVar7;
ULONGLONG UVar8;
uint uVar9;
int iVar10;
uint uVar11;
ULONG UVar12;
ULONG UVar13;
byte *pbVar14;
undefined auStackY_c8 [32];
ULONG *local_80;
undefined8 local_78;
undefined8 uStack_70;
undefined8 local_68;
undefined8 uStack_60;
ulonglong local_58;

local_58 = DAT_180091970 ^ (ulonglong)auStackY_c8;
local_80 = (ULONG *)0x0;
local_78 = param_2;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x39,&DAT_180084d00);
}
if (((((((param_3 != (ULONG *)0x0) && (param_4 != 0)) && (param_5 != (uint *)0x0)) &&
((uVar11 = *(uint *)(param_4 + 4), 0xc < uVar11 &&
(pcVar4 = *(char **)(param_4 + 8), pcVar4 != (char *)0x0)))) &&
(((*pcVar4 == '\x16' && ((pcVar4[1] == -2 && (CONCAT11(pcVar4[1],pcVar4[2]) < 0xff00)))) &&
(CONCAT11(pcVar4[0xb],pcVar4[0xc]) + 0xd <= uVar11)))) &&
((((0xb < CONCAT11(pcVar4[0xb],pcVar4[0xc]) && (pcVar4[0xd] == '\x01')) &&
(((uint)(byte)pcVar4[0x13] * 0x100 + (uint)(byte)pcVar4[0x14]) * 0x100 +
(uint)(byte)pcVar4[0x15] == 0)) &&
(((uVar9 = ((uint)(byte)pcVar4[0x16] * 0x100 + (uint)(byte)pcVar4[0x17]) * 0x100 +
(uint)(byte)pcVar4[0x18], uVar9 + 0xc <= uVar11 - 0xd &&
(pUVar1 = (PUCHAR)(pcVar4 + 0x19), 1 < uVar9)) &&
((*pUVar1 == 0xfe && ((CONCAT11(*pUVar1,pcVar4[0x1a]) < 0xff00 && (0x1f < uVar9 - 2)))))))))
) && (uVar9 != 0x22)) {
bVar2 = pcVar4[0x3b];
if ((bVar2 < 0x21) && ((uint)bVar2 <= uVar9 - 0x23)) {
iVar10 = (uVar9 - 0x23) - (uint)bVar2;
pbVar14 = (byte *)(pcVar4 + (ulonglong)bVar2 + 0x3c);
UVar13 = (int)pbVar14 - (int)pUVar1;
if (iVar10 != 0) {
bVar2 = *pbVar14;
if (((bVar2 & 0xdf) == 0) && (uVar11 = iVar10 - 1, bVar2 <= uVar11)) {
UVar12 = uVar11 - bVar2;
uVar7 = FUN_18005baf8((longlong *)&local_80);
if ((int)uVar7 < 0) {
RtlNtStatusToDosError(uVar7 & 0xffffffff);
}
else if (bVar2 == 0) {
local_78 = 0;
uStack_70 = 0;
local_68 = 0;
uStack_60 = 0;
if (DAT_1800919a4 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3a,&DAT_180084d00);
}
}
else {
UVar3 = *param_3;
pUVar5 = *(PUCHAR *)(param_3 + 2);
UVar8 = GetTickCount64();
pUVar6 = local_80;
if ((ulonglong)(*(longlong *)(local_80 + 0xe) + *(longlong *)(local_80 + 0xc)) < UVar8
) {
FUN_18005ba0c(local_80);
}
uVar11 = FUN_18005b8dc(pUVar6,pUVar1,UVar13,pbVar14 + (ulonglong)bVar2 + 1,UVar12,
pUVar5,UVar3,(PUCHAR)&local_78);
if ((int)uVar11 < 0) {
FUN_1800441c4(uVar11);
}
else {
FUN_180043fa0(param_5,&local_78);
}
}
}
else {
iVar10 = FUN_18005ba60(local_80,pUVar1,UVar13,pbVar14 + (ulonglong)bVar2 + 1,UVar12,
*(PUCHAR *)(param_3 + 2),*param_3);
if ((iVar10 == 0) && ((DAT_1800919b0 & 2) != 0)) {
RtlInitUnicodeString(&local_78,local_78);
FUN_180045408((ushort *)&DAT_180084f80,0x180084eb4,(ulonglong)param_1,&local_78);
}
}
}
}
}
}
FUN_180028070(local_58 ^ (ulonglong)auStackY_c8);
return;
}
=========================================
Function at address: 0x180043fa0
Called functions addresses: 0x18000a1f4


undefined4 FUN_180043fa0(uint *param_1,undefined8 *param_2)

{
undefined4 *puVar1;
undefined8 uVar2;
undefined8 uVar3;
longlong lVar4;

lVar4 = *(longlong *)(param_1 + 2);
if (lVar4 == 0) {
*param_1 = 0x3c;
lVar4 = FUN_18000a1f4(0x3c);
*(longlong *)(param_1 + 2) = lVar4;
if (lVar4 == 0) {
return 0xe;
}
}
else if (*param_1 < 0x3c) {
param_1[1] = 0x3c;
return 0x80090321;
}
param_1[1] = 0;
uVar2 = param_2[1];
*(undefined8 *)(lVar4 + 0x1c) = *param_2;
*(undefined8 *)(lVar4 + 0x24) = uVar2;
uVar2 = param_2[2];
uVar3 = param_2[3];
*(undefined4 *)(lVar4 + 0xd) = 0x23000003;
*(undefined8 *)(lVar4 + 0x2c) = uVar2;
*(undefined8 *)(lVar4 + 0x34) = uVar3;
*(undefined4 *)(lVar4 + 0x18) = 0x20fffe23;
*(undefined4 *)(lVar4 + 0x14) = 0;
*(undefined *)(lVar4 + 0x13) = 0;
puVar1 = *(undefined4 **)(param_1 + 2);
*puVar1 = 0xfffe16;
*(undefined2 *)(puVar1 + 1) = 0;
*(undefined4 *)((longlong)puVar1 + 7) = 0;
*(undefined *)((longlong)puVar1 + 6) = 0;
*(undefined2 *)((longlong)puVar1 + 0xb) = 0x2f00;
param_1[1] = 0x3c;
return 0;
}
=========================================
Function at address: 0x180044054
Called functions addresses: 0x18000e5b4 0x18002a7c0


void FUN_180044054(uint param_1,longlong *param_2,ulonglong param_3,undefined4 *param_4)

{
int iVar1;
ulonglong uVar2;
longlong *plVar3;

if (*(char *)(param_2 + 0xc) == '\x02') {
plVar3 = param_2;
uVar2 = FUN_18000e5b4(param_1);
if (((char)uVar2 != '\0') && ((*(uint *)(plVar3 + 8) & 0x3ff0) != 0)) {

if (iVar1 == 0) {
*(undefined2 *)(param_2 + 0xc) = 0;
if (*(int *)((longlong)param_2 + 0x44) == 0x60) {
*(undefined4 *)((longlong)param_2 + 0x44) = 3;
}
}
else {
if (((param_3 >> 8 & 1) != 0) && (*(longlong *)(param_4 + 2) != 0)) {

*(undefined8 *)(param_4 + 2) = 0;
}
*param_4 = 0;
param_4[1] = 0;
}
}
}
return;
}
=========================================
Function at address: 0x180044114
Called functions addresses: 0x18002a77b 0x18002a7c0


undefined4 FUN_180044114(longlong *param_1,uint *param_2)

{
uint uVar1;
ushort *puVar2;
void *_Dst;


if (puVar2 != (ushort *)0x0) {
_Dst = *(void **)(param_2 + 2);
if (_Dst == (void *)0x0) {

*(void **)(param_2 + 2) = _Dst;
if (_Dst == (void *)0x0) {
return 0xe;
}
uVar1 = (uint)*puVar2;
*param_2 = (uint)*puVar2;
}
else {
uVar1 = *param_2;
}
if (uVar1 < *puVar2) {
return 0x80090321;
}
memcpy(_Dst,puVar2 + 1,(ulonglong)*puVar2);
*param_2 = (uint)*puVar2;
}
return 0;
}
=========================================
Function at address: 0x1800441c4
Called functions addresses: 0xEXTERNAL:000000c4


uint FUN_1800441c4(uint param_1)

{
uint uVar1;
bool bVar2;

if ((param_1 & 0x1fff0000) == 0x90000) {
return param_1;
}
if ((int)param_1 < -0x3ffffe73) {
if (param_1 == 0xc000018c) {
return 0xc000018c;
}
if ((int)param_1 < -0x3fffff9b) {
if (param_1 == 0xc0000064) {
return 0x8009030c;
}
if ((int)param_1 < -0x3ffffff2) {
if (param_1 == 0xc000000d) {
return 0x80090308;
}
if (param_1 == 0x8000000d) {
return 0x80090308;
}
if (param_1 == 0x80092010) {
return 0x8009030c;
}
if (-0x7ff6dfef < (int)param_1) {
if ((int)param_1 < -0x7ff6dfec) {
return 0x8009030c;
}
if (param_1 == 0x80096001) {
return 0x8009030c;
}
if (param_1 == 0x800b0110) {
return 0x8009030c;
}
if (param_1 == 0xc0000008) {
return 0x80090301;
}
}
}
else {
if (param_1 == 0xc0000017) {
return 0x80090300;
}
if (param_1 == 0xc0000023) {
return 0x80090321;
}
if (param_1 == 0xc0000034) {
return 0x80090303;
}
if (param_1 == 0xc000005e) {
return 0x80090311;
}
if (param_1 == 0xc000005f) {
return 0x8009030d;
}
if (param_1 == 0xc0000061) {
return 0x80090306;
}
}
}
else if ((int)param_1 < -0x3fffff20) {
if (param_1 == 0xc00000df) {
return 0x80090311;
}
if (param_1 == 0xc000006a) {
return 0x8009030c;
}
if (param_1 == 0xc000006b) {
return 0x80090308;
}
if (-0x3fffff95 < (int)param_1) {
if ((int)param_1 < -0x3fffff8d) {
return 0x8009030c;
}
if (param_1 == 0xc000009a) {
return 0x80090300;
}
if (param_1 == 0xc00000bb) {
return 0x80090302;
}
if (param_1 == 0xc00000be) {
return 0x80090311;
}
}
}
else {
if (param_1 == 0xc00000e5) {
return 0x80090304;
}
if (param_1 == 0xc0000106) {
return 0x80090308;
}
if (param_1 == 0xc0000133) {
return 0x80090324;
}
if (param_1 == 0xc000015b) {
return 0x8009030c;
}
if (param_1 == 0xc000018b) {
return 0x80090303;
}
}
goto LAB_1800444d4;
}
if ((int)param_1 < -0x3ffffca4) {
if (param_1 == 0xc000035b) {
return 0x80090346;
}
if ((int)param_1 < -0x3ffffdcc) {
if ((((param_1 == 0xc0000233) || (param_1 == 0xc000018d)) || (param_1 == 0xc0000190)) ||
(param_1 == 0xc0000192)) {
return 0x80090311;
}
if (param_1 == 0xc0000193) {
return 0x8009030c;
}
if ((int)param_1 < -0x3ffffe68) goto LAB_1800444d4;
if ((int)param_1 < -0x3ffffe64) {
return param_1;
}
bVar2 = param_1 == 0xc0000224;
}
else {
if (param_1 == 0xc0000234) {
return 0x8009030c;
}
if (param_1 == 0xc000023c) {
return 0x80090311;
}
if (param_1 == 0xc00002f9) {
return 0x8009030c;
}
if (param_1 == 0xc00002fe) {
return 0x8009033f;
}
bVar2 = param_1 == 0xc0000320;
}
}
else {
if (-0x3ffffbf5 < (int)param_1) {
if (param_1 == 0xc0000413) {
return 0xc0000413;
}
if (param_1 == 0xc0000418) {
return 0x8009030c;
}
if (param_1 == 0xc000042d) {
return 0x80090361;
}
if (param_1 == 0xc000042f) {
return 0x80090362;
}
if (param_1 == 0) {
return 0;
}
goto LAB_1800444d4;
}
if (param_1 == 0xc000040b) {
return 0x80090357;
}
if ((int)param_1 < -0x3ffffc80) goto LAB_1800444d4;
if ((int)param_1 < -0x3ffffc7e) {
return 0x8009030c;
}
if ((int)param_1 < -0x3ffffc7d) goto LAB_1800444d4;
if ((int)param_1 < -0x3ffffc78) {
return 0x8009030c;
}
if (param_1 == 0xc0000388) {
return 0x80090350;
}
if (param_1 == 0xc000038c) {
return 0x8009030c;
}
if (param_1 == 0xc000038f) {
return 0x8009030c;
}
bVar2 = param_1 == 0xc0000408;
}
if (bVar2) {
return 0x8009030c;
}
LAB_1800444d4:
uVar1 = RtlNtStatusToDosErrorNoTeb();
if (((int)uVar1 < 0) && ((uVar1 & 0x1fff0000) == 0x90000)) {
return uVar1;
}
return 0x80090304;
}
=========================================
Function at address: 0x180044528
Called functions addresses: 0x18004312c 0x180028070


void FUN_180044528(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4)

{
undefined8 local_res18;
undefined4 local_res20 [2];
undefined auStackY_78 [32];
undefined8 local_48 [2];
undefined8 *local_38;
undefined4 local_30;
undefined4 local_2c;
undefined4 *local_28;
undefined4 local_20;
undefined4 local_1c;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_78;
local_38 = &local_res18;
local_2c = 0;
local_28 = local_res20;
local_30 = 8;
local_1c = 0;
local_20 = 4;
local_res18 = param_3;
local_res20[0] = param_4;
FUN_18004312c(param_1,&DAT_180084ca0,param_3,3,local_48);
FUN_180028070(local_18 ^ (ulonglong)auStackY_78);
return;
}
=========================================
Function at address: 0x1800445a4
Called functions addresses: 0x18004312c 0x180028070


void FUN_1800445a4(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 local_res18;
undefined8 local_res20;
undefined auStackY_78 [32];
undefined8 local_48 [2];
undefined8 *local_38;
undefined4 local_30;
undefined4 local_2c;
undefined8 *local_28;
undefined4 local_20;
undefined4 local_1c;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_78;
local_38 = &local_res18;
local_2c = 0;
local_28 = &local_res20;
local_30 = 8;
local_1c = 0;
local_20 = 8;
local_res18 = param_3;
local_res20 = param_4;
FUN_18004312c(8,&DAT_180084cb0,param_3,3,local_48);
FUN_180028070(local_18 ^ (ulonglong)auStackY_78);
return;
}
=========================================
Function at address: 0x18004461c
Called functions addresses: 0x18004312c 0x180028070


void FUN_18004461c(undefined8 param_1,undefined8 param_2,undefined8 param_3,wchar_t *param_4)

{
longlong lVar1;
ulonglong uVar2;
undefined8 local_res18 [2];
undefined auStackY_78 [32];
undefined8 local_48 [2];
undefined8 *local_38;
undefined8 local_30;
wchar_t *local_28;
undefined4 local_20;
undefined4 local_1c;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_78;
local_30 = 8;
local_38 = local_res18;
if (param_4 == (wchar_t *)0x0) {
uVar2 = 10;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (param_4[lVar1] != L'\0');
uVar2 = (ulonglong)((int)lVar1 * 2 + 2);
}
local_1c = 0;
local_20 = (undefined4)uVar2;
if (param_4 == (wchar_t *)0x0) {
param_4 = L"NULL";
}
local_res18[0] = param_3;
local_28 = param_4;
FUN_18004312c(uVar2,&DAT_180084bb0,param_3,3,local_48);
FUN_180028070(local_18 ^ (ulonglong)auStackY_78);
return;
}
=========================================
Function at address: 0x1800446c0
Called functions addresses: 0x180041cb0 0x18004497c


undefined8 FUN_1800446c0(longlong param_1,longlong param_2)

{
undefined uVar1;
int iVar2;
longlong lVar3;
uint *puVar4;
int *piVar5;
longlong lVar6;
undefined8 uVar7;
uint uVar8;
undefined4 uVar9;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18004497c(DAT_180091000[2],0x35,&DAT_180084d00,param_1,(char)param_2);
}
lVar3 = *(longlong *)(param_1 + 8);
if (((*(int *)(param_2 + 4) == 1) && (puVar4 = *(uint **)(param_2 + 8), puVar4 != (uint *)0x0)) &&
(uVar9 = 2, (puVar4[1] & 0xfffffff) == 2)) {
uVar8 = *puVar4;
if (uVar8 < 4) {
return 0x80090302;
}
if (*(longlong *)(lVar3 + 0x58) == 0) {
return 0x80090301;
}
piVar5 = *(int **)(puVar4 + 2);
iVar2 = *piVar5;
if (iVar2 == 1) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x36,&DAT_180084d00);
}
if (*(int *)(lVar3 + 0x44) != 4) {
uVar9 = 5;
}
*(undefined4 *)(lVar3 + 0x44) = uVar9;
return 0;
}
if (iVar2 == 2) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x37,&DAT_180084d00);
uVar8 = *puVar4;
}
if (0xb < uVar8) {
lVar6 = *(longlong *)(puVar4 + 2);
if ((*(uint *)(lVar3 + 0x40) & 0x3ff0) == 0) {
return 0x80090302;
}
if ((*(int *)(lVar6 + 4) - 1U < 2) && (*(uint *)(lVar6 + 8) < 0x100)) {
uVar1 = *(undefined *)(lVar6 + 8);
*(undefined *)(lVar3 + 0x60) = *(undefined *)(lVar6 + 4);
*(undefined *)(lVar3 + 0x61) = uVar1;
*(undefined4 *)(lVar3 + 0x44) = 0x60;
return 0;
}
}
}
else {
uVar7 = 0x80090302;
if (iVar2 != 3) {
return 0x80090302;
}
if (7 < uVar8) {
uVar8 = piVar5[1];
if ((uVar8 & 2) != 0) {
*(undefined *)(*(longlong *)(lVar3 + 0x58) + 0xec) = 0;
uVar7 = 0;
uVar8 = piVar5[1];
}
if ((uVar8 & 1) != 0) {
if (*(char *)(*(longlong *)(lVar3 + 0x58) + 0xed) != '\0') {
*(undefined2 *)(*(longlong *)(lVar3 + 0x58) + 0xec) = 1;
return 0;
}
return uVar7;
}
return uVar7;
}
}
}
return 0x80090308;
}
=========================================
Function at address: 0x180044890
Called functions addresses: 0x18002a7c0 0x18005ad90


undefined SslFreeCustomBuffer(longlong param_1,longlong param_2,undefined8 param_3,char param_4)

{
undefined uVar1;

/* 0x44890  29  SslFreeCustomBuffer */
uVar1 = 0;
if (((param_2 == DAT_180092628) || (param_2 == DAT_180092630)) && (param_1 != 0)) {
if (*(longlong *)(param_1 + 0x18) != 0) {

uVar1 = 1;
if (param_4 != '\0') {
FUN_18005ad90(0x180092da0,*(longlong **)(param_1 + 0x18),*(char *)(param_1 + 0x20),
*(int *)(*(longlong *)(param_1 + 8) + 0x44));
*(undefined8 *)(param_1 + 0x18) = 0;
}
}
}
else {
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x18004492c
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18004492c(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,0);
return;
}
=========================================
Function at address: 0x18004497c
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18004497c(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4,
undefined param_5)

{
undefined8 local_res20;

local_res20 = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,8,0);
return;
}
=========================================
Function at address: 0x1800449cc
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_1800449cc(uint param_1)

{
undefined local_18 [16];

if ((DAT_1800919b0 & 2) != 0) {
RtlInitUnicodeString(local_18);
FUN_180045408((ushort *)&DAT_180084fd0,0x180084ef0,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180044a44
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180044a44(uint param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,int param_5
)

{
ushort *puVar1;
wchar_t *pwVar2;
undefined local_28 [16];
undefined local_18 [16];

RtlInitUnicodeString(local_28);
if ((DAT_1800919b0 & 1) == 0) {
return;
}
if (param_5 == -0x7ff6fcde) {
RtlInitUnicodeString(local_18,param_4);
pwVar2 = L"duub";
puVar1 = (ushort *)&DAT_180085010;
LAB_180044b46:
FUN_180045408(puVar1,(longlong)pwVar2,(ulonglong)param_1,local_28);
}
else {
if (param_5 == -0x7ff6fcdb) {
puVar1 = (ushort *)&DAT_180085030;
}
else if (param_5 == -0x7ff6fcd8) {
puVar1 = (ushort *)&DAT_180085040;
}
else {
if (param_5 != -0x7ff6dff0) {
puVar1 = (ushort *)&DAT_180084fe0;
pwVar2 = L"dudb";
goto LAB_180044b46;
}
puVar1 = (ushort *)&DAT_180085020;
}
FUN_180045408(puVar1,0x180084ee8,(ulonglong)param_1,local_28);
}
return;
}
=========================================
Function at address: 0x180044b64
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180044b64(uint param_1)

{
undefined local_18 [16];

if ((DAT_1800919b0 & 2) != 0) {
RtlInitUnicodeString(local_18);
FUN_180045408((ushort *)&DAT_180084fb0,0x180084ef0,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180044bcc
Called functions addresses: 0x1800452cc 0x180045408 0xEXTERNAL:000000c8


void FUN_180044bcc(uint param_1,undefined8 param_2,uint param_3)

{
undefined local_28 [16];
undefined local_18 [16];

if ((DAT_1800919b0 & 1) != 0) {
RtlInitUnicodeString(local_18);
FUN_1800452cc(param_3,local_28);
FUN_180045408((ushort *)&DAT_180085070,0x180084ec0,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180044c38
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180044c38(uint param_1,undefined8 param_2,char param_3)

{
undefined8 uVar1;
undefined local_28 [16];
undefined local_18 [16];

if ((DAT_1800919b0 & 1) != 0) {
RtlInitUnicodeString(local_18);
uVar1 = DAT_180092df8;
if (param_3 != '\0') {
uVar1 = DAT_180092df0;
}
RtlInitUnicodeString(local_28,uVar1);
FUN_180045408((ushort *)&DAT_180085090,0x180084ea8,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180044ccc
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180044ccc(uint param_1,undefined8 param_2,char param_3,undefined param_4,undefined4 param_5
)

{
undefined8 uVar1;
undefined local_28 [16];
undefined local_18 [16];

if ((DAT_1800919b0 & 1) != 0) {
RtlInitUnicodeString(local_18);
uVar1 = DAT_180092df8;
if (param_3 != '\0') {
uVar1 = DAT_180092df0;
}
RtlInitUnicodeString(local_28,uVar1);
FUN_180045408((ushort *)&DAT_1800850a0,0x180084e98,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180044d6c
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180044d6c(char param_1,undefined8 *param_2)

{
undefined8 uVar1;
wchar_t *pwVar2;
undefined local_48 [16];
undefined local_38 [16];
undefined local_28 [16];
undefined local_18 [16];

if ((DAT_1800919b0 & 4) != 0) {
if (*(int *)(param_2 + 5) == 1) {
pwVar2 = L"key exchange";
}
else if (*(int *)(param_2 + 5) == 2) {
pwVar2 = L"signature";
}
else {
pwVar2 = L"N/A";
if (*(int *)(param_2 + 2) != 0) {
pwVar2 = L"unknown";
}
}
uVar1 = DAT_180092df8;
if (param_1 != '\0') {
uVar1 = DAT_180092df0;
}
RtlInitUnicodeString(local_18,uVar1);
RtlInitUnicodeString(local_28,param_2[1]);
RtlInitUnicodeString(local_38,*param_2);
RtlInitUnicodeString(local_48,pwVar2);
FUN_180045408((ushort *)&DAT_1800850d0,0x180084e80,local_18,local_28);
}
return;
}
=========================================
Function at address: 0x180044e9c
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180044e9c(uint param_1)

{
undefined local_18 [16];

if ((DAT_1800919b0 & 2) != 0) {
RtlInitUnicodeString(local_18);
FUN_180045408((ushort *)&DAT_180084f70,0x180084eb4,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180044ee8
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180044ee8(uint param_1)

{
undefined local_18 [16];

if ((DAT_1800919b0 & 4) != 0) {
RtlInitUnicodeString(local_18);
FUN_180045408((ushort *)&DAT_180084f50,0x180084eb4,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180044f34
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180044f34(uint param_1)

{
undefined local_18 [16];

if ((DAT_1800919b0 & 2) != 0) {
RtlInitUnicodeString(local_18);
FUN_180045408((ushort *)&DAT_180084fc0,0x180084ef0,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180044fac
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180044fac(uint param_1,undefined8 param_2,char param_3,undefined param_4,undefined4 param_5
,undefined4 param_6)

{
undefined8 uVar1;
undefined local_28 [16];
undefined local_18 [16];

if ((DAT_1800919b0 & 1) != 0) {
RtlInitUnicodeString(local_18);
uVar1 = DAT_180092df8;
if (param_3 != '\0') {
uVar1 = DAT_180092df0;
}
RtlInitUnicodeString(local_28,uVar1);
FUN_180045408((ushort *)&DAT_180085050,0x180084ec8,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180045064
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180045064(undefined8 param_1,uint param_2)

{
undefined local_18 [16];

if ((DAT_1800919b0 & 1) != 0) {
RtlInitUnicodeString(local_18,&DAT_180085350);
FUN_180045408((ushort *)&DAT_1800850b0,0x180084e90,local_18,(ulonglong)param_2);
}
return;
}
=========================================
Function at address: 0x1800450b8
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_1800450b8(uint param_1,undefined8 param_2,char param_3,undefined param_4,undefined4 param_5
)

{
undefined8 uVar1;
undefined local_28 [16];
undefined local_18 [16];

if ((DAT_1800919b0 & 1) != 0) {
RtlInitUnicodeString(local_18);
uVar1 = DAT_180092df8;
if (param_3 != '\0') {
uVar1 = DAT_180092df0;
}
RtlInitUnicodeString(local_28,uVar1);
FUN_180045408((ushort *)&DAT_180084f90,0x180084ed8,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180045164
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180045164(uint param_1,undefined8 param_2,char param_3)

{
undefined8 uVar1;
undefined local_28 [16];
undefined local_18 [16];

if ((DAT_1800919b0 & 1) != 0) {
RtlInitUnicodeString(local_18);
uVar1 = DAT_180092df8;
if (param_3 != '\0') {
uVar1 = DAT_180092df0;
}
RtlInitUnicodeString(local_28,uVar1);
FUN_180045408((ushort *)&DAT_1800850c0,0x180084e30,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x1800451f4
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_1800451f4(uint param_1,undefined8 param_2,char param_3)

{
undefined local_18 [16];

if (((DAT_1800919b0 & 4) != 0) && (param_3 == '\x02')) {
RtlInitUnicodeString(local_18);
FUN_180045408((ushort *)&DAT_180085000,0x180084f00,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x180045258
Called functions addresses: 0x180045408 0xEXTERNAL:000000c8


void FUN_180045258(uint param_1,undefined8 param_2,undefined8 param_3)

{
undefined local_28 [16];
undefined local_18 [16];

if ((DAT_1800919b0 & 1) != 0) {
RtlInitUnicodeString(local_18);
RtlInitUnicodeString(local_28,param_3);
FUN_180045408((ushort *)&DAT_180084f40,0x180084ec0,(ulonglong)param_1,local_18);
}
return;
}
=========================================
Function at address: 0x1800452cc
Called functions addresses: 0xEXTERNAL:000000c8


void FUN_1800452cc(uint param_1,undefined8 param_2)

{
wchar_t *pwVar1;

if (param_1 < 0x201) {
if (param_1 != 0x200) {
if ((param_1 == 4) || (param_1 == 8)) {
pwVar1 = L"SSL 2.0";
goto LAB_180045376;
}
if ((param_1 == 0x10) || (param_1 == 0x20)) {
pwVar1 = L"SSL 3.0";
goto LAB_180045376;
}
if ((param_1 == 0x40) || (param_1 == 0x80)) {
pwVar1 = L"TLS 1.0";
goto LAB_180045376;
}
if (param_1 != 0x100) goto LAB_180045354;
}
pwVar1 = L"TLS 1.1";
}
else {
if ((param_1 == 0x400) || (param_1 == 0x800)) {
pwVar1 = L"TLS 1.2";
goto LAB_180045376;
}
if ((param_1 == 0x10000) || (param_1 == 0x20000)) {
pwVar1 = L"DTLS 1.0";
goto LAB_180045376;
}
if ((param_1 == 0x40000) || (param_1 == 0x80000)) {
pwVar1 = L"DTLS 1.2";
goto LAB_180045376;
}
LAB_180045354:
pwVar1 = L"unknown";
}
LAB_180045376:
/* WARNING: Could not recover jumptable at 0x000180045379. Too many branches */

RtlInitUnicodeString(param_2,pwVar1);
return;
}
=========================================
Function at address: 0x18004538c
Called functions addresses: None


uint FUN_18004538c(short *param_1,longlong param_2,longlong param_3,ulonglong param_4)

{
short sVar1;
short *psVar2;
longlong lVar3;
longlong lVar4;

if (param_2 - 1U < 0x7fffffff) {
if (param_4 < 0x7fffffff) {
lVar4 = param_4 - param_2;
lVar3 = param_3 - (longlong)param_1;
do {
if ((lVar4 + param_2 == 0) || (sVar1 = *(short *)(lVar3 + (longlong)param_1), sVar1 == 0))
break;
*param_1 = sVar1;
param_1 = param_1 + 1;
param_2 = param_2 + -1;
} while (param_2 != 0);
psVar2 = param_1 + -1;
if (param_2 != 0) {
psVar2 = param_1;
}
*psVar2 = 0;
return ~-(uint)(param_2 != 0) & 0x80000005;
}
}
else if (param_2 == 0) {
return 0xc000000d;
}
*param_1 = 0;
return 0xc000000d;
}
=========================================
Function at address: 0x180045408
Called functions addresses: 0x180028d90 0xEXTERNAL:0000004a 0xEXTERNAL:000000bd 0x18002a700 0x180027520 0x18002a7c0 0x18000a418 0x18004538c 0x180028070 0x180041d20


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_180045408(ushort *param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
ushort uVar1;
short sVar2;
undefined4 uVar3;
short *psVar4;
PSID pSid;
DWORD DVar5;
int iVar6;
ulonglong uVar7;
undefined8 uVar8;
undefined4 *puVar9;
longlong *plVar10;
longlong lVar11;
ushort *puVar12;
ushort *puVar13;
ulonglong uVar14;
void *_Dst;
undefined *puVar15;
undefined *puVar16;
undefined *puVar17;
ushort *puVar18;
ushort *_Dst_00;
uint uVar19;
ushort *puVar20;
ushort *puVar21;
longlong *plVar22;
bool bVar23;
longlong local_res10;
undefined8 local_res18;
undefined8 local_res20;
undefined auStack_98 [48];
uint local_68;
uint local_64;
ushort *local_60;
ushort *local_58;
ulonglong local_50;

local_50 = DAT_180091970 ^ (ulonglong)&local_68;
_Dst_00 = (ushort *)0x0;
local_68 = 0;
local_res10 = param_2;
local_res18 = param_3;
local_res20 = param_4;
local_58 = param_1;
puVar13 = _Dst_00;
if ((DAT_180092d80 == 0) &&
(DVar5 = FUN_180027520(), puVar17 = auStack_98, puVar18 = _Dst_00, DVar5 != 0)) {
LAB_180045b28:
puVar12 = (ushort *)0x0;
if (puVar18 != (ushort *)0x0) {
do {
if ((*(longlong *)(_Dst_00 + (longlong)puVar12 * 4) != 0) &&
(*(int *)(*(longlong *)(_Dst_00 + (longlong)puVar12 * 4) + -8) == 0x70616548)) {
*(undefined8 *)(puVar17 + -8) = 0x180045b5f;

}
puVar12 = (ushort *)(ulonglong)((int)puVar12 + 1);
} while (puVar12 < puVar18);
}
puVar15 = puVar17;
if ((_Dst_00 != (ushort *)0x0) && (*(int *)(_Dst_00 + -4) == 0x70616548)) {
*(undefined8 *)(puVar17 + -8) = 0x180045b95;

}
}
else {
puVar18 = (ushort *)0x0;
puVar17 = auStack_98;
puVar12 = _Dst_00;
if (local_res10 == 0) {
LAB_180045ac9:
uVar19 = local_68;
*(undefined8 *)(puVar17 + -8) = 0x180045ae1;
iVar6 = EtwEventWrite(DAT_180092d80,param_1,uVar19);
puVar18 = puVar12;
if (((iVar6 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar1 = *param_1;
uVar8 = DAT_180091000[2];
*(int *)(puVar17 + 0x20) = iVar6;
*(undefined8 *)(puVar17 + -8) = 0x180045b25;
FUN_180041d20(uVar8,10,&DAT_180084f30,(uint)uVar1,puVar17[0x20]);
}
goto LAB_180045b28;
}
uVar7 = 0xffffffffffffffff;
do {
uVar7 = uVar7 + 1;
} while (*(short *)(local_res10 + uVar7 * 2) != 0);
puVar12 = (ushort *)(uVar7 & 0xffffffff);
puVar20 = (ushort *)0x7f;
local_60 = (ushort *)0x7f;
puVar13 = puVar18;
if (((ushort *)0x7f < puVar12) ||
(puVar20 = (ushort *)(uVar7 & 0xffffffff), uVar19 = local_68, local_60 = puVar12,
(int)uVar7 != 0)) {
do {
uVar1 = *(ushort *)(local_res10 + (longlong)puVar13 * 2);
if (uVar1 == 0x62) {
iVar6 = 2;
}
else {
if (((uVar1 != 100) && (uVar1 != 0x70)) &&
((puVar17 = auStack_98, uVar1 < 0x73 || (puVar17 = auStack_98, 0x75 < uVar1))))
goto LAB_180045bbe;
iVar6 = 1;
}
puVar13 = (ushort *)(ulonglong)((int)puVar13 + 1);
uVar19 = (int)_Dst_00 + iVar6;
_Dst_00 = (ushort *)(ulonglong)uVar19;
} while (puVar13 < puVar20);
}
local_68 = uVar19;
uVar7 = (longlong)_Dst_00 * 0x10;
puVar17 = auStack_98;
puVar13 = puVar18;
if ((((_Dst_00 == (ushort *)0x0) || (puVar17 = auStack_98, DAT_1800920e0 < uVar7)) ||
(uVar14 = DAT_1800920e8 + 8 + uVar7, puVar17 = auStack_98, puVar13 = (ushort *)0x0,
uVar14 < uVar7)) || (uVar8 = FUN_18000a418(uVar14), puVar17 = auStack_98, (int)uVar8 == 0))
{
LAB_180045575:
if (uVar7 <= uVar7 + 8) {
*(undefined8 *)(puVar17 + -8) = 0x180045595;

if (puVar9 == (undefined4 *)0x0) goto LAB_180045bbe;
*puVar9 = 0x70616548;
puVar13 = (ushort *)(puVar9 + 2);
}
puVar16 = puVar17;
if (puVar13 == (ushort *)0x0) goto LAB_180045bbe;
}
else {
uVar14 = uVar7 + 0x17;
if (uVar14 <= uVar7 + 8) {
uVar14 = 0xffffffffffffff0;
}
lVar11 = -(uVar14 & 0xfffffffffffffff0);
puVar13 = (ushort *)((longlong)&local_68 + lVar11);
puVar17 = auStack_98 + lVar11;
if (puVar13 == (ushort *)0x0) goto LAB_180045575;
puVar13[0] = 0x7453;
puVar13[1] = 0x6b63;
puVar13 = (ushort *)((longlong)&local_60 + lVar11);
puVar17 = auStack_98 + lVar11;
puVar16 = auStack_98 + lVar11;
if (puVar13 == (ushort *)0x0) goto LAB_180045575;
}
*(undefined8 *)(puVar16 + -8) = 0x1800455ca;
memset(puVar13,0,uVar7);
uVar7 = (longlong)_Dst_00 * 8;
puVar18 = (ushort *)0x0;
bVar23 = _Dst_00 != (ushort *)0x0;
puVar15 = puVar16;
_Dst_00 = (ushort *)0x0;
if (((bVar23) && (_Dst_00 = puVar18, uVar7 < DAT_1800920e0 || uVar7 - DAT_1800920e0 == 0)) &&
(uVar14 = DAT_1800920e8 + 8 + uVar7, uVar7 <= uVar14)) {
*(undefined8 *)(puVar16 + -8) = 0x1800455fd;
uVar8 = FUN_18000a418(uVar14);
if ((int)uVar8 == 0) goto LAB_18004563c;
uVar14 = uVar7 + 0x17;
if (uVar14 <= uVar7 + 8) {
uVar14 = 0xffffffffffffff0;
}
*(undefined8 *)(puVar16 + -8) = 0x180045624;
lVar11 = -(uVar14 & 0xfffffffffffffff0);
_Dst_00 = (ushort *)(puVar16 + lVar11 + 0x30);
puVar15 = puVar16 + lVar11;
if (_Dst_00 == (ushort *)0x0) goto LAB_18004563c;
_Dst_00[0] = 0x7453;
_Dst_00[1] = 0x6b63;
_Dst_00 = (ushort *)(puVar16 + lVar11 + 0x38);
puVar15 = puVar16 + lVar11;
puVar17 = puVar16 + lVar11;
if (_Dst_00 == (ushort *)0x0) goto LAB_18004563c;
LAB_18004567a:
*(undefined8 *)(puVar17 + -8) = 0x180045687;
memset(_Dst_00,0,uVar7);
puVar18 = (ushort *)0x0;
local_64 = 0;
puVar12 = (ushort *)0x0;
if (puVar20 != (ushort *)0x0) {
plVar22 = &local_res10;
puVar16 = puVar17;
puVar20 = puVar18;
puVar21 = puVar13;
do {
uVar19 = (uint)puVar20;
sVar2 = *(short *)(local_res10 + (longlong)puVar20 * 2);
puVar17 = puVar16;
if (sVar2 == 0x62) {
uVar3 = *(undefined4 *)(plVar22 + 1);
puVar12 = _Dst_00 + (longlong)puVar18 * 4;
puVar12[0] = 0;
puVar12[1] = 0;
puVar12[2] = 0;
puVar12[3] = 0;
if ((DAT_1800920e0 < 4) || (DAT_1800920e8 + 0xcU < 4)) {
LAB_180045a41:
*(undefined8 *)(puVar17 + -8) = 0x180045a5d;

*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = puVar9;
if (puVar9 == (undefined4 *)0x0) goto LAB_180045b28;
*puVar9 = 0x70616548;
puVar9 = (undefined4 *)(*(longlong *)(_Dst_00 + (longlong)puVar18 * 4) + 8);
*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = puVar9;
if (puVar9 == (undefined4 *)0x0) goto LAB_180045b28;
}
else {
*(undefined8 *)(puVar16 + -8) = 0x180045a0b;
uVar8 = FUN_18000a418(DAT_1800920e8 + 0xcU);
if ((int)uVar8 != 0) {
puVar17 = puVar16 + -0x10;
*(undefined **)(_Dst_00 + (longlong)puVar18 * 4) = puVar16 + 0x20;
}
if (*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) == (undefined4 *)0x0)
goto LAB_180045a41;
**(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = 0x6b637453;
puVar9 = (undefined4 *)(*(longlong *)(_Dst_00 + (longlong)puVar18 * 4) + 8);
*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = puVar9;
if (puVar9 == (undefined4 *)0x0) goto LAB_180045a41;
}
*puVar9 = uVar3;
plVar22 = plVar22 + 2;
lVar11 = (longlong)puVar18 * 4;
puVar18 = puVar18 + 1;
*(longlong *)puVar21 = *(longlong *)(_Dst_00 + lVar11);
puVar21[4] = 4;
puVar21[5] = 0;
puVar21[6] = 0;
puVar21[7] = 0;
*(longlong *)(puVar21 + 8) = *plVar22;
*(undefined4 *)(puVar21 + 0xc) = uVar3;
puVar21[0xe] = 0;
puVar21[0xf] = 0;
puVar21 = puVar21 + 0x10;
}
else {
if (sVar2 == 100) {
uVar3 = *(undefined4 *)(plVar22 + 1);
puVar12 = _Dst_00 + (longlong)puVar18 * 4;
puVar12[0] = 0;
puVar12[1] = 0;
puVar12[2] = 0;
puVar12[3] = 0;
if ((DAT_1800920e0 < 4) || (DAT_1800920e8 + 0xcU < 4)) {
LAB_180045982:
*(undefined8 *)(puVar17 + -8) = 0x18004599e;

*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = puVar9;
if (puVar9 == (undefined4 *)0x0) goto LAB_180045b28;
*puVar9 = 0x70616548;
puVar9 = (undefined4 *)(*(longlong *)(_Dst_00 + (longlong)puVar18 * 4) + 8);
*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = puVar9;
if (puVar9 == (undefined4 *)0x0) goto LAB_180045b28;
}
else {
*(undefined8 *)(puVar16 + -8) = 0x18004594c;
uVar8 = FUN_18000a418(DAT_1800920e8 + 0xcU);
if ((int)uVar8 != 0) {
puVar17 = puVar16 + -0x10;
*(undefined **)(_Dst_00 + (longlong)puVar18 * 4) = puVar16 + 0x20;
}
if (*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) == (undefined4 *)0x0)
goto LAB_180045982;
**(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = 0x6b637453;
puVar9 = (undefined4 *)(*(longlong *)(_Dst_00 + (longlong)puVar18 * 4) + 8);
*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = puVar9;
if (puVar9 == (undefined4 *)0x0) goto LAB_180045982;
}
*puVar9 = uVar3;
lVar11 = *(longlong *)(_Dst_00 + (longlong)puVar18 * 4);
puVar21[4] = 4;
puVar21[5] = 0;
puVar21[6] = 0;
puVar21[7] = 0;
LAB_1800459d4:
*(longlong *)puVar21 = lVar11;
}
else {
if (sVar2 == 0x70) {
lVar11 = plVar22[1];
puVar12 = _Dst_00 + (longlong)puVar18 * 4;
puVar12[0] = 0;
puVar12[1] = 0;
puVar12[2] = 0;
puVar12[3] = 0;
if ((DAT_1800920e0 < 8) || (DAT_1800920e8 + 0x10U < 8)) {
LAB_1800458c9:
*(undefined8 *)(puVar17 + -8) = 0x1800458e5;

*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = puVar9;
if (puVar9 == (undefined4 *)0x0) goto LAB_180045b28;
*puVar9 = 0x70616548;
plVar10 = (longlong *)(*(longlong *)(_Dst_00 + (longlong)puVar18 * 4) + 8);
*(longlong **)(_Dst_00 + (longlong)puVar18 * 4) = plVar10;
if (plVar10 == (longlong *)0x0) goto LAB_180045b28;
}
else {
*(undefined8 *)(puVar16 + -8) = 0x180045893;
uVar8 = FUN_18000a418(DAT_1800920e8 + 0x10U);
if ((int)uVar8 != 0) {
puVar17 = puVar16 + -0x10;
*(undefined **)(_Dst_00 + (longlong)puVar18 * 4) = puVar16 + 0x20;
}
if (*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) == (undefined4 *)0x0)
goto LAB_1800458c9;
**(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = 0x6b637453;
plVar10 = (longlong *)(*(longlong *)(_Dst_00 + (longlong)puVar18 * 4) + 8);
*(longlong **)(_Dst_00 + (longlong)puVar18 * 4) = plVar10;
if (plVar10 == (longlong *)0x0) goto LAB_1800458c9;
}
*plVar10 = lVar11;
lVar11 = *(longlong *)(_Dst_00 + (longlong)puVar18 * 4);
puVar21[4] = 8;
puVar21[5] = 0;
puVar21[6] = 0;
puVar21[7] = 0;
goto LAB_1800459d4;
}
if (sVar2 != 0x73) {
if (sVar2 == 0x74) {
lVar11 = plVar22[1];
puVar21[4] = 0x10;
puVar21[5] = 0;
puVar21[6] = 0;
puVar21[7] = 0;
goto LAB_1800459d4;
}
if (sVar2 == 0x75) {
plVar22 = plVar22 + 1;
puVar20 = (ushort *)*plVar22;
puVar12 = _Dst_00 + (longlong)puVar18 * 4;
puVar12[0] = 0;
puVar12[1] = 0;
puVar12[2] = 0;
puVar12[3] = 0;
uVar7 = (ulonglong)*puVar20 + 2;
if ((DAT_1800920e0 < uVar7) ||
(uVar14 = (ulonglong)*puVar20 + DAT_1800920e8 + 10, uVar14 < uVar7)) {
LAB_180045779:
if ((ulonglong)*puVar20 + 10 < (ulonglong)*puVar20 + 2) goto LAB_180045b28;
*(undefined8 *)(puVar17 + -8) = 0x1800457a6;

*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = puVar9;
if (puVar9 == (undefined4 *)0x0) goto LAB_180045b28;
*puVar9 = 0x70616548;
_Dst = (void *)(*(longlong *)(_Dst_00 + (longlong)puVar18 * 4) + 8);
*(void **)(_Dst_00 + (longlong)puVar18 * 4) = _Dst;
if (_Dst == (void *)0x0) goto LAB_180045b28;
}
else {
*(undefined8 *)(puVar16 + -8) = 0x180045721;
uVar8 = FUN_18000a418(uVar14);
if ((int)uVar8 != 0) {
uVar7 = (ulonglong)*puVar20 + 0x19;
if (uVar7 <= (ulonglong)*puVar20 + 10) {
uVar7 = 0xffffffffffffff0;
}
*(undefined8 *)(puVar16 + -8) = 0x180045750;
puVar17 = puVar16 + -(uVar7 & 0xfffffffffffffff0);
*(undefined **)(_Dst_00 + (longlong)puVar18 * 4) =
puVar16 + -(uVar7 & 0xfffffffffffffff0) + 0x30;
}
if (*(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) == (undefined4 *)0x0)
goto LAB_180045779;
**(undefined4 **)(_Dst_00 + (longlong)puVar18 * 4) = 0x6b637453;
_Dst = (void *)(*(longlong *)(_Dst_00 + (longlong)puVar18 * 4) + 8);
*(void **)(_Dst_00 + (longlong)puVar18 * 4) = _Dst;
if (_Dst == (void *)0x0) goto LAB_180045779;
}
uVar1 = *puVar20;
*(undefined8 *)(puVar17 + -8) = 0x1800457de;
memset(_Dst,0,(ulonglong)uVar1 + 2);
uVar1 = *puVar20;
lVar11 = *(longlong *)(puVar20 + 4);
psVar4 = *(short **)(_Dst_00 + (longlong)puVar18 * 4);
*(undefined8 *)(puVar17 + -8) = 0x1800457f7;
uVar19 = FUN_18004538c(psVar4,(ulonglong)(uVar1 >> 1) + 1,lVar11,
(ulonglong)(uVar1 >> 1));
if (uVar19 == 0) {
lVar11 = *(longlong *)(_Dst_00 + (longlong)puVar18 * 4);
puVar18 = (ushort *)((longlong)puVar18 + 1);
*(uint *)(puVar21 + 4) = *puVar20 + 2;
*(longlong *)puVar21 = lVar11;
puVar21[6] = 0;
puVar21[7] = 0;
puVar21 = puVar21 + 8;
uVar19 = local_64;
goto LAB_180045ab1;
}
}
goto LAB_180045b28;
}
pSid = (PSID)plVar22[1];
*(undefined8 *)(puVar16 + -8) = 0x180045850;
DVar5 = GetLengthSid(pSid);
*(PSID *)puVar21 = pSid;
puVar21[6] = 0;
puVar21[7] = 0;
*(DWORD *)(puVar21 + 4) = DVar5;
}
plVar22 = plVar22 + 1;
puVar18 = (ushort *)((longlong)puVar18 + 1);
puVar21 = puVar21 + 8;
}
LAB_180045ab1:
puVar20 = (ushort *)(ulonglong)(uVar19 + 1);
local_64 = uVar19 + 1;
puVar16 = puVar17;
puVar12 = puVar18;
param_1 = local_58;
} while (puVar20 < local_60);
}
goto LAB_180045ac9;
}
LAB_18004563c:
if (uVar7 + 8 < uVar7) {
LAB_18004566d:
puVar17 = puVar15;
if (_Dst_00 != (ushort *)0x0) goto LAB_18004567a;
}
else {
*(undefined8 *)(puVar15 + -8) = 0x18004565c;

if (puVar9 != (undefined4 *)0x0) {
*puVar9 = 0x70616548;
_Dst_00 = (ushort *)(puVar9 + 2);
goto LAB_18004566d;
}
}
}
puVar17 = puVar15;
if ((puVar13 != (ushort *)0x0) && (*(int *)(puVar13 + -4) == 0x70616548)) {
*(undefined8 *)(puVar15 + -8) = 0x180045bbe;

}
LAB_180045bbe:
uVar7 = local_50 ^ (ulonglong)&local_68;
*(undefined8 *)(puVar17 + -8) = 0x180045bcc;
FUN_180028070(uVar7);
return;
}
=========================================
Function at address: 0x180045bf8
Called functions addresses: 0x180041dd8 0xEXTERNAL:000000be 0xEXTERNAL:00000040


void FUN_180045bf8(void)

{
int iVar1;

if (DAT_180092d80 != 0) {
iVar1 = EtwEventUnregister();
if (((iVar1 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041dd8(DAT_180091000[2],0xb,&DAT_180084f30,L"Schannel",(char)iVar1);
}
}
if (DAT_180092df8 != (HLOCAL)0x0) {
LocalFree(DAT_180092df8);
DAT_180092df8 = (HLOCAL)0x0;
}
if (DAT_180092df0 != (HLOCAL)0x0) {
LocalFree(DAT_180092df0);
DAT_180092df0 = (HLOCAL)0x0;
}
return;
}
=========================================
Function at address: 0x180045ca0
Called functions addresses: 0x18000909c 0x180014db8 0xEXTERNAL:0000012b 0x18000a1f4 0x18000e850 0xEXTERNAL:00000138 0x18002a77b 0xEXTERNAL:00000137 0xEXTERNAL:00000041


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined8
SslCrackCertificate(BYTE *param_1,undefined8 param_2,undefined *param_3,undefined8 *param_4)

{
uint uVar1;
PCERT_INFO p_Var2;
longlong lVar3;
int iVar4;
DWORD DVar5;
PCCERT_CONTEXT pCertContext;
DWORD *pDVar6;
undefined4 *puVar7;
ulonglong uVar8;
longlong lVar9;
undefined4 uVar10;
DWORD DVar11;
size_t _Size;
longlong *local_28 [2];

/* 0x45ca0  25  SslCrackCertificate */
DVar11 = (DWORD)param_2;
uVar10 = 0;
iVar4 = FUN_18000e850(1,param_2,param_3,(ulonglong)param_4);
if (iVar4 == 0) {
return 0;
}
if (((ulonglong)param_3 & 2) != 0) {
if (DVar11 < 0x12) {
return 0;
}
lVar9 = *(longlong *)(param_1 + 4) - _DAT_180085100;
if ((lVar9 == 0) &&
(lVar9 = (ulonglong)*(uint *)(param_1 + 0xc) - (ulonglong)(uint)s_certificate_180085102._6_4_
, lVar9 == 0)) {
lVar9 = (ulonglong)param_1[0x10] - (ulonglong)(byte)s_certificate_180085102[10];
}
if (lVar9 == 0) {
param_1 = param_1 + 0x11;
DVar11 = DVar11 - 0x11;
}
}
pCertContext = CertCreateCertificateContext(1,param_1,DVar11);
if (pCertContext == (PCCERT_CONTEXT)0x0) {
GetLastError();
return 0;
}
DVar11 = CertNameToStrA(pCertContext->dwCertEncodingType,&pCertContext->pCertInfo->Subject,
0x20000003,(LPSTR)0x0,0);
pDVar6 = (DWORD *)0x0;
if (DVar11 != 0) {
DVar5 = CertNameToStrA(pCertContext->dwCertEncodingType,&pCertContext->pCertInfo->Issuer,
0x20000003,(LPSTR)0x0,0);
pDVar6 = (DWORD *)0x0;
if (DVar5 != 0) {
pDVar6 = (DWORD *)FUN_18000a1f4((ulonglong)(DVar11 + 0x42 + DVar5));
if (pDVar6 == (DWORD *)0x0) goto LAB_180045d7e;
pDVar6[0xe] = 0;
pDVar6[0xf] = 0;
*(DWORD **)(pDVar6 + 10) = pDVar6 + 0x10;
*(ulonglong *)(pDVar6 + 0xc) = (longlong)(pDVar6 + 0x10) + (ulonglong)DVar5;
_Size = 0x10;
*pDVar6 = pCertContext->pCertInfo->dwVersion;
p_Var2 = pCertContext->pCertInfo;
if ((p_Var2->SerialNumber).cbData < 0x11) {
_Size = (size_t)(p_Var2->SerialNumber).cbData;
}
memcpy(pDVar6 + 1,(p_Var2->SerialNumber).pbData,_Size);
*(FILETIME *)(pDVar6 + 6) = pCertContext->pCertInfo->NotBefore;
*(FILETIME *)(pDVar6 + 8) = pCertContext->pCertInfo->NotAfter;
DVar5 = CertNameToStrA(pCertContext->dwCertEncodingType,&pCertContext->pCertInfo->Issuer,
0x20000003,*(LPSTR *)(pDVar6 + 10),DVar5);
if ((DVar5 != 0) &&
(DVar11 = CertNameToStrA(pCertContext->dwCertEncodingType,&pCertContext->pCertInfo->Subject
,0x20000003,*(LPSTR *)(pDVar6 + 0xc),DVar11), DVar11 != 0)) {
local_28[0] = (longlong *)0x0;
puVar7 = (undefined4 *)FUN_18000a1f4(0x20);
*(undefined4 **)(pDVar6 + 0xe) = puVar7;
if (puVar7 != (undefined4 *)0x0) {
*puVar7 = 0;
*(undefined4 *)(*(longlong *)(pDVar6 + 0xe) + 4) = 0x14;
lVar9 = *(longlong *)(pDVar6 + 0xe);
*(undefined4 *)(lVar9 + 8) = 0x31415352;
uVar8 = FUN_180014db8((longlong)pCertContext,local_28,(int *)0x0);
if ((int)uVar8 == 0) {
lVar3 = *local_28[0];
iVar4 = *(int *)(lVar3 + 4);
*(uint *)(lVar9 + 0xc) = *(uint *)(lVar3 + 0xc) >> 3;
if (iVar4 == 0xa400) {
uVar1 = *(uint *)(lVar3 + 0xc);
*(uint *)(lVar9 + 0x10) = uVar1;
*(uint *)(lVar9 + 0x14) = (uVar1 >> 3) - 1;
uVar10 = *(undefined4 *)(lVar3 + 0x10);
}
else {
uVar1 = *(uint *)(lVar3 + 0xc);
*(uint *)(lVar9 + 0x10) = uVar1 >> 3;
*(uint *)(lVar9 + 0x14) = (uVar1 >> 6) - 1;
}
*(undefined4 *)(lVar9 + 0x18) = uVar10;
FUN_18000909c(local_28[0]);
CertFreeCertificateContext(pCertContext);
*param_4 = pDVar6;
return 1;
}
}
goto LAB_180045d7e;
}
}
}
GetLastError();
LAB_180045d7e:
CertFreeCertificateContext(pCertContext);
if (pDVar6 != (DWORD *)0x0) {
if (*(HLOCAL *)(pDVar6 + 0xe) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(pDVar6 + 0xe));
}
FUN_18000909c(pDVar6);
}
return 0;
}
=========================================
Function at address: 0x180045f80
Called functions addresses: 0x18000909c


void SslFreeCertificate(HLOCAL param_1)

{
/* 0x45f80  28  SslFreeCertificate */
if (param_1 != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)param_1 + 0x38));
FUN_18000909c(param_1);
}
return;
}
=========================================
Function at address: 0x180045fb0
Called functions addresses: 0x18000eb9c


undefined8 SslGenerateRandomBits(PUCHAR param_1,ULONG param_2)

{
NTSTATUS NVar1;
undefined8 uVar2;

NVar1 = BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,param_1,param_2,2);
if (-1 < NVar1) {
return 0;
}
/* WARNING: Could not recover jumptable at 0x0001800385f0. Too many branches */

uVar2 = RtlNtStatusToDosError();
return uVar2;
}
=========================================
Function at address: 0x180045fc0
Called functions addresses: None


undefined8 SslGetMaximumKeySize(void)

{
/* 0x45fc0  32  SslGetMaximumKeySize */
return 0x800;
}
=========================================
Function at address: 0x180045fd0
Called functions addresses: None


undefined8 SslLoadCertificate(void)

{
/* 0x45fd0  34  SslLoadCertificate */
return 0;
}
=========================================
Function at address: 0x180045fdc
Called functions addresses: 0xEXTERNAL:000000c2 0x18005d574 0x18000909c 0x18002a7c0 0xEXTERNAL:000000c7 0x180028070 0xEXTERNAL:000000c0


void FUN_180045fdc(longlong param_1,undefined8 param_2)

{
uint uVar1;
HLOCAL pvVar2;
char cVar3;
int iVar4;
undefined8 uVar5;
uint uVar6;
undefined8 *puVar7;
undefined auStack_a8 [48];
longlong local_78;
uint local_70 [2];
HLOCAL local_68;
undefined8 local_60;
longlong lStack_58;
undefined local_50 [8];
uint local_48;
undefined8 local_38;
undefined4 local_30;
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_a8;
local_68 = (HLOCAL)0x0;
local_78 = 0;
local_70[0] = 0;
local_38 = 0;
local_30 = 0;
local_60 = 0;
lStack_58 = 0;

if (cVar3 == '\0') goto LAB_1800461b7;
uVar6 = local_48 & 0x40;
if (*(longlong *)(param_1 + 0x58) == 0) goto LAB_1800461b7;
RtlAcquireResourceShared(*(longlong *)(param_1 + 0x58) + 0x48,1);
uVar5 = FUN_18005d574(*(longlong *)(param_1 + 0x58),&local_68,local_70);
RtlReleaseResource(*(longlong *)(param_1 + 0x58) + 0x48);
pvVar2 = local_68;
uVar1 = local_70[0];
if ((int)uVar5 == 0) {
if ((local_68 == (HLOCAL)0x0) ||


-1 < iVar4)))) {
if (uVar6 == 0) {
lStack_58 = local_78;
local_60 = CONCAT44(uVar1,(undefined4)local_60);
}
else {
local_30 = (undefined4)local_78;
local_38 = CONCAT44(uVar1,(undefined4)local_38);
}
puVar7 = &local_38;
if (uVar6 == 0) {
puVar7 = &local_60;
}

(0,(-(uint)(uVar6 != 0) & 0xfffffffc) + 0x10,param_2,puVar7);
if (-1 < iVar4) {
local_78 = 0;
goto LAB_180046182;
}
}
RtlNtStatusToDosError(iVar4);
}
LAB_180046182:
if (local_78 != 0) {

}
if (pvVar2 != (HLOCAL)0x0) {
FUN_18000909c(pvVar2);
}
LAB_1800461b7:
FUN_180028070(local_28 ^ (ulonglong)auStack_a8);
return;
}
=========================================
Function at address: 0x1800461e4
Called functions addresses: 0xEXTERNAL:000000c2 0x18000909c 0xEXTERNAL:0000012b 0x18000a1f4 0x18002a7c0 0xEXTERNAL:000000c7 0xEXTERNAL:00000136 0xEXTERNAL:000000c0 0xEXTERNAL:00000041 0x18000f5c0


DWORD FUN_1800461e4(longlong param_1,longlong param_2)

{
CERT_NAME_BLOB *pName;
longlong lVar1;
uint uVar2;
ulonglong uVar3;
ulonglong uVar4;
PCCERT_CONTEXT pCertContext;
char cVar5;
DWORD DVar6;
LPWSTR psz;
longlong local_res18;
longlong local_res20;
PCCERT_CONTEXT local_58;
undefined8 local_50;
ulonglong uStack_48;
undefined8 local_40;

local_58 = (PCCERT_CONTEXT)0x0;
psz = (LPWSTR)0x0;
local_40 = 0;
local_res18 = 0;
local_res20 = 0;
local_50 = 0;
uStack_48 = 0;

if (cVar5 == '\0') {
return 0x54f;
}
uVar3 = uStack_48 & 0x40;
uVar4 = uStack_48 & 0x40;
if (param_2 == 0) {
return 0x57;
}
RtlAcquireResourceShared(*(longlong *)(param_1 + 0x58) + 0x48,1);
lVar1 = *(longlong *)(param_1 + 0x58);
if (*(uint **)(lVar1 + 0x18) == (uint *)0x0) {
RtlReleaseResource(lVar1 + 0x48);
return 0x78;
}
DVar6 = FUN_18000f5c0(*(uint **)(lVar1 + 0x18),*(DWORD *)(lVar1 + 0x20),&local_58);
RtlReleaseResource(*(longlong *)(param_1 + 0x58) + 0x48);
pCertContext = local_58;
if (DVar6 == 0) {
pName = &local_58->pCertInfo->Issuer;
if ((pName->cbData == 0) || ((local_58->pCertInfo->Issuer).pbData == (BYTE *)0x0)) {
DVar6 = 0x78;
psz = (LPWSTR)0x0;
}
else {
DVar6 = CertNameToStrW(local_58->dwCertEncodingType,pName,0x20000003,(LPWSTR)0x0,0);
if (DVar6 != 0) {
uVar2 = DVar6 * 2;
psz = (LPWSTR)FUN_18000a1f4((ulonglong)uVar2);
if (psz == (LPWSTR)0x0) {
DVar6 = 0xe;
goto LAB_18004641f;
}
DVar6 = CertNameToStrW(pCertContext->dwCertEncodingType,&pCertContext->pCertInfo->Issuer,
0x20000003,psz,DVar6);
if (DVar6 != 0) {

if ((-1 < (int)DVar6) &&

-1 < (int)DVar6)) {
if (uVar4 == 0) {
local_res20 = local_res18;
}
else {
local_res20 = CONCAT44(local_res20._4_4_,(undefined4)local_res18);
}

(0,(-(uint)(uVar3 != 0) & 0xfffffffc) + 8,param_2,&local_res20);
if (-1 < (int)DVar6) goto LAB_18004641f;
}
DVar6 = RtlNtStatusToDosError(DVar6);
goto LAB_18004641f;
}
}
DVar6 = GetLastError();
}
}
LAB_18004641f:
if (pCertContext != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(pCertContext);
}
if (psz != (LPWSTR)0x0) {
FUN_18000909c(psz);
}
if (((int)DVar6 < 0) && (local_res18 != 0)) {

}
return DVar6;
}
=========================================
Function at address: 0x18004648c
Called functions addresses: 0x180041cb0 0x18002a7c0


undefined8 FUN_18004648c(longlong param_1,undefined8 param_2)

{
int iVar1;
undefined8 uVar2;
undefined4 local_res8;
int iStackX_c;

iVar1 = *(int *)(*(longlong *)(param_1 + 0x58) + 0xd8);
if ((*(uint *)(param_1 + 0x88) >> 0xe & 1) == 0) {
uVar2 = 0x8009030e;
if (iVar1 != -0x7ff6fcf2) {
_local_res8 = CONCAT44(iVar1,*(undefined4 *)(*(longlong *)(param_1 + 0x58) + 0xdc));

}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x72,&DAT_1800853e8);
}
uVar2 = 0x80090301;
}
return uVar2;
}
=========================================
Function at address: 0x180046538
Called functions addresses: 0xEXTERNAL:000000c2 0xEXTERNAL:0000011b 0x18002a7c0 0x180028070 0xEXTERNAL:000000c0


void FUN_180046538(longlong param_1,undefined8 param_2)

{
longlong lVar1;
int iVar2;
undefined8 uVar3;
undefined auStack_128 [32];
undefined *local_108;
undefined4 local_100;
undefined4 *local_f8;
undefined4 local_f0;
undefined4 local_e8 [4];
undefined local_d8 [192];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_128;
local_e8[0] = 0xc0;
RtlAcquireResourceShared(*(longlong *)(param_1 + 0x58) + 0x48,1);
lVar1 = *(longlong *)(*(longlong *)(param_1 + 0x58) + 0x10);
if (lVar1 == 0) {
RtlReleaseResource(*(longlong *)(param_1 + 0x58) + 0x48);
}
else {
local_f0 = *(undefined4 *)(param_1 + 0x150);
if (*(undefined8 **)(param_1 + 8) == (undefined8 *)0x0) {
uVar3 = 0;
}
else {
uVar3 = **(undefined8 **)(param_1 + 8);
}
local_f8 = local_e8;
local_100 = local_e8[0];
local_108 = local_d8;
iVar2 = SslComputeEapKeyBlock(uVar3,lVar1,param_1 + 0x110,0x40);
RtlReleaseResource(*(longlong *)(param_1 + 0x58) + 0x48);
if (iVar2 == 0) {

}
}
FUN_180028070(local_18 ^ (ulonglong)auStack_128);
return;
}
=========================================
Function at address: 0x180046670
Called functions addresses: 0x18000909c 0x18000a1f4 0x18002a7c0 0xEXTERNAL:000000c7


undefined8 FUN_180046670(longlong param_1,undefined8 param_2)

{
uint uVar1;
undefined uVar2;
undefined uVar3;
char cVar4;
int iVar5;
undefined *puVar6;
uint *puVar7;
undefined8 uVar8;
ulonglong uVar9;
undefined *puVar10;
longlong lVar11;
uint uVar12;
undefined *puVar13;
uint *puVar14;
ulonglong uVar15;
longlong *plVar16;
int iVar17;
uint uVar18;
longlong local_res18;
undefined4 local_res20;
int local_res24;
longlong local_68;
int local_60;
undefined local_58 [8];
uint local_50;

local_res18 = 0;
uVar15 = 0;
iVar17 = 0;

if (cVar4 == '\0') {
return 0x54f;
}
local_60 = 0;
uVar18 = local_50 & 0x40;
local_68 = 0;
lVar11 = *(longlong *)(param_1 + 0x380);
if ((lVar11 != 0) && (2 < *(uint *)(param_1 + 0x378))) {
puVar13 = (undefined *)(lVar11 + 2);
uVar1 = *(uint *)(param_1 + 0x378) - 2;
puVar6 = (undefined *)(lVar11 + 3);
puVar10 = puVar13;
while (iVar17 = (int)uVar15, puVar6 < puVar13 + uVar1) {
puVar10 = puVar10 + (ulonglong)CONCAT11(*puVar10,*puVar6) + 2;
uVar15 = (ulonglong)(iVar17 + 1);
puVar6 = puVar10 + 1;
}
uVar12 = ((-(uint)(uVar18 != 0) & 0xfffffff8) + 0x10) * iVar17;
puVar7 = (uint *)FUN_18000a1f4((ulonglong)uVar12);
if (puVar7 == (uint *)0x0) {
return 0x80090300;
}

if (iVar5 < 0) {
FUN_18000909c(puVar7);
goto LAB_180046791;
}

(0,uVar1,(ulonglong)uVar12 + local_res18,puVar13);
if (iVar5 < 0) {
FUN_18000909c(puVar7);

goto LAB_180046791;
}
lVar11 = (ulonglong)uVar12 + local_res18;
if (iVar17 != 0) {
puVar14 = puVar7;
if (uVar18 == 0) {
do {
uVar2 = *puVar13;
uVar3 = puVar13[1];
*puVar14 = (uint)CONCAT11(uVar2,uVar3);
uVar9 = (ulonglong)(CONCAT11(uVar2,uVar3) + 2);
puVar13 = puVar13 + uVar9;
*(longlong *)(puVar14 + 2) = lVar11 + 2;
lVar11 = lVar11 + uVar9;
puVar14 = puVar14 + 4;
uVar15 = uVar15 - 1;
} while (uVar15 != 0);
}
else {
do {
uVar2 = *puVar13;
uVar3 = puVar13[1];
*puVar14 = (uint)CONCAT11(uVar2,uVar3);
uVar9 = (ulonglong)(CONCAT11(uVar2,uVar3) + 2);
puVar13 = puVar13 + uVar9;
puVar14[1] = (int)lVar11 + 2;
lVar11 = lVar11 + uVar9;
puVar14 = puVar14 + 2;
uVar15 = uVar15 - 1;
} while (uVar15 != 0);
}
}

if (iVar5 < 0) {
FUN_18000909c(puVar7);

goto LAB_180046791;
}
FUN_18000909c(puVar7);
}
if (uVar18 == 0) {
local_68 = local_res18;
plVar16 = &local_68;
uVar8 = 0x10;
local_60 = iVar17;
}
else {
local_res20 = (undefined4)local_res18;
plVar16 = (longlong *)&local_res20;
uVar8 = 8;
local_res24 = iVar17;
}

if (-1 < iVar5) {
return 0;
}
if (local_res18 != 0) {

}
LAB_180046791:
uVar8 = RtlNtStatusToDosError(iVar5);
return uVar8;
}
=========================================
Function at address: 0x180046990
Called functions addresses: 0xEXTERNAL:000000c2 0x180046a38 0xEXTERNAL:000000c0


int FUN_180046990(longlong param_1,longlong param_2)

{
int iVar1;
longlong lVar2;
longlong lVar3;

lVar3 = 0;
if (*(longlong *)(param_1 + 0x58) == 0) {
iVar1 = -0x7ff6fcff;
}
else {
RtlAcquireResourceShared(*(longlong *)(param_1 + 0x58) + 0x48,1);
lVar2 = *(longlong *)(param_1 + 0x58);
if (*(longlong *)(lVar2 + 0x10) == 0) {
iVar1 = -0x7ff6fcff;
}
else {
if (*(longlong **)(param_1 + 8) != (longlong *)0x0) {
lVar3 = **(longlong **)(param_1 + 8);
}
iVar1 = FUN_180046a38(param_1,lVar3,*(longlong *)(lVar2 + 0x10),param_1 + 0x110,0x40,param_2);
lVar2 = *(longlong *)(param_1 + 0x58);
}
RtlReleaseResource(lVar2 + 0x48);
}
return iVar1;
}
=========================================
Function at address: 0x180046a38
Called functions addresses: 0x18000909c 0x18000a1f4 0x18002a7c0 0x180041cb0 0xEXTERNAL:000000c7 0xEXTERNAL:0000011a


int FUN_180046a38(longlong param_1,longlong param_2,longlong param_3,undefined8 param_4,
undefined4 param_5,longlong param_6)

{
uint uVar1;
longlong lVar2;
ulonglong uVar3;
ulonglong uVar4;
char cVar5;
undefined *puVar6;
ulonglong uVar7;
int iVar8;
undefined *puVar9;
longlong local_58;
undefined8 local_50;
longlong lStack_48;
undefined8 local_40;
ulonglong uStack_38;
undefined8 local_30;

puVar6 = (undefined *)0x0;
local_30 = 0;
local_58 = 0;
local_50 = 0;
lStack_48 = 0;
uVar7 = 0;
local_40 = 0;
uStack_38 = 0;

if (cVar5 == '\0') {
iVar8 = 0x54f;
}
else {
uVar3 = uStack_38 & 0x40;
uVar4 = uStack_38 & 0x40;
if (param_6 == 0) {
iVar8 = 0x57;
}
else {
if ((param_2 != 0) && (*(longlong *)(param_1 + 0x348) != 0)) {
if (param_3 != 0) {
uVar1 = *(uint *)(*(longlong *)(param_1 + 0x348) + 0x20);
uVar7 = (ulonglong)uVar1;
puVar6 = (undefined *)FUN_18000a1f4(uVar7);
if (puVar6 == (undefined *)0x0) {
iVar8 = 0xe;
}
else {
lVar2 = *(longlong *)(param_1 + 0x348);
iVar8 = SslExportKeyingMaterial
(param_2,param_3,*(undefined8 *)(lVar2 + 8),param_4,param_5,
*(undefined8 *)(lVar2 + 0x18),*(undefined2 *)(lVar2 + 0x10),puVar6,
uVar1,0);
if (iVar8 == 0) {

if ((iVar8 < 0) ||

iVar8 < 0)) {
LAB_180046c7b:
iVar8 = RtlNtStatusToDosError(iVar8);
}
else {
if (uVar4 == 0) {
lStack_48 = local_58;
}
else {
local_50._4_4_ = (undefined4)local_58;
}
local_50 = CONCAT44(local_50._4_4_,uVar1);

(0,(-(uint)(uVar3 != 0) & 0xfffffff8) + 0x10,param_6,&local_50);
if (iVar8 < 0) goto LAB_180046c7b;
}
puVar9 = puVar6;
if (iVar8 == 0) goto code_r0x000180046b4c;
}
}
goto LAB_180046b1a;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x12,&DAT_180085110);
}
}
iVar8 = -0x7ff6fcff;
}
}
LAB_180046b1a:
if (local_58 != 0) {

}
puVar9 = puVar6;
if (puVar6 == (undefined *)0x0) {
return iVar8;
}
code_r0x000180046b4c:
for (; uVar7 != 0; uVar7 = uVar7 - 1) {
*puVar6 = 0;
puVar6 = puVar6 + 1;
}
FUN_18000909c(puVar9);
return iVar8;
}
=========================================
Function at address: 0x180046ca0
Called functions addresses: 0xEXTERNAL:00000139 0x18002a7c0 0xEXTERNAL:000000c7


undefined8 FUN_180046ca0(longlong *param_1,undefined8 param_2)

{
longlong lVar1;
DWORD DVar2;
int iVar3;
longlong lVar4;
undefined8 uVar5;
longlong local_res8;
ulonglong local_28;
longlong lStack_20;
undefined8 local_18;
ulonglong uStack_10;

local_res8 = 0;
local_28 = 0;
lStack_20 = 0;
local_18 = 0;
uStack_10 = 0;

if (lVar4 != 0) {
lVar1 = *(longlong *)(lVar4 + 0x20);
if (lVar1 != 0) {
lStack_20 = *(longlong *)(lVar1 + 8);
uStack_10 = uStack_10 & 0xffffffff00000000;
local_28 = CONCAT44(local_28._4_4_,*(undefined4 *)(lVar1 + 0x10));
local_18 = CONCAT44(local_18._4_4_ | 1,1);
if (*(longlong **)(lVar4 + 0x1b0) != (longlong *)0x0) {
lVar4 = **(longlong **)(lVar4 + 0x1b0);
if (lVar4 == -8) {
DVar2 = CertGetPublicKeyLength
(1,(PCERT_PUBLIC_KEY_INFO)(*(longlong *)(lVar1 + 0x18) + 0x60));
}
else {
DVar2 = *(DWORD *)(lVar4 + 0xc);
}
uStack_10 = CONCAT44(uStack_10._4_4_,DVar2);
}
}
}
if (lStack_20 == 0) {
LAB_180046de2:

if (-1 < iVar3) {
return 0;
}
}
else {

if (iVar3 < 0) goto LAB_180046d76;

(0,local_28 & 0xffffffff,local_res8,lStack_20);
if (-1 < iVar3) {
lStack_20 = local_res8;
goto LAB_180046de2;
}
}

LAB_180046d76:
uVar5 = RtlNtStatusToDosError(iVar3);
return uVar5;
}
=========================================
Function at address: 0x180046e2c
Called functions addresses: 0x18002a7c0 0x180041cb0


undefined4 FUN_180046e2c(longlong param_1,undefined8 param_2)

{
undefined4 uVar1;
uint local_res8 [8];

uVar1 = 0x54f;
local_res8[0] = (uint)*(ushort *)(param_1 + 0xd8);
if (*(char *)(param_1 + 0xe9) == '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180085110);
}
}
else {

}
return uVar1;
}
=========================================
Function at address: 0x180046eb8
Called functions addresses: 0x18002a7c0 0xEXTERNAL:000000c7


undefined4 FUN_180046eb8(longlong param_1,undefined8 param_2)

{
ushort uVar1;
char cVar2;
int iVar3;
undefined4 unaff_EBX;
uint uVar4;
undefined8 *puVar5;
longlong local_res18;
undefined8 local_res20;
undefined8 local_58;
longlong lStack_50;
undefined local_48 [8];
uint local_40;

local_res20 = 0;
local_58 = 0;
lStack_50 = 0;
local_res18 = 0;

if (cVar2 == '\0') {
return unaff_EBX;
}
uVar4 = local_40 & 0x40;
if ((*(uint *)(param_1 + 0x40) & 0x82800) == 0) {
return unaff_EBX;
}
uVar1 = *(ushort *)(param_1 + 0x1fe);
if (uVar1 == 0) {
LAB_180046fb0:
if (uVar4 == 0) {
lStack_50 = local_res18;
local_58 = CONCAT62(local_58._2_6_,uVar1);
}
else {
local_res20 = CONCAT44((undefined4)local_res18,(undefined4)local_res20);
local_res20 = CONCAT62(local_res20._2_6_,uVar1);
}
puVar5 = &local_res20;
if (uVar4 == 0) {
puVar5 = &local_58;
}

(0,(-(uint)(uVar4 != 0) & 0xfffffff8) + 0x10,param_2,puVar5);
if (-1 < iVar3) {
local_res18 = 0;
goto LAB_180047013;
}
}
else {

if ((-1 < iVar3) &&

(0,(uint)uVar1 * 2,local_res18,param_1 + 0x200), -1 < iVar3))
goto LAB_180046fb0;
}
RtlNtStatusToDosError(iVar3);
LAB_180047013:
if (local_res18 != 0) {

}
return unaff_EBX;
}
=========================================
Function at address: 0x18004705c
Called functions addresses: 0x18000909c 0x18004746c 0xEXTERNAL:000000bc 0xEXTERNAL:000000c0


int FUN_18004705c(longlong param_1,undefined8 param_2,uint param_3)

{
longlong lVar1;
int iVar2;
HLOCAL pvVar3;
uint local_res8 [2];
HLOCAL local_res20;

local_res20 = (HLOCAL)0x0;
local_res8[0] = 0;
if (*(longlong *)(param_1 + 0x58) == 0) {
iVar2 = -0x7ff6fcff;
}
else {
iVar2 = FUN_18004746c(param_2,param_3,&local_res20,local_res8);
pvVar3 = local_res20;
if (iVar2 == 0) {
RtlAcquireResourceExclusive(*(longlong *)(param_1 + 0x58) + 0x48,1);
lVar1 = *(longlong *)(param_1 + 0x58);
if (*(HLOCAL *)(lVar1 + 0x38) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(lVar1 + 0x38));
}
*(HLOCAL *)(lVar1 + 0x38) = local_res20;
*(uint *)(lVar1 + 0x40) = local_res8[0];
iVar2 = 0;
RtlReleaseResource();
pvVar3 = (HLOCAL)0x0;
}
if (pvVar3 != (HLOCAL)0x0) {
FUN_18000909c(pvVar3);
}
}
return iVar2;
}
=========================================
Function at address: 0x180047118
Called functions addresses: 0x18000909c 0x18004746c


int FUN_180047118(longlong param_1,undefined8 param_2,uint param_3)

{
int iVar1;
uint local_res20 [2];
undefined4 *local_18 [2];

local_18[0] = (undefined4 *)0x0;
local_res20[0] = 0;
iVar1 = FUN_18004746c(param_2,param_3,local_18,local_res20);
if (iVar1 == 0) {
if (local_res20[0] == 4) {
*(undefined4 *)(param_1 + 0x150) = *local_18[0];
}
else {
iVar1 = 0x57;
}
}
if (local_18[0] != (undefined4 *)0x0) {
FUN_18000909c(local_18[0]);
}
return iVar1;
}
=========================================
Function at address: 0x18004718c
Called functions addresses: 0x18000909c 0x18000a1f4 0x1800475d8


int FUN_18004718c(longlong param_1,longlong param_2,uint param_3)

{
ushort *puVar1;
HLOCAL pvVar2;
int iVar3;

puVar1 = (ushort *)FUN_18000a1f4(0x28);
if (puVar1 == (ushort *)0x0) {
iVar3 = 0xe;
}
else {
iVar3 = FUN_1800475d8(param_2,param_3,puVar1);
if (iVar3 == 0) {
pvVar2 = *(HLOCAL *)(param_1 + 0x348);
if (pvVar2 != (HLOCAL)0x0) {
if (*(HLOCAL *)((longlong)pvVar2 + 8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)pvVar2 + 8));
pvVar2 = *(HLOCAL *)(param_1 + 0x348);
}
if (*(HLOCAL *)((longlong)pvVar2 + 0x18) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)pvVar2 + 0x18));
pvVar2 = *(HLOCAL *)(param_1 + 0x348);
}
FUN_18000909c(pvVar2);
}
*(ushort **)(param_1 + 0x348) = puVar1;
}
else {
FUN_18000909c(puVar1);
}
}
return iVar3;
}
=========================================
Function at address: 0x180047244
Called functions addresses: 0x18005b628 0x180041cb0 0x18002a7c0 0x180041794


int FUN_180047244(longlong param_1,undefined8 param_2,int param_3)

{
short sVar1;
int iVar2;
longlong lVar3;
undefined2 uVar4;
int local_res8 [2];

if (*(char *)(param_1 + 0xe9) == '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180085110);
}
iVar2 = 0x54f;
}
else {
if (param_3 == 4) {

if (iVar2 < 0) {
return iVar2;
}
uVar4 = (undefined2)local_res8[0];
if ((local_res8[0] - 200U < 0xff39) &&
(lVar3 = param_1, sVar1 = FUN_18005b628(param_1,local_res8[0]), sVar1 != 0)) {
*(undefined2 *)(param_1 + 0xd8) = uVar4;
*(short *)(param_1 + 0xda) = sVar1;
if ((*(int *)(param_1 + 0x44) == 4) && (iVar2 = FUN_180041794(lVar3), iVar2 != 0)) {
return iVar2;
}
return 0;
}
}
iVar2 = 0x57;
}
return iVar2;
}
=========================================
Function at address: 0x180047320
Called functions addresses: 0x180041cdc 0x18002a7c0 0x180028070


void FUN_180047320(longlong param_1,undefined8 param_2,int param_3)

{
char cVar1;
int iVar2;
undefined auStack_78 [56];
uint local_40;
ulonglong local_30;
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_78;
local_30 = 0;

if (cVar1 != '\0') {
if (param_3 == (-(uint)((local_40 & 0x40) != 0) & 0xfffffffc) + 8) {

if (iVar2 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_180085110,iVar2);
}
}
else if ((local_40 & 0x40) == 0) {
*(ulonglong *)(param_1 + 0x68) = local_30;
}
else {
*(ulonglong *)(param_1 + 0x68) = local_30 & 0xffffffff;
*(undefined4 *)(param_1 + 0x6c) = 0;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180085110,param_3);
}
}
FUN_180028070(local_28 ^ (ulonglong)auStack_78);
return;
}
=========================================
Function at address: 0x18004746c
Called functions addresses: 0x18000909c 0x18000a1f4 0x18002a7c0 0xEXTERNAL:000000c7


int FUN_18004746c(undefined8 param_1,uint param_2,undefined8 *param_3,uint *param_4)

{
char cVar1;
int iVar2;
HLOCAL pvVar3;
uint uVar4;
ulonglong uVar5;
undefined4 local_38;
uint uStack_34;
uint uStack_30;
undefined4 uStack_2c;
undefined local_28 [8];
uint local_20;

local_38 = 0;
uStack_34 = 0;
uStack_30 = 0;
uStack_2c = 0;

if (cVar1 == '\0') {
return 0x54f;
}
uVar4 = (-(uint)((local_20 & 0x40) != 0) & 0xfffffffc) + 0x10;
if (uVar4 <= param_2) {

uVar4 = uStack_34;
if (iVar2 < 0) {
iVar2 = RtlNtStatusToDosError(iVar2);
return iVar2;
}
uVar5 = CONCAT44(uStack_2c,uStack_30);
if ((local_20 & 0x40) != 0) {
uVar5 = (ulonglong)uStack_30;
}
if (((uStack_34 < 0x10001) && (uStack_34 != 0)) && (uVar5 != 0)) {
pvVar3 = (HLOCAL)FUN_18000a1f4((ulonglong)uStack_34);
if (pvVar3 == (HLOCAL)0x0) {
return 0xe;
}

if (iVar2 < 0) {
iVar2 = RtlNtStatusToDosError(iVar2);
}
else {
*param_3 = pvVar3;
*param_4 = uVar4;
}
if (iVar2 == 0) {
return 0;
}
FUN_18000909c(pvVar3);
return iVar2;
}
}
return 0x57;
}
=========================================
Function at address: 0x1800475d8
Called functions addresses: 0x18000909c 0x18000a1f4 0x18002a7c0 0xEXTERNAL:000000c7


int FUN_1800475d8(longlong param_1,uint param_2,ushort *param_3)

{
ushort uVar1;
ulonglong uVar2;
char cVar3;
int iVar4;
HLOCAL pvVar5;
HLOCAL pvVar6;
uint uVar7;
ulonglong uVar8;
ushort uVar9;
int iVar10;
ulonglong local_78;
undefined8 local_70;
ulonglong uStack_68;
undefined8 local_60;
ulonglong local_58;
ulonglong uStack_50;
undefined8 local_48;
ulonglong uStack_40;
undefined8 local_38;

pvVar6 = (HLOCAL)0x0;
local_38 = 0;
local_60 = 0;
local_58 = 0;
uStack_50 = 0;
local_48 = 0;
uStack_40 = 0;
local_70 = 0;
uStack_68 = 0;

if (cVar3 == '\0') {
return 0x54f;
}
uVar8 = uStack_68 & 0x40;
uVar7 = (-(uint)((uStack_68 & 0x40) != 0) & 0xffffffec) + 0x28;
if (((param_1 == 0) || (param_2 < uVar7)) || (param_3 == (ushort *)0x0)) {
return 0x57;
}

uVar2 = local_58;
pvVar5 = pvVar6;
if (iVar4 < 0) {
LAB_1800476ac:
iVar4 = RtlNtStatusToDosError(iVar4);
LAB_1800477e7:
if (iVar4 == 0) {
return 0;
}
if (pvVar5 == (HLOCAL)0x0) goto LAB_1800477f8;
}
else {
uVar1 = (ushort)local_58;
uVar7 = (uint)(ushort)local_58;
if (uVar8 == 0) {
local_78 = uStack_40;
uVar8 = uStack_50;
uVar9 = (ushort)local_48;
iVar10 = (int)local_38;
}
else {
local_78 = uStack_50 >> 0x20;
uVar8 = local_58 >> 0x20;
uVar9 = (ushort)uStack_50;
iVar10 = (int)local_48;
}
if (0x103 < (ushort)((ushort)local_58 - 1)) {
return 0x57;
}
if (uVar8 == 0) {
return 0x57;
}
if (iVar10 == 0) {
return 0x57;
}
pvVar5 = (HLOCAL)FUN_18000a1f4((ulonglong)uVar7);
if (pvVar5 == (HLOCAL)0x0) {
return 0xe;
}

if (iVar4 < 0) goto LAB_1800476ac;
if (*(char *)(((uVar2 & 0xffff) - 1) + (longlong)pvVar5) == '\0') {
if (uVar9 != 0) {
if (local_78 == 0) goto LAB_180047772;
pvVar6 = (HLOCAL)FUN_18000a1f4((ulonglong)uVar9);
if (pvVar6 != (HLOCAL)0x0) {

if (iVar4 < 0) goto LAB_1800476ac;
goto LAB_1800477d2;
}
iVar4 = 0xe;
goto LAB_1800477f0;
}
LAB_1800477d2:
*param_3 = uVar1;
*(HLOCAL *)(param_3 + 4) = pvVar5;
param_3[8] = uVar9;
*(HLOCAL *)(param_3 + 0xc) = pvVar6;
*(int *)(param_3 + 0x10) = iVar10;
goto LAB_1800477e7;
}
LAB_180047772:
iVar4 = 0x57;
}
LAB_1800477f0:
FUN_18000909c(pvVar5);
LAB_1800477f8:
if (pvVar6 != (HLOCAL)0x0) {
FUN_18000909c(pvVar6);
}
return iVar4;
}
=========================================
Function at address: 0x180047838
Called functions addresses: None


void FUN_180047838(short *param_1)

{
longlong lVar1;
short *psVar2;
short *psVar3;
ushort uVar4;

psVar2 = *(short **)(param_1 + 4);
uVar4 = 0;
if ((psVar2 != (short *)0x0) && (param_1[1] != 0)) {
psVar3 = psVar2;
if (param_1[1] != 2) {
do {
if (*psVar2 == 0) break;
*psVar3 = *psVar2;
if ((*psVar2 == 0xd) && (psVar2[1] == 10)) {
psVar2 = psVar2 + 1;
*psVar3 = 0x2c;
}
uVar4 = uVar4 + 2;
psVar3 = psVar3 + 1;
psVar2 = psVar2 + 1;
} while ((ulonglong)uVar4 < (ulonglong)(ushort)param_1[1] - 2);
}
*psVar3 = 0;
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (*(short *)(*(longlong *)(param_1 + 4) + lVar1 * 2) != 0);
*param_1 = (short)lVar1 * 2;
}
return;
}
=========================================
Function at address: 0x1800478d4
Called functions addresses: 0x180044f34 0x180028d90 0x1800449cc 0x180028070 0x180041d20 0xEXTERNAL:00000041 0x18004312c 0xEXTERNAL:00000047 0x180041cdc 0xEXTERNAL:00000145 0x180054de4 0x180001604 0x180041cb0 0xEXTERNAL:00000146


void FUN_1800478d4(longlong param_1,PCCERT_CONTEXT param_2,longlong param_3,uint param_4,
uint *param_5,int *param_6,undefined8 *param_7)

{
int iVar1;
BOOL BVar2;
DWORD DVar3;
uint uVar4;
uint uVar5;
_CERT_CHAIN_PARA *_Dst;
undefined8 uVar6;
undefined8 uVar7;
HCERTSTORE hAdditionalStore;
undefined auStackY_118 [32];
PCCERT_CHAIN_CONTEXT local_d0;
int local_c8;
uint local_c4;
char *local_c0;
_CERT_CHAIN_PARA local_b8;
undefined4 local_80;
undefined4 local_7c;
undefined4 local_78;
undefined8 local_58 [2];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_118;
local_d0 = (PCCERT_CHAIN_CONTEXT)0x0;
local_c8 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180085178);
}
*param_5 = 0;
*param_6 = 0;
if (param_7 != (undefined8 *)0x0) {
*param_7 = 0;
}
uVar4 = (param_4 & 0x1000000) << 4;
uVar5 = uVar4 | 0x20000000;
if ((param_4 & 0x2000000) == 0) {
uVar5 = uVar4;
}
uVar4 = uVar5 | 0x40000000;
if ((param_4 & 0x4000000) == 0) {
uVar4 = uVar5;
}
uVar5 = param_4 >> 0x10 & 0x800;
local_c4 = uVar5 | 0x1000;
if ((param_4 & 0x10000000) == 0) {
local_c4 = uVar5;
}
uVar5 = uVar4 | 4;
if ((param_4 & 0x200000) == 0) {
uVar5 = uVar4;
}
DVar3 = uVar5 | 0x80000000;
if ((param_4 & 0x400000) == 0) {
DVar3 = uVar5;
}
iVar1 = FUN_180001604(param_3,&local_c8);
if (iVar1 != 0) goto LAB_180047b36;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041d20(DAT_180091000[2],0x20,&DAT_180085178,DVar3,(char)param_4);
}
_Dst = &local_b8;
local_c0 = "1.3.6.1.5.5.7.3.2";
uVar6 = 0x60;
memset(_Dst,0,0x60);
local_b8.cbSize = 0x60;
local_b8.RequestedUsage.dwType = 1;
local_b8.RequestedUsage.Usage.rgpszUsageIdentifier = &local_c0;
local_b8.RequestedUsage.Usage.cUsageIdentifier = 1;
if ((param_1 != 0) &&
(_Dst = *(_CERT_CHAIN_PARA **)(param_1 + 0x350), _Dst != (_CERT_CHAIN_PARA *)0x0)) {
local_80 = *(undefined4 *)&(_Dst->RequestedUsage).Usage.field_0x4;
local_7c = *(undefined4 *)&(_Dst->RequestedUsage).Usage.rgpszUsageIdentifier;
local_78 = *(undefined4 *)((longlong)&(_Dst->RequestedUsage).Usage.rgpszUsageIdentifier + 4);
if (_Dst[1].cbSize == 1) {
local_b8.RequestedUsage.dwType = 0;
local_b8.RequestedUsage.Usage.cUsageIdentifier = 0;
local_b8.RequestedUsage.Usage.rgpszUsageIdentifier = (char **)0x0;
}
}
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_18004312c(_Dst,&DAT_180084c90,uVar6,1,local_58);
}
hAdditionalStore = param_2->hCertStore;
uVar7 = 0;
uVar6 = 0;
BVar2 = CertGetCertificateChain
((HCERTCHAINENGINE)0x0,param_2,(LPFILETIME)0x0,hAdditionalStore,&local_b8,DVar3,
(LPVOID)0x0,&local_d0);
if (BVar2 == 0) {
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_18004312c(uVar6,&DAT_180084c80,uVar7,1,local_58);
}
DVar3 = GetLastError();
if (DVar3 != 0) goto LAB_180047b36;
}
else {
if (((byte)DAT_180092f00 & 1) != 0) {
hAdditionalStore = (HCERTSTORE)0x1;
FUN_18004312c(uVar6,&DAT_180084c80,uVar7,1,local_58);
}
uVar5 = local_c4;
if ((param_4 >> 0x17 & 1) == 0) {
iVar1 = FUN_180054de4(local_d0,(LPCSTR)0x4,(ulonglong)local_c4,hAdditionalStore);
if (iVar1 == 0) {
*param_5 = *param_5 | 0x60;
iVar1 = FUN_180054de4(local_d0,(LPCSTR)0x6,(ulonglong)uVar5,hAdditionalStore);
if (iVar1 == 0) {
*param_5 = *param_5 | 0x10;
goto LAB_180047cbc;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x23,&DAT_180085178,iVar1);
}
FUN_180044f34(*(uint *)(param_1 + 0xd4));
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x22,&DAT_180085178,iVar1);
}
FUN_1800449cc(*(uint *)(param_1 + 0xd4));
}
*param_6 = iVar1;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x21,&DAT_180085178);
}
*param_5 = *param_5 | 0x70;
}
}
LAB_180047cbc:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x24,&DAT_180085178,*param_5);
}
if (param_7 != (undefined8 *)0x0) {
*param_7 = local_d0;
local_d0 = (PCCERT_CHAIN_CONTEXT)0x0;
}
LAB_180047b36:
if (local_d0 != (PCCERT_CHAIN_CONTEXT)0x0) {
CertFreeCertificateChain(local_d0);
}
if (local_c8 != 0) {
RevertToSelf();
}
FUN_180028070(local_48 ^ (ulonglong)auStackY_118);
return;
}
=========================================
Function at address: 0x180047d14
Called functions addresses: 0xEXTERNAL:0000003f 0xEXTERNAL:00000147 0x18002a77b


undefined8 FUN_180047d14(longlong param_1,uint param_2,undefined8 *param_3,uint *param_4)

{
longlong lVar1;
longlong lVar2;
DWORD *pDVar3;
int iVar4;
BOOL BVar5;
undefined4 *puVar6;
undefined8 uVar7;
uint uVar8;
uint uVar9;
ulonglong uVar10;
ulonglong uVar11;
undefined4 *puVar12;

lVar1 = **(longlong **)(param_1 + 0x10);
lVar2 = *(longlong *)(**(longlong **)(lVar1 + 0x10) + 8);
uVar8 = *(int *)(lVar2 + 0x10) + 0x20;
if (uVar8 < 0x20) {
uVar7 = 0x216;
}
else {
uVar10 = 0;
uVar11 = 0;
if (*(int *)(lVar1 + 0xc) != 0) {
do {
pDVar3 = *(DWORD **)(*(longlong *)(*(longlong *)(lVar1 + 0x10) + uVar11 * 8) + 8);
uVar9 = uVar8;
if ((int)uVar11 != 0) {
BVar5 = CertCompareCertificateName
(*pDVar3,(PCERT_NAME_BLOB)(*(longlong *)(pDVar3 + 6) + 0x30),
(PCERT_NAME_BLOB)(*(longlong *)(pDVar3 + 6) + 0x50));
if (BVar5 != 0) break;
uVar9 = uVar8 + 8;
}
uVar8 = *(int *)(*(longlong *)(pDVar3 + 6) + 0x30) + uVar9;
if (uVar8 < uVar9) {
return 0xc0000095;
}
uVar10 = (ulonglong)((int)uVar10 + 1);
uVar9 = (int)uVar11 + 1;
uVar11 = (ulonglong)uVar9;
} while (uVar9 < *(uint *)(lVar1 + 0xc));
}
uVar8 = uVar8 + 3 & 0xfffffffc;
puVar6 = (undefined4 *)LocalAlloc(0x40,(ulonglong)uVar8);
if (puVar6 == (undefined4 *)0x0) {
uVar7 = 0x80090300;
}
else {
*puVar6 = 2;
iVar4 = (int)uVar10;
uVar9 = iVar4 * 8 + 0x18;
puVar6[2] = uVar9;
puVar6[1] = uVar8;
puVar6[3] = *(undefined4 *)(lVar2 + 0x10);
puVar6[4] = param_2 | 0x80;
memcpy((void *)((ulonglong)uVar9 + (longlong)puVar6),*(void **)(lVar2 + 8),
(ulonglong)*(uint *)(lVar2 + 0x10));
uVar9 = uVar9 + *(int *)(lVar2 + 0x10);
puVar6[5] = iVar4;
if (iVar4 != 0) {
puVar12 = puVar6 + 7;
do {
lVar2 = *(longlong *)
(*(longlong *)
((longlong)puVar12 + *(longlong *)(lVar1 + 0x10) + (-0x1c - (longlong)puVar6))
+ 8);
puVar12[-1] = uVar9;
*puVar12 = *(undefined4 *)(*(longlong *)(lVar2 + 0x18) + 0x30);
memcpy((void *)((ulonglong)uVar9 + (longlong)puVar6),
*(void **)(*(longlong *)(lVar2 + 0x18) + 0x38),
(ulonglong)*(uint *)(*(longlong *)(lVar2 + 0x18) + 0x30));
puVar12 = puVar12 + 2;
uVar9 = uVar9 + *(int *)(*(longlong *)(lVar2 + 0x18) + 0x30);
uVar10 = uVar10 - 1;
} while (uVar10 != 0);
}
*param_3 = puVar6;
*param_4 = uVar8;
uVar7 = 0;
}
}
return uVar7;
}
=========================================
Function at address: 0x180047eb0
Called functions addresses: 0xEXTERNAL:0000003f 0xEXTERNAL:0000017a 0xEXTERNAL:000000c8 0x18002a77b 0x180029bc4 0xEXTERNAL:00000040 0xEXTERNAL:00000186


int FUN_180047eb0(undefined4 param_1,undefined8 param_2,ushort *param_3,ushort *param_4,
undefined4 param_5,undefined4 *param_6,undefined8 *param_7,undefined8 param_8)

{
char cVar1;
ushort uVar2;
int iVar3;
HLOCAL _Dst;
ushort uVar4;
int iVar5;
ushort *puVar6;
undefined4 local_64;
undefined4 local_60;
undefined4 uStack_5c;
undefined8 uStack_58;
undefined4 local_50;
undefined4 uStack_4c;
HLOCAL pvStack_48;
ushort local_40;
undefined auStack_3e [6];
HLOCAL pvStack_38;

iVar5 = 0;
_local_40 = 0;
pvStack_38 = (HLOCAL)0x0;
cVar1 = SampUsingDsData();
if (cVar1 == '\0') {
iVar5 = -0x7ff6fcfe;
}
else if (((param_4 == (ushort *)0x0) || (param_3 == (ushort *)0x0)) ||
((uVar4 = *param_3 + *param_4, *param_3 <= uVar4 && (uVar4 <= (ushort)(uVar4 + 4))))) {
uStack_58 = LocalAlloc(0x40,0x410);
pvStack_48 = LocalAlloc(0x40,0x208);
if ((uStack_58 == (HLOCAL)0x0) || (pvStack_48 == (HLOCAL)0x0)) {
iVar5 = -0x7ff6fd00;
}
else {
local_60 = 0x4100000;
local_50 = 0x2080000;
param_5 = 0x208;
local_64 = 0x104;
_Dst = pvStack_38;
puVar6 = param_3;
if (param_4 != (ushort *)0x0) {
uVar4 = *param_3 + *param_4 + 4;
uVar2 = *param_3 + *param_4 + 2;
_local_40 = CONCAT62(CONCAT42(auStack_3e._2_4_,uVar4),uVar2);
_Dst = LocalAlloc(0x40,(ulonglong)uVar4);
puVar6 = (ushort *)0x0;
pvStack_38 = _Dst;
if (_Dst != (HLOCAL)0x0) {
memcpy(_Dst,*(void **)(param_4 + 4),(ulonglong)*param_4);
*(undefined2 *)((longlong)_Dst + (ulonglong)(*param_4 >> 1) * 2) = 0x3a;
memcpy((void *)((longlong)_Dst + ((ulonglong)(*param_4 >> 1) + 1) * 2),
*(void **)(param_3 + 4),(ulonglong)*param_3);
*(undefined2 *)((longlong)_Dst + (ulonglong)(uVar2 >> 1) * 2) = 0;
puVar6 = &local_40;
}
}
if (puVar6 != (ushort *)0x0) {
cVar1 = FUN_180029bc4();
if (cVar1 == '\0') {
iVar5 = -0x3fffff45;
}
else {
iVar3 = CrackSingleName(param_1,4,*(undefined8 *)(puVar6 + 4),2,&local_64,pvStack_48,
&param_5,uStack_58,param_8);
if (iVar3 == 0) {
RtlInitUnicodeString(&local_50,pvStack_48);
RtlInitUnicodeString(&local_60,uStack_58);
*param_6 = local_60;
param_6[1] = uStack_5c;
param_6[2] = (undefined4)uStack_58;
param_6[3] = uStack_58._4_4_;
*param_7 = CONCAT44(uStack_4c,local_50);
param_7[1] = pvStack_48;
}
else {
iVar5 = -0x3fffffff;
}
}
if (_Dst != (HLOCAL)0x0) {
LocalFree(_Dst);
}
}
}
if (iVar5 < 0) {
if (uStack_58 != (HLOCAL)0x0) {
LocalFree(uStack_58);
}
if (pvStack_48 != (HLOCAL)0x0) {
LocalFree(pvStack_48);
}
}
}
else {
iVar5 = -0x7ff6fd00;
}
return iVar5;
}
=========================================
Function at address: 0x1800481b0
Called functions addresses: 0x18002a7c0 0x1800534dc 0x180028070


void FUN_1800481b0(undefined8 param_1,undefined8 param_2,undefined *param_3,undefined8 *param_4,
undefined8 *param_5)

{
int iVar1;
undefined auStack_128 [32];
undefined8 local_108;
undefined *local_100;
HANDLE *local_f8;
undefined8 *local_f0;
undefined8 *local_e8;
undefined8 *local_e0;
undefined8 local_c8;
HANDLE local_c0;
undefined8 local_b8;
undefined8 local_b0;
longlong local_a8;
undefined local_98 [80];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStack_128;
local_a8 = 0;
local_e0 = &local_b8;
local_e8 = &local_b0;
local_f0 = &local_c8;
local_f8 = &local_c0;
local_108 = CONCAT44(local_108._4_4_,3);
local_100 = param_3;

if (iVar1 < 0) {
local_e8 = &local_c8;
local_f0 = (undefined8 *)&DAT_180092638;
local_f8 = (HANDLE *)CONCAT44(local_f8._4_4_,3);
local_100 = (undefined *)0x0;
local_108 = 0;

}
else {
iVar1 = FUN_1800534dc(local_c0,local_98);
if (iVar1 != 0) {
local_e0 = &local_c8;
local_e8 = (undefined8 *)&DAT_180092638;
local_100 = local_98;
local_f0 = (undefined8 *)CONCAT44(local_f0._4_4_,2);
local_f8 = (HANDLE *)CONCAT44(local_f8._4_4_,3);
local_108 = 0;

}
*param_5 = local_c0;
*param_4 = local_c8;
if (local_a8 != 0) {

}
}
FUN_180028070(local_48 ^ (ulonglong)auStack_128);
return;
}
=========================================
Function at address: 0x18004835c
Called functions addresses: 0xEXTERNAL:00000032 0xEXTERNAL:000000c8 0x1800499fc 0x1800494f8 0xEXTERNAL:000000c0 0x180041d70 0xEXTERNAL:000000c2 0x180041cdc 0x18002a77b 0x18002a7c0 0x180041cb0 0xEXTERNAL:00000061 0xEXTERNAL:000000b6


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined8
FUN_18004835c(undefined8 param_1,void *param_2,ulonglong param_3,uint param_4,undefined8 *param_5,
undefined4 *param_6,int *param_7)

{
uint uVar1;
longlong lVar2;
bool bVar3;
wchar_t *_Str;
char cVar4;
int iVar5;
undefined4 *puVar6;
wchar_t *pwVar7;
undefined8 uVar8;
void *pvVar9;
void *pvVar10;
void *pvVar11;
void *pvVar12;
undefined8 local_res8;
void *local_res10;
ulonglong local_res18;
void *local_88;
void *local_80;
wchar_t *local_78;
void *local_70;
undefined8 local_68;
undefined8 uStack_60;
undefined local_58 [8];
byte local_50;

pvVar9 = (void *)0x0;
local_res10 = (void *)0x0;
bVar3 = false;
pvVar10 = (void *)0x0;
local_70 = (void *)0x0;
pvVar12 = (void *)0x0;
local_80 = (void *)0x0;
local_78 = (wchar_t *)0x0;
local_68 = 0;
uStack_60 = (void *)0x0;
local_88 = (void *)0x0;
local_res8 = param_1;
local_res18 = param_3;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x33,&DAT_180085178);
}
if (param_5 != (undefined8 *)0x0) {
*param_5 = 0;
}
iVar5 = FUN_1800499fc((longlong)param_2,param_4,&local_res10,&local_res18,(longlong *)&local_78);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x34,&DAT_180085178,iVar5);
}
_Str = local_78;
pvVar11 = local_res10;
if ((iVar5 < 0) && (pvVar11 = pvVar9, local_78 != (wchar_t *)0x0)) {
RtlInitUnicodeString(&local_68,local_78);
RtlAcquireResourceShared(&DAT_180092e40,1);
cVar4 = RtlEqualUnicodeString(&local_68,&DAT_180092e30,1);
if ((cVar4 != '\0') ||
(cVar4 = RtlEqualUnicodeString(&local_68,&DAT_180092e20,1), cVar4 != '\0')) {
bVar3 = true;
}
RtlReleaseResource(&DAT_180092e40);
if (bVar3) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x35,&DAT_180085178);
}
iVar5 = -0x3fffff93;
pvVar10 = pvVar9;
pvVar12 = pvVar9;
}
else {

if ((cVar4 == '\0') || ((local_50 & 8) == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041d70(DAT_180091000[2],0x37,&DAT_180085178,_Str);
}
iVar5 = FUN_1800494f8((ushort *)&local_68,param_2,*(uint *)((longlong)param_2 + 4),1,0,
&local_res10,(uint *)&local_res18,(longlong *)&local_88);
pvVar12 = local_88;
if (-1 < iVar5) {
lVar2 = *(longlong *)((longlong)local_88 + 0x10);
local_70 = local_res10;
pwVar7 = wcschr(_Str,L'.');
if (pwVar7 != (wchar_t *)0x0) {
*pwVar7 = L'\0';
RtlInitUnicodeString(&local_68,_Str);
}
if ((0x20 < (uint)(*(int *)(lVar2 + 4) - *(int *)(lVar2 + 0xc))) &&
(*(uint *)(lVar2 + 0x18) < 0x10000)) {
local_68._0_4_ = CONCAT22(*(undefined2 *)(lVar2 + 0x18),*(undefined2 *)(lVar2 + 0x18));
uStack_60 = (void *)((ulonglong)*(uint *)(lVar2 + 0x14) + lVar2);
goto LAB_18004844c;
}
goto LAB_180048454;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x36,&DAT_180085178);
}
}
LAB_180048610:
*param_6 = 0;
*param_7 = iVar5;
}
else {
local_68 = CONCAT44(uRam0000000180092e24,_DAT_180092e20);
uStack_60 = (void *)CONCAT44(uRam0000000180092e2c,uRam0000000180092e28);
pvVar12 = pvVar9;
LAB_18004844c:
pvVar9 = pvVar11;
pvVar10 = pvVar11;
if (iVar5 < 0) goto LAB_180048610;
LAB_180048454:

(local_res10,local_res18 & 0xffffffff,0,&local_80,&local_res8);
pvVar10 = pvVar9;
if (iVar5 < 0) goto LAB_180048610;
local_res10 = local_80;
local_res18 = CONCAT44(local_res18._4_4_,(int)local_res8);
uVar1 = (int)local_res8 + 0x20;
if (uVar1 < 0x20) {
LAB_18004884d:
uVar8 = 0xc0000095;
goto LAB_18004861e;
}
if ((ushort)local_68 + uVar1 < uVar1) goto LAB_18004884d;
puVar6 = (undefined4 *)VirtualAlloc((LPVOID)0x0,(ulonglong)((ushort)local_68 + uVar1),0x1000,4);
if (puVar6 == (undefined4 *)0x0) {
uVar8 = 0xc0000017;
goto LAB_18004861e;
}
*puVar6 = 2;
puVar6[2] = 0x20;
puVar6[1] = (uint)(ushort)local_68 + (int)local_res18 + 0x20;
puVar6[3] = (int)local_res18;
memcpy(puVar6 + 8,local_res10,local_res18 & 0xffffffff);
puVar6[5] = (int)local_res18 + 0x20U;
puVar6[6] = (uint)(ushort)local_68;
memcpy((void *)((ulonglong)((int)local_res18 + 0x20U) + (longlong)puVar6),uStack_60,
local_68 & 0xffff);
*param_5 = puVar6;
*param_6 = puVar6[1];
*param_7 = 0;
}
uVar8 = 0;
pvVar9 = pvVar10;
LAB_18004861e:
if (pvVar12 != (void *)0x0) {

}
if (pvVar9 != (void *)0x0) {

}
if (local_70 != (void *)0x0) {

}
if (local_80 != (void *)0x0) {

}
if (_Str != (wchar_t *)0x0) {

}
return uVar8;
}
=========================================
Function at address: 0x180048860
Called functions addresses: 0xEXTERNAL:00000188 0x180041cdc 0x180027498 0x180041cb0 0xEXTERNAL:000000bc 0x18004bcec 0xEXTERNAL:000000c0 0xEXTERNAL:00000189 0x180041d70


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180048860(int param_1)

{
wchar_t *pwVar1;
char cVar2;
int iVar3;
undefined8 uVar4;
longlong local_res10 [3];
undefined8 local_18;
undefined8 uStack_10;

if (param_1 == 4) {
local_res10[0] = 0;
local_18 = 0;
uStack_10 = (wchar_t *)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x58,&DAT_180085178);
}
iVar3 = LsaIQueryInformationPolicyTrusted(0xc,local_res10);
if (iVar3 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x59,&DAT_180085178,iVar3);
}
}
else {
uVar4 = FUN_180027498((ushort *)&local_18,(ushort *)(local_res10[0] + 0x10));
if (-1 < (int)uVar4) {
cVar2 = RtlAcquireResourceExclusive(&DAT_180092e40,1);
if (cVar2 == '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x5a,&DAT_180085178);
}
}
else {
FUN_18004bcec((undefined8 *)&DAT_180092e30);
pwVar1 = uStack_10;
DAT_180092e38._0_4_ = (undefined4)uStack_10;
DAT_180092e38._4_4_ = uStack_10._4_4_;
uStack_10 = (wchar_t *)0x0;
_DAT_180092e30 = (undefined4)local_18;
uRam0000000180092e34 = local_18._4_4_;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x5b,&DAT_180085178,pwVar1);
}
RtlReleaseResource(&DAT_180092e40);
}
}
}
if (local_res10[0] != 0) {
LsaIFree_LSAPR_POLICY_INFORMATION(0xc);
}
FUN_18004bcec(&local_18);
}
return;
}
=========================================
Function at address: 0x1800489ec
Called functions addresses: 0xEXTERNAL:0000003f 0x18002a77b 0xEXTERNAL:000000a3 0xEXTERNAL:00000040 0x18002a757 0xEXTERNAL:00000142 0xEXTERNAL:00000141


undefined8 FUN_1800489ec(PCCERT_CONTEXT param_1,undefined8 *param_2,undefined4 *param_3)

{
PCERT_EXTENSION p_Var1;
undefined8 *puVar2;
longlong lVar3;
LPCWSTR lpString;
int iVar4;
BOOL BVar5;
DWORD DVar6;
LPWSTR pszNameString;
PCERT_INFO p_Var7;
uint *puVar8;
uint uVar9;
ulonglong uVar10;
uint uVar11;
ulonglong uVar12;
DWORD local_res8 [2];
undefined8 *local_res10;
uint *local_res18;
HLOCAL local_res20;
uint *local_58 [3];

p_Var7 = param_1->pCertInfo;
pszNameString = (LPWSTR)0x0;
*param_3 = 0;
uVar10 = 0;
local_res10 = param_2;
if (p_Var7->cExtension != 0) {
do {
p_Var1 = p_Var7->rgExtension;
iVar4 = strcmp(p_Var1[uVar10].pszObjId,"2.5.29.17");
if (iVar4 == 0) {
local_res8[0] = 0;
local_58[0] = (uint *)0x0;
BVar5 = CryptDecodeObjectEx(param_1->dwCertEncodingType,(LPCSTR)0xc,
p_Var1[uVar10].Value.pbData,p_Var1[uVar10].Value.cbData,
0x2008000,(PCRYPT_DECODE_PARA)0x0,local_58,local_res8);
if (BVar5 != 0) {
uVar12 = 0;
puVar8 = local_58[0];
if (*local_58[0] != 0) {
do {
if (((*(int *)(*(longlong *)(puVar8 + 2) + uVar12 * 0x18) == 1) &&
(puVar2 = *(undefined8 **)(*(longlong *)(puVar8 + 2) + 8 + uVar12 * 0x18),
puVar2 != (undefined8 *)0x0)) &&
(iVar4 = strcmp("1.3.6.1.4.1.311.20.2.3",(char *)*puVar2), iVar4 == 0)) {
local_res18 = (uint *)((ulonglong)local_res18 & 0xffffffff00000000);
local_res20 = (HLOCAL)0x0;
BVar5 = CryptDecodeObjectEx(param_1->dwCertEncodingType,(LPCSTR)0x18,
(BYTE *)puVar2[2],*(DWORD *)(puVar2 + 1),0x2008000,
(PCRYPT_DECODE_PARA)0x0,&local_res20,
(DWORD *)&local_res18);
if (BVar5 != 0) {
pszNameString =
(LPWSTR)LocalAlloc(0x40,(ulonglong)*(uint *)((longlong)local_res20 + 8) + 2);
if (pszNameString != (LPWSTR)0x0) {
memcpy(pszNameString,*(void **)((longlong)local_res20 + 0x10),
(ulonglong)*(uint *)((longlong)local_res20 + 8));
}
LocalFree(local_res20);
local_res20 = (HLOCAL)0x0;
puVar8 = local_58[0];
if (pszNameString == (LPWSTR)0x0) goto LAB_180048c79;
}
puVar8 = local_58[0];
if (pszNameString != (LPWSTR)0x0) break;
}
uVar11 = (int)uVar12 + 1;
uVar12 = (ulonglong)uVar11;
} while (uVar11 < *puVar8);
}
LocalFree(puVar8);
if (pszNameString != (LPWSTR)0x0) goto LAB_180048dae;
}
}
p_Var7 = param_1->pCertInfo;
uVar11 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar11;
} while (uVar11 < p_Var7->cExtension);
if (pszNameString != (LPWSTR)0x0) goto LAB_180048dae;
}
uVar11 = 0;
if (p_Var7->cExtension != 0) {
do {
p_Var1 = p_Var7->rgExtension;
iVar4 = strcmp(p_Var1[uVar11].pszObjId,"2.5.29.17");
if (iVar4 == 0) {
local_res8[0] = 0;
local_res18 = (uint *)0x0;
BVar5 = CryptDecodeObjectEx(param_1->dwCertEncodingType,(LPCSTR)0xc,
p_Var1[uVar11].Value.pbData,p_Var1[uVar11].Value.cbData,
0x2008000,(PCRYPT_DECODE_PARA)0x0,&local_res18,local_res8);
if (BVar5 != 0) {
uVar10 = 0;
if (*local_res18 != 0) {
lVar3 = *(longlong *)(local_res18 + 2);
do {
if ((*(int *)(lVar3 + uVar10 * 0x18) == 3) &&
(lpString = *(LPCWSTR *)(lVar3 + 8 + uVar10 * 0x18), lpString != (LPCWSTR)0x0)) {
iVar4 = lstrlenW(lpString);
uVar9 = iVar4 * 2 + 2;
pszNameString = (LPWSTR)LocalAlloc(0x40,(ulonglong)uVar9);
puVar8 = local_res18;
if (pszNameString == (LPWSTR)0x0) {
LAB_180048c79:
LocalFree(puVar8);
return 0xc0000017;
}
memcpy(pszNameString,*(void **)(lVar3 + 8 + uVar10 * 0x18),(ulonglong)uVar9);
*param_3 = 1;
break;
}
uVar9 = (int)uVar10 + 1;
uVar10 = (ulonglong)uVar9;
} while (uVar9 < *local_res18);
}
LocalFree(local_res18);
if (pszNameString != (LPWSTR)0x0) goto LAB_180048dae;
}
}
p_Var7 = param_1->pCertInfo;
uVar11 = uVar11 + 1;
} while (uVar11 < p_Var7->cExtension);
if (pszNameString != (LPWSTR)0x0) goto LAB_180048dae;
}
DVar6 = CertGetNameStringW(param_1,3,0,"2.5.4.3",(LPWSTR)0x0,0);
if (DVar6 == 0) {
return 0xc0000225;
}
pszNameString = (LPWSTR)LocalAlloc(0x40,(ulonglong)DVar6 * 2);
if (pszNameString == (LPWSTR)0x0) {
return 0xc0000017;
}
DVar6 = CertGetNameStringW(param_1,3,0,"2.5.4.3",pszNameString,DVar6);
if (DVar6 == 0) {
LocalFree(pszNameString);
return 0xc0000034;
}
LAB_180048dae:
*local_res10 = pszNameString;
return 0;
}
=========================================
Function at address: 0x180048dd8
Called functions addresses: 0x18004b228 0x1800499fc 0xEXTERNAL:000000c8 0x180053078 0x1800494f8 0x1800478d4 0x180041cdc 0x180044b64 0x18002a7c0 0x180041cb0 0xEXTERNAL:00000040 0xEXTERNAL:00000146 0x180047d14 0x1800481b0


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

ulonglong FUN_180048dd8(longlong param_1,ulonglong param_2,int param_3,longlong param_4,uint param_5
,PCCERT_CONTEXT param_6,undefined8 param_7,wchar_t *param_8,wchar_t *param_9,
undefined8 *param_10)

{
PCCERT_CHAIN_CONTEXT pCVar1;
void *hMem;
uint uVar2;
ulonglong uVar3;
undefined2 uVar4;
ulonglong uVar5;
uint uVar6;
longlong lVar7;
longlong lVar8;
longlong lVar9;
longlong lVar10;
ulonglong local_res10;
uint local_res18 [2];
longlong local_98;
HANDLE local_90;
PCCERT_CHAIN_CONTEXT local_88;
uint local_80 [2];
longlong local_78;
undefined8 local_70;
undefined8 uStack_68;
void *local_60;
longlong local_58;
undefined8 local_50;
undefined8 uStack_48;

lVar10 = 0;
local_58 = 0;
local_60 = (void *)0x0;
param_7._0_4_ = 0;
local_98 = 0;
lVar7 = 0;
local_78 = 0;
local_res18[0] = 0;
local_88 = (PCCERT_CHAIN_CONTEXT)0x0;
local_70 = 0;
uStack_68 = 0;
if (param_3 != 1) {
return 0x8009030d;
}
local_res10 = param_2;
uVar3 = FUN_1800478d4(param_1,param_6,param_4,param_5,local_80,(int *)local_res18,&local_88);
pCVar1 = local_88;
if ((int)uVar3 != 0) {
return uVar3;
}
if ((local_80[0] & 0x10) == 0) {
if (((byte)DAT_1800919b4 & 0x10) != 0 && (local_80[0] & 0x60) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x28,&DAT_180085178);
}
uVar2 = FUN_18004b228((longlong)pCVar1,&local_90,4,param_8,param_9);
uVar3 = (ulonglong)uVar2;
if (-1 < (int)uVar2) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) == 0)) goto LAB_180048f15;
uVar4 = 0x29;
goto LAB_180048f05;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar4 = 0x2a;
goto LAB_18004901f;
}
}
}
else if (((byte)DAT_1800919b4 & 8) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],(short)uVar3 + 0x25,&DAT_180085178);
}
uVar2 = FUN_18004b228((longlong)pCVar1,&local_90,0,param_8,param_9);
uVar3 = (ulonglong)uVar2;
if (-1 < (int)uVar2) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) == 0)) goto LAB_180048f15;
uVar4 = 0x26;
LAB_180048f05:
FUN_180041cb0(DAT_180091000[2],uVar4,&DAT_180085178);
LAB_180048f15:
CertFreeCertificateChain(pCVar1);
*param_10 = local_90;
return uVar3;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar4 = 0x27;
LAB_18004901f:
FUN_180041cdc(DAT_180091000[2],uVar4,&DAT_180085178,uVar2);
}
}
if (local_80[0] == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2b,&DAT_180085178);
}
uVar3 = 0x80090327;
if ((int)local_res18[0] < 0) {
uVar3 = (ulonglong)local_res18[0];
}
CertFreeCertificateChain(pCVar1);
return uVar3;
}
uVar3 = FUN_180047d14((longlong)pCVar1,local_80[0],&local_60,(uint *)&param_7);
uVar5 = uVar3 & 0xffffffff;
CertFreeCertificateChain(pCVar1);
if ((int)uVar3 < 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar5;
}
if ((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) == 0) {
return uVar5;
}
FUN_180041cdc(DAT_180091000[2],0x2c,&DAT_180085178,(int)uVar3);
return uVar5;
}
FUN_180053078(1);
hMem = local_60;
uVar2 = FUN_1800499fc((longlong)local_60,(uint)param_7,&local_98,&local_res10,
(longlong *)&local_88);
lVar9 = local_98;
if ((int)uVar2 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2d,&DAT_180085178,uVar2);
}
pCVar1 = local_88;
if ((local_88 != (PCCERT_CHAIN_CONTEXT)0x0) || (lVar9 = lVar10, uVar2 == 0xc0000371)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2e,&DAT_180085178);
}
if (uVar2 != 0xc0000371) {
RtlInitUnicodeString(&local_50,pCVar1);
}
else {
local_50 = CONCAT44(uRam0000000180092e24,_DAT_180092e20);
uStack_48 = CONCAT44(uRam0000000180092e2c,uRam0000000180092e28);
}
uVar2 = FUN_1800494f8((ushort *)&local_50,hMem,*(uint *)((longlong)hMem + 4),1,
(uint)(uVar2 == 0xc0000371),&local_98,(uint *)&local_res10,&local_58);
lVar8 = local_58;
if ((int)uVar2 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2f,&DAT_180085178,uVar2);
}
}
else {
uStack_68 = *(longlong *)(local_58 + 0x10);
lVar7 = local_98;
if (((uint)(*(int *)(uStack_68 + 4) - *(int *)(uStack_68 + 0xc)) < 0x21) ||
(0xffff < *(uint *)(uStack_68 + 0x18))) {
local_70 = CONCAT44(uRam0000000180092e24,_DAT_180092e20);
uStack_68 = CONCAT44(uRam0000000180092e2c,uRam0000000180092e28);
}
else {
local_70._0_4_ =
CONCAT22(*(undefined2 *)(uStack_68 + 0x18),*(undefined2 *)(uStack_68 + 0x18));
uStack_68 = (ulonglong)*(uint *)(uStack_68 + 0x14) + uStack_68;
}
}

goto LAB_1800492b3;
}
}
local_70 = CONCAT44(uRam0000000180092e24,_DAT_180092e20);
uStack_68 = CONCAT44(uRam0000000180092e2c,uRam0000000180092e28);
lVar7 = lVar10;
lVar8 = lVar10;
lVar10 = lVar9;
LAB_1800492b3:
uVar3 = (ulonglong)uVar2;
uVar6 = local_res18[0];
if (-1 < (int)uVar2) {

(local_98,local_res10 & 0xffffffff,0,&local_78,&param_6);
uVar3 = (ulonglong)uVar2;
if ((int)uVar2 < 0) {
uVar6 = local_res18[0];
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x30,&DAT_180085178,uVar2);
uVar6 = local_res18[0];
}
}
else {
local_98 = local_78;
local_res10 = CONCAT44(local_res10._4_4_,param_6._0_4_);
uVar2 = FUN_1800481b0(local_78,(ulonglong)param_6 & 0xffffffff,(undefined *)&local_70,&param_7
,&local_90);
uVar3 = (ulonglong)uVar2;
if ((int)uVar2 < 0) {
uVar6 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x31,&DAT_180085178,uVar2);
uVar6 = 0;
}
}
else {
*param_10 = local_90;
uVar6 = 0;
}
}
}
if (hMem != (void *)0x0) {
LocalFree(hMem);
}
if (lVar8 != 0) {

}
if (lVar10 != 0) {

}
if (lVar7 != 0) {

}
if (local_78 != 0) {

}
uVar2 = (uint)uVar3;
if ((int)uVar2 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x32,&DAT_180085178,uVar2);
}
FUN_180044b64(*(uint *)(param_1 + 0xd4));
if (((int)uVar6 < 0) && ((uVar2 & 0x1fff0000) != 0x90000)) {
uVar3 = (ulonglong)uVar6;
}
}
return uVar3;
}
=========================================
Function at address: 0x1800494f8
Called functions addresses: 0x180041cdc 0x18004cec0 0x18002a77b 0x18002a7c0 0x180041cb0 0x18002a700 0x18000a418 0xEXTERNAL:0000015d 0xEXTERNAL:0000018c 0x180028070 0x18004ca84


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_1800494f8(ushort *param_1,void *param_2,uint param_3,int param_4,int param_5,
undefined8 *param_6,uint *param_7,longlong *param_8)

{
undefined4 *_Dst;
ushort uVar1;
longlong lVar2;
NTSTATUS NVar3;
undefined8 uVar4;
undefined4 *puVar5;
void *pvVar6;
ulonglong uVar7;
ulonglong uVar8;
undefined2 uVar9;
void *pvVar10;
undefined *puVar11;
undefined *puVar12;
uint uVar13;
uint uVar14;
undefined auStack_98 [32];
undefined8 local_78;
undefined8 local_70;
undefined8 local_68;
longlong local_58;
void *local_50;
int local_48;
int local_44;
uint local_40 [2];
longlong local_38;
undefined auStack_30 [8];
ulonglong local_28;

puVar12 = auStack_98;
puVar11 = auStack_98;
local_28 = DAT_180091970 ^ (ulonglong)&local_58;
local_58 = 0;
local_38 = 0;
local_50 = param_2;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3a,&DAT_180085178);
}
if (0x4000 < param_3) goto LAB_1800499cf;
if ((param_4 == 0) || (param_5 != 0)) {
LAB_180049639:
uVar14 = param_3 + 3 & 0xfffffffc;
puVar5 = (undefined4 *)0x0;
uVar13 = uVar14 + 0x40 + ((uint)*param_1 + DAT_180092e10 + 3 & 0xfffffffc);
puVar12 = auStack_98;
if ((((uVar13 == 0) || (uVar8 = (ulonglong)uVar13, puVar12 = auStack_98, DAT_1800920e0 < uVar8))
|| (uVar7 = DAT_1800920e8 + 8 + uVar8, puVar12 = auStack_98, uVar7 < uVar8)) ||
(uVar4 = FUN_18000a418(uVar7), puVar12 = auStack_98, puVar5 = (undefined4 *)0x0,
(int)uVar4 == 0)) {
LAB_1800496c4:
if (uVar13 <= uVar13 + 8) {
*(undefined8 *)(puVar12 + -8) = 0x1800496e4;

if (puVar5 == (undefined4 *)0x0) goto LAB_180049982;
*puVar5 = 0x70616548;
puVar5 = puVar5 + 2;
}
puVar11 = puVar12;
if (puVar5 == (undefined4 *)0x0) goto LAB_180049982;
}
else {
uVar8 = (ulonglong)(uVar13 + 8) + 0xf;
if (uVar8 <= uVar13 + 8) {
uVar8 = 0xffffffffffffff0;
}
lVar2 = -(uVar8 & 0xfffffffffffffff0);
puVar5 = (undefined4 *)((longlong)&local_58 + lVar2);
puVar12 = auStack_98 + lVar2;
if (puVar5 == (undefined4 *)0x0) goto LAB_1800496c4;
*puVar5 = 0x6b637453;
puVar5 = (undefined4 *)((longlong)&local_50 + lVar2);
puVar12 = auStack_98 + lVar2;
puVar11 = auStack_98 + lVar2;
if (puVar5 == (undefined4 *)0x0) goto LAB_1800496c4;
}
puVar12 = puVar11;
*puVar5 = 7;
_Dst = puVar5 + 0x10;
uVar4 = *(undefined8 *)(param_1 + 4);
*(undefined8 *)(puVar5 + 2) = *(undefined8 *)param_1;
*(undefined8 *)(puVar5 + 4) = uVar4;
*(undefined4 **)(puVar5 + 4) = _Dst;
uVar1 = *param_1;
pvVar6 = *(void **)(param_1 + 4);
*(undefined8 *)(puVar12 + -8) = 0x18004972c;
memcpy(_Dst,pvVar6,(ulonglong)uVar1);
pvVar10 = (void *)((longlong)_Dst + (ulonglong)*param_1);
*(ulonglong *)(puVar5 + 6) = CONCAT62(uRam0000000180092e12,DAT_180092e10);
*(void **)(puVar5 + 8) = DAT_180092e18;
*(void **)(puVar5 + 8) = pvVar10;
*(undefined8 *)(puVar12 + -8) = 0x18004975a;
memcpy(pvVar10,DAT_180092e18,(ulonglong)DAT_180092e10);
pvVar6 = local_50;
puVar5[10] = uVar14;
pvVar10 = (void *)((ulonglong)DAT_180092e10 + 3 + (longlong)pvVar10 & 0xfffffffffffffffc);
*(void **)(puVar5 + 0xc) = pvVar10;
*(undefined8 *)(puVar12 + -8) = 0x180049780;
memcpy(pvVar10,pvVar6,(ulonglong)param_3);
*(int **)(puVar12 + 0x30) = &local_44;
*(undefined **)(puVar12 + 0x28) = auStack_30;
*(longlong **)(puVar12 + 0x20) = &local_58;
*(undefined8 *)(puVar12 + -8) = 0x1800497b5;
NVar3 = LsaCallAuthenticationPackage
(DAT_180092e08,DAT_180092e00,puVar5,uVar13,*(PVOID **)(puVar12 + 0x20),
*(PULONG *)(puVar12 + 0x28),*(PNTSTATUS *)(puVar12 + 0x30));
if (puVar5[-2] == 0x70616548) {
*(undefined8 *)(puVar12 + -8) = 0x1800497df;

}
if (NVar3 < 0) {
local_58 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar9 = 0x3d;
puVar11 = puVar12;
goto LAB_1800495f9;
}
}
else if (local_44 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar4 = DAT_180091000[2];
*(undefined8 *)(puVar12 + -8) = 0x18004985b;
FUN_180041cdc(uVar4,0x3e,&DAT_180085178,local_44);
}
}
else {
lVar2 = *(longlong *)(local_58 + 0x10);
uVar13 = *(uint *)(lVar2 + 0xc);
local_40[0] = uVar13;
*(undefined8 *)(puVar12 + -8) = 0x18004987b;
pvVar6 = (void *)FUN_18004cec0((ulonglong)uVar13);
local_50 = pvVar6;
if (pvVar6 != (void *)0x0) {
uVar14 = *(uint *)(lVar2 + 8);
*(undefined8 *)(puVar12 + -8) = 0x1800498a3;
memcpy(pvVar6,(void *)((ulonglong)uVar14 + lVar2),(ulonglong)uVar13);
lVar2 = local_38;
if (param_5 == 0) {
*(undefined8 *)(puVar12 + -8) = 0x1800498bd;
uVar8 = FUN_18004ca84(lVar2,&local_50,local_40);
NVar3 = (NTSTATUS)uVar8;
pvVar6 = local_50;
uVar13 = local_40[0];
if (-1 < NVar3) goto LAB_180049904;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar4 = DAT_180091000[2];
*(undefined8 *)(puVar12 + -8) = 0x1800498f7;
FUN_180041cdc(uVar4,0x3f,&DAT_180085178,NVar3);
pvVar6 = local_50;
}
}
else {
LAB_180049904:
lVar2 = local_58;
*param_6 = pvVar6;
*param_7 = uVar13;
pvVar6 = (void *)0x0;
local_58 = 0;
*param_8 = lVar2;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar4 = DAT_180091000[2];
*(undefined8 *)(puVar12 + -8) = 0x18004995d;
FUN_180041cdc(uVar4,0x40,&DAT_180085178,NVar3);
}
}
if (pvVar6 != (void *)0x0) {
*(undefined8 *)(puVar12 + -8) = 0x180049982;

}
}
}
}
else {
local_68 = 0;
local_70 = 0;
local_78 = 0;
local_48 = 1;
NVar3 = LsaIIsDomainWithinForest(param_1,&local_48,0,&local_38);
if (NVar3 < 0) {
puVar12 = auStack_98;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(puVar12 = auStack_98, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar9 = 0x3b;
puVar11 = auStack_98;
LAB_1800495f9:
uVar4 = DAT_180091000[2];
*(undefined8 *)(puVar11 + -8) = 0x180049602;
FUN_180041cdc(uVar4,uVar9,&DAT_180085178,NVar3);
puVar12 = puVar11;
}
}
else {
if (local_48 != 0) goto LAB_180049639;
puVar12 = auStack_98;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(puVar12 = auStack_98, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar9 = 0x3c;
NVar3 = -0x7ff6fcef;
goto LAB_1800495f9;
}
}
}
LAB_180049982:
if (local_38 != 0) {
*(undefined8 *)(puVar12 + -8) = 0x1800499a6;

}
if (local_58 != 0) {
*(undefined8 *)(puVar12 + -8) = 0x1800499cd;

}
LAB_1800499cf:
uVar8 = local_28 ^ (ulonglong)&local_58;
*(undefined8 *)(puVar12 + -8) = 0x1800499db;
FUN_180028070(uVar8);
return;
}
=========================================
Function at address: 0x1800499fc
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000012b 0x180053078 0x180041cb0 0xEXTERNAL:00000137 0x18004aa94 0x18004ae90 0x18004b59c


int FUN_1800499fc(longlong param_1,uint param_2,undefined8 param_3,undefined8 param_4,
longlong *param_5)

{
uint uVar1;
int iVar2;
int iVar3;
PCCERT_CONTEXT pCertContext;
char cVar4;
undefined2 uVar5;
uint uVar6;
ulonglong uVar7;

iVar2 = -0x3fffff93;
iVar3 = -0x3ffffddb;
*param_5 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180085178);
}
if ((0xffe0 < param_2 - 0x20) || (param_2 < *(uint *)(param_1 + 4))) {
return -0x3ffffff3;
}
uVar6 = *(uint *)(param_1 + 8);
if (param_2 < uVar6) {
return -0x3ffffff3;
}
uVar1 = *(uint *)(param_1 + 0xc);
if (0x10000 < uVar1) {
return -0x3ffffff3;
}
if (param_2 < uVar1 + uVar6) {
return -0x3ffffff3;
}
pCertContext = CertCreateCertificateContext(1,(BYTE *)(param_1 + (ulonglong)uVar6),uVar1);
if (pCertContext == (PCCERT_CONTEXT)0x0) {
iVar2 = -0x3fffffe9;
goto LAB_180049e90;
}
if (((byte)DAT_1800919b4 & 4) == 0 || (*(byte *)(param_1 + 0x10) & 0x10) == 0) {
LAB_180049bd5:
uVar6 = *(uint *)(param_1 + 0x10);
if (((byte)DAT_1800919b4 & 1) != 0 && (uVar6 & 0x20) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x17,&DAT_180085178);
}
iVar3 = FUN_18004aa94(&pCertContext->dwCertEncodingType,param_3,param_4,param_5);
iVar2 = iVar3;
if ((-1 < iVar3) || (*param_5 != 0)) {
uVar5 = 8;
goto LAB_180049c72;
}
if (iVar3 == -0x3ffffc8f) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar5 = 0x18;
goto LAB_180049b77;
}
goto LAB_180049e81;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x19,&DAT_180085178,iVar3);
}
uVar6 = *(uint *)(param_1 + 0x10);
}
cVar4 = (char)uVar6;
if (((byte)DAT_1800919b4 & 2) == 0 || (uVar6 & 0x40) == 0) {
LAB_180049dca:
if ((iVar2 == -0x3fffffcb) || (iVar3 == -0x3fffffcb)) {
iVar2 = -0x7ff6fcb9;
}
else if (iVar2 != -0x3fffffe9) {
iVar2 = -0x3fffff93;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1a,&DAT_180085178);
cVar4 = (char)*(undefined4 *)(param_1 + 0x10);
}
if ((cVar4 < '\0') && (*(int *)(param_1 + 0x14) != 0)) {
if ((ulonglong)(*(int *)(param_1 + 0x14) - 1) * 8 + 0x20 <= (ulonglong)param_2) {
uVar7 = 0;
do {
uVar6 = *(uint *)(param_1 + 0x18 + uVar7 * 8);
uVar1 = *(uint *)(param_1 + 0x1c + uVar7 * 8);
if (param_2 < uVar6) {
return -0x3ffffff3;
}
if (0x10000 < uVar1) {
return -0x3ffffff3;
}
if (param_2 < uVar1 + uVar6) {
return -0x3ffffff3;
}
iVar2 = FUN_18004ae90((byte *)((ulonglong)uVar6 + param_1),uVar1,param_3,param_4,param_5
);
if ((-1 < iVar2) || (*param_5 != 0)) goto LAB_180049e1a;
if (iVar2 == -0x3ffffc8f) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) == 0)) goto LAB_180049e81;
uVar5 = 0x1b;
goto LAB_180049b77;
}
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
} while (uVar6 < *(uint *)(param_1 + 0x14));
LAB_180049d96:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1d,&DAT_180085178,iVar2);
}
goto LAB_180049dca;
}
iVar2 = -0x3ffffff3;
}
else {
iVar2 = FUN_18004ae90((pCertContext->pCertInfo->Issuer).pbData,
(pCertContext->pCertInfo->Issuer).cbData,param_3,param_4,param_5);
if ((-1 < iVar2) || (*param_5 != 0)) {
LAB_180049e1a:
uVar5 = 4;
goto LAB_180049c72;
}
if (iVar2 != -0x3ffffc8f) goto LAB_180049d96;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar5 = 0x1c;
goto LAB_180049b77;
}
}
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180085178);
}
iVar2 = FUN_18004b59c(pCertContext,param_3,param_4,param_5);
if ((iVar2 < 0) && (*param_5 == 0)) {
if (iVar2 != -0x3ffffc8f) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x16,&DAT_180085178,iVar2);
}
goto LAB_180049bd5;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar5 = 0x15;
LAB_180049b77:
FUN_180041cdc(DAT_180091000[2],uVar5,&DAT_180085178,0xc0000371);
}
}
else {
uVar5 = 0x10;
LAB_180049c72:
FUN_180053078(uVar5);
}
}
LAB_180049e81:
CertFreeCertificateContext(pCertContext);
LAB_180049e90:
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar2;
}
if ((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0) {
FUN_180041cdc(DAT_180091000[2],0x1e,&DAT_180085178,iVar2);
return iVar2;
}
return iVar2;
}
=========================================
Function at address: 0x180049ef4
Called functions addresses: 0x180041cdc 0x18000909c 0xEXTERNAL:0000012b 0x18000a1f4 0x18004bc9c 0x18002a7c0 0x180041cb0 0xEXTERNAL:00000062 0xEXTERNAL:00000137 0xEXTERNAL:0000005d 0x18004a314 0xEXTERNAL:00000041


int FUN_180049ef4(undefined8 param_1,longlong param_2,ulonglong param_3,uint param_4,
undefined8 *param_5,undefined4 *param_6,int *param_7)

{
undefined4 uVar1;
int iVar2;
DWORD DVar3;
BYTE *pbCertEncoded;
PCCERT_CONTEXT pCertContext;
ulonglong uVar4;
undefined2 uVar5;
BYTE *pBVar6;
PCCERT_CONTEXT pCVar7;
PCCERT_CONTEXT lpAddress;
ulonglong uVar8;
undefined8 local_res8;
ulonglong local_res18 [2];
PCCERT_CONTEXT local_68;
BYTE *local_60;
undefined4 local_58;
undefined4 local_54;
undefined4 local_50;
undefined4 local_4c;
PCCERT_CONTEXT local_48;
undefined4 local_40;
undefined4 local_3c;

pCVar7 = (PCCERT_CONTEXT)0x0;
local_4c = 0;
local_3c = 0;
local_68 = (PCCERT_CONTEXT)0x0;
local_res18[0] = param_3 & 0xffffffff00000000;
local_res8 = 0;
local_60 = (BYTE *)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x41,&DAT_180085178);
}
if (param_5 != (undefined8 *)0x0) {
*param_5 = 0;
*param_6 = 0;
if ((0x27 < param_4) && (*(int *)(param_2 + 4) == 0x28)) {
pbCertEncoded = (BYTE *)FUN_18000a1f4((ulonglong)*(uint *)(param_2 + 0x10));
if (pbCertEncoded == (BYTE *)0x0) {
iVar2 = -0x3fffffe9;
goto LAB_18004a2c3;
}

(0,*(undefined4 *)(param_2 + 0x10),pbCertEncoded,
*(undefined8 *)(param_2 + 0x18));
if (iVar2 < 0) {
lpAddress = pCVar7;
pCertContext = pCVar7;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(lpAddress = (PCCERT_CONTEXT)0x0, pCertContext = (PCCERT_CONTEXT)0x0,
(*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar5 = 0x42;
pCertContext = pCVar7;
goto LAB_18004a009;
}
}
else {
uVar8 = (ulonglong)*(uint *)(param_2 + 0x10);
uVar4 = (ulonglong)*(uint *)(param_2 + 0xc);
pBVar6 = pbCertEncoded;
pCertContext = CertCreateCertificateContext
(*(uint *)(param_2 + 0xc),pbCertEncoded,*(uint *)(param_2 + 0x10));
if (pCertContext == (PCCERT_CONTEXT)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar3 = GetLastError();
FUN_18004bc9c(DAT_180091000[2],pBVar6,uVar8,DVar3);
}
iVar2 = -0x3ffffff3;
lpAddress = (PCCERT_CONTEXT)0x0;
}
else {
local_50 = *(undefined4 *)(param_2 + 8);
local_40 = *(undefined4 *)(param_2 + 0x20);
local_58 = 6;
local_54 = 0x20;
local_48 = pCertContext;
iVar2 = FUN_18004a314(uVar4,(longlong)&local_58,uVar8,0x20,&local_68,
(undefined4 *)local_res18,param_7);
pCVar7 = local_68;
lpAddress = pCVar7;
if (-1 < iVar2) {
if (*param_7 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x44,&DAT_180085178,*param_7);
lpAddress = local_68;
}
}
else {
local_60 = local_68->pbCertEncoded;

uVar4 = local_res18[0];
if (iVar2 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar5 = 0x45;
LAB_18004a009:
FUN_180041cdc(DAT_180091000[2],uVar5,&DAT_180085178,iVar2);
lpAddress = pCVar7;
}
}
else {
uVar1 = (undefined4)local_res18[0];

(0,local_res18[0] & 0xffffffff,&local_res8);
if (iVar2 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar5 = 0x46;
goto LAB_18004a009;
}
}
else {

(0,uVar4 & 0xffffffff,local_res8,pCVar7);
if (iVar2 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x47,&DAT_180085178,iVar2);
}

}
else {
*param_5 = local_res8;
*param_6 = uVar1;
}
}
}
}
}
}
}
FUN_18000909c(pbCertEncoded);
if (local_60 != (BYTE *)0x0) {
CloseHandle(local_60);
}
if (lpAddress != (PCCERT_CONTEXT)0x0) {
VirtualFree(lpAddress,0,0x8000);
}
if (pCertContext != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(pCertContext);
}
goto LAB_18004a2c3;
}
}
iVar2 = -0x3ffffff3;
LAB_18004a2c3:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x48,&DAT_180085178,iVar2);
}
return iVar2;
}
=========================================
Function at address: 0x18004a314
Called functions addresses: 0x180041cdc 0xEXTERNAL:000000cd 0x180041cb0 0xEXTERNAL:00000061 0x18004a534 0xEXTERNAL:00000062 0x180048dd8


undefined4
FUN_18004a314(undefined8 param_1,longlong param_2,undefined8 param_3,uint param_4,
undefined8 *param_5,undefined4 *param_6,int *param_7)

{
PCCERT_CONTEXT pCVar1;
char cVar2;
int iVar3;
undefined4 *puVar5;
uint uVar6;
undefined4 uVar7;
HANDLE local_res18;
int local_res20 [2];
HANDLE in_stack_ffffffffffffffc8;
ulonglong uVar4;

local_res18 = (HANDLE)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x49,&DAT_180085178);
}
if (param_5 != (undefined8 *)0x0) {
*param_5 = 0;
}
if ((param_4 < 0x20) || (*(int *)(param_2 + 4) != 0x20)) {
uVar7 = 0xc000000d;
}
else {
cVar2 = RtlGetNtProductType(local_res20);
if (cVar2 != '\0') {
pCVar1 = *(PCCERT_CONTEXT *)(param_2 + 0x10);
uVar6 = *(uint *)(param_2 + 0x18) | 0x80000000;
if (local_res20[0] == 2) {
uVar4 = FUN_180048dd8(0,0,*(int *)(param_2 + 8),0,uVar6,pCVar1,0,(wchar_t *)0x0,
(wchar_t *)0x0,&local_res18);
iVar3 = (int)uVar4;
}
else {
uVar4 = FUN_18004a534(0,(ulonglong)pCVar1,*(int *)(param_2 + 8),0,uVar6,pCVar1,
in_stack_ffffffffffffffc8,(wchar_t *)0x0,(wchar_t *)0x0,&local_res18);
iVar3 = (int)uVar4;
}
if (iVar3 < 0) {
*param_6 = 0;
uVar7 = 0;
*param_7 = iVar3;
goto LAB_18004a49d;
}
puVar5 = (undefined4 *)VirtualAlloc((LPVOID)0x0,0x18,0x1000,4);
if (puVar5 != (undefined4 *)0x0) {
puVar5[1] = 0x18;
*puVar5 = 6;
puVar5[4] = 0;
*(HANDLE *)(puVar5 + 2) = local_res18;
*param_5 = puVar5;
local_res18 = (HANDLE)0x0;
*param_6 = puVar5[1];
*param_7 = 0;
uVar7 = 0;
goto LAB_18004a4b6;
}
}
uVar7 = 0xc0000017;
}
LAB_18004a49d:
if (local_res18 != (HANDLE)0x0) {
CloseHandle(local_res18);
}
LAB_18004a4b6:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x4a,&DAT_180085178,uVar7);
}
return uVar7;
}
=========================================
Function at address: 0x18004a500
Called functions addresses: 0x18002a7c0


bool FUN_18004a500(void)

{
int iVar1;


return -1 < iVar1;
}
=========================================
Function at address: 0x18004a534
Called functions addresses: 0x18004b228 0x180053078 0x1800494f8 0x180041d70 0x180041e9c 0x1800478d4 0x180041cdc 0x180044b64 0x180041cb0 0x18002a7c0 0xEXTERNAL:00000040 0xEXTERNAL:00000146 0x180047d14 0x1800481b0


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

ulonglong FUN_18004a534(longlong param_1,ulonglong param_2,int param_3,longlong param_4,uint param_5
,PCCERT_CONTEXT param_6,HANDLE param_7,wchar_t *param_8,wchar_t *param_9,
undefined8 *param_10)

{
PCERT_SIMPLE_CHAIN *pp_Var1;
uint uVar2;
wchar_t *pwVar3;
PCCERT_CHAIN_CONTEXT pCVar4;
uint uVar5;
ulonglong uVar6;
undefined2 uVar7;
ulonglong uVar8;
ulonglong local_res10;
uint local_res18 [4];
void *local_58;
undefined8 local_50;
PCCERT_CHAIN_CONTEXT local_48;
undefined8 local_40;
undefined8 local_38;
longlong lStack_30;

local_res10 = param_2 & 0xffffffff00000000;
local_40 = 0;
local_48 = (PCCERT_CHAIN_CONTEXT)0x0;
local_58 = (void *)0x0;
local_50 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x4b,&DAT_180085178,0);
}
if (param_3 != 1) {
return 0x8009030d;
}
uVar6 = FUN_1800478d4(param_1,param_6,param_4,param_5,local_res18,(int *)&local_res10,&local_48);
pCVar4 = local_48;
if ((int)uVar6 != 0) {
return uVar6;
}
if ((local_res18[0] & 0x10) == 0) {
if (((byte)DAT_1800919b4 & 0x10) == 0 || (local_res18[0] & 0x60) == 0) goto LAB_18004a7cd;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x51,&DAT_180085178);
}
uVar5 = FUN_18004b228((longlong)pCVar4,&param_7,4,param_8,param_9);
uVar6 = (ulonglong)uVar5;
if (-1 < (int)uVar5) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) == 0)) goto LAB_18004a6d0;
uVar7 = 0x52;
goto LAB_18004a6c0;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) == 0)) goto LAB_18004a7cd;
uVar7 = 0x53;
}
else {
if (((byte)DAT_1800919b4 & 8) == 0) goto LAB_18004a7cd;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],(short)uVar6 + 0x4c,&DAT_180085178);
}
pwVar3 = param_9;
if ((param_1 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041d70(DAT_180091000[2],0x4d,&DAT_180085178,param_8);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x4e,&DAT_180085178,pwVar3);
}
}
uVar5 = FUN_18004b228((longlong)pCVar4,&param_7,0,param_8,pwVar3);
uVar6 = (ulonglong)uVar5;
if (-1 < (int)uVar5) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) == 0)) goto LAB_18004a6d0;
uVar7 = 0x4f;
LAB_18004a6c0:
FUN_180041cb0(DAT_180091000[2],uVar7,&DAT_180085178);
LAB_18004a6d0:
CertFreeCertificateChain(pCVar4);
*param_10 = param_7;
return uVar6;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) == 0)) goto LAB_18004a7cd;
uVar7 = 0x50;
}
FUN_180041cdc(DAT_180091000[2],uVar7,&DAT_180085178,uVar5);
LAB_18004a7cd:
if (local_res18[0] == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x54,&DAT_180085178);
}
uVar8 = 0x80090327;
if ((int)(uint)local_res10 < 0) {
uVar8 = local_res10 & 0xffffffff;
}
CertFreeCertificateChain(pCVar4);
}
else {
FUN_180053078(2);
uVar6 = FUN_180047d14((longlong)pCVar4,local_res18[0],&local_58,(uint *)&param_6);
uVar8 = uVar6 & 0xffffffff;
CertFreeCertificateChain(pCVar4);
if ((int)uVar6 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x55,&DAT_180085178,(int)uVar6);
}
}
else {
uVar5 = FUN_1800494f8((ushort *)&DAT_180092e20,local_58,(uint)param_6,0,0,&local_50,
local_res18,(longlong *)&local_48);
uVar8 = (ulonglong)uVar5;
LocalFree(local_58);
pCVar4 = local_48;
if ((int)uVar5 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x56,&DAT_180085178,uVar5);
}
uVar2 = (uint)local_res10;

(uVar5,local_res10 & 0xffffffff,&DAT_180091950,&DAT_180091950,0,0,3,&DAT_180092638
,&local_40);
FUN_180044b64(*(uint *)(param_1 + 0xd4));
if ((int)uVar2 < 0) {
if ((uVar5 & 0x1fff0000) != 0x90000) {
uVar5 = uVar2;
}
uVar8 = (ulonglong)uVar5;
}
}
else {
pp_Var1 = local_48->rgpChain;
if (((uint)(*(int *)((longlong)pp_Var1 + 4) - *(int *)((longlong)pp_Var1 + 0xc)) < 0x21) ||
(0xffff < *(uint *)(pp_Var1 + 3))) {
local_38 = _DAT_180092e20;
lStack_30 = lRam0000000180092e28;
}
else {
local_38._0_4_ = CONCAT22(*(undefined2 *)(pp_Var1 + 3),*(undefined2 *)(pp_Var1 + 3));
lStack_30 = (ulonglong)*(uint *)((longlong)pp_Var1 + 0x14) + (longlong)pp_Var1;
}
uVar5 = FUN_1800481b0(local_50,(ulonglong)local_res18[0],(undefined *)&local_38,&local_40,
&param_7);
uVar8 = (ulonglong)uVar5;
if ((int)uVar5 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x57,&DAT_180085178,uVar5);
}
FUN_180044b64(*(uint *)(param_1 + 0xd4));
}
else {
*param_10 = param_7;
}


}
}
}
return uVar8;
}
=========================================
Function at address: 0x18004aa94
Called functions addresses: 0x180047838 0x18002a7c0 0x18002a700 0x18000a418 0xEXTERNAL:00000136 0x180028070 0x180047eb0


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_18004aa94(DWORD *param_1,undefined8 param_2,undefined8 param_3,longlong *param_4)

{
LPWSTR psz;
undefined8 *puVar1;
undefined8 uVar2;
DWORD DVar3;
DWORD DVar4;
DWORD DVar5;
int iVar6;
undefined8 uVar7;
ulonglong uVar8;
uint uVar9;
ulonglong uVar10;
longlong lVar11;
undefined *puVar12;
undefined *puVar13;
undefined auStackY_b8 [32];
ushort local_78;
ushort uStack_76;
undefined8 *local_70;
int local_68 [2];
undefined8 local_60;
undefined8 uStack_58;
undefined8 local_50;
longlong lStack_48;
undefined8 local_40;
longlong lStack_38;
ulonglong local_30;

puVar12 = auStackY_b8;
local_30 = DAT_180091970 ^ (ulonglong)&local_78;
lVar11 = *(longlong *)(param_1 + 6);
*param_4 = 0;
local_40 = 0;
lStack_38 = 0;
local_50 = 0;
lStack_48 = 0;
local_60 = 0;
uStack_58 = 0;
DVar3 = CertNameToStrW(*param_1,(PCERT_NAME_BLOB)(lVar11 + 0x30),0x28000003,(LPWSTR)0x0,0);
DVar4 = CertNameToStrW(*param_1,(PCERT_NAME_BLOB)(*(longlong *)(param_1 + 6) + 0x50),0x28000003,
(LPWSTR)0x0,0);
puVar13 = auStackY_b8;
if ((((DVar3 == 0) || (puVar13 = auStackY_b8, DVar4 == 0)) ||
(uVar9 = DVar4 + DVar3, puVar13 = auStackY_b8, uVar9 < DVar3)) ||
((puVar13 = auStackY_b8, 0xffff < uVar9 || (puVar13 = auStackY_b8, 0x7ff9 < (ushort)uVar9))))
goto LAB_18004ae58;
local_70 = (undefined8 *)0x0;
uStack_76 = ((short)(DVar3 + 6) + (short)DVar4) * 2;
uVar9 = (uint)uStack_76;
puVar13 = auStackY_b8;
if ((uStack_76 == 0) ||
((uVar8 = (ulonglong)uStack_76, puVar13 = auStackY_b8, DAT_1800920e0 < uVar8 ||
(uVar10 = DAT_1800920e8 + 8 + uVar8, puVar13 = auStackY_b8, uVar10 < uVar8)))) {
LAB_18004ac0c:
if (uVar9 <= uVar9 + 8) {
*(undefined8 *)(puVar13 + -8) = 0x18004ac32;

if (local_70 == (undefined8 *)0x0) goto LAB_18004ae58;
*(undefined4 *)local_70 = 0x70616548;
local_70 = local_70 + 1;
}
if (local_70 == (undefined8 *)0x0) goto LAB_18004ae58;
}
else {
uVar7 = FUN_18000a418(uVar10);
uVar9 = (uint)uStack_76;
if ((int)uVar7 != 0) {
uVar8 = (ulonglong)(uStack_76 + 8) + 0xf;
if (uVar8 <= uStack_76 + 8) {
uVar8 = 0xffffffffffffff0;
}
puVar12 = auStackY_b8 + -(uVar8 & 0xfffffffffffffff0);
local_70 = (undefined8 *)((longlong)&local_78 + -(uVar8 & 0xfffffffffffffff0));
}
puVar13 = puVar12;
if (local_70 == (undefined8 *)0x0) goto LAB_18004ac0c;
*(undefined4 *)local_70 = 0x6b637453;
local_70 = local_70 + 1;
if (local_70 == (undefined8 *)0x0) {
uVar9 = (uint)uStack_76;
goto LAB_18004ac0c;
}
}
puVar1 = local_70;
*(DWORD *)(puVar13 + 0x20) = DVar3;
*puVar1 = 0x3e0049003c;
puVar1 = local_70;
lVar11 = *(longlong *)(param_1 + 6);
DVar3 = *param_1;
psz = (LPWSTR)((longlong)local_70 + 6);
*(undefined8 *)(puVar13 + -8) = 0x18004ac8d;
DVar5 = CertNameToStrW(DVar3,(PCERT_NAME_BLOB)(lVar11 + 0x30),0x28000003,psz,
*(DWORD *)(puVar13 + 0x20));
*(DWORD *)(puVar13 + 0x20) = DVar4;
*(undefined8 *)((longlong)puVar1 + (ulonglong)(DVar5 - 1) * 2 + 6) = 0x3e0053003c;
lVar11 = *(longlong *)(param_1 + 6);
DVar3 = *param_1;
*(undefined8 *)(puVar13 + -8) = 0x18004acc5;
CertNameToStrW(DVar3,(PCERT_NAME_BLOB)(lVar11 + 0x50),0x28000003,
(LPWSTR)((longlong)puVar1 + (ulonglong)(DVar5 - 1) * 2 + 0xc),
*(DWORD *)(puVar13 + 0x20));
*(undefined8 *)(puVar13 + -8) = 0x18004acd3;
FUN_180047838((short *)&local_78);
*(undefined8 **)(puVar13 + 0x28) = &local_60;
*(undefined8 *)(puVar13 + 0x20) = param_3;
uVar7 = 1;
*(undefined8 *)(puVar13 + -8) = 0x18004ad12;

if ((short)local_60 != 0) {
uVar7 = CONCAT71((int7)((ulonglong)uVar7 >> 8),-1 < iVar6);
*(int *)(puVar13 + 0x28) = iVar6;
*(undefined8 **)(puVar13 + 0x20) = &local_60;
*(undefined8 *)(puVar13 + -8) = 0x18004ad5c;

uVar2 = uStack_58;
*(undefined8 *)(puVar13 + -8) = 0x18004ad7b;

}
if (iVar6 == -0x3ffffddb) {
*(int **)(puVar13 + 0x38) = local_68;
*(undefined8 **)(puVar13 + 0x30) = &local_50;
*(undefined8 **)(puVar13 + 0x28) = &local_40;
*(undefined8 *)(puVar13 + -8) = 0x18004adb8;
iVar6 = FUN_180047eb0(0xfffffff5,uVar7,&local_78,(ushort *)&DAT_180091960,
*(undefined4 *)(puVar13 + 0x20),*(undefined4 **)(puVar13 + 0x28),
*(undefined8 **)(puVar13 + 0x30),*(undefined8 *)(puVar13 + 0x38));
if (-1 < iVar6) {
lVar11 = lStack_48;
if (local_68[0] == 0) {
*param_4 = lStack_48;
lVar11 = 0;
}
if (lStack_38 != 0) {
*(undefined8 *)(puVar13 + -8) = 0x18004adf7;

}
if (lVar11 != 0) {
*(undefined8 *)(puVar13 + -8) = 0x18004ae1a;

}
}
}
if ((local_70 != (undefined8 *)0x0) && (*(int *)(local_70 + -1) == 0x70616548)) {
*(undefined8 *)(puVar13 + -8) = 0x18004ae48;

}
LAB_18004ae58:
uVar8 = local_30 ^ (ulonglong)&local_78;
*(undefined8 *)(puVar13 + -8) = 0x18004ae64;
FUN_180028070(uVar8);
return;
}
=========================================
Function at address: 0x18004ae90
Called functions addresses: 0x180047838 0x18002a7c0 0x18002a700 0x18000a418 0xEXTERNAL:00000040 0x18005dcd8 0xEXTERNAL:00000136 0x180028070 0x18005db58 0x180047eb0


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_18004ae90(byte *param_1,uint param_2,undefined8 param_3,undefined8 param_4,
undefined8 *param_5)

{
undefined8 *puVar1;
undefined8 uVar2;
HLOCAL hMem;
int iVar3;
DWORD DVar4;
undefined8 uVar5;
ulonglong uVar6;
ulonglong uVar7;
HLOCAL hMem_00;
undefined *puVar8;
undefined *puVar9;
uint uVar10;
LPWSTR psz;
undefined auStackY_c8 [32];
ushort local_88;
ushort uStack_86;
undefined8 *local_80;
int local_78 [2];
undefined8 local_70;
undefined8 uStack_68;
_CRYPTOAPI_BLOB local_60;
undefined8 local_50;
HLOCAL pvStack_48;
undefined8 local_40;
HLOCAL pvStack_38;
ulonglong local_30;

puVar8 = auStackY_c8;
puVar9 = auStackY_c8;
local_30 = DAT_180091970 ^ (ulonglong)&local_88;
*param_5 = 0;
local_40 = 0;
pvStack_38 = (HLOCAL)0x0;
local_50 = 0;
pvStack_48 = (HLOCAL)0x0;
local_70 = 0;
uStack_68 = 0;
iVar3 = FUN_18005dcd8(param_1,param_2);
if (((iVar3 != 0) ||
(local_60.cbData = param_2, local_60.pbData = param_1,
DVar4 = CertNameToStrW(1,&local_60,0x28000003,(LPWSTR)0x0,0), puVar9 = auStackY_c8,
0xffff < DVar4)) || (puVar9 = auStackY_c8, 0x7ffc < (ushort)DVar4)) goto LAB_18004b1ef;
uStack_86 = (short)(DVar4 + 3) * 2;
uVar10 = (uint)uStack_86;
local_80 = (undefined8 *)0x0;
puVar9 = auStackY_c8;
if (((uStack_86 == 0) ||
(uVar7 = (ulonglong)uStack_86, puVar9 = auStackY_c8, DAT_1800920e0 < uVar7)) ||
(uVar6 = DAT_1800920e8 + 8 + uVar7, puVar9 = auStackY_c8, uVar6 < uVar7)) {
LAB_18004afe4:
if (uVar10 <= uVar10 + 8) {
*(undefined8 *)(puVar9 + -8) = 0x18004b00a;

if (local_80 == (undefined8 *)0x0) goto LAB_18004b1ef;
*(undefined4 *)local_80 = 0x70616548;
local_80 = local_80 + 1;
}
if (local_80 == (undefined8 *)0x0) goto LAB_18004b1ef;
}
else {
uVar5 = FUN_18000a418(uVar6);
uVar10 = (uint)uStack_86;
if ((int)uVar5 != 0) {
uVar7 = (ulonglong)(uStack_86 + 8) + 0xf;
if (uVar7 <= uStack_86 + 8) {
uVar7 = 0xffffffffffffff0;
}
puVar8 = auStackY_c8 + -(uVar7 & 0xfffffffffffffff0);
local_80 = (undefined8 *)((longlong)&local_88 + -(uVar7 & 0xfffffffffffffff0));
}
puVar9 = puVar8;
if (local_80 == (undefined8 *)0x0) goto LAB_18004afe4;
*(undefined4 *)local_80 = 0x6b637453;
local_80 = local_80 + 1;
if (local_80 == (undefined8 *)0x0) {
uVar10 = (uint)uStack_86;
goto LAB_18004afe4;
}
}
puVar1 = local_80;
*(DWORD *)(puVar9 + 0x20) = DVar4;
*puVar1 = 0x3e0049003c;
psz = (LPWSTR)((longlong)local_80 + 6);
*(undefined8 *)(puVar9 + -8) = 0x18004b063;
CertNameToStrW(1,&local_60,0x28000003,psz,*(DWORD *)(puVar9 + 0x20));
*(undefined8 *)(puVar9 + -8) = 0x18004b071;
FUN_180047838((short *)&local_88);
*(undefined8 **)(puVar9 + 0x28) = &local_70;
*(undefined8 *)(puVar9 + 0x20) = param_4;
uVar5 = 1;
*(undefined8 *)(puVar9 + -8) = 0x18004b0ad;

if ((short)local_70 != 0) {
uVar5 = CONCAT71((int7)((ulonglong)uVar5 >> 8),-1 < iVar3);
*(int *)(puVar9 + 0x28) = iVar3;
*(undefined8 **)(puVar9 + 0x20) = &local_70;
*(undefined8 *)(puVar9 + -8) = 0x18004b0f9;

uVar2 = uStack_68;
*(undefined8 *)(puVar9 + -8) = 0x18004b118;

}
if (iVar3 == -0x3ffffddb) {
*(int **)(puVar9 + 0x38) = local_78;
*(undefined8 **)(puVar9 + 0x30) = &local_50;
*(undefined8 **)(puVar9 + 0x28) = &local_40;
*(undefined8 *)(puVar9 + -8) = 0x18004b154;
iVar3 = FUN_180047eb0(0xfffffff5,uVar5,&local_88,(ushort *)&DAT_180091960,
*(undefined4 *)(puVar9 + 0x20),*(undefined4 **)(puVar9 + 0x28),
*(undefined8 **)(puVar9 + 0x30),*(undefined8 *)(puVar9 + 0x38));
hMem = pvStack_38;
if (-1 < iVar3) {
hMem_00 = pvStack_48;
if (local_78[0] == 0) {
*param_5 = pvStack_48;
hMem_00 = (HLOCAL)0x0;
}
if (pvStack_38 != (HLOCAL)0x0) {
*(undefined8 *)(puVar9 + -8) = 0x18004b186;
LocalFree(hMem);
}
if (hMem_00 != (HLOCAL)0x0) {
*(undefined8 *)(puVar9 + -8) = 0x18004b19a;
LocalFree(hMem_00);
}
if (local_78[0] == 0) goto LAB_18004b1b3;
}
*(undefined8 *)(puVar9 + -8) = 0x18004b1b3;
FUN_18005db58(param_1,param_2);
}
LAB_18004b1b3:
if ((local_80 != (undefined8 *)0x0) && (*(int *)(local_80 + -1) == 0x70616548)) {
*(undefined8 *)(puVar9 + -8) = 0x18004b1df;

}
LAB_18004b1ef:
uVar7 = local_30 ^ (ulonglong)&local_88;
*(undefined8 *)(puVar9 + -8) = 0x18004b1fb;
FUN_180028070(uVar7);
return;
}
=========================================
Function at address: 0x18004b228
Called functions addresses: 0xEXTERNAL:0000003f 0xEXTERNAL:00000160 0x18002a77b 0xEXTERNAL:00000040 0x1800489ec 0x180028070 0xEXTERNAL:0000018d 0x180041d70 0xEXTERNAL:00000162


void FUN_18004b228(longlong param_1,PHANDLE param_2,uint param_3,wchar_t *param_4,wchar_t *param_5)

{
PCCERT_CONTEXT pCVar1;
PHANDLE ppvVar2;
NTSTATUS NVar3;
undefined8 uVar4;
undefined4 *AuthenticationInformation;
longlong lVar5;
ushort uVar6;
uint uVar7;
ushort uVar8;
longlong lVar9;
undefined4 *puVar10;
uint uVar11;
bool bVar12;
undefined auStackY_118 [32];
wchar_t *local_a8;
int local_a0;
int local_9c;
PVOID local_98;
ULONG local_90 [2];
PCCERT_CONTEXT local_88;
PHANDLE local_80;
_LUID local_78;
_QUOTA_LIMITS local_70;
ulonglong local_40;

local_40 = DAT_180091970 ^ (ulonglong)auStackY_118;
AuthenticationInformation = (undefined4 *)0x0;
bVar12 = DAT_180092784 == 0;
puVar10 = (undefined4 *)0x0;
*param_2 = (HANDLE)0x0;
uVar6 = 0;
local_a8 = (wchar_t *)0x0;
local_98 = (PVOID)0x0;
local_78.LowPart = 0;
local_78.HighPart = 0;
local_80 = param_2;
if (bVar12) goto LAB_18004b56b;
pCVar1 = *(PCCERT_CONTEXT *)(**(longlong **)(**(longlong **)(param_1 + 0x10) + 0x10) + 8);
local_88 = pCVar1;
uVar4 = FUN_1800489ec(pCVar1,&local_a8,&local_a0);
if ((int)uVar4 < 0) goto LAB_18004b56b;
if (local_a0 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041d70(DAT_180091000[2],10,&DAT_180085178,local_a8);
}
uVar11 = pCVar1->cbCertEncoded + 0x38;
AuthenticationInformation = puVar10;
if (0x37 < uVar11) {
uVar8 = uVar6;
uVar7 = uVar11;
if (param_4 != (wchar_t *)0x0) {
lVar9 = -1;
do {
lVar9 = lVar9 + 1;
} while (param_4[lVar9] != L'\0');
uVar8 = ((short)lVar9 + 1) * 2;
uVar7 = uVar8 + uVar11;
if (uVar7 < uVar11) goto LAB_18004b529;
}
lVar9 = -1;
uVar11 = uVar7;
if (param_5 != (wchar_t *)0x0) {
do {
lVar5 = lVar9;
lVar9 = lVar5 + 1;
} while (param_5[lVar9] != L'\0');
uVar6 = ((short)lVar5 + 2) * 2;
uVar11 = uVar6 + uVar7;
if (uVar11 < uVar7) goto LAB_18004b529;
}
AuthenticationInformation = (undefined4 *)LocalAlloc(0x40,(ulonglong)uVar11);
if (AuthenticationInformation != (undefined4 *)0x0) {
*AuthenticationInformation = 0xe;
AuthenticationInformation[1] = param_3 | 2;
puVar10 = AuthenticationInformation + 0xe;
if (param_4 != (wchar_t *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041d70(DAT_180091000[2],0xb,&DAT_180085178,param_4);
}
*(ushort *)(AuthenticationInformation + 2) = uVar8 - 2;
*(undefined4 **)(AuthenticationInformation + 4) = puVar10;
*(ushort *)((longlong)AuthenticationInformation + 10) = uVar8;
memcpy(puVar10,param_4,(ulonglong)uVar8);
puVar10 = (undefined4 *)
((longlong)puVar10 +
(ulonglong)*(ushort *)((longlong)AuthenticationInformation + 10));
}
if (param_5 != (wchar_t *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041d70(DAT_180091000[2],0xc,&DAT_180085178,param_5);
}
*(ushort *)(AuthenticationInformation + 6) = uVar6 - 2;
*(undefined4 **)(AuthenticationInformation + 8) = puVar10;
*(ushort *)((longlong)AuthenticationInformation + 0x1a) = uVar6;
memcpy(puVar10,param_5,(ulonglong)uVar6);
puVar10 = (undefined4 *)
((longlong)puVar10 +
(ulonglong)*(ushort *)((longlong)AuthenticationInformation + 0x1a));
}
AuthenticationInformation[10] = local_88->cbCertEncoded;
*(undefined4 **)(AuthenticationInformation + 0xc) = puVar10;
memcpy(puVar10,local_88->pbCertEncoded,(ulonglong)local_88->cbCertEncoded);
ppvVar2 = local_80;
NVar3 = LsaLogonUser(DAT_180092e08,(PLSA_STRING)&DAT_180092eb0,Network,DAT_180092e04,
AuthenticationInformation,uVar11,DAT_180092610,
(PTOKEN_SOURCE)&DAT_180092638,&local_98,local_90,&local_78,local_80,
&local_70,&local_9c);
if ((-1 < NVar3) && (-1 < local_9c)) {
LsaISetTokenDacl(*ppvVar2);
}
}
}
}
LAB_18004b529:
if (local_98 != (PVOID)0x0) {
LsaFreeReturnBuffer(local_98);
}
if (AuthenticationInformation != (undefined4 *)0x0) {
LocalFree(AuthenticationInformation);
}
if (local_a8 != (wchar_t *)0x0) {
LocalFree(local_a8);
}
LAB_18004b56b:
FUN_180028070(local_40 ^ (ulonglong)auStackY_118);
return;
}
=========================================
Function at address: 0x18004b59c
Called functions addresses: 0xEXTERNAL:00000032 0xEXTERNAL:000000c8 0xEXTERNAL:00000028 0xEXTERNAL:000000a3 0x18002a700 0x1800489ec 0x180028070 0xEXTERNAL:000000c0 0x180041d70 0xEXTERNAL:000000c2 0xEXTERNAL:00000029 0x18002a7c0 0x18000a418 0xEXTERNAL:00000040 0xEXTERNAL:000000b6 0x180047eb0


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_18004b59c(PCCERT_CONTEXT param_1,undefined8 param_2,undefined8 param_3,undefined8 *param_4)

{
longlong lVar1;
wchar_t *pwVar2;
LPCWSTR _Str;
HLOCAL hMem;
char cVar3;
int iVar4;
int iVar5;
int iVar6;
undefined8 uVar7;
LPCWSTR pWVar8;
wchar_t *pwVar9;
uint uVar10;
undefined4 uVar11;
ulonglong uVar12;
ulonglong uVar13;
HLOCAL hMem_00;
undefined *puVar14;
undefined *puVar15;
LPCWSTR pWVar16;
undefined auStack_e8 [32];
undefined8 local_c8;
undefined8 *local_c0;
undefined4 local_a8 [2];
wchar_t *local_a0;
wchar_t local_98;
int local_94;
int local_90 [2];
undefined8 local_88;
undefined8 local_80;
undefined8 uStack_78;
LPCWSTR local_70 [2];
undefined8 local_60;
undefined8 local_58;
HLOCAL pvStack_50;
undefined8 *local_48;
undefined8 local_40;
HLOCAL pvStack_38;
ulonglong local_30;

puVar15 = auStack_e8;
local_30 = DAT_180091970 ^ (ulonglong)local_a8;
pWVar8 = (LPCWSTR)0x0;
local_a8[0] = 0;
local_a0 = (wchar_t *)0x0;
local_70[0] = (LPCWSTR)0x0;
*param_4 = 0;
local_40 = 0;
pvStack_38 = (HLOCAL)0x0;
pWVar16 = (LPCWSTR)0x0;
local_58 = 0;
pvStack_50 = (HLOCAL)0x0;
local_80 = 0;
uStack_78 = 0;
local_88 = param_2;
local_60 = param_3;
local_48 = param_4;
uVar7 = FUN_1800489ec(param_1,local_70,&local_94);
_Str = local_70[0];
iVar6 = local_94;
if ((int)uVar7 < 0) goto LAB_18004bc62;
if (local_94 == 0) {
RtlInitUnicodeString(local_a8,local_70[0]);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
FUN_180041d70(DAT_180091000[2],0xe,&DAT_180085178,local_a0);
}
local_c0 = &local_80;
local_c8 = param_3;

puVar15 = auStack_e8;
joined_r0x00018004b87d:
if ((short)local_80 != 0) {
*(int *)(puVar15 + 0x28) = iVar4;
*(undefined8 **)(puVar15 + 0x20) = &local_80;
*(undefined8 *)(puVar15 + -8) = 0x18004b8bf;

uVar7 = uStack_78;
*(undefined8 *)(puVar15 + -8) = 0x18004b8de;

}
if (iVar4 == -0x3ffffddb) {
if (iVar6 == 0) {
*(undefined8 *)(puVar15 + -8) = 0x18004ba1e;
pwVar9 = wcschr(_Str,L'@');
if (pwVar9 != (wchar_t *)0x0) {
*(undefined8 *)(puVar15 + -8) = 0x18004ba3e;
RtlInitUnicodeString(local_70,pwVar9 + 1);
*(undefined8 *)(puVar15 + -8) = 0x18004ba53;
RtlAcquireResourceShared(&DAT_180092e40,1);
*(undefined8 *)(puVar15 + -8) = 0x18004ba6d;
cVar3 = RtlEqualUnicodeString(local_70,&DAT_180092e30,1);
*(undefined8 *)(puVar15 + -8) = 0x18004ba83;
RtlReleaseResource(&DAT_180092e40);
if (cVar3 != '\0') {
*pwVar9 = L'\0';
*(undefined8 *)(puVar15 + -8) = 0x18004baa5;
RtlInitUnicodeString(local_a8,_Str);
pwVar2 = local_a0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar7 = DAT_180091000[2];
*(undefined8 *)(puVar15 + -8) = 0x18004bad1;
FUN_180041d70(uVar7,0x10,&DAT_180085178,pwVar2);
}
*(undefined8 *)(puVar15 + 0x28) = 0;
*(undefined8 *)(puVar15 + 0x20) = local_60;
*(undefined8 *)(puVar15 + -8) = 0x18004bb0c;

*pwVar9 = L'@';
goto LAB_18004bb18;
}
}
LAB_18004bb6d:
*(undefined8 *)(puVar15 + -8) = 0x18004bb7b;
pWVar16 = _Str;
RtlInitUnicodeString(local_a8);
pwVar9 = local_a0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
pWVar16 = (LPCWSTR)0x12;
uVar7 = DAT_180091000[2];
*(undefined8 *)(puVar15 + -8) = 0x18004bba7;
FUN_180041d70(uVar7,0x12,&DAT_180085178,pwVar9);
}
uVar11 = 8;
}
else {
*(undefined8 *)(puVar15 + -8) = 0x18004b902;
pwVar9 = wcschr(_Str,L'.');
if (pwVar9 != (wchar_t *)0x0) {
*(undefined8 *)(puVar15 + -8) = 0x18004b922;
RtlInitUnicodeString(local_70,pwVar9 + 1);
*(undefined8 *)(puVar15 + -8) = 0x18004b937;
RtlAcquireResourceShared(&DAT_180092e40,1);
*(undefined8 *)(puVar15 + -8) = 0x18004b951;
cVar3 = RtlEqualUnicodeString(local_70,&DAT_180092e30,1);
*(undefined8 *)(puVar15 + -8) = 0x18004b967;
RtlReleaseResource(&DAT_180092e40);
if (cVar3 != '\0') {
local_98 = pwVar9[1];
pwVar9[0] = L'$';
pwVar9[1] = L'\0';
*(undefined8 *)(puVar15 + -8) = 0x18004b995;
RtlInitUnicodeString(local_a8,_Str);
pwVar2 = local_a0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar7 = DAT_180091000[2];
*(undefined8 *)(puVar15 + -8) = 0x18004b9bf;
FUN_180041d70(uVar7,0xf,&DAT_180085178,pwVar2);
}
uVar7 = local_60;
*(undefined8 *)(puVar15 + 0x28) = 0;
*(undefined8 *)(puVar15 + 0x20) = uVar7;
*(undefined8 *)(puVar15 + -8) = 0x18004b9f8;

*pwVar9 = L'.';
pwVar9[1] = local_98;
LAB_18004bb18:
if (iVar6 != -0x3ffffddb) goto LAB_18004bc24;
}
}
if (local_94 == 0) goto LAB_18004bb6d;
*(undefined8 *)(puVar15 + -8) = 0x18004bb3b;
pWVar16 = pWVar8;
RtlInitUnicodeString(local_a8);
pwVar9 = local_a0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
pWVar16 = (LPCWSTR)0x11;
uVar7 = DAT_180091000[2];
*(undefined8 *)(puVar15 + -8) = 0x18004bb66;
FUN_180041d70(uVar7,0x11,&DAT_180085178,pwVar9);
}
uVar11 = 10;
}
*(int **)(puVar15 + 0x38) = local_90;
*(undefined8 **)(puVar15 + 0x30) = &local_58;
*(undefined8 **)(puVar15 + 0x28) = &local_40;
*(undefined8 *)(puVar15 + -8) = 0x18004bbd3;
iVar6 = FUN_180047eb0(uVar11,pWVar16,(ushort *)local_a8,(ushort *)0x0,
*(undefined4 *)(puVar15 + 0x20),*(undefined4 **)(puVar15 + 0x28),
*(undefined8 **)(puVar15 + 0x30),*(undefined8 *)(puVar15 + 0x38));
hMem = pvStack_38;
if (-1 < iVar6) {
hMem_00 = pvStack_50;
if (local_90[0] == 0) {
*local_48 = pvStack_50;
hMem_00 = (HLOCAL)0x0;
}
if (pvStack_38 != (HLOCAL)0x0) {
*(undefined8 *)(puVar15 + -8) = 0x18004bc06;
LocalFree(hMem);
}
if (hMem_00 != (HLOCAL)0x0) {
*(undefined8 *)(puVar15 + -8) = 0x18004bc1a;
LocalFree(hMem_00);
}
}
}
}
else {
iVar4 = lstrlenW(local_70[0]);
iVar5 = lstrlenW(L"host/");
uVar10 = iVar4 + 1 + iVar5;
uVar13 = (ulonglong)uVar10 * 2;
puVar15 = auStack_e8;
if (((ulonglong)uVar10 != 0) &&
(puVar15 = auStack_e8, pWVar8 = pWVar16, uVar13 <= DAT_1800920e0)) {
uVar12 = DAT_1800920e8 + uVar13 + 8;
puVar15 = auStack_e8;
if ((uVar12 < uVar13) ||
(uVar7 = FUN_18000a418(uVar12), puVar15 = auStack_e8, (int)uVar7 == 0)) goto LAB_18004b6c0;
uVar12 = uVar13 + 0x17;
if (uVar12 <= uVar13 + 8) {
uVar12 = 0xffffffffffffff0;
}
lVar1 = -(uVar12 & 0xfffffffffffffff0);
pWVar8 = (LPCWSTR)((longlong)local_a8 + lVar1);
puVar15 = auStack_e8 + lVar1;
if (pWVar8 == (LPCWSTR)0x0) goto LAB_18004b6c0;
pWVar8[0] = L'';
pWVar8[1] = L'';
pWVar8 = (LPCWSTR)((longlong)&local_a0 + lVar1);
puVar15 = auStack_e8 + lVar1;
puVar14 = auStack_e8 + lVar1;
if (pWVar8 == (LPCWSTR)0x0) goto LAB_18004b6c0;
LAB_18004b701:
*(undefined8 *)(puVar14 + -8) = 0x18004b715;
_o_wcscpy_s(pWVar8,uVar10,L"host/");
*(undefined8 *)(puVar14 + -8) = 0x18004b72a;
_o_wcscat_s(pWVar8,uVar10);
*(undefined8 *)(puVar14 + -8) = 0x18004b73d;
RtlInitUnicodeString(local_a8,pWVar8);
pwVar9 = local_a0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(uint *)((longlong)DAT_180091000 + 0x1c) & 0x100) != 0)) {
uVar7 = DAT_180091000[2];
*(undefined8 *)(puVar14 + -8) = 0x18004b77d;
FUN_180041d70(uVar7,0xd,&DAT_180085178,pwVar9);
}
*(undefined8 **)(puVar14 + 0x28) = &local_80;
*(undefined8 *)(puVar14 + 0x20) = local_60;
*(undefined8 *)(puVar14 + -8) = 0x18004b7bc;

puVar15 = puVar14;
goto joined_r0x00018004b87d;
}
LAB_18004b6c0:
if (uVar13 + 8 < uVar13) {
LAB_18004b6f2:
puVar14 = puVar15;
if (pWVar8 != (LPCWSTR)0x0) goto LAB_18004b701;
}
else {
*(undefined8 *)(puVar15 + -8) = 0x18004b6e0;

if (pWVar8 != (LPCWSTR)0x0) {
pWVar8[0] = L'';
pWVar8[1] = L'';
pWVar8 = pWVar8 + 4;
goto LAB_18004b6f2;
}
}
}
LAB_18004bc24:
if (_Str != (LPCWSTR)0x0) {
*(undefined8 *)(puVar15 + -8) = 0x18004bc33;
LocalFree(_Str);
}
if ((pWVar8 != (LPCWSTR)0x0) && (*(int *)(pWVar8 + -4) == 0x70616548)) {
*(undefined8 *)(puVar15 + -8) = 0x18004bc60;

}
LAB_18004bc62:
uVar13 = local_30 ^ (ulonglong)local_a8;
*(undefined8 *)(puVar15 + -8) = 0x18004bc6e;
FUN_180028070(uVar13);
return;
}
=========================================
Function at address: 0x18004bc9c
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18004bc9c(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,&DAT_180085178,0x43,local_res20,4,0);
return;
}
=========================================
Function at address: 0x18004bcec
Called functions addresses: 0x18000909c


void FUN_18004bcec(undefined8 *param_1)

{
if ((param_1 != (undefined8 *)0x0) && ((HLOCAL)param_1[1] != (HLOCAL)0x0)) {
FUN_18000909c((HLOCAL)param_1[1]);
*param_1 = 0;
param_1[1] = 0;
}
return;
}
=========================================
Function at address: 0x18004bd20
Called functions addresses: 0xEXTERNAL:000000d8 0xEXTERNAL:000000dd 0xEXTERNAL:000000c9 0x18004bdc0 0xEXTERNAL:00000044


ulonglong SslEmptyCacheA(longlong param_1)

{
int iVar1;
ulonglong unaff_RBX;
undefined4 local_28 [2];
LPCWSTR local_20;
undefined local_18 [16];

/* 0x4bd20  26  SslEmptyCacheA */
local_28[0] = 0;
local_20 = (LPCWSTR)0x0;
if (param_1 != 0) {
RtlInitAnsiString(local_18);
iVar1 = RtlAnsiStringToUnicodeString(local_28,local_18,1);
if (iVar1 < 0) {
SetLastError(0x80090300);
return unaff_RBX;
}
}
SslEmptyCacheW(local_20);
if (local_20 != (LPCWSTR)0x0) {
RtlFreeUnicodeString(local_28);
}
return unaff_RBX;
}
=========================================
Function at address: 0x18004bdc0
Called functions addresses: 0xEXTERNAL:0000015e 0xEXTERNAL:000000d8 0x18000909c 0x18000a1f4 0xEXTERNAL:00000161 0x18002a77b 0xEXTERNAL:000000a3 0xEXTERNAL:0000015d 0xEXTERNAL:00000044 0xEXTERNAL:0000015c


bool SslEmptyCacheW(LPCWSTR param_1)

{
DWORD dwErrCode;
int iVar1;
undefined4 *ProtocolSubmitBuffer;
longlong lVar2;
uint SubmitBufferLength;
uint uVar3;
ULONG local_res18 [2];
DWORD local_res20 [2];
HANDLE local_48;
_LSA_STRING local_40;

/* 0x4bdc0  27  SslEmptyCacheW */
local_48 = (HANDLE)0x0;
dwErrCode = LsaConnectUntrusted(&local_48);
ProtocolSubmitBuffer = (undefined4 *)0x0;
if ((int)dwErrCode < 0) goto LAB_18004bf06;
RtlInitAnsiString(&local_40,"Schannel");
dwErrCode = LsaLookupAuthenticationPackage(local_48,&local_40,local_res18);
ProtocolSubmitBuffer = (undefined4 *)0x0;
if ((int)dwErrCode < 0) goto LAB_18004bf06;
SubmitBufferLength = 0x28;
if (param_1 == (LPCWSTR)0x0) {
ProtocolSubmitBuffer = (undefined4 *)FUN_18000a1f4(0x28);
if (ProtocolSubmitBuffer != (undefined4 *)0x0) {
LAB_18004beb5:
*ProtocolSubmitBuffer = 3;
ProtocolSubmitBuffer[8] = 3;
dwErrCode = LsaCallAuthenticationPackage
(local_48,local_res18[0],ProtocolSubmitBuffer,SubmitBufferLength,
(PVOID *)0x0,(PULONG)0x0,(PNTSTATUS)local_res20);
if ((-1 < (int)dwErrCode) && ((int)local_res20[0] < 0)) {
dwErrCode = local_res20[0];
}
goto LAB_18004bf06;
}
}
else {
iVar1 = lstrlenW(param_1);
uVar3 = iVar1 * 2 + 2;
SubmitBufferLength = iVar1 * 2 + 0x2a;
ProtocolSubmitBuffer = (undefined4 *)FUN_18000a1f4((ulonglong)SubmitBufferLength);
if (ProtocolSubmitBuffer != (undefined4 *)0x0) {
memcpy(ProtocolSubmitBuffer + 10,param_1,(ulonglong)uVar3);
lVar2 = -1;
*(undefined4 **)(ProtocolSubmitBuffer + 6) = ProtocolSubmitBuffer + 10;
do {
lVar2 = lVar2 + 1;
} while (param_1[lVar2] != L'\0');
*(short *)((longlong)ProtocolSubmitBuffer + 0x12) = (short)uVar3;
*(short *)(ProtocolSubmitBuffer + 4) = (short)lVar2 * 2;
goto LAB_18004beb5;
}
}
dwErrCode = 0x80090300;
LAB_18004bf06:
if (local_48 != (HANDLE)0x0) {
LsaDeregisterLogonProcess(local_48);
}
if (ProtocolSubmitBuffer != (undefined4 *)0x0) {
FUN_18000909c(ProtocolSubmitBuffer);
}
if (-1 >= (int)dwErrCode) {
SetLastError(dwErrCode);
}
return -1 < (int)dwErrCode;
}
=========================================
Function at address: 0x18004bf60
Called functions addresses: 0x180041cb0 0x18002a7c0 0x180028070


void FUN_18004bf60(undefined param_1,undefined param_2,undefined param_3,undefined param_4,
undefined8 *param_5,undefined4 *param_6,int *param_7)

{
int iVar1;
undefined auStack_58 [48];
undefined8 local_28;
undefined8 local_20;
undefined4 local_18;
undefined4 local_14;
ulonglong local_10;

local_10 = DAT_180091970 ^ (ulonglong)auStack_58;
local_28 = 0;
local_20 = 0;
*param_5 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180085198);
}
local_18 = DAT_1800925d4;
local_14 = DAT_1800925d8;

if (-1 < iVar1) {

if (iVar1 < 0) {

}
else {
*param_5 = local_28;
*param_6 = 0x10;
}
}
*param_7 = iVar1;
FUN_180028070(local_10 ^ (ulonglong)auStack_58);
return;
}
=========================================
Function at address: 0x18004c0ac
Called functions addresses: 0x1800595e0 0xEXTERNAL:0000014b 0x180041cb0 0x18002a7c0 0x18002a700 0x18000a418 0x180028070 0x18005ddd0 0xEXTERNAL:0000002a


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_18004c0ac(undefined8 param_1,undefined4 *param_2,ulonglong param_3,uint param_4,
undefined8 *param_5,undefined4 *param_6,int *param_7)

{
ushort uVar1;
longlong lVar2;
char cVar3;
int iVar4;
uint uVar5;
undefined4 *puVar6;
undefined8 uVar7;
ulonglong uVar8;
ulonglong uVar9;
undefined *puVar10;
undefined *puVar11;
undefined4 *puVar12;
undefined4 *puVar13;
int *piVar14;
undefined auStack_b8 [48];
undefined4 local_88;
undefined8 local_84;
undefined4 local_7c;
undefined2 local_78;
undefined2 uStack_76;
undefined4 local_74;
ulonglong local_70;
undefined4 local_68;
undefined4 local_64;
int local_60 [2];
int local_58;
char local_50;
undefined local_40 [8];
byte local_38;
ulonglong local_28;

puVar10 = auStack_b8;
local_28 = DAT_180091970 ^ (ulonglong)&local_88;
puVar12 = (undefined4 *)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180085198);
}

if (cVar3 == '\0') {
LAB_18004c14b:
iVar4 = -0x3fffff1b;
puVar11 = puVar10;
}
else {
if ((local_38 & 0x40) == 0) {
puVar13 = param_2;
if (0x27 < param_4) goto LAB_18004c1a3;
}
else if (0x17 < param_4) {
local_88 = *param_2;
local_84 = *(undefined8 *)(param_2 + 1);
local_68 = param_2[5];
local_78 = *(undefined2 *)(param_2 + 3);
uStack_76 = *(undefined2 *)((longlong)param_2 + 0xe);
local_70 = (ulonglong)(uint)param_2[4];
local_7c = 0;
local_74 = 0;
local_64 = 0;
puVar13 = &local_88;
LAB_18004c1a3:
uVar1 = *(ushort *)(puVar13 + 4);
if ((uVar1 & 1) == 0) {
uVar8 = *(ulonglong *)(puVar13 + 6);
if (uVar8 == 0) {
if (uVar1 != 0) goto LAB_18004c1be;
}
else if (uVar1 == 0) {
*(undefined8 *)(puVar13 + 6) = 0;
}
else {
if (param_3 <= uVar8) {
uVar8 = uVar8 - param_3;
}
if ((((uVar8 == 0) || (param_4 < uVar8)) || ((ulonglong)param_4 < uVar8 + uVar1)) ||
((uVar8 < 0x28 || ((uVar8 & 1) != 0)))) goto LAB_18004c1be;
*(ushort *)((longlong)puVar13 + 0x12) = uVar1;
*(ulonglong *)(puVar13 + 6) = uVar8 + (longlong)param_2;
}

puVar11 = auStack_b8;
if (iVar4 < 0) goto LAB_18004c1c3;
piVar14 = puVar13 + 1;
if ((puVar13[2] == 0 && *piVar14 == 0) && ((puVar13[8] & 0x30000) == 0)) {
LAB_18004c298:
piVar14 = local_60;
}
else {
if (local_50 == '\0') {
iVar4 = -0x3fffff9f;
puVar11 = auStack_b8;
goto LAB_18004c1c3;
}
if (puVar13[2] == 0 && *piVar14 == 0) goto LAB_18004c298;
}
lVar2 = *(longlong *)(puVar13 + 6);
puVar11 = auStack_b8;
puVar6 = (undefined4 *)0x0;
if (lVar2 != 0) {
uVar1 = *(ushort *)(puVar13 + 4);
uVar8 = (ulonglong)uVar1;
puVar11 = auStack_b8;
puVar6 = puVar12;
if ((uVar1 != 0) &&
(puVar11 = auStack_b8, *(short *)(lVar2 + (uVar8 - 2 & 0xfffffffffffffffe)) != 0)) {
if (0xfffd < uVar1) goto LAB_18004c1be;
uVar9 = uVar8 + 2;
if (uVar9 <= *(ushort *)((longlong)puVar13 + 0x12)) {
*(undefined2 *)(lVar2 + (ulonglong)(uVar1 >> 1) * 2) = 0;
*(short *)(puVar13 + 4) = *(short *)(puVar13 + 4) + 2;
puVar11 = auStack_b8;
goto LAB_18004c3d6;
}
puVar10 = auStack_b8;
puVar6 = (undefined4 *)0x0;
if (((DAT_1800920e0 < uVar9) ||
(uVar8 = uVar8 + DAT_1800920e8 + 10, puVar10 = auStack_b8, puVar6 = puVar12,
uVar8 < uVar9)) ||
(uVar7 = FUN_18000a418(uVar8), puVar10 = auStack_b8, (int)uVar7 == 0)) {
LAB_18004c362:
if ((ulonglong)*(ushort *)(puVar13 + 4) + 2 <=
(ulonglong)*(ushort *)(puVar13 + 4) + 10) {
*(undefined8 *)(puVar10 + -8) = 0x18004c38a;

if (puVar6 == (undefined4 *)0x0) goto LAB_18004c14b;
*puVar6 = 0x70616548;
puVar6 = puVar6 + 2;
}
puVar11 = puVar10;
if (puVar6 == (undefined4 *)0x0) goto LAB_18004c14b;
}
else {
uVar8 = (ulonglong)*(ushort *)(puVar13 + 4) + 0x19;
if (uVar8 <= (ulonglong)*(ushort *)(puVar13 + 4) + 10) {
uVar8 = 0xffffffffffffff0;
}
lVar2 = -(uVar8 & 0xfffffffffffffff0);
puVar6 = (undefined4 *)((longlong)&local_88 + lVar2);
puVar10 = auStack_b8 + lVar2;
if (puVar6 == (undefined4 *)0x0) goto LAB_18004c362;
*puVar6 = 0x6b637453;
puVar6 = (undefined4 *)((longlong)&local_84 + lVar2 + 4);
puVar10 = auStack_b8 + lVar2;
puVar11 = auStack_b8 + lVar2;
if (puVar6 == (undefined4 *)0x0) goto LAB_18004c362;
}
uVar1 = *(ushort *)(puVar13 + 4);
uVar7 = *(undefined8 *)(puVar13 + 6);
*(undefined8 *)(puVar11 + -8) = 0x18004c3c5;
_o_wcsncpy_s(puVar6,(ulonglong)uVar1 + 2 >> 1,uVar7,uVar1 >> 1);
*(undefined2 *)((longlong)puVar6 + (ulonglong)(*(ushort *)(puVar13 + 4) >> 1) * 2) = 0;
}
}
LAB_18004c3d6:
uVar5 = puVar13[8];
if ((uVar5 & 0xfff7ffff) != 0) {
puVar12 = puVar6;
if (puVar6 == (undefined4 *)0x0) {
puVar12 = *(undefined4 **)(puVar13 + 6);
}
*(undefined4 **)(puVar11 + 0x20) = puVar12;
*(undefined8 *)(puVar11 + -8) = 0x18004c406;
uVar7 = FUN_1800595e0(DAT_1800927f0,uVar5,piVar14,local_58,*(undefined8 *)(puVar11 + 0x20)
);
iVar4 = (int)uVar7;
uVar5 = puVar13[8];
if ((uVar5 & 2) != 0) {
*(undefined8 *)(puVar11 + -8) = 0x18004c414;
FUN_18005ddd0();
uVar5 = puVar13[8];
}
}
if ((uVar5 >> 0x13 & 1) != 0) {
*(undefined8 *)(puVar11 + -8) = 0x18004c426;
CertFreeCertificateChainEngine((HCERTCHAINENGINE)0x0);
*(undefined8 *)(puVar11 + -8) = 0x18004c437;
CertFreeCertificateChainEngine((HCERTCHAINENGINE)0x1);
}
*param_5 = 0;
*param_6 = 0;
if ((puVar6 != (undefined4 *)0x0) && (puVar6[-2] == 0x70616548)) {
*(undefined8 *)(puVar11 + -8) = 0x18004c47d;

}
goto LAB_18004c1c3;
}
}
LAB_18004c1be:
iVar4 = -0x3ffffff3;
puVar11 = auStack_b8;
}
LAB_18004c1c3:
*param_7 = iVar4;
uVar8 = local_28 ^ (ulonglong)&local_88;
*(undefined8 *)(puVar11 + -8) = 0x18004c1da;
FUN_180028070(uVar8);
return;
}
=========================================
Function at address: 0x18004c488
Called functions addresses: 0x18000909c 0x18000a1f4 0x18002a7c0 0x18005916c


undefined8
FUN_18004c488(undefined8 param_1,undefined4 *param_2,ulonglong param_3,uint param_4,
undefined8 *param_5,undefined4 *param_6,int *param_7)

{
ushort uVar1;
char cVar2;
int iVar3;
undefined8 *puVar4;
undefined8 uVar5;
ulonglong uVar6;
undefined4 *puVar7;
undefined8 local_res8;
undefined local_68 [8];
byte local_60;
undefined4 local_50;
undefined8 local_4c;
undefined4 local_44;
undefined2 local_40;
undefined2 local_3e;
undefined4 local_3c;
ulonglong local_38;
undefined4 local_30;
undefined4 local_2c;

*param_5 = 0;
*param_6 = 0;
local_res8 = param_1;

if (cVar2 == '\0') {
iVar3 = -0x3fffff1b;
goto LAB_18004c559;
}
if ((local_60 & 0x40) == 0) {
puVar7 = param_2;
if (0x27 < param_4) goto LAB_18004c542;
}
else if (0x17 < param_4) {
local_50 = *param_2;
local_4c = *(undefined8 *)(param_2 + 1);
local_30 = param_2[5];
local_40 = *(undefined2 *)(param_2 + 3);
local_3e = *(undefined2 *)((longlong)param_2 + 0xe);
local_38 = (ulonglong)(uint)param_2[4];
local_44 = 0;
local_3c = 0;
local_2c = 0;
puVar7 = &local_50;
LAB_18004c542:
uVar6 = *(ulonglong *)(puVar7 + 6);
uVar1 = *(ushort *)(puVar7 + 4);
if (uVar6 == 0) {
joined_r0x00018004c5c5:
if (uVar1 != 0) goto LAB_18004c554;
}
else {
if (uVar1 != 0) {
if (param_3 <= uVar6) {
uVar6 = uVar6 - param_3;
}
if ((((uVar6 == 0) || (param_4 < uVar6)) || ((ulonglong)param_4 < uVar6 + uVar1)) ||
((uVar6 < 0x28 || ((uVar6 & 1) != 0)))) goto LAB_18004c554;
*(ushort *)((longlong)puVar7 + 0x12) = uVar1;
*(ulonglong *)(puVar7 + 6) = uVar6 + (longlong)param_2;
uVar1 = uVar1 & 1;
goto joined_r0x00018004c5c5;
}
*(undefined8 *)(puVar7 + 6) = 0;
}
puVar4 = (undefined8 *)FUN_18000a1f4(0x1c);
if (puVar4 == (undefined8 *)0x0) {
iVar3 = -0x3fffffe9;
}
else {
uVar5 = FUN_18005916c(DAT_1800927f0,(byte)puVar7[8],puVar4);
iVar3 = (int)uVar5;
if ((-1 < iVar3) &&


if (iVar3 < 0) {

}
else {
*param_5 = local_res8;
*param_6 = 0x1c;
}
}
FUN_18000909c(puVar4);
}
goto LAB_18004c559;
}
LAB_18004c554:
iVar3 = -0x3ffffff3;
LAB_18004c559:
*param_7 = iVar3;
return 0;
}
=========================================
Function at address: 0x18004c6a0
Called functions addresses: 0x180049ef4 0x18000e850 0x180041cb0 0x18002a7c0 0x18004c0ac 0x18004bf60 0x18004835c 0x18004a314 0x18004c488


ulonglong FUN_18004c6a0(undefined8 param_1,int *param_2,undefined *param_3,ulonglong param_4,
undefined8 *param_5,undefined4 *param_6,int *param_7)

{
char cVar1;
int iVar2;
undefined4 uVar3;
ulonglong uVar4;
undefined4 extraout_var;
undefined4 extraout_var_00;
undefined8 uVar5;
undefined2 uVar6;
int *piVar7;
uint uVar8;
undefined *puVar9;
uint local_20;

piVar7 = param_2;
puVar9 = param_3;
uVar4 = param_4;

if (cVar1 == '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180085198);
}
return 0xc00000e5;
}
if ((param_2 == (int *)0x0) || (uVar8 = (uint)param_4, uVar8 < 4)) {
return 0xc000000d;
}
uVar5 = 0;
iVar2 = FUN_18000e850(0,piVar7,puVar9,uVar4);
if (iVar2 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090302;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090302;
}
uVar6 = 0xd;
}
else {
if (*param_2 == 2) {
uVar4 = FUN_18004835c(uVar5,param_2,(ulonglong)puVar9,uVar8,param_5,param_6,param_7);
return uVar4;
}
if (*param_2 == 6) {
if ((local_20 & 0x10) != 0) {
uVar3 = FUN_18004a314(uVar5,(longlong)param_2,puVar9,uVar8,param_5,param_6,param_7);
return CONCAT44(extraout_var,uVar3);
}
}
else if (*param_2 == 7) {
if ((local_20 & 0x10) == 0) {
if ((local_20 & 0x200) == 0) {
return 0xc0000061;
}
iVar2 = FUN_180049ef4(uVar5,(longlong)param_2,(ulonglong)puVar9,uVar8,param_5,param_6,
param_7);
return CONCAT44(extraout_var_00,iVar2);
}
}
else {
if (*param_2 == 4) {
uVar4 = FUN_18004c488(uVar5,param_2,(ulonglong)param_3,uVar8,param_5,param_6,param_7);
return uVar4;
}
if (*param_2 == 3) {
uVar4 = FUN_18004c0ac(uVar5,param_2,(ulonglong)param_3,uVar8,param_5,param_6,param_7);
return uVar4;
}
if (*param_2 == 8) {
uVar4 = FUN_18004bf60((char)uVar5,(char)piVar7,(char)puVar9,(char)uVar4,param_5,param_6,
param_7);
return uVar4;
}
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090302;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090302;
}
uVar6 = 0xe;
}
FUN_180041cb0(DAT_180091000[2],uVar6,&DAT_180085198);
return 0x80090302;
}
=========================================
Function at address: 0x18004c960
Called functions addresses: 0x18004c6a0


ulonglong FUN_18004c960(undefined8 param_1,int *param_2,undefined *param_3,ulonglong param_4,
undefined8 *param_5,undefined4 *param_6,int *param_7)

{
ulonglong uVar1;

if ((param_2 == (int *)0x0) || ((uint)param_4 < 4)) {
uVar1 = 0xc000000d;
}
else {
if (*param_2 == 2) {
uVar1 = FUN_18004c6a0(param_1,param_2,param_3,param_4,param_5,param_6,param_7);
return uVar1;
}
uVar1 = 0x80090302;
}
return uVar1;
}
=========================================
Function at address: 0x18004c990
Called functions addresses: 0x18000e850 0x18004c0ac 0x18004bf60 0x18004c488


undefined8
FUN_18004c990(undefined8 param_1,int *param_2,undefined *param_3,ulonglong param_4,
undefined8 *param_5,undefined4 *param_6,int *param_7)

{
int iVar1;
int iVar2;
undefined8 uVar3;
undefined *puVar4;
uint uVar5;

uVar5 = (uint)param_4;
if ((param_2 == (int *)0x0) || (uVar5 < 4)) {
return 0xc000000d;
}
iVar1 = *param_2;
puVar4 = param_3;
iVar2 = FUN_18000e850(0,param_2,param_3,param_4);
if (iVar2 != 0) {
*param_5 = 0;
*param_6 = 0;
if (iVar1 == 3) {
uVar3 = FUN_18004c0ac(param_5,param_2,(ulonglong)param_3,uVar5,param_5,param_6,param_7);
return uVar3;
}
if (iVar1 == 4) {
uVar3 = FUN_18004c488(param_5,param_2,(ulonglong)param_3,uVar5,param_5,param_6,param_7);
return uVar3;
}
if (iVar1 == 8) {
uVar3 = FUN_18004bf60((char)param_5,(char)param_6,(char)puVar4,(char)param_4,param_5,param_6,
param_7);
return uVar3;
}
}
return 0x80090302;
}
=========================================
Function at address: 0x18004ca84
Called functions addresses: 0x180041cdc 0x18007acd0 0x18004ce04 0x180041cb0 0x18002a7c0 0x18007ad88 0x18007a8f8


ulonglong FUN_18004ca84(longlong param_1,undefined8 *param_2,uint *param_3)

{
uint uVar1;
ulonglong uVar2;
longlong lVar3;
undefined2 uVar4;
uint *puVar5;
uint *puVar6;
ulonglong uVar7;
uint *puVar8;
uint *puVar10;
ulonglong uVar11;
uint uVar12;
uint *local_res10;
undefined8 *local_res18 [2];
uint local_48 [4];
uint *puVar9;

puVar6 = (uint *)*param_2;
puVar9 = (uint *)0x0;
puVar8 = (uint *)0x0;
uVar12 = *param_3;
uVar7 = 0;
local_res18[0] = (undefined8 *)0x0;
local_res10 = (uint *)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_1800851a8);
}
uVar1 = FUN_18007acd0(puVar6,uVar12);
if (uVar1 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_1800851a8);
}
uVar7 = 0x80090309;
}
else {
local_48[0] = 0;
local_48[1] = 0;
local_48[2] = 0;
local_48[3] = 0;
puVar10 = puVar9;
if (puVar6 != (uint *)0x0) {
for (puVar5 = puVar6 + 2; puVar5 < puVar6 + (ulonglong)*puVar6 * 4 + 2; puVar5 = puVar5 + 4) {
if (*puVar5 == 1) {
if (puVar5 != (uint *)0x0) {
uVar11 = (ulonglong)puVar5[1];
uVar2 = FUN_18007ad88((longlong *)local_res18,*(undefined8 *)(puVar5 + 2),puVar5[1]);
uVar7 = uVar2 & 0xffffffff;
puVar10 = puVar8;
if ((int)uVar2 < 0) {
puVar10 = puVar9;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(puVar10 = puVar8, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_1800851a8,(int)uVar2);
puVar10 = puVar9;
}
goto LAB_18004cb94;
}
uVar1 = FUN_18004ce04(param_1,local_res18[0]);
uVar7 = (ulonglong)uVar1;
if (-1 < (int)uVar1) {
uVar1 = FUN_18007a8f8(local_res18[0],local_48,uVar11,puVar6,&local_res10);
uVar7 = (ulonglong)uVar1;
puVar10 = local_res10;
if ((int)uVar1 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xf,&DAT_1800851a8,uVar1);
puVar10 = local_res10;
}
}
else {
uVar12 = 0;
puVar6 = local_res10;
if ((local_res10 != (uint *)0x0) &&
(uVar12 = *local_res10 * 0x10 + 8, *local_res10 != 0)) {
uVar2 = (ulonglong)*local_res10;
puVar8 = local_res10 + 3;
do {
uVar1 = *puVar8;
puVar8 = puVar8 + 4;
uVar12 = uVar12 + (uVar1 + 7 & 0xfffffff8);
uVar2 = uVar2 - 1;
} while (uVar2 != 0);
}
}
goto LAB_18004cb94;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18004cb94;
uVar4 = 0xe;
goto LAB_18004cb7d;
}
break;
}
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
uVar4 = 0xc;
LAB_18004cb7d:
FUN_180041cb0(DAT_180091000[2],uVar4,&DAT_1800851a8);
puVar10 = puVar9;
}
LAB_18004cb94:
if (puVar6 != (uint *)0x0) {
uVar2 = 0;
if (*puVar6 != 0) {
do {
lVar3 = uVar2 + 1;
if (((uint *)((ulonglong)uVar12 + (longlong)puVar6) < *(uint **)(puVar6 + lVar3 * 4)) ||
((uint *)((ulonglong)uVar12 + (longlong)puVar6) < puVar6)) {
uVar7 = 0x80090309;
goto LAB_18004cc11;
}
uVar1 = (int)uVar2 + 1;
uVar2 = (ulonglong)uVar1;
*(ulonglong *)(puVar6 + lVar3 * 4) = (ulonglong)(puVar6[lVar3 * 4] - (int)puVar6);
} while (uVar1 < *puVar6);
}
if (puVar10 == (uint *)0x0) goto LAB_18004cc3b;
if ((uint *)*param_2 != puVar10) {

*param_2 = puVar10;
puVar10 = (uint *)0x0;
*param_3 = uVar12;
}
}
LAB_18004cc11:
if (puVar10 != (uint *)0x0) {

}
}
LAB_18004cc3b:
if (local_res18[0] != (undefined8 *)0x0) {

}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x10,&DAT_1800851a8,(int)uVar7);
}
return uVar7;
}
=========================================
Function at address: 0x18004ce04
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000018a


int FUN_18004ce04(longlong param_1,undefined8 param_2)

{
int iVar1;
undefined2 uVar2;
undefined8 uVar3;
undefined8 uVar4;

if (param_1 == 0) {
param_1 = 0;
uVar4 = 0;
uVar3 = 0;
}
else {
uVar3 = 2;
uVar4 = 2;
}
iVar1 = LsaIFilterSids(0,uVar3,uVar4,0,param_1,3,param_2,0,0,0);
if (iVar1 < 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar1;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return iVar1;
}
uVar2 = 0x11;
}
else {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar1;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return iVar1;
}
uVar2 = 0x12;
}
FUN_180041cdc(DAT_180091000[2],uVar2,&DAT_1800851a8,iVar1);
return iVar1;
}
=========================================
Function at address: 0x18004cec0
Called functions addresses: 0x18002a7c0


undefined8 FUN_18004cec0(ulonglong param_1)

{
undefined8 uVar1;
uint uVar2;

uVar2 = (int)param_1 + 7U & 0xfffffff8;
if (uVar2 < param_1) {
return 0;
}

return uVar1;
}
=========================================
Function at address: 0x18004cf00
Called functions addresses: 0x18002a7c0


void FUN_18004cf00(void)

{

return;
}
=========================================
Function at address: 0x18004cf24
Called functions addresses: 0xEXTERNAL:0000016b 0xEXTERNAL:0000004b 0xEXTERNAL:00000040 0xEXTERNAL:000000df 0xEXTERNAL:00000062 0x180028070


void FUN_18004cf24(void)

{
longlong *plVar1;
longlong lVar2;
undefined **ppuVar3;
undefined auStack_48 [32];
undefined *local_28 [3];
ulonglong local_10;

local_10 = DAT_180091970 ^ (ulonglong)auStack_48;
lVar2 = 3;
local_28[0] = (undefined *)&DAT_180092678;
ppuVar3 = local_28;
local_28[1] = (undefined *)&DAT_1800926a0;
local_28[2] = &DAT_1800926c8;
do {
plVar1 = (longlong *)*ppuVar3;
if (*plVar1 != 0) {
RtlDeregisterWait();
*plVar1 = 0;
}
if ((HKEY)plVar1[2] != (HKEY)0x0) {
RegCloseKey((HKEY)plVar1[2]);
plVar1[2] = 0;
}
if ((HANDLE)plVar1[1] != (HANDLE)0x0) {
CloseHandle((HANDLE)plVar1[1]);
plVar1[1] = 0;
}
ppuVar3 = ppuVar3 + 1;
lVar2 = lVar2 + -1;
} while (lVar2 != 0);
if (DAT_180092ec8 != 0) {
RtlDeregisterWait();
DAT_180092ec8 = 0;
}
if (DAT_180092ed0 != (HANDLE)0x0) {
BCryptUnregisterConfigChangeNotify(DAT_180092ed0);
DAT_180092ed0 = (HANDLE)0x0;
}
if (DAT_180092f10 != (HLOCAL)0x0) {
LocalFree(DAT_180092f10);
DAT_180092f10 = (HLOCAL)0x0;
}
if (DAT_180092f48 != (HLOCAL)0x0) {
LocalFree(DAT_180092f48);
DAT_180092f48 = (HLOCAL)0x0;
}
FUN_180028070(local_10 ^ (ulonglong)auStack_48);
return;
}
=========================================
Function at address: 0x18004d070
Called functions addresses: 0x1800237c0 0xEXTERNAL:00000074 0x18002516c


ulonglong FUN_18004d070(void)

{
ulonglong uVar1;
undefined8 uVar2;
bool bVar3;

uVar1 = 0;
LOCK();
bVar3 = DAT_180092f44 == 0;
if (bVar3) {
DAT_180092f44 = 1;
}
else {
uVar1 = (ulonglong)DAT_180092f44;
}
UNLOCK();
if (bVar3) {
uVar2 = 100;
Sleep(100);
LOCK();
DAT_180092f44 = 0;
UNLOCK();
FUN_1800237c0(uVar2);
uVar1 = FUN_18002516c(DAT_180085348);
}
return uVar1;
}
=========================================
Function at address: 0x18004d0c0
Called functions addresses: 0x18000909c 0x180017e94


undefined8 * FUN_18004d0c0(undefined8 *param_1,ulonglong param_2)

{
*param_1 = &PTR_FUN_18007c298;
if ((param_2 & 1) != 0) {
if ((param_2 & 4) == 0) {
FUN_18000909c(param_1);
}
else {
FUN_180017e94();
}
}
return param_1;
}
=========================================
Function at address: 0x18004d100
Called functions addresses: 0x18000909c 0x180017e94


undefined8 * FUN_18004d100(undefined8 *param_1,ulonglong param_2)

{
*param_1 = &PTR_FUN_18007c298;
if ((param_2 & 1) != 0) {
if ((param_2 & 4) == 0) {
FUN_18000909c(param_1);
}
else {
FUN_180017e94();
}
}
return param_1;
}
=========================================
Function at address: 0x18004d140
Called functions addresses: 0x18000909c 0x180017e94


undefined8 * FUN_18004d140(undefined8 *param_1,ulonglong param_2)

{
*param_1 = &PTR_FUN_18007c298;
if ((param_2 & 1) != 0) {
if ((param_2 & 4) == 0) {
FUN_18000909c(param_1);
}
else {
FUN_180017e94();
}
}
return param_1;
}
=========================================
Function at address: 0x18004d180
Called functions addresses: 0x180028364


undefined8 * FUN_18004d180(undefined8 *param_1,ulonglong param_2)

{
*param_1 = &PTR_FUN_18007c298;
if ((param_2 & 1) != 0) {
_o_free(param_1,8);
}
return param_1;
}
=========================================
Function at address: 0x18004d1c0
Called functions addresses: 0x18000a1f4


void FUN_18004d1c0(undefined8 param_1,uint param_2)

{
FUN_18000a1f4((ulonglong)param_2);
return;
}
=========================================
Function at address: 0x18004d1d0
Called functions addresses: 0x18000909c


void FUN_18004d1d0(undefined8 param_1,HLOCAL param_2)

{
FUN_18000909c(param_2);
return;
}
=========================================
Function at address: 0x18004d1e0
Called functions addresses: 0x180028d90


void FUN_18004d1e0(undefined8 param_1,int param_2,undefined param_3,undefined8 param_4,
undefined8 param_5,undefined8 param_6,longlong param_7)

{
uint *puVar1;
ulonglong uVar2;
bool bVar3;
bool bVar4;
ulonglong uVar5;
uint uVar6;

uVar5 = 0;
if (param_7 != 0) {
bVar4 = false;
if (param_2 == 0) {
*(undefined4 *)(param_7 + 0x24) = 0;
*(undefined *)(param_7 + 0x28) = 0;
*(undefined8 *)(param_7 + 0x10) = 0;
*(undefined8 *)(param_7 + 0x18) = 0;
if (*(short *)(param_7 + 0x2a) != 0) {
memset(*(void **)(param_7 + 0x30),0,
(longlong)((int)(*(ushort *)(param_7 + 0x2a) - 1) / 0x20 + 1) << 2);
}
}
else if (param_2 == 1) {
*(undefined8 *)(param_7 + 0x10) = param_4;
*(undefined8 *)(param_7 + 0x18) = param_5;
*(undefined *)(param_7 + 0x28) = param_3;
*(undefined4 *)(param_7 + 0x24) = 1;
if (*(short *)(param_7 + 0x2a) != 0) {
do {
bVar3 = bVar4;
if (((*(byte *)(uVar5 + *(longlong *)(param_7 + 0x40)) <= *(byte *)(param_7 + 0x28)) ||
(*(byte *)(param_7 + 0x28) == 0)) &&
((uVar2 = *(ulonglong *)(*(longlong *)(param_7 + 0x38) + uVar5 * 8), uVar2 == 0 ||
(((*(ulonglong *)(param_7 + 0x10) & uVar2) != 0 &&
((*(ulonglong *)(param_7 + 0x18) & uVar2) == *(ulonglong *)(param_7 + 0x18))))))) {
bVar3 = true;
}
uVar6 = 1 << ((byte)uVar5 & 0x1f);
if (bVar3) {
puVar1 = (uint *)(*(longlong *)(param_7 + 0x30) + (uVar5 >> 5) * 4);
*puVar1 = *puVar1 | uVar6;
}
else {
puVar1 = (uint *)(*(longlong *)(param_7 + 0x30) + (uVar5 >> 5) * 4);
*puVar1 = *puVar1 & ~uVar6;
}
uVar6 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar6;
} while (uVar6 < *(ushort *)(param_7 + 0x2a));
return;
}
}
}
return;
}
=========================================
Function at address: 0x18004d2f0
Called functions addresses: 0xEXTERNAL:000000ad 0xEXTERNAL:000000ae 0xEXTERNAL:000000af


undefined8 FUN_18004d2f0(int param_1,longlong param_2,undefined4 *param_3,undefined8 param_4)

{
undefined uVar1;
undefined4 uVar2;
undefined8 uVar3;

*param_3 = 0;
if (param_1 == 4) {
uVar3 = EtwGetTraceLoggerHandle(param_4);
uVar1 = EtwGetTraceEnableLevel(uVar3);
uVar2 = EtwGetTraceEnableFlags(uVar3);
}
else {
if (param_1 != 5) {
return 0x57;
}
uVar3 = 0;
uVar2 = 0;
uVar1 = 0;
}
if (((*(byte *)(param_2 + 0x1a) & 2) != 0) && (*(longlong *)(param_2 + 0x10) != 0)) {
param_2 = *(longlong *)(param_2 + 0x10);
}
*(undefined4 *)(param_2 + 0x1c) = uVar2;
*(undefined8 *)(param_2 + 0x10) = uVar3;
*(undefined *)(param_2 + 0x19) = uVar1;
return 0;
}
=========================================
Function at address: 0x18004d388
Called functions addresses: 0x18004d4e4


undefined4 FUN_18004d388(undefined *param_1,uint param_2,short *param_3,byte param_4)

{
undefined8 uVar1;
ushort uVar2;
uint uVar3;
int iVar4;
ulonglong uVar5;
undefined4 uVar6;
byte *pbVar7;

if ((((param_1 == (undefined *)0x0) || (param_2 == 0)) || (param_3 == (short *)0x0)) ||
(param_4 == 0)) {
uVar6 = 0x8009035d;
}
else {
if (((1 < param_2) && (CONCAT11(*param_1,param_1[1]) - 0x301 < 0xfbfc)) &&
((0x1f < param_2 - 2 && ((pbVar7 = param_1 + 0x22, param_2 != 0x22 && (*pbVar7 < 0x21)))))) {
if ((uint)*pbVar7 <= param_2 - 0x23) {
uVar3 = (param_2 - 0x23) - (uint)*pbVar7;
pbVar7 = pbVar7 + (ulonglong)*pbVar7 + 1;
if (1 < uVar3) {
uVar2 = CONCAT11(*pbVar7,pbVar7[1]);
if ((1 < uVar2) && ((pbVar7[1] & 1) == 0)) {
uVar3 = uVar3 - 2;
if (uVar2 <= uVar3) {
iVar4 = uVar3 - uVar2;
pbVar7 = pbVar7 + (ulonglong)uVar2 + 2;
if ((iVar4 != 0) && (*pbVar7 != 0)) {
uVar3 = iVar4 - 1;
if (*pbVar7 <= uVar3) {
uVar5 = (ulonglong)*pbVar7;
uVar3 = uVar3 - *pbVar7;
if (uVar3 < 2) {
return 0;
}
if (uVar3 < CONCAT11(pbVar7[uVar5 + 1],pbVar7[uVar5 + 2])) {
return 0;
}
uVar1 = FUN_18004d4e4(pbVar7 + uVar5 + 3,
(uint)CONCAT11(pbVar7[uVar5 + 1],pbVar7[uVar5 + 2]),param_3,
param_4);
return (int)uVar1;
}
}
}
}
}
}
}
uVar6 = 0x80090326;
}
return uVar6;
}
=========================================
Function at address: 0x18004d4e4
Called functions addresses: None


undefined8 FUN_18004d4e4(undefined *param_1,uint param_2,short *param_3,byte param_4)

{
undefined8 uVar1;
uint uVar2;
ulonglong uVar3;
uint uVar4;
short *psVar5;

if (((param_1 == (undefined *)0x0) || (param_3 == (short *)0x0)) || (param_4 == 0)) {
uVar1 = 0x8009035d;
}
else {
if (param_2 != 0) {
do {
if (param_2 < 4) {
return 0x80090326;
}
uVar4 = (uint)CONCAT11(param_1[2],param_1[3]);
if (param_2 - 4 < uVar4) {
return 0x80090326;
}
uVar3 = 0;
psVar5 = param_3;
if (param_4 != 0) {
do {
if (CONCAT11(*param_1,param_1[1]) == *psVar5) {
*(undefined **)(param_3 + uVar3 * 0xc + 4) = param_1 + 4;
*(uint *)(param_3 + uVar3 * 0xc + 8) = uVar4;
break;
}
uVar2 = (int)uVar3 + 1;
uVar3 = (ulonglong)uVar2;
psVar5 = psVar5 + 0xc;
} while (uVar2 < param_4);
}
param_1 = param_1 + 4 + uVar4;
param_2 = (param_2 - 4) - uVar4;
} while (param_2 != 0);
}
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x18004d5a4
Called functions addresses: 0x18004d388


undefined4 FUN_18004d5a4(char *param_1,uint param_2,short *param_3,byte param_4,int *param_5)

{
undefined4 uVar1;
uint uVar2;

if ((((param_1 == (char *)0x0) || (param_3 == (short *)0x0)) || (param_4 == 0)) ||
(param_5 == (int *)0x0)) {
uVar1 = 0x8009035d;
}
else {
if (param_2 < 4) {
*param_5 = 4 - param_2;
}
else {
uVar2 = ((uint)(byte)param_1[1] * 0x100 + (uint)(byte)param_1[2]) * 0x100 +
(uint)(byte)param_1[3];
if (uVar2 + 4 <= param_2) {
if (*param_1 != '\x01') {
return 0;
}
uVar1 = FUN_18004d388(param_1 + 4,uVar2,param_3,param_4);
return uVar1;
}
*param_5 = (uVar2 - param_2) + 4;
}
uVar1 = 0x80090318;
}
return uVar1;
}
=========================================
Function at address: 0x18004d660
Called functions addresses: 0x18004d5a4


int SslGetExtensions(char *param_1,uint param_2,short *param_3,byte param_4,int *param_5,
uint param_6)

{
int iVar1;
short *psVar2;
ulonglong uVar3;
ushort uVar4;

/* 0x4d660  31  SslGetExtensions */
uVar3 = (ulonglong)param_4;
iVar1 = 0;
if ((((param_1 == (char *)0x0) || (param_3 == (short *)0x0)) || (param_4 == 0)) ||
(param_5 == (int *)0x0)) {
return -0x7ff6fca3;
}
if (param_6 == 0) {
if (param_2 < 5) {
*param_5 = 5 - param_2;
return -0x7ff6fce8;
}
if ((CONCAT11(param_1[1],param_1[2]) - 0xfefd & 0xfffffffd) == 0) {
return -0x7ff6fcda;
}
uVar4 = CONCAT11(param_1[3],param_1[4]);
if (param_2 < uVar4 + 5) {
*param_5 = (uVar4 - param_2) + 5;
return -0x7ff6fce8;
}
if ((*param_1 != '\x16') ||
(iVar1 = FUN_18004d5a4(param_1 + 5,(uint)uVar4,param_3,param_4,param_5), iVar1 == 0))
goto LAB_18004d75b;
}
else {
if ((param_6 & 1) == 0) {
return -0x7ff6fca3;
}
iVar1 = FUN_18004d5a4(param_1,param_2,param_3,param_4,param_5);
}
if (iVar1 != 0) {
if (param_4 != 0) {
psVar2 = param_3 + 8;
do {
psVar2[-4] = 0;
psVar2[-3] = 0;
psVar2[-2] = 0;
psVar2[-1] = 0;
psVar2[0] = 0;
psVar2[1] = 0;
psVar2 = psVar2 + 0xc;
uVar3 = uVar3 - 1;
} while (uVar3 != 0);
return iVar1;
}
return iVar1;
}
LAB_18004d75b:
*param_5 = 0;
return iVar1;
}
=========================================
Function at address: 0x18004d7a0
Called functions addresses: 0x18004d9f8


ulonglong FUN_18004d7a0(byte *param_1,uint param_2,uint *param_3)

{
byte bVar1;
ulonglong uVar2;
uint uVar3;
uint uVar4;
int iVar5;
ulonglong uVar6;
uint uVar7;
byte *pbVar8;

uVar6 = 0;
if ((((1 < param_2) && (uVar7 = (uint)*param_1 * 0x100 + (uint)param_1[1], 0x2ff < uVar7)) &&
(0x1f < param_2 - 2)) && (param_2 != 0x22)) {
bVar1 = param_1[0x22];
if ((bVar1 < 0x21) && ((uint)bVar1 <= param_2 - 0x23)) {
uVar4 = (param_2 - 0x23) - (uint)bVar1;
pbVar8 = param_1 + (ulonglong)bVar1 + 0x23;
if ((1 < uVar4) &&
((uVar3 = (uint)*pbVar8 * 0x100 + (uint)pbVar8[1], (uVar3 & 1) == 0 &&
(uVar4 = uVar4 - 2, uVar3 <= uVar4)))) {
iVar5 = uVar4 - uVar3;
if (iVar5 != 0) {
bVar1 = pbVar8[(ulonglong)uVar3 + 2];
if ((bVar1 != 0) && (uVar4 = iVar5 - 1, bVar1 <= uVar4)) {
uVar4 = uVar4 - bVar1;
if (0x300 < uVar7) {
if ((uVar4 < 2) ||
(uVar4 - 2 <
(uint)CONCAT11(pbVar8[(ulonglong)bVar1 + (ulonglong)uVar3 + 3],
pbVar8[(ulonglong)bVar1 + (ulonglong)uVar3 + 4]))) {
return 0;
}
uVar2 = FUN_18004d9f8(pbVar8 + (ulonglong)(uint)bVar1 + (ulonglong)uVar3 + 5,
(uint)CONCAT11(pbVar8[(ulonglong)bVar1 + (ulonglong)uVar3 + 3],
pbVar8[(ulonglong)bVar1 + (ulonglong)uVar3 + 4]),
param_3);
uVar6 = uVar2 & 0xffffffff;
if ((int)uVar2 != 0) {
return uVar2;
}
}
return uVar6;
}
}
}
}
}
return 0x80090326;
}
=========================================
Function at address: 0x18004d8b0
Called functions addresses: None


undefined8 FUN_18004d8b0(undefined *param_1,uint param_2,uint *param_3)

{
bool bVar1;
undefined8 uVar2;
char *pcVar3;
int iVar4;
ushort uVar5;

bVar1 = false;
if ((param_2 < 2) || (CONCAT11(*param_1,param_1[1]) < 3)) {
LAB_18004d930:
uVar2 = 0x80090326;
}
else {
pcVar3 = param_1 + 2;
for (iVar4 = param_2 - 2; iVar4 != 0; iVar4 = (iVar4 - 3U) - (uint)uVar5) {
if (iVar4 - 1U < 2) goto LAB_18004d930;
uVar5 = CONCAT11(pcVar3[1],pcVar3[2]);
if (iVar4 - 3U < (uint)uVar5) goto LAB_18004d930;
if ((*pcVar3 == '\0') && (!bVar1)) {
*param_3 = (uint)uVar5;
bVar1 = true;
param_3[1] = (uint)uVar5;
*(char **)(param_3 + 2) = pcVar3 + 3;
}
pcVar3 = pcVar3 + 3 + uVar5;
}
uVar2 = 0;
}
return uVar2;
}
=========================================
Function at address: 0x18004d944
Called functions addresses: None


undefined8 FUN_18004d944(uint *param_1)

{
char *pcVar1;
uint uVar2;

pcVar1 = *(char **)(param_1 + 2);
if ((((1 < *param_1) &&
(uVar2 = (uint)CONCAT11(*pcVar1,pcVar1[1]) & ((int)*pcVar1 >> 0x1f & 0x4000U) + 0x3fff,
uVar2 + 2 <= *param_1)) && (10 < uVar2)) &&
(((pcVar1[2] == '\x01' && (1 < CONCAT11(pcVar1[3],pcVar1[4]))) &&
(CONCAT11(pcVar1[5],pcVar1[6]) + 9 +
(uint)CONCAT11(pcVar1[9],pcVar1[10]) + (uint)CONCAT11(pcVar1[7],pcVar1[8]) <= uVar2)))) {
return 0;
}
return 0x80090326;
}
=========================================
Function at address: 0x18004d9f8
Called functions addresses: 0x18004d8b0


undefined8 FUN_18004d9f8(undefined *param_1,uint param_2,uint *param_3)

{
undefined *puVar1;
undefined uVar2;
undefined8 uVar3;
uint uVar4;
undefined *puVar5;

if (param_2 != 0) {
do {
if (param_2 < 4) {
return 0x80090326;
}
uVar2 = *param_1;
uVar4 = (uint)CONCAT11(param_1[2],param_1[3]);
puVar1 = param_1 + 1;
puVar5 = param_1 + 4;
if (param_2 - 4 < uVar4) {
return 0x80090326;
}
param_1 = puVar5 + uVar4;
param_2 = (param_2 - 4) - uVar4;
if ((CONCAT11(uVar2,*puVar1) == 0) &&
(uVar3 = FUN_18004d8b0(puVar5,uVar4,param_3), (int)uVar3 != 0)) {
return uVar3;
}
} while (param_2 != 0);
}
return 0;
}
=========================================
Function at address: 0x18004da80
Called functions addresses: 0x18004d7a0


ulonglong FUN_18004da80(int param_1,char *param_2,uint param_3,uint *param_4)

{
ulonglong uVar1;
uint uVar2;
uint uVar3;
ulonglong uVar4;

uVar4 = (ulonglong)param_3;
if (param_1 == 0x16) {
do {
uVar3 = (uint)uVar4;
if (uVar3 < 4) {
param_4[2] = 0;
param_4[3] = 0;
*param_4 = 4 - uVar3;
return 0x80090318;
}
if (*param_2 != '\x01') {
return 0x80090308;
}
uVar2 = (uint)(byte)param_2[2] * 0x100 + (uint)(byte)param_2[1] * 0x10000 +
(uint)(byte)param_2[3];
if (uVar4 < (ulonglong)uVar2 + 4) {
param_4[2] = 0;
param_4[3] = 0;
*param_4 = (uVar2 - uVar3) + 4;
return 0x80090318;
}
uVar1 = FUN_18004d7a0((byte *)(param_2 + 4),uVar2,param_4);
if ((int)uVar1 != 0) {
return uVar1;
}
param_2 = param_2 + (ulonglong)uVar2 + 4;
uVar3 = uVar3 + (-4 - uVar2);
uVar4 = (ulonglong)uVar3;
} while (uVar3 != 0);
}
else {
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x18004db50
Called functions addresses: 0x18004da80 0x18004d944


ulonglong SslGetServerIdentity(byte *param_1,uint param_2,undefined8 *param_3,int *param_4)

{
ulonglong uVar1;
uint uVar2;
uint uVar3;
int iVar4;
ulonglong local_38;
byte *pbStack_30;

/* 0x4db50  33  SslGetServerIdentity */
iVar4 = 0;
uVar2 = 0;
local_38 = 0;
pbStack_30 = (byte *)0x0;
if (((param_1 == (byte *)0x0) || (param_3 == (undefined8 *)0x0)) || (param_4 == (int *)0x0)) {
uVar1 = 0x8009035d;
}
else if (param_2 < 5) {
*param_4 = 5 - param_2;
LAB_18004dbaa:
uVar1 = 0x80090318;
}
else if (*param_1 == 0x16) {
do {
if (param_2 < 5) {
if (iVar4 == 0) {
*param_4 = 5 - param_2;
goto LAB_18004dbaa;
}
break;
}
if (3 < *param_1 - 0x14) {
return 0x80090308;
}
uVar3 = (uint)CONCAT11(param_1[3],param_1[4]);
if (param_2 < uVar3 + 5) {
*param_4 = (uVar3 - param_2) + 5;
goto LAB_18004dbaa;
}
iVar4 = iVar4 + 5 + uVar3;
uVar1 = FUN_18004da80((uint)*param_1,(char *)(param_1 + 5),uVar3,(uint *)&local_38);
uVar2 = (uint)uVar1;
if (uVar2 != 0) {
if (uVar2 != 0x80090318) goto LAB_18004dc3f;
goto LAB_18004dc38;
}
param_1 = param_1 + (uVar3 + 5);
param_2 = param_2 + (-5 - uVar3);
} while (param_2 != 0);
*param_3 = pbStack_30;
LAB_18004dc38:
*param_4 = (int)local_38;
LAB_18004dc3f:
uVar1 = (ulonglong)uVar2;
}
else {
local_38 = (ulonglong)param_2;
pbStack_30 = param_1;
uVar1 = FUN_18004d944((uint *)&local_38);
if ((int)uVar1 == 0) {
*param_4 = 0;
}
}
return uVar1;
}
=========================================
Function at address: 0x18004dc98
Called functions addresses: 0x18000dda0 0x18002a7c0


ulonglong FUN_18004dc98(undefined8 *param_1,undefined *param_2,undefined8 *param_3,
undefined4 *param_4)

{
uint uVar1;
ulonglong uVar2;
longlong lVar3;

uVar2 = FUN_18000dda0(param_1,param_2);
if ((int)uVar2 == 0) {

param_1[1] = lVar3;
if (lVar3 == 0) {
uVar2 = 0xe;
}
else {
param_1[2] = lVar3;
*(undefined4 *)((longlong)param_1 + 0x1c) = *(undefined4 *)(param_1 + 3);
uVar1 = FUN_18000dda0(param_1,param_2);
uVar2 = (ulonglong)uVar1;
if (uVar1 == 0) {
*param_3 = param_1[1];
*param_4 = *(undefined4 *)(param_1 + 3);
uVar2 = 0;
}
else {

}
}
}
return uVar2;
}
=========================================
Function at address: 0x18004dd58
Called functions addresses: 0xEXTERNAL:00000113


undefined8 FUN_18004dd58(longlong param_1,undefined4 param_2,undefined8 param_3,undefined8 param_4)

{
undefined4 *puVar1;
undefined8 uVar2;
uint uVar3;
undefined4 *puVar4;
int local_res8 [2];

puVar1 = *(undefined4 **)(param_1 + 0x10);
puVar4 = puVar1;
if (*(longlong *)(param_1 + 8) != 0) {
*(int *)(param_1 + 0x1c) = *(int *)(param_1 + 0x1c) + -0x10;
*(undefined4 **)(param_1 + 0x10) = puVar1 + 4;
puVar4 = puVar1 + 4;
}
local_res8[0] = *(int *)(param_1 + 0x1c);
uVar2 = SslExportKey(param_3,param_4,L"OpaqueKeyBlob",puVar4,local_res8[0],local_res8,0);
if (((int)uVar2 == 0) || ((int)uVar2 == -0x7ff6ffd8)) {
uVar3 = local_res8[0] + 0x17U & 0xfffffff8;
if (*(longlong *)(param_1 + 8) == 0) {
*(int *)(param_1 + 0x18) = *(int *)(param_1 + 0x18) + uVar3;
}
else {
*puVar1 = param_2;
puVar1[1] = uVar3 - 0x10;
puVar1[2] = local_res8[0];
*(longlong *)(param_1 + 0x10) = *(longlong *)(param_1 + 0x10) + (ulonglong)(uVar3 - 0x10);
*(int *)(param_1 + 0x1c) = *(int *)(param_1 + 0x1c) + (0x10 - uVar3);
}
uVar2 = 0;
}
return uVar2;
}
=========================================
Function at address: 0x18004de20
Called functions addresses: None


undefined8 * FUN_18004de20(undefined8 *param_1)

{
*param_1 = &PTR_FUN_18007cfb8;
return param_1;
}
=========================================
Function at address: 0x18004de38
Called functions addresses: None


undefined8 FUN_18004de38(longlong param_1,ulonglong param_2)

{
ulonglong uVar1;
undefined uVar2;
ulonglong uVar3;
ulonglong uVar4;

uVar1 = 0xffffffffffff;
uVar3 = *(longlong *)(param_1 + 0x80) + 0x3f;
uVar4 = param_2 & 0xffffffffffff;
if (*(int *)(param_1 + 0x74) == -1) {
LAB_18004dec2:
uVar2 = 1;
}
else {
uVar1 = (ulonglong)*(int *)(param_1 + 0x74);
if (param_2 >> 0x30 == uVar1) {
if (uVar3 < uVar4) {
if (uVar4 - uVar3 < 0x40) {
uVar1 = *(longlong *)(param_1 + 0x78) << ((byte)(uVar4 - uVar3) & 0x3f) | 1;
}
else {
uVar1 = 1;
}
uVar2 = 1;
*(ulonglong *)(param_1 + 0x78) = uVar1;
uVar1 = uVar4 - 0x3f;
*(ulonglong *)(param_1 + 0x80) = uVar1;
goto LAB_18004dec7;
}
uVar3 = uVar3 - uVar4;
if ((uVar3 < 0x40) &&
(uVar1 = *(ulonglong *)(param_1 + 0x78), (uVar1 >> (uVar3 & 0x3f) & 1) == 0)) {
uVar1 = uVar1 | 1L << (uVar3 & 0x3f);
*(ulonglong *)(param_1 + 0x78) = uVar1;
goto LAB_18004dec2;
}
}
uVar2 = 0;
}
LAB_18004dec7:
return CONCAT71((int7)(uVar1 >> 8),uVar2);
}
=========================================
Function at address: 0x18004dee0
Called functions addresses: 0xEXTERNAL:00000040


void FUN_18004dee0(undefined8 param_1,HLOCAL param_2)

{
/* WARNING: Could not recover jumptable at 0x00018004dee3. Too many branches */

LocalFree(param_2);
return;
}
=========================================
Function at address: 0x18004def8
Called functions addresses: 0x180041cdc 0x180041cb0 0xEXTERNAL:0000010f 0x180028070 0x18004f728


void FUN_18004def8(longlong param_1,undefined4 *param_2)

{
int iVar1;
undefined auStack_78 [32];
undefined8 local_58;
undefined4 local_50;
undefined4 *local_48;
undefined8 local_40;
undefined4 local_38;
undefined4 local_30;
undefined4 local_28;
undefined2 local_24;
ulonglong local_20;

local_20 = DAT_180091970 ^ (ulonglong)auStack_78;
if (param_2 != (undefined4 *)0x0) {
local_28 = 0x1000018;
local_24 = 0x1600;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x7b,&DAT_1800853e8);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x7c,&DAT_1800853e8,*(undefined4 *)(param_1 + 0x68));
}
}
local_30 = 0;
local_48 = param_2 + 1;
local_40 = *(undefined8 *)(param_1 + 0x68);
local_38 = 0x17;
local_50 = *param_2;
local_58 = *(undefined8 *)(param_2 + 2);
iVar1 = SslEncryptPacket(*(undefined8 *)(param_1 + 0x58),*(undefined8 *)(param_1 + 0x30),
&local_28,6);
if (iVar1 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x7d,&DAT_1800853e8);
}
FUN_18004f728(*(longlong *)(param_1 + 0x58),(longlong *)(param_1 + 0x1c0),
(longlong *)(param_1 + 0x30),(undefined8 *)(param_1 + 0x68));
}
}
FUN_180028070(local_20 ^ (ulonglong)auStack_78);
return;
}
=========================================
Function at address: 0x18004e050
Called functions addresses: 0x18004ed04


void FUN_18004e050(longlong param_1,uint *param_2,char param_3)

{
int iVar1;
uint uVar2;
undefined4 local_38;
undefined4 local_34;
int *local_30;
int local_28 [2];
undefined *local_20;
int local_18;
undefined4 local_14;
undefined *local_10;

local_20 = *(undefined **)(param_2 + 2);
uVar2 = *param_2;
*param_2 = 0;
if (((param_3 != '\0') && (local_20 != (undefined *)0x0)) &&
((uint)(*(int *)(param_1 + 0x44) + 2 + *(int *)(param_1 + 0x40)) <= uVar2)) {
local_20[1] = param_3;
local_10 = local_20 + 2;
*local_20 = 2;
local_38 = 0;
local_18 = uVar2 - 2;
local_30 = local_28;
local_28[0] = 2;
local_14 = 2;
local_34 = 2;
local_28[1] = 1;
iVar1 = FUN_18004ed04(param_1,0x40000000,(longlong)&local_38);
if (iVar1 == 0) {
if ((uint)(local_18 + local_28[0]) <= uVar2) {
uVar2 = local_18 + local_28[0];
}
*param_2 = uVar2;
}
}
return;
}
=========================================
Function at address: 0x18004e0fc
Called functions addresses: 0x18000a1f4 0x180041cb0 0x1800509d0


undefined4
FUN_18004e0fc(longlong param_1,undefined8 param_2,undefined8 param_3,byte param_4,
undefined4 *param_5)

{
undefined *puVar1;
undefined4 uVar2;
undefined4 uVar3;

if ((param_4 & 8) == 0) {
puVar1 = (undefined *)FUN_1800509d0(1);
}
else {
puVar1 = (undefined *)FUN_18000a1f4(1);
}
if (puVar1 == (undefined *)0x0) {
uVar3 = 0x80090300;
uVar2 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(uVar2 = 0, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x89,&DAT_1800853e8);
}
}
else {
uVar3 = 0;
*puVar1 = *(undefined *)(param_1 + 0x8c);
*(undefined **)(param_5 + 2) = puVar1;
uVar2 = 1;
}
param_5[1] = uVar2;
*param_5 = uVar2;
return uVar3;
}
=========================================
Function at address: 0x18004e1a0
Called functions addresses: 0xEXTERNAL:0000003f


void FUN_18004e1a0(undefined8 param_1,SIZE_T param_2)

{
/* WARNING: Could not recover jumptable at 0x00018004e1a5. Too many branches */

LocalAlloc(0x40,param_2);
return;
}
=========================================
Function at address: 0x18004e1c0
Called functions addresses: None


undefined8 FUN_18004e1c0(longlong param_1,undefined4 *param_2,undefined4 *param_3)

{
if ((param_2 != (undefined4 *)0x0) && (param_3 != (undefined4 *)0x0)) {
*param_2 = *(undefined4 *)(param_1 + 0x178);
*param_3 = *(undefined4 *)(param_1 + 0x17c);
return 0;
}
return 0x57;
}
=========================================
Function at address: 0x18004e1f0
Called functions addresses: 0x180010610


undefined8 FUN_18004e1f0(longlong param_1,short *param_2,undefined8 *param_3)

{
FUN_180010610(param_2,0x100,*(longlong *)(param_1 + 0x50));
*param_3 = *(undefined8 *)(param_1 + 0x58);
return 0;
}
=========================================
Function at address: 0x18004e228
Called functions addresses: 0x18004492c 0x180041cb0 0x18004e350


undefined8 FUN_18004e228(longlong param_1,byte *param_2,int param_3,undefined4 *param_4)

{
uint uVar1;
char cVar2;
undefined4 uVar3;

uVar1 = *(uint *)(param_1 + 0x18);
if (((uVar1 & 0x800a2aaa) == 0) || (param_3 != 0)) {
if (((uVar1 & 0x40051555) == 0) || (param_3 != 4)) {
if ((param_3 == 2) && ((byte)(*param_2 - 1) < 2)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18004492c(DAT_180091000[2],0xc,&DAT_1800853e8,(uint)*param_2,param_2[1]);
}
cVar2 = FUN_18004e350(param_2[1]);
if (cVar2 != '\0') {
uVar3 = 0x15;
goto LAB_18004e33f;
}
}
}
else if ((((*param_2 == 0) && (param_2[1] == 0)) && (param_2[2] == 0)) &&
((param_2[3] == 0 && ((uVar1 >> 0xc & 1) == 0)))) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_1800853e8);
}
uVar3 = 0x16;
LAB_18004e33f:
*param_4 = uVar3;
return 0;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_1800853e8);
}
return 0x80090308;
}
=========================================
Function at address: 0x18004e350
Called functions addresses: None


undefined FUN_18004e350(byte param_1)

{
bool bVar1;

if (param_1 < 0x48) {
if (0x45 < param_1) {
return 1;
}
if (param_1 == 0) {
return 1;
}
if (param_1 == 10) {
return 1;
}
if (param_1 < 0x14) {
return 0;
}
if (param_1 < 0x17) {
return 1;
}
if (param_1 == 0x1e) {
return 1;
}
if (param_1 == 0x28) {
return 1;
}
if (param_1 < 0x2a) {
return 0;
}
if (param_1 < 0x34) {
return 1;
}
bVar1 = param_1 == 0x3c;
}
else {
if (param_1 == 0x50) {
return 1;
}
if (param_1 == 0x5a) {
return 1;
}
if (param_1 == 100) {
return 1;
}
if (param_1 == 0x6e) {
return 1;
}
if (param_1 == 0x73) {
return 1;
}
bVar1 = param_1 == 0x78;
}
if (bVar1) {
return 1;
}
return 0;
}
=========================================
Function at address: 0x18004e3b4
Called functions addresses: 0x18000909c 0x180041cb0


undefined8 FUN_18004e3b4(longlong param_1,byte param_2,uint *param_3)

{
uint uVar1;
uint uVar2;
undefined8 uVar3;
undefined2 *puVar4;

uVar1 = *param_3;
puVar4 = *(undefined2 **)(param_3 + 2) + 4;
if (uVar1 < 5) {
puVar4 = *(undefined2 **)(param_3 + 2);
}
uVar2 = uVar1 - 8;
if (uVar1 < 5) {
uVar2 = uVar1;
}
if (uVar2 == 4) {
uVar3 = 0;
*(undefined2 *)(param_1 + 0x88) = *puVar4;
*(undefined2 *)(param_1 + 0x8a) = puVar4[1];
}
else {
uVar3 = 0x8009035d;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x88,&DAT_1800853e8);
}
}
if ((param_2 & 8) != 0) {
FUN_18000909c(*(HLOCAL *)(param_3 + 2));
param_3[2] = 0;
param_3[3] = 0;
*param_3 = 0;
param_3[1] = 0;
}
return uVar3;
}
=========================================
Function at address: 0x18004e470
Called functions addresses: 0x180041cb0


undefined8 FUN_18004e470(ulonglong param_1,undefined4 param_2,int param_3,undefined8 *param_4)

{
undefined8 uVar1;

if (param_4 == (undefined8 *)0x0) {
uVar1 = 0x8009035d;
}
else if ((param_1 >> 0xe & 1) == 0) {
uVar1 = 0x8009030e;
if (param_3 != -0x7ff6fcf2) {
*param_4 = CONCAT44(param_3,param_2);
uVar1 = 0;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x72,&DAT_1800853e8);
}
uVar1 = 0x80090301;
}
return uVar1;
}
=========================================
Function at address: 0x18004e4e8
Called functions addresses: 0x180028d90 0x18000d31c 0x180028070 0xEXTERNAL:00000110 0x180028d78


void FUN_18004e4e8(longlong param_1,undefined4 *param_2)

{
int iVar1;
ulonglong uVar2;
undefined auStack_308 [32];
undefined *local_2e8;
undefined4 local_2e0;
undefined local_2d8 [140];
undefined local_24c [128];
undefined4 local_1cc;
undefined local_1c4 [128];
undefined4 local_144;
undefined local_140 [280];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_308;
memset(local_2d8,0,0x2a4);
uVar2 = FUN_18000d31c(*(uint *)(param_1 + 0x18));
local_2e0 = 0;
local_2e8 = local_2d8;
iVar1 = SslLookupCipherSuiteInfo
(*(undefined8 *)(param_1 + 0x58),uVar2 & 0xffff,*(undefined4 *)(param_1 + 0x38),
*(undefined4 *)(param_1 + 0x3c));
if (iVar1 == 0) {
*param_2 = 1;
param_2[1] = *(undefined4 *)(param_1 + 0x18);
_o_wcscpy_s(param_2 + 2,0x40,local_24c);
param_2[0x22] = local_1cc;
_o_wcscpy_s(param_2 + 0x23,0x40,local_1c4);
param_2[0x43] = local_144;
_o_wcscpy_s(param_2 + 0x44,0x40,local_140);
param_2[100] = *(undefined4 *)(param_1 + 0x1c);
}
FUN_180028070(local_28 ^ (ulonglong)auStack_308);
return;
}
=========================================
Function at address: 0x18004e5f8
Called functions addresses: 0x180041cb0 0xEXTERNAL:0000011a


void FUN_18004e5f8(longlong param_1,longlong param_2)

{
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x70,&DAT_1800853e8);
}
SslExportKeyingMaterial
(*(undefined8 *)(param_1 + 0x58),*(undefined8 *)(param_1 + 0x1b0),
*(undefined8 *)(param_2 + 8),0,0,*(undefined8 *)(param_2 + 0x18),
*(undefined2 *)(param_2 + 0x10),*(undefined8 *)(param_2 + 0x28),
*(undefined4 *)(param_2 + 0x20),0);
return;
}
=========================================
Function at address: 0x18004e694
Called functions addresses: 0xEXTERNAL:0000003f 0x18002a77b 0x180041cb0 0x180028070


void FUN_18004e694(longlong param_1,int *param_2)

{
HLOCAL _Dst;
ulonglong uVar1;
int iVar2;
ulonglong uVar3;
bool bVar4;
undefined auStack_48 [32];
undefined8 local_28;
undefined4 local_20;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_48;
local_28 = 0;
local_20 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x71,&DAT_1800853e8);
}
if ((*(ulonglong *)(param_1 + 0x10) & 0x20000) != 0) {
local_28 = CONCAT62(local_28._2_6_,5);
}
bVar4 = (*(ulonglong *)(param_1 + 0x10) & 0x20000) != 0;
uVar1 = (ulonglong)bVar4;
uVar3 = uVar1;
if ((*(longlong *)(param_1 + 0x188) != 0) && (*(int *)(*(longlong *)(param_1 + 0x188) + 4) == 2))
{
uVar3 = (ulonglong)(bVar4 + 1);
*(undefined2 *)((longlong)&local_28 + uVar1 * 2) = 0x10;
}
uVar1 = uVar3;
if (*(longlong *)(param_1 + 400) != 0) {
uVar1 = (ulonglong)((int)uVar3 + 1);
*(undefined2 *)((longlong)&local_28 + uVar3 * 2) = 0xe;
}
uVar3 = uVar1;
if (*(longlong *)(param_1 + 0x198) != 0) {
uVar3 = (ulonglong)((int)uVar1 + 1);
*(undefined2 *)((longlong)&local_28 + uVar1 * 2) = 0x18;
}
uVar1 = uVar3;
if ((*(ulonglong *)(param_1 + 0x10) & 0x8000000) != 0) {
uVar1 = (ulonglong)((int)uVar3 + 1);
*(undefined2 *)((longlong)&local_28 + uVar3 * 2) = 0x17;
}
iVar2 = (int)uVar1;
if (*(char *)(param_1 + 0x20) != '\0') {
iVar2 = iVar2 + 1;
*(undefined2 *)((longlong)&local_28 + uVar1 * 2) = 0xff01;
}
if (iVar2 == 0) {
param_2[0] = 0;
param_2[1] = 0;
param_2[2] = 0;
param_2[3] = 0;
}
else {
_Dst = LocalAlloc(0x40,(ulonglong)(uint)(iVar2 * 2));
if (_Dst != (HLOCAL)0x0) {
memcpy(_Dst,&local_28,(ulonglong)(uint)(iVar2 * 2));
*(HLOCAL *)(param_2 + 2) = _Dst;
*param_2 = iVar2;
}
}
FUN_180028070(local_18 ^ (ulonglong)auStack_48);
return;
}
=========================================
Function at address: 0x18004e80c
Called functions addresses: 0x180041cb0 0x18000d1cc 0x180041d20


undefined8 FUN_18004e80c(longlong param_1,int *param_2)

{
uint uVar1;
int iVar2;
bool bVar3;
uint local_res8 [4];
uint local_res18 [2];
uint local_res20 [2];

local_res20[0] = 0;
local_res18[0] = 0;
local_res8[0] = 0;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0) {
FUN_180041cb0(DAT_180091000[2],0x5f,&DAT_1800853e8);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x60,&DAT_1800853e8);
}
}
iVar2 = FUN_18000d1cc(*(undefined8 *)(param_1 + 0x58),*(undefined4 *)(param_1 + 0x38),
*(uint *)(param_1 + 0x18),*(undefined4 *)(param_1 + 0x3c),local_res20,
local_res18,local_res8);
if (iVar2 != 0) {
return 0x80090304;
}
uVar1 = *(uint *)(param_1 + 0x18);
if (uVar1 < 0x801) {
if (((uVar1 != 0x800) && (uVar1 != 0x10)) &&
((uVar1 != 0x20 &&
((((uVar1 != 0x40 && (uVar1 != 0x80)) && (uVar1 != 0x100)) && (uVar1 != 0x200)))))) {
bVar3 = uVar1 == 0x400;
LAB_18004e921:
if (!bVar3) {
*param_2 = 0x4000;
iVar2 = 0;
goto LAB_18004e956;
}
}
}
else if ((((uVar1 != 0x1000) && (uVar1 != 0x2000)) && (uVar1 != 0x10000)) &&
((uVar1 != 0x20000 && (uVar1 != 0x40000)))) {
bVar3 = uVar1 == 0x80000;
goto LAB_18004e921;
}
*param_2 = (0x4000 - local_res8[0]) - local_res18[0];
iVar2 = (uint)((*(uint *)(param_1 + 0x18) & 0x3000) != 0) + *(int *)(param_1 + 0x44) +
*(int *)(param_1 + 0x40) + local_res8[0] + local_res18[0];
LAB_18004e956:
param_2[3] = iVar2;
param_2[2] = local_res20[0];
param_2[1] = local_res18[0];
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],0x61,&DAT_1800853e8,0,0);
}
return 0;
}
=========================================
Function at address: 0x18004e9a4
Called functions addresses: 0xEXTERNAL:0000003f 0x18002a77b 0x180041cb0


undefined8 FUN_18004e9a4(longlong param_1,undefined8 *param_2)

{
byte bVar1;
undefined8 *puVar2;
void *_Src;
undefined8 uVar3;
HLOCAL _Dst;

puVar2 = *(undefined8 **)(param_1 + 400);
_Dst = (HLOCAL)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x6d,&DAT_1800853e8);
}
if (puVar2 == (undefined8 *)0x0) {
*param_2 = 0;
param_2[1] = 0;
}
else {
_Src = (void *)puVar2[1];
if (_Src != (void *)0x0) {
bVar1 = *(byte *)((longlong)puVar2 + 2);
_Dst = LocalAlloc(0x40,(ulonglong)bVar1);
if (_Dst == (HLOCAL)0x0) {
return 0x80090300;
}
memcpy(_Dst,_Src,(ulonglong)bVar1);
}
uVar3 = puVar2[1];
*param_2 = *puVar2;
param_2[1] = uVar3;
param_2[1] = _Dst;
}
return 0;
}
=========================================
Function at address: 0x18004ea70
Called functions addresses: 0xEXTERNAL:0000003f 0x18002a77b 0x180041cb0


undefined8 FUN_18004ea70(longlong param_1,undefined8 *param_2)

{
HLOCAL _Dst;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x6f,&DAT_1800853e8);
}
*param_2 = 0;
param_2[1] = 0;
if (*(longlong *)(param_1 + 0x1a8) != 0) {
_Dst = LocalAlloc(0x40,(ulonglong)*(uint *)(param_1 + 0x1a0));
if (_Dst == (HLOCAL)0x0) {
return 0x80090300;
}
memcpy(_Dst,*(void **)(param_1 + 0x1a8),(ulonglong)*(uint *)(param_1 + 0x1a0));
*(undefined4 *)param_2 = *(undefined4 *)(param_1 + 0x1a0);
param_2[1] = _Dst;
}
return 0;
}
=========================================
Function at address: 0x18004eb24
Called functions addresses: 0xEXTERNAL:0000003f 0x18002a77b 0x18002a7c0 0x180041d20


undefined8 FUN_18004eb24(longlong *param_1,uint *param_2)

{
uint uVar1;
longlong lVar2;
HLOCAL pvVar3;
uint local_res8 [2];
void *local_res10;


*param_2 = 0;
param_2[2] = 0;
param_2[3] = 0;
if ((*(byte *)(param_1 + 3) & 0xc) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x68,&DAT_1800853e8,0x80090302,2);
}
return 0x80090302;
}
if ((local_res10 != (void *)0x0) && (local_res8[0] != 0)) {
uVar1 = local_res8[0] + 0x2b;
if (uVar1 < local_res8[0]) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x69,&DAT_1800853e8,0x80090304,4);
}
return 0x80090304;
}
pvVar3 = LocalAlloc(0x40,(ulonglong)uVar1);
*(HLOCAL *)(param_2 + 2) = pvVar3;
if (pvVar3 == (HLOCAL)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x6a,&DAT_1800853e8,0x80090300,0);
}
return 0x80090300;
}
*(uint *)((longlong)pvVar3 + 0x18) = local_res8[0] + 0xb;
*(undefined4 *)(*(longlong *)(param_2 + 2) + 0x1c) = 0x20;
lVar2 = *(longlong *)(param_2 + 2);
*(undefined8 *)(lVar2 + 0x20) = s_tls_unique__1800853d8._0_8_;
*(undefined2 *)(lVar2 + 0x28) = s_tls_unique__1800853d8._8_2_;
*(char *)(lVar2 + 0x2a) = s_tls_unique__1800853d8[10];
memcpy((void *)(lVar2 + 0x2b),local_res10,(ulonglong)local_res8[0]);
*param_2 = uVar1;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],0x6b,&DAT_1800853e8,0,0);
}
return 0;
}
=========================================
Function at address: 0x18004ed04
Called functions addresses: 0xEXTERNAL:0000003f 0x180041cdc 0x18002a77b 0x18004e228 0x180041cb0 0xEXTERNAL:00000040 0xEXTERNAL:0000010f 0x180041d20 0xEXTERNAL:0000003d 0x180041e9c


int FUN_18004ed04(longlong param_1,int param_2,longlong param_3)

{
longlong lVar1;
bool bVar2;
int iVar3;
undefined8 uVar4;
undefined2 uVar5;
uint uVar6;
uint *puVar8;
uint *puVar9;
int *piVar10;
byte *pbVar11;
uint uVar12;
ulonglong uVar14;
undefined4 local_res20;
undefined4 local_58 [2];
int local_50;
uint local_4c;
HLOCAL local_48;
uint *puVar7;
ulonglong uVar13;

puVar7 = (uint *)0x0;
bVar2 = false;
local_res20 = 0x17;
local_58[0] = 0x17;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x32,&DAT_1800853e8);
}
if (*(uint *)(param_3 + 4) != 0) {
lVar1 = *(longlong *)(param_3 + 8);
piVar10 = (int *)(lVar1 + 4);
puVar8 = puVar7;
puVar9 = puVar7;
do {
if (*piVar10 == 1) {
puVar9 = (uint *)((longlong)puVar7 * 0x10 + lVar1);
}
else if ((*piVar10 == 2) && (puVar8 == (uint *)0x0)) {
puVar8 = (uint *)((longlong)puVar7 * 0x10 + lVar1);
}
uVar6 = (int)puVar7 + 1;
puVar7 = (uint *)(ulonglong)uVar6;
piVar10 = piVar10 + 4;
} while (uVar6 < *(uint *)(param_3 + 4));
if ((puVar8 != (uint *)0x0) && (puVar9 != (uint *)0x0)) {
local_48 = *(HLOCAL *)(puVar9 + 2);
if ((local_48 == (HLOCAL)0x0) || (*(longlong *)(puVar8 + 2) == 0)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcf8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x7ff6fcf8;
}
uVar5 = 0x34;
goto LAB_18004f280;
}
if ((*(uint *)(param_1 + 0x18) & 0xf0000) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x35,&DAT_1800853e8,0x80090302,2);
}
return -0x7ff6fcfe;
}
if (*(longlong *)(puVar8 + 2) == (longlong)local_48 + (ulonglong)*puVar9) {
local_50 = *puVar8 + *puVar9;
}
else {
bVar2 = true;
local_48 = LocalAlloc(0x40,(ulonglong)(*puVar8 + *puVar9));
if (local_48 == (HLOCAL)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x38,&DAT_1800853e8,0x80090300,0);
}
return -0x7ff6fd00;
}
local_50 = *puVar8 + *puVar9;
}
local_4c = 0;
pbVar11 = *(byte **)(puVar9 + 2);
uVar6 = *puVar9;
uVar14 = (ulonglong)uVar6;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x39,&DAT_1800853e8);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x3a,&DAT_1800853e8,uVar6);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x3b,&DAT_1800853e8,uVar6);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x3c,&DAT_1800853e8,local_4c);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x3d,&DAT_1800853e8,local_50);
}
}
}
}
}
uVar12 = *(int *)(param_1 + 0x44) + *(int *)(param_1 + 0x40);
uVar13 = (ulonglong)uVar12;
if (param_2 == 0x40000000) {
uVar4 = FUN_18004e228(param_1,pbVar11,uVar6,local_58);
iVar3 = (int)uVar4;
if (iVar3 == 0) {
local_res20 = local_58[0];
goto LAB_18004efb3;
}
LAB_18004f1cd:
if (!bVar2) goto LAB_18004f229;
}
else {
LAB_18004efb3:
if (!bVar2) {
memmove_s((void *)(uVar13 + (longlong)*(void **)(puVar9 + 2)),(ulonglong)*puVar9,
*(void **)(puVar9 + 2),(ulonglong)*puVar9);
pbVar11 = pbVar11 + uVar13;
}
if ((*(uint *)(param_1 + 0x18) & 0x3000) != 0) {
pbVar11[uVar14] = (byte)local_res20;
uVar14 = (ulonglong)(uVar6 + 1);
local_res20 = 0x17;
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x3e,&DAT_1800853e8);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x3f,&DAT_1800853e8,(int)uVar14);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x40,&DAT_1800853e8,uVar13 + (longlong)local_48);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x41,&DAT_1800853e8,local_50 - uVar12);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x42,&DAT_1800853e8,local_4c);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x43,&DAT_1800853e8,
*(undefined4 *)(param_1 + 0x68));
}
}
}
}
}
}
iVar3 = SslEncryptPacket(*(undefined8 *)(param_1 + 0x58),*(undefined8 *)(param_1 + 0x30),
pbVar11,uVar14,local_48,local_50,&local_4c,
*(undefined8 *)(param_1 + 0x68),local_res20,0);
*(longlong *)(param_1 + 0x68) = *(longlong *)(param_1 + 0x68) + 1;
if (iVar3 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x44,&DAT_1800853e8,iVar3);
}
iVar3 = -0x7ff6fcd7;
goto LAB_18004f1cd;
}
uVar6 = local_4c;
if (*puVar9 <= local_4c) {
uVar6 = *puVar9;
}
*puVar9 = uVar6;
uVar12 = local_4c - uVar6;
if (*puVar8 <= local_4c - uVar6) {
uVar12 = *puVar8;
}
*puVar8 = uVar12;
iVar3 = 0;
if (!bVar2) goto LAB_18004f229;
memcpy(*(void **)(puVar9 + 2),local_48,(ulonglong)*puVar9);
memcpy(*(void **)(puVar8 + 2),(void *)((ulonglong)*puVar9 + (longlong)local_48),
(ulonglong)*puVar8);
}
LocalFree(local_48);
LAB_18004f229:
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar3;
}
if ((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) || (iVar3 == 0)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) {
return iVar3;
}
FUN_180041d20(DAT_180091000[2],0x47,&DAT_1800853e8,iVar3,(char)iVar3);
return iVar3;
}
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcf8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x7ff6fcf8;
}
uVar5 = 0x33;
LAB_18004f280:
FUN_180041d20(DAT_180091000[2],uVar5,&DAT_1800853e8,0x80090308,8);
return -0x7ff6fcf8;
}
=========================================
Function at address: 0x18004f2bc
Called functions addresses: 0xEXTERNAL:0000003f 0x180050148 0x18002a77b 0x180041cb0 0x18000c91c 0xEXTERNAL:00000040 0x180041d20 0x18004e050


int FUN_18004f2bc(longlong param_1,longlong param_2)

{
uint uVar1;
undefined uVar2;
undefined uVar3;
longlong lVar4;
bool bVar5;
int iVar6;
ulonglong uVar7;
undefined2 uVar8;
uint *puVar9;
uint *puVar10;
uint uVar11;
int *piVar12;
uint uVar13;
uint *puVar14;
bool bVar15;
char local_res10 [8];
uint local_48;
uint local_44;
HLOCAL local_40;
uint local_38;
uint local_34;
longlong local_30;

puVar9 = (uint *)0x0;
puVar10 = (uint *)0x0;
puVar14 = (uint *)0x0;
local_res10[0] = '\0';
bVar5 = false;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x53,&DAT_1800853e8);
}
uVar7 = 0;
if (*(uint *)(param_2 + 4) != 0) {
lVar4 = *(longlong *)(param_2 + 8);
piVar12 = (int *)(lVar4 + 4);
do {
iVar6 = *piVar12;
if (iVar6 == 1) {
puVar9 = (uint *)(uVar7 * 0x10 + lVar4);
}
else if (iVar6 == 2) {
if (puVar10 == (uint *)0x0) {
puVar10 = (uint *)(uVar7 * 0x10 + lVar4);
}
}
else if (iVar6 == 0x11) {
puVar14 = (uint *)(uVar7 * 0x10 + lVar4);
}
uVar11 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar11;
piVar12 = piVar12 + 4;
} while (uVar11 < *(uint *)(param_2 + 4));
if ((puVar10 != (uint *)0x0) && (puVar9 != (uint *)0x0)) {
local_30 = *(longlong *)(puVar9 + 2);
if ((local_30 == 0) || (*(longlong *)(puVar10 + 2) == 0)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcf8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x7ff6fcf8;
}
uVar8 = 0x55;
goto LAB_18004f6e5;
}
if (~*puVar10 < *puVar9) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x56,&DAT_1800853e8,0x8009035d,0x5d);
}
return -0x7ff6fca3;
}
uVar11 = *(uint *)(param_1 + 0x18);
if ((uVar11 & 0xf0000) != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x57,&DAT_1800853e8,0x80090302,2);
}
return -0x7ff6fcfe;
}
local_34 = 0;
local_40 = *(HLOCAL *)(puVar9 + 2);
if ((longlong)local_40 + (ulonglong)*puVar9 == *(longlong *)(puVar10 + 2)) {
local_48 = *puVar10 + *puVar9;
local_44 = local_48;
local_38 = local_48;
}
else {
local_44 = *puVar10 + *puVar9;
local_40 = LocalAlloc(0x40,(ulonglong)local_44);
if (local_40 == (HLOCAL)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x5a,&DAT_1800853e8,0x80090300,0);
}
return -0x7ff6fd00;
}
local_48 = local_44;
memcpy(local_40,*(void **)(puVar9 + 2),(ulonglong)*puVar9);
memcpy((void *)((ulonglong)*puVar9 + (longlong)local_40),*(void **)(puVar10 + 2),
(ulonglong)*puVar10);
local_38 = *puVar9;
bVar5 = true;
uVar11 = *(uint *)(param_1 + 0x18);
}
if (uVar11 < 0x801) {
if ((((uVar11 != 0x800) && (uVar11 != 0x10)) &&
((uVar11 != 0x20 && (((uVar11 != 0x40 && (uVar11 != 0x80)) && (uVar11 != 0x100)))))) &&
(uVar11 != 0x200)) {
bVar15 = uVar11 == 0x400;
LAB_18004f56a:
if (!bVar15) {
iVar6 = -0x7ff6fcff;
goto LAB_18004f643;
}
}
}
else if ((((uVar11 != 0x1000) && (uVar11 != 0x2000)) && (uVar11 != 0x10000)) &&
((uVar11 != 0x20000 && (uVar11 != 0x40000)))) {
bVar15 = uVar11 == 0x80000;
goto LAB_18004f56a;
}
uVar13 = *(int *)(param_1 + 0x40) + *(int *)(param_1 + 0x44);
if (uVar13 <= local_48) {
if ((*(char *)((longlong)local_40 + 1) == -2) &&
(CONCAT11(*(char *)((longlong)local_40 + 1),*(undefined *)((longlong)local_40 + 2)) <
0xff00)) {
uVar2 = *(undefined *)((longlong)local_40 + 0xb);
uVar3 = *(undefined *)((longlong)local_40 + 0xc);
}
else {
uVar2 = *(undefined *)((longlong)local_40 + 3);
uVar3 = *(undefined *)((longlong)local_40 + 4);
}
uVar1 = *(int *)(param_1 + 0x44) + (uint)CONCAT11(uVar2,uVar3);
if (uVar1 < uVar13) {
iVar6 = -0x7ff6fcf8;
local_res10[0] = '2';
goto LAB_18004f643;
}
uVar13 = uVar1;
if (uVar1 <= local_48) {
if ((uVar11 & 0x3000) == 0) {
uVar7 = FUN_18000c91c(param_1,&local_48,&local_38,local_res10);
iVar6 = (int)uVar7;
}
else {
iVar6 = FUN_180050148(param_1,(longlong)&local_48,&local_38,local_res10);
}
if ((iVar6 == 0) || (iVar6 == 0x90321)) {
*puVar9 = local_34;
*puVar10 = local_44 - local_34;
if (iVar6 == 0x90321) {
*(undefined4 *)(param_1 + 8) = 0x4c;
}
}
goto LAB_18004f643;
}
}
local_44 = uVar13;
iVar6 = -0x7ff6fce8;
LAB_18004f643:
if (bVar5) {
LocalFree(local_40);
}
if (puVar14 != (uint *)0x0) {
FUN_18004e050(param_1,puVar14,local_res10[0]);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) || (iVar6 == 0)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) {
return iVar6;
}
FUN_180041d20(DAT_180091000[2],0x5d,&DAT_1800853e8,iVar6,(char)iVar6);
return iVar6;
}
return iVar6;
}
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcf8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x7ff6fcf8;
}
uVar8 = 0x54;
LAB_18004f6e5:
FUN_180041d20(DAT_180091000[2],uVar8,&DAT_1800853e8,0x80090308,8);
return -0x7ff6fcf8;
}
=========================================
Function at address: 0x18004f728
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000010e 0x180041cb0 0xEXTERNAL:00000112 0xEXTERNAL:0000011c


int FUN_18004f728(longlong param_1,longlong *param_2,longlong *param_3,undefined8 *param_4)

{
longlong lVar1;
int iVar2;
undefined2 uVar3;
int unaff_EBX;
longlong local_res8;
longlong local_28 [2];

local_res8 = 0;
local_28[0] = 0;
if (param_1 == 0) {
return unaff_EBX;
}
if (param_2 == (longlong *)0x0) {
return unaff_EBX;
}
if (param_3 == (longlong *)0x0) {
return unaff_EBX;
}
if (param_4 == (undefined8 *)0x0) {
return unaff_EBX;
}
iVar2 = SslExpandNextGenTrafficKey(param_1,*param_2,&local_res8,0,0);
if (iVar2 == 0) {
iVar2 = SslExpandWriteKey(param_1,local_res8,local_28,0,0);
if (iVar2 == 0) {
if (*param_2 != 0) {
SslFreeObject(*param_2,0);
}
if (*param_3 != 0) {
SslFreeObject(*param_3,0);
}
lVar1 = local_res8;
local_res8 = 0;
*param_2 = lVar1;
*param_3 = local_28[0];
*param_4 = 0;
local_28[0] = 0;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return unaff_EBX;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return unaff_EBX;
}
FUN_180041cb0(DAT_180091000[2],0x8c,&DAT_1800853e8);
goto LAB_18004f89c;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18004f89c;
uVar3 = 0x8b;
}
else {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18004f89c;
uVar3 = 0x8a;
}
FUN_180041cdc(DAT_180091000[2],uVar3,&DAT_1800853e8,iVar2);
LAB_18004f89c:
if (local_res8 != 0) {
SslFreeObject(local_res8,0);
}
if (local_28[0] != 0) {
SslFreeObject(local_28[0],0);
}
return unaff_EBX;
}
=========================================
Function at address: 0x18004f8f0
Called functions addresses: 0xEXTERNAL:00000090


void FUN_18004f8f0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5,undefined param_6,undefined param_7,undefined param_8)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
TraceMessage(param_1,0x2b,&DAT_1800853e8,0x65,local_res20,4,&param_5,4,&param_6,4,&param_7,4,
&param_8,4,0);
return;
}
=========================================
Function at address: 0x18004f974
Called functions addresses: 0xEXTERNAL:00000090


void FUN_18004f974(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5,undefined param_6)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
TraceMessage(param_1,0x2b,&DAT_1800853e8,0x51,local_res20,4,&param_5,4,&param_6,4,0);
return;
}
=========================================
Function at address: 0x18004f9dc
Called functions addresses: 0xEXTERNAL:0000003f 0x180041cdc 0x18002a77b 0x180041cb0


undefined4 FUN_18004f9dc(undefined8 param_1,int *param_2,uint *param_3,undefined8 *param_4)

{
int iVar1;
undefined8 uVar2;
undefined8 *puVar3;
undefined4 uVar4;
uint uVar5;
undefined8 *_Dst;

uVar4 = 0;
uVar5 = 0x50;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1c,&DAT_180082b10);
}
if ((((param_2 == (int *)0x0) || (param_4 == (undefined8 *)0x0)) || (param_3 == (uint *)0x0)) ||
(1 < *param_2 - 3U)) {
uVar4 = 0xc000000d;
}
else {
if (param_2[1] != 0) {
uVar5 = param_2[1] * 8 + 0x50;
}
if (param_2[10] != 0) {
uVar5 = uVar5 + param_2[10] * 4;
}
if (param_2[6] != 0) {
uVar5 = uVar5 + param_2[6] * 8;
}
puVar3 = (undefined8 *)LocalAlloc(0x40,(ulonglong)uVar5);
if (puVar3 == (undefined8 *)0x0) {
uVar4 = 0xc0000017;
}
else {
uVar2 = *(undefined8 *)(param_2 + 2);
iVar1 = *param_2;
*puVar3 = *(undefined8 *)param_2;
puVar3[1] = uVar2;
uVar2 = *(undefined8 *)(param_2 + 6);
puVar3[2] = *(undefined8 *)(param_2 + 4);
puVar3[3] = uVar2;
uVar2 = *(undefined8 *)(param_2 + 10);
puVar3[4] = *(undefined8 *)(param_2 + 8);
puVar3[5] = uVar2;
uVar2 = *(undefined8 *)(param_2 + 0xe);
puVar3[6] = *(undefined8 *)(param_2 + 0xc);
puVar3[7] = uVar2;
if (iVar1 == 3) {
puVar3[8] = *(undefined8 *)(param_2 + 0x10);
}
else {
uVar2 = *(undefined8 *)(param_2 + 0x12);
puVar3[8] = *(undefined8 *)(param_2 + 0x10);
puVar3[9] = uVar2;
}
_Dst = puVar3 + 10;
if (param_2[1] != 0) {
memcpy(_Dst,*(void **)(param_2 + 2),(ulonglong)(uint)param_2[1] << 3);
puVar3[1] = _Dst;
*(int *)((longlong)puVar3 + 4) = param_2[1];
_Dst = _Dst + (uint)param_2[1];
}
if (param_2[6] != 0) {
memcpy(_Dst,*(void **)(param_2 + 8),(ulonglong)(uint)param_2[6] << 3);
puVar3[4] = _Dst;
*(int *)(puVar3 + 3) = param_2[6];
_Dst = _Dst + (uint)param_2[6];
}
if (param_2[10] != 0) {
memcpy(_Dst,*(void **)(param_2 + 0xc),(ulonglong)(uint)param_2[10] << 2);
puVar3[6] = _Dst;
*(int *)(puVar3 + 5) = param_2[10];
}
*param_3 = uVar5;
*param_4 = puVar3;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1d,&DAT_180082b10,uVar4);
}
return uVar4;
}
=========================================
Function at address: 0x18004fbd0
Called functions addresses: 0x180041cdc 0x18004dc98 0x180041cb0 0x18000c710 0x18002a7c0 0xEXTERNAL:000000c6 0x180041d20 0x180041e9c


int FUN_18004fbd0(longlong param_1,uint param_2,undefined4 *param_3,longlong *param_4)

{
undefined8 *puVar1;
longlong lVar2;
int iVar3;
longlong *plVar4;
ulonglong uVar5;
int unaff_EBX;
longlong *local_38;
undefined8 local_30;
undefined8 uStack_28;
undefined4 local_20;
undefined4 local_1c;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x20,&DAT_180082b10);
}
if (param_4 != (longlong *)0x0) {
*param_4 = 0;
}
*param_3 = 0;
puVar1 = (undefined8 *)(param_3 + 2);
*puVar1 = 0;
param_3[1] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x21,&DAT_180082b10,param_1);
}
plVar4 = FUN_18000c710(param_1);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x22,&DAT_180082b10,plVar4);
}
if (plVar4 == (longlong *)0x0) {
return unaff_EBX;
}
if (*(int *)(plVar4 + 1) != 4) {
return unaff_EBX;
}
local_20 = 0;
local_1c = 0;
local_30 = 0;
uStack_28 = 0;
local_38 = plVar4;
uVar5 = FUN_18004dc98(&local_38,(undefined *)0x0,puVar1,param_3);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x23,&DAT_180082b10,(int)uVar5);
}
if ((int)uVar5 != 0) {
return unaff_EBX;
}
if ((param_4 != (longlong *)0x0) && (lVar2 = plVar4[0x21], lVar2 != 0)) {
if ((param_2 & 2) == 0) {
iVar3 = NtDuplicateObject(0xffffffffffffffff,lVar2,0xffffffffffffffff,param_4,0,0,2);
if (iVar3 < 0) {

*puVar1 = 0;
*param_3 = 0;
goto LAB_18004fd50;
}
}
else {
*param_4 = lVar2;
plVar4[0x21] = 0;
}
}
iVar3 = 0;
LAB_18004fd50:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar3 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x24,&DAT_180082b10,iVar3,(char)iVar3);
}
return unaff_EBX;
}
=========================================
Function at address: 0x18004fe10
Called functions addresses: 0x18000c710 0x180041cb0


int FUN_18004fe10(longlong param_1,longlong *param_2)

{
int iVar1;
longlong *plVar2;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1b,&DAT_180082b10);
}
plVar2 = FUN_18000c710(param_1);
if (plVar2 == (longlong *)0x0) {
iVar1 = -0x7ff6fcff;
}
else if (plVar2[0x21] == 0) {
iVar1 = -0x7ff6fcf5;
if (*(int *)(plVar2 + 0x22) != 0) {
iVar1 = *(int *)(plVar2 + 0x22);
}
}
else {
*param_2 = plVar2[0x21];
iVar1 = 0;
}
return iVar1;
}
=========================================
Function at address: 0x18004fea0
Called functions addresses: 0x18000e850 0x180041cb0 0x180041d20 0x18000b190


undefined8 FUN_18004fea0(uint *param_1,longlong param_2,ulonglong *param_3,ulonglong param_4)

{
int iVar1;
undefined8 uVar2;
longlong lVar3;
ulonglong uVar4;
ulonglong *puVar5;

lVar3 = param_2;
puVar5 = param_3;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
puVar5 = (ulonglong *)&DAT_180082b10;
lVar3 = 0x25;
FUN_180041cb0(DAT_180091000[2],0x25,&DAT_180082b10);
}
iVar1 = FUN_18000e850(1,lVar3,(undefined *)puVar5,param_4);
if (iVar1 == 0) {
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cb0(DAT_180091000[2],0x26,&DAT_180082b10);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0x27,&DAT_180082b10,0x80090304,4);
}
}
uVar2 = 0x80090304;
}
else {
do {
LOCK();
iVar1 = DAT_180092f50 + 1;
UNLOCK();
uVar4 = (ulonglong)(DAT_180092f50 + 1);
DAT_180092f50 = iVar1;
} while ((uVar4 & 7) == 0);
uVar2 = FUN_18000b190(uVar4,param_2,param_1,1);
if (-1 < (int)uVar2) {
*param_3 = uVar4;
}
}
return uVar2;
}
=========================================
Function at address: 0x18004ffb0
Called functions addresses: 0x180041cdc 0x180026c74


int FUN_18004ffb0(int param_1,undefined8 param_2,undefined8 param_3)

{
undefined8 uVar1;
int iVar2;
int local_res8 [2];

if (param_1 == 0x2200) {
iVar2 = 2;
}
else {
iVar2 = 3;
if (param_1 != 0x2203) {
if ((param_1 == 0x2400) || (param_1 == 0xa400)) {
iVar2 = 1;
}
else {
uVar1 = FUN_180026c74(param_1,param_2,param_3,local_res8,(undefined4 *)0x0);
iVar2 = local_res8[0];
if (((((int)uVar1 != 0) || (local_res8[0] == 0)) &&
((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xc,&DAT_1800853f8,param_1);
}
}
}
}
return iVar2;
}
=========================================
Function at address: 0x18005004c
Called functions addresses: 0xEXTERNAL:00000090


void FUN_18005004c(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4,
undefined param_5)

{
undefined8 local_res20;

local_res20 = param_4;
TraceMessage(param_1,0x2b,param_3,param_2,&local_res20,8,&param_5,4,0);
return;
}
=========================================
Function at address: 0x1800500a0
Called functions addresses: 0xEXTERNAL:00000090


void FUN_1800500a0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4,
wchar_t *param_5)

{
longlong lVar1;
undefined8 local_res20;

if (param_5 == (wchar_t *)0x0) {
lVar1 = 10;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (param_5[lVar1] != L'\0');
lVar1 = lVar1 * 2 + 2;
}
if (param_5 == (wchar_t *)0x0) {
param_5 = L"NULL";
}
local_res20 = param_4;
TraceMessage(param_1,0x2b,&DAT_1800853f8,0x17,&local_res20,8,param_5,lVar1,&stack0x00000030,4,0);
return;
}
=========================================
Function at address: 0x180050148
Called functions addresses: 0x180043258 0x180041cdc 0xEXTERNAL:0000010a 0x18002a77b 0x180041cb0 0x18000172c 0x1800432ec 0x180041e58 0x180041d20


int FUN_180050148(longlong param_1,longlong param_2,uint *param_3,undefined *param_4)

{
uint uVar1;
byte bVar2;
byte bVar3;
byte *pbVar4;
int iVar5;
undefined8 uVar6;
byte *_Src;
ulonglong uVar7;
undefined8 *puVar8;
undefined2 uVar9;
uint uVar10;
uint local_res8 [2];

if (((((param_1 == 0) || (param_2 == 0)) ||
(pbVar4 = *(byte **)(param_2 + 8), pbVar4 == (byte *)0x0)) ||
((param_3 == (uint *)0x0 || (*(longlong *)(param_3 + 2) == 0)))) ||
(param_4 == (undefined *)0x0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],10,&DAT_180085408,0x8009035d,0x5d);
}
return -0x7ff6fca3;
}
if ((*(uint *)(param_1 + 0x18) & 0x3000) == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) != 0)) {
FUN_180041d20(DAT_180091000[2],0xb,&DAT_180085408,0x80090301,1);
}
return -0x7ff6fcff;
}
if ((*(int *)(param_1 + 8) != 4) && (*(int *)(param_1 + 8) != 0x4f)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fcf8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x7ff6fcf8;
}
uVar9 = 0xc;
puVar8 = DAT_180091000;
goto LAB_1800506c5;
}
local_res8[0] = *(uint *)(param_2 + 4);
iVar5 = *(int *)(param_1 + 0x44);
uVar10 = *(int *)(param_1 + 0x40) + iVar5;
*(undefined4 *)(param_2 + 4) = 0;
if (local_res8[0] < uVar10) {
*(uint *)(param_2 + 4) = uVar10;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fce8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x7ff6fce8;
}
uVar9 = 0xd;
}
else {
if ((pbVar4[1] == 0xfe) && (CONCAT11(pbVar4[1],pbVar4[2]) < 0xff00)) {
bVar2 = pbVar4[0xb];
bVar3 = pbVar4[0xc];
}
else {
bVar2 = pbVar4[3];
bVar3 = pbVar4[4];
}
uVar1 = (uint)CONCAT11(bVar2,bVar3) + iVar5;
if (uVar1 <= local_res8[0]) {
local_res8[0] = local_res8[0] - uVar10;
_Src = pbVar4 + uVar10;
iVar5 = SslDecryptPacket(*(undefined8 *)(param_1 + 0x58),*(undefined8 *)(param_1 + 0x28),
pbVar4,uVar1,_Src,local_res8[0],local_res8,
*(undefined8 *)(param_1 + 0x60),0);
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0xf,&DAT_180085408,iVar5);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x10,&DAT_180085408,local_res8[0]);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x11,&DAT_180085408,*(undefined8 *)(param_1 + 0x60));
}
}
}
*(int *)(param_2 + 4) = *(int *)(param_2 + 4) + uVar1;
*(longlong *)(param_1 + 0x60) = *(longlong *)(param_1 + 0x60) + 1;
if (iVar5 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x12,&DAT_180085408,iVar5);
}
puVar8 = DAT_180091000;
*param_4 = 0x14;
if (((undefined8 **)puVar8 != &DAT_180091000) &&
((*(byte *)((longlong)puVar8 + 0x1c) & 5) != 0)) {
FUN_180043258(puVar8[2],0x13,&DAT_180085408,0x80090330,0x30);
}
return -0x7ff6fcd0;
}
uVar7 = (ulonglong)local_res8[0];
do {
local_res8[0] = (int)uVar7 - 1;
uVar7 = (ulonglong)local_res8[0];
if (local_res8[0] == 0) break;
} while (_Src[uVar7] == 0);
bVar2 = _Src[uVar7];
if (bVar2 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180085408);
}
puVar8 = DAT_180091000;
*param_4 = 10;
if ((undefined8 **)puVar8 == &DAT_180091000) {
return -0x7ff6fcf8;
}
if ((*(byte *)((longlong)puVar8 + 0x1c) & 5) == 0) {
return -0x7ff6fcf8;
}
FUN_180043258(puVar8[2],0x15,&DAT_180085408,0x80090308,8);
return -0x7ff6fcf8;
}
*pbVar4 = bVar2;
uVar10 = (uint)bVar2;
bVar2 = *_Src;
if (uVar10 != 0x15) {
if (uVar10 == 0x16) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180085408);
}
*(undefined *)(param_1 + 0x70) = 0;
param_3[1] = 0;
if (((bVar2 == 4) || (bVar2 == 0xb)) || ((bVar2 == 0xd || (bVar2 == 0x18)))) {
*(int *)(param_2 + 4) = *(int *)(param_2 + 4) - uVar1;
*(undefined2 *)(pbVar4 + ((ulonglong)uVar1 - 2)) = (undefined2)local_res8[0];
*(undefined4 *)(param_1 + 8) = 0x4e;
iVar5 = 0x90321;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x90321;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x90321;
}
uVar9 = 0x17;
goto LAB_18005071b;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x18,&DAT_180085408,(uint)bVar2);
}
puVar8 = DAT_180091000;
*param_4 = 10;
if ((undefined8 **)puVar8 == &DAT_180091000) {
return -0x7ff6fcf8;
}
if ((*(byte *)((longlong)puVar8 + 0x1c) & 5) == 0) {
return -0x7ff6fcf8;
}
uVar9 = 0x19;
}
else {
if (uVar10 == 0x17) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1a,&DAT_180085408);
}
*(undefined *)(param_1 + 0x70) = 0;
if (*(byte **)(param_3 + 2) != _Src) {
if (*param_3 < local_res8[0]) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1b,&DAT_180085408);
}
puVar8 = DAT_180091000;
*param_4 = 0x14;
if ((undefined8 **)puVar8 == &DAT_180091000) {
return -0x7ff6fcd0;
}
if ((*(byte *)((longlong)puVar8 + 0x1c) & 5) == 0) {
return -0x7ff6fcd0;
}
FUN_180041d20(puVar8[2],0x1c,&DAT_180085408,0x80090330,0x30);
return -0x7ff6fcd0;
}
memcpy(*(byte **)(param_3 + 2),_Src,(ulonglong)local_res8[0]);
}
param_3[1] = local_res8[0];
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],0x1d,&DAT_180085408,0,0);
}
return 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x20,&DAT_180085408,uVar10);
}
puVar8 = DAT_180091000;
*param_4 = 10;
if ((undefined8 **)puVar8 == &DAT_180091000) {
return -0x7ff6fcf8;
}
if ((*(byte *)((longlong)puVar8 + 0x1c) & 5) == 0) {
return -0x7ff6fcf8;
}
uVar9 = 0x21;
}
LAB_1800506c5:
FUN_180041d20(puVar8[2],uVar9,&DAT_180085408,0x80090308,8);
return -0x7ff6fcf8;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1e,&DAT_180085408);
}
uVar6 = FUN_18000172c(_Src,local_res8[0],(byte *)(param_1 + 0x70),(undefined *)0x0);
param_3[1] = 0;
iVar5 = (int)uVar6;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar5;
}
if ((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) || (iVar5 == 0)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) {
return iVar5;
}
uVar9 = 0x1f;
LAB_18005071b:
FUN_180041d20(DAT_180091000[2],uVar9,&DAT_180085408,iVar5,(char)iVar5);
return iVar5;
}
*(uint *)(param_2 + 4) = uVar1;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return -0x7ff6fce8;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return -0x7ff6fce8;
}
uVar9 = 0xe;
}
FUN_180041d20(DAT_180091000[2],uVar9,&DAT_180085408,0x80090318,0x18);
return -0x7ff6fce8;
}
=========================================
Function at address: 0x180050800
Called functions addresses: 0xEXTERNAL:000000c2 0x180041cb0 0xEXTERNAL:000000c0 0x180041e9c


longlong * FUN_180050800(longlong *param_1)

{
longlong *plVar1;
longlong *plVar2;
longlong *plVar3;
longlong lVar4;
uint uVar5;

if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0) {
FUN_180041cb0(DAT_180091000[2],0x18,&DAT_180085418);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x19,&DAT_180085418);
}
}
uVar5 = 0;
if (DAT_1800919e0 != 0) {
do {
lVar4 = (ulonglong)(DAT_1800919e4 - 1U & uVar5) * 0x60;
RtlAcquireResourceShared(DAT_1800921d0 + lVar4,1);
plVar2 = (longlong *)((ulonglong)uVar5 * 0x10 + DAT_1800921c8);
plVar1 = (longlong *)*plVar2;
if (plVar1 != plVar2) {
do {
plVar3 = plVar1 + -0x26;
if (*param_1 == plVar1[-1]) {
RtlReleaseResource(DAT_1800921d0 + lVar4);
goto LAB_18005090c;
}
plVar1 = (longlong *)*plVar1;
} while (plVar1 != plVar2);
}
RtlReleaseResource(DAT_1800921d0 + lVar4);
uVar5 = uVar5 + 1;
} while (uVar5 < DAT_1800919e0);
}
plVar3 = (longlong *)0x0;
LAB_18005090c:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x1a,&DAT_180085418,plVar3);
}
return plVar3;
}
=========================================
Function at address: 0x180050980
Called functions addresses: 0xEXTERNAL:0000007f 0xEXTERNAL:000000a5


void FUN_180050980(undefined8 param_1)

{
HANDLE pvVar1;
undefined8 local_res8;
undefined8 local_res10 [3];

local_res10[0] = 0;
local_res8 = param_1;
pvVar1 = GetCurrentProcess();
NtFreeVirtualMemory(pvVar1,&local_res8,local_res10,0x8000);
return;
}
=========================================
Function at address: 0x1800509d0
Called functions addresses: 0xEXTERNAL:000000de 0xEXTERNAL:0000007f


undefined8 FUN_1800509d0(ulonglong param_1)

{
int iVar1;
HANDLE pvVar2;
undefined8 local_res10;
ulonglong local_res18 [2];

local_res18[0] = param_1 & 0xffffffff;
local_res10 = 0;
pvVar2 = GetCurrentProcess();
iVar1 = NtAllocateVirtualMemory(pvVar2,&local_res10,0,local_res18,0x1000,4);
if (iVar1 < 0) {
local_res10 = 0;
}
return local_res10;
}
=========================================
Function at address: 0x180050a40
Called functions addresses: 0x18000909c 0xEXTERNAL:00000108 0x18000e850 0xEXTERNAL:0000017d 0x180041e9c


int FUN_180050a40(longlong param_1,ulonglong param_2,uint *param_3,ulonglong param_4)

{
int iVar1;
SECURITY_STATUS SVar2;
undefined8 *puVar3;
NCRYPT_HANDLE *pNVar4;

SVar2 = 0;
iVar1 = FUN_18000e850(1,param_2,(undefined *)param_3,param_4);
if (((iVar1 == 0) || (param_3 == (uint *)0x0)) ||
(pNVar4 = *(NCRYPT_HANDLE **)(param_3 + 2), pNVar4 == (NCRYPT_HANDLE *)0x0)) {
return 0x54f;
}
if ((ulonglong)*param_3 < (ulonglong)(param_1 << 4)) {
return -0x7ff6fce8;
}
puVar3 = DAT_180091000;
if (param_1 != 0) {
do {
if (*pNVar4 != 0) {
SVar2 = NCryptFreeObject(*pNVar4);
puVar3 = DAT_180091000;
}
if (((SVar2 < 0) && ((undefined8 **)puVar3 != &DAT_180091000)) &&
((*(byte *)((longlong)puVar3 + 0x1c) & 1) != 0)) {
FUN_180041e9c(puVar3[2],0x30,&DAT_180085440,pNVar4);
puVar3 = DAT_180091000;
}
if (pNVar4[1] != 0) {
SVar2 = CryptReleaseContext(pNVar4[1],param_2 & 0xffffffff);
puVar3 = DAT_180091000;
}
if (((SVar2 < 0) && ((undefined8 **)puVar3 != &DAT_180091000)) &&
((*(byte *)((longlong)puVar3 + 0x1c) & 1) != 0)) {
FUN_180041e9c(puVar3[2],0x31,&DAT_180085440,pNVar4 + 1);
puVar3 = DAT_180091000;
}
pNVar4 = pNVar4 + 2;
param_1 = param_1 + -1;
} while (param_1 != 0);
pNVar4 = *(NCRYPT_HANDLE **)(param_3 + 2);
if (pNVar4 == (NCRYPT_HANDLE *)0x0) goto LAB_180050b7a;
}
FUN_18000909c(pNVar4);
param_3[2] = 0;
param_3[3] = 0;
LAB_180050b7a:
param_3[1] = 0;
*param_3 = 0;
return SVar2;
}
=========================================
Function at address: 0x180050bb0
Called functions addresses: 0x180050800 0x18000e850 0x18004e0fc 0x18000c710 0x180041cb0


undefined4 FUN_180050bb0(longlong param_1,undefined8 param_2,int *param_3,undefined4 *param_4)

{
int iVar1;
undefined4 uVar2;
longlong *plVar3;
undefined8 uVar4;
int *piVar5;

uVar4 = param_2;
piVar5 = param_3;
iVar1 = FUN_18000e850(1,param_2,(undefined *)param_3,(ulonglong)param_4);
if (((iVar1 == 0) || (param_3 == (int *)0x0)) || (param_4 == (undefined4 *)0x0)) {
uVar2 = 0x80090304;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
piVar5 = (int *)&DAT_180085440;
uVar4 = 0x3d;
FUN_180041cb0(DAT_180091000[2],0x3d,&DAT_180085440);
}
if ((*(longlong **)(param_3 + 2) == (longlong *)0x0) || (*param_3 != 8)) {
plVar3 = FUN_18000c710(param_1);
}
else {
plVar3 = FUN_180050800(*(longlong **)(param_3 + 2));
}
if (plVar3 == (longlong *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3e,&DAT_180085440);
}
uVar2 = 0x80090301;
}
else {
uVar2 = FUN_18004e0fc((longlong)plVar3,uVar4,piVar5,(byte)param_2,param_4);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3f,&DAT_180085440);
}
}
}
return uVar2;
}
=========================================
Function at address: 0x180050ce0
Called functions addresses: 0xEXTERNAL:00000127 0x180041cdc 0x18000909c 0x18000a1f4 0x18000e850 0x180041cb0 0xEXTERNAL:00000125 0x1800509d0 0x180050980 0x180051f10 0x1800520e0 0xEXTERNAL:00000041


ulonglong FUN_180050ce0(undefined8 param_1,ulonglong param_2,undefined *param_3,uint *param_4)

{
int *piVar1;
int iVar2;
BOOL BVar3;
DWORD DVar4;
int iVar5;
int extraout_EAX;
int extraout_EAX_00;
uint *puVar6;
undefined8 uVar7;
undefined2 uVar8;
undefined8 *puVar9;
ulonglong unaff_RBX;
uint uVar10;
uint uVar11;
HCERTSTORE hCertStore;
uint uVar12;
uint *puVar13;
DWORD local_98;
uint local_94;
uint local_90;
uint local_88 [2];
uint *local_80;
undefined8 *local_78;
int local_70 [2];
HCERTSTORE local_68;
HCERTSTORE local_60;
undefined8 local_58;
undefined8 uStack_50;
PCCERT_CONTEXT local_48;

iVar5 = 0;
local_70[0] = 0;
local_68 = (HCERTSTORE)0x0;
puVar6 = (uint *)0x0;
local_88[0] = 0;
uVar10 = 0;
local_80 = (uint *)0x0;
uVar11 = 1;
local_70[1] = 1;
local_88[1] = 1;
iVar2 = FUN_18000e850(1,param_2,param_3,(ulonglong)param_4);
if (iVar2 == 0) {
return unaff_RBX;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x40,&DAT_180085440);
}
if (((param_4 != (uint *)0x0) && (param_3 != (undefined *)0x0)) &&
(*(undefined8 **)(param_3 + 8) != (undefined8 *)0x0)) {
piVar1 = (int *)**(undefined8 **)(param_3 + 8);
if (*piVar1 - 1U < 5) {
if (*piVar1 == 4) {
local_94 = piVar1[1];
puVar9 = *(undefined8 **)(piVar1 + 2);
local_90 = piVar1[0x12];
hCertStore = *(HCERTSTORE *)(piVar1 + 4);
}
else {
local_94 = piVar1[2];
puVar9 = *(undefined8 **)(piVar1 + 4);
local_90 = piVar1[0xd];
hCertStore = *(HCERTSTORE *)(piVar1 + 6);
}
uVar12 = 0;
local_78 = puVar9;
local_60 = hCertStore;
if (local_94 != 0) {
do {
local_48 = (PCCERT_CONTEXT)*puVar9;
local_98 = 0;
BVar3 = CertSerializeCertificateStoreElement(local_48,0,(BYTE *)0x0,&local_98);
if (BVar3 == 0) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18005112e;
DVar4 = GetLastError();
uVar8 = 0x41;
goto LAB_180050f35;
}
uVar10 = uVar10 + 0x10 + local_98;
if ((local_90 & 0x10000) != 0) {
local_58 = 0;
uStack_50 = 0;
BVar3 = CertSaveStore(local_48->hCertStore,1,1,2,&local_58,0);
if (BVar3 == 0) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18005112e;
DVar4 = GetLastError();
uVar8 = 0x42;
goto LAB_180050f35;
}
uVar10 = uVar10 + 8 + (int)local_58;
}
uVar12 = uVar12 + 1;
puVar9 = puVar9 + 1;
} while (uVar12 < local_94);
}
if (hCertStore != (HCERTSTORE)0x0) {
local_58 = 0;
uStack_50 = 0;
BVar3 = CertSaveStore(hCertStore,1,1,2,&local_58,0);
if (BVar3 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar4 = GetLastError();
uVar8 = 0x43;
LAB_180050f35:
FUN_180041cdc(DAT_180091000[2],uVar8,&DAT_180085440,DVar4);
}
goto LAB_18005112e;
}
uVar10 = uVar10 + 8 + (int)local_58;
}
if (uVar10 != 0) {
if ((param_2 & 8) == 0) {
puVar6 = (uint *)FUN_1800509d0((ulonglong)uVar10);
}
else {
puVar6 = (uint *)FUN_18000a1f4((ulonglong)uVar10);
}
if (puVar6 != (uint *)0x0) {
local_98 = 0;
puVar13 = puVar6;
uVar12 = uVar10;
if (local_94 != 0) {
do {
local_68 = (HCERTSTORE)*local_78;
local_80 = puVar13 + 1;
local_70[0] = 0x28;
local_88[0] = uVar12 - 4;
uVar7 = FUN_180051f10(0,0,local_70,local_88);
iVar5 = (int)uVar7;
if (iVar5 < 0) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18005112e;
uVar8 = 0x44;
goto LAB_1800510fa;
}
uVar12 = (uVar12 - 4) - local_88[0];
*puVar13 = local_88[0];
puVar13 = (uint *)((longlong)puVar13 + (ulonglong)local_88[0] + 4);
if ((local_90 & 0x10000) != 0) {
if (uVar12 < 4) goto LAB_18005112e;
local_80 = puVar13 + 1;
local_88[0] = uVar12 - 4;
FUN_1800520e0(1,0,local_70,local_88);
iVar5 = extraout_EAX;
if (extraout_EAX < 0) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18005112e;
uVar8 = 0x45;
goto LAB_1800510fa;
}
uVar12 = (uVar12 - 4) - local_88[0];
*puVar13 = local_88[0];
puVar13 = (uint *)((longlong)puVar13 + (ulonglong)local_88[0] + 4);
}
local_98 = local_98 + 1;
local_78 = local_78 + 1;
} while (local_98 < local_94);
}
if (local_60 == (HCERTSTORE)0x0) {
LAB_180051115:
if (-1 < iVar5) goto LAB_18005114a;
}
else {
local_68 = local_60;
local_70[0] = 8;
if (3 < uVar12) {
local_80 = puVar13 + 1;
local_88[0] = uVar12 - 4;
FUN_1800520e0(0,0,local_70,local_88);
iVar5 = extraout_EAX_00;
if (-1 < extraout_EAX_00) {
*puVar13 = local_88[0];
goto LAB_180051115;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar8 = 0x46;
LAB_1800510fa:
FUN_180041cdc(DAT_180091000[2],uVar8,&DAT_180085440,iVar5);
}
}
}
}
}
}
}
LAB_18005112e:
if ((param_2 & 8) == 0) {
FUN_180050980(puVar6);
}
else {
FUN_18000909c(puVar6);
}
uVar10 = 0;
puVar6 = (uint *)0x0;
uVar11 = 0;
LAB_18005114a:
param_4[1] = uVar11;
*(uint **)(param_4 + 2) = puVar6;
*param_4 = uVar10;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x47,&DAT_180085440);
}
return unaff_RBX;
}
=========================================
Function at address: 0x1800511b0
Called functions addresses: 0x18000909c 0x180041cdc 0x18005ca1c 0x18000a1f4 0x18000e850 0x180041cb0 0x18005c9b4 0x180041d70 0x180041e9c


DWORD FUN_1800511b0(ulonglong param_1,ulonglong param_2,int *param_3,uint *param_4)

{
DWORD DVar1;
uint uVar2;
uint uVar3;
int iVar4;
uint uVar5;
undefined8 *puVar6;
uint uVar7;
DWORD DVar8;
uint uVar9;
wchar_t *pwVar10;
int local_88 [2];
wchar_t *local_80;
wchar_t *local_78;
NCRYPT_KEY_HANDLE local_70;
int local_68;
uint local_64;
HCRYPTPROV local_60;
ulonglong local_58;
undefined8 local_50;
undefined8 uStack_48;

local_78 = (wchar_t *)0x0;
DVar8 = 0;
local_80 = (wchar_t *)0x0;
local_88[0] = 0;
local_70 = 0;
local_60 = 0;
iVar4 = FUN_18000e850(1,param_2,(undefined *)param_3,(ulonglong)param_4);
if (((iVar4 == 0) || (param_3 == (int *)0x0)) || (param_4 == (uint *)0x0)) {
DVar8 = 0x54f;
}
else {
*param_4 = 0;
param_4[2] = 0;
param_4[3] = 0;
param_4[1] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x24,&DAT_180085440);
}
uVar9 = 8;
if (*(longlong *)(param_3 + 2) == 0) {
DVar8 = 0x54f;
}
else {
param_4[1] = 1;
uVar7 = (int)param_1 * 0x24;
*param_4 = uVar7;
if ((param_2 & 4) != 0) {
uVar7 = uVar7 + 8;
*param_4 = uVar7;
}
puVar6 = (undefined8 *)FUN_18000a1f4((ulonglong)uVar7);
*(undefined8 **)(param_4 + 2) = puVar6;
if (puVar6 == (undefined8 *)0x0) {
DVar8 = 0xe;
}
else {
if ((param_2 & 4) != 0) {
*puVar6 = **(undefined8 **)(param_3 + 2);
puVar6 = puVar6 + 1;
}
pwVar10 = (wchar_t *)(*(longlong *)(param_3 + 2) + 8);
local_58 = 0;
uVar7 = *param_3 - 8;
if (param_1 != 0) {
do {
local_68 = *(int *)(pwVar10 + 10);
local_64 = uVar7 - *(int *)pwVar10;
uVar7 = *(uint *)(pwVar10 + 0x12);
local_50 = *(undefined8 *)(pwVar10 + 2);
uStack_48 = *(undefined8 *)(pwVar10 + 6);
DVar1 = *(DWORD *)(pwVar10 + 0xc);
uVar2 = *(uint *)(pwVar10 + 0xe);
DVar8 = *(DWORD *)(pwVar10 + 0x10);
uVar3 = *(uint *)(pwVar10 + 0x14);
pwVar10 = pwVar10 + 0x16;
uVar5 = uVar7 + 0x2c;
if ((uVar5 < 0x2c) || (uVar3 + uVar5 < uVar5)) {
DVar8 = 0x216;
break;
}
if (local_64 < uVar3 + uVar5) {
DVar8 = 0x54f;
break;
}
if (uVar7 != 0) {
local_78 = pwVar10;
pwVar10 = (wchar_t *)((longlong)pwVar10 + (ulonglong)uVar7);
}
if (uVar3 != 0) {
local_80 = pwVar10;
pwVar10 = (wchar_t *)((longlong)pwVar10 + (ulonglong)uVar3);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041d70(DAT_180091000[2],0x25,&DAT_180085440,local_78);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041d70(DAT_180091000[2],0x26,&DAT_180085440,local_80);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x27,&DAT_180085440,DVar8);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x28,&DAT_180085440,DVar1);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x29,&DAT_180085440,uVar2);
}
}
}
}
}
DVar8 = FUN_18005ca1c(&local_70,local_78,local_80,DVar8,uVar2,1,local_88);
if (DVar8 != 0) {
if (local_88[0] == 0) {
local_70 = 0;
DVar8 = FUN_18005c9b4(&local_60,local_78,local_80,DVar1,uVar2);
if (DVar8 == 0) goto LAB_1800514b6;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2b,&DAT_180085440,DVar8);
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2a,&DAT_180085440);
}
DVar8 = 0x8009030d;
break;
}
LAB_1800514b6:
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x2c,&DAT_180085440);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041e9c(DAT_180091000[2],0x2d,&DAT_180085440,local_70);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x2e,&DAT_180085440,local_60);
}
}
}
local_58 = local_58 + 1;
*puVar6 = local_50;
puVar6[1] = uStack_48;
*(int *)(puVar6 + 2) = local_68;
*(NCRYPT_KEY_HANDLE *)((longlong)puVar6 + 0x14) = local_70;
*(HCRYPTPROV *)((longlong)puVar6 + 0x1c) = local_60;
puVar6 = (undefined8 *)((longlong)puVar6 + 0x24);
uVar7 = local_64;
} while (local_58 < param_1);
}
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2f,&DAT_180085440);
}
if (DVar8 != 0) {
if ((param_2 & 4) == 0) {
if (*(HLOCAL *)(param_4 + 2) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_4 + 2));
}
param_4[2] = 0;
param_4[3] = 0;
param_4[1] = 0;
uVar9 = 0;
}
*param_4 = uVar9;
DVar8 = 0;
}
}
return DVar8;
}
=========================================
Function at address: 0x180051690
Called functions addresses: 0x18004e3b4 0x180050800 0x18000e850 0x18000c710 0x180041cb0


ulonglong FUN_180051690(longlong param_1,undefined8 param_2,uint *param_3,ulonglong param_4)

{
int iVar1;
longlong *plVar2;
ulonglong uVar3;

iVar1 = FUN_18000e850(1,param_2,(undefined *)param_3,param_4);
if ((iVar1 == 0) || (param_3 == (uint *)0x0)) {
uVar3 = 0x80090304;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3a,&DAT_180085440);
}
if (*param_3 == 0xc) {
plVar2 = FUN_180050800(*(longlong **)(param_3 + 2));
}
else {
plVar2 = FUN_18000c710(param_1);
}
if (plVar2 == (longlong *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3b,&DAT_180085440);
}
uVar3 = 0x80090301;
}
else {
uVar3 = FUN_18004e3b4((longlong)plVar2,(byte)param_2,param_3);
uVar3 = uVar3 & 0xffffffff;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180085440);
}
}
}
return uVar3;
}
=========================================
Function at address: 0x1800517a0
Called functions addresses: 0x18000a1f4 0xEXTERNAL:00000184 0xEXTERNAL:0000017e 0xEXTERNAL:0000017f 0xEXTERNAL:00000109 0xEXTERNAL:00000041 0x180041e9c 0xEXTERNAL:0000003c 0xEXTERNAL:00000185 0x180041cdc 0x18000909c 0xEXTERNAL:00000180 0x18000e850 0x180041cb0 0xEXTERNAL:00000181 0xEXTERNAL:00000107


DWORD FUN_1800517a0(NCRYPT_HANDLE param_1,longlong param_2,uint *param_3,DWORD *param_4)

{
uint uVar1;
uint uVar2;
uint uVar3;
DWORD dwDataLen;
int iVar4;
uint uVar5;
SECURITY_STATUS SVar6;
BOOL BVar7;
DWORD DVar8;
PBYTE pbSignature;
undefined2 uVar9;
uint uVar10;
DWORD DVar11;
ALG_ID **pPaddingInfo;
wchar_t *_Str1;
ALG_ID *pAVar12;
BYTE *pBVar13;
ALG_ID *pAVar14;
ALG_ID *pAVar15;
DWORD local_78 [2];
HCRYPTHASH local_70;
DWORD local_68;
ALG_ID *local_60;
longlong local_58;
DWORD local_50;
ALG_ID local_4c;
ALG_ID *local_48;
undefined8 uStack_40;

local_70 = 0;
iVar4 = FUN_18000e850(1,param_2,(undefined *)param_3,(ulonglong)param_4);
if (((iVar4 == 0) || (param_3 == (uint *)0x0)) || (param_4 == (DWORD *)0x0)) {
return 0x54f;
}
param_4[0] = 0;
param_4[1] = 0;
param_4[2] = 0;
param_4[3] = 0;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180085440);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_180085440,(int)param_1);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xc,&DAT_180085440,(int)param_2);
}
}
}
uVar1 = *param_3;
pAVar14 = *(ALG_ID **)(param_3 + 2);
if (uVar1 < 0x24) {
return 0x80090318;
}
local_68 = pAVar14[1];
local_4c = *pAVar14;
local_78[0] = pAVar14[2];
local_58 = *(longlong *)(pAVar14 + 3);
DVar8 = pAVar14[8];
uVar2 = pAVar14[6];
uVar3 = pAVar14[7];
local_60 = (ALG_ID *)CONCAT44(local_60._4_4_,pAVar14[5]);
pAVar14 = pAVar14 + 9;
local_50 = DVar8;
local_48 = pAVar14;
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_180085440,local_4c);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xe,&DAT_180085440,local_78[0]);
}
}
dwDataLen = local_50;
uVar5 = uVar2 + 0x18;
if (((uVar5 < 0x18) || (uVar10 = uVar5 + uVar3, uVar10 < uVar5)) || (uVar10 + DVar8 < uVar10)) {
return 0x216;
}
DVar11 = 0;
if (uVar1 < uVar10 + DVar8) {
return 0x54f;
}
if (uVar2 != 0) {
pAVar14 = (ALG_ID *)((longlong)pAVar14 + (ulonglong)uVar2);
}
_Str1 = (wchar_t *)(-(ulonglong)(uVar2 != 0) & (ulonglong)local_48);
pAVar12 = (ALG_ID *)0x0;
pAVar15 = pAVar14;
if (uVar3 != 0) {
if ((uVar2 & 1) != 0) {
return 0x54f;
}
pAVar15 = (ALG_ID *)((longlong)pAVar14 + (ulonglong)uVar3);
pAVar12 = pAVar14;
}
pBVar13 = (BYTE *)(-(ulonglong)(local_50 != 0) & (ulonglong)pAVar15);
pPaddingInfo = (ALG_ID **)0x0;
if (param_2 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180085440);
}
if (local_58 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x14,&DAT_180085440,local_58);
}
BVar7 = CryptSetProvParam(param_1,1,(BYTE *)&local_58,0);
if (((BVar7 == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar8 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x15,&DAT_180085440,DVar8);
}
}
BVar7 = CryptCreateHash(param_1,local_4c,0,0,&local_70);
if (BVar7 == 0) {
DVar11 = GetLastError();
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180051e9a;
uVar9 = 0x16;
}
else if ((int)local_60 == 0) {
BVar7 = CryptSetHashParam(local_70,2,pBVar13,0);
if (BVar7 == 0) {
DVar11 = GetLastError();
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180051e9a;
uVar9 = 0x17;
}
else {
LAB_180051d94:
DVar8 = local_78[0];
BVar7 = CryptSignHashW(local_70,local_78[0],(LPCWSTR)0x0,0,(BYTE *)0x0,param_4);
if (BVar7 == 0) {
DVar11 = GetLastError();
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180051e9a;
uVar9 = 0x19;
}
else {
pBVar13 = (BYTE *)FUN_18000a1f4((ulonglong)*param_4);
*(BYTE **)(param_4 + 2) = pBVar13;
if (pBVar13 == (BYTE *)0x0) {
DVar11 = 0xe;
goto LAB_180051e9a;
}
BVar7 = CryptSignHashW(local_70,DVar8,(LPCWSTR)0x0,0,pBVar13,param_4);
if (BVar7 != 0) goto LAB_180051e65;
DVar11 = GetLastError();
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180051e9a;
uVar9 = 0x1a;
}
}
}
else {
BVar7 = CryptHashData(local_70,pBVar13,dwDataLen,0);
if (BVar7 != 0) goto LAB_180051d94;
DVar11 = GetLastError();
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180051e9a;
uVar9 = 0x18;
}
}
else {
local_78[0] = 0;
local_60 = (ALG_ID *)0x0;
local_48 = (ALG_ID *)0x0;
uStack_40 = 0;
if (_Str1 == (wchar_t *)0x0) {
return 0x54f;
}
if (pBVar13 == (BYTE *)0x0) {
return 0x54f;
}
iVar4 = wcsncmp(_Str1,L"RSA",3);
DVar8 = local_68;
if (iVar4 == 0) {
if (local_68 == 8) {
pPaddingInfo = &local_48;
uStack_40 = CONCAT44(uStack_40._4_4_,dwDataLen);
local_48 = pAVar12;
}
else {
if (local_68 != 2) {
return 0x54f;
}
pPaddingInfo = &local_60;
local_60 = pAVar12;
}
}
if (local_58 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0xf,&DAT_180085440,local_58);
}
SVar6 = NCryptSetProperty(param_1,L"HWND Handle",(PBYTE)&local_58,8,0);
if (((SVar6 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x10,&DAT_180085440,SVar6);
}
}
DVar11 = NCryptSignHash(param_1,pPaddingInfo,pBVar13,dwDataLen,(PBYTE)0x0,local_78[0],local_78,
DVar8);
if (DVar11 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return DVar11;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return DVar11;
}
FUN_180041cdc(DAT_180091000[2],0x11,&DAT_180085440,DVar11);
return DVar11;
}
pbSignature = (PBYTE)FUN_18000a1f4((ulonglong)local_78[0]);
*(PBYTE *)(param_4 + 2) = pbSignature;
if (pbSignature == (PBYTE)0x0) {
return 0xe;
}
*param_4 = local_78[0];
DVar11 = NCryptSignHash(param_1,pPaddingInfo,pBVar13,dwDataLen,pbSignature,local_78[0],local_78,
DVar8);
if (DVar11 == 0) {
LAB_180051e65:
param_4[1] = 1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1b,&DAT_180085440);
}
goto LAB_180051e9a;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180051e9a;
uVar9 = 0x12;
}
FUN_180041cdc(DAT_180091000[2],uVar9,&DAT_180085440,DVar11);
LAB_180051e9a:
if (local_70 != 0) {
CryptDestroyHash(local_70);
}
if (DVar11 != 0) {
if (*(HLOCAL *)(param_4 + 2) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_4 + 2));
param_4[2] = 0;
param_4[3] = 0;
}
*param_4 = 0;
return DVar11;
}
return 0;
}
=========================================
Function at address: 0x180051f10
Called functions addresses: 0x18000e850 0x180041cb0 0xEXTERNAL:00000125 0xEXTERNAL:00000152


undefined8 FUN_180051f10(undefined8 param_1,undefined8 param_2,int *param_3,uint *param_4)

{
uint uVar1;
PCCERT_CONTEXT pCertContext;
undefined8 *puVar2;
int iVar3;
BOOL BVar4;
undefined8 uVar5;
DWORD local_28 [2];
undefined8 local_20;

uVar5 = 0;
local_28[1] = 8;
local_20 = 0;
local_28[0] = 0;
iVar3 = FUN_18000e850(1,param_2,(undefined *)param_3,(ulonglong)param_4);
if (iVar3 == 0) {
uVar5 = 0x80090304;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1c,&DAT_180085440);
}
if (((((param_4 == (uint *)0x0) || (*(longlong *)(param_4 + 2) == 0)) || (*param_4 < 0xc)) ||
((param_3 == (int *)0x0 ||
(pCertContext = *(PCCERT_CONTEXT *)(param_3 + 2), pCertContext == (PCCERT_CONTEXT)0x0))))
|| (*param_3 != 0x28)) {
uVar5 = 0x80090304;
}
else {
BVar4 = CertGetCertificateContextProperty(pCertContext,1,&local_20,local_28 + 1);
if (BVar4 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180085440);
}
local_20 = 0;
}
puVar2 = *(undefined8 **)(param_4 + 2);
uVar1 = *param_4;
*puVar2 = local_20;
local_28[0] = uVar1 - 0xc;
BVar4 = CertSerializeCertificateStoreElement
(pCertContext,0,(BYTE *)((longlong)puVar2 + 0xc),local_28);
if (BVar4 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1e,&DAT_180085440);
}
uVar5 = 0x8009030d;
}
else {
*(DWORD *)(puVar2 + 1) = local_28[0];
*param_4 = local_28[0] + 0xc;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180085440);
}
}
return uVar5;
}
=========================================
Function at address: 0x1800520e0
Called functions addresses: 0xEXTERNAL:00000127 0x180041cdc 0x18000e850 0x180041cb0 0xEXTERNAL:00000041


undefined4 FUN_1800520e0(longlong param_1,undefined8 param_2,int *param_3,uint *param_4)

{
int *piVar1;
int iVar2;
BOOL BVar3;
DWORD DVar4;
undefined4 unaff_EBX;
HCERTSTORE hCertStore;
undefined8 local_28;
int *piStack_20;

local_28 = 0;
piStack_20 = (int *)0x0;
iVar2 = FUN_18000e850(1,param_2,(undefined *)param_3,(ulonglong)param_4);
if (iVar2 == 0) {
return unaff_EBX;
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x20,&DAT_180085440);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x21,&DAT_180085440);
}
}
if ((((param_4 != (uint *)0x0) && (piVar1 = *(int **)(param_4 + 2), piVar1 != (int *)0x0)) &&
(3 < *param_4)) &&
((param_3 != (int *)0x0 &&
(hCertStore = *(HCERTSTORE *)(param_3 + 2), hCertStore != (HCERTSTORE)0x0)))) {
if (param_1 == 0) {
if (*param_3 != 8) goto LAB_180052277;
}
else {
if ((param_1 != 1) || (*param_3 != 0x28)) goto LAB_180052277;
hCertStore = *(HCERTSTORE *)((longlong)hCertStore + 0x20);
}
piStack_20 = piVar1 + 1;
local_28 = CONCAT44(local_28._4_4_,*param_4 - 4);
BVar3 = CertSaveStore(hCertStore,1,1,2,&local_28,0);
if (((BVar3 == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar4 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x22,&DAT_180085440,DVar4);
}
*piVar1 = (int)local_28;
*param_4 = (int)local_28 + 4;
}
LAB_180052277:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x23,&DAT_180085440);
}
return unaff_EBX;
}
=========================================
Function at address: 0x1800522bc
Called functions addresses: 0xEXTERNAL:0000016f


int FUN_1800522bc(void)

{
NTSTATUS NVar1;
UCHAR local_res8 [8];
uint local_res10 [2];
uint local_res18 [2];
uint local_res20 [2];

local_res18[0] = 0;
BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,(PUCHAR)local_res18,4,2);
BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,(PUCHAR)local_res20,4,2);
local_res18[0] = local_res18[0] & 0x3fffff;
local_res20[0] = local_res20[0] & 0x3fffff;
BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,(PUCHAR)local_res10,4,2);
local_res10[0] = local_res10[0] & 0x1fff;
while( true ) {
NVar1 = BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,local_res8,1,2);
if ((NVar1 < 0) || (local_res8[0] == '\0')) break;
local_res10[0] = local_res10[0] + 0x2000;
}
return local_res10[0] + local_res20[0] + local_res18[0];
}
=========================================
Function at address: 0x180052374
Called functions addresses: 0xEXTERNAL:0000016f 0x1800522bc


void FUN_180052374(void)

{
uint uVar1;
ulonglong uVar2;
uint local_res8 [2];
UCHAR local_res10 [24];

BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,local_res10,4,2);
BCryptGenRandom((BCRYPT_ALG_HANDLE)0x0,(PUCHAR)local_res8,4,2);
local_res8[0] = local_res8[0] | 1;
uVar1 = FUN_1800522bc();
if (uVar1 >> 1 != 0) {
uVar2 = (ulonglong)(uVar1 >> 1);
do {
uVar2 = uVar2 - 1;
} while (uVar2 != 0);
}
return;
}
=========================================
Function at address: 0x1800523f4
Called functions addresses: 0xEXTERNAL:0000003f 0x180041cb0 0x180028d78


HLOCAL FUN_1800523f4(longlong param_1)

{
uint uVar1;
longlong lVar2;
HLOCAL pvVar3;

lVar2 = -1;
do {
lVar2 = lVar2 + 1;
} while (*(short *)(param_1 + lVar2 * 2) != 0);
uVar1 = (int)lVar2 * 2 + 2;
pvVar3 = LocalAlloc(0x40,(ulonglong)uVar1);
if (pvVar3 == (HLOCAL)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180085468);
}
pvVar3 = (HLOCAL)0x0;
}
else {
_o_wcscpy_s(pvVar3,uVar1 >> 1,param_1);
}
return pvVar3;
}
=========================================
Function at address: 0x1800524a0
Called functions addresses: 0x1800523f4 0x180028d90 0x18000f1fc 0x18000d31c 0xEXTERNAL:00000040 0xEXTERNAL:00000110 0x180026c20 0x180028070


void FUN_1800524a0(longlong param_1,undefined8 *param_2)

{
int iVar1;
undefined4 uVar2;
ulonglong uVar3;
HLOCAL pvVar4;
ulonglong uVar5;
undefined auStack_378 [32];
undefined *local_358;
undefined4 local_350;
undefined4 local_348;
undefined local_344 [4];
int local_340;
undefined local_2b8 [128];
undefined4 local_238;
undefined local_124 [268];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_378;
local_348 = 1;
memset(local_344,0,0x324);
*param_2 = 0;
param_2[1] = 0;
param_2[2] = 0;
param_2[3] = 0;
uVar3 = FUN_18000d31c(*(uint *)(param_1 + 0x18));
local_350 = 0;
uVar5 = (ulonglong)*(uint *)(param_1 + 0x38);
uVar3 = uVar3 & 0xffff;
local_358 = local_344;
iVar1 = SslLookupCipherSuiteInfo
(*(undefined8 *)(param_1 + 0x58),uVar3,uVar5,*(undefined4 *)(param_1 + 0x3c));
if ((iVar1 == 0) && (local_340 == *(int *)(param_1 + 0x38))) {
*(undefined4 *)(param_2 + 2) = local_238;
uVar2 = FUN_18000f1fc((longlong)&local_348,uVar3,uVar5);
*(undefined4 *)(param_2 + 3) = uVar2;
uVar2 = FUN_180026c20((longlong)&local_348,uVar3);
*(undefined4 *)((longlong)param_2 + 0x14) = uVar2;
pvVar4 = FUN_1800523f4((longlong)local_2b8);
param_2[1] = pvVar4;
pvVar4 = FUN_1800523f4((longlong)local_124);
*param_2 = pvVar4;
if ((param_2[1] != 0) && (pvVar4 != (HLOCAL)0x0)) goto LAB_1800525be;
}
if ((HLOCAL)*param_2 != (HLOCAL)0x0) {
LocalFree((HLOCAL)*param_2);
*param_2 = 0;
}
if ((HLOCAL)param_2[1] != (HLOCAL)0x0) {
LocalFree((HLOCAL)param_2[1]);
param_2[1] = 0;
}
LAB_1800525be:
FUN_180028070(local_18 ^ (ulonglong)auStack_378);
return;
}
=========================================
Function at address: 0x1800525ec
Called functions addresses: 0xEXTERNAL:0000012b 0x180041cb0 0x18000f5c0


undefined8 FUN_1800525ec(longlong param_1,FILETIME *param_2)

{
DWORD DVar1;
PCCERT_CONTEXT local_res8;

local_res8 = (PCCERT_CONTEXT)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180085468);
}
if (*(uint **)(param_1 + 0x98) == (uint *)0x0) {
param_2->dwLowDateTime = 0;
param_2->dwHighDateTime = 0;
param_2[1].dwLowDateTime = 0xd5969fff;
param_2[1].dwHighDateTime = 0x7fffff36;
}
else {
DVar1 = FUN_18000f5c0(*(uint **)(param_1 + 0x98),*(DWORD *)(param_1 + 0xa0),&local_res8);
if (DVar1 != 0) {
return 0x80090300;
}
*param_2 = local_res8->pCertInfo->NotBefore;
param_2[1] = local_res8->pCertInfo->NotAfter;
CertFreeCertificateContext(local_res8);
}
return 0;
}
=========================================
Function at address: 0x1800526a8
Called functions addresses: 0xEXTERNAL:0000003f 0xEXTERNAL:0000012b 0x180041cb0 0xEXTERNAL:00000040 0xEXTERNAL:00000136 0x18000f5c0


DWORD FUN_1800526a8(longlong param_1,undefined8 *param_2)

{
PCCERT_CONTEXT pCertContext;
DWORD DVar1;
DWORD DVar2;
LPWSTR psz;
PCCERT_CONTEXT local_res8;

DVar2 = 0;
local_res8 = (PCCERT_CONTEXT)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x10,&DAT_180085468);
}
if (*(uint **)(param_1 + 0x98) == (uint *)0x0) {
LAB_180052701:
DVar2 = 0x80090302;
}
else {
DVar1 = FUN_18000f5c0(*(uint **)(param_1 + 0x98),*(DWORD *)(param_1 + 0xa0),&local_res8);
pCertContext = local_res8;
if (DVar1 != 0) {
return DVar1;
}
DVar1 = CertNameToStrW(local_res8->dwCertEncodingType,&local_res8->pCertInfo->Subject,0x20000003
,(LPWSTR)0x0,0);
if (DVar1 < 2) {
DVar2 = 0x80090302;
}
else {
psz = (LPWSTR)LocalAlloc(0x40,(ulonglong)(DVar1 * 2));
*param_2 = psz;
if (psz == (LPWSTR)0x0) {
DVar2 = 0x80090300;
}
else {
DVar1 = CertNameToStrW(pCertContext->dwCertEncodingType,&pCertContext->pCertInfo->Subject,
0x20000003,psz,DVar1);
if (DVar1 < 2) {
CertFreeCertificateContext(pCertContext);
LocalFree((HLOCAL)*param_2);
goto LAB_180052701;
}
}
}
CertFreeCertificateContext(pCertContext);
}
return DVar2;
}
=========================================
Function at address: 0x1800527f0
Called functions addresses: 0xEXTERNAL:0000003f 0xEXTERNAL:000000a3 0x180041cb0 0x180028d78


undefined8 FUN_1800527f0(undefined8 param_1,longlong *param_2)

{
int iVar1;
HLOCAL pvVar2;
undefined8 uVar3;
uint uVar4;
uint uVar5;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x11,&DAT_180085468);
}
iVar1 = lstrlenW(L"Schannel");
uVar4 = iVar1 * 2 + 2;
iVar1 = lstrlenW(L"Schannel Security Package");
uVar5 = iVar1 * 2 + 2;
pvVar2 = LocalAlloc(0x40,(ulonglong)uVar4 + 0x20 + (ulonglong)uVar5);
*param_2 = (longlong)pvVar2;
if (pvVar2 == (HLOCAL)0x0) {
uVar3 = 0xc000009a;
}
else {
*(undefined2 *)((longlong)pvVar2 + 4) = 1;
*(undefined2 *)(*param_2 + 6) = 0xe;
*(undefined4 *)*param_2 = 0x4107b3;
*(undefined4 *)(*param_2 + 8) = 0x6000;
*(longlong *)(*param_2 + 0x10) = *param_2 + 0x20;
*(ulonglong *)(*param_2 + 0x18) = *(longlong *)(*param_2 + 0x10) + (ulonglong)uVar4;
_o_wcscpy_s(*(undefined8 *)(*param_2 + 0x10),uVar4 >> 1,L"Schannel");
_o_wcscpy_s(*(undefined8 *)(*param_2 + 0x18),uVar5 >> 1,L"Schannel Security Package");
uVar3 = 0;
}
return uVar3;
}
=========================================
Function at address: 0x180052918
Called functions addresses: 0xEXTERNAL:0000003f 0x180041cb0 0xEXTERNAL:000000a3 0x180028d78


undefined8 FUN_180052918(longlong param_1,undefined8 *param_2)

{
uint uVar1;
int iVar2;
ulonglong uVar3;
HLOCAL pvVar4;
int *piVar5;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x12,&DAT_180085468);
}
piVar5 = &DAT_18007fd60;
uVar3 = 0;
do {
if (*(int *)(param_1 + 0x18) == *piVar5) {
iVar2 = lstrlenW((LPCWSTR)(&PTR_DAT_18007fd68)[uVar3 * 3]);
uVar1 = iVar2 * 2 + 2;
pvVar4 = LocalAlloc(0x40,(ulonglong)uVar1);
*param_2 = pvVar4;
if (pvVar4 == (HLOCAL)0x0) {
return 0x80090300;
}
_o_wcscpy_s(pvVar4,uVar1 >> 1,(&PTR_DAT_18007fd68)[uVar3 * 3]);
*(undefined4 *)(param_2 + 1) = (&DAT_18007fd70)[uVar3 * 6];
*(undefined4 *)((longlong)param_2 + 0xc) = (&DAT_18007fd74)[uVar3 * 6];
return 0;
}
uVar1 = (int)uVar3 + 1;
uVar3 = (ulonglong)uVar1;
piVar5 = piVar5 + 6;
} while (uVar1 < 0xc);
return 0x80090302;
}
=========================================
Function at address: 0x180052a04
Called functions addresses: 0xEXTERNAL:0000003f 0x18000909c 0x180014db8 0xEXTERNAL:00000139 0xEXTERNAL:0000012b 0x18002a77b 0x180041cb0 0x18000f5c0


DWORD FUN_180052a04(longlong param_1,DWORD *param_2)

{
PCCERT_CONTEXT pCertContext;
DWORD DVar1;
HLOCAL _Dst;
ulonglong uVar2;
PCCERT_CONTEXT local_res8;
longlong *local_res10;

local_res8 = (PCCERT_CONTEXT)0x0;
local_res10 = (longlong *)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180085468);
}
param_2[0] = 0;
param_2[1] = 0;
param_2[2] = 0;
param_2[3] = 0;
param_2[4] = 0;
param_2[5] = 0;
param_2[6] = 0;
param_2[7] = 0;
if (*(uint **)(param_1 + 0x98) != (uint *)0x0) {
DVar1 = FUN_18000f5c0(*(uint **)(param_1 + 0x98),*(DWORD *)(param_1 + 0xa0),&local_res8);
pCertContext = local_res8;
if (DVar1 != 0) {
return DVar1;
}
if (local_res8 != (PCCERT_CONTEXT)0x0) {
_Dst = LocalAlloc(0x40,(ulonglong)local_res8->cbCertEncoded);
if (_Dst == (HLOCAL)0x0) {
CertFreeCertificateContext(pCertContext);
return 0x80090300;
}
memcpy(_Dst,pCertContext->pbCertEncoded,(ulonglong)pCertContext->cbCertEncoded);
param_2[5] = param_2[5] | 1;
*(HLOCAL *)(param_2 + 2) = _Dst;
DVar1 = pCertContext->cbCertEncoded;
param_2[6] = 0;
*param_2 = DVar1;
param_2[4] = 1;
uVar2 = FUN_180014db8((longlong)pCertContext,&local_res10,(int *)0x0);
if ((int)uVar2 == 0) {
if (local_res10 == (longlong *)0x0) {
DVar1 = CertGetPublicKeyLength(1,&pCertContext->pCertInfo->SubjectPublicKeyInfo);
param_2[6] = DVar1;
}
else {
if (*local_res10 != -8) {
param_2[6] = *(DWORD *)(*local_res10 + 0xc);
}
FUN_18000909c(local_res10);
}
}
CertFreeCertificateContext(pCertContext);
}
}
return 0;
}
=========================================
Function at address: 0x180052b68
Called functions addresses: 0x180012af0 0x180028070 0x1800293fb 0x180012dc8 0x180027af0


void FUN_180052b68(undefined8 param_1,byte *param_2,undefined8 param_3,undefined8 param_4,
undefined8 param_5,undefined8 *param_6)

{
longlong lVar1;
undefined8 uVar2;
undefined auStackY_b8 [32];
EVENT_DESCRIPTOR local_88;
undefined4 local_78;
_EVENT_DATA_DESCRIPTOR local_68;
ushort *local_58;
uint local_50;
undefined4 local_4c;
undefined8 local_48;
undefined8 local_40;
undefined8 local_38;
undefined8 local_30;
undefined *local_28;
int local_20;
undefined4 local_1c;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_b8;
local_28 = (undefined *)*param_6;
if (local_28 == (undefined *)0x0) {
local_28 = &DAT_18008233c;
local_20 = 2;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (*(short *)(local_28 + lVar1 * 2) != 0);
local_20 = (int)lVar1 * 2 + 2;
}
local_38 = param_5;
local_88._0_4_ = (uint)*param_2 << 0x18;
local_88._4_4_ = ZEXT24(*(ushort *)(param_2 + 1));
local_88.Keyword = *(ULONGLONG *)(param_2 + 3);
local_58 = (ushort *)(param_2 + 0xb);
local_68.Ptr = (ULONGLONG)PTR_DAT_180091488;
local_1c = 0;
local_30 = 4;
local_40 = 4;
local_68.Size = (ULONG)*(ushort *)PTR_DAT_180091488;
local_50 = (uint)*local_58;
local_68.Reserved = 2;
local_4c = 1;
local_78 = 0xbe9;
local_48 = param_4;
if (DAT_1800914a8 == FUN_180027af0) {
uVar2 = FUN_180012dc8(FUN_180027af0,(longlong)&local_68);
if ((byte)uVar2 == 0) {
EventWriteTransfer(DAT_1800914a0,&local_88,(LPCGUID)0x0,(LPCGUID)0x0,5,&local_68);
}
else {
FUN_180012af0(0x180091480,(undefined8 *)&local_88,5,(longlong)&local_68,(byte)uVar2);
}
}
FUN_180028070(local_18 ^ (ulonglong)auStackY_b8);
return;
}
=========================================
Function at address: 0x180052cc4
Called functions addresses: 0x180012af0 0x180028070 0x1800293fb 0x180012dc8 0x180027af0


void FUN_180052cc4(undefined8 param_1,byte *param_2,undefined8 param_3,undefined8 param_4,
undefined8 *param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
undefined8 param_9,undefined8 param_10,undefined8 param_11,undefined8 param_12,
undefined8 *param_13,undefined8 param_14,undefined8 param_15,undefined8 param_16,
undefined8 param_17,undefined8 param_18,undefined8 param_19,undefined8 param_20,
undefined8 param_21,undefined8 param_22,undefined8 param_23,undefined8 param_24,
undefined8 *param_25,undefined8 param_26)

{
longlong lVar1;
undefined8 uVar2;
undefined auStackY_218 [32];
EVENT_DESCRIPTOR local_1e8;
undefined4 local_1d8;
_EVENT_DATA_DESCRIPTOR local_1c8;
ushort *local_1b8;
uint local_1b0;
undefined4 local_1ac;
undefined8 local_1a8;
undefined8 local_1a0;
undefined *local_198;
int local_190;
undefined4 local_18c;
undefined8 local_188;
undefined8 local_180;
undefined8 local_178;
undefined8 local_170;
undefined8 local_168;
undefined8 local_160;
undefined8 local_158;
undefined8 local_150;
undefined8 local_148;
undefined8 local_140;
undefined8 local_138;
undefined8 local_130;
undefined8 local_128;
undefined8 local_120;
ushort *local_118;
undefined8 local_110;
undefined8 local_108;
int local_100;
undefined4 local_fc;
undefined8 local_f8;
undefined8 local_f0;
undefined8 local_e8;
undefined8 local_e0;
undefined8 local_d8;
undefined8 local_d0;
undefined8 local_c8;
undefined8 local_c0;
undefined8 local_b8;
undefined8 local_b0;
undefined8 local_a8;
undefined8 local_a0;
undefined8 local_98;
undefined8 local_90;
undefined8 local_88;
undefined8 local_80;
undefined8 local_78;
undefined8 local_70;
undefined8 local_68;
undefined8 local_60;
undefined8 local_58;
undefined8 local_50;
ushort *local_48;
undefined8 local_40;
undefined8 local_38;
int local_30;
undefined4 local_2c;
undefined8 local_28;
undefined8 local_20;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_218;
local_28 = param_26;
local_20 = 4;
local_190 = 2;
local_2c = 0;
local_40 = 2;
local_48 = (ushort *)(param_25 + 1);
local_50 = 4;
local_38 = *param_25;
local_30 = (uint)*local_48 << 2;
local_58 = param_24;
local_68 = param_23;
local_78 = param_22;
local_88 = param_21;
local_98 = param_20;
local_a8 = param_19;
local_b8 = param_18;
local_c8 = param_17;
local_d8 = param_16;
local_e8 = param_15;
local_f8 = param_14;
local_60 = 4;
local_70 = 1;
local_118 = (ushort *)(param_13 + 1);
local_80 = 4;
local_108 = *param_13;
local_100 = (uint)*local_118 << 2;
local_128 = param_12;
local_138 = param_11;
local_148 = param_10;
local_158 = param_9;
local_168 = param_8;
local_178 = param_7;
local_188 = param_6;
local_90 = 4;
local_a0 = 4;
local_b0 = 4;
local_c0 = 4;
local_d0 = 4;
local_e0 = 4;
local_f0 = 2;
local_110 = 2;
local_fc = 0;
local_120 = 4;
local_130 = 4;
local_140 = 2;
local_150 = 2;
local_160 = 8;
local_170 = 8;
local_180 = 1;
local_198 = (undefined *)*param_5;
if (local_198 == (undefined *)0x0) {
local_198 = &DAT_18008233c;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (*(short *)(local_198 + lVar1 * 2) != 0);
local_190 = (int)lVar1 * 2 + 2;
}
local_1e8._0_4_ = (uint)*param_2 << 0x18;
local_1e8._4_4_ = ZEXT24(*(ushort *)(param_2 + 1));
local_18c = 0;
local_1e8.Keyword = *(ULONGLONG *)(param_2 + 3);
local_1b8 = (ushort *)(param_2 + 0xb);
local_1c8.Ptr = (ULONGLONG)PTR_DAT_180091488;
local_1a0 = 8;
local_1c8.Size = (ULONG)*(ushort *)PTR_DAT_180091488;
local_1b0 = (uint)*local_1b8;
local_1c8.Reserved = 2;
local_1ac = 1;
local_1d8 = 0xbe9;
local_1a8 = param_4;
if (DAT_1800914a8 == FUN_180027af0) {
uVar2 = FUN_180012dc8(FUN_180027af0,(longlong)&local_1c8);
if ((byte)uVar2 == 0) {
EventWriteTransfer(DAT_1800914a0,&local_1e8,(LPCGUID)0x0,(LPCGUID)0x0,0x1b,&local_1c8);
}
else {
FUN_180012af0(0x180091480,(undefined8 *)&local_1e8,0x1b,(longlong)&local_1c8,(byte)uVar2);
}
}
FUN_180028070(local_18 ^ (ulonglong)auStackY_218);
return;
}
=========================================
Function at address: 0x180053000
Called functions addresses: 0x180052b68


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180053000(undefined8 param_1,undefined4 param_2,undefined8 param_3)

{
undefined4 local_res20 [2];
undefined4 local_18 [2];
undefined8 local_10 [2];

local_18[0] = (undefined4)param_1;
if ((((DAT_1800927ac != '\0') && (5 < DAT_180091480)) && ((_DAT_180091490 & 0x400000000000) != 0))
&& ((DAT_180091498 & 0x400000000000) == DAT_180091498)) {
local_res20[0] = param_2;
local_10[0] = param_3;
FUN_180052b68(param_1,&DAT_180084988,param_3,local_18,local_res20,local_10);
}
return;
}
=========================================
Function at address: 0x180053078
Called functions addresses: 0x180028070 0x1800533ac


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180053078(undefined2 param_1)

{
undefined auStackY_78 [32];
undefined2 local_48 [4];
_EVENT_DATA_DESCRIPTOR local_40 [2];
undefined2 *local_20;
undefined4 local_18;
undefined4 local_14;
ulonglong local_10;

local_10 = DAT_180091970 ^ (ulonglong)auStackY_78;
if ((((DAT_1800927ac != '\0') && (5 < DAT_180091480)) && ((_DAT_180091490 & 0x400000000000) != 0))
&& ((DAT_180091498 & 0x400000000000) == DAT_180091498)) {
local_20 = local_48;
local_14 = 0;
local_18 = 2;
local_48[0] = param_1;
_tlgWriteTransfer_EtwWriteTransfer
(0x180091480,&DAT_18008495b,(LPCGUID)0x0,(LPCGUID)0x0,3,local_40);
}
FUN_180028070(local_10 ^ (ulonglong)auStackY_78);
return;
}
=========================================
Function at address: 0x180053124
Called functions addresses: 0xEXTERNAL:00000083


void FUN_180053124(longlong param_1,undefined4 param_2,undefined8 param_3)

{
if ((param_1 != 0) && (DAT_1800927ac != '\0')) {
*(undefined *)(param_1 + 0x10) = 1;
*(undefined4 *)(param_1 + 0xc) = param_2;
QueryPerformanceCounter((LARGE_INTEGER *)(param_1 + 0x50));
*(undefined4 *)(param_1 + 0x18) = 2;
*(undefined8 *)(param_1 + 0x78) = param_3;
*(bool *)(param_1 + 0x1c) = *(int *)(param_1 + 0xc) == 1;
}
return;
}
=========================================
Function at address: 0x180053180
Called functions addresses: 0xEXTERNAL:00000090


void FUN_180053180(undefined8 param_1,undefined8 param_2,undefined8 param_3,wchar_t *param_4,
wchar_t *param_5,wchar_t *param_6)

{
longlong lVar1;
longlong lVar2;
longlong lVar3;

lVar1 = -1;
if (param_6 == (wchar_t *)0x0) {
lVar2 = 10;
}
else {
lVar2 = -1;
do {
lVar2 = lVar2 + 1;
} while (param_6[lVar2] != L'\0');
lVar2 = lVar2 * 2 + 2;
}
if (param_6 == (wchar_t *)0x0) {
param_6 = L"NULL";
}
if (param_5 == (wchar_t *)0x0) {
lVar3 = 10;
}
else {
lVar3 = -1;
do {
lVar3 = lVar3 + 1;
} while (param_5[lVar3] != L'\0');
lVar3 = lVar3 * 2 + 2;
}
if (param_5 == (wchar_t *)0x0) {
param_5 = L"NULL";
}
if (param_4 == (wchar_t *)0x0) {
lVar1 = 10;
}
else {
do {
lVar1 = lVar1 + 1;
} while (param_4[lVar1] != L'\0');
lVar1 = lVar1 * 2 + 2;
}
if (param_4 == (wchar_t *)0x0) {
param_4 = L"NULL";
}
TraceMessage(param_1,0x2b,&DAT_180082b28,10,param_4,lVar1,param_5,lVar3,param_6,lVar2,
&stack0x00000038,4,&stack0x00000040,8,&stack0x00000048,8,&stack0x00000050,4,
&stack0x00000058,4,&stack0x00000060,4,&stack0x00000068,4,&stack0x00000070,4,
&stack0x00000078,4,&stack0x00000080,4,&stack0x00000088,8,&stack0x00000090,4,
&stack0x00000098,4,&stack0x000000a0,4,0);
return;
}
=========================================
Function at address: 0x1800533ac
Called functions addresses: 0xEXTERNAL:00000094


/* Library Function - Single Match
_tlgWriteTransfer_EtwWriteTransfer

Library: Visual Studio 2019 Release */

void _tlgWriteTransfer_EtwWriteTransfer
(longlong param_1,byte *param_2,LPCGUID param_3,LPCGUID param_4,ULONG param_5,
PEVENT_DATA_DESCRIPTOR param_6)

{
EVENT_DESCRIPTOR local_18;

local_18._0_4_ = (uint)*param_2 << 0x18;
local_18._4_4_ = ZEXT24(*(ushort *)(param_2 + 1));
local_18.Keyword = *(ULONGLONG *)(param_2 + 3);
param_6->Ptr = *(ULONGLONG *)(param_1 + 8);
param_6->Size = (uint)**(ushort **)(param_1 + 8);
param_6->Reserved = 2;
param_6[1].Ptr = (ULONGLONG)(param_2 + 0xb);
param_6[1].Size = (uint)*(ushort *)(param_2 + 0xb);
param_6[1].Reserved = 1;
EventWriteTransfer(*(REGHANDLE *)(param_1 + 0x20),&local_18,param_3,param_4,param_5,param_6);
return;
}
=========================================
Function at address: 0x180053448
Called functions addresses: 0x18002a7c0 0xEXTERNAL:0000007a


undefined8 FUN_180053448(DWORD *param_1)

{
char cVar1;
DWORD local_28 [8];

if (DAT_180092620 == 0) {
local_28[0] = GetCurrentProcessId();
}
else {

if (cVar1 == '\0') {
*param_1 = 0xffffffff;
return 0;
}
}
*param_1 = local_28[0];
return 1;
}
=========================================
Function at address: 0x1800534ac
Called functions addresses: 0xEXTERNAL:00000088


int FUN_1800534ac(uint param_1)

{
DWORD DVar1;
int iVar2;

DVar1 = GetTickCount();
iVar2 = DVar1 - param_1;
if (DVar1 < param_1) {
iVar2 = iVar2 + -1;
}
return iVar2;
}
=========================================
Function at address: 0x1800534dc
Called functions addresses: 0xEXTERNAL:00000048 0xEXTERNAL:0000004a 0x18002a77b 0x180028070


void FUN_1800534dc(HANDLE param_1,void *param_2)

{
BOOL BVar1;
undefined auStackY_b8 [32];
DWORD local_88 [4];
PSID local_78 [12];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_b8;
if (((param_1 != (HANDLE)0x0) &&
(BVar1 = GetTokenInformation(param_1,TokenUser,local_78,0x54,local_88), BVar1 != 0)) &&
(local_88[0] = GetLengthSid(local_78[0]), local_88[0] < 0x45)) {
memcpy(param_2,local_78[0],(ulonglong)local_88[0]);
}
FUN_180028070(local_18 ^ (ulonglong)auStackY_b8);
return;
}
=========================================
Function at address: 0x180053588
Called functions addresses: 0xEXTERNAL:00000045 0xEXTERNAL:00000079 0x180041cb0 0xEXTERNAL:0000007e 0x1800534dc 0xEXTERNAL:00000062 0x180028070 0xEXTERNAL:00000046 0xEXTERNAL:00000041


void FUN_180053588(undefined *param_1)

{
BOOL BVar1;
int iVar2;
HANDLE ThreadHandle;
undefined2 uVar3;
undefined auStack_e8 [32];
DWORD local_c8 [2];
HANDLE local_c0;
undefined local_b8 [80];
undefined local_68 [80];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_e8;
local_c0 = (HANDLE)0x0;
*param_1 = 0;
local_c8[0] = 0x44;
ThreadHandle = GetCurrentThread();
BVar1 = OpenThreadToken(ThreadHandle,8,1,&local_c0);
if (BVar1 != 0) {
iVar2 = FUN_1800534dc(local_c0,local_68);
if (iVar2 != 0) {
BVar1 = CreateWellKnownSid(WinLocalSystemSid,(PSID)0x0,local_b8,local_c8);
if (BVar1 != 0) {
BVar1 = EqualSid(local_b8,local_68);
if (BVar1 == 0) {
local_c8[0] = 0x44;
BVar1 = CreateWellKnownSid(WinNetworkServiceSid,(PSID)0x0,local_b8,local_c8);
if (BVar1 == 0) goto LAB_1800535ea;
BVar1 = EqualSid(local_b8,local_68);
if (BVar1 == 0) goto LAB_1800536d4;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar3 = 0xb;
goto LAB_1800536c1;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar3 = 10;
LAB_1800536c1:
FUN_180041cb0(DAT_180091000[2],uVar3,&DAT_1800854b0);
}
*param_1 = 1;
goto LAB_1800536d4;
}
}
}
LAB_1800535ea:
GetLastError();
LAB_1800536d4:
if (local_c0 != (HANDLE)0x0) {
CloseHandle(local_c0);
}
FUN_180028070(local_18 ^ (ulonglong)auStack_e8);
return;
}
=========================================
Function at address: 0x180053714
Called functions addresses: None


void FUN_180053714(undefined *param_1,undefined *param_2,ulonglong param_3)

{
undefined uVar1;
undefined *puVar2;

for (puVar2 = param_1 + ((param_3 & 0xffffffff) - 1); param_1 <= puVar2; puVar2 = puVar2 + -1) {
uVar1 = *param_2;
param_2 = param_2 + 1;
*puVar2 = uVar1;
}
return;
}
=========================================
Function at address: 0x180053738
Called functions addresses: 0x18000909c 0x18000a1f4 0x18002a757 0xEXTERNAL:00000149 0xEXTERNAL:00000041


BOOL FUN_180053738(PCCERT_CONTEXT param_1)

{
LPSTR *ppCVar1;
BOOL BVar2;
int iVar3;
PCERT_ENHKEY_USAGE pUsage;
uint uVar4;
ulonglong uVar5;
DWORD local_res10 [2];

local_res10[0] = 0;
BVar2 = CertGetEnhancedKeyUsage(param_1,2,(PCERT_ENHKEY_USAGE)0x0,local_res10);
if (BVar2 == 0) {
GetLastError();
}
else {
pUsage = (PCERT_ENHKEY_USAGE)FUN_18000a1f4((ulonglong)local_res10[0]);
if (pUsage != (PCERT_ENHKEY_USAGE)0x0) {
BVar2 = CertGetEnhancedKeyUsage(param_1,2,pUsage,local_res10);
if (BVar2 == 0) {
GetLastError();
BVar2 = 0;
}
else {
uVar5 = 0;
if (pUsage->cUsageIdentifier != 0) {
ppCVar1 = pUsage->rgpszUsageIdentifier;
BVar2 = 1;
do {
iVar3 = strcmp(ppCVar1[uVar5],"1.3.6.1.5.5.7.3.1");
if (iVar3 == 0) goto LAB_1800537e9;
uVar4 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar4;
} while (uVar4 < pUsage->cUsageIdentifier);
}
BVar2 = 0;
}
LAB_1800537e9:
FUN_18000909c(pUsage);
}
}
return BVar2;
}
=========================================
Function at address: 0x180053810
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000012b 0x180041cb0 0xEXTERNAL:0000012e 0xEXTERNAL:00000152 0x180028070 0xEXTERNAL:00000041 0xEXTERNAL:0000013a


void FUN_180053810(HCERTSTORE param_1,PCCERT_CONTEXT param_2,char param_3,undefined8 *param_4)

{
bool bVar1;
BOOL BVar2;
DWORD DVar3;
PCCERT_CONTEXT pCertContext;
PCCERT_CONTEXT pCVar4;
undefined2 uVar5;
uint uVar6;
undefined auStackY_a8 [32];
DWORD local_78 [2];
DWORD local_70 [2];
undefined *local_68;
undefined8 *local_60;
undefined local_58 [24];
ulonglong local_40;

local_40 = DAT_180091970 ^ (ulonglong)auStackY_a8;
bVar1 = false;
uVar6 = 0;
local_78[0] = 0x14;
local_60 = param_4;
if (param_3 == '\0') {
pCertContext = CertDuplicateCertificateContext(param_2);
LAB_180053942:
do {
local_78[0] = 0x14;
BVar2 = CertGetCertificateContextProperty(pCertContext,0x40,local_58,local_78);
if (BVar2 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1b,&DAT_1800854d0);
}
LAB_180053a8c:
pCVar4 = pCertContext;
if (!bVar1) {
CertFreeCertificateContext(pCertContext);
goto LAB_180053aac;
}
break;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1c,&DAT_1800854d0);
}
local_70[0] = local_78[0];
local_68 = local_58;
pCVar4 = CertFindCertificateInStore(param_1,1,0,0x10000,local_70,(PCCERT_CONTEXT)0x0);
if (pCVar4 == (PCCERT_CONTEXT)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar3 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x1d,&DAT_1800854d0,DVar3);
}
goto LAB_180053a8c;
}
CertFreeCertificateContext(pCertContext);
uVar6 = uVar6 + 1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1e,&DAT_1800854d0);
}
bVar1 = true;
pCertContext = pCVar4;
} while (uVar6 < 0x53a);
*local_60 = pCVar4;
}
else {
BVar2 = CertGetCertificateContextProperty(param_2,3,local_58,local_78);
if (BVar2 == 0) {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180053aac;
DVar3 = GetLastError();
uVar5 = 0x19;
}
else {
local_70[0] = local_78[0];
local_68 = local_58;
pCertContext = CertFindCertificateInStore(param_1,1,0,0x10000,local_70,(PCCERT_CONTEXT)0x0);
if (pCertContext != (PCCERT_CONTEXT)0x0) goto LAB_180053942;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180053aac;
DVar3 = GetLastError();
uVar5 = 0x1a;
}
FUN_180041cdc(DAT_180091000[2],uVar5,&DAT_1800854d0,DVar3);
}
LAB_180053aac:
FUN_180028070(local_40 ^ (ulonglong)auStackY_a8);
return;
}
=========================================
Function at address: 0x180053ad0
Called functions addresses: 0x18000909c 0x18000a1f4 0x180053e4c


ulonglong FUN_180053ad0(HCERTSTORE param_1,undefined8 *param_2,uint *param_3)

{
ulonglong uVar1;
undefined *puVar2;
ulonglong uVar3;
char local_res8 [8];

local_res8[0] = '\0';
if (param_1 == (HCERTSTORE)0x0) {
uVar1 = 0x57;
}
else {
uVar1 = FUN_180053e4c(param_1,(undefined *)0x0,param_3,local_res8);
if ((int)uVar1 == 0) {
puVar2 = (undefined *)FUN_18000a1f4((ulonglong)*param_3);
*param_2 = puVar2;
if (puVar2 == (undefined *)0x0) {
uVar1 = 0xe;
}
else {
uVar3 = FUN_180053e4c(param_1,puVar2,param_3,local_res8);
uVar1 = uVar3 & 0xffffffff;
if ((int)uVar3 == 0) {
uVar1 = 0;
}
else {
FUN_18000909c((HLOCAL)*param_2);
*param_2 = 0;
}
}
}
}
return uVar1;
}
=========================================
Function at address: 0x180053b60
Called functions addresses: 0x18000909c 0x180028d90 0x18000a1f4 0x18002a77b 0x180041cb0 0xEXTERNAL:0000014e 0xEXTERNAL:00000041


DWORD FUN_180053b60(longlong param_1,undefined4 *param_2,uint *param_3)

{
uint uVar1;
uint uVar2;
BOOL BVar3;
DWORD DVar4;
uint uVar5;
uint *pvStructInfo;
uint uVar6;
void *pvVar7;
undefined4 *_Dst;
uint *pvStructInfo_00;
DWORD local_res8 [2];
DWORD local_res20 [2];

DVar4 = 0;
local_res8[0] = 0;
BVar3 = CryptDecodeObject(1,(LPCSTR)0x26,*(BYTE **)(param_1 + 0x20),*(DWORD *)(param_1 + 0x18),0,
(void *)0x0,local_res8);
if ((BVar3 == 0) ||
(BVar3 = CryptDecodeObject(1,(LPCSTR)0x27,*(BYTE **)(param_1 + 0x10),*(DWORD *)(param_1 + 8),0,
(void *)0x0,local_res20), BVar3 == 0)) {
DVar4 = GetLastError();
}
else {
uVar6 = local_res20[0] + local_res8[0] + 0x28;
if (param_2 != (undefined4 *)0x0) {
if (uVar6 <= *param_3) {
pvStructInfo = (uint *)FUN_18000a1f4((ulonglong)(local_res20[0] + local_res8[0]));
if (pvStructInfo == (uint *)0x0) {
return 0x80090300;
}
pvStructInfo_00 = (uint *)((ulonglong)local_res8[0] + (longlong)pvStructInfo);
BVar3 = CryptDecodeObject(1,(LPCSTR)0x26,*(BYTE **)(param_1 + 0x20),
*(DWORD *)(param_1 + 0x18),0,pvStructInfo,local_res8);
if ((BVar3 == 0) ||
(BVar3 = CryptDecodeObject(1,(LPCSTR)0x27,*(BYTE **)(param_1 + 0x10),
*(DWORD *)(param_1 + 8),0,pvStructInfo_00,local_res20),
BVar3 == 0)) {
DVar4 = GetLastError();
}
else {
uVar5 = *pvStructInfo_00;
if ((((uVar5 < 0x100001) && (pvStructInfo_00[4] < 0x100001)) &&
(pvStructInfo_00[8] < 0x100001)) && (*pvStructInfo < 0x100001)) {
uVar1 = uVar5;
if (uVar5 <= *pvStructInfo) {
uVar1 = *pvStructInfo;
}
uVar2 = uVar5;
if (uVar5 <= pvStructInfo_00[8]) {
uVar2 = pvStructInfo_00[8];
}
uVar5 = uVar5 + 0x28 + uVar2 + uVar1 + pvStructInfo_00[4];
if (uVar6 < uVar5) {
*param_3 = uVar5;
return 0x80090321;
}
*param_2 = 0x206;
param_2[1] = 0x2200;
param_2[2] = 0x31535344;
param_2[3] = *pvStructInfo_00 << 3;
memcpy(param_2 + 4,*(void **)(pvStructInfo_00 + 2),(ulonglong)*pvStructInfo_00);
pvVar7 = (void *)((longlong)(param_2 + 4) + (ulonglong)*pvStructInfo_00);
memcpy(pvVar7,*(void **)(pvStructInfo_00 + 6),(ulonglong)pvStructInfo_00[4]);
pvVar7 = (void *)((longlong)pvVar7 + (ulonglong)pvStructInfo_00[4]);
memcpy(pvVar7,*(void **)(pvStructInfo_00 + 10),(ulonglong)pvStructInfo_00[8]);
uVar6 = pvStructInfo_00[8];
pvVar7 = (void *)((longlong)pvVar7 + (ulonglong)uVar6);
if (uVar6 < *pvStructInfo_00) {
uVar6 = *pvStructInfo_00 - uVar6;
memset(pvVar7,0,(ulonglong)uVar6);
pvVar7 = (void *)((longlong)pvVar7 + (ulonglong)uVar6);
}
memcpy(pvVar7,*(void **)(pvStructInfo + 2),(ulonglong)*pvStructInfo);
uVar6 = *pvStructInfo;
_Dst = (undefined4 *)((longlong)pvVar7 + (ulonglong)uVar6);
if (uVar6 < *pvStructInfo_00) {
uVar6 = *pvStructInfo_00 - uVar6;
memset(_Dst,0,(ulonglong)uVar6);
_Dst = (undefined4 *)((longlong)_Dst + (ulonglong)uVar6);
}
*_Dst = 0xffffffff;
*(undefined8 *)(_Dst + 1) = 0;
*(undefined8 *)(_Dst + 3) = 0;
_Dst[5] = 0;
*param_3 = ((int)_Dst - (int)param_2) + 0x18;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_1800854d0);
}
DVar4 = 0x80090308;
}
}
FUN_18000909c(pvStructInfo);
return DVar4;
}
DVar4 = 0x80090321;
}
*param_3 = uVar6;
}
return DVar4;
}
=========================================
Function at address: 0x180053e4c
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000012b 0x18005425c 0x18002a77b 0x180041cb0 0x1800544b4 0xEXTERNAL:00000152 0xEXTERNAL:0000012c 0xEXTERNAL:00000041


undefined8 FUN_180053e4c(HCERTSTORE param_1,undefined *param_2,uint *param_3,char *param_4)

{
uint uVar1;
PCERT_INFO p_Var2;
ulonglong uVar3;
bool bVar4;
bool bVar5;
uint uVar6;
int iVar7;
BOOL BVar8;
DWORD DVar9;
PCCERT_CONTEXT pCertContext;
undefined8 uVar10;
uint uVar11;
undefined *puVar12;
int local_118;
DWORD local_114;
undefined4 local_110 [2];
undefined8 local_108;
undefined8 uStack_100;
BYTE *local_f8;
LPSTR pCStack_f0;
undefined8 local_e8;
BYTE *pBStack_e0;
undefined8 local_d8;
BYTE *pBStack_d0;
FILETIME local_c8;
FILETIME FStack_c0;
ulonglong local_b8;
BYTE *pBStack_b0;
LPSTR local_a8;
undefined8 uStack_a0;
BYTE *local_98;
undefined8 uStack_90;
BYTE *local_88;
undefined8 uStack_80;
undefined8 local_78;
BYTE *pBStack_70;
undefined8 local_68;
undefined8 uStack_60;
BYTE *local_58;
undefined8 uStack_50;
undefined8 local_48;
PCERT_EXTENSION p_Stack_40;

uVar1 = *param_3;
uVar11 = 0;
*param_3 = 0;
bVar4 = false;
bVar5 = false;
pCertContext = CertEnumCertificatesInStore(param_1,(PCCERT_CONTEXT)0x0);
puVar12 = param_2;
do {
if ((pCertContext == (PCCERT_CONTEXT)0x0) ||
(p_Var2 = pCertContext->pCertInfo, p_Var2 == (PCERT_INFO)0x0)) {
if ((param_4 != (char *)0x0) && ((bVar4 && (bVar5)))) {
*param_4 = '\x01';
}
*param_3 = uVar11;
return 0;
}
local_108 = *(undefined8 *)p_Var2;
uStack_100 = *(undefined8 *)&p_Var2->SerialNumber;
local_f8 = (p_Var2->SerialNumber).pbData;
pCStack_f0 = (p_Var2->SignatureAlgorithm).pszObjId;
local_e8 = *(undefined8 *)&(p_Var2->SignatureAlgorithm).Parameters;
pBStack_e0 = (p_Var2->SignatureAlgorithm).Parameters.pbData;
local_d8 = *(undefined8 *)&p_Var2->Issuer;
pBStack_d0 = (p_Var2->Issuer).pbData;
local_c8 = p_Var2->NotBefore;
FStack_c0 = p_Var2->NotAfter;
uVar3 = *(ulonglong *)&p_Var2->Subject;
pBStack_b0 = (p_Var2->Subject).pbData;
local_a8 = (p_Var2->SubjectPublicKeyInfo).Algorithm.pszObjId;
uStack_a0 = *(undefined8 *)&(p_Var2->SubjectPublicKeyInfo).Algorithm.Parameters;
local_98 = (p_Var2->SubjectPublicKeyInfo).Algorithm.Parameters.pbData;
uStack_90 = *(undefined8 *)&(p_Var2->SubjectPublicKeyInfo).PublicKey;
local_88 = (p_Var2->SubjectPublicKeyInfo).PublicKey.pbData;
uStack_80 = *(undefined8 *)&(p_Var2->SubjectPublicKeyInfo).PublicKey.cUnusedBits;
local_78 = *(undefined8 *)&p_Var2->IssuerUniqueId;
pBStack_70 = (p_Var2->IssuerUniqueId).pbData;
local_68 = *(undefined8 *)&(p_Var2->IssuerUniqueId).cUnusedBits;
uStack_60 = *(undefined8 *)&p_Var2->SubjectUniqueId;
local_58 = (p_Var2->SubjectUniqueId).pbData;
uStack_50 = *(undefined8 *)&(p_Var2->SubjectUniqueId).cUnusedBits;
local_48 = *(undefined8 *)&p_Var2->cExtension;
p_Stack_40 = p_Var2->rgExtension;
local_b8._0_4_ = (uint)uVar3;
uVar6 = (uint)local_b8;
local_b8 = uVar3;
if ((uint)local_b8 < 0x10000) {
iVar7 = FUN_1800544b4(pCertContext,&DAT_180091000,0,&local_118);
if ((iVar7 == 0) && (local_118 != 0)) {
uVar10 = FUN_18005425c((longlong)pCertContext);
if ((int)uVar10 == 0) {
bVar5 = true;
}
else {
bVar4 = true;
}
if ((((param_2 != (undefined *)0x0) && ((int)uVar10 != 0)) && (param_4 != (char *)0x0)) &&
(*param_4 != '\0')) {
local_110[0] = 0;
local_114 = 4;
BVar8 = CertGetCertificateContextProperty(pCertContext,0x66,local_110,&local_114);
if (BVar8 == 0) {
DVar9 = GetLastError();
if (((DVar9 != 0x490) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xc,&DAT_1800854d0,DVar9);
}
goto LAB_180054099;
}
}
uVar11 = uVar11 + 2 + uVar6;
if (param_2 != (undefined *)0x0) {
if (((uVar1 < uVar11) || (uVar1 < 2)) || (uVar1 < uVar6)) {
CertFreeCertificateContext(pCertContext);
return 0x54f;
}
*puVar12 = (char)(uVar3 >> 8);
puVar12[1] = (char)uVar3;
memcpy(puVar12 + 2,pBStack_b0,uVar3 & 0xffffffff);
puVar12 = puVar12 + 2 + (uVar3 & 0xffffffff);
}
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_1800854d0);
}
LAB_180054099:
pCertContext = CertEnumCertificatesInStore(param_1,pCertContext);
} while( true );
}
=========================================
Function at address: 0x180054118
Called functions addresses: 0x180041cb0 0xEXTERNAL:0000012e 0xEXTERNAL:0000013a 0x180053738


undefined8 FUN_180054118(HCERTSTORE param_1,longlong param_2,int *param_3)

{
BOOL BVar1;
PCCERT_CONTEXT pCVar2;
ulonglong uVar3;
PCCERT_CONTEXT pPrevCertContext;

uVar3 = 0;
pPrevCertContext = (PCCERT_CONTEXT)0x0;
while( true ) {
pPrevCertContext = CertFindCertificateInStore(param_1,1,0,0x150000,(void *)0x0,pPrevCertContext)
;
if (pPrevCertContext == (PCCERT_CONTEXT)0x0) break;
BVar1 = FUN_180053738(pPrevCertContext);
if (BVar1 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_1800854d0);
}
}
else {
if (param_2 != 0) {
pCVar2 = CertDuplicateCertificateContext(pPrevCertContext);
*(PCCERT_CONTEXT *)(uVar3 * 0x38 + param_2) = pCVar2;
}
uVar3 = (ulonglong)((int)uVar3 + 1);
}
}
if (param_3 != (int *)0x0) {
*param_3 = (int)uVar3;
}
return 0;
}
=========================================
Function at address: 0x180054200
Called functions addresses: 0x180014fd4


undefined8 FUN_180054200(longlong param_1,int *param_2)

{
char *pcVar1;
int iVar2;
undefined8 *puVar3;
undefined8 uVar4;

if ((param_1 == 0) || (param_2 == (int *)0x0)) {
uVar4 = 0x8009035d;
}
else if (((*(longlong *)(param_1 + 0x18) == 0) ||
(puVar3 = (undefined8 *)(*(longlong *)(param_1 + 0x18) + 0x60),
puVar3 == (undefined8 *)0x0)) || (pcVar1 = (char *)*puVar3, pcVar1 == (char *)0x0)) {
uVar4 = 0x80090304;
}
else {
iVar2 = FUN_180014fd4(pcVar1);
if (iVar2 == 0) {
uVar4 = 0x8009030d;
}
else {
*param_2 = iVar2;
uVar4 = 0;
}
}
return uVar4;
}
=========================================
Function at address: 0x18005425c
Called functions addresses: 0x18002a76f


undefined8 FUN_18005425c(longlong param_1)

{
longlong lVar1;
int iVar2;

lVar1 = *(longlong *)(param_1 + 0x18);
if ((*(uint *)(lVar1 + 0x50) == *(uint *)(lVar1 + 0x30)) &&
(iVar2 = memcmp(*(void **)(lVar1 + 0x58),*(void **)(lVar1 + 0x38),
(ulonglong)*(uint *)(lVar1 + 0x30)), iVar2 == 0)) {
return 1;
}
return 0;
}
=========================================
Function at address: 0x180054298
Called functions addresses: 0x180041cdc 0x18000909c 0x180054f60 0x18000a1f4 0xEXTERNAL:00000129 0x180028070 0xEXTERNAL:00000150 0x180041d20 0xEXTERNAL:00000041 0x180054118


void FUN_180054298(undefined8 param_1,longlong param_2,undefined8 param_3,undefined8 param_4)

{
DWORD DVar1;
HCERTSTORE hCertStore;
undefined8 uVar2;
longlong lVar3;
undefined2 uVar4;
undefined auStackY_78 [32];
int local_48 [2];
_EVENT_DATA_DESCRIPTOR local_40;
ulonglong local_30;

local_30 = DAT_180091970 ^ (ulonglong)auStackY_78;
local_48[0] = 0;
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(param_1,(PCEVENT_DESCRIPTOR)&DAT_180084c30,param_3,param_4,&local_40);
}
uVar2 = param_1;
hCertStore = (HCERTSTORE)CryptObjectLocatorGetContent();
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar2,(PCEVENT_DESCRIPTOR)&DAT_180084c20,param_3,param_4,&local_40);
}
if (hCertStore == (HCERTSTORE)0x0) {
DVar1 = GetLastError();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x20,&DAT_1800854d0,DVar1);
}
if (DVar1 == 0) goto LAB_180054466;
}
else {
uVar2 = FUN_180054118(hCertStore,0,local_48);
DVar1 = (DWORD)uVar2;
if (DVar1 == 0) {
if (local_48[0] == 0) {
DVar1 = 0x8009030e;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar4 = 0x22;
DVar1 = 0x8009030e;
goto LAB_18005440e;
}
}
else {
lVar3 = FUN_18000a1f4((ulonglong)(uint)(local_48[0] * 0x38));
*(longlong *)(param_2 + 8) = lVar3;
if (lVar3 == 0) {
DVar1 = 0xe;
}
else {
uVar2 = FUN_180054118(hCertStore,lVar3,local_48);
DVar1 = (DWORD)uVar2;
if (DVar1 == 0) {
*(int *)(param_2 + 4) = local_48[0];
*(undefined8 *)(param_2 + 0x18) = param_1;
*(HCERTSTORE *)(param_2 + 0x20) = hCertStore;
goto LAB_180054466;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar4 = 0x23;
goto LAB_18005440e;
}
}
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar4 = 0x21;
LAB_18005440e:
FUN_180041cdc(DAT_180091000[2],uVar4,&DAT_1800854d0,DVar1);
}
}
if (*(longlong *)(param_2 + 8) != 0) {
FUN_18000909c(*(HLOCAL *)(param_2 + 8));
}
if (hCertStore != (HCERTSTORE)0x0) {
CertCloseStore(hCertStore,0);
}
LAB_180054466:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041d20(DAT_180091000[2],0x24,&DAT_1800854d0,DVar1,(char)DVar1);
}
FUN_180028070(local_30 ^ (ulonglong)auStackY_78);
return;
}
=========================================
Function at address: 0x1800544b4
Called functions addresses: 0x18002a7c0 0x18002a700 0x18000a418 0x18002a757 0x180028070 0xEXTERNAL:00000149 0xEXTERNAL:00000041


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_1800544b4(PCCERT_CONTEXT param_1,undefined8 param_2,int param_3,undefined4 *param_4)

{
LPSTR *ppCVar1;
char *_Str2;
longlong lVar2;
BOOL BVar3;
uint uVar4;
DWORD DVar5;
int iVar6;
undefined8 uVar7;
ulonglong uVar8;
undefined4 *puVar9;
ulonglong uVar10;
PCERT_ENHKEY_USAGE pUsage;
undefined *puVar11;
undefined *puVar12;
uint uVar13;
undefined4 uVar14;
undefined auStack_48 [32];
_CTL_USAGE local_28;

puVar12 = auStack_48;
local_28.rgpszUsageIdentifier = (LPSTR *)(DAT_180091970 ^ (ulonglong)&local_28);
local_28.cUsageIdentifier = 0;
uVar13 = -(uint)(param_3 != 0) & 2;
BVar3 = CertGetEnhancedKeyUsage(param_1,uVar13,(PCERT_ENHKEY_USAGE)0x0,&local_28.cUsageIdentifier)
;
if (BVar3 != 0) {
uVar8 = (ulonglong)local_28.cUsageIdentifier;
pUsage = (PCERT_ENHKEY_USAGE)0x0;
puVar11 = auStack_48;
if ((((local_28.cUsageIdentifier == 0) || (puVar11 = auStack_48, DAT_1800920e0 < uVar8)) ||
(uVar10 = DAT_1800920e8 + 8 + uVar8, puVar11 = auStack_48, uVar10 < uVar8)) ||
(uVar7 = FUN_18000a418(uVar10), puVar11 = auStack_48, (int)uVar7 == 0)) {
LAB_180054585:
uVar4 = local_28.cUsageIdentifier + 8;
puVar12 = puVar11;
if (uVar4 < local_28.cUsageIdentifier) {
LAB_1800545b4:
if (pUsage != (PCERT_ENHKEY_USAGE)0x0) goto LAB_1800545c3;
}
else {
*(undefined8 *)(puVar11 + -8) = 0x1800545a5;

if (puVar9 != (undefined4 *)0x0) {
*puVar9 = 0x70616548;
pUsage = (PCERT_ENHKEY_USAGE)(puVar9 + 2);
goto LAB_1800545b4;
}
}
*param_4 = 0;
goto LAB_180054608;
}
uVar8 = (ulonglong)(local_28.cUsageIdentifier + 8) + 0xf;
if (uVar8 <= local_28.cUsageIdentifier + 8) {
uVar8 = 0xffffffffffffff0;
}
lVar2 = -(uVar8 & 0xfffffffffffffff0);
pUsage = (PCERT_ENHKEY_USAGE)((longlong)&local_28 + lVar2);
puVar11 = auStack_48 + lVar2;
if (pUsage == (PCERT_ENHKEY_USAGE)0x0) goto LAB_180054585;
pUsage->cUsageIdentifier = 0x6b637453;
pUsage = (PCERT_ENHKEY_USAGE)((longlong)&local_28 + lVar2 + 8);
puVar11 = auStack_48 + lVar2;
puVar12 = auStack_48 + lVar2;
if (pUsage == (PCERT_ENHKEY_USAGE)0x0) goto LAB_180054585;
LAB_1800545c3:
*(undefined8 *)(puVar12 + -8) = 0x1800545d6;
BVar3 = CertGetEnhancedKeyUsage(param_1,uVar13,pUsage,&local_28.cUsageIdentifier);
if (BVar3 != 0) {
if (pUsage->cUsageIdentifier == 0) {
*(undefined8 *)(puVar12 + -8) = 0x18005463a;
DVar5 = GetLastError();
if (DVar5 == 0x80092004) goto LAB_1800545df;
}
uVar8 = 0;
uVar14 = 0;
if (pUsage->cUsageIdentifier != 0) {
ppCVar1 = pUsage->rgpszUsageIdentifier;
do {
_Str2 = ppCVar1[uVar8];
*(undefined8 *)(puVar12 + -8) = 0x180054662;
iVar6 = strcmp("1.3.6.1.5.5.7.3.2",_Str2);
if (iVar6 == 0) {
uVar14 = 1;
break;
}
uVar13 = (int)uVar8 + 1;
uVar8 = (ulonglong)uVar13;
uVar14 = 0;
} while (uVar13 < pUsage->cUsageIdentifier);
}
if (*(int *)&pUsage[-1].rgpszUsageIdentifier == 0x70616548) {
*(undefined8 *)(puVar12 + -8) = 0x180054693;

}
*param_4 = uVar14;
goto LAB_180054608;
}
LAB_1800545df:
if (*(int *)&pUsage[-1].rgpszUsageIdentifier == 0x70616548) {
*(undefined8 *)(puVar12 + -8) = 0x1800545ff;

}
}
*param_4 = 1;
LAB_180054608:
uVar8 = (ulonglong)local_28.rgpszUsageIdentifier ^ (ulonglong)&local_28;
*(undefined8 *)(puVar12 + -8) = 0x180054614;
FUN_180028070(uVar8);
return;
}
=========================================
Function at address: 0x1800546a4
Called functions addresses: 0x180054f60 0xEXTERNAL:0000014c 0x180028d90 0x18005425c 0x180028070 0xEXTERNAL:00000041 0xEXTERNAL:00000128 0xEXTERNAL:00000145 0x180041cdc 0xEXTERNAL:00000047 0xEXTERNAL:0000012d 0x180001604 0xEXTERNAL:00000129 0xEXTERNAL:00000146 0xEXTERNAL:0000012c


void FUN_1800546a4(undefined8 *param_1,longlong param_2)

{
DWORD DVar1;
BOOL BVar2;
uint uVar3;
DWORD DVar4;
HCERTSTORE hCertStore;
HCERTSTORE hCertStore_00;
PCCERT_CONTEXT pCertContext;
undefined8 uVar5;
undefined2 uVar6;
undefined8 uVar7;
PCERT_CHAIN_POLICY_PARA pPolicyPara;
PCERT_CHAIN_POLICY_STATUS pPolicyStatus;
undefined auStackY_198 [32];
int local_158 [2];
PCCERT_CHAIN_CONTEXT local_150;
char *local_148;
_CERT_CHAIN_POLICY_PARA local_140;
undefined4 local_130;
undefined4 local_12c;
undefined4 local_128;
undefined4 local_124;
undefined8 local_120;
_CERT_CHAIN_POLICY_STATUS local_118;
_CERT_CHAIN_PARA local_f8 [3];
_EVENT_DATA_DESCRIPTOR local_98;
_EVENT_DATA_DESCRIPTOR local_88;
_EVENT_DATA_DESCRIPTOR local_78;
_EVENT_DATA_DESCRIPTOR local_68;
_EVENT_DATA_DESCRIPTOR local_58;
_EVENT_DATA_DESCRIPTOR local_48;
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_198;
local_150 = (PCCERT_CHAIN_CONTEXT)0x0;
local_158[0] = 0;
hCertStore = CertOpenStore((LPCSTR)0x2,0,0,4,(void *)0x0);
if (hCertStore == (HCERTSTORE)0x0) {
DVar1 = GetLastError();
}
else {
DVar1 = FUN_180001604(param_2,local_158);
if (DVar1 == 0) {
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)0x18001;
hCertStore_00 = CertOpenStore((LPCSTR)0xa,0,0,0x18001,L"ROOT");
if (hCertStore_00 == (HCERTSTORE)0x0) {
DVar1 = GetLastError();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_1800854d0,DVar1);
}
}
else {
for (pCertContext = CertEnumCertificatesInStore(hCertStore_00,(PCCERT_CONTEXT)0x0);
pCertContext != (PCCERT_CONTEXT)0x0;
pCertContext = CertEnumCertificatesInStore(hCertStore_00,pCertContext)) {
uVar5 = FUN_18005425c((longlong)pCertContext);
if ((int)uVar5 != 0) {
local_148 = "1.3.6.1.5.5.7.3.2";
uVar5 = 0x60;
memset(local_f8,0,0x60);
local_f8[0].cbSize = 0x60;
local_f8[0].RequestedUsage.Usage.rgpszUsageIdentifier = &local_148;
local_f8[0].RequestedUsage.dwType = 1;
local_f8[0].RequestedUsage.Usage.cUsageIdentifier = 1;
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(1,(PCEVENT_DESCRIPTOR)&DAT_180084c90,uVar5,pPolicyStatus,&local_98);
}
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)0x0;
uVar7 = 0;
uVar5 = 0;
BVar2 = CertGetCertificateChain
((HCERTCHAINENGINE)0x0,pCertContext,(LPFILETIME)0x0,(HCERTSTORE)0x0,
local_f8,0,(LPVOID)0x0,&local_150);
if (BVar2 == 0) {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084c80,uVar7,pPolicyStatus,&local_88
);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar3 = GetLastError();
uVar6 = 0xe;
LAB_180054a89:
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)(ulonglong)uVar3;
FUN_180041cdc(DAT_180091000[2],uVar6,&DAT_1800854d0,uVar3);
}
}
else {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084c80,uVar7,pPolicyStatus,&local_78
);
}
local_124 = 0;
local_128 = 0;
local_120 = 0;
local_118.pvExtraPolicyStatus = (void *)0x0;
local_140.pvExtraPolicyPara = &local_130;
local_130 = 0x18;
local_12c = 1;
local_140.cbSize = 0x10;
local_140.dwFlags = 7;
local_118.lChainIndex = 0;
local_118.lElementIndex = 0;
local_118.cbSize = 0x18;
local_118.dwError = 0;
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(local_140.pvExtraPolicyPara,(PCEVENT_DESCRIPTOR)&DAT_180084c70,uVar7,
pPolicyStatus,&local_68);
}
pPolicyStatus = &local_118;
pPolicyPara = &local_140;
uVar5 = 4;
BVar2 = CertVerifyCertificateChainPolicy
((LPCSTR)0x4,local_150,pPolicyPara,pPolicyStatus);
if (BVar2 == 0) {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,
&local_58);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar4 = GetLastError();
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)(ulonglong)DVar4;
FUN_180041cdc(DAT_180091000[2],0xf,&DAT_1800854d0,DVar4);
}
}
else {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,
&local_48);
}
if (local_118.dwError == 0) {
CertFreeCertificateChain(local_150);
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)0x0;
BVar2 = CertAddCertificateContextToStore
(hCertStore,pCertContext,2,(PCCERT_CONTEXT *)0x0);
if (((BVar2 == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar3 = GetLastError();
uVar6 = 0x10;
goto LAB_180054a89;
}
goto LAB_180054aa3;
}
}
CertFreeCertificateChain(local_150);
}
}
LAB_180054aa3:
}
CertCloseStore(hCertStore_00,0);
}
}
if (local_158[0] != 0) {
RevertToSelf();
}
}
if (DVar1 == 0) {
*param_1 = hCertStore;
}
else {
CertCloseStore(hCertStore,0);
}
FUN_180028070(local_38 ^ (ulonglong)auStackY_198);
return;
}
=========================================
Function at address: 0x180054b34
Called functions addresses: 0xEXTERNAL:00000147 0x18000a1f4 0x18002a77b


undefined8
FUN_180054b34(undefined8 param_1,longlong param_2,longlong param_3,char param_4,longlong *param_5,
uint *param_6)

{
DWORD *pDVar1;
BOOL BVar2;
longlong lVar3;
longlong lVar4;
ulonglong uVar5;
uint uVar6;
undefined *puVar8;
uint uVar9;
ulonglong uVar7;

uVar5 = 0;
if (param_6 == (uint *)0x0) {
return 0x80090304;
}
if (param_3 == 0) {
uVar9 = *(int *)(param_2 + 0x10) + 3;
if (param_5 != (longlong *)0x0) {
if (*param_5 == 0) {
lVar3 = FUN_18000a1f4((ulonglong)uVar9);
*param_5 = lVar3;
if (lVar3 == 0) {
return 0x80090300;
}
}
else if (*param_6 < uVar9) {
return 0x80090321;
}
*param_6 = uVar9;
puVar8 = (undefined *)*param_5;
*puVar8 = *(undefined *)(param_2 + 0x12);
puVar8[1] = *(undefined *)(param_2 + 0x11);
puVar8[2] = *(undefined *)(param_2 + 0x10);
memcpy(puVar8 + 3,*(void **)(param_2 + 8),(ulonglong)*(uint *)(param_2 + 0x10));
return 0;
}
}
else {
uVar9 = 0;
lVar3 = **(longlong **)(param_3 + 0x10);
uVar7 = uVar5;
if (*(int *)(lVar3 + 0xc) != 0) {
do {
pDVar1 = *(DWORD **)(*(longlong *)(*(longlong *)(lVar3 + 0x10) + uVar7 * 8) + 8);
if ((((int)uVar7 != 0) && (param_4 == '\0')) &&
(BVar2 = CertCompareCertificateName
(*pDVar1,(PCERT_NAME_BLOB)(*(longlong *)(pDVar1 + 6) + 0x30),
(PCERT_NAME_BLOB)(*(longlong *)(pDVar1 + 6) + 0x50)), BVar2 != 0))
break;
if (pDVar1[4] + uVar9 < uVar9) {
return 0x216;
}
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
uVar9 = pDVar1[4] + uVar9 + 3;
} while (uVar6 < *(uint *)(lVar3 + 0xc));
}
if (param_5 != (longlong *)0x0) {
if (*param_5 == 0) {
lVar4 = FUN_18000a1f4((ulonglong)uVar9);
*param_5 = lVar4;
if (lVar4 == 0) {
return 0x80090300;
}
}
else if (*param_6 < uVar9) {
return 0x80090321;
}
*param_6 = uVar9;
puVar8 = (undefined *)*param_5;
if (*(int *)(lVar3 + 0xc) != 0) {
while( true ) {
pDVar1 = *(DWORD **)(*(longlong *)(*(longlong *)(lVar3 + 0x10) + uVar5 * 8) + 8);
if ((((int)uVar5 != 0) && (param_4 == '\0')) &&
(BVar2 = CertCompareCertificateName
(*pDVar1,(PCERT_NAME_BLOB)(*(longlong *)(pDVar1 + 6) + 0x30),
(PCERT_NAME_BLOB)(*(longlong *)(pDVar1 + 6) + 0x50)), BVar2 != 0))
break;
*puVar8 = *(undefined *)((longlong)pDVar1 + 0x12);
puVar8[1] = *(undefined *)((longlong)pDVar1 + 0x11);
puVar8[2] = *(undefined *)(pDVar1 + 4);
memcpy(puVar8 + 3,*(void **)(pDVar1 + 2),(ulonglong)pDVar1[4]);
uVar9 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar9;
puVar8 = puVar8 + 3 + pDVar1[4];
if (*(uint *)(lVar3 + 0xc) <= uVar9) {
return 0;
}
}
return 0;
}
return 0;
}
}
*param_6 = uVar9;
return 0;
}
=========================================
Function at address: 0x180054d10
Called functions addresses: 0x180007ef4 0xEXTERNAL:00000147


void FUN_180054d10(ushort *param_1,PCCERT_CONTEXT param_2,longlong param_3,char param_4)

{
longlong lVar1;
PCCERT_CONTEXT pCVar2;
char cVar3;
BOOL BVar4;
uint uVar5;

*param_1 = 0;
param_1[0x11] = 0;
cVar3 = '\x01';
if (param_3 == 0) {
cVar3 = FUN_180007ef4(param_1,param_2);
}
else {
uVar5 = 0;
lVar1 = **(longlong **)(param_3 + 0x10);
if (*(int *)(lVar1 + 0xc) == 0) {
return;
}
do {
pCVar2 = *(PCCERT_CONTEXT *)
(*(longlong *)(*(longlong *)(lVar1 + 0x10) + (ulonglong)uVar5 * 8) + 8);
if (((uVar5 != 0) && (param_4 == '\0')) &&
(BVar4 = CertCompareCertificateName
(pCVar2->dwCertEncodingType,&pCVar2->pCertInfo->Issuer,
&pCVar2->pCertInfo->Subject), BVar4 != 0)) break;
cVar3 = FUN_180007ef4(param_1,pCVar2);
if (cVar3 == '\0') goto LAB_180054db5;
uVar5 = uVar5 + 1;
} while (uVar5 < *(uint *)(lVar1 + 0xc));
}
if (cVar3 == '\0') {
LAB_180054db5:
*param_1 = 0;
param_1[0x11] = 0;
}
return;
}
=========================================
Function at address: 0x180054de4
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000014c 0x180054f60 0x180028070 0xEXTERNAL:00000041 0x180001674


void FUN_180054de4(PCCERT_CHAIN_CONTEXT param_1,LPCSTR param_2,undefined8 param_3,undefined8 param_4
)

{
BOOL BVar1;
uint uVar2;
PCERT_CHAIN_POLICY_PARA pPolicyPara;
PCERT_CHAIN_POLICY_STATUS pPolicyStatus;
undefined auStackY_a8 [32];
_CERT_CHAIN_POLICY_PARA local_78;
undefined4 local_68;
undefined4 local_64;
undefined4 local_60;
undefined8 local_5c;
undefined4 local_54;
_CERT_CHAIN_POLICY_STATUS local_50;
_EVENT_DATA_DESCRIPTOR local_38;
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStackY_a8;
local_78.cbSize = 0x10;
if (param_2 == (LPCSTR)0x6) {
local_78.pvExtraPolicyPara = (undefined4 *)0x0;
local_78.dwFlags = 0x40000000;
}
else {
local_5c = 0;
local_78.pvExtraPolicyPara = &local_68;
local_54 = 0;
local_60 = 0;
local_78.dwFlags = 0;
local_68 = 0x18;
local_64 = 1;
}
local_50.lChainIndex = 0;
local_50.lElementIndex = 0;
local_50.cbSize = 0x18;
local_50.dwError = 0;
local_50.pvExtraPolicyStatus = (void *)0x0;
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(0x18,(PCEVENT_DESCRIPTOR)&DAT_180084c70,param_3,param_4,&local_38);
}
pPolicyStatus = &local_50;
pPolicyPara = &local_78;
BVar1 = CertVerifyCertificateChainPolicy(param_2,param_1,pPolicyPara,pPolicyStatus);
if (BVar1 == 0) {
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(param_2,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,&local_38);
}
GetLastError();
}
else {
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(param_2,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,&local_38);
}
uVar2 = FUN_180001674(local_50.dwError,0,(uint)param_3,(undefined *)0x0);
if (((uVar2 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x14,&DAT_1800854d0,uVar2);
}
}
FUN_180028070(local_28 ^ (ulonglong)auStackY_a8);
return;
}
=========================================
Function at address: 0x180054f60
Called functions addresses: 0xEXTERNAL:00000094


void FUN_180054f60(undefined8 param_1,PCEVENT_DESCRIPTOR param_2,undefined8 param_3,
undefined8 param_4,PEVENT_DATA_DESCRIPTOR param_5)

{
ushort *puVar1;
uint uVar2;
uint uVar3;

puVar1 = DAT_180091388;
uVar3 = 0;
if (DAT_180091388 == (ushort *)0x0) {
param_5->Ptr = 0;
uVar2 = uVar3;
}
else {
param_5->Ptr = (ULONGLONG)DAT_180091388;
uVar2 = 2;
uVar3 = (uint)*puVar1;
}
param_5->Size = uVar3;
param_5->Reserved = uVar2;
EventWriteTransfer(DAT_180091380,param_2,(LPCGUID)0x0,(LPCGUID)0x0,1,param_5);
return;
}
=========================================
Function at address: 0x180054fc4
Called functions addresses: 0xEXTERNAL:00000062


void FUN_180054fc4(void)

{
if (DAT_1800927d0 != (HANDLE)0x0) {
CloseHandle(DAT_1800927d0);
DAT_1800927d0 = (HANDLE)0x0;
}
if (DAT_1800927c8 != (HANDLE)0x0) {
CloseHandle(DAT_1800927c8);
DAT_1800927c8 = (HANDLE)0x0;
}
return;
}
=========================================
Function at address: 0x180055014
Called functions addresses: 0xEXTERNAL:00000156


void FUN_180055014(void)

{
if (DAT_180092f68 != 0) {
CryptObjectLocatorRelease(1);
DAT_180092f68 = 0;
}
if (DAT_180092f60 != 0) {
CryptObjectLocatorRelease(1);
DAT_180092f60 = 0;
}
return;
}
=========================================
Function at address: 0x180055070
Called functions addresses: 0xEXTERNAL:0000009f 0xEXTERNAL:00000062 0x1800432ec 0xEXTERNAL:00000041


void FUN_180055070(void)

{
int iVar1;
uint uVar2;
BOOL BVar3;
DWORD DVar4;

LOCK();
iVar1 = DAT_180092ee0 + 1;
UNLOCK();
uVar2 = DAT_180092ee0 + 1;
DAT_180092ee0 = iVar1;
if (uVar2 < 2) {
if (DAT_1800927d8 != (HANDLE)0x0) {
BVar3 = UnregisterWaitEx(DAT_1800927d8,(HANDLE)0xffffffffffffffff);
if (((BVar3 == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
DVar4 = GetLastError();
FUN_1800432ec(DAT_180091000[2],10,&DAT_180085528,DVar4);
}
DAT_1800927d8 = (HANDLE)0x0;
}
if (DAT_1800927e0 != (HANDLE)0x0) {
CloseHandle(DAT_1800927e0);
DAT_1800927e0 = (HANDLE)0x0;
}
}
LOCK();
DAT_180092ee0 = DAT_180092ee0 + -1;
UNLOCK();
return;
}
=========================================
Function at address: 0x18005512c
Called functions addresses: 0x180041cdc 0xEXTERNAL:000000bc 0xEXTERNAL:00000155 0xEXTERNAL:000000c0 0xEXTERNAL:00000041


DWORD FUN_18005512c(void)

{
DWORD DVar1;
DWORD DVar2;
longlong lVar3;
longlong lVar4;

DVar2 = 0;
RtlAcquireResourceExclusive(&DAT_180092e40,1);
lVar4 = DAT_180092f60;
lVar3 = DAT_180092f68;
DVar1 = 0;
if (DAT_180092f68 == 0) {
lVar3 = CryptObjectLocatorInitialize("SslObjectLocatorInitializePfx",1,0,0,DAT_1800927d0);
if (lVar3 == 0) {
DVar1 = GetLastError();
lVar4 = DAT_180092f60;
lVar3 = DAT_180092f68;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_180085528,DVar1);
lVar4 = DAT_180092f60;
lVar3 = DAT_180092f68;
}
}
else {
lVar4 = CryptObjectLocatorInitialize
("SslObjectLocatorInitializeIssuerList",2,0,0,DAT_1800927c8);
DVar1 = DVar2;
if (((lVar4 == 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar2 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0xe,&DAT_180085528,DVar2);
}
}
}
DAT_180092f68 = lVar3;
DAT_180092f60 = lVar4;
RtlReleaseResource(&DAT_180092e40);
return DVar1;
}
=========================================
Function at address: 0x180055288
Called functions addresses: 0xEXTERNAL:00000140 0xEXTERNAL:00000067 0xEXTERNAL:00000041


DWORD FUN_180055288(longlong param_1,HCERTSTORE param_2,HANDLE param_3)

{
DWORD DVar1;
BOOL BVar2;
HANDLE local_res18 [2];

if ((param_2 == (HCERTSTORE)0x0) || (param_3 == (HANDLE)0x0)) {
return 0x57;
}
local_res18[0] = param_3;
DVar1 = WaitForSingleObjectEx(param_3,0,0);
if (DVar1 == 0xffffffff) {
LAB_1800552c3:
DVar1 = GetLastError();
}
else {
if (DVar1 == 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) | 0x10;
BVar2 = CertControlStore(param_2,0,1,local_res18);
if (BVar2 == 0) goto LAB_1800552c3;
}
DVar1 = 0;
}
return DVar1;
}
=========================================
Function at address: 0x180055318
Called functions addresses: 0x180041cdc 0xEXTERNAL:00000047 0x180001604 0x1800561b4 0x180055288


void FUN_180055318(undefined8 *param_1)

{
int *piVar1;
DWORD DVar2;
int iVar3;
int local_res8 [2];

local_res8[0] = 0;
LOCK();
piVar1 = (int *)((longlong)param_1 + 0x94);
iVar3 = *piVar1;
*piVar1 = *piVar1 + 1;
UNLOCK();
if (iVar3 + 1 < 2) {
if ((*(uint *)(param_1 + 0x13) & 0x40051555) != 0) {
FUN_1800561b4(param_1);
}
if (((HCERTSTORE)param_1[0x60] != (HCERTSTORE)0x0) && ((HANDLE)param_1[0x61] != (HANDLE)0x0)) {
DVar2 = FUN_180055288((longlong)param_1,(HCERTSTORE)param_1[0x60],(HANDLE)param_1[0x61]);
if ((DVar2 != 0) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)))) {
FUN_180041cdc(DAT_180091000[2],0x1d,&DAT_180082b38,DVar2);
}
}
if (((HCERTSTORE)param_1[0x66] != (HCERTSTORE)0x0) && ((HANDLE)param_1[0x67] != (HANDLE)0x0)) {
DVar2 = FUN_180055288((longlong)param_1,(HCERTSTORE)param_1[0x66],(HANDLE)param_1[0x67]);
if ((DVar2 != 0) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)))) {
FUN_180041cdc(DAT_180091000[2],0x1e,&DAT_180082b38,DVar2);
}
}
if (((HCERTSTORE)param_1[0x68] != (HCERTSTORE)0x0) && ((HANDLE)param_1[0x69] != (HANDLE)0x0)) {
DVar2 = FUN_180055288((longlong)param_1,(HCERTSTORE)param_1[0x68],(HANDLE)param_1[0x69]);
if ((DVar2 != 0) &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)))) {
FUN_180041cdc(DAT_180091000[2],0x1f,&DAT_180082b38,DVar2);
}
}
if ((param_1[0x62] != 0) && (param_1[99] != 0)) {
iVar3 = FUN_180001604(param_1[0x5e],local_res8);
if (iVar3 == 0) {
DVar2 = FUN_180055288((longlong)param_1,(HCERTSTORE)param_1[0x62],(HANDLE)param_1[99]);
if (((DVar2 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x21,&DAT_180082b38,DVar2);
}
if (local_res8[0] != 0) {
RevertToSelf();
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x20,&DAT_180082b38,iVar3);
}
}
}
LOCK();
*(int *)((longlong)param_1 + 0x94) = *(int *)((longlong)param_1 + 0x94) + -1;
UNLOCK();
return;
}
=========================================
Function at address: 0x180055510
Called functions addresses: 0x180056bf0 0x180056de8 0xEXTERNAL:000000bc 0xEXTERNAL:000000c0


int FUN_180055510(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
int iVar1;
undefined8 uVar2;
undefined uVar3;
undefined7 uVar4;

uVar4 = (undefined7)((ulonglong)param_2 >> 8);
if ((*(uint *)(param_1 + 0x98) & 0x40051555) == 0) {
iVar1 = 0;
}
else {
uVar3 = 1;
RtlAcquireResourceExclusive(param_1 + 0x30);
iVar1 = 0;
if ((*(byte *)(param_1 + 0x9c) & 0x40) != 0) {
if (*(longlong *)(param_1 + 800) == 0) {
uVar2 = FUN_180056de8(param_1);
iVar1 = (int)uVar2;
}
else {
iVar1 = FUN_180056bf0(param_1,CONCAT71(uVar4,uVar3),param_3,param_4);
}
if (iVar1 == 0) {
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) & 0xffffffbf;
}
}
RtlReleaseResource(param_1 + 0x30);
}
return iVar1;
}
=========================================
Function at address: 0x1800555a0
Called functions addresses: 0xEXTERNAL:000000c2 0xEXTERNAL:00000147 0x180041cb0 0x1800432ec 0xEXTERNAL:000000c0


ulonglong FUN_1800555a0(longlong param_1,longlong param_2)

{
undefined *puVar1;
undefined *puVar2;
uint uVar3;
longlong lVar4;
DWORD *pDVar5;
BOOL BVar6;
undefined8 uVar7;
ulonglong uVar8;
undefined *puVar10;
uint uVar11;
_CRYPTOAPI_BLOB local_38;
ulonglong uVar9;
ulonglong uVar12;

local_38.cbData = 0;
local_38._4_4_ = 0;
local_38.pbData = (BYTE *)0x0;
RtlAcquireResourceShared(param_1 + 0x30,1);
puVar10 = *(undefined **)(param_1 + 0x360);
uVar9 = 0;
uVar8 = 0;
if (puVar10 == (undefined *)0x0) {
uVar8 = uVar9;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x26,&DAT_180082b38);
}
}
else {
uVar3 = *(uint *)(param_1 + 0x358);
if (uVar3 < 2) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x27,&DAT_180082b38,uVar3);
}
}
else {
puVar2 = puVar10 + uVar3;
lVar4 = **(longlong **)(param_2 + 0x10);
for (; puVar1 = puVar10 + 1, puVar1 < puVar2;
puVar10 = puVar10 + (ulonglong)CONCAT11(*puVar10,*puVar1) + 2) {
local_38.pbData = puVar10 + 2;
local_38.cbData = (uint)CONCAT11(*puVar10,*puVar1);
if (uVar3 < CONCAT11(*puVar10,*puVar1)) break;
uVar12 = uVar9;
if (*(int *)(lVar4 + 0xc) != 0) {
do {
pDVar5 = *(DWORD **)(*(longlong *)(*(longlong *)(lVar4 + 0x10) + uVar12 * 8) + 8);
BVar6 = CertCompareCertificateName
(*pDVar5,(PCERT_NAME_BLOB)(*(longlong *)(pDVar5 + 6) + 0x30),&local_38
);
if (BVar6 != 0) {
uVar8 = 1;
goto LAB_1800556f8;
}
uVar11 = (int)uVar12 + 1;
uVar12 = (ulonglong)uVar11;
} while (uVar11 < *(uint *)(lVar4 + 0xc));
}
}
}
}
LAB_1800556f8:
uVar7 = RtlReleaseResource(param_1 + 0x30);
return CONCAT71((int7)((ulonglong)uVar7 >> 8),(char)uVar8);
}
=========================================
Function at address: 0x180055730
Called functions addresses: 0x1800546a4 0xEXTERNAL:000000c8 0x180053e4c 0xEXTERNAL:0000003f 0x180041cdc 0xEXTERNAL:0000013f 0x18000909c 0xEXTERNAL:0000012b 0x180045408 0x180053ad0 0x18002a77b 0x1800569fc 0xEXTERNAL:00000129 0xEXTERNAL:00000040 0xEXTERNAL:0000003e 0xEXTERNAL:0000012c


/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

ulonglong FUN_180055730(longlong param_1)

{
uint uVar1;
undefined8 uVar2;
undefined *puVar3;
PCCERT_CONTEXT pCertContext;
ulonglong uVar4;
undefined *puVar5;
HCERTSTORE pvVar6;
undefined *_Dst;
ulonglong uVar7;
uint uVar8;
uint local_res8 [2];
uint local_res10 [2];
HCERTSTORE local_res18;
void *local_res20;
undefined local_48 [16];

local_res20 = (void *)0x0;
local_res10[0] = 0;
puVar3 = (undefined *)0x0;
local_res18 = (HCERTSTORE)0x0;
local_res8[0] = 0;
if (*(HLOCAL *)(param_1 + 0x360) != (HLOCAL)0x0) {
if ((*(byte *)(param_1 + 0x9c) & 0x10) == 0) {
return 0;
}
LocalFree(*(HLOCAL *)(param_1 + 0x360));
*(undefined8 *)(param_1 + 0x360) = 0;
*(undefined4 *)(param_1 + 0x358) = 0;
}
*(uint *)(param_1 + 0x9c) = *(uint *)(param_1 + 0x9c) & 0xffffffef;
uVar8 = 0;
if ((*(HCERTSTORE *)(param_1 + 0x300) != (HCERTSTORE)0x0) &&
(uVar2 = FUN_180053e4c(*(HCERTSTORE *)(param_1 + 0x300),(undefined *)0x0,local_res8,(char *)0x0
), uVar8 = local_res8[0], (int)uVar2 == 0)) {
puVar3 = (undefined *)LocalAlloc(0x40,(ulonglong)local_res8[0]);
if (puVar3 == (undefined *)0x0) {
return 0xe;
}
uVar2 = FUN_180053e4c(*(HCERTSTORE *)(param_1 + 0x300),puVar3,local_res8,(char *)0x0);
uVar8 = local_res8[0];
if ((int)uVar2 != 0) {
LocalFree(puVar3);
puVar3 = (undefined *)0x0;
uVar8 = 0;
}
}
pvVar6 = *(HCERTSTORE *)(param_1 + 0x330);
if (pvVar6 == (HCERTSTORE)0x0) {
if ((*(HCERTSTORE *)(param_1 + 0x340) != (HCERTSTORE)0x0) &&
(pCertContext = CertEnumCertificatesInStore
(*(HCERTSTORE *)(param_1 + 0x340),(PCCERT_CONTEXT)0x0),
pCertContext != (PCCERT_CONTEXT)0x0)) {
CertFreeCertificateContext(pCertContext);
pvVar6 = *(HCERTSTORE *)(param_1 + 0x340);
goto LAB_18005584c;
}
LAB_180055864:
uVar1 = FUN_1800546a4(&local_res18,*(longlong *)(param_1 + 0x2f0));
uVar7 = (ulonglong)uVar1;
if (uVar1 == 0) goto LAB_1800558b8;
pvVar6 = local_res18;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x23,&DAT_180082b38,uVar1);
pvVar6 = local_res18;
}
LAB_1800559dc:
if (puVar3 == (undefined *)0x0) goto LAB_180055adc;
}
else {
LAB_18005584c:
local_res18 = CertDuplicateStore(pvVar6);
if (local_res18 == (HCERTSTORE)0x0) goto LAB_180055864;
LAB_1800558b8:
pvVar6 = local_res18;
uVar4 = FUN_180053ad0(local_res18,&local_res20,local_res10);
uVar1 = local_res10[0];
uVar7 = uVar4 & 0xffffffff;
if ((int)uVar4 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x24,&DAT_180082b38,(int)uVar4);
}
goto LAB_1800559dc;
}
if (puVar3 == (undefined *)0x0) {
puVar5 = (undefined *)LocalAlloc(0x40,(ulonglong)local_res10[0]);
if (puVar5 == (undefined *)0x0) {
uVar7 = 0xe;
goto LAB_180055adc;
}
LAB_180055972:
_Dst = puVar5 + uVar8;
memcpy(_Dst,local_res20,(ulonglong)uVar1);
uVar1 = uVar1 + uVar8;
local_res8[0] = uVar1;
if ((*(byte *)(param_1 + 0x9c) & 1) == 0) {
uVar8 = uVar1 + 0x1b;
puVar3 = puVar5;
if (puVar5 == (undefined *)0x0) {
_Dst = (undefined *)0x40;
puVar5 = (undefined *)LocalAlloc(0x40,0x1b);
}
else {
if (uVar8 < uVar1) goto LAB_180055941;
_Dst = puVar5;
puVar5 = (undefined *)LocalReAlloc(puVar5,(ulonglong)uVar8,2);
}
uVar2 = uRam0000000180091a08;
if (puVar5 == (undefined *)0x0) {
uVar7 = 0xe;
goto LAB_1800559dc;
}
*(undefined8 *)(puVar5 + uVar1) = _DAT_180091a00;
*(undefined8 *)((longlong)(puVar5 + uVar1) + 8) = uVar2;
*(undefined8 *)(puVar5 + (ulonglong)uVar1 + 0x10) = s_NT_AUTHORITY_180091a0f._1_8_;
*(undefined2 *)(puVar5 + (ulonglong)uVar1 + 0x18) = s_NT_AUTHORITY_180091a0f._9_2_;
puVar5[(ulonglong)uVar1 + 0x1a] = s_NT_AUTHORITY_180091a0f[0xb];
local_res8[0] = uVar8;
LAB_180055a24:
uVar8 = FUN_1800569fc(_Dst,puVar5,local_res8);
uVar7 = (ulonglong)uVar8;
puVar3 = puVar5;
if (uVar8 != 0) goto LAB_180055a36;
}
else if (puVar5 != (undefined *)0x0) goto LAB_180055a24;
*(uint *)(param_1 + 0x358) = local_res8[0];
*(undefined **)(param_1 + 0x360) = puVar5;
if ((puVar5 != (undefined *)0x0) && (0x3fd0 < local_res8[0])) {
uVar8 = 0;
if (local_res8[0] != 0) {
do {
uVar1 = uVar8 + 2 + (uint)CONCAT11(*puVar5,puVar5[1]);
if (0x3fd0 < uVar1) {
*(uint *)(param_1 + 0x358) = uVar8;
break;
}
puVar5 = puVar5 + (CONCAT11(*puVar5,puVar5[1]) + 2);
uVar8 = uVar1;
} while (uVar1 < local_res8[0]);
}
uVar8 = *(uint *)(param_1 + 0xd4);
if ((DAT_1800919b0 & 1) != 0) {
RtlInitUnicodeString(local_48,param_1 + 0xd8);
FUN_180045408((ushort *)&DAT_180084fa0,0x180084eb4,(ulonglong)uVar8,local_48);
}
}
uVar7 = 0;
goto LAB_180055adc;
}
if (local_res10[0] + uVar8 < uVar8) {
LAB_180055941:
uVar7 = 0x216;
}
else {
puVar5 = (undefined *)LocalReAlloc(puVar3,(ulonglong)(local_res10[0] + uVar8),2);
if (puVar5 != (undefined *)0x0) goto LAB_180055972;
uVar7 = 0xe;
}
}
LAB_180055a36:
LocalFree(puVar3);
LAB_180055adc:
if (pvVar6 != (HCERTSTORE)0x0) {
CertCloseStore(pvVar6,0);
}
if (local_res20 != (HLOCAL)0x0) {
FUN_18000909c(local_res20);
}
return uVar7;
}
=========================================
Function at address: 0x180055b18
Called functions addresses: 0x18005e8a8 0x18000a1f4 0x18002a7c0 0x18005e6d0


undefined8 FUN_180055b18(longlong param_1,uint *param_2)

{
code *pcVar1;
int iVar2;
undefined8 *puVar3;
longlong *plVar4;
longlong lVar5;
longlong *plVar6;
uint7 in_stack_ffffffffffffffd9;

puVar3 = (undefined8 *)FUN_18000a1f4(0x498);
if ((puVar3 != (undefined8 *)0x0) &&
(puVar3 = FUN_18005e6d0(puVar3,(*(uint *)(param_1 + 0x98) & 0x40051555) != 0,
*(undefined *)(param_1 + 0xad),*(undefined *)(param_1 + 0xac)),
puVar3 != (undefined8 *)0x0)) {
iVar2 = FUN_18005e8a8((ulonglong)puVar3,*(undefined4 *)(param_1 + 0xd4),param_1 + 0xd8,
*(longlong *)(param_1 + 0x2f0),param_2,0,
(ulonglong)in_stack_ffffffffffffffd9 << 8,
(uint)(*(longlong *)(param_1 + 800) != 0),*(uint **)(param_1 + 200),
*(uint *)(param_1 + 0xc4));
if (iVar2 == 0) {
if (*(int *)((longlong)puVar3 + 0x8c) != 0) {
*(undefined *)(param_1 + 900) = 1;
}
plVar4 = (longlong *)(param_1 + 0x20);
plVar6 = puVar3 + 1;
lVar5 = *plVar4;
if (*(longlong **)(lVar5 + 8) != plVar4) {
lVar5 = 3;
pcVar1 = (code *)swi(0x29);
plVar4 = (longlong *)(*pcVar1)();
}
*plVar6 = lVar5;
puVar3[2] = plVar4;
*(longlong **)(lVar5 + 8) = plVar6;
*plVar4 = (longlong)plVar6;
*(int *)(param_1 + 0x1c) = *(int *)(param_1 + 0x1c) + 1;
}
else {

}
return 0;
}
return 0xe;
}
=========================================
Function at address: 0x180055c40
Called functions addresses: 0xEXTERNAL:000000c2 0x18000a1f4 0x18002a77b 0xEXTERNAL:000000c0


undefined8 FUN_180055c40(longlong param_1,undefined8 *param_2,undefined4 *param_3)

{
longlong lVar1;
void *_Dst;
undefined8 uVar2;

if ((param_2 == (undefined8 *)0x0) || (param_3 == (undefined4 *)0x0)) {
uVar2 = 0x57;
}
else {
*param_2 = 0;
lVar1 = param_1 + 0x30;
*param_3 = 0;
RtlAcquireResourceShared(lVar1,1);
if ((*(longlong *)(param_1 + 0x360) != 0) && (*(uint *)(param_1 + 0x358) != 0)) {
_Dst = (void *)FUN_18000a1f4((ulonglong)*(uint *)(param_1 + 0x358));
*param_2 = _Dst;
if (_Dst == (void *)0x0) {
RtlReleaseResource(lVar1);
return 0xe;
}
memcpy(_Dst,*(void **)(param_1 + 0x360),(ulonglong)*(uint *)(param_1 + 0x358));
*param_3 = *(undefined4 *)(param_1 + 0x358);
}
RtlReleaseResource(lVar1);
uVar2 = 0;
}
return uVar2;
}
=========================================
Function at address: 0x180055d18
Called functions addresses: 0xEXTERNAL:000000c2 0xEXTERNAL:000000c0


undefined8 FUN_180055d18(longlong param_1,longlong *param_2,int param_3,longlong *param_4)

{
undefined8 *puVar1;
longlong lVar2;
undefined8 *puVar3;
undefined8 uVar4;

uVar4 = 0x490;
if (((param_2 == (longlong *)0x0) || (param_3 == 0)) || (param_4 == (longlong *)0x0)) {
uVar4 = 0x57;
}
else {
RtlAcquireResourceShared(param_1 + 0x30,1);
puVar1 = *(undefined8 **)(param_1 + 0x20);
do {
do {
puVar3 = puVar1;
if (puVar3 == (undefined8 *)(param_1 + 0x20)) goto LAB_180055da6;
puVar1 = (undefined8 *)*puVar3;
} while (param_3 != 0x14);
lVar2 = puVar3[4] - *param_2;
if ((lVar2 == 0) && (lVar2 = puVar3[5] - param_2[1], lVar2 == 0)) {
lVar2 = (ulonglong)*(uint *)(puVar3 + 6) - (ulonglong)*(uint *)(param_2 + 2);
}
} while (lVar2 != 0);
uVar4 = 0;
*param_4 = (longlong)(puVar3 + -1);
LAB_180055da6:
RtlReleaseResource(param_1 + 0x30);
}
return uVar4;
}
=========================================
Function at address: 0x180055de0
Called functions addresses: 0xEXTERNAL:0000003f 0xEXTERNAL:00000040 0xEXTERNAL:00000097 0xEXTERNAL:00000041


DWORD FUN_180055de0(undefined8 param_1,LPCWSTR param_2,undefined8 *param_3)

{
DWORD DVar1;
DWORD DVar2;
LPWSTR lpDst;

DVar2 = 0;
DVar1 = ExpandEnvironmentStringsW(param_2,(LPWSTR)0x0,0);
if (DVar1 == 0) {
DVar2 = GetLastError();
if (0 < (int)DVar2) {
DVar2 = DVar2 & 0xffff | 0x80070000;
}
}
else {
lpDst = (LPWSTR)LocalAlloc(0x40,(ulonglong)DVar1 * 2);
if (lpDst == (LPWSTR)0x0) {
DVar2 = 0x8009000e;
}
else {
DVar1 = ExpandEnvironmentStringsW(param_2,lpDst,DVar1);
if (DVar1 == 0) {
DVar2 = GetLastError();
if (0 < (int)DVar2) {
DVar2 = DVar2 & 0xffff | 0x80070000;
}
LocalFree(lpDst);
}
else {
*param_3 = lpDst;
}
}
}
return DVar2;
}
=========================================
Function at address: 0x180055ed0
Called functions addresses: 0x180056ef0 0x180028d90 0x1800534dc 0xEXTERNAL:000000bc 0x180028070 0xEXTERNAL:000000c0 0xEXTERNAL:00000041 0xEXTERNAL:0000003f 0x180056f54 0xEXTERNAL:00000040 0x180056fb0 0xEXTERNAL:00000177 0x180055de0


void FUN_180055ed0(longlong param_1,longlong *param_2)

{
longlong *plVar1;
int iVar2;
uint uVar3;
uint uVar4;
DWORD DVar5;
LPCWSTR hMem;
LPCWSTR pWVar6;
longlong *plVar7;
undefined auStack_178 [48];
short *local_148;
longlong local_140;
wchar_t local_138 [4];
wchar_t awStack_130 [4];
wchar_t local_128 [2];
wchar_t awStack_124 [2];
wchar_t awStack_120 [2];
wchar_t awStack_11c [2];
wchar_t local_118 [4];
wchar_t local_110 [4];
wchar_t local_108 [4];
wchar_t awStack_100 [4];
wchar_t local_f8 [4];
wchar_t awStack_f0 [4];
wchar_t local_e8 [4];
wchar_t awStack_e0 [4];
wchar_t local_d8 [4];
wchar_t awStack_d0 [4];
wchar_t local_c8 [4];
wchar_t awStack_c0 [4];
wchar_t local_b8 [4];
wchar_t awStack_b0 [4];
wchar_t local_a8 [4];
wchar_t awStack_a0 [4];
wchar_t local_98;
undefined local_88 [80];
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStack_178;
memset(local_88,0,0x44);
local_98 = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x38];
local_148 = (short *)0x0;
hMem = (LPCWSTR)0x0;
local_108[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0];
local_108[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[1];
local_108[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[2];
local_108[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[3];
awStack_100[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[4];
awStack_100[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[5];
awStack_100[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[6];
awStack_100[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[7];
local_e8[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x10];
local_e8[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x11];
local_e8[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x12];
local_e8[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x13];
awStack_e0[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x14];
awStack_e0[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x15];
awStack_e0[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x16];
awStack_e0[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x17];
local_c8[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x20];
local_c8[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x21];
local_c8[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x22];
local_c8[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x23];
awStack_c0[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x24];
awStack_c0[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x25];
awStack_c0[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x26];
awStack_c0[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x27];
local_f8[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[8];
local_f8[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[9];
local_f8[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[10];
local_f8[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0xb];
awStack_f0[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0xc];
awStack_f0[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0xd];
awStack_f0[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0xe];
awStack_f0[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0xf];
local_a8[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x30];
local_a8[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x31];
local_a8[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x32];
local_a8[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x33];
awStack_a0[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x34];
awStack_a0[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x35];
awStack_a0[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x36];
awStack_a0[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x37];
local_d8[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x18];
local_d8[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x19];
local_d8[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x1a];
local_d8[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x1b];
awStack_d0[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x1c];
awStack_d0[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x1d];
awStack_d0[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x1e];
awStack_d0[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x1f];
local_b8[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x28];
local_b8[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x29];
local_b8[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x2a];
local_b8[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x2b];
awStack_b0[0] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x2c];
awStack_b0[1] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x2d];
awStack_b0[2] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x2e];
awStack_b0[3] = u__ALLUSERSPROFILE__Microsoft_Cryp_180085560[0x2f];
local_110[0] = u__SessionTicketKey_key_1800855d8[0x14];
local_110[1] = u__SessionTicketKey_key_1800855d8[0x15];
local_138[0] = u__SessionTicketKey_key_1800855d8[0];
local_138[1] = u__SessionTicketKey_key_1800855d8[1];
local_138[2] = u__SessionTicketKey_key_1800855d8[2];
local_138[3] = u__SessionTicketKey_key_1800855d8[3];
awStack_130[0] = u__SessionTicketKey_key_1800855d8[4];
awStack_130[1] = u__SessionTicketKey_key_1800855d8[5];
awStack_130[2] = u__SessionTicketKey_key_1800855d8[6];
awStack_130[3] = u__SessionTicketKey_key_1800855d8[7];
local_118[0] = u__SessionTicketKey_key_1800855d8[0x10];
local_118[1] = u__SessionTicketKey_key_1800855d8[0x11];
local_118[2] = u__SessionTicketKey_key_1800855d8[0x12];
local_118[3] = u__SessionTicketKey_key_1800855d8[0x13];
local_128[0] = u__SessionTicketKey_key_1800855d8[8];
local_128[1] = u__SessionTicketKey_key_1800855d8[9];
awStack_124[0] = u__SessionTicketKey_key_1800855d8[10];
awStack_124[1] = u__SessionTicketKey_key_1800855d8[0xb];
awStack_120[0] = u__SessionTicketKey_key_1800855d8[0xc];
awStack_120[1] = u__SessionTicketKey_key_1800855d8[0xd];
awStack_11c[0] = u__SessionTicketKey_key_1800855d8[0xe];
awStack_11c[1] = u__SessionTicketKey_key_1800855d8[0xf];
RtlAcquireResourceExclusive(param_1 + 0x30,1);
plVar1 = (longlong *)(param_1 + 0x378);
if (*plVar1 == 0) {
iVar2 = FUN_1800534dc(*(HANDLE *)(param_1 + 0x2f0),local_88);
if ((iVar2 == 0) || (iVar2 = ConvertSidToStringSidW(local_88,&local_148), iVar2 == 0)) {
GetLastError();
goto LAB_1800560ba;
}
local_140 = 0;
if (local_148 == (short *)0x0) goto LAB_1800560ba;
plVar7 = &local_140;
uVar3 = FUN_180056fb0(local_148,0x7fffffff,plVar7);
if ((int)uVar3 < 0) goto LAB_1800560ba;
uVar3 = (int)local_140 * 2 + 0x9c;
hMem = (LPCWSTR)LocalAlloc(0x40,(ulonglong)uVar3);
if ((((hMem == (LPCWSTR)0x0) || ((ulonglong)(uVar3 >> 1) == 0)) ||
(uVar4 = FUN_180056f54(hMem,(ulonglong)(uVar3 >> 1),plVar7,(longlong)local_108),
(int)uVar4 < 0)) ||
(((uVar4 = FUN_180056ef0(hMem,(ulonglong)uVar3,(longlong)local_148), (int)uVar4 < 0 ||
(pWVar6 = hMem, uVar3 = FUN_180056ef0(hMem,(ulonglong)uVar3,(longlong)local_138),
(int)uVar3 < 0)) || (DVar5 = FUN_180055de0(pWVar6,hMem,plVar1), (int)DVar5 < 0))))
goto LAB_1800560ba;
}
*param_2 = *plVar1;
LAB_1800560ba:
RtlReleaseResource(param_1 + 0x30);
if (hMem != (LPCWSTR)0x0) {
LocalFree(hMem);
}
if (local_148 != (short *)0x0) {
LocalFree(local_148);
}
FUN_180028070(local_38 ^ (ulonglong)auStack_178);
return;
}
=========================================
Function at address: 0x180056124
Called functions addresses: 0xEXTERNAL:000000c2 0x1800489ec 0xEXTERNAL:000000c0 0x1800441c4


uint FUN_180056124(longlong param_1,undefined8 *param_2)

{
uint uVar1;
undefined8 uVar2;
undefined4 local_res8 [2];

if (*(int *)(param_1 + 0x1c) == 0) {
uVar1 = 0x8009030e;
}
else {
RtlAcquireResourceShared(param_1 + 0x30,1);
uVar2 = FUN_1800489ec(*(PCCERT_CONTEXT *)(*(longlong *)(param_1 + 0x20) + 0x18),param_2,
local_res8);
if ((int)(uint)uVar2 < 0) {
RtlReleaseResource();
uVar1 = FUN_1800441c4((uint)uVar2);
}
else {
RtlReleaseResource(param_1 + 0x30);
uVar1 = 0;
}
}
return uVar1;
}
=========================================
Function at address: 0x1800561b4
Called functions addresses: 0xEXTERNAL:00000128 0x180041cdc 0xEXTERNAL:00000047 0x180001604 0x180056ff8 0xEXTERNAL:00000041


void FUN_1800561b4(undefined8 *param_1)

{
DWORD DVar1;
int iVar2;
HCERTSTORE pvVar3;
undefined8 *puVar4;
HANDLE pvVar5;
undefined2 uVar6;
int local_res8 [2];

local_res8[0] = 0;
puVar4 = param_1;
if (((((HCERTSTORE)param_1[0x60] != (HCERTSTORE)0x0) && (param_1[0x61] == 0)) &&
(DVar1 = FUN_180056ff8(param_1,(HCERTSTORE)param_1[0x60],param_1 + 0x61), DVar1 != 0)) &&
((puVar4 = DAT_180091000, (undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)))) {
puVar4 = (undefined8 *)DAT_180091000[2];
FUN_180041cdc(puVar4,0xe,&DAT_180082b38,DVar1);
}
if ((((HCERTSTORE)param_1[0x66] != (HCERTSTORE)0x0) && (param_1[0x67] == 0)) &&
((DVar1 = FUN_180056ff8(puVar4,(HCERTSTORE)param_1[0x66],param_1 + 0x67), DVar1 != 0 &&
(((undefined8 **)DAT_180091000 != &DAT_180091000 &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)))))) {
FUN_180041cdc(DAT_180091000[2],0xf,&DAT_180082b38,DVar1);
}
if (param_1[0x68] == 0) {
pvVar5 = (HANDLE)0xa;
pvVar3 = CertOpenStore((LPCSTR)0xa,0,0,0x20000,L"ClientAuthIssuer");
param_1[0x68] = pvVar3;
if (pvVar3 == (HCERTSTORE)0x0) {
DVar1 = GetLastError();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar6 = 0x10;
LAB_1800562ff:
FUN_180041cdc(DAT_180091000[2],uVar6,&DAT_180082b38,DVar1);
}
}
else if ((((param_1[0x69] == 0) &&
(DVar1 = FUN_180056ff8(pvVar5,pvVar3,param_1 + 0x69), DVar1 != 0)) &&
((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar6 = 0x11;
goto LAB_1800562ff;
}
}
if (param_1[0x62] != 0) {
return;
}
iVar2 = FUN_180001604(param_1[0x5e],local_res8);
if (iVar2 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return;
}
FUN_180041cdc(DAT_180091000[2],0x12,&DAT_180082b38,iVar2);
return;
}
pvVar5 = (HANDLE)0xa;
pvVar3 = CertOpenStore((LPCSTR)0xa,0,0,0x18001,L"ROOT");
param_1[0x62] = pvVar3;
if (pvVar3 == (HCERTSTORE)0x0) {
DVar1 = GetLastError();
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_1800563fa;
uVar6 = 0x13;
}
else {
if (((param_1[99] != 0) || (DVar1 = FUN_180056ff8(pvVar5,pvVar3,param_1 + 99), DVar1 == 0)) ||
(((undefined8 **)DAT_180091000 == &DAT_180091000 ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)))) goto LAB_1800563fa;
uVar6 = 0x14;
}
FUN_180041cdc(DAT_180091000[2],uVar6,&DAT_180082b38,DVar1);
LAB_1800563fa:
if (local_res8[0] != 0) {
RevertToSelf();
}
return;
}
=========================================
Function at address: 0x180056428
Called functions addresses: 0xEXTERNAL:00000036 0x180041cdc 0xEXTERNAL:00000047 0x180028d90 0x180001604 0x18000a1f4 0xEXTERNAL:00000163 0x18002a77b 0x180028070 0xEXTERNAL:00000041


void FUN_180056428(longlong param_1,longlong param_2)

{
longlong lVar1;
char cVar2;
int iVar3;
DWORD DVar4;
wchar_t *pwVar5;
longlong lVar6;
void *pvVar8;
longlong lVar9;
uint uVar10;
undefined auStack_478 [32];
uint local_458;
int local_454 [3];
wchar_t local_448 [520];
ulonglong local_38;
longlong lVar7;

local_38 = DAT_180091970 ^ (ulonglong)auStack_478;
memset(local_448,0,0x404);
local_458 = 0x202;
local_454[0] = 0;
iVar3 = FUN_180001604(param_2,local_454);
if (iVar3 == 0) {
cVar2 = GetUserNameExW(0xc,local_448,&local_458);
if (cVar2 == '\0') {
DVar4 = GetLastError();
if (((DVar4 != 0x534) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
DVar4 = GetLastError();
FUN_180041cdc(DAT_180091000[2],10,&DAT_180082b38,DVar4);
}
}
else {
pwVar5 = wcsrchr(local_448,L'\\');
if (pwVar5 != (wchar_t *)0x0) {
lVar9 = -1;
*pwVar5 = L'\0';
lVar7 = -1;
do {
lVar6 = lVar7 + 1;
lVar1 = lVar7 + 2;
lVar7 = lVar6;
} while (pwVar5[lVar1] != L'\0');
uVar10 = ((uint)lVar6 & 0xffff) + 1;
pvVar8 = (void *)FUN_18000a1f4((ulonglong)(uVar10 * 2));
*(void **)(param_1 + 0x368) = pvVar8;
if (pvVar8 != (void *)0x0) {
memcpy(pvVar8,pwVar5 + 1,(ulonglong)uVar10 * 2);
do {
lVar9 = lVar9 + 1;
} while (local_448[lVar9] != L'\0');
local_458 = ((uint)lVar9 & 0xffff) + 1;
pvVar8 = (void *)FUN_18000a1f4((ulonglong)(local_458 * 2));
*(void **)(param_1 + 0x370) = pvVar8;
if (pvVar8 != (void *)0x0) {
memcpy(pvVar8,local_448,(ulonglong)local_458 * 2);
}
}
}
}
}
if (local_454[0] != 0) {
RevertToSelf();
}
FUN_180028070(local_38 ^ (ulonglong)auStack_478);
return;
}
=========================================
Function at address: 0x180056618
Called functions addresses: 0xEXTERNAL:000000c2 0x18005f458 0xEXTERNAL:000000bc 0xEXTERNAL:000000c0 0x18005f83c


undefined8 FUN_180056618(longlong param_1)

{
longlong lVar1;
undefined8 *puVar2;
ulonglong uVar3;
undefined8 *puVar4;

RtlAcquireResourceShared(param_1 + 0x30,1);
puVar4 = *(undefined8 **)(param_1 + 0x20);
while (puVar4 != (undefined8 *)(param_1 + 0x20)) {
lVar1 = *(longlong *)(param_1 + 0x2f0);
puVar2 = (undefined8 *)*puVar4;
RtlAcquireResourceExclusive(puVar4 + 0x44,1);
FUN_18005f458((longlong)(puVar4 + -1));
uVar3 = FUN_18005f83c((longlong)(puVar4 + -1),lVar1);
RtlReleaseResource(uVar3);
puVar4 = puVar2;
}
RtlReleaseResource(param_1 + 0x30);
return 0;
}
=========================================
Function at address: 0x1800566dc
Called functions addresses: 0xEXTERNAL:000000c2 0x18005ff30 0xEXTERNAL:000000c0


undefined8
FUN_1800566dc(longlong param_1,int param_2,uint param_3,longlong param_4,longlong *param_5)

{
undefined8 *puVar1;
undefined8 uVar2;
undefined4 in_register_00000014;
undefined8 uVar3;
undefined8 *puVar4;

uVar3 = 0x80090331;
if (*(int *)(param_1 + 0x1c) != 0) {
RtlAcquireResourceShared
(param_1 + 0x30,CONCAT71((int7)(CONCAT44(in_register_00000014,param_2) >> 8),1));
puVar4 = *(undefined8 **)(param_1 + 0x20);
do {
if (puVar4 == (undefined8 *)(param_1 + 0x20)) goto LAB_180056771;
puVar1 = puVar4 + -1;
puVar4 = (undefined8 *)*puVar4;
uVar2 = FUN_18005ff30((longlong)puVar1,param_2,param_3,param_4,*(uint **)(param_1 + 200),
*(uint *)(param_1 + 0xc4));
} while ((char)uVar2 == '\0');
uVar3 = 0;
*param_5 = (longlong)puVar1;
LAB_180056771:
RtlReleaseResource(param_1 + 0x30);
}
return uVar3;
}
=========================================
Function at address: 0x1800567a8
Called functions addresses: 0xEXTERNAL:000000c2 0xEXTERNAL:00000075 0x180041cb0 0x180055510 0xEXTERNAL:000000c0 0x18001b930


int FUN_1800567a8(longlong param_1,longlong param_2,wchar_t *param_3,undefined8 param_4,char param_5
,longlong param_6,uint *param_7,uint param_8,longlong param_9,char param_10,
longlong param_11,undefined8 *param_12)

{
undefined8 *puVar1;
undefined8 *puVar2;
undefined8 *puVar3;
undefined8 *puVar4;
int iVar5;
undefined8 uVar6;
longlong lVar7;
undefined8 *puVar8;
wchar_t *pwVar9;
uint uVar10;
int local_58;
longlong local_50;

uVar10 = (uint)param_4;
local_50 = 0;
local_58 = 0;
if (param_12 == (undefined8 *)0x0) {
iVar5 = 0x57;
}
else {
*param_12 = 0;
if (*(int *)(param_1 + 0x1c) == 0) {
iVar5 = -0x7ff6fccf;
}
else {
if ((*(byte *)(param_1 + 0x9c) & 0x40) != 0) {
lVar7 = param_2;
pwVar9 = param_3;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
pwVar9 = (wchar_t *)&DAT_180082b38;
lVar7 = 0x25;
FUN_180041cb0(DAT_180091000[2],0x25,&DAT_180082b38);
}
iVar5 = FUN_180055510(param_1,lVar7,pwVar9,param_4);
if (iVar5 != 0) {
return iVar5;
}
}
iVar5 = -0x7ff6fccf;
RtlAcquireResourceShared(param_1 + 0x30,1);
if (param_11 != 0) {
RtlAcquireResourceShared(param_11 + 0x48,1);
if (*(longlong *)(param_11 + 0x150) != 0) {
local_50 = *(longlong *)(param_11 + 0x150) + 0x28;
local_58 = 0x14;
}
}
puVar1 = *(undefined8 **)(param_1 + 0x20);
puVar3 = (undefined8 *)0x0;
puVar4 = (undefined8 *)0x0;
do {
while( true ) {
do {
puVar2 = puVar1;
puVar8 = puVar3;
if (puVar2 == (undefined8 *)(param_1 + 0x20)) goto LAB_1800569ab;
puVar8 = puVar2 + -1;
puVar1 = (undefined8 *)*puVar2;
} while ((local_50 != 0) &&
(((puVar2 + 4 == (undefined8 *)0x0 || (local_58 != 0x14)) ||
(lVar7 = RtlCompareMemory(local_50,puVar2 + 4,0x14), lVar7 != 0x14))));
uVar6 = FUN_18001b930((longlong)puVar8,param_2,param_3,uVar10,param_6,param_7,param_8,
param_9,param_10);
if ((int)uVar6 == 1) break;
if (((int)uVar6 == 2) && (puVar4 == (undefined8 *)0x0)) {
puVar4 = puVar8;
}
}
} while (((puVar3 != (undefined8 *)0x0) && (*(char *)(puVar2 + 9) == param_5)) ||
(iVar5 = 0, puVar3 = puVar8, *(char *)(puVar2 + 9) == param_5));
LAB_1800569ab:
if (param_11 != 0) {
RtlReleaseResource(param_11 + 0x48);
}
RtlReleaseResource(param_1 + 0x30);
if (puVar8 == (undefined8 *)0x0) {
puVar8 = puVar4;
}
*param_12 = puVar8;
}
}
return iVar5;
}
=========================================
Function at address: 0x1800569fc
Called functions addresses: 0x18000909c 0x18000a1f4 0x180041cb0 0x18002a76f 0x18002a787


undefined4 FUN_1800569fc(undefined8 param_1,undefined *param_2,uint *param_3)

{
uint *puVar1;
ulonglong uVar2;
int iVar3;
uint uVar4;
undefined *puVar5;
uint *puVar6;
uint *puVar7;
undefined *puVar8;
ulonglong uVar9;
undefined *puVar10;
undefined *puVar11;
uint uVar12;

if ((param_2 != (undefined *)0x0) && (1 < *param_3)) {
puVar10 = param_2 + *param_3;
iVar3 = 0;
puVar11 = param_2 + 1;
puVar5 = puVar11;
puVar8 = param_2;
while (puVar5 < puVar10) {
iVar3 = iVar3 + 1;
puVar8 = puVar8 + (ulonglong)CONCAT11(*puVar8,*puVar5) + 2;
puVar5 = puVar8 + 1;
}
puVar1 = (uint *)FUN_18000a1f4((ulonglong)(uint)(iVar3 << 4));
if (puVar1 == (uint *)0x0) {
return 0xe;
}
puVar5 = param_2;
puVar8 = param_2;
uVar9 = 0;
if (puVar11 < puVar10) {
do {
uVar4 = CONCAT11(*puVar5,*puVar11) + 2;
uVar12 = (int)uVar9 + 1;
uVar2 = (ulonglong)uVar12;
*(undefined **)(puVar1 + uVar9 * 4 + 2) = puVar5;
puVar1[uVar9 * 4] = uVar4;
puVar5 = puVar5 + uVar4;
puVar11 = puVar5 + 1;
uVar9 = uVar2;
} while (puVar11 < puVar10);
if (uVar12 != 0) {
puVar7 = puVar1 + 2;
uVar4 = 1;
do {
if ((*(longlong *)puVar7 != 0) && (uVar4 < uVar12)) {
puVar6 = puVar1 + (ulonglong)uVar4 * 4 + 2;
uVar9 = (ulonglong)(uVar12 - uVar4);
do {
if (((*(void **)puVar6 != (void *)0x0) && (puVar7[-2] == puVar6[-2])) &&
(iVar3 = memcmp(*(void **)puVar7,*(void **)puVar6,(ulonglong)puVar6[-2]),
iVar3 == 0)) {
puVar6[0] = 0;
puVar6[1] = 0;
}
puVar6 = puVar6 + 4;
uVar9 = uVar9 - 1;
} while (uVar9 != 0);
}
uVar4 = uVar4 + 1;
puVar7 = puVar7 + 4;
uVar2 = uVar2 - 1;
} while (uVar2 != 0);
uVar4 = 0;
puVar7 = puVar1;
puVar11 = param_2;
do {
if (*(longlong *)(puVar7 + 2) != 0) {
if (puVar8 != puVar11) {
if (puVar10 < puVar11 + *puVar7) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x22,&DAT_180082b38);
}
FUN_18000909c(puVar1);
return 0x54f;
}
memmove(puVar8,puVar11,(ulonglong)*puVar7);
}
puVar8 = puVar8 + *puVar7;
}
uVar4 = uVar4 + 1;
puVar11 = puVar11 + *puVar7;
puVar7 = puVar7 + 4;
} while (uVar4 < uVar12);
}
}
*param_3 = (int)puVar8 - (int)param_2;
FUN_18000909c(puVar1);
}
return 0;
}
=========================================
Function at address: 0x180056bf0
Called functions addresses: 0x180041cdc 0x180054f60 0x180028d90 0xEXTERNAL:00000158 0xEXTERNAL:00000129 0xEXTERNAL:00000157 0x180055b18 0x180028070 0xEXTERNAL:00000126 0x180054298 0x180010cf8 0xEXTERNAL:00000041


void FUN_180056bf0(longlong param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
int iVar1;
DWORD DVar2;
longlong lVar3;
undefined8 uVar4;
undefined2 uVar5;
ulonglong uVar6;
uint *puVar7;
undefined8 uVar8;
undefined auStackY_c8 [32];
undefined local_98 [4];
uint local_94;
uint *local_90;
HCERTSTORE local_78;
_EVENT_DATA_DESCRIPTOR local_28;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_c8;
uVar8 = 0x70;
memset(local_98,0,0x70);
uVar4 = *(undefined8 *)(param_1 + 800);
iVar1 = CryptObjectLocatorIsChanged();
if (iVar1 == 0) goto LAB_180056db8;
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar4,(PCEVENT_DESCRIPTOR)&DAT_180084c10,uVar8,param_4,&local_28);
}
uVar4 = *(undefined8 *)(param_1 + 800);
lVar3 = CryptObjectLocatorGetUpdated();
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar4,(PCEVENT_DESCRIPTOR)&DAT_180084c00,uVar8,param_4,&local_28);
}
if (lVar3 == 0) {
DVar2 = GetLastError();
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180056db8;
uVar5 = 0x19;
}
else {
CryptObjectLocatorFree(*(undefined8 *)(param_1 + 800));
*(longlong *)(param_1 + 800) = lVar3;
DVar2 = FUN_180054298(lVar3,(longlong)local_98,uVar8,param_4);
if (DVar2 == 0) {
if (local_94 != 0) {
uVar6 = (ulonglong)local_94;
puVar7 = local_90;
do {
uVar4 = FUN_180055b18(param_1,puVar7);
if ((((int)uVar4 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1b,&DAT_180082b38,(int)uVar4);
}
puVar7 = puVar7 + 0xe;
uVar6 = uVar6 - 1;
} while (uVar6 != 0);
}
if (local_78 != (HCERTSTORE)0x0) {
CertCloseStore(local_78,0);
}
FUN_180010cf8(local_98,'\0');
goto LAB_180056db8;
}
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_180056db8;
uVar5 = 0x1a;
}
FUN_180041cdc(DAT_180091000[2],uVar5,&DAT_180082b38,DVar2);
LAB_180056db8:
FUN_180028070(local_18 ^ (ulonglong)auStackY_c8);
return;
}
=========================================
Function at address: 0x180056de8
Called functions addresses: 0x180041cdc 0x180053810 0xEXTERNAL:0000012b 0x180055b18


undefined8 FUN_180056de8(longlong param_1)

{
undefined8 *puVar1;
PCCERT_CONTEXT pCertContext;
int iVar2;
undefined8 uVar3;
undefined8 *puVar4;
PCCERT_CONTEXT local_res8;
PCCERT_CONTEXT local_48;
undefined8 uStack_40;
undefined8 local_38;
undefined8 uStack_30;
undefined8 local_28;
undefined8 uStack_20;
undefined8 local_18;

local_res8 = (PCCERT_CONTEXT)0x0;
puVar1 = *(undefined8 **)(param_1 + 0x20);
while (puVar4 = puVar1, puVar4 != (undefined8 *)(param_1 + 0x20)) {
puVar1 = (undefined8 *)*puVar4;
if (((byte)*(undefined4 *)(puVar4 + 2) & 0x21) == 0x20) {
iVar2 = FUN_180053810(*(HCERTSTORE *)(DAT_1800927e8 + 0x48),(PCCERT_CONTEXT)puVar4[3],'\x01',
&local_res8);
pCertContext = local_res8;
if (iVar2 != 0) {
*(uint *)(puVar4 + 2) = *(uint *)(puVar4 + 2) | 1;
uStack_40 = 0;
local_48 = local_res8;
local_18 = 1;
local_38 = 0;
uStack_30 = 0;
local_28 = 0;
uStack_20 = 0;
uVar3 = FUN_180055b18(param_1,(uint *)&local_48);
if ((((int)uVar3 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1c,&DAT_180082b38,(int)uVar3);
}
CertFreeCertificateContext(pCertContext);
}
}
}
return 0;
}
=========================================
Function at address: 0x180056ef0
Called functions addresses: 0x180056f54 0x180056fb0


uint FUN_180056ef0(short *param_1,ulonglong param_2,longlong param_3)

{
uint uVar1;
longlong *plVar2;
ulonglong uVar3;
longlong local_res10 [3];

uVar3 = param_2 >> 1;
if (uVar3 - 1 < 0x7fffffff) {
plVar2 = local_res10;
uVar1 = FUN_180056fb0(param_1,uVar3,plVar2);
if (-1 < (int)uVar1) {
uVar1 = FUN_180056f54(param_1 + local_res10[0],uVar3 - local_res10[0],plVar2,param_3);
}
}
else {
uVar1 = 0x80070057;
}
return uVar1;
}
=========================================
Function at address: 0x180056f54
Called functions addresses: None


uint FUN_180056f54(short *param_1,longlong param_2,undefined8 param_3,longlong param_4)

{
short sVar1;
longlong lVar2;
short *psVar3;
longlong lVar4;

if (param_2 != 0) {
lVar2 = 0x7ffffffe;
lVar4 = param_4 - (longlong)param_1;
do {
if ((lVar2 == 0) || (sVar1 = *(short *)(lVar4 + (longlong)param_1), sVar1 == 0)) break;
*param_1 = sVar1;
lVar2 = lVar2 + -1;
param_1 = param_1 + 1;
param_2 = param_2 + -1;
} while (param_2 != 0);
}
psVar3 = param_1 + -1;
if (param_2 != 0) {
psVar3 = param_1;
}
*psVar3 = 0;
return ~-(uint)(param_2 != 0) & 0x8007007a;
}
=========================================
Function at address: 0x180056fb0
Called functions addresses: None


uint FUN_180056fb0(short *param_1,longlong param_2,longlong *param_3)

{
uint uVar1;
longlong lVar2;

lVar2 = param_2;
if (param_2 != 0) {
do {
if (*param_1 == 0) break;
param_1 = param_1 + 1;
lVar2 = lVar2 + -1;
} while (lVar2 != 0);
}
uVar1 = ~-(uint)(lVar2 != 0) & 0x80070057;
if (param_3 != (longlong *)0x0) {
if (lVar2 != 0) {
*param_3 = param_2 - lVar2;
return uVar1;
}
*param_3 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x180056ff8
Called functions addresses: 0xEXTERNAL:00000066 0xEXTERNAL:00000041 0xEXTERNAL:00000062 0xEXTERNAL:00000140


DWORD FUN_180056ff8(HANDLE param_1,HCERTSTORE param_2,undefined8 *param_3)

{
DWORD DVar1;
BOOL BVar2;
HANDLE local_res8;

if ((param_2 == (HCERTSTORE)0x0) || (param_3 == (undefined8 *)0x0)) {
DVar1 = 0x57;
}
else {
local_res8 = param_1;
local_res8 = CreateEventA((LPSECURITY_ATTRIBUTES)0x0,0,0,(LPCSTR)0x0);
if (local_res8 == (HANDLE)0x0) {
DVar1 = GetLastError();
}
else {
BVar2 = CertControlStore(param_2,0,2,&local_res8);
if (BVar2 == 0) {
DVar1 = GetLastError();
CloseHandle(local_res8);
}
else {
*param_3 = local_res8;
DVar1 = 0;
}
}
}
return DVar1;
}
=========================================
Function at address: 0x1800570b0
Called functions addresses: 0xEXTERNAL:00000062 0xEXTERNAL:00000140


void FUN_1800570b0(undefined8 param_1,HCERTSTORE param_2,longlong *param_3)

{
if (((param_2 != (HCERTSTORE)0x0) && (param_3 != (longlong *)0x0)) && (*param_3 != 0)) {
CertControlStore(param_2,0,5,param_3);
CloseHandle((HANDLE)*param_3);
*param_3 = 0;
}
return;
}
=========================================
Function at address: 0x180057104
Called functions addresses: 0x180058a18 0x180055730 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0x180055318


ulonglong FUN_180057104(undefined8 *param_1)

{
undefined8 *puVar1;
ulonglong uVar2;

FUN_180058a18(DAT_1800927e8);
FUN_180055318(param_1);
if ((param_1[0x6c] == 0) || ((*(byte *)((longlong)param_1 + 0x9c) & 0x10) != 0)) {
puVar1 = param_1 + 6;
RtlAcquireResourceExclusive(puVar1,1);
if ((param_1[0x6c] == 0) || ((*(byte *)((longlong)param_1 + 0x9c) & 0x10) != 0)) {
uVar2 = FUN_180055730((longlong)param_1);
if ((int)uVar2 != 0) {
RtlReleaseResource(puVar1);
return uVar2 & 0xffffffff;
}
}
RtlReleaseResource(puVar1);
}
return 0;
}
=========================================
Function at address: 0x1800571a4
Called functions addresses: 0x1800579d8 0xEXTERNAL:00000041 0x180041d20 0x180041cdc 0xEXTERNAL:00000129 0x1800586fc 0x180041cb0 0x18002a7c0 0xEXTERNAL:00000128 0x180001604 0xEXTERNAL:00000047 0x18000404c 0x18000a1f4 0x180053588 0x18000909c


DWORD FUN_1800571a4(longlong *param_1,int param_2)

{
longlong *plVar1;
undefined uVar2;
undefined uVar3;
longlong lVar4;
DWORD DVar5;
int iVar6;
undefined8 uVar7;
undefined *puVar8;
uint *puVar9;
HCERTSTORE hCertStore;
undefined *puVar10;
uint *puVar11;
undefined *puVar12;
char cVar13;
ulonglong uVar14;
uint uVar15;
uint uVar16;
char local_res8 [8];
int local_res18 [2];
undefined8 local_68;
char *pcStack_60;
undefined8 local_58;
ulonglong uStack_50;
uint *local_48;
undefined8 uStack_40;
undefined8 local_38;

uVar15 = 0;
puVar9 = (uint *)0x0;
local_res18[0] = 0;
local_res8[0] = '\0';
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180085618);
}
DVar5 = FUN_180001604(*(longlong *)(param_1[10] + 0x2f0),local_res18);
if (DVar5 != 0) goto LAB_180057593;
cVar13 = '\0';
if (local_res18[0] != 0) {
iVar6 = FUN_180053588(local_res8);
if (((iVar6 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x15,&DAT_180085618,iVar6);
}
RevertToSelf();
local_res18[0] = 0;
cVar13 = local_res8[0];
}
if (*(int *)(param_1 + 0x83) == 0) {

DVar5 = FUN_1800586fc((longlong)param_1,uVar7);
FUN_18000404c((longlong)param_1,1);
if (-1 < (int)DVar5) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180085618);
}
goto LAB_180057593;
}
}
if (param_2 != 0) {
DVar5 = 0x90320;
goto LAB_180057593;
}
lVar4 = param_1[0x70];
uVar16 = uVar15;
if ((lVar4 != 0) && (uVar16 = 0, 2 < *(uint *)(param_1 + 0x6f))) {
puVar12 = (undefined *)(lVar4 + 2);
uVar16 = uVar15;
if ((undefined *)(lVar4 + 3U) < puVar12 + (*(uint *)(param_1 + 0x6f) - 2)) {
puVar8 = (undefined *)(lVar4 + 3);
puVar10 = puVar12;
do {
uVar16 = uVar16 + 1;
puVar10 = puVar10 + (ulonglong)CONCAT11(*puVar10,*puVar8) + 2;
puVar8 = puVar10 + 1;
} while (puVar8 < puVar12 + (*(uint *)(param_1 + 0x6f) - 2));
}
puVar9 = (uint *)FUN_18000a1f4((ulonglong)(uVar16 << 4));
if (puVar9 == (uint *)0x0) {
DVar5 = 0x80090300;
goto LAB_180057593;
}
if (uVar16 != 0) {
uVar14 = (ulonglong)uVar16;
puVar11 = puVar9;
do {
*(undefined **)(puVar11 + 2) = puVar12 + 2;
uVar2 = *puVar12;
uVar3 = puVar12[1];
*puVar11 = (uint)CONCAT11(uVar2,uVar3);
puVar12 = puVar12 + (CONCAT11(uVar2,uVar3) + 2);
puVar11 = puVar11 + 4;
uVar14 = uVar14 - 1;
} while (uVar14 != 0);
}
}
DVar5 = FUN_180001604(*(longlong *)(param_1[10] + 0x2f0),local_res18);
if (DVar5 != 0) goto LAB_180057593;
hCertStore = CertOpenStore((LPCSTR)0xa,1,0,(-(uint)(cVar13 != '\0') & 0x10000) + 0x1c004,
&DAT_18008275c);
if (hCertStore == (HCERTSTORE)0x0) {
DVar5 = GetLastError();
goto LAB_180057593;
}
local_38 = 0;
pcStack_60 = "1.3.6.1.5.5.7.3.2";
iVar6 = *(int *)(param_1 + 0x83);
local_58 = 0;
uStack_50 = (ulonglong)uVar16;
plVar1 = param_1 + 0x82;
local_68 = 0x38;
uStack_40 = 0;
local_48 = puVar9;
if (iVar6 == 1) {
DVar5 = FUN_1800579d8((longlong)param_1,hCertStore,plVar1,&local_68,local_res18,1,1);
if ((int)DVar5 < 0) {
FUN_18000404c((longlong)param_1,2);
iVar6 = *(int *)(param_1 + 0x83);
goto LAB_1800574a9;
}
}
else {
LAB_1800574a9:
if (iVar6 == 2) {
DVar5 = FUN_1800579d8((longlong)param_1,hCertStore,plVar1,&local_68,local_res18,1,0);
if (-1 < (int)DVar5) goto LAB_18005757b;
FUN_18000404c((longlong)param_1,3);
iVar6 = *(int *)(param_1 + 0x83);
}
if (iVar6 == 3) {
DVar5 = FUN_1800579d8((longlong)param_1,hCertStore,plVar1,&local_68,local_res18,0,1);
if (-1 < (int)DVar5) goto LAB_18005757b;
FUN_18000404c((longlong)param_1,4);
iVar6 = *(int *)(param_1 + 0x83);
}
if (iVar6 == 4) {
DVar5 = FUN_1800579d8((longlong)param_1,hCertStore,plVar1,&local_68,local_res18,0,0);
if (-1 < (int)DVar5) goto LAB_18005757b;
FUN_18000404c((longlong)param_1,5);
}
DVar5 = 0x90320;
}
LAB_18005757b:
CertCloseStore(hCertStore,0);
LAB_180057593:
if (local_res18[0] != 0) {
RevertToSelf();
}
if (puVar9 != (uint *)0x0) {
FUN_18000909c(puVar9);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x17,&DAT_180085618,DVar5);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (DVar5 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x18,&DAT_180085618,DVar5,(char)DVar5);
}
}
return DVar5;
}
=========================================
Function at address: 0x180057640
Called functions addresses: 0x180061340 0x180011434 0x18005e8a8 0x180041cb0 0x18002a7c0 0x18005ff30 0x18000a1f4 0x180041d20 0x18005e6d0


int FUN_180057640(longlong param_1,longlong param_2)

{
char cVar1;
char cVar2;
uint uVar3;
longlong lVar4;
char *pcVar5;
longlong lVar6;
int iVar7;
int iVar8;
char *pcVar9;
int *piVar10;
undefined8 *puVar11;
undefined8 uVar12;
uint uVar13;
undefined **ppuVar14;
undefined7 in_stack_ffffffffffffff79;
undefined8 local_68;
longlong lStack_60;
longlong local_58 [8];

uVar3 = *(uint *)(param_1 + 0x40);
lVar4 = *(longlong *)(*(longlong *)(param_1 + 0x50) + 0x2f0);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180085618);
}
uVar13 = 0;
ppuVar14 = &PTR_s_1_2_840_113549_1_1_1_18007d750;
pcVar5 = *(char **)(*(longlong *)(param_2 + 0x18) + 0x60);
do {
pcVar9 = pcVar5;
do {
cVar1 = *pcVar9;
cVar2 = pcVar9[(longlong)*ppuVar14 - (longlong)pcVar5];
if (cVar1 != cVar2) break;
pcVar9 = pcVar9 + 1;
} while (cVar2 != '\0');
if (cVar1 == cVar2) {
iVar8 = (&DAT_18007d75c)[(ulonglong)uVar13 * 4];
goto LAB_1800576f5;
}
uVar13 = uVar13 + 1;
ppuVar14 = ppuVar14 + 2;
} while (uVar13 < 8);
iVar8 = 0;
LAB_1800576f5:
uVar13 = 0;
if (*(ushort *)(param_1 + 0x542) != 0) {
piVar10 = (int *)(param_1 + 0x544);
do {
if (*piVar10 == iVar8) {
lVar6 = *(longlong *)(param_1 + 0x50);
if (lVar6 == 0) {
iVar8 = -0x7ff6fcfc;
goto LAB_180057721;
}
puVar11 = (undefined8 *)FUN_18000a1f4(0x498);
if (puVar11 != (undefined8 *)0x0) {
puVar11 = FUN_18005e6d0(puVar11,(*(uint *)(param_1 + 0x40) & 0x40051555) != 0,
*(undefined *)(param_1 + 0x10a),0);
if (puVar11 != (undefined8 *)0x0) {
local_58[6] = 0;
local_58[1] = 0;
local_58[2] = 0;
local_58[3] = 0;
local_58[4] = 0;
local_58[5] = 0;
local_58[0] = param_2;
iVar8 = FUN_18005e8a8((ulonglong)puVar11,*(undefined4 *)(lVar6 + 0xd4),lVar6 + 0xd8,
lVar4,(uint *)local_58,*(uint *)(lVar6 + 0x9c) >> 4 & 8,
CONCAT71(in_stack_ffffffffffffff79,1),0,(uint *)0x0,0);
if (iVar8 == 0) {
uVar12 = FUN_18005ff30((longlong)puVar11,*(int *)((longlong)puVar11 + 0x84),
*(uint *)(param_1 + 0x40),
-(ulonglong)((uVar3 & 0x82800) != 0) & param_1 + 0x1feU,
*(uint **)(lVar6 + 200),*(uint *)(lVar6 + 0xc4));
if ((char)uVar12 != '\0') {
FUN_180061340(param_1,puVar11,'\x01');
iVar8 = 0;
goto LAB_180057775;
}
iVar8 = -0x7ff6fcf3;
}

goto LAB_180057721;
}
}
iVar8 = 0xe;
goto LAB_180057721;
}
uVar13 = uVar13 + 1;
piVar10 = piVar10 + 1;
} while (uVar13 < *(ushort *)(param_1 + 0x542));
}
iVar8 = -0x7ff6fcf3;
LAB_180057721:
if (*(char *)(param_1 + 0x10a) != '\0') {
local_68 = 0;
lStack_60 = 0;
if (DAT_180092620 != 0) {

if (iVar7 == 0) {
FUN_180011434(lStack_60);
}
}
}
LAB_180057775:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar8 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0xb,&DAT_180085618,iVar8,(char)iVar8);
}
return iVar8;
}
=========================================
Function at address: 0x18005792c
Called functions addresses: 0xEXTERNAL:00000143 0xEXTERNAL:0000014e 0x180028070


void FUN_18005792c(longlong param_1)

{
PCERT_EXTENSION p_Var1;
undefined auStackY_68 [32];
DWORD local_28 [2];
undefined8 local_20;
undefined4 local_18;
ulonglong local_10;

local_10 = DAT_180091970 ^ (ulonglong)auStackY_68;
p_Var1 = CertFindExtension("2.5.29.19",*(DWORD *)(*(longlong *)(param_1 + 0x18) + 0xc0),
*(CERT_EXTENSION **)(*(longlong *)(param_1 + 0x18) + 200));
if (p_Var1 != (PCERT_EXTENSION)0x0) {
local_20 = 0;
local_18 = 0;
local_28[0] = 0xc;
CryptDecodeObject(1,(LPCSTR)0xf,(p_Var1->Value).pbData,(p_Var1->Value).cbData,0,&local_20,
local_28);
}
FUN_180028070(local_10 ^ (ulonglong)auStackY_68);
return;
}
=========================================
Function at address: 0x1800579d8
Called functions addresses: 0x180001674 0x180054f60 0x180058598 0xEXTERNAL:00000041 0x180028070 0x180041d20 0x180057640 0x180041cdc 0x180041cb0 0xEXTERNAL:00000146 0x180001604 0xEXTERNAL:00000047 0x1800544b4 0xEXTERNAL:0000014c 0xEXTERNAL:00000148


void FUN_1800579d8(longlong param_1,HCERTSTORE param_2,undefined8 *param_3,void *param_4,
int *param_5,int param_6,int param_7)

{
PCERT_SIMPLE_CHAIN p_Var1;
PCCERT_CONTEXT pCVar2;
int iVar3;
BOOL BVar4;
DWORD DVar5;
undefined8 uVar6;
undefined2 uVar7;
uint uVar8;
ulonglong uVar9;
PCCERT_CHAIN_CONTEXT pPrevChainContext;
undefined8 uVar10;
PCERT_CHAIN_POLICY_PARA pPolicyPara;
int *piVar11;
PCERT_CHAIN_POLICY_STATUS pPolicyStatus;
undefined auStackY_108 [32];
int local_d8;
int local_d4;
HCERTSTORE local_d0;
_CERT_CHAIN_POLICY_PARA local_c8;
undefined4 local_b8;
undefined4 local_b4;
undefined4 local_b0;
undefined4 local_ac;
undefined8 local_a8;
_CERT_CHAIN_POLICY_STATUS local_a0;
_EVENT_DATA_DESCRIPTOR local_88;
_EVENT_DATA_DESCRIPTOR local_78;
_EVENT_DATA_DESCRIPTOR local_68;
ulonglong local_58;

local_58 = DAT_180091970 ^ (ulonglong)auStackY_108;
pPrevChainContext = (PCCERT_CHAIN_CONTEXT)0x0;
local_d0 = param_2;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x10,&DAT_180085618);
}
if ((((param_3 == (undefined8 *)0x0) || (param_5 == (int *)0x0)) || (param_1 == 0)) ||
(param_4 == (void *)0x0)) {
iVar3 = 0x54f;
}
else {
if (*param_5 == 0) {
iVar3 = FUN_180001604(*(longlong *)(*(longlong *)(param_1 + 0x50) + 0x2f0),param_5);
if (iVar3 != 0) {
pPrevChainContext = (PCCERT_CHAIN_CONTEXT)0x0;
if (iVar3 < 0) {
LAB_180057cfa:
if (pPrevChainContext != (PCCERT_CHAIN_CONTEXT)0x0) {
CertFreeCertificateChain(pPrevChainContext);
pPrevChainContext = (PCCERT_CHAIN_CONTEXT)0x0;
}
}
goto LAB_180057d17;
}
}
pPrevChainContext = (PCCERT_CHAIN_CONTEXT)*param_3;
LAB_180057cc5:
do {
do {
do {
do {
uVar6 = 1;
pPrevChainContext = CertFindChainInStore(param_2,1,0,1,param_4,pPrevChainContext);
if (pPrevChainContext == (PCCERT_CHAIN_CONTEXT)0x0) {
iVar3 = -0x7ff6fce0;
goto LAB_180057d17;
}
uVar9 = 0;
local_d8 = 0;
p_Var1 = *pPrevChainContext->rgpChain;
param_2 = local_d0;
} while (p_Var1->cElement == 0);
do {
piVar11 = &local_d8;
uVar10 = 1;
iVar3 = FUN_1800544b4(p_Var1->rgpElement[uVar9]->pCertContext,uVar6,1,piVar11);
if ((iVar3 != 0) || (local_d8 == 0)) {
iVar3 = 0;
break;
}
uVar8 = (int)uVar9 + 1;
uVar9 = (ulonglong)uVar8;
iVar3 = local_d8;
} while (uVar8 < p_Var1->cElement);
param_2 = local_d0;
} while (iVar3 == 0);
local_ac = 0;
local_b0 = 0;
local_a8 = 0;
local_a0.pvExtraPolicyStatus = (void *)0x0;
local_c8.pvExtraPolicyPara = &local_b8;
local_a0.lChainIndex = 0;
local_a0.lElementIndex = 0;
local_b8 = 0x18;
local_a0.cbSize = 0x18;
local_a0.dwError = 0;
local_c8.dwFlags = 0x30;
if (param_6 == 0) {
local_c8.dwFlags = 0x37;
}
local_b4 = 1;
local_c8.cbSize = 0x10;
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(0x37,(PCEVENT_DESCRIPTOR)&DAT_180084c70,uVar10,piVar11,&local_88);
}
pPolicyStatus = &local_a0;
pPolicyPara = &local_c8;
uVar6 = 4;
BVar4 = CertVerifyCertificateChainPolicy
((LPCSTR)0x4,pPrevChainContext,pPolicyPara,pPolicyStatus);
if (BVar4 == 0) {
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar6,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,
&local_78);
}
param_2 = local_d0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
DVar5 = GetLastError();
uVar7 = 0x11;
LAB_180057c2d:
FUN_180041cdc(DAT_180091000[2],uVar7,&DAT_180085618,DVar5);
param_2 = local_d0;
}
goto LAB_180057cc5;
}
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar6,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,&local_68
);
}
DVar5 = FUN_180001674(local_a0.dwError,0,0,(undefined *)0x0);
if (DVar5 != 0) {
param_2 = local_d0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
uVar7 = 0x12;
goto LAB_180057c2d;
}
goto LAB_180057cc5;
}
if (((pPrevChainContext->cChain == 0) ||
(p_Var1 = *pPrevChainContext->rgpChain, p_Var1 == (PCERT_SIMPLE_CHAIN)0x0)) ||
((p_Var1->cElement == 0 || (p_Var1->rgpElement == (PCERT_CHAIN_ELEMENT *)0x0)))) {
iVar3 = -0x7ff6fcfc;
goto LAB_180057cfa;
}
pCVar2 = (*p_Var1->rgpElement)->pCertContext;
} while ((param_7 != 0) &&
(FUN_180058598(pCVar2,&local_d4), param_2 = local_d0, local_d4 != 2));
if (*param_5 == 1) {
RevertToSelf();
*param_5 = 0;
}
iVar3 = FUN_180057640(param_1,(longlong)pCVar2);
param_2 = local_d0;
} while (iVar3 < 0);
}
LAB_180057d17:
*param_3 = pPrevChainContext;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar3 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x13,&DAT_180085618,iVar3,(char)iVar3);
}
FUN_180028070(local_58 ^ (ulonglong)auStackY_108);
return;
}
=========================================
Function at address: 0x180057d84
Called functions addresses: 0x180001674 0x180054f60 0x180010674 0xEXTERNAL:00000041 0xEXTERNAL:0000012c 0x180028070 0x18005792c 0x180041d20 0x180041d70 0xEXTERNAL:000000c8 0x180041cdc 0x180045408 0xEXTERNAL:00000129 0x180041cb0 0xEXTERNAL:00000145 0xEXTERNAL:000000a3 0xEXTERNAL:00000087 0xEXTERNAL:00000146 0xEXTERNAL:00000128 0x180028d90 0xEXTERNAL:0000012b 0xEXTERNAL:0000014c 0x18000a1f4 0x18000909c


void FUN_180057d84(undefined8 *param_1,uint param_2,PCERT_CHAIN_POLICY_STATUS param_3,
longlong param_4,uint param_5,longlong param_6)

{
BOOL BVar1;
DWORD DVar2;
uint uVar3;
int iVar4;
PCCERT_CONTEXT lpBuffer;
_CERT_CHAIN_PARA *_Dst;
undefined8 uVar5;
undefined2 uVar6;
short sVar7;
int iVar8;
PCCERT_CONTEXT pCertContext;
PCCERT_CONTEXT pPrevCertContext;
undefined8 uVar9;
PCERT_CHAIN_POLICY_PARA pPolicyPara;
PCERT_CHAIN_POLICY_STATUS pPolicyStatus;
PCCERT_CONTEXT hCertStore;
PCCERT_CONTEXT pCVar10;
undefined auStackY_278 [32];
DWORD local_238 [2];
PCCERT_CHAIN_CONTEXT local_230;
uint local_228;
longlong local_220;
PCERT_CHAIN_POLICY_STATUS local_218 [2];
_CERT_CHAIN_POLICY_PARA local_208;
undefined4 local_1f8;
undefined4 local_1f4;
undefined4 local_1f0;
undefined4 local_1ec;
PCCERT_CONTEXT local_1e8;
_CERT_CHAIN_POLICY_STATUS local_1e0;
PCCERT_CONTEXT local_1c8;
undefined8 uStack_1c0;
undefined8 local_1b8;
undefined8 uStack_1b0;
undefined8 local_1a8;
undefined8 uStack_1a0;
undefined8 local_198;
_CERT_CHAIN_PARA local_188 [3];
uint local_128 [2];
PCCERT_CONTEXT *local_120;
undefined local_118 [96];
char *local_b8;
char *local_b0;
char *local_a8;
_EVENT_DATA_DESCRIPTOR local_a0;
_EVENT_DATA_DESCRIPTOR local_90;
_EVENT_DATA_DESCRIPTOR local_80;
_EVENT_DATA_DESCRIPTOR local_70;
_EVENT_DATA_DESCRIPTOR local_60;
_EVENT_DATA_DESCRIPTOR local_50;
ulonglong local_40;

local_40 = DAT_180091970 ^ (ulonglong)auStackY_278;
pCertContext = (PCCERT_CONTEXT)0x0;
local_b8 = "1.3.6.1.5.5.7.3.1";
local_b0 = "1.3.6.1.4.1.311.10.3.3";
local_a8 = "2.16.840.1.113730.4.1";
pPrevCertContext = (PCCERT_CONTEXT)0x0;
hCertStore = (PCCERT_CONTEXT)0x0;
local_230 = (PCCERT_CHAIN_CONTEXT)0x0;
local_228 = param_2;
local_220 = param_4;
local_218[0] = param_3;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x19,&DAT_180085618);
}
local_238[0] = 0;
BVar1 = GetComputerNameExW(ComputerNameDnsFullyQualified,(LPWSTR)0x0,local_238);
if ((BVar1 == 0) && (DVar2 = GetLastError(), DVar2 != 0xea)) {
lpBuffer = pCertContext;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(lpBuffer = (PCCERT_CONTEXT)0x0, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar2 = GetLastError();
uVar6 = 0x1a;
lpBuffer = pCertContext;
LAB_180057e87:
FUN_180041cdc(DAT_180091000[2],uVar6,&DAT_180085618,DVar2);
}
LAB_180057ea1:
DVar2 = 0x80090322;
pPrevCertContext = pCertContext;
hCertStore = pCertContext;
LAB_18005847c:
if ((DAT_1800919b0 & 1) != 0) {
RtlInitUnicodeString(local_218,param_6);
FUN_180045408((ushort *)&DAT_180085080,0x180084eb4,(ulonglong)param_5,local_218);
}
pCertContext = pPrevCertContext;
if (lpBuffer == (PCCERT_CONTEXT)0x0) goto LAB_1800584c6;
}
else {
lpBuffer = (PCCERT_CONTEXT)FUN_18000a1f4((ulonglong)(local_238[0] * 2));
if (lpBuffer == (PCCERT_CONTEXT)0x0) {
DVar2 = 0x80090300;
goto LAB_18005847c;
}
BVar1 = GetComputerNameExW(ComputerNameDnsFullyQualified,(LPWSTR)lpBuffer,local_238);
if (BVar1 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar2 = GetLastError();
uVar6 = 0x1b;
goto LAB_180057e87;
}
goto LAB_180057ea1;
}
local_238[0] = lstrlenW((LPCWSTR)lpBuffer);
if ((local_238[0] != 0) &&
(*(wchar_t *)((longlong)&lpBuffer->dwCertEncodingType + (ulonglong)(local_238[0] - 1) * 2) ==
L'.')) {
*(wchar_t *)((longlong)&lpBuffer->dwCertEncodingType + (ulonglong)(local_238[0] - 1) * 2) =
L'\0';
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d70(DAT_180091000[2],0x1c,&DAT_180085618,(wchar_t *)lpBuffer);
}
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)0x2c000;
hCertStore = (PCCERT_CONTEXT)CertOpenStore((LPCSTR)0xa,1,0,0x2c000,&DAT_18008275c);
pCVar10 = pCertContext;
if (hCertStore != (PCCERT_CONTEXT)0x0) {
do {
pPrevCertContext = (PCCERT_CONTEXT)0x0;
LAB_180058451:
pPrevCertContext = CertEnumCertificatesInStore(hCertStore,pPrevCertContext);
iVar8 = (int)pCertContext;
if (pPrevCertContext != (PCCERT_CONTEXT)0x0) {
_Dst = local_188;
uVar5 = 0x60;
memset(_Dst,0,0x60);
local_188[0].RequestedUsage.Usage.rgpszUsageIdentifier = &local_b8;
local_188[0].cbSize = 0x60;
local_188[0].RequestedUsage.dwType = 1;
local_188[0].RequestedUsage.Usage.cUsageIdentifier = 3;
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(_Dst,(PCEVENT_DESCRIPTOR)&DAT_180084c90,uVar5,pPolicyStatus,&local_a0);
}
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)0x0;
uVar9 = 0;
uVar5 = 0;
BVar1 = CertGetCertificateChain
((HCERTCHAINENGINE)0x0,pPrevCertContext,(LPFILETIME)0x0,(HCERTSTORE)0x0,
local_188,0x90000004,(LPVOID)0x0,&local_230);
if (BVar1 != 0) {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084c80,uVar9,pPolicyStatus,&local_80);
}
local_1ec = 0;
local_1f0 = 0;
local_1e0.pvExtraPolicyStatus = (void *)0x0;
local_208.pvExtraPolicyPara = &local_1f8;
local_1f8 = 0x18;
local_1f4 = 2;
local_1e0.lChainIndex = 0;
local_1e0.lElementIndex = 0;
local_1e0.cbSize = 0x18;
local_1e0.dwError = 0;
local_208.dwFlags = -(uint)(iVar8 != 0) & 7;
local_208.cbSize = 0x10;
local_1e8 = lpBuffer;
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60((ulonglong)(uint)-iVar8,(PCEVENT_DESCRIPTOR)&DAT_180084c70,uVar9,
pPolicyStatus,&local_70);
}
pPolicyStatus = &local_1e0;
pPolicyPara = &local_208;
uVar5 = 4;
BVar1 = CertVerifyCertificateChainPolicy
((LPCSTR)0x4,local_230,pPolicyPara,pPolicyStatus);
if (BVar1 == 0) {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,
&local_60);
}
GetLastError();
}
else {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,
&local_50);
}
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)0x0;
uVar3 = FUN_180001674(local_1e0.dwError,0,0x1800,(undefined *)0x0);
if (uVar3 == 0) {
CertFreeCertificateChain(local_230);
iVar4 = FUN_18005792c((longlong)pPrevCertContext);
if (iVar4 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x22,&DAT_180085618);
}
if (iVar8 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
sVar7 = (short)pCertContext + 0x23;
LAB_18005839b:
FUN_180041cb0(DAT_180091000[2],sVar7,&DAT_180085618);
}
}
else {
if ((int)pCVar10 == 1) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
sVar7 = (short)pCVar10 + 0x23;
goto LAB_180058376;
}
goto LAB_180058451;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
sVar7 = 0x25;
goto LAB_18005839b;
}
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180085618);
}
pCVar10 = (PCCERT_CONTEXT)0x1;
if (iVar8 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
sVar7 = (short)pCertContext + 0x20;
LAB_180058376:
FUN_180041cb0(DAT_180091000[2],sVar7,&DAT_180085618);
}
goto LAB_180058451;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
sVar7 = 0x21;
goto LAB_18005839b;
}
}
memset(local_118,0,0x60);
local_120 = &local_1c8;
local_198 = 0;
uStack_1c0 = 0;
local_128[0] = 4;
local_128[1] = 1;
local_1b8 = 0;
uStack_1b0 = 0;
local_1a8 = 0;
uStack_1a0 = 0;
pPolicyStatus = local_218[0];
local_1c8 = pPrevCertContext;
uVar3 = FUN_180010674(DAT_1800927e8,param_1,(undefined4 *)(ulonglong)local_228,
(undefined8 *)local_218[0],local_220,local_128,param_6);
if (uVar3 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x26,&DAT_180085618);
}
DVar2 = 0;
pCertContext = pPrevCertContext;
goto LAB_1800584be;
}
goto LAB_180058451;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)(ulonglong)uVar3;
FUN_180041cdc(DAT_180091000[2],0x1e,&DAT_180085618,uVar3);
}
}
CertFreeCertificateChain(local_230);
goto LAB_180058451;
}
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084c80,uVar9,pPolicyStatus,&local_90);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
DVar2 = GetLastError();
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)(ulonglong)DVar2;
FUN_180041cdc(DAT_180091000[2],0x1d,&DAT_180085618,DVar2);
}
goto LAB_180058451;
}
pCertContext = (PCCERT_CONTEXT)(ulonglong)(iVar8 + 1U);
} while (iVar8 + 1U < 2);
DVar2 = 0x8009030e;
goto LAB_18005847c;
}
GetLastError();
DVar2 = GetLastError();
if (DVar2 != 0) goto LAB_18005847c;
}
LAB_1800584be:
FUN_18000909c(lpBuffer);
LAB_1800584c6:
if (pCertContext != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(pCertContext);
}
if (hCertStore != (PCCERT_CONTEXT)0x0) {
CertCloseStore(hCertStore,0);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (DVar2 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0x27,&DAT_180085618,DVar2,(char)DVar2);
}
FUN_180028070(local_40 ^ (ulonglong)auStackY_278);
return;
}
=========================================
Function at address: 0x180058598
Called functions addresses: 0xEXTERNAL:0000017d 0x180041cb0 0xEXTERNAL:0000017b 0x18000a1f4 0xEXTERNAL:00000152 0xEXTERNAL:0000017c 0x18000909c


void FUN_180058598(PCCERT_CONTEXT param_1,undefined4 *param_2)

{
BOOL BVar1;
undefined8 *pvData;
DWORD local_res10 [2];
undefined4 local_res18 [2];
HCRYPTPROV local_res20;

local_res20 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x28,&DAT_180085618);
}
*param_2 = 4;
BVar1 = CertGetCertificateContextProperty(param_1,2,(void *)0x0,local_res10);
if (BVar1 != 0) {
pvData = (undefined8 *)FUN_18000a1f4((ulonglong)local_res10[0]);
if (pvData != (undefined8 *)0x0) {
BVar1 = CertGetCertificateContextProperty(param_1,2,pvData,local_res10);
if (BVar1 != 0) {
*(uint *)((longlong)pvData + 0x14) = *(uint *)((longlong)pvData + 0x14) & 0xfffffffe;
BVar1 = CryptAcquireContextW
(&local_res20,(LPCWSTR)*pvData,(LPCWSTR)pvData[1],*(DWORD *)(pvData + 2),
*(uint *)((longlong)pvData + 0x14) | 0x40);
if (BVar1 != 0) {
local_res10[0] = 4;
BVar1 = CryptGetProvParam(local_res20,3,(BYTE *)local_res18,local_res10,0);
if (BVar1 != 0) {
*param_2 = local_res18[0];
}
}
}
FUN_18000909c(pvData);
}
}
if (local_res20 != 0) {
CryptReleaseContext(local_res20,0);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x29,&DAT_180085618);
}
return;
}
=========================================
Function at address: 0x1800586fc
Called functions addresses: 0xEXTERNAL:00000041 0xEXTERNAL:00000159 0x180041d20 0x180057640 0x180041cdc 0xEXTERNAL:0000015a 0xEXTERNAL:00000129 0xEXTERNAL:0000012e 0x180041cb0 0x180006aac 0xEXTERNAL:00000128 0x18002a7c0 0xEXTERNAL:0000015b 0xEXTERNAL:00000047 0x180001604 0xEXTERNAL:0000012b


/* WARNING: Type propagation algorithm not settling */

int FUN_1800586fc(longlong param_1,undefined8 param_2)

{
int iVar1;
DWORD DVar2;
HCERTSTORE hCertStore;
PCCERT_CONTEXT pCertContext;
int local_res18 [2];
int local_res20 [2];
ulonglong in_stack_ffffffffffffff88;
longlong local_58;
longlong local_50 [2];
undefined4 local_40 [2];
longlong local_38;

local_58 = 0;
local_res18[0] = 0;
local_50[0] = 0;
local_50[1] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180085618);
}
iVar1 = FUN_180006aac(local_50 + 1);
if (iVar1 == 0) {
iVar1 = FUN_180001604(*(longlong *)(*(longlong *)(param_1 + 0x50) + 0x2f0),local_res18);
if (iVar1 == 0) {

(local_50 + 1,1,param_2,3,in_stack_ffffffffffffff88 & 0xffffffff00000000,
&local_58);
if (iVar1 < 0) {
if (((iVar1 == -0x3ffffddb) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180085618);
}
}
else {
iVar1 = CredIsMarshaledCredentialW(*(undefined8 *)(local_58 + 0x48));
if (iVar1 != 0) {
iVar1 = CredUnmarshalCredentialW(*(undefined8 *)(local_58 + 0x48),local_res20,local_50);
if ((iVar1 != 0) && (local_res20[0] == 1)) {
hCertStore = CertOpenStore((LPCSTR)0xa,1,0,0x10004,&DAT_18008275c);
if (hCertStore == (HCERTSTORE)0x0) {
GetLastError();
iVar1 = -0x7ff6fcf2;
}
else {
local_38 = local_50[0] + 4;
local_40[0] = 0x14;
pCertContext = CertFindCertificateInStore
(hCertStore,1,0,0x10000,local_40,(PCCERT_CONTEXT)0x0);
if (pCertContext == (PCCERT_CONTEXT)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar2 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0xe,&DAT_180085618,DVar2);
}
iVar1 = -0x7ff6fcf2;
}
else {
if (local_res18[0] != 0) {
RevertToSelf();
local_res18[0] = 0;
}
iVar1 = FUN_180057640(param_1,(longlong)pCertContext);
if (-1 < iVar1) {
iVar1 = 0;
}
CertFreeCertificateContext(pCertContext);
}
CertCloseStore(hCertStore,0);
}
goto LAB_180058969;
}
}
iVar1 = -0x7ff6fcf3;
}
}
}
LAB_180058969:
if (local_58 != 0) {

}
if (local_50[0] != 0) {
CredFree();
}
if (local_res18[0] != 0) {
RevertToSelf();
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0 && (iVar1 != 0)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)))) {
FUN_180041d20(DAT_180091000[2],0xf,&DAT_180085618,iVar1,(char)iVar1);
}
return iVar1;
}
=========================================
Function at address: 0x180058a18
Called functions addresses: 0xEXTERNAL:000000da 0x180041cb0 0xEXTERNAL:00000067 0xEXTERNAL:000000e0


ulonglong FUN_180058a18(longlong param_1)

{
DWORD DVar1;
ulonglong in_RAX;
undefined4 extraout_var;
undefined8 *puVar2;
undefined8 uVar3;

if (*(HANDLE *)(param_1 + 0x40) != (HANDLE)0x0) {
DVar1 = WaitForSingleObjectEx(*(HANDLE *)(param_1 + 0x40),0,0);
in_RAX = CONCAT44(extraout_var,DVar1);
if (DVar1 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180085628);
}
RtlEnterCriticalSection(param_1 + 8);
for (puVar2 = *(undefined8 **)(param_1 + 0x30); puVar2 != (undefined8 *)(param_1 + 0x30);
puVar2 = (undefined8 *)*puVar2) {
*(uint *)((longlong)puVar2 + 0x94) = *(uint *)((longlong)puVar2 + 0x94) | 0x10;
}
uVar3 = RtlLeaveCriticalSection(param_1 + 8);
return CONCAT71((int7)((ulonglong)uVar3 >> 8),1);
}
}
return in_RAX & 0xffffffffffffff00;
}
=========================================
Function at address: 0x180058ac4
Called functions addresses: 0x180058f54 0x180058e94


void FUN_180058ac4(undefined8 *param_1,uint param_2,undefined4 *param_3)

{
undefined4 *puVar1;
undefined8 *puVar2;
uint uVar3;
undefined4 in_stack_ffffffffffffffdc;
undefined4 in_stack_ffffffffffffffe4;

if ((param_1 != (undefined8 *)0x0) && (uVar3 = 0, puVar2 = DAT_180091000, param_2 != 0)) {
do {
if (((undefined8 **)puVar2 != &DAT_180091000) &&
((*(byte *)((longlong)puVar2 + 0x1c) & 4) != 0)) {
FUN_180058e94(puVar2[2],0xb,param_3,uVar3,(char)*(undefined4 *)(param_1 + 6));
puVar2 = DAT_180091000;
}
puVar1 = (undefined4 *)*param_1;
if ((((puVar1 != (undefined4 *)0x0) &&
(param_3 = *(undefined4 **)(puVar1 + 6), param_3 != (undefined4 *)0x0)) &&
((undefined8 **)puVar2 != &DAT_180091000)) &&
((*(byte *)((longlong)puVar2 + 0x1c) & 4) != 0)) {
FUN_180058f54(puVar2[2],puVar1,param_3,uVar3,CONCAT44(in_stack_ffffffffffffffdc,*puVar1),
CONCAT44(in_stack_ffffffffffffffe4,*param_3),*(undefined **)(param_3 + 6));
puVar2 = DAT_180091000;
}
uVar3 = uVar3 + 1;
param_1 = param_1 + 7;
} while (uVar3 < param_2);
}
return;
}
=========================================
Function at address: 0x180058b94
Called functions addresses: 0x180059008 0x180028d90 0x180058eec 0x180028070


void FUN_180058b94(longlong param_1,longlong param_2,ulonglong param_3)

{
wchar_t wVar1;
uint uVar2;
longlong lVar3;
wchar_t *pwVar4;
wchar_t *pwVar5;
uint uVar6;
undefined8 *puVar7;
uint uVar8;
uint uVar9;
undefined4 *puVar10;
longlong lVar11;
undefined auStackY_118 [32];
undefined4 in_stack_ffffffffffffff0c;
undefined4 in_stack_ffffffffffffff14;
wchar_t local_b8 [64];
ulonglong local_38;

if (param_1 != 0) {
local_38 = DAT_180091970 ^ (ulonglong)auStackY_118;
uVar6 = (uint)param_2;
uVar9 = 0;
if (uVar6 != 0) {
puVar10 = (undefined4 *)(param_1 + 0x20);
puVar7 = DAT_180091000;
do {
if (((undefined8 **)puVar7 != &DAT_180091000) &&
((*(byte *)((longlong)puVar7 + 0x1c) & 4) != 0)) {
FUN_180058eec(puVar7[2],param_2,param_3,uVar9,(char)*puVar10,(char)puVar10[-4]);
puVar7 = DAT_180091000;
}
uVar2 = puVar10[-3];
if ((*(longlong *)(puVar10 + -2) != 0) && (uVar8 = 0, uVar2 != 0)) {
lVar11 = *(longlong *)(puVar10 + -2) + 0x28;
do {
memset(local_b8,0,0x80);
lVar3 = *(longlong *)(lVar11 + -0x18);
param_2 = 0x40;
pwVar5 = local_b8;
param_3 = (ulonglong)(((uint)*(undefined8 *)(lVar11 + -0x20) & 0xffff) >> 1);
do {
if ((param_2 + -0x40 + param_3 == 0) ||
(wVar1 = *(wchar_t *)((lVar3 - (longlong)local_b8) + (longlong)pwVar5),
wVar1 == L'\0')) break;
*pwVar5 = wVar1;
pwVar5 = pwVar5 + 1;
param_2 = param_2 + -1;
} while (param_2 != 0);
pwVar4 = pwVar5 + -1;
if (param_2 != 0) {
pwVar4 = pwVar5;
}
*pwVar4 = L'\0';
if (((undefined8 **)puVar7 != &DAT_180091000) &&
((*(byte *)((longlong)puVar7 + 0x1c) & 4) != 0)) {
FUN_180059008(puVar7[2],param_2,param_3,uVar9,
CONCAT44(in_stack_ffffffffffffff0c,uVar8),
CONCAT44(in_stack_ffffffffffffff14,*(undefined4 *)(lVar11 + -0x28)),
local_b8);
puVar7 = DAT_180091000;
}
uVar8 = uVar8 + 1;
lVar11 = lVar11 + 0x30;
} while (uVar8 < uVar2);
}
uVar9 = uVar9 + 1;
puVar10 = puVar10 + 10;
} while (uVar9 < uVar6);
}
FUN_180028070(local_38 ^ (ulonglong)auStackY_118);
}
return;
}
=========================================
Function at address: 0x180058d5c
Called functions addresses: 0xEXTERNAL:00000129 0xEXTERNAL:000000a9 0x18002a7c0 0xEXTERNAL:00000062 0xEXTERNAL:00000140 0xEXTERNAL:00000178


void FUN_180058d5c(void)

{
longlong *pvCtrlPara;
longlong lVar1;
HCERTSTORE hCertStore;

lVar1 = DAT_1800927e8;
if (DAT_1800927e8 != 0) {
if (*(longlong *)(DAT_1800927e8 + 0x40) != 0) {
UnregisterGPNotification();
CloseHandle(*(HANDLE *)(lVar1 + 0x40));
}
hCertStore = *(HCERTSTORE *)(lVar1 + 0x48);
if (hCertStore != (HCERTSTORE)0x0) {
pvCtrlPara = (longlong *)(lVar1 + 0x50);
if (*pvCtrlPara != 0) {
CertControlStore(hCertStore,0,5,pvCtrlPara);
CloseHandle((HANDLE)*pvCtrlPara);
hCertStore = *(HCERTSTORE *)(lVar1 + 0x48);
}
CertCloseStore(hCertStore,0);
}
RtlDeleteCriticalSection(lVar1 + 8);
DAT_1800927e8 = 0;

}
return;
}
=========================================
Function at address: 0x180058e30
Called functions addresses: 0x180056618 0xEXTERNAL:000000da 0xEXTERNAL:000000e0


undefined8 FUN_180058e30(longlong param_1)

{
undefined8 *puVar1;

RtlEnterCriticalSection(param_1 + 8);
for (puVar1 = *(undefined8 **)(param_1 + 0x30); puVar1 != (undefined8 *)(param_1 + 0x30);
puVar1 = (undefined8 *)*puVar1) {
FUN_180056618((longlong)(puVar1 + -1));
}
RtlLeaveCriticalSection(param_1 + 8);
return 0;
}
=========================================
Function at address: 0x180058e94
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180058e94(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,&DAT_180085628,param_2,local_res20,4,&param_5,4,0);
return;
}
=========================================
Function at address: 0x180058eec
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180058eec(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5,undefined param_6)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,&DAT_180085628,0xd,local_res20,4,&param_5,4,&param_6,4,0);
return;
}
=========================================
Function at address: 0x180058f54
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180058f54(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
undefined8 param_5,undefined8 param_6,undefined *param_7)

{
longlong lVar1;
longlong lVar2;
undefined *puVar3;
undefined4 local_res20 [2];

if (param_7 == (undefined *)0x0) {
lVar2 = 5;
}
else {
lVar1 = -1;
do {
lVar2 = lVar1;
lVar1 = lVar2 + 1;
} while (param_7[lVar1] != '\0');
lVar2 = lVar2 + 2;
}
puVar3 = param_7;
if (param_7 == (undefined *)0x0) {
puVar3 = &DAT_180083c6c;
}
local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,&DAT_180085628,0xc,local_res20,4,&param_5,4,&param_6,4,puVar3,lVar2,0
);
return;
}
=========================================
Function at address: 0x180059008
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180059008(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
undefined8 param_5,undefined8 param_6,wchar_t *param_7)

{
longlong lVar1;
wchar_t *pwVar2;
undefined4 local_res20 [2];

if (param_7 == (wchar_t *)0x0) {
lVar1 = 10;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (param_7[lVar1] != L'\0');
lVar1 = lVar1 * 2 + 2;
}
pwVar2 = param_7;
if (param_7 == (wchar_t *)0x0) {
pwVar2 = L"NULL";
}
local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,&DAT_180085628,0xe,local_res20,4,&param_5,4,&param_6,4,pwVar2,lVar1,
&stack0x00000040,4,&stack0x00000048,4,0);
return;
}
=========================================
Function at address: 0x1800590f0
Called functions addresses: 0x18002a7c0 0xEXTERNAL:000000b3


void FUN_1800590f0(longlong param_1)

{
undefined8 *puVar1;

for (puVar1 = *(undefined8 **)(param_1 + 0x10); puVar1 != (undefined8 *)(param_1 + 0x10);
puVar1 = (undefined8 *)*puVar1) {
if (puVar1 + -0x26 != (undefined8 *)0x0) {

}
}
if (*(char *)(param_1 + 0x90) != '\0') {
RtlDeleteResource(param_1 + 0x30);
}
return;
}
=========================================
Function at address: 0x18005916c
Called functions addresses: 0x1800591e4


undefined8 FUN_18005916c(longlong param_1,byte param_2,undefined8 *param_3)

{
uint uVar1;

*param_3 = 0;
param_3[1] = 0;
param_3[2] = 0;
uVar1 = 0;
*(undefined4 *)(param_3 + 3) = 0;
*(undefined4 *)param_3 = *(undefined4 *)(param_1 + 0x1c);
if (*(int *)(param_1 + 0x30) != 0) {
do {
FUN_1800591e4((ulonglong)uVar1 * 0x98 + *(longlong *)(param_1 + 0x28),param_2,
(longlong)param_3);
uVar1 = uVar1 + 1;
} while (uVar1 < *(uint *)(param_1 + 0x30));
}
return 0;
}
=========================================
Function at address: 0x1800591e4
Called functions addresses: 0xEXTERNAL:00000088 0x18002a7c0 0x1800032c4 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc


undefined8 FUN_1800591e4(longlong param_1,byte param_2,longlong param_3)

{
undefined8 *puVar1;
DWORD DVar2;
int iVar3;
undefined8 uVar4;
undefined7 in_register_00000011;
undefined8 *puVar5;

DVar2 = GetTickCount();
RtlAcquireResourceExclusive(param_1 + 0x30,CONCAT71(in_register_00000011,1));
puVar1 = *(undefined8 **)(param_1 + 0x10);
while (puVar5 = puVar1, puVar5 != (undefined8 *)(param_1 + 0x10)) {
puVar1 = (undefined8 *)*puVar5;

if (((iVar3 == 1) || (iVar3 == 2)) && (((byte)iVar3 & param_2) != 0)) {
*(int *)(param_3 + 4) = *(int *)(param_3 + 4) + 1;
if (*(int *)(puVar5 + -9) == 1) {
*(int *)(param_3 + 0xc) = *(int *)(param_3 + 0xc) + 1;
uVar4 = FUN_1800032c4((ulonglong)*(uint *)((longlong)puVar5 + -0x1c),(ulonglong)DVar2,
*(uint *)(puVar5 + -3));
if ((char)uVar4 != '\0') {
*(int *)(param_3 + 0x10) = *(int *)(param_3 + 0x10) + 1;
}
if (*(char *)((longlong)puVar5 + -0x44) == '\0') {
*(int *)(param_3 + 0x14) = *(int *)(param_3 + 0x14) + 1;
}
}
else {
*(int *)(param_3 + 8) = *(int *)(param_3 + 8) + 1;
}
}
}
RtlReleaseResource(param_1 + 0x30);
return 0;
}
=========================================
Function at address: 0x1800592e8
Called functions addresses: 0x18000685c


int FUN_1800592e8(longlong param_1,undefined4 param_2,uint *param_3,longlong *param_4)

{
int iVar1;
longlong local_18 [2];

iVar1 = FUN_18000685c(param_1,'\x01',0,param_3,local_18);
if (iVar1 == 0) {
*param_4 = local_18[0];
if (local_18[0] == 0) {
iVar1 = 0x57;
}
else {
*(undefined4 *)(local_18[0] + 0xa8) = param_2;
}
}
return iVar1;
}
=========================================
Function at address: 0x18005933c
Called functions addresses: 0xEXTERNAL:00000088 0x180053448 0xEXTERNAL:0000018b 0x18002a7c0 0xEXTERNAL:000000c2 0x1800032c4 0xEXTERNAL:000000c0 0x18002a76f 0x1800069c4 0xEXTERNAL:000000bc 0x180041e9c


bool FUN_18005933c(longlong *param_1,ulonglong param_2,longlong param_3,void *param_4,uint param_5,
longlong *param_6)

{
longlong *plVar1;
longlong *plVar2;
code *pcVar3;
char cVar4;
undefined uVar5;
DWORD DVar6;
int iVar7;
undefined8 uVar8;
longlong *plVar9;
longlong *plVar10;
longlong *plVar11;
longlong lVar12;
DWORD local_res10 [2];
longlong local_res18;
void *local_res20;
undefined8 local_58 [3];

local_res18 = param_3;
local_res20 = param_4;
DVar6 = GetTickCount();
FUN_180053448(local_res10);
RtlAcquireResourceExclusive(param_1 + 6,1);
lVar12 = (param_2 & 0xffffffff) * 0x10;
plVar9 = (longlong *)(*param_1 + lVar12);
plVar11 = (longlong *)*plVar9;
iVar7 = 0;
if (plVar11 != plVar9) {
do {
plVar1 = plVar11 + -0x24;
plVar2 = (longlong *)*plVar11;
plVar9 = plVar11 + -0x1b;
RtlAcquireResourceShared(plVar9,1);
if (*(char *)((longlong)plVar11 + -0x34) != '\0') {
uVar8 = FUN_1800032c4((ulonglong)*(uint *)((longlong)plVar11 + -0xc),(ulonglong)DVar6,
*(uint *)(plVar11 + -1));
if (((char)uVar8 == '\0') && (param_5 == *(ushort *)((longlong)plVar11 + -0x32))) {
iVar7 = memcmp(local_res20,plVar11 + -6,(ulonglong)param_5);
if ((iVar7 == 0) && (*(DWORD *)(plVar11 + -2) == local_res10[0])) {
local_58[0] = *(undefined8 *)(*(longlong *)(local_res18 + 0x50) + 0x2f8);
plVar10 = plVar1;

(plVar1,0,0,local_58,*(undefined4 *)(local_res18 + 0x40));
if (cVar4 != '\0') {
iVar7 = FUN_1800069c4(plVar10,(longlong)plVar1);
RtlReleaseResource(plVar9);
if (iVar7 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],10,&DAT_180082b48,plVar1);
}
*param_6 = (longlong)plVar1;
if (iVar7 == 2) {
plVar9 = plVar11 + 4;
lVar12 = *plVar9;
if ((*(longlong **)(lVar12 + 8) != plVar9) ||
(plVar11 = (longlong *)plVar11[5], (longlong *)*plVar11 != plVar9)) {
pcVar3 = (code *)swi(0x29);
(*pcVar3)(3);
pcVar3 = (code *)swi(3);
uVar5 = (*pcVar3)();
return (bool)uVar5;
}
*plVar11 = lVar12;
*(longlong **)(lVar12 + 8) = plVar11;
}
LsaIModifyPerformanceCounter(9,0,0);
}
break;
}
}
}
}
RtlReleaseResource(plVar9);
plVar11 = plVar2;
iVar7 = 0;
} while (plVar2 != (longlong *)(*param_1 + lVar12));
}
RtlReleaseResource(param_1 + 6);
return 0 < iVar7;
}
=========================================
Function at address: 0x180059568
Called functions addresses: 0x18005933c


ulonglong FUN_180059568(longlong param_1,longlong param_2,uint *param_3,uint param_4,
longlong *param_5)

{
uint uVar1;
bool bVar2;
longlong *in_RAX;
longlong local_18 [2];

if (3 < param_4) {
uVar1 = *param_3;
in_RAX = (longlong *)(ulonglong)uVar1;
if (uVar1 < *(uint *)(param_1 + 0x10)) {
bVar2 = FUN_18005933c((longlong *)
(((ulonglong)uVar1 / (ulonglong)*(uint *)(param_1 + 0x34)) * 0x98 +
*(longlong *)(param_1 + 0x28)),
(ulonglong)uVar1 % (ulonglong)*(uint *)(param_1 + 0x34),param_2,param_3,
param_4,local_18);
if (bVar2) {
*param_5 = local_18[0];
return CONCAT71((int7)((ulonglong)local_18[0] >> 8),1);
}
*param_5 = 0;
in_RAX = param_5;
}
}
return (ulonglong)in_RAX & 0xffffffffffffff00;
}
=========================================
Function at address: 0x1800595e0
Called functions addresses: 0x180059674


undefined8
FUN_1800595e0(longlong param_1,uint param_2,undefined8 param_3,int param_4,undefined8 param_5)

{
uint uVar1;

uVar1 = 0;
if ((*(int *)(param_1 + 0x20) != 0) && (*(int *)(param_1 + 0x30) != 0)) {
do {
FUN_180059674((ulonglong)uVar1 * 0x98 + *(longlong *)(param_1 + 0x28),param_2,param_3,param_4,
(int *)(param_1 + 0x20),param_5);
uVar1 = uVar1 + 1;
} while (uVar1 < *(uint *)(param_1 + 0x30));
}
return 0;
}
=========================================
Function at address: 0x180059674
Called functions addresses: 0x18002a7c0 0xEXTERNAL:0000018b 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc


undefined8
FUN_180059674(longlong param_1,uint param_2,undefined8 param_3,int param_4,int *param_5,
undefined8 param_6)

{
longlong *****ppppplVar1;
longlong *****ppppplVar2;
longlong *****ppppplVar3;
longlong ****pppplVar4;
longlong ****pppplVar5;
code *pcVar6;
char cVar7;
undefined4 in_register_00000014;
longlong *****ppppplVar8;
undefined *puVar9;
undefined auStack_78 [8];
undefined auStack_70 [40];
longlong ****local_48;
longlong ****local_40;

puVar9 = auStack_78;
local_40 = (longlong ****)&local_48;
local_48 = (longlong ****)&local_48;
RtlAcquireResourceExclusive
(param_1 + 0x30,CONCAT71((int7)(CONCAT44(in_register_00000014,param_2) >> 8),1));
ppppplVar2 = *(longlong ******)(param_1 + 0x10);
do {
if (ppppplVar2 == (longlong *****)(param_1 + 0x10)) {
RtlReleaseResource(param_1 + 0x30);
ppppplVar8 = (longlong *****)local_48;
while (ppppplVar8 != (longlong *****)(puVar9 + 0x30)) {
LAB_180059835:
ppppplVar2 = ppppplVar8 + -0x26;
ppppplVar8 = (longlong *****)*ppppplVar8;
if (ppppplVar2 != (longlong *****)0x0) {
*(undefined8 *)(puVar9 + -8) = 0x180059860;

}
}
return 0;
}
ppppplVar8 = ppppplVar2 + -0x26;
ppppplVar3 = (longlong *****)*ppppplVar2;
RtlAcquireResourceExclusive(ppppplVar2 + -0x1d,1);
if (((param_4 == *(int *)(ppppplVar2 + -4)) || ((param_2 >> 0x11 & 1) != 0)) &&

cVar7 != '\0')) {
if (*(int *)(ppppplVar2 + -9) < 2) {
ppppplVar1 = ppppplVar2 + -2;
pppplVar4 = *ppppplVar1;
if (((longlong *****)pppplVar4[1] != ppppplVar1) ||
(pppplVar5 = ppppplVar2[-1], (longlong *****)*pppplVar5 != ppppplVar1)) {
LAB_18005982e:
pcVar6 = (code *)swi(0x29);
(*pcVar6)(3);
puVar9 = auStack_70;
goto LAB_180059835;
}
*pppplVar5 = (longlong ***)pppplVar4;
pppplVar4[1] = (longlong ***)pppplVar5;
pppplVar4 = *ppppplVar2;
if (((longlong *****)pppplVar4[1] != ppppplVar2) ||
(pppplVar5 = ppppplVar2[1], (longlong *****)*pppplVar5 != ppppplVar2))
goto LAB_18005982e;
*pppplVar5 = (longlong ***)pppplVar4;
ppppplVar8 = ppppplVar2 + 2;
pppplVar4[1] = (longlong ***)pppplVar5;
pppplVar4 = *ppppplVar8;
if (((longlong *****)pppplVar4[1] != ppppplVar8) ||
(pppplVar5 = ppppplVar2[3], (longlong *****)*pppplVar5 != ppppplVar8))
goto LAB_18005982e;
*pppplVar5 = (longlong ***)pppplVar4;
pppplVar4[1] = (longlong ***)pppplVar5;
LOCK();
*param_5 = *param_5 + -1;
UNLOCK();
LsaIModifyPerformanceCounter(4);
if ((longlong *****)*local_40 != &local_48) goto LAB_18005982e;
ppppplVar2[1] = local_40;
*ppppplVar2 = (longlong ****)&local_48;
*local_40 = (longlong ***)ppppplVar2;
local_40 = (longlong ****)ppppplVar2;
}
else {
*(undefined2 *)((longlong)ppppplVar2 + -0x44) = 0;
}
}
RtlReleaseResource(ppppplVar2 + -0x1d);
ppppplVar2 = ppppplVar3;
} while( true );
}
=========================================
Function at address: 0x18005988c
Called functions addresses: 0x1800590f0 0xEXTERNAL:000000a9 0x18002a7c0 0x18000909c


undefined8 FUN_18005988c(longlong *param_1)

{
undefined8 uVar1;
HLOCAL pvVar2;
uint uVar3;

if (param_1 == (longlong *)0x0) {
uVar1 = 0x54f;
}
else {
if (param_1[1] != 0) {
pvVar2 = (HLOCAL)param_1[5];
if (pvVar2 != (HLOCAL)0x0) {
uVar3 = 0;
if (*(int *)(param_1 + 6) != 0) {
do {
FUN_1800590f0((ulonglong)uVar3 * 0x98 + param_1[5]);
uVar3 = uVar3 + 1;
} while (uVar3 < *(uint *)(param_1 + 6));
pvVar2 = (HLOCAL)param_1[5];
}
FUN_18000909c(pvVar2);
param_1[5] = 0;
}
FUN_18000909c((HLOCAL)param_1[1]);
param_1[1] = 0;
}
if (*(char *)(param_1 + 0xc) != '\0') {
RtlDeleteCriticalSection(param_1 + 7);
}

uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x180059940
Called functions addresses: 0x180059c68 0x180041cdc 0x180059d04 0x180059d38 0x18000a1f4 0x18000909c


undefined8 FUN_180059940(longlong param_1,longlong *param_2,uint *param_3)

{
int *piVar1;
bool bVar2;
bool bVar3;
bool bVar4;
bool bVar5;
bool bVar6;
bool bVar7;
longlong lVar8;
uint *puVar9;
undefined4 *puVar10;
ulonglong uVar11;
ulonglong uVar12;
uint uVar13;
longlong lVar14;
ulonglong uVar15;
int *piVar16;
uint uVar17;
int iVar18;
longlong lVar19;
uint uVar20;
longlong lVar21;

bVar3 = false;
bVar6 = false;
bVar4 = false;
bVar5 = false;
if (param_1 == 0) {
return 0x57;
}
*param_3 = 0;
lVar8 = FUN_18000a1f4(0x58);
*param_2 = lVar8;
if (lVar8 == 0) {
return 0xe;
}
lVar8 = *(longlong *)(param_1 + 0xb8);
lVar19 = 4;
lVar21 = 8;
if (lVar8 != 0) {
uVar17 = *(uint *)(param_1 + 0xb0);
uVar12 = 0;
if (uVar17 != 0) {
do {
uVar20 = *(uint *)(lVar8 + uVar12 * 4);
puVar9 = &DAT_180085640;
bVar2 = false;
uVar13 = 0;
do {
if (uVar20 == *puVar9) goto LAB_1800599ff;
uVar13 = uVar13 + 1;
puVar9 = (uint *)((longlong)puVar9 + lVar19);
} while (uVar13 < 0x11);
if (uVar13 == 0x11) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180085688,uVar20);
}
FUN_18000909c((HLOCAL)*param_2);
*param_2 = 0;
return 0x57;
}
LAB_1800599ff:
uVar13 = uVar20 & 0xe000;
bVar7 = bVar6;
if (uVar13 == 0x6000) {
puVar9 = &DAT_180091108;
lVar14 = lVar21;
do {
if ((((puVar9[-2] == uVar20) && (*(uint *)(param_1 + 0xa4) <= *puVar9)) &&
(*puVar9 <= *(uint *)(param_1 + 0xa8))) &&
((puVar9[-10] & *(uint *)(param_1 + 0x98)) != 0)) {
bVar2 = true;
}
puVar9 = puVar9 + 0xe;
lVar14 = lVar14 + -1;
} while (lVar14 != 0);
bVar3 = true;
bVar5 = bVar6;
if (bVar2) {
LAB_180059ad1:
piVar16 = (int *)*param_2;
uVar15 = (ulonglong)*param_3;
uVar11 = FUN_180059c68(piVar16,*param_3,uVar20);
lVar19 = 4;
bVar7 = bVar6;
bVar5 = bVar6;
if ((char)uVar11 == '\0') {
piVar16[uVar15 & 0xffffffff] = uVar20;
*param_3 = *param_3 + 1;
}
}
}
else if (uVar13 == 0x8000) {
bVar4 = true;
puVar9 = (uint *)FUN_180059d04(uVar20);
if (puVar9 != (uint *)0x0) {
uVar13 = *(uint *)(param_1 + 0x98) & *puVar9;
joined_r0x000180059a79:
bVar6 = bVar5;
bVar5 = bVar6;
if (uVar13 != 0) goto LAB_180059ad1;
}
}
else if (uVar13 == 0xa000) {
bVar7 = true;
puVar10 = FUN_180059d38(uVar20);
bVar5 = true;
if (puVar10 != (undefined4 *)0x0) {
uVar13 = *(uint *)(param_1 + 0x98) & puVar10[1];
goto joined_r0x000180059a79;
}
}
bVar6 = bVar7;
uVar20 = (int)uVar12 + 1;
uVar12 = (ulonglong)uVar20;
} while (uVar20 < uVar17);
if (bVar3) goto LAB_180059b9e;
}
}
puVar9 = &DAT_1800910e0;
do {
if (((*(uint *)(param_1 + 0xa4) <= puVar9[10]) && (puVar9[10] <= *(uint *)(param_1 + 0xa8))) &&
((*puVar9 & *(uint *)(param_1 + 0x98)) != 0)) {
piVar16 = (int *)*param_2;
uVar17 = puVar9[8];
uVar11 = (ulonglong)*param_3;
uVar12 = FUN_180059c68(piVar16,*param_3,uVar17);
if ((char)uVar12 == '\0') {
piVar16[uVar11 & 0xffffffff] = uVar17;
*param_3 = *param_3 + 1;
}
}
puVar9 = puVar9 + 0xe;
lVar21 = lVar21 + -1;
} while (lVar21 != 0);
LAB_180059b9e:
if (!bVar4) {
piVar16 = &DAT_180091028;
lVar8 = 5;
do {
if ((*(uint *)(param_1 + 0x98) & piVar16[-6]) != 0) {
piVar1 = (int *)*param_2;
iVar18 = *piVar16;
uVar11 = (ulonglong)*param_3;
uVar12 = FUN_180059c68(piVar1,*param_3,iVar18);
if ((char)uVar12 == '\0') {
piVar1[uVar11 & 0xffffffff] = iVar18;
*param_3 = *param_3 + 1;
}
}
piVar16 = piVar16 + 10;
lVar8 = lVar8 + -1;
} while (lVar8 != 0);
}
if (!bVar5) {
piVar16 = &DAT_1800914c0;
lVar8 = 4;
do {
if ((*(uint *)(param_1 + 0x98) & piVar16[1]) != 0) {
piVar1 = (int *)*param_2;
iVar18 = *piVar16;
uVar11 = (ulonglong)*param_3;
uVar12 = FUN_180059c68(piVar1,*param_3,iVar18);
if ((char)uVar12 == '\0') {
piVar1[uVar11 & 0xffffffff] = iVar18;
*param_3 = *param_3 + 1;
}
}
piVar16 = piVar16 + 0x10;
lVar8 = lVar8 + -1;
} while (lVar8 != 0);
*(undefined4 *)(*param_2 + (ulonglong)*param_3 * 4) = 0x2200;
*param_3 = *param_3 + 1;
*(undefined4 *)(*param_2 + (ulonglong)*param_3 * 4) = 0x2203;
*param_3 = *param_3 + 1;
}
return 0;
}
=========================================
Function at address: 0x180059c68
Called functions addresses: None


ulonglong FUN_180059c68(int *param_1,uint param_2,int param_3)

{
int iVar1;
ulonglong in_RAX;
uint uVar2;
bool bVar3;

uVar2 = 0;
if (param_2 != 0) {
do {
iVar1 = *param_1;
in_RAX = (ulonglong)(iVar1 - 0x2400U);
if ((iVar1 - 0x2400U & 0xffff7fff) == 0) {
in_RAX = (ulonglong)(param_3 - 0x2400U);
bVar3 = (param_3 - 0x2400U & 0xffff7fff) == 0;
}
else if ((iVar1 == 0xaa02) || (iVar1 == 0x2200)) {
if (param_3 == 0xaa02) goto LAB_180059cc6;
bVar3 = param_3 == 0x2200;
}
else {
bVar3 = iVar1 == param_3;
}
if (bVar3) {
LAB_180059cc6:
return CONCAT71((int7)(in_RAX >> 8),1);
}
uVar2 = uVar2 + 1;
param_1 = param_1 + 1;
} while (uVar2 < param_2);
}
return in_RAX & 0xffffffffffffff00;
}
=========================================
Function at address: 0x180059cd0
Called functions addresses: None


undefined4 * FUN_180059cd0(int param_1)

{
uint uVar1;
ulonglong uVar2;
int *piVar3;

uVar2 = 0;
piVar3 = &DAT_180091100;
do {
if (*piVar3 == param_1) {
return &DAT_1800910e0 + uVar2 * 0xe;
}
uVar1 = (int)uVar2 + 1;
uVar2 = (ulonglong)uVar1;
piVar3 = piVar3 + 0xe;
} while (uVar1 < 8);
return (undefined4 *)0x0;
}
=========================================
Function at address: 0x180059d04
Called functions addresses: None


undefined8 * FUN_180059d04(int param_1)

{
uint uVar1;
ulonglong uVar2;
int *piVar3;

uVar2 = 0;
piVar3 = &DAT_180091028;
do {
if (*piVar3 == param_1) {
return &DAT_180091010 + uVar2 * 5;
}
uVar1 = (int)uVar2 + 1;
uVar2 = (ulonglong)uVar1;
piVar3 = piVar3 + 10;
} while (uVar1 < 5);
return (undefined8 *)0x0;
}
=========================================
Function at address: 0x180059d38
Called functions addresses: None


undefined4 * FUN_180059d38(int param_1)

{
uint uVar1;
ulonglong uVar2;
int *piVar3;

uVar2 = 0;
piVar3 = &DAT_1800914c0;
do {
if (*piVar3 == param_1) {
return &DAT_1800914c0 + uVar2 * 0x10;
}
uVar1 = (int)uVar2 + 1;
uVar2 = (ulonglong)uVar1;
piVar3 = piVar3 + 0x10;
} while (uVar1 < 4);
return (undefined4 *)0x0;
}
=========================================
Function at address: 0x180059d68
Called functions addresses: None


undefined4 * FUN_180059d68(int param_1)

{
uint uVar1;
ulonglong uVar2;
int *piVar3;

uVar2 = 0;
piVar3 = &DAT_1800913ec;
do {
if (*piVar3 == param_1) {
return &DAT_1800913d0 + uVar2 * 8;
}
uVar1 = (int)uVar2 + 1;
uVar2 = (ulonglong)uVar1;
piVar3 = piVar3 + 8;
} while (uVar1 < 5);
return (undefined4 *)0x0;
}
=========================================
Function at address: 0x180059d9c
Called functions addresses: 0xEXTERNAL:000000c2 0xEXTERNAL:000000c0


undefined8
FUN_180059d9c(undefined8 param_1,longlong param_2,longlong *param_3,int param_4,int param_5)

{
longlong *plVar1;
undefined8 uVar2;
longlong *plVar3;
uint uVar4;
uint uVar5;
uint uVar6;

RtlAcquireResourceShared(&DAT_180092428,1);
plVar3 = DAT_1800925b0;
if ((*(uint *)(param_2 + 0x88) >> 0x1d & 1) != 0) {
plVar3 = DAT_1800925b8;
}
uVar5 = 0;
if (plVar3 == (longlong *)0x0) {
uVar4 = 0;
}
else {
uVar4 = *(uint *)(plVar3 + 1);
if (uVar4 != 0) {
plVar3 = (longlong *)(*plVar3 + 0x350);
do {
if (*(int *)((longlong)plVar3 + -0x334) == param_4) {
plVar1 = (longlong *)*plVar3;
if (param_5 == 0) {
LAB_180059e72:
if (plVar1 != (longlong *)0x0) {
LOCK();
*(int *)(plVar1[2] + 0xc) = *(int *)(plVar1[2] + 0xc) + 1;
UNLOCK();
}
LOCK();
*(int *)(plVar3[1] + 0xc) = *(int *)(plVar3[1] + 0xc) + 1;
UNLOCK();
*param_3 = (longlong)(plVar3 + -0x6a);
break;
}
if (plVar1 != (longlong *)0x0) {
uVar6 = 0;
if (*(uint *)(plVar1 + 1) != 0) {
do {
if (param_5 == *(int *)((ulonglong)uVar6 * 0x30c + 0x304 + *plVar1)) {
plVar1 = (longlong *)*plVar3;
goto LAB_180059e72;
}
uVar6 = uVar6 + 1;
} while (uVar6 < *(uint *)(plVar1 + 1));
}
}
}
uVar5 = uVar5 + 1;
plVar3 = plVar3 + 0x6c;
} while (uVar5 < uVar4);
}
}
RtlReleaseResource(&DAT_180092428);
uVar2 = 0x490;
if (uVar5 != uVar4) {
uVar2 = 0;
}
return uVar2;
}
=========================================
Function at address: 0x180059ed0
Called functions addresses: 0xEXTERNAL:0000011c 0xEXTERNAL:000000f7 0xEXTERNAL:000000c2 0x180023408 0x18000a1f4 0xEXTERNAL:000000c0 0x180028070


void FUN_180059ed0(undefined8 param_1,undefined8 param_2,longlong *param_3,uint *param_4)

{
longlong *plVar1;
int iVar2;
longlong lVar3;
ulonglong uVar4;
longlong *plVar5;
uint uVar6;
ulonglong uVar7;
ulonglong uVar8;
undefined auStack_178 [32];
uint *local_158;
longlong local_148 [32];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStack_178;
iVar2 = 0x490;
local_158 = param_4;
RtlAcquireResourceShared(&DAT_180092428,1);
uVar7 = 0;
if (DAT_180092498 != 0) {
do {
iVar2 = SslOpenPrivateKey((&DAT_1800924a0)[uVar7],local_148 + uVar7,param_2,0x40);
if (iVar2 != 0) goto LAB_180059fe6;
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
} while (uVar6 < DAT_180092498);
uVar4 = (ulonglong)(DAT_180092498 << 4);
lVar3 = FUN_18000a1f4(uVar4);
if (lVar3 == 0) {
iVar2 = 0xe;
}
else {
uVar8 = 0;
if (DAT_180092498 != 0) {
do {
plVar5 = (longlong *)(uVar8 * 0x10 + lVar3);
FUN_180023408(uVar4,(&DAT_1800924a0)[uVar8],plVar5);
plVar1 = local_148 + uVar8;
uVar6 = (int)uVar8 + 1;
uVar8 = (ulonglong)uVar6;
plVar5[1] = *plVar1;
param_4 = local_158;
} while (uVar6 < DAT_180092498);
}
*param_3 = lVar3;
*param_4 = DAT_180092498;
}
}
LAB_180059fe6:
RtlReleaseResource(&DAT_180092428);
if (iVar2 != 0) {
while ((int)uVar7 != 0) {
uVar7 = (ulonglong)((int)uVar7 - 1);
SslFreeObject(local_148[uVar7],0);
}
}
FUN_180028070(local_48 ^ (ulonglong)auStack_178);
return;
}
=========================================
Function at address: 0x18005a04c
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18005a04c(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
wchar_t *param_5)

{
longlong lVar1;
undefined4 local_res20 [2];

if (param_5 == (wchar_t *)0x0) {
lVar1 = 10;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (param_5[lVar1] != L'\0');
lVar1 = lVar1 * 2 + 2;
}
if (param_5 == (wchar_t *)0x0) {
param_5 = L"NULL";
}
local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,&DAT_180085700,param_2,local_res20,4,param_5,lVar1,0);
return;
}
=========================================
Function at address: 0x18005a0dc
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18005a0dc(undefined8 param_1,undefined2 param_2,undefined8 param_3,wchar_t *param_4,
undefined param_5,undefined param_6)

{
longlong lVar1;

if (param_4 == (wchar_t *)0x0) {
lVar1 = 10;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (param_4[lVar1] != L'\0');
lVar1 = lVar1 * 2 + 2;
}
if (param_4 == (wchar_t *)0x0) {
param_4 = L"NULL";
}
EtwTraceMessage(param_1,0x2b,&DAT_180085700,param_2,param_4,lVar1,&param_5,4,&param_6,4,0);
return;
}
=========================================
Function at address: 0x18005a174
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18005a174(undefined8 param_1,undefined2 param_2,undefined8 param_3,wchar_t *param_4,
undefined param_5)

{
longlong lVar1;

if (param_4 == (wchar_t *)0x0) {
lVar1 = 10;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (param_4[lVar1] != L'\0');
lVar1 = lVar1 * 2 + 2;
}
if (param_4 == (wchar_t *)0x0) {
param_4 = L"NULL";
}
EtwTraceMessage(param_1,0x2b,param_3,param_2,param_4,lVar1,&param_5,4,0);
return;
}
=========================================
Function at address: 0x18005a1f4
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18005a1f4(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined *param_4,
wchar_t *param_5)

{
longlong lVar1;
longlong lVar2;
longlong lVar3;

if (param_5 == (wchar_t *)0x0) {
lVar3 = 10;
}
else {
lVar3 = -1;
do {
lVar3 = lVar3 + 1;
} while (param_5[lVar3] != L'\0');
lVar3 = lVar3 * 2 + 2;
}
if (param_5 == (wchar_t *)0x0) {
param_5 = L"NULL";
}
lVar1 = -1;
if (param_4 == (undefined *)0x0) {
lVar2 = 5;
}
else {
do {
lVar2 = lVar1;
lVar1 = lVar2 + 1;
} while (param_4[lVar1] != '\0');
lVar2 = lVar2 + 2;
}
if (param_4 == (undefined *)0x0) {
param_4 = &DAT_180083c6c;
}
EtwTraceMessage(param_1,0x2b,&DAT_180085700,0x1c,param_4,lVar2,param_5,lVar3,0);
return;
}
=========================================
Function at address: 0x18005a2a4
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18005a2a4(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined *param_4,
wchar_t *param_5)

{
longlong lVar1;
longlong lVar2;
longlong lVar3;

if (param_5 == (wchar_t *)0x0) {
lVar3 = 10;
}
else {
lVar3 = -1;
do {
lVar3 = lVar3 + 1;
} while (param_5[lVar3] != L'\0');
lVar3 = lVar3 * 2 + 2;
}
if (param_5 == (wchar_t *)0x0) {
param_5 = L"NULL";
}
lVar1 = -1;
if (param_4 == (undefined *)0x0) {
lVar2 = 5;
}
else {
do {
lVar2 = lVar1;
lVar1 = lVar2 + 1;
} while (param_4[lVar1] != '\0');
lVar2 = lVar2 + 2;
}
if (param_4 == (undefined *)0x0) {
param_4 = &DAT_180083c6c;
}
EtwTraceMessage(param_1,0x2b,&DAT_180085700,0x1e,param_4,lVar2,param_5,lVar3,&stack0x00000030,4,0)
;
return;
}
=========================================
Function at address: 0x18005a36c
Called functions addresses: 0x18006368c 0x180003750 0x18005a424


undefined8 *
FUN_18005a36c(undefined8 *param_1,undefined8 param_2,longlong param_3,uint param_4,
undefined8 param_5)

{
undefined8 uVar1;
undefined8 *puVar2;

FUN_180003750(param_1,param_3,param_4,param_5);
puVar2 = param_1 + 0xab;
FUN_18005a424(puVar2,param_2);
uVar1 = param_1[0xc5];
*puVar2 = &PTR_FUN_18007fcf0;
*param_1 = &PTR_FUN_18007fae0;
FUN_18006368c(param_1 + 0xcf,(longlong)param_1,uVar1);
param_1[0xcf] = &PTR_FUN_18007d550;
param_1[0xe3] = 0;
*(undefined2 *)(param_1 + 0xe4) = 0;
param_1[0xe5] = 0;
param_1[0xe6] = 0;
*(undefined2 *)(param_1 + 0xe7) = 0;
*(undefined4 *)((longlong)param_1 + 0x73c) = *(undefined4 *)(param_1 + 8);
*(undefined *)((longlong)param_1 + 0x73a) = 1;
return param_1;
}
=========================================
Function at address: 0x18005a424
Called functions addresses: None


undefined8 * FUN_18005a424(undefined8 *param_1,undefined8 param_2)

{
param_1[3] = param_2;
*(undefined *)(param_1 + 1) = 0;
*param_1 = &PTR_FUN_18007cb60;
*(undefined *)(param_1 + 4) = 0;
param_1[2] = &PTR_FUN_18007cb58;
param_1[5] = 0;
param_1[6] = 0;
param_1[7] = 0;
param_1[8] = 0;
param_1[9] = 0;
param_1[10] = 0;
param_1[0xb] = 0;
param_1[0xc] = 0;
param_1[0xd] = 0;
param_1[0xe] = 0;
*(undefined *)(param_1 + 0xf) = 0;
param_1[0x10] = 0;
*(undefined *)(param_1 + 0x11) = 0;
param_1[0x12] = 0;
param_1[0x13] = 0;
param_1[0x14] = 0;
param_1[0x15] = 0;
param_1[0x16] = 0;
param_1[0x17] = 0;
param_1[0x18] = 0;
*(undefined2 *)(param_1 + 0x19) = 0x100;
param_1[0x1a] = param_2;
*(undefined *)(param_1 + 0x1b) = 0;
param_1[0x1c] = 0;
*(undefined2 *)(param_1 + 0x1d) = 0;
param_1[0x1e] = 0;
*(undefined *)(param_1 + 0x1f) = 0;
*(undefined8 *)((longlong)param_1 + 0xf9) = 0;
*(undefined8 *)((longlong)param_1 + 0x101) = 0;
*(undefined8 *)((longlong)param_1 + 0x109) = 0;
*(undefined8 *)((longlong)param_1 + 0x111) = 0;
*(undefined2 *)((longlong)param_1 + 0x119) = 0;
return param_1;
}
=========================================
Function at address: 0x18005a4f8
Called functions addresses: 0x180003400 0x18006a988 0x180020b60 0x180063788 0x180003ed0


void FUN_18005a4f8(longlong *param_1,undefined8 param_2,uint param_3)

{
longlong *plVar1;

plVar1 = param_1 + 0xab;
*param_1 = (longlong)&PTR_FUN_18007fae0;
*plVar1 = (longlong)&PTR_FUN_18007fcf0;
FUN_18006a988((longlong)plVar1);
FUN_180003ed0(param_1,param_2,param_3);
param_1[0xcf] = (longlong)&PTR_FUN_18007d550;
FUN_180063788(param_1 + 0xcf);
FUN_180020b60(plVar1);
FUN_180003400(param_1,param_2,param_3);
return;
}
=========================================
Function at address: 0x18005a570
Called functions addresses: 0x180003df0 0x180028a7c 0x1800726b8 0x18006fe4c 0x180003d20 0x180003d4c 0x180014550 0x18005abd8 0xEXTERNAL:0000011c 0x180003e7c 0x180003ce4 0x180003700 0x1800209bc 0x18002a7c0 0x180003ea4 0x18000909c


longlong * FUN_18005a570(longlong *param_1)

{
int *piVar1;
int iVar2;
HLOCAL pvVar3;
longlong *plVar4;
longlong lVar5;

*param_1 = (longlong)&PTR_FUN_18007cba8;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
plVar4 = (longlong *)param_1[0x3a];
if (plVar4 != (longlong *)0x0) {
if ((*plVar4 != 0) && (plVar4[3] != 0)) {

plVar4[3] = 0;
*(undefined4 *)(plVar4 + 2) = 0;
plVar4 = (longlong *)param_1[0x3a];
}
FUN_180003700((longlong)param_1,plVar4);
}
}
else {
if ((HLOCAL)param_1[0x47] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x47]);
}
lVar5 = param_1[0x49];
if (lVar5 != 0) {
FUN_1800726b8(lVar5);
_o_free(lVar5);
param_1[0x49] = 0;
}
if (param_1[0x48] != 0) {
FUN_18005abd8(param_1[0x48]);
param_1[0x48] = 0;
}
FUN_18006fe4c((longlong)param_1);
}
if ((HLOCAL)param_1[0x62] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x62]);
}
if ((HLOCAL)param_1[99] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[99]);
}
if ((HLOCAL)param_1[100] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[100]);
}
FUN_180003ea4(param_1);
if ((HLOCAL)param_1[0x66] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x66]);
}
FUN_180003e7c(param_1);
lVar5 = param_1[0x68];
if (lVar5 != 0) {
if (*(longlong *)(lVar5 + 8) != 0) {

lVar5 = param_1[0x68];
}

param_1[0x68] = 0;
}
pvVar3 = (HLOCAL)param_1[0x69];
if (pvVar3 != (HLOCAL)0x0) {
if (*(HLOCAL *)((longlong)pvVar3 + 8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)pvVar3 + 8));
pvVar3 = (HLOCAL)param_1[0x69];
}
if (*(HLOCAL *)((longlong)pvVar3 + 0x18) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)pvVar3 + 0x18));
pvVar3 = (HLOCAL)param_1[0x69];
}
FUN_18000909c(pvVar3);
param_1[0x69] = 0;
}
if ((HLOCAL)param_1[0x6a] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6a]);
}
if ((HLOCAL)param_1[0x6b] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6b]);
}
if ((HLOCAL)param_1[0x6c] != (HLOCAL)0x0) {
FUN_180003700((longlong)param_1,(HLOCAL)param_1[0x6c]);
}
FUN_180003df0((longlong)param_1);
*param_1 = (longlong)&PTR_FUN_18007cdb8;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
if (param_1[0x13] != 0) {
SslFreeObject(param_1[0x13],0);
}
if (param_1[0x14] != 0) {
SslFreeObject(param_1[0x14],0);
}
if (param_1[0x15] != 0) {
SslFreeObject(param_1[0x15],0);
}
if (param_1[0xe] != 0) {
SslFreeObject(param_1[0xe],0);
}
lVar5 = param_1[1];
if (lVar5 != 0) {
if (*(longlong *)(lVar5 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar5 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar5 + 0x358));
}
if ((longlong *)param_1[3] != (longlong *)0x0) {
FUN_1800209bc((longlong *)param_1[3]);
}
if ((((1 < *(int *)((longlong)param_1 + 0x44) - 3U) &&
(*(int *)((longlong)param_1 + 0x44) != 0x4f)) &&
((*(uint *)(param_1 + 0x11) >> 0x12 & 1) == 0)) && (param_1[0xb] != 0)) {
*(undefined *)(param_1[0xb] + 0xec) = 0;
}
if ((longlong *)param_1[10] != (longlong *)0x0) {
FUN_180003d4c(DAT_1800927e8,(longlong *)param_1[10]);
}
lVar5 = param_1[0xb];
if (lVar5 != 0) {
FUN_180014550(*(longlong *)(lVar5 + 0xe0),lVar5,'\x01','\0');
}
lVar5 = param_1[0xf];
if (lVar5 != 0) {
LOCK();
piVar1 = (int *)(lVar5 + 0x14);
iVar2 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar2 == 1) {

}
}
*param_1 = (longlong)&PTR_FUN_18007cfb8;
return param_1;
}
=========================================
Function at address: 0x18005a900
Called functions addresses: 0x180014550 0xEXTERNAL:0000011c 0x180003ce4 0x1800209bc 0x18002a7c0 0x180003d20 0x180003d4c


undefined8 * FUN_18005a900(undefined8 *param_1)

{
int *piVar1;
int iVar2;
longlong lVar3;

*param_1 = &PTR_FUN_18007cdb8;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
if (param_1[0x13] != 0) {
SslFreeObject(param_1[0x13],0);
}
if (param_1[0x14] != 0) {
SslFreeObject(param_1[0x14],0);
}
if (param_1[0x15] != 0) {
SslFreeObject(param_1[0x15],0);
}
if (param_1[0xe] != 0) {
SslFreeObject(param_1[0xe],0);
}
lVar3 = param_1[1];
if (lVar3 != 0) {
if (*(longlong *)(lVar3 + 0x350) != 0) {
FUN_180003d20(*(HLOCAL *)(*(longlong *)(lVar3 + 0x350) + 0x10));
}
FUN_180003ce4(*(longlong **)(lVar3 + 0x358));
}
if ((longlong *)param_1[3] != (longlong *)0x0) {
FUN_1800209bc((longlong *)param_1[3]);
}
if ((((1 < *(int *)((longlong)param_1 + 0x44) - 3U) &&
(*(int *)((longlong)param_1 + 0x44) != 0x4f)) &&
((*(uint *)(param_1 + 0x11) >> 0x12 & 1) == 0)) && (param_1[0xb] != 0)) {
*(undefined *)(param_1[0xb] + 0xec) = 0;
}
if ((longlong *)param_1[10] != (longlong *)0x0) {
FUN_180003d4c(DAT_1800927e8,(longlong *)param_1[10]);
}
lVar3 = param_1[0xb];
if (lVar3 != 0) {
FUN_180014550(*(longlong *)(lVar3 + 0xe0),lVar3,'\x01','\0');
}
lVar3 = param_1[0xf];
if (lVar3 != 0) {
LOCK();
piVar1 = (int *)(lVar3 + 0x14);
iVar2 = *piVar1;
*piVar1 = *piVar1 + -1;
UNLOCK();
if (iVar2 == 1) {

}
}
*param_1 = &PTR_FUN_18007cfb8;
return param_1;
}
=========================================
Function at address: 0x18005aa90
Called functions addresses: 0x180028a7c


undefined8 * FUN_18005aa90(undefined8 *param_1,byte param_2)

{
*param_1 = &PTR_FUN_18007c298;
if ((param_2 & 1) != 0) {
_o_free();
}
return param_1;
}
=========================================
Function at address: 0x18005aac0
Called functions addresses: 0x180028a7c


undefined8 * FUN_18005aac0(undefined8 *param_1,byte param_2)

{
*param_1 = &PTR_FUN_18007cb58;
if ((param_2 & 1) != 0) {
_o_free();
}
return param_1;
}
=========================================
Function at address: 0x18005aaf0
Called functions addresses: 0x18005a4f8


longlong * FUN_18005aaf0(longlong *param_1,undefined8 param_2,uint param_3)

{
FUN_18005a4f8(param_1,param_2,param_3);
return param_1;
}
=========================================
Function at address: 0x18005ab10
Called functions addresses: 0x180028a7c 0x180063788


/* Library Function - Single Match
public: virtual void * __ptr64 __cdecl std::bad_alloc::`scalar deleting destructor'(unsigned
int) __ptr64

Library: Visual Studio 2019 Release */



{
*(undefined ***)this = &PTR_FUN_18007d550;
FUN_180063788((undefined8 *)this);
if ((param_1 & 1) != 0) {
_o_free(this);
}
return this;
}
=========================================
Function at address: 0x18005ab60
Called functions addresses: 0x180028a7c 0x180020b60


undefined8 * FUN_18005ab60(undefined8 *param_1,uint param_2)

{
FUN_180020b60(param_1);
if ((param_2 & 1) != 0) {
_o_free(param_1);
}
return param_1;
}
=========================================
Function at address: 0x18005aba0
Called functions addresses: 0x180028a7c 0x180020c30


undefined8 * FUN_18005aba0(undefined8 *param_1,uint param_2)

{
FUN_180020c30(param_1);
if ((param_2 & 1) != 0) {
_o_free(param_1);
}
return param_1;
}
=========================================
Function at address: 0x18005abd8
Called functions addresses: 0x180028a7c 0x1800726f4


longlong FUN_18005abd8(longlong param_1)

{
FUN_1800726f4(param_1);
_o_free(param_1);
return param_1;
}
=========================================
Function at address: 0x18005ac00
Called functions addresses: 0x18002a7c0


void FUN_18005ac00(longlong *param_1,undefined8 param_2)

{

return;
}
=========================================
Function at address: 0x18005ac30
Called functions addresses: 0xEXTERNAL:0000011c 0x18005afcc


void FUN_18005ac30(longlong param_1)

{
if (*(char *)(param_1 + 0x621) != '\0') {
FUN_18005afcc(param_1 + 0x558);
}
if (*(longlong *)(param_1 + 0x98) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x98),0);
*(undefined8 *)(param_1 + 0x98) = 0;
}
if (*(longlong *)(param_1 + 0x90) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x90),0);
*(undefined8 *)(param_1 + 0x90) = 0;
}
if ((*(char *)(param_1 + 0xe9) != '\0') && (*(char *)(param_1 + 0x108) != '\0')) {
*(undefined8 *)(param_1 + 0xf8) = 0;
}
return;
}
=========================================
Function at address: 0x18005acc0
Called functions addresses: 0xEXTERNAL:0000011c 0x18005afcc


void FUN_18005acc0(longlong param_1)

{
if (*(char *)(param_1 + 0x4b1) != '\0') {
FUN_18005afcc(param_1 + 1000);
}
if (*(longlong *)(param_1 + 0x98) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x98),0);
*(undefined8 *)(param_1 + 0x98) = 0;
}
if (*(longlong *)(param_1 + 0x90) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x90),0);
*(undefined8 *)(param_1 + 0x90) = 0;
}
if ((*(char *)(param_1 + 0xe9) != '\0') && (*(char *)(param_1 + 0x108) != '\0')) {
*(undefined8 *)(param_1 + 0xf8) = 0;
}
return;
}
=========================================
Function at address: 0x18005ad50
Called functions addresses: 0x180014550


void FUN_18005ad50(longlong param_1)

{
longlong lVar1;

lVar1 = *(longlong *)(param_1 + 0x528);
if (lVar1 != 0) {
FUN_180014550(*(longlong *)(lVar1 + 0xe0),lVar1,'\x01','\0');
*(undefined8 *)(param_1 + 0x528) = 0;
}
return;
}
=========================================
Function at address: 0x18005ad90
Called functions addresses: 0x1800272fc 0x18002a7c0 0x18005df3c 0x180029f58 0x18000909c


void FUN_18005ad90(longlong param_1,longlong *param_2,char param_3,int param_4)

{
int *piVar1;
int iVar2;
undefined8 uVar3;
ushort uVar4;
uint uVar5;
undefined8 *puVar6;
undefined8 uVar7;
HLOCAL pvVar8;

if (param_2 == (longlong *)0x0) {
return;
}
if (param_4 == 4) {

uVar5 = *(uint *)(param_1 + 0x18);
if (*(uint *)(param_1 + 0x18) <= (uint)uVar4) {
uVar5 = (uint)uVar4;
}
*(uint *)(param_1 + 0x18) = uVar5;
LOCK();
piVar1 = (int *)(param_1 + 0x14);
iVar2 = *piVar1;
*piVar1 = *piVar1 + 1;
UNLOCK();
if ((iVar2 == 99) && (*(longlong *)(param_1 + 0x38) != 0)) {
*(undefined4 *)(param_1 + 0x20) = *(undefined4 *)(param_1 + 0x18);
if (*(int *)(param_1 + 0x40) == 0) {
puVar6 = (undefined8 *)FUN_180029f58(0x50);
if (puVar6 == (undefined8 *)0x0) goto LAB_18005ae4f;
puVar6 = FUN_1800272fc(puVar6,*(undefined4 *)(param_1 + 0x20),1);
}
else {
puVar6 = (undefined8 *)FUN_180029f58(0x80);
if (puVar6 == (undefined8 *)0x0) {
puVar6 = (undefined8 *)0x0;
}
else {
puVar6 = FUN_18005df3c(puVar6,*(int *)(param_1 + 0x20),*(int *)(param_1 + 0x40));
}
}
if (puVar6 != (undefined8 *)0x0) {
*(undefined8 **)(param_1 + 0x38) = puVar6;
}
}
}
LAB_18005ae4f:
if (param_3 == '\0') {
uVar3 = *(undefined8 *)(param_1 + 0x38);


}
else {

FUN_18000909c(pvVar8);
}
return;
}
=========================================
Function at address: 0x18005aecc
Called functions addresses: 0x18002a7c0 0x18000909c 0x18005ad90 0x180041e9c


void FUN_18005aecc(longlong param_1,HLOCAL param_2)

{
uint uVar1;
int iVar2;
uint uVar3;
longlong lVar4;

lVar4 = *(longlong *)((longlong)param_2 + 8);
uVar1 = *(uint *)(lVar4 + 0x40);
iVar2 = *(int *)(lVar4 + 0x44);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x12,&DAT_180082b58,param_2);
lVar4 = *(longlong *)((longlong)param_2 + 8);
}
if (lVar4 != 0) {
uVar3 = *(uint *)(lVar4 + 0x40);

if ((uVar3 & 0x800a2aaa) != 0) {
FUN_18000909c(*(HLOCAL *)((longlong)param_2 + 8));
}
*(undefined8 *)((longlong)param_2 + 8) = 0;
}
if ((uVar1 & 0x51550) == 0) {
FUN_18000909c(param_2);
}
else {
FUN_18005ad90(param_1,*(longlong **)((longlong)param_2 + 0x18),
*(char *)((longlong)param_2 + 0x20),iVar2);
*(undefined8 *)((longlong)param_2 + 0x18) = 0;

}
return;
}
=========================================
Function at address: 0x18005afcc
Called functions addresses: 0xEXTERNAL:0000011c


void FUN_18005afcc(longlong param_1)

{
if (*(longlong *)(param_1 + 0x50) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x50),0);
*(undefined8 *)(param_1 + 0x50) = 0;
}
if (*(longlong *)(param_1 + 0x58) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x58),0);
*(undefined8 *)(param_1 + 0x58) = 0;
}
return;
}
=========================================
Function at address: 0x18005b01c
Called functions addresses: None


void FUN_18005b01c(longlong param_1,undefined8 *param_2,undefined8 *param_3)

{
undefined8 uVar1;
undefined8 uVar2;

uVar1 = 0;
if (param_2 != (undefined8 *)0x0) {
uVar2 = uVar1;
if (*(char *)(param_1 + 0xc9) != '\0') {
uVar2 = *(undefined8 *)(param_1 + 0x50);
}
*param_2 = uVar2;
}
if (param_3 != (undefined8 *)0x0) {
if (*(char *)(param_1 + 0xc9) != '\0') {
uVar1 = *(undefined8 *)(param_1 + 0x58);
}
*param_3 = uVar1;
}
return;
}
=========================================
Function at address: 0x18005b060
Called functions addresses: None


undefined8 FUN_18005b060(longlong param_1)

{
if (*(char *)(param_1 + 0x641) != '\0') {
return *(undefined8 *)(param_1 + 0x648);
}
return *(undefined8 *)(param_1 + 0x250);
}
=========================================
Function at address: 0x18005b090
Called functions addresses: None


undefined8 FUN_18005b090(longlong param_1)

{
if (*(char *)(param_1 + 0x4d1) != '\0') {
return *(undefined8 *)(param_1 + 0x4d8);
}
return *(undefined8 *)(param_1 + 0x250);
}
=========================================
Function at address: 0x18005b0c0
Called functions addresses: None


ushort FUN_18005b0c0(longlong param_1)

{
ushort uVar1;

uVar1 = *(ushort *)(param_1 + 0x14);
if (*(ushort *)(param_1 + 0x14) <= *(ushort *)(param_1 + 0x12)) {
uVar1 = *(ushort *)(param_1 + 0x12);
}
return uVar1;
}
=========================================
Function at address: 0x18005b0e0
Called functions addresses: 0x18005b01c


void FUN_18005b0e0(longlong param_1,undefined8 *param_2,undefined8 *param_3)

{
FUN_18005b01c(param_1 + 0x558,param_3,param_2);
return;
}
=========================================
Function at address: 0x18005b100
Called functions addresses: 0x18005b01c


void FUN_18005b100(longlong param_1,undefined8 *param_2,undefined8 *param_3)

{
FUN_18005b01c(param_1 + 1000,param_2,param_3);
return;
}
=========================================
Function at address: 0x18005b120
Called functions addresses: 0x18006d6b0


void FUN_18005b120(longlong param_1,longlong param_2,char param_3,longlong param_4,int param_5)

{
FUN_18006d6b0(param_1 + 0x5a8,param_2,(ulonglong)(-(uint)(param_3 != '\0') & 8) + param_1 + 0x5a8,
param_4,param_5);
return;
}
=========================================
Function at address: 0x18005b150
Called functions addresses: 0x18006d6b0


void FUN_18005b150(longlong param_1,longlong param_2,char param_3,longlong param_4,int param_5)

{
FUN_18006d6b0(param_1 + 0x440,param_2,
(-(ulonglong)(param_3 != '\0') & 0xfffffffffffffff8) + param_1 + 0x440,param_4,
param_5);
return;
}
=========================================
Function at address: 0x18005b180
Called functions addresses: 0x18006d824


void FUN_18005b180(longlong param_1,longlong param_2,uint param_3,int param_4)

{
FUN_18006d824(param_1 + 0x558,param_2,param_3,param_4,*(uint *)(param_1 + 0x44));
return;
}
=========================================
Function at address: 0x18005b1b0
Called functions addresses: 0x18006d824


void FUN_18005b1b0(longlong param_1,longlong param_2,uint param_3,int param_4)

{
FUN_18006d824(param_1 + 1000,param_2,param_3,param_4,*(uint *)(param_1 + 0x44));
return;
}
=========================================
Function at address: 0x18005b1e0
Called functions addresses: 0x18006db5c


void FUN_18005b1e0(undefined8 param_1,longlong param_2)

{
FUN_18006db5c(param_1,param_2,param_1,'\0');
return;
}
=========================================
Function at address: 0x18005b200
Called functions addresses: 0x18006eb44


void FUN_18005b200(longlong param_1)

{
FUN_18006eb44(param_1 + 0x558);
return;
}
=========================================
Function at address: 0x18005b220
Called functions addresses: 0x18006eb44


void FUN_18005b220(longlong param_1)

{
FUN_18006eb44(param_1 + 1000);
return;
}
=========================================
Function at address: 0x18005b240
Called functions addresses: 0x180061340


void FUN_18005b240(longlong param_1,undefined8 param_2)

{
FUN_180061340(param_1,param_2,'\0');
return;
}
=========================================
Function at address: 0x18005b250
Called functions addresses: 0x180022b30


void FUN_18005b250(longlong param_1,longlong param_2,uint *param_3)

{
FUN_180022b30(param_1 + 0x558,param_2,param_3);
return;
}
=========================================
Function at address: 0x18005b270
Called functions addresses: None


undefined8 FUN_18005b270(longlong param_1,longlong param_2)

{
*(bool *)(param_1 + 0x3dc) = param_2 != 0;
return 0;
}
=========================================
Function at address: 0x18005b290
Called functions addresses: 0x18006f0d8


void FUN_18005b290(longlong param_1,longlong param_2,char param_3,char param_4)

{
FUN_18006f0d8(param_1 + 0x558,param_2,param_3,param_4);
return;
}
=========================================
Function at address: 0x18005b2a4
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18005b2a4(undefined8 param_1,undefined8 param_2,undefined8 param_3,wchar_t *param_4,
undefined *param_5)

{
longlong lVar1;
longlong lVar2;
longlong lVar3;

lVar3 = -1;
if (param_5 == (undefined *)0x0) {
lVar2 = 5;
}
else {
lVar1 = -1;
do {
lVar2 = lVar1;
lVar1 = lVar2 + 1;
} while (param_5[lVar1] != '\0');
lVar2 = lVar2 + 2;
}
if (param_5 == (undefined *)0x0) {
param_5 = &DAT_180083c6c;
}
if (param_4 == (wchar_t *)0x0) {
lVar3 = 10;
}
else {
do {
lVar3 = lVar3 + 1;
} while (param_4[lVar3] != L'\0');
lVar3 = lVar3 * 2 + 2;
}
if (param_4 == (wchar_t *)0x0) {
param_4 = L"NULL";
}
EtwTraceMessage(param_1,0x2b,&DAT_180082b58,10,param_4,lVar3,param_5,lVar2,0);
return;
}
=========================================
Function at address: 0x18005b354
Called functions addresses: 0x180001604


undefined8 FUN_18005b354(longlong param_1,undefined4 *param_2)

{
longlong lVar1;
int iVar2;
undefined8 uVar3;
int iVar4;

lVar1 = *(longlong *)(param_1 + 0x50);
*param_2 = 0;
uVar3 = *(undefined8 *)(lVar1 + 0x2e4);
iVar2 = (int)uVar3;
iVar4 = (int)((ulonglong)uVar3 >> 0x20);
if (((iVar2 != 999) || (iVar4 != 0)) && ((iVar2 != 0x3e4 || (iVar4 != 0)))) {
uVar3 = FUN_180001604(*(longlong *)(lVar1 + 0x2f0),param_2);
return uVar3;
}
return 0;
}
=========================================
Function at address: 0x18005b3a0
Called functions addresses: 0x1800461e4 0x180046ca0 0x180013248 0x18002a7c0 0x180045fdc


ulonglong FUN_18005b3a0(longlong *param_1,int param_2,undefined8 *param_3)

{
DWORD DVar1;
ulonglong uVar2;
longlong lVar3;
undefined4 extraout_var;

if (param_2 == 6) {
DVar1 = FUN_1800461e4((longlong)param_1,(longlong)param_3);
return CONCAT44(extraout_var,DVar1);
}
if (param_2 == 0x52) {
uVar2 = FUN_180046ca0(param_1,param_3);
return uVar2;
}
if (param_2 == 0x54) {

if (lVar3 != 0) {
uVar2 = FUN_180013248(param_3,*(PCCERT_CONTEXT *)(lVar3 + 0x20));
return uVar2;
}
return 0x8009030e;
}
if (param_2 != 0x5e) {
return 0x78;
}
uVar2 = FUN_180045fdc((longlong)param_1,param_3);
return uVar2;
}
=========================================
Function at address: 0x18005b440
Called functions addresses: 0x18004705c 0x180047320


int FUN_18005b440(longlong param_1,int param_2,undefined8 param_3,uint param_4)

{
int iVar1;

if (param_2 == 0x5e) {
iVar1 = FUN_18004705c(param_1,param_3,param_4);
return iVar1;
}
if (param_2 != 0x68) {
return 0x78;
}
iVar1 = FUN_180047320(param_1,param_3,param_4);
return iVar1;
}
=========================================
Function at address: 0x18005b470
Called functions addresses: 0x180012368 0x180045408 0x180028d90 0x18002a7c0 0x180012458 0x1800124f0 0xEXTERNAL:000000c8


void FUN_18005b470(longlong *param_1,undefined4 param_2,undefined4 param_3,undefined param_4)

{
ushort uVar1;
uint uVar2;
longlong lVar3;
undefined4 uVar4;
undefined *puVar5;
longlong lVar6;
undefined *puVar7;
ulonglong uVar8;
undefined local_738 [16];
undefined local_728 [16];
undefined local_718 [8];
undefined4 local_710;
undefined4 uStack_70c;


lVar6 = param_1[0x10];
if (*(short *)(lVar6 + 0x22) == 0) {
*(short *)(lVar6 + 0x22) = (short)param_2;
*(undefined4 *)(lVar6 + 0x24) = param_3;
}
*(undefined *)(param_1 + 0xc) = 2;
*(undefined *)((longlong)param_1 + 0x61) = param_4;
puVar7 = &DAT_18008233c;
if (puVar5 != (undefined *)0x0) {
puVar7 = puVar5;
}
uVar2 = *(uint *)(param_1[10] + 0xd4);
if ((DAT_1800919b0 & 4) != 0) {
RtlInitUnicodeString(local_728,param_1[10] + 0xd8);
RtlInitUnicodeString(local_738,puVar7);
FUN_180045408((ushort *)&DAT_180084ff0,0x180084f08,(ulonglong)uVar2,local_728);
}
uVar8 = 0x6e8;
memset(local_718,0,0x6e8);
lVar6 = param_1[1];
if (lVar6 == 0) {
local_710 = 0;
}
else {
local_710 = *(undefined4 *)(lVar6 + 0x1c);
}
uVar4 = local_710;
uStack_70c = *(undefined4 *)(param_1 + 2);
uVar1 = *(ushort *)((longlong)param_1 + 0x22);
lVar3 = param_1[0x11];
if ((lVar6 != 0) && (param_1[0xb] != 0)) {
uVar2 = *(uint *)(param_1[0xb] + 8);
uVar8 = (ulonglong)uVar2;
FUN_180012458(param_1[0xf],*(int *)(lVar6 + 0x20),uVar2);
}
lVar6 = param_1[0xf];
if ((lVar6 != 0) && (DAT_1800927ac != '\0')) {
*(undefined4 *)(lVar6 + 0x24) = uStack_70c;
*(undefined *)(lVar6 + 0x6c) = param_4;
*(undefined4 *)(lVar6 + 0x68) = param_3;
*(undefined4 *)(lVar6 + 0x70) = param_2;
*(undefined4 *)(lVar6 + 0x20) = uVar4;
*(uint *)(lVar6 + 0x28) = (uint)uVar1;
*(longlong *)(lVar6 + 0x80) = lVar3;
FUN_1800124f0(lVar6,'\x01',uVar8);
lVar6 = param_1[0xf];
}
FUN_180012368(lVar6,L"Fatal Error");
return;
}
=========================================
Function at address: 0x18005b628
Called functions addresses: None


undefined2 FUN_18005b628(longlong param_1,int param_2)

{
undefined2 uVar1;
int iVar2;
int iVar3;

uVar1 = 0;
if ((*(byte *)(param_1 + 0x20) & 2) == 0) {
iVar2 = 0;
}
else {
iVar2 = *(int *)(param_1 + 0x30);
}
if ((*(byte *)(param_1 + 0x20) & 4) == 0) {
iVar3 = 0;
}
else {
iVar3 = *(int *)(param_1 + 0x2c);
}
iVar2 = (((param_2 - *(int *)(param_1 + 0x34)) - iVar3) - iVar2) - *(int *)(param_1 + 0x3c);
if (-1 < iVar2) {
uVar1 = (undefined2)iVar2;
}
return uVar1;
}
=========================================
Function at address: 0x18005b660
Called functions addresses: 0x18000a230


void FUN_18005b660(longlong param_1,PUCHAR param_2,ULONG param_3,PUCHAR param_4)

{
int iVar1;

iVar1 = FUN_18000a230(DAT_180092a48,param_1,param_2,param_3,param_4,0x10);
if (iVar1 == 0) {
FUN_18000a230(DAT_180092a50,param_1,param_2,param_3,param_4 + 0x10,0x14);
}
return;
}
=========================================
Function at address: 0x18005b6e8
Called functions addresses: None


undefined8 FUN_18005b6e8(longlong param_1,int param_2)

{
uint uVar1;
ulonglong uVar2;
int *piVar3;

uVar2 = 0;
if (*(uint *)(param_1 + 0x224) != 0) {
piVar3 = (int *)(param_1 + 0x2d0);
do {
if (*piVar3 == param_2) {
return *(undefined8 *)(param_1 + 0x250 + uVar2 * 8);
}
uVar1 = (int)uVar2 + 1;
uVar2 = (ulonglong)uVar1;
piVar3 = piVar3 + 1;
} while (uVar1 < *(uint *)(param_1 + 0x224));
}
return 0;
}
=========================================
Function at address: 0x18005b730
Called functions addresses: 0x180009470 0x180009e8c


ulonglong FUN_18005b730(longlong *param_1,uint *param_2,char param_3,undefined param_4)

{
ulonglong uVar1;
uint uVar2;
longlong lVar3;
uint uVar4;
int iVar5;

iVar5 = 2;
if ((*(ushort *)(param_1 + 4) & 4) != 0) {
uVar2 = *(uint *)((longlong)param_1 + 0x34);
uVar4 = *(int *)(param_1 + 6) + 2;
if (uVar2 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar2 = uVar2 - uVar4 % uVar2;
}
uVar4 = uVar4 + uVar2;
}
iVar5 = uVar4 + *(int *)((longlong)param_1 + 0x2c);
}
uVar2 = *(uint *)((longlong)param_1 + 0x3c);
if ((*(ushort *)(param_1 + 4) & 4) == 0) {
uVar4 = 0;
}
else {
uVar4 = *(uint *)((longlong)param_1 + 0x2c);
}
if (param_3 == '\x01' || param_3 == '\x02') {
uVar1 = FUN_180009e8c((longlong)param_1,param_2,uVar2 + iVar5);
if ((int)uVar1 == 0) {
lVar3 = *(longlong *)(param_2 + 2) + (ulonglong)uVar2;
*(char *)(lVar3 + (ulonglong)uVar4) = param_3;
*(undefined *)(lVar3 + 1 + (ulonglong)uVar4) = param_4;
uVar1 = FUN_180009470(param_1,param_2,0x15,2);
}
}
else {
uVar1 = 0x57;
}
return uVar1;
}
=========================================
Function at address: 0x18005b81c
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18005b81c(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,8,0);
return;
}
=========================================
Function at address: 0x18005b870
Called functions addresses: 0xEXTERNAL:0000016e 0x18000909c


void FUN_18005b870(longlong param_1)

{
if (*(BCRYPT_ALG_HANDLE *)(param_1 + 0x18) != (BCRYPT_ALG_HANDLE)0x0) {
BCryptCloseAlgorithmProvider(*(BCRYPT_ALG_HANDLE *)(param_1 + 0x18),0);
*(undefined8 *)(param_1 + 0x18) = 0;
}
if (*(HLOCAL *)(param_1 + 8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 8));
}
*(undefined4 *)(param_1 + 0x10) = 0;
return;
}
=========================================
Function at address: 0x18005b8b4
Called functions addresses: 0x180028a7c 0x18005b870


longlong FUN_18005b8b4(longlong param_1)

{
FUN_18005b870(param_1);
_o_free(param_1);
return param_1;
}
=========================================
Function at address: 0x18005b8dc
Called functions addresses: 0xEXTERNAL:00000165 0xEXTERNAL:00000167 0xEXTERNAL:00000166 0xEXTERNAL:00000171


NTSTATUS FUN_18005b8dc(ULONG *param_1,PUCHAR param_2,ULONG param_3,PUCHAR param_4,ULONG param_5,
PUCHAR param_6,ULONG param_7,PUCHAR param_8)

{
NTSTATUS NVar1;
BCRYPT_HASH_HANDLE local_res8;

local_res8 = (BCRYPT_HASH_HANDLE)0x0;
NVar1 = BCryptCreateHash(*(BCRYPT_ALG_HANDLE *)(param_1 + 6),&local_res8,(PUCHAR)0x0,0,
*(PUCHAR *)(param_1 + 2),*param_1,0);
if (-1 < NVar1) {
NVar1 = BCryptHashData(local_res8,param_2,param_3,0);
if (-1 < NVar1) {
NVar1 = BCryptHashData(local_res8,param_4,param_5,0);
if (-1 < NVar1) {
NVar1 = BCryptHashData(local_res8,param_6,param_7,0);
if (-1 < NVar1) {
NVar1 = BCryptFinishHash(local_res8,param_8,param_1[8],0);
if (-1 < NVar1) {
NVar1 = 0;
}
}
}
}
}
if (local_res8 != (BCRYPT_HASH_HANDLE)0x0) {
BCryptDestroyHash(local_res8);
}
return NVar1;
}
=========================================
Function at address: 0x18005ba0c
Called functions addresses: 0xEXTERNAL:00000086 0x18000eb9c


ulonglong FUN_18005ba0c(ULONG *param_1)

{
ulonglong uVar1;
ULONGLONG UVar2;
ulonglong uVar3;

if (DAT_180092f78 == 0) {
uVar3 = 0xc;
}
else {
uVar1 = FUN_18000eb9c(*(PUCHAR *)(param_1 + 2),*param_1);
uVar3 = uVar1 & 0xffffffff;
if (-1 < (int)uVar1) {
UVar2 = GetTickCount64();
*(ULONGLONG *)(param_1 + 0xe) = UVar2;
}
}
return uVar3;
}
=========================================
Function at address: 0x18005ba60
Called functions addresses: 0x18005b8dc 0x180028070 0x18002a76f


void FUN_18005ba60(ULONG *param_1,PUCHAR param_2,ULONG param_3,PUCHAR param_4,ULONG param_5,
PUCHAR param_6,ULONG param_7)

{
NTSTATUS NVar1;
undefined auStackY_88 [32];
UCHAR local_48 [32];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStackY_88;
local_48[0] = '\0';
local_48[1] = '\0';
local_48[2] = '\0';
local_48[3] = '\0';
local_48[4] = '\0';
local_48[5] = '\0';
local_48[6] = '\0';
local_48[7] = '\0';
local_48[8] = '\0';
local_48[9] = '\0';
local_48[10] = '\0';
local_48[0xb] = '\0';
local_48[0xc] = '\0';
local_48[0xd] = '\0';
local_48[0xe] = '\0';
local_48[0xf] = '\0';
local_48[0x10] = '\0';
local_48[0x11] = '\0';
local_48[0x12] = '\0';
local_48[0x13] = '\0';
local_48[0x14] = '\0';
local_48[0x15] = '\0';
local_48[0x16] = '\0';
local_48[0x17] = '\0';
local_48[0x18] = '\0';
local_48[0x19] = '\0';
local_48[0x1a] = '\0';
local_48[0x1b] = '\0';
local_48[0x1c] = '\0';
local_48[0x1d] = '\0';
local_48[0x1e] = '\0';
local_48[0x1f] = '\0';
NVar1 = FUN_18005b8dc(param_1,param_2,param_3,param_4,param_5,param_6,param_7,local_48);
if (-1 < NVar1) {
memcmp(param_4 + -0x20,local_48,0x20);
}
FUN_180028070(local_28 ^ (ulonglong)auStackY_88);
return;
}
=========================================
Function at address: 0x18005baf8
Called functions addresses: 0xEXTERNAL:000000da 0x180029f58 0x18005b8b4 0x18005bbc8 0xEXTERNAL:000000e0


ulonglong FUN_18005baf8(longlong *param_1)

{
uint *puVar1;
ulonglong uVar2;
ulonglong uVar3;

uVar3 = 0;
if (DAT_180092f78 == (uint *)0x0) {
RtlEnterCriticalSection(&DAT_180092ca0);
puVar1 = DAT_180092f78;
if (DAT_180092f78 == (uint *)0x0) {
puVar1 = (uint *)FUN_180029f58(0x40);
if (puVar1 == (uint *)0x0) {
uVar3 = 0xc0000017;
puVar1 = DAT_180092f78;
}
else {
puVar1[2] = 0;
puVar1[3] = 0;
puVar1[4] = 0;
puVar1[6] = 0;
puVar1[7] = 0;
puVar1[8] = 0;
puVar1[9] = 0;
puVar1[10] = 0;
*puVar1 = 0x20;
puVar1[0xc] = 600000;
puVar1[0xd] = 0;
uVar2 = FUN_18005bbc8(puVar1);
uVar3 = uVar2 & 0xffffffff;
if ((int)uVar2 < 0) {
FUN_18005b8b4((longlong)puVar1);
puVar1 = DAT_180092f78;
}
}
}
DAT_180092f78 = puVar1;
RtlLeaveCriticalSection(&DAT_180092ca0);
}
*param_1 = (longlong)DAT_180092f78;
return uVar3;
}
=========================================
Function at address: 0x18005bbc8
Called functions addresses: 0xEXTERNAL:00000169 0x18000eb9c 0xEXTERNAL:0000016d 0x18000a1f4


ulonglong FUN_18005bbc8(uint *param_1)

{
BCRYPT_ALG_HANDLE *phAlgorithm;
NTSTATUS NVar1;
PUCHAR pUVar2;
ulonglong uVar3;
undefined4 extraout_var;
undefined4 extraout_var_00;
undefined4 extraout_var_01;

pUVar2 = (PUCHAR)FUN_18000a1f4((ulonglong)*param_1);
*(PUCHAR *)(param_1 + 2) = pUVar2;
if (pUVar2 == (PUCHAR)0x0) {
uVar3 = 0xc000009a;
}
else {
uVar3 = FUN_18000eb9c(pUVar2,*param_1);
if (-1 < (int)uVar3) {
phAlgorithm = (BCRYPT_ALG_HANDLE *)(param_1 + 6);
NVar1 = BCryptOpenAlgorithmProvider(phAlgorithm,L"SHA256",(LPCWSTR)0x0,8);
uVar3 = CONCAT44(extraout_var,NVar1);
if (-1 < NVar1) {
NVar1 = BCryptGetProperty(*phAlgorithm,L"HashDigestLength",(PUCHAR)(param_1 + 8),4,
param_1 + 9,0);
uVar3 = CONCAT44(extraout_var_00,NVar1);
if (-1 < NVar1) {
NVar1 = BCryptGetProperty(*phAlgorithm,L"ObjectLength",(PUCHAR)(param_1 + 10),4,
param_1 + 9,0);
uVar3 = CONCAT44(extraout_var_01,NVar1);
if (-1 < NVar1) {
param_1[4] = 1;
uVar3 = 0;
}
}
}
}
}
return uVar3;
}
=========================================
Function at address: 0x18005bcb0
Called functions addresses: 0xEXTERNAL:00000169 0x18005c184 0xEXTERNAL:0000003c 0xEXTERNAL:00000168 0xEXTERNAL:0000011f 0x180028070 0x18005c020 0x180028d90 0x18002a7c0 0xEXTERNAL:00000170 0xEXTERNAL:00000040 0xEXTERNAL:000000c2 0x18005b470 0x18000a1f4 0xEXTERNAL:000000c0


void FUN_18005bcb0(longlong *param_1,wchar_t *param_2,undefined8 param_3,undefined4 param_4,
undefined4 param_5,ULONG param_6,BYTE *param_7,uint param_8)

{
uint uVar1;
int iVar2;
NTSTATUS NVar3;
longlong lVar4;
PUCHAR hMem;
undefined8 uVar5;
undefined4 uVar6;
undefined8 *pPaddingInfo;
undefined auStackY_108 [32];
uint local_c8;
uint local_c4;
ULONG local_c0;
longlong local_b8;
BCRYPT_KEY_HANDLE local_b0;
ulonglong local_a8;
undefined8 local_a0;
undefined8 local_98;
undefined8 uStack_90;
UCHAR local_88 [64];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_108;
local_b0 = (BCRYPT_HANDLE)0x0;
hMem = (PUCHAR)0x0;
pPaddingInfo = (undefined8 *)0x0;
local_c0 = 0x40;
memset(local_88,0,0x40);
local_a0 = 0;
local_98 = 0;
uStack_90 = 0;

RtlAcquireResourceShared(local_b8 + 0x48,1);
local_a8 = *(ulonglong *)(local_b8 + 0x10);
iVar2 = wcsncmp(param_2,L"RSA",3);
if (iVar2 == 0) {
if (param_6 == 8) {
pPaddingInfo = &local_98;
uStack_90 = CONCAT44(uStack_90._4_4_,param_5);
local_98 = param_3;
}
else {
if (param_6 != 2) goto LAB_18005bfda;
pPaddingInfo = &local_a0;
local_a0 = param_3;
}
}

if (lVar4 == 0) {
RtlReleaseResource(local_b8 + 0x48);
iVar2 = 0x54f;
uVar6 = 0x517;
}
else {
if ((undefined8 *)param_1[1] == (undefined8 *)0x0) {
uVar5 = 0;
}
else {
uVar5 = *(undefined8 *)param_1[1];
}
iVar2 = SslComputeClientAuthHash(uVar5,local_a8,lVar4,param_2);
RtlReleaseResource(local_b8 + 0x48);
if (iVar2 == 0) {
iVar2 = FUN_18005c020((longlong)param_1,param_2,&local_b0);
if (iVar2 == 0) {
iVar2 = wcsncmp(param_2,L"RSA",3);
if (iVar2 == 0) {
LAB_18005bf81:
NVar3 = BCryptVerifySignature
(local_b0,pPaddingInfo,local_88,local_c0,param_7,param_8,param_6);
if (NVar3 != 0) {
FUN_18005b470(param_1,0x51a,NVar3,0x33);
}
if (hMem == (PUCHAR)0x0) goto LAB_18005bfda;
}
else {
local_c8 = 0;
local_a8 = local_a8 & 0xffffffff00000000;
iVar2 = wcsncmp(param_2,L"DSA",3);
uVar1 = 0x2f;
if (iVar2 == 0) {
uVar1 = 0x28;
}
NVar3 = BCryptGetProperty(local_b0,L"KeyLength",(PUCHAR)&local_c8,4,(ULONG *)&local_a8,0);
if ((NVar3 != 0) || (iVar2 = (local_c8 >> 3) + (uint)((local_c8 & 7) != 0), iVar2 == 0))
goto LAB_18005bfda;
local_c4 = iVar2 * 2;
hMem = (PUCHAR)FUN_18000a1f4((ulonglong)local_c4);
if (hMem == (PUCHAR)0x0) goto LAB_18005bfda;
uVar5 = FUN_18005c184(param_7,param_8,hMem,&local_c4,(LPCSTR)(ulonglong)uVar1);
param_7 = hMem;
param_8 = local_c4;
if ((int)uVar5 == 0) goto LAB_18005bf81;
FUN_18005b470(param_1,0x519,(int)uVar5,0x32);
}
LocalFree(hMem);
goto LAB_18005bfda;
}
uVar6 = 0x518;
}
else {
uVar6 = 0x517;
}
}
FUN_18005b470(param_1,uVar6,iVar2,0x50);
LAB_18005bfda:
if (local_b0 != (BCRYPT_KEY_HANDLE)0x0) {
BCryptDestroyKey(local_b0);
}
FUN_180028070(local_48 ^ (ulonglong)auStackY_108);
return;
}
=========================================
Function at address: 0x18005c020
Called functions addresses: 0x18005c498 0xEXTERNAL:0000003c 0xEXTERNAL:000000c2 0xEXTERNAL:000000c0 0xEXTERNAL:00000123


int FUN_18005c020(longlong param_1,wchar_t *param_2,BCRYPT_KEY_HANDLE *param_3)

{
DWORD *pDVar1;
int iVar2;
BOOL BVar3;
int iVar4;

iVar4 = 0;
iVar2 = wcsncmp(param_2,L"ECDSA",5);
if (iVar2 == 0) {
RtlAcquireResourceShared(*(longlong *)(param_1 + 0x58) + 0x48,1);
pDVar1 = *(DWORD **)(*(longlong *)(param_1 + 0x58) + 0x30);
BVar3 = CryptImportPublicKeyInfoEx2
(*pDVar1,(PCERT_PUBLIC_KEY_INFO)(*(longlong *)(pDVar1 + 6) + 0x60),0x80000000,
(void *)0x0,param_3);
RtlReleaseResource(*(longlong *)(param_1 + 0x58) + 0x48);
if (BVar3 == 0) {
iVar4 = -0x7ff6fcfc;
}
}
else {
iVar4 = FUN_18005c498(param_1,param_2,param_3);
}
return iVar4;
}
=========================================
Function at address: 0x18005c0f0
Called functions addresses: 0xEXTERNAL:000000c9 0xEXTERNAL:000000c7


undefined8 FUN_18005c0f0(byte *param_1,uint param_2,char param_3,longlong param_4)

{
undefined4 uVar1;
undefined8 uVar2;
ushort local_18;
ushort local_16;
undefined4 local_14;
byte *local_10;

local_14 = 0;
if ((((param_1 == (byte *)0x0) || (param_4 == 0)) || (*(longlong *)(param_4 + 8) == 0)) ||
(param_2 == 0)) {
LAB_18005c172:
uVar2 = 0x57;
}
else {
if (param_3 == '\0') {
local_18 = (ushort)*param_1;
if (param_2 - 1 < (uint)*param_1) {
return 0x54f;
}
param_1 = param_1 + 1;
}
else {
if (0xff < param_2) goto LAB_18005c172;
local_18 = (ushort)param_2;
}
local_16 = local_18;
local_10 = param_1;
uVar1 = RtlAnsiStringToUnicodeString(param_4,&local_18,0);
uVar2 = RtlNtStatusToDosError(uVar1);
}
return uVar2;
}
=========================================
Function at address: 0x18005c184
Called functions addresses: 0x180001e7c 0x180053714 0xEXTERNAL:0000014e 0x18000a1f4 0x18002a77b 0x18000909c


undefined8
FUN_18005c184(BYTE *param_1,DWORD param_2,undefined *param_3,uint *param_4,LPCSTR param_5)

{
BOOL BVar1;
uint *pvStructInfo;
undefined8 uVar2;
uint uVar3;
DWORD local_28 [4];

uVar2 = 0;
local_28[0] = 0;
BVar1 = CryptDecodeObject(1,param_5,param_1,param_2,0,(void *)0x0,local_28);
if (BVar1 == 0) {
return 0x80090304;
}
pvStructInfo = (uint *)FUN_18000a1f4((ulonglong)local_28[0]);
if (pvStructInfo == (uint *)0x0) {
return 0x80090300;
}
BVar1 = CryptDecodeObject(1,param_5,param_1,param_2,0,pvStructInfo,local_28);
if (BVar1 == 0) {
LAB_18005c2e1:
uVar2 = 0x80090304;
}
else {
if (param_5 == (LPCSTR)0x2f) {
uVar3 = *param_4 >> 1;
if ((*pvStructInfo <= uVar3) && (pvStructInfo[4] <= uVar3)) {
memcpy(param_3,*(void **)(pvStructInfo + 2),(ulonglong)*pvStructInfo);
memcpy(param_3 + (*param_4 >> 1),*(void **)(pvStructInfo + 6),(ulonglong)pvStructInfo[4]);
FUN_180001e7c(param_3,uVar3);
FUN_180001e7c(param_3 + (*param_4 >> 1),*param_4 >> 1);
goto LAB_18005c2e6;
}
}
else {
if (param_5 != (LPCSTR)0x28) goto LAB_18005c2e1;
if (local_28[0] <= *param_4) {
FUN_180053714(param_3,(undefined *)pvStructInfo,(ulonglong)(local_28[0] >> 1));
FUN_180053714(param_3 + (local_28[0] >> 1),
(undefined *)((ulonglong)(local_28[0] >> 1) + (longlong)pvStructInfo),
(ulonglong)(local_28[0] >> 1));
*param_4 = local_28[0];
goto LAB_18005c2e6;
}
}
uVar2 = 0x80090326;
}
LAB_18005c2e6:
FUN_18000909c(pvStructInfo);
return uVar2;
}
=========================================
Function at address: 0x18005c318
Called functions addresses: 0xEXTERNAL:000000a7


uint FUN_18005c318(uint *param_1,longlong param_2)

{
uint in_EAX;
uint uVar1;
ulonglong uVar2;

if (((param_1 != (uint *)0x0) && (*param_1 != 0)) && (param_2 != 0)) {
uVar2 = 0;
do {
in_EAX = RtlCompareUnicodeString(uVar2 * 0x10 + *(longlong *)(param_1 + 2),param_2,1);
if (in_EAX == 0) {
return 1;
}
uVar1 = (int)uVar2 + 1;
uVar2 = (ulonglong)uVar1;
} while (uVar1 < *param_1);
}
return in_EAX & 0xffffff00;
}
=========================================
Function at address: 0x18005c384
Called functions addresses: 0xEXTERNAL:00000183 0xEXTERNAL:00000040 0xEXTERNAL:00000182 0xEXTERNAL:0000012f 0x18000a1f4


int FUN_18005c384(DWORD *param_1,undefined8 *param_2,DWORD *param_3)

{
BOOL BVar1;
BYTE *pbData;
int iVar2;
HCRYPTKEY local_res8;

*param_2 = 0;
local_res8 = 0;
BVar1 = CryptImportPublicKeyInfoEx
(DAT_180092a30,*param_1,
(PCERT_PUBLIC_KEY_INFO)(*(longlong *)(param_1 + 6) + 0x60),0x2200,0,(void *)0x0
,&local_res8);
if ((BVar1 == 0) || (BVar1 = CryptExportKey(local_res8,0,6,0x80,(BYTE *)0x0,param_3), BVar1 == 0))
{
iVar2 = -0x7ff6fcfc;
}
else {
pbData = (BYTE *)FUN_18000a1f4((ulonglong)*param_3);
*param_2 = pbData;
if (pbData == (BYTE *)0x0) {
iVar2 = -0x7ff6fd00;
}
else {
BVar1 = CryptExportKey(local_res8,0,6,0x80,pbData,param_3);
iVar2 = 0;
if (BVar1 == 0) {
iVar2 = -0x7ff6fcfc;
}
}
}
if (local_res8 != 0) {
CryptDestroyKey(local_res8);
}
if (iVar2 != 0) {
LocalFree((HLOCAL)*param_2);
*param_2 = 0;
}
return iVar2;
}
=========================================
Function at address: 0x18005c498
Called functions addresses: 0xEXTERNAL:0000003c 0xEXTERNAL:00000121 0xEXTERNAL:00000040 0xEXTERNAL:000000c2 0xEXTERNAL:000000c0 0x18000a1f4 0xEXTERNAL:00000175 0xEXTERNAL:0000011d 0x18005c384 0xEXTERNAL:00000108 0x18000909c


int FUN_18005c498(longlong param_1,wchar_t *param_2,BCRYPT_KEY_HANDLE *param_3)

{
undefined8 *puVar1;
int iVar2;
PBYTE pbData;
DWORD cbData;
PBYTE pBVar3;
PBYTE pbOutput;
BCRYPT_ALG_HANDLE hAlgorithm;
PBYTE pBVar4;
wchar_t *pszBlobType;
DWORD local_res18 [2];
DWORD local_res20 [2];
NCRYPT_KEY_HANDLE local_58;
PBYTE local_50;
wchar_t *local_48;

pBVar4 = (PBYTE)0x0;
*param_3 = (BCRYPT_KEY_HANDLE)0x0;
local_58 = 0;
local_res18[0] = 0;
local_50 = (PBYTE)0x0;
local_res20[0] = 0;
pbOutput = (PBYTE)0x0;
iVar2 = wcsncmp(param_2,L"DSA",3);
hAlgorithm = DAT_180092a40;
if (iVar2 == 0) {
pszBlobType = L"DSAPUBLICBLOB";
local_48 = L"CAPIDSAPUBLICBLOB";
RtlAcquireResourceShared(*(longlong *)(param_1 + 0x58) + 0x48,1);
iVar2 = FUN_18005c384(*(DWORD **)(*(longlong *)(param_1 + 0x58) + 0x30),&local_50,local_res20);
pbData = local_50;
pBVar3 = local_50;
cbData = local_res20[0];
if (iVar2 != 0) {
RtlReleaseResource(*(longlong *)(param_1 + 0x58) + 0x48);
pBVar3 = local_50;
pbOutput = pBVar4;
goto LAB_18005c6da;
}
}
else {
iVar2 = wcsncmp(param_2,L"RSA",3);
hAlgorithm = DAT_180092a38;
pBVar3 = pBVar4;
if (iVar2 != 0) {
iVar2 = -0x7ff6fcfc;
goto LAB_18005c6da;
}
pszBlobType = L"RSAPUBLICBLOB";
local_48 = L"CAPIPUBLICBLOB";
RtlAcquireResourceShared(*(longlong *)(param_1 + 0x58) + 0x48,1);
puVar1 = *(undefined8 **)(*(longlong *)(param_1 + 0x58) + 0x28);
pbData = (PBYTE)*puVar1;
cbData = *(DWORD *)(puVar1 + 1);
}
iVar2 = NCryptImportKey(DAT_1800925a8,0,local_48,(NCryptBufferDesc *)0x0,&local_58,pbData,cbData,8
);
RtlReleaseResource(*(longlong *)(param_1 + 0x58) + 0x48);
if ((iVar2 == 0) &&
(iVar2 = NCryptExportKey(local_58,0,pszBlobType,(NCryptBufferDesc *)0x0,(PBYTE)0x0,0,
local_res18,0), -1 < iVar2)) {
pbOutput = (PBYTE)FUN_18000a1f4((ulonglong)local_res18[0]);
if (pbOutput == (PBYTE)0x0) {
iVar2 = -0x7ff6fd00;
}
else {
iVar2 = NCryptExportKey(local_58,0,pszBlobType,(NCryptBufferDesc *)0x0,pbOutput,local_res18[0]
,local_res18,0);
if ((iVar2 == 0) &&
(iVar2 = BCryptImportKeyPair(hAlgorithm,(BCRYPT_KEY_HANDLE)0x0,pszBlobType,param_3,pbOutput
,local_res18[0],0), iVar2 != 0)) {
iVar2 = -0x7ff6fcf3;
}
}
}
LAB_18005c6da:
if (pBVar3 != (PBYTE)0x0) {
LocalFree(pBVar3);
}
if (pbOutput != (PBYTE)0x0) {
FUN_18000909c(pbOutput);
}
if (local_58 != 0) {
NCryptFreeObject(local_58);
}
return iVar2;
}
=========================================
Function at address: 0x18005c734
Called functions addresses: 0x18005cc0c 0xEXTERNAL:0000003c 0x180059d38 0xEXTERNAL:000000a7 0x18005a174


ulonglong FUN_18005c734(uint *param_1,uint param_2,uint param_3,longlong param_4,char param_5)

{
uint *puVar1;
int iVar2;
ulonglong uVar3;
int *piVar4;
undefined uVar5;
uint uVar6;
int *piVar7;

uVar3 = (ulonglong)param_2;
if ((param_2 == 0) || (param_1 == (uint *)0x0)) {
LAB_18005c91d:
uVar3 = (ulonglong)register0x00000020 & 0xffffffffffffff00;
}
else {
if (param_3 == 0) {
register0x00000020 = (BADSPACEBASE *)FUN_180059d38(0xaa02);
if ((undefined8 *)register0x00000020 == (undefined8 *)0x0) goto LAB_18005c91d;
param_3 = *(uint *)((longlong)register0x00000020 + 0x30);
}
puVar1 = param_1 + uVar3 * 10;
if (param_1 < puVar1) {
uVar5 = 1;
do {
if (param_1[5] != 0) {
if (*param_1 == 0) {
LAB_18005c7e8:
if ((param_5 == '\0') || ((*(byte *)(param_1 + 8) & 1) == 0)) {
register0x00000020 = (BADSPACEBASE *)(ulonglong)param_1[5];
piVar7 = *(int **)(param_1 + 6);
piVar4 = piVar7 + (longlong)register0x00000020 * 0xc;
for (; piVar7 < piVar4; piVar7 = piVar7 + 0xc) {
if (((*piVar7 == 0) && (*(short *)(piVar7 + 2) == 4)) &&
(iVar2 = wcsncmp(*(wchar_t **)(piVar7 + 4),L"DH",2), iVar2 == 0)) {
if (((piVar7[6] == 0) && (piVar7[10] == 0)) && (piVar7[0xb] == 0)) {
register0x00000020 = (BADSPACEBASE *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
register0x00000020 =
(BADSPACEBASE *)
FUN_18005a174(DAT_180091000[2],0xc,&DAT_180082b78,L"DH",0);
}
goto LAB_18005c896;
}
if (param_3 != 0) {
if (piVar7[10] != 0) {
if ((uint)piVar7[10] <= param_3) goto LAB_18005c863;
LAB_18005c8da:
register0x00000020 = (BADSPACEBASE *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
register0x00000020 =
(BADSPACEBASE *)
FUN_18005cc0c(DAT_180091000[2],0xe,&DAT_180082b78,L"DH",(char)param_3,0
);
}
goto LAB_18005c896;
}
if (piVar7[0xb] != 0) {
LAB_18005c863:
if ((piVar7[0xb] != 0) && ((uint)piVar7[0xb] < param_3)) goto LAB_18005c8da;
}
}
}
register0x00000020 = (BADSPACEBASE *)(ulonglong)param_1[5];
piVar4 = (int *)((longlong)register0x00000020 * 0x30 + *(longlong *)(param_1 + 6));
}
}
}
else if (param_4 != 0) {
uVar6 = 0;
do {
register0x00000020 =
(BADSPACEBASE *)
RtlCompareUnicodeString
((ulonglong)uVar6 * 0x10 + *(longlong *)(param_1 + 2),param_4,1);
if ((int)register0x00000020 == 0) goto LAB_18005c7e8;
uVar6 = uVar6 + 1;
} while (uVar6 < *param_1);
}
}
param_1 = param_1 + 10;
} while (param_1 < puVar1);
}
uVar5 = 0;
LAB_18005c896:
uVar3 = CONCAT71((int7)((ulonglong)register0x00000020 >> 8),uVar5);
}
return uVar3;
}
=========================================
Function at address: 0x18005c948
Called functions addresses: 0x1800077a0


ulonglong FUN_18005c948(uint *param_1,uint param_2,int param_3,longlong param_4)

{
ulonglong in_RAX;
ulonglong uVar1;
wchar_t *pwVar2;

if ((param_2 == 0) || (param_1 == (uint *)0x0)) {
LAB_18005c9a5:
uVar1 = in_RAX & 0xffffffffffffff00;
}
else {
if (param_3 == 1) {
pwVar2 = L"RSA";
}
else if (param_3 == 2) {
pwVar2 = L"DSA";
}
else {
if (param_3 != 0x40) goto LAB_18005c9a5;
pwVar2 = L"ECDSA";
}
uVar1 = FUN_1800077a0(param_1,param_2,1,pwVar2,(wchar_t *)0x0,0,param_4,'\x01');
}
return uVar1;
}
=========================================
Function at address: 0x18005c9b4
Called functions addresses: 0x180044ccc 0xEXTERNAL:00000041 0xEXTERNAL:0000007a 0xEXTERNAL:0000017c


DWORD FUN_18005c9b4(HCRYPTPROV *param_1,LPCWSTR param_2,LPCWSTR param_3,DWORD param_4,uint param_5)

{
BOOL BVar1;
DWORD DVar2;
DWORD DVar3;

DVar2 = 0;
BVar1 = CryptAcquireContextW(param_1,param_2,param_3,param_4,param_5 & 0xfffffffe);
if (BVar1 == 0) {
DVar2 = GetLastError();
DVar3 = GetCurrentProcessId();
FUN_180044ccc(DVar3,L"<UNKNOWN>",'\0',(char)DVar2,0x271e);
}
return DVar2;
}
=========================================
Function at address: 0x18005ca1c
Called functions addresses: 0x180041cdc 0xEXTERNAL:00000100 0xEXTERNAL:0000011e 0xEXTERNAL:00000108


SECURITY_STATUS
FUN_18005ca1c(NCRYPT_KEY_HANDLE *param_1,LPCWSTR param_2,LPCWSTR param_3,DWORD param_4,uint param_5,
int param_6,undefined4 *param_7)

{
uint uVar1;
SECURITY_STATUS SVar2;
undefined2 uVar3;
NCRYPT_PROV_HANDLE local_28 [2];

local_28[0] = 0;
if (param_7 != (undefined4 *)0x0) {
*param_7 = 0;
}
uVar1 = param_5 | 0x40;
if (param_6 != 0) {
uVar1 = param_5;
}
SVar2 = NCryptOpenStorageProvider(local_28,param_3,0);
if (SVar2 == 0) {
if (param_7 != (undefined4 *)0x0) {
*param_7 = 1;
}
SVar2 = NCryptOpenKey(local_28[0],param_1,param_2,param_4,uVar1 & 0xfffffffe);
if (((SVar2 == 0) || ((undefined8 **)DAT_180091000 == &DAT_180091000)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18005cb0f;
uVar3 = 0xb;
}
else {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18005cb0f;
uVar3 = 10;
}
FUN_180041cdc(DAT_180091000[2],uVar3,&DAT_180082b78,SVar2);
LAB_18005cb0f:
if (local_28[0] != 0) {
NCryptFreeObject(local_28[0]);
}
return SVar2;
}
=========================================
Function at address: 0x18005cb48
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18005cb48(undefined8 param_1,undefined8 param_2,undefined8 param_3,wchar_t *param_4,
wchar_t *param_5)

{
longlong lVar1;
longlong lVar2;
longlong lVar3;

lVar1 = -1;
lVar3 = 10;
if (param_5 == (wchar_t *)0x0) {
lVar2 = 10;
}
else {
lVar2 = -1;
do {
lVar2 = lVar2 + 1;
} while (param_5[lVar2] != L'\0');
lVar2 = lVar2 * 2 + 2;
}
if (param_5 == (wchar_t *)0x0) {
param_5 = L"NULL";
}
if (param_4 != (wchar_t *)0x0) {
do {
lVar1 = lVar1 + 1;
} while (param_4[lVar1] != L'\0');
lVar3 = lVar1 * 2 + 2;
}
if (param_4 == (wchar_t *)0x0) {
param_4 = L"NULL";
}
EtwTraceMessage(param_1,0x2b,&DAT_180082b78,0xd,param_4,lVar3,param_5,lVar2,&stack0x00000030,4,0);
return;
}
=========================================
Function at address: 0x18005cc0c
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18005cc0c(undefined8 param_1,undefined2 param_2,undefined8 param_3,wchar_t *param_4,
undefined param_5,undefined param_6)

{
longlong lVar1;

if (param_4 == (wchar_t *)0x0) {
lVar1 = 10;
}
else {
lVar1 = -1;
do {
lVar1 = lVar1 + 1;
} while (param_4[lVar1] != L'\0');
lVar1 = lVar1 * 2 + 2;
}
if (param_4 == (wchar_t *)0x0) {
param_4 = L"NULL";
}
EtwTraceMessage(param_1,0x2b,param_3,param_2,param_4,lVar1,&param_5,4,&param_6,4,0);
return;
}
=========================================
Function at address: 0x18005cca0
Called functions addresses: 0x180004080 0x18000909c


undefined8 * FUN_18005cca0(undefined8 *param_1,uint param_2)

{
FUN_180004080(param_1);
if ((param_2 & 1) != 0) {
FUN_18000909c(param_1);
}
return param_1;
}
=========================================
Function at address: 0x18005cce0
Called functions addresses: 0x180016390


ulonglong FUN_18005cce0(longlong param_1,int *param_2,short *param_3,uint param_4)

{
ulonglong in_RAX;
ulonglong uVar1;

if (((param_4 & 0x10001) == 0) ||
(((param_4 >> 0x10 & 1) == 0 &&
(((param_2 == (int *)0x0 ||
(in_RAX = (ulonglong)(uint)*param_2, *(uint *)(param_1 + 0x178) != *param_2)) ||
(in_RAX = (ulonglong)(uint)param_2[1], *(uint *)(param_1 + 0x17c) != param_2[1])))))) {
LAB_18005cd23:
uVar1 = in_RAX & 0xffffffffffffff00;
}
else {
if (param_3 != (short *)0x0) {
in_RAX = FUN_180016390(param_1,param_3);
if ((char)in_RAX == '\0') goto LAB_18005cd23;
}
uVar1 = CONCAT71((int7)(in_RAX >> 8),1);
}
return uVar1;
}
=========================================
Function at address: 0x18005cd40
Called functions addresses: None


bool FUN_18005cd40(void)

{
uint in_R9D;

return (in_R9D & 0x20002) != 0;
}
=========================================
Function at address: 0x18005cd60
Called functions addresses: None


void FUN_18005cd60(longlong param_1,undefined8 param_2,longlong param_3)

{
int *piVar1;
longlong lVar2;

lVar2 = *(longlong *)(param_3 + 8);
*(longlong *)(param_1 + 0xb0) = lVar2;
*(undefined4 *)(param_1 + 0xb8) = *(undefined4 *)(param_3 + 0x10);
if (*(longlong *)(lVar2 + 0x350) != 0) {
LOCK();
piVar1 = (int *)(*(longlong *)(*(longlong *)(lVar2 + 0x350) + 0x10) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
}
LOCK();
piVar1 = (int *)(*(longlong *)(lVar2 + 0x358) + 0xc);
*piVar1 = *piVar1 + 1;
UNLOCK();
return;
}
=========================================
Function at address: 0x18005cda0
Called functions addresses: 0x18005ce74


ulonglong FUN_18005cda0(longlong param_1,longlong param_2,int *param_3)

{
ulonglong uVar1;
int local_res10 [6];

local_res10[0] = 0;
if ((param_2 == 0) || (param_3 == (int *)0x0)) {
uVar1 = 0x57;
}
else {
uVar1 = FUN_18005ce74(param_1,param_2,local_res10);
if ((int)uVar1 == 0) {
*param_3 = (uint)*(byte *)(param_1 + 0xd0) + *(int *)(param_1 + 0x40) +
*(int *)(param_1 + 0x20) + local_res10[0] + 0x43;
uVar1 = 0;
}
}
return uVar1;
}
=========================================
Function at address: 0x18005ce10
Called functions addresses: 0x18005cda0


ulonglong FUN_18005ce10(longlong param_1,longlong param_2,int *param_3)

{
ulonglong uVar1;
int local_res10 [6];

local_res10[0] = 0;
if ((param_2 == 0) || (param_3 == (int *)0x0)) {
uVar1 = 0x57;
}
else {
uVar1 = FUN_18005cda0(param_1,param_2,local_res10);
if ((int)uVar1 == 0) {
*param_3 = (-(uint)(*(longlong *)(param_1 + 0x150) != 0) & 0x14) + local_res10[0] + 0x27;
uVar1 = 0;
}
}
return uVar1;
}
=========================================
Function at address: 0x18005ce74
Called functions addresses: 0xEXTERNAL:00000113


ulonglong FUN_18005ce74(longlong param_1,longlong param_2,undefined4 *param_3)

{
uint uVar1;
ulonglong uVar2;

if ((param_2 == 0) || (param_3 == (undefined4 *)0x0)) {
uVar2 = 0x57;
}
else if (*(longlong *)(param_1 + 0x10) == 0) {
*param_3 = 0;
uVar2 = 0;
}
else {
uVar2 = 0;
if (*(ulonglong **)(param_2 + 8) != (ulonglong *)0x0) {
uVar2 = **(ulonglong **)(param_2 + 8);
}
uVar1 = SslExportKey(uVar2,*(undefined8 *)(param_1 + 0x10),L"OpaqueKeyBlob",0,0,param_3,0);
uVar2 = (ulonglong)uVar1;
if (uVar1 == 0x80090028) {
uVar2 = 0;
}
}
return uVar2;
}
=========================================
Function at address: 0x18005cef0
Called functions addresses: 0x180059d9c 0x18005d284 0x18005d304 0x180041cb0 0x18005d370 0x18005d4e8


ulonglong FUN_18005cef0(longlong param_1,longlong param_2,int *param_3,uint param_4)

{
uint uVar1;
int iVar2;
undefined4 uVar3;
ulonglong uVar4;
undefined4 extraout_var;
undefined4 extraout_var_00;

if ((((param_2 != 0) && (param_3 != (int *)0x0)) && (0x43 < param_4)) && (*param_3 == 1)) {
*(int *)(param_1 + 8) = param_3[1];
uVar1 = param_3[8];
*(uint *)(param_1 + 0xa8) = uVar1;
*(int *)(param_1 + 0xb8) = param_3[10];
if ((*(uint *)(param_2 + 0x40) & uVar1) == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180085800);
}
}
else {
uVar4 = FUN_180059d9c((ulonglong)uVar1,param_2,(longlong *)(param_1 + 0xb0),param_3[9],
param_3[10]);
if ((int)uVar4 != 0) {
return uVar4;
}
*(undefined8 *)(param_1 + 0xbc) = *(undefined8 *)(param_3 + 0xd);
*(int *)(param_1 + 0xd8) = param_3[0xb];
*(int *)(param_1 + 0xdc) = param_3[0xc];
if ((param_3[2] == 0x41) && (param_3[3] + 0x41U <= param_4)) {
uVar4 = FUN_18005d304(param_1,(longlong)param_3 + 0x41,param_3[3]);
if ((int)uVar4 != 0) {
return uVar4;
}
uVar1 = param_3[4];
if ((uVar1 == param_3[2] + param_3[3]) && (param_3[5] + uVar1 <= param_4)) {
uVar4 = FUN_18005d370(param_1,param_2,(uint *)((longlong)param_3 + (ulonglong)uVar1),
param_3[5]);
if ((int)uVar4 != 0) {
return uVar4;
}
uVar1 = param_3[6];
if ((uVar1 == param_3[5] + param_3[4]) && (param_3[7] + uVar1 <= param_4)) {
iVar2 = FUN_18005d284(param_1,(void *)((longlong)param_3 + (ulonglong)uVar1),param_3[7])
;
if (iVar2 != 0) {
return CONCAT44(extraout_var,iVar2);
}
if ((param_3[0xf] == param_3[7] + param_3[6]) &&
((uint)*(byte *)(param_3 + 0x10) + param_3[0xf] <= param_4)) {
uVar3 = FUN_18005d4e8(param_1,(void *)((ulonglong)(uint)param_3[0xf] +
(longlong)param_3),*(byte *)(param_3 + 0x10));
return CONCAT44(extraout_var_00,uVar3);
}
}
}
}
}
}
return 0x57;
}
=========================================
Function at address: 0x18005d0a0
Called functions addresses: 0x180041cb0 0x180055d18 0xEXTERNAL:000000c0 0xEXTERNAL:00000089 0x18005cef0 0xEXTERNAL:000000bc


ulonglong FUN_18005d0a0(longlong param_1,longlong param_2,int *param_3,uint param_4)

{
uint uVar1;
int iVar2;
ulonglong uVar3;
ulonglong uVar4;
_FILETIME local_res10;

local_res10.dwLowDateTime = 0;
local_res10.dwHighDateTime = 0;
if ((((param_2 == 0) || (param_3 == (int *)0x0)) || (param_4 < 0x28)) || (*param_3 != 0)) {
return 0x57;
}
GetSystemTimeAsFileTime(&local_res10);
local_res10 = (_FILETIME)((ulonglong)local_res10 / 10000);
uVar3 = *(ulonglong *)(param_3 + 6) / 10000;
if ((ulonglong)DAT_1800919c4 + (longlong)local_res10 < uVar3) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180085800);
}
return 0x576;
}
if (DAT_1800919c8 + uVar3 + (ulonglong)DAT_1800919c4 < (ulonglong)local_res10) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180085800);
}
return 0x5b4;
}
RtlAcquireResourceExclusive(param_1 + 0x48,CONCAT71((int7)(uVar3 >> 8),1));
if ((param_3[1] == 0x20) && (param_3[2] + 0x20U <= param_4)) {
uVar3 = FUN_18005cef0(param_1,param_2,param_3 + 8,param_3[2]);
uVar4 = uVar3 & 0xffffffff;
if ((int)uVar3 != 0) goto LAB_18005d248;
uVar1 = param_3[3];
if ((uVar1 == param_3[1] + param_3[2]) && (iVar2 = param_3[4], iVar2 + uVar1 <= param_4)) {
if (*(longlong *)(param_1 + 0x150) != 0) {
uVar4 = 0x54f;
goto LAB_18005d248;
}
if (iVar2 == 0) {
uVar4 = 0;
goto LAB_18005d248;
}
if (((longlong *)((longlong)param_3 + (ulonglong)uVar1) != (longlong *)0x0) &&
(*(longlong *)(param_2 + 0x50) != 0)) {
uVar4 = FUN_180055d18(*(longlong *)(param_2 + 0x50),
(longlong *)((longlong)param_3 + (ulonglong)uVar1),iVar2,
(longlong *)(param_1 + 0x150));
uVar4 = uVar4 & 0xffffffff;
goto LAB_18005d248;
}
}
}
uVar4 = 0x57;
LAB_18005d248:
RtlReleaseResource(param_1 + 0x48);
return uVar4;
}
=========================================
Function at address: 0x18005d284
Called functions addresses: 0x18000a1f4 0x18002a77b


undefined4 FUN_18005d284(longlong param_1,void *param_2,uint param_3)

{
void *_Dst;

if ((*(longlong *)(param_1 + 0x38) != 0) || (*(int *)(param_1 + 0x40) != 0)) {
return 0x54f;
}
if (param_3 != 0) {
if (param_2 == (void *)0x0) {
return 0x57;
}
_Dst = (void *)FUN_18000a1f4((ulonglong)param_3);
*(void **)(param_1 + 0x38) = _Dst;
if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,param_2,(ulonglong)param_3);
*(uint *)(param_1 + 0x40) = param_3;
}
return 0;
}
=========================================
Function at address: 0x18005d304
Called functions addresses: 0xEXTERNAL:00000122


undefined8 FUN_18005d304(longlong param_1,longlong param_2,int param_3)

{
undefined8 uVar1;

if (*(longlong *)(param_1 + 0x10) == 0) {
if (param_3 == 0) {
uVar1 = 0;
}
else if (param_2 == 0) {
uVar1 = 0x57;
}
else {
if (*(undefined8 **)(param_1 + 0xb0) == (undefined8 *)0x0) {
uVar1 = 0;
}
else {
uVar1 = **(undefined8 **)(param_1 + 0xb0);
}
uVar1 = SslImportKey(uVar1,(longlong *)(param_1 + 0x10),L"OpaqueKeyBlob",param_2,param_3,0);
}
}
else {
uVar1 = 0x54f;
}
return uVar1;
}
=========================================
Function at address: 0x18005d370
Called functions addresses: 0x180014db8 0x180041cb0 0xEXTERNAL:00000041 0xEXTERNAL:00000137 0xEXTERNAL:0000012b 0x18000a1f4 0x18002a77b 0x18000909c


ulonglong FUN_18005d370(longlong param_1,longlong param_2,uint *param_3,uint param_4)

{
DWORD DVar1;
PCCERT_CONTEXT pCertContext;
undefined4 extraout_var;
ulonglong uVar2;
void *_Dst;
ulonglong uVar3;
HLOCAL local_res8;

if ((((*(longlong *)(param_1 + 0x18) != 0) || (*(int *)(param_1 + 0x20) != 0)) ||
(*(longlong *)(param_1 + 0x28) != 0)) || (*(longlong *)(param_1 + 0x30) != 0)) {
return 0x54f;
}
if (param_2 != 0) {
if (param_4 == 0) {
if ((*(uint *)(param_2 + 0x88) >> 8 & 1) == 0) {
return 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180085800);
}
}
else if (((param_3 != (uint *)0x0) && (4 < param_4)) &&
((ulonglong)*param_3 <= (ulonglong)param_4 - 4)) {
pCertContext = CertCreateCertificateContext(1,(BYTE *)(param_3 + 1),*param_3);
if (pCertContext == (PCCERT_CONTEXT)0x0) {
DVar1 = GetLastError();
return CONCAT44(extraout_var,DVar1);
}
local_res8 = (HLOCAL)0x0;
uVar2 = FUN_180014db8((longlong)pCertContext,&local_res8,(int *)0x0);
uVar3 = uVar2 & 0xffffffff;
if ((int)uVar2 == 0) {
_Dst = (void *)FUN_18000a1f4((ulonglong)param_4);
*(void **)(param_1 + 0x18) = _Dst;
if (_Dst != (void *)0x0) {
*(HLOCAL *)(param_1 + 0x28) = local_res8;
*(PCCERT_CONTEXT *)(param_1 + 0x30) = pCertContext;
memcpy(_Dst,param_3,(ulonglong)param_4);
*(uint *)(param_1 + 0x20) = param_4;
return 0;
}
FUN_18000909c(local_res8);
uVar3 = 0xe;
}
CertFreeCertificateContext(pCertContext);
return uVar3;
}
}
return 0x57;
}
=========================================
Function at address: 0x18005d4e8
Called functions addresses: 0x18000a1f4 0x18002a77b


undefined4 FUN_18005d4e8(longlong param_1,void *param_2,byte param_3)

{
void *_Dst;

if ((*(longlong *)(param_1 + 200) != 0) || (*(char *)(param_1 + 0xd0) != '\0')) {
return 0x54f;
}
if (param_3 != 0) {
if (param_2 == (void *)0x0) {
return 0x57;
}
_Dst = (void *)FUN_18000a1f4((ulonglong)param_3);
*(void **)(param_1 + 200) = _Dst;
if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,param_2,(ulonglong)param_3);
*(byte *)(param_1 + 0xd0) = param_3;
}
return 0;
}
=========================================
Function at address: 0x18005d574
Called functions addresses: 0x18000a1f4 0x18002a77b


undefined8 FUN_18005d574(longlong param_1,undefined8 *param_2,uint *param_3)

{
uint uVar1;
void *_Dst;

if (*(longlong *)(param_1 + 0x38) == 0) {
*param_2 = 0;
*param_3 = 0;
}
else {
uVar1 = *(uint *)(param_1 + 0x40);
*param_3 = uVar1;
_Dst = (void *)FUN_18000a1f4((ulonglong)uVar1);
*param_2 = _Dst;
if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,*(void **)(param_1 + 0x38),(ulonglong)*(uint *)(param_1 + 0x40));
}
return 0;
}
=========================================
Function at address: 0x18005d5d4
Called functions addresses: 0x180059d04


undefined8 FUN_18005d5d4(longlong param_1,undefined *param_2,undefined4 *param_3)

{
undefined8 *puVar1;

if ((*(longlong *)(param_1 + 0xb0) != 0) &&
(puVar1 = FUN_180059d04(*(int *)(*(longlong *)(param_1 + 0xb0) + 0x2c)),
puVar1 != (undefined8 *)0x0)) {
if (param_2 != (undefined *)0x0) {
if (0x40 < *(uint *)((longlong)puVar1 + 0x1c)) {
*param_2 = 0;
return 0x54f;
}
*param_2 = *(undefined *)((longlong)puVar1 + 0x1c);
}
if (param_3 != (undefined4 *)0x0) {
*param_3 = *(undefined4 *)(puVar1 + 4);
}
return 0;
}
return 0x54f;
}
=========================================
Function at address: 0x18005d630
Called functions addresses: 0x18005d8fc 0x18005d9dc 0x18005d968 0x18005da48


undefined8
FUN_18005d630(longlong param_1,longlong param_2,undefined4 *param_3,uint param_4,int *param_5)

{
undefined8 uVar1;
undefined4 uVar2;
uint uVar3;

if (((param_2 == 0) || (param_3 == (undefined4 *)0x0)) || (param_5 == (int *)0x0)) {
return 0x57;
}
if (0x43 < param_4) {
*param_3 = 1;
param_3[1] = *(undefined4 *)(param_1 + 8);
param_3[8] = *(undefined4 *)(param_1 + 0xa8);
if (((*(byte *)(param_2 + 0x20) & 8) == 0) || (*(longlong *)(param_2 + 8) == 0)) {
uVar2 = 0;
}
else {
uVar2 = *(undefined4 *)(*(longlong *)(param_2 + 8) + 0x1c);
}
param_3[9] = uVar2;
param_3[10] = *(undefined4 *)(param_2 + 0x10);
*(undefined8 *)(param_3 + 0xd) = *(undefined8 *)(param_1 + 0xbc);
param_3[0xb] = *(undefined4 *)(param_1 + 0xd8);
param_3[0xc] = *(undefined4 *)(param_1 + 0xdc);
param_3[2] = 0x41;
uVar1 = FUN_18005d968(param_1,param_2,(longlong)param_3 + 0x41,param_4 - 0x41,param_3 + 3);
if ((int)uVar1 != 0) {
return uVar1;
}
uVar3 = param_3[3] + param_3[2];
param_3[4] = uVar3;
if (uVar3 <= param_4) {
uVar1 = FUN_18005d9dc(param_1,(void *)((ulonglong)uVar3 + (longlong)param_3),param_4 - uVar3,
param_3 + 5);
if ((int)uVar1 != 0) {
return uVar1;
}
uVar3 = param_3[5] + param_3[4];
param_3[6] = uVar3;
if (uVar3 <= param_4) {
uVar1 = FUN_18005d8fc(param_1,(void *)((ulonglong)uVar3 + (longlong)param_3),param_4 - uVar3
,param_3 + 7);
if ((int)uVar1 != 0) {
return uVar1;
}
uVar3 = param_3[7] + param_3[6];
param_3[0xf] = uVar3;
if (uVar3 <= param_4) {
uVar1 = FUN_18005da48(param_1,(void *)((ulonglong)uVar3 + (longlong)param_3),
param_4 - uVar3,(undefined *)(param_3 + 0x10));
if ((int)uVar1 != 0) {
return uVar1;
}
*param_5 = (uint)*(byte *)(param_3 + 0x10) + param_3[0xf];
return 0;
}
}
}
}
return 0x7a;
}
=========================================
Function at address: 0x18005d7b0
Called functions addresses: 0x18005d630 0xEXTERNAL:000000c2 0xEXTERNAL:000000c0 0xEXTERNAL:00000089


int FUN_18005d7b0(longlong param_1,longlong param_2,undefined4 *param_3,uint param_4,int *param_5)

{
undefined4 *puVar1;
longlong lVar2;
int iVar3;
undefined8 uVar4;
uint uVar5;
undefined8 *puVar6;
int unaff_EBX;

if (param_2 == 0) {
return unaff_EBX;
}
if (param_3 == (undefined4 *)0x0) {
return unaff_EBX;
}
if (param_5 == (int *)0x0) {
return unaff_EBX;
}
if (param_4 < 0x28) {
return unaff_EBX;
}
RtlAcquireResourceShared(param_1 + 0x48,1);
*param_3 = 0;
GetSystemTimeAsFileTime((LPFILETIME)(param_3 + 6));
param_3[1] = 0x20;
uVar4 = FUN_18005d630(param_1,param_2,param_3 + 8,param_4 - 0x20,param_3 + 2);
iVar3 = (int)uVar4;
if (iVar3 != 0) goto LAB_18005d8b0;
uVar5 = param_3[2] + param_3[1];
param_3[3] = uVar5;
if (param_4 < uVar5) {
LAB_18005d864:
iVar3 = 0x7a;
}
else {
puVar1 = param_3 + 4;
puVar6 = (undefined8 *)((ulonglong)uVar5 + (longlong)param_3);
if (((puVar6 == (undefined8 *)0x0) && (param_4 != uVar5)) || (puVar1 == (undefined4 *)0x0)) {
iVar3 = 0x57;
goto LAB_18005d8b0;
}
lVar2 = *(longlong *)(param_1 + 0x150);
if (lVar2 == 0) {
*puVar1 = 0;
}
else {
if (param_4 - uVar5 < 0x14) goto LAB_18005d864;
uVar4 = *(undefined8 *)(lVar2 + 0x30);
*puVar6 = *(undefined8 *)(lVar2 + 0x28);
puVar6[1] = uVar4;
*(undefined4 *)(puVar6 + 2) = *(undefined4 *)(lVar2 + 0x38);
*puVar1 = 0x14;
}
iVar3 = 0;
}
LAB_18005d8b0:
RtlReleaseResource(param_1 + 0x48);
if (iVar3 == 0) {
*param_5 = param_3[4] + param_3[3];
}
return unaff_EBX;
}
=========================================
Function at address: 0x18005d8fc
Called functions addresses: 0x18002a77b


undefined8 FUN_18005d8fc(longlong param_1,void *param_2,uint param_3,undefined4 *param_4)

{
undefined8 uVar1;

if (((param_2 == (void *)0x0) && (param_3 != 0)) || (param_4 == (undefined4 *)0x0)) {
uVar1 = 0x57;
}
else {
if (*(void **)(param_1 + 0x38) == (void *)0x0) {
*param_4 = 0;
}
else {
if (param_3 < *(uint *)(param_1 + 0x40)) {
return 0x7a;
}
memcpy(param_2,*(void **)(param_1 + 0x38),(ulonglong)*(uint *)(param_1 + 0x40));
*param_4 = *(undefined4 *)(param_1 + 0x40);
}
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x18005d968
Called functions addresses: 0xEXTERNAL:00000113


undefined8
FUN_18005d968(longlong param_1,longlong param_2,longlong param_3,int param_4,undefined4 *param_5)

{
undefined8 uVar1;
longlong *plVar2;

if ((param_2 == 0) || (((param_3 == 0 && (param_4 != 0)) || (param_5 == (undefined4 *)0x0)))) {
uVar1 = 0x57;
}
else if (*(longlong *)(param_1 + 0x10) == 0) {
*param_5 = 0;
uVar1 = 0;
}
else {
plVar2 = *(longlong **)(param_2 + 8);
if (plVar2 != (longlong *)0x0) {
plVar2 = (longlong *)*plVar2;
}
uVar1 = SslExportKey(plVar2,*(longlong *)(param_1 + 0x10),L"OpaqueKeyBlob",param_3,param_4,
param_5,0);
}
return uVar1;
}
=========================================
Function at address: 0x18005d9dc
Called functions addresses: 0x18002a77b


undefined8 FUN_18005d9dc(longlong param_1,void *param_2,uint param_3,undefined4 *param_4)

{
undefined8 uVar1;

if (((param_2 == (void *)0x0) && (param_3 != 0)) || (param_4 == (undefined4 *)0x0)) {
uVar1 = 0x57;
}
else {
if (*(void **)(param_1 + 0x18) == (void *)0x0) {
*param_4 = 0;
}
else {
if (param_3 < *(uint *)(param_1 + 0x20)) {
return 0x7a;
}
memcpy(param_2,*(void **)(param_1 + 0x18),(ulonglong)*(uint *)(param_1 + 0x20));
*param_4 = *(undefined4 *)(param_1 + 0x20);
}
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x18005da48
Called functions addresses: 0x18002a77b


undefined8 FUN_18005da48(longlong param_1,void *param_2,uint param_3,undefined *param_4)

{
undefined8 uVar1;

if (((param_2 == (void *)0x0) && (param_3 != 0)) || (param_4 == (undefined *)0x0)) {
uVar1 = 0x57;
}
else {
if (*(void **)(param_1 + 200) == (void *)0x0) {
*param_4 = 0;
}
else {
if (param_3 < *(byte *)(param_1 + 0xd0)) {
return 0x7a;
}
memcpy(param_2,*(void **)(param_1 + 200),(ulonglong)*(byte *)(param_1 + 0xd0));
*param_4 = *(undefined *)(param_1 + 0xd0);
}
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x18005dabc
Called functions addresses: 0x18000f484 0x18000909c


DWORD FUN_18005dabc(longlong param_1)

{
undefined8 *puVar1;
DWORD DVar2;

puVar1 = (undefined8 *)(param_1 + 400);
if ((HLOCAL)*puVar1 != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)*puVar1);
*puVar1 = 0;
*(uint *)(param_1 + 0x198) = 0;
}
if (*(longlong *)(param_1 + 0x30) == 0) {
DVar2 = 0;
}
else {
DVar2 = FUN_18000f484(*(longlong *)(param_1 + 0x30),puVar1,(uint *)(param_1 + 0x198));
}
return DVar2;
}
=========================================
Function at address: 0x18005db20
Called functions addresses: None


ulonglong FUN_18005db20(byte *param_1,uint param_2)

{
byte bVar1;
ulonglong uVar2;
ulonglong uVar3;

uVar2 = 0;
if (param_1 != (byte *)0x0) {
if (param_2 != 0) {
uVar3 = (ulonglong)param_2;
do {
bVar1 = *param_1;
param_1 = param_1 + 1;
uVar2 = (ulonglong)((int)uVar2 + (bVar1 ^ 0x55));
uVar3 = uVar3 - 1;
} while (uVar3 != 0);
}
uVar2 = uVar2 % (ulonglong)DAT_1800926fc;
}
return uVar2;
}
=========================================
Function at address: 0x18005db58
Called functions addresses: 0xEXTERNAL:00000088 0x18005dcd8 0x18000a1f4 0xEXTERNAL:000000c0 0x18005db20 0x18002a77b 0x18000909c 0xEXTERNAL:000000bc


void FUN_18005db58(byte *param_1,uint param_2)

{
DWORD *pDVar1;
longlong *plVar2;
ulonglong uVar3;
code *pcVar4;
int iVar5;
DWORD DVar6;
ulonglong uVar7;
DWORD *pDVar8;
void *_Dst;
longlong lVar9;

if ((((param_1 != (byte *)0x0) && (param_2 != 0)) && (DAT_180092778 != 0)) &&
(iVar5 = FUN_18005dcd8(param_1,param_2), iVar5 == 0)) {
uVar7 = FUN_18005db20(param_1,param_2);
uVar3 = (ulonglong)DAT_1800926fc;
DVar6 = GetTickCount();
pDVar8 = (DWORD *)FUN_18000a1f4(0x38);
if (pDVar8 != (DWORD *)0x0) {
_Dst = (void *)FUN_18000a1f4((ulonglong)param_2);
*(void **)(pDVar8 + 2) = _Dst;
if (_Dst != (void *)0x0) {
pDVar8[4] = param_2;
memcpy(_Dst,param_1,(ulonglong)param_2);
*pDVar8 = DVar6;
RtlAcquireResourceExclusive(&DAT_180092718,1);
pDVar1 = pDVar8 + 6;
lVar9 = ((uVar7 & 0xffffffff) % uVar3) * 0x10 + DAT_1800926f0;
plVar2 = *(longlong **)(lVar9 + 8);
if (*plVar2 == lVar9) {
*(longlong *)pDVar1 = lVar9;
*(longlong **)(pDVar8 + 8) = plVar2;
*plVar2 = (longlong)pDVar1;
*(DWORD **)(lVar9 + 8) = pDVar1;
pDVar1 = pDVar8 + 10;
if (*(undefined8 **)DAT_180092710 == &DAT_180092708) {
*(undefined8 **)pDVar1 = &DAT_180092708;
*(DWORD **)(pDVar8 + 0xc) = DAT_180092710;
*(DWORD **)DAT_180092710 = pDVar1;
DAT_180092704 = DAT_180092704 + 1;
DAT_180092710 = pDVar1;
RtlReleaseResource(&DAT_180092718);
return;
}
}
pcVar4 = (code *)swi(0x29);
(*pcVar4)(3);
pcVar4 = (code *)swi(3);
(*pcVar4)();
return;
}
FUN_18000909c(pDVar8);
}
}
return;
}
=========================================
Function at address: 0x18005dca8
Called functions addresses: 0x18000909c


void FUN_18005dca8(HLOCAL param_1)

{
if (param_1 != (HLOCAL)0x0) {
if (*(HLOCAL *)((longlong)param_1 + 8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)((longlong)param_1 + 8));
}
FUN_18000909c(param_1);
}
return;
}
=========================================
Function at address: 0x18005dcd8
Called functions addresses: 0xEXTERNAL:00000088 0xEXTERNAL:000000c2 0x1800032c4 0xEXTERNAL:000000c0 0x18005db20 0x18002a76f


undefined4 FUN_18005dcd8(byte *param_1,uint param_2)

{
ulonglong uVar1;
DWORD DVar2;
int iVar3;
ulonglong uVar4;
undefined8 uVar5;
undefined8 *puVar6;
undefined4 uVar7;
uint *puVar8;
undefined8 *puVar9;

uVar7 = 0;
if (((param_1 == (byte *)0x0) || (param_2 == 0)) || (DAT_180092778 == 0)) {
uVar7 = 0;
}
else {
uVar4 = FUN_18005db20(param_1,param_2);
uVar1 = (ulonglong)DAT_1800926fc;
DVar2 = GetTickCount();
RtlAcquireResourceShared(&DAT_180092718,1);
puVar9 = (undefined8 *)(((uVar4 & 0xffffffff) % uVar1) * 0x10 + DAT_1800926f0);
puVar6 = (undefined8 *)*puVar9;
do {
do {
if (puVar6 == puVar9) goto LAB_18005dd96;
puVar8 = (uint *)(puVar6 + -3);
puVar6 = (undefined8 *)*puVar6;
uVar5 = FUN_1800032c4((ulonglong)*puVar8,(ulonglong)DVar2,DAT_1800926f8);
} while (((char)uVar5 != '\0') || (param_2 != puVar8[4]));
iVar3 = memcmp(param_1,*(void **)(puVar8 + 2),(ulonglong)param_2);
} while (iVar3 != 0);
uVar7 = 1;
LAB_18005dd96:
RtlReleaseResource(&DAT_180092718);
}
return uVar7;
}
=========================================
Function at address: 0x18005ddd0
Called functions addresses: 0x18005dca8 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc


void FUN_18005ddd0(void)

{
longlong *plVar1;
longlong lVar2;
longlong *plVar3;
longlong *plVar4;
code *pcVar5;
longlong *plVar6;

if ((DAT_180092778 != 0) && (DAT_180092704 != 0)) {
RtlAcquireResourceExclusive(&DAT_180092718,1);
plVar6 = DAT_180092708;
while ((longlong **)plVar6 != &DAT_180092708) {
plVar1 = (longlong *)*plVar6;
plVar4 = plVar6 + -2;
lVar2 = *plVar4;
if ((*(longlong **)(lVar2 + 8) != plVar4) ||
(plVar3 = (longlong *)plVar6[-1], (longlong *)*plVar3 != plVar4)) {
LAB_18005de8b:
pcVar5 = (code *)swi(0x29);
(*pcVar5)(3);
pcVar5 = (code *)swi(3);
(*pcVar5)();
return;
}
*plVar3 = lVar2;
*(longlong **)(lVar2 + 8) = plVar3;
lVar2 = *plVar6;
if ((*(longlong **)(lVar2 + 8) != plVar6) ||
(plVar4 = (longlong *)plVar6[1], (longlong *)*plVar4 != plVar6)) goto LAB_18005de8b;
*plVar4 = lVar2;
*(longlong **)(lVar2 + 8) = plVar4;
DAT_180092704 = DAT_180092704 + -1;
FUN_18005dca8(plVar6 + -5);
plVar6 = plVar1;
}
RtlReleaseResource(&DAT_180092718);
}
return;
}
=========================================
Function at address: 0x18005de98
Called functions addresses: 0x18005dca8 0xEXTERNAL:000000b3 0x18000909c 0xEXTERNAL:000000bc


void FUN_18005de98(void)

{
undefined8 *puVar1;
undefined8 *puVar2;

if (DAT_180092778 != 0) {
RtlAcquireResourceExclusive(&DAT_180092718,1);
}
if (DAT_1800926f0 != (HLOCAL)0x0) {
puVar2 = DAT_180092708;
if ((undefined8 **)DAT_180092708 != &DAT_180092708) {
do {
puVar1 = puVar2 + -5;
puVar2 = (undefined8 *)*puVar2;
FUN_18005dca8(puVar1);
} while ((undefined8 **)puVar2 != &DAT_180092708);
}
FUN_18000909c(DAT_1800926f0);
DAT_1800926f0 = (HLOCAL)0x0;
}
if (DAT_180092778 != 0) {
RtlDeleteResource(&DAT_180092718);
DAT_180092778 = 0;
}
return;
}
=========================================
Function at address: 0x18005df3c
Called functions addresses: 0xEXTERNAL:0000008e 0x1800272fc 0xEXTERNAL:00000084 0xEXTERNAL:00000061


undefined8 * FUN_18005df3c(undefined8 *param_1,int param_2,int param_3)

{
LPVOID pvVar1;
uint uVar2;
_SYSTEM_INFO local_38;

FUN_1800272fc(param_1,param_2,1);
param_1[0xc] = 0;
*(undefined4 *)(param_1 + 0xe) = 0;
*param_1 = &PTR_FUN_18007fcf8;
GetSystemInfo(&local_38);
InitializeSListHead((PSLIST_HEADER)(param_1 + 10));
uVar2 = (local_38.dwPageSize - 1) + param_2 * param_3 & ~(local_38.dwPageSize - 1);
*(uint *)(param_1 + 0xd) = uVar2;
*(uint *)((longlong)param_1 + 0x6c) = param_2 + 0x17U & 0xfffffff8;
pvVar1 = VirtualAlloc((LPVOID)0x0,(ulonglong)uVar2,0x3000,4);
param_1[0xc] = pvVar1;
return param_1;
}
=========================================
Function at address: 0x18005dfe8
Called functions addresses: 0xEXTERNAL:0000008c 0xEXTERNAL:0000008d 0x18000909c


void FUN_18005dfe8(undefined8 *param_1)

{
PSLIST_ENTRY p_Var1;

*param_1 = &PTR_FUN_18007d428;
if (*(char *)(param_1 + 4) != '\0') {
while (p_Var1 = InterlockedPopEntrySList((PSLIST_HEADER)(param_1 + 2)),
p_Var1 != (PSLIST_ENTRY)0x0) {
FUN_18000909c(p_Var1);
}
}
InterlockedFlushSList((PSLIST_HEADER)(param_1 + 2));
*param_1 = &PTR_FUN_18007c298;
return;
}
=========================================
Function at address: 0x18005e054
Called functions addresses: 0xEXTERNAL:0000005d 0x18005dfe8


void FUN_18005e054(undefined8 *param_1)

{
*param_1 = &PTR_FUN_18007fcf8;
if ((LPVOID)param_1[0xc] != (LPVOID)0x0) {
VirtualFree((LPVOID)param_1[0xc],0,0x8000);
}
FUN_18005dfe8(param_1);
return;
}
=========================================
Function at address: 0x18005e0a0
Called functions addresses: 0x180028a7c 0x18005dfe8


undefined8 * FUN_18005e0a0(undefined8 *param_1,uint param_2)

{
FUN_18005dfe8(param_1);
if ((param_2 & 1) != 0) {
_o_free(param_1);
}
return param_1;
}
=========================================
Function at address: 0x18005e0e0
Called functions addresses: 0x180028a7c 0x18005e054


undefined8 * FUN_18005e0e0(undefined8 *param_1,uint param_2)

{
FUN_18005e054(param_1);
if ((param_2 & 1) != 0) {
_o_free(param_1);
}
return param_1;
}
=========================================
Function at address: 0x18005e120
Called functions addresses: 0x180028d90 0x180022d60 0xEXTERNAL:0000008d


PSLIST_ENTRY FUN_18005e120(longlong param_1)

{
uint *puVar1;
uint uVar2;
PSLIST_ENTRY p_Var3;

if (*(longlong *)(param_1 + 0x60) == 0) {
p_Var3 = (PSLIST_ENTRY)0x0;
}
else {
p_Var3 = InterlockedPopEntrySList((PSLIST_HEADER)(param_1 + 0x50));
if (p_Var3 == (PSLIST_ENTRY)0x0) {
LOCK();
puVar1 = (uint *)(param_1 + 0x70);
uVar2 = *puVar1;
*puVar1 = *puVar1 + *(int *)(param_1 + 0x6c);
UNLOCK();
if (*(uint *)(param_1 + 0x68) < *(int *)(param_1 + 0x6c) + uVar2) {
LOCK();
*(int *)(param_1 + 0x70) = *(int *)(param_1 + 0x70) - *(int *)(param_1 + 0x6c);
UNLOCK();
p_Var3 = (PSLIST_ENTRY)FUN_180022d60(param_1);
return p_Var3;
}
p_Var3 = (PSLIST_ENTRY)((ulonglong)uVar2 + *(longlong *)(param_1 + 0x60));
}
memset(p_Var3 + 2,0,(ulonglong)*(uint *)(param_1 + 0x6c) - 0x10);
p_Var3 = p_Var3 + 2;
}
return p_Var3;
}
=========================================
Function at address: 0x18005e1b0
Called functions addresses: 0x18000a1f4


longlong FUN_18005e1b0(longlong param_1,ulonglong param_2,char param_3)

{
ushort *puVar1;
ushort uVar2;
longlong lVar3;
ushort uVar4;

uVar4 = (ushort)param_2;
if ((param_2 < 0x10000) && (uVar2 = *(short *)(param_1 + 0x14) + uVar4, uVar4 <= uVar2)) {
puVar1 = *(ushort **)(param_1 + 8);
*(ushort *)(param_1 + 0x14) = uVar2;
if (puVar1 != (ushort *)0x0) {
uVar2 = *puVar1;
if ((int)(param_2 & 0xffff) < (int)((uint)puVar1[1] - (uint)uVar2)) {
if (param_3 == '\0') {
*puVar1 = uVar4 + uVar2;
lVar3 = (longlong)puVar1 + (ulonglong)uVar2;
}
else {
puVar1[1] = puVar1[1] - uVar4;
lVar3 = (ulonglong)*(ushort *)(*(longlong *)(param_1 + 8) + 2) +
*(longlong *)(param_1 + 8);
}
return lVar3 + 4;
}
}
lVar3 = FUN_18000a1f4(param_2 & 0xffff);
return lVar3;
}
return 0;
}
=========================================
Function at address: 0x18005e240
Called functions addresses: 0x180022e40 0xEXTERNAL:0000008b


void FUN_18005e240(longlong param_1,HLOCAL param_2)

{
if (((param_2 != (HLOCAL)0x0) && (*(HLOCAL *)(param_1 + 0x60) <= param_2)) &&
(param_2 < (HLOCAL)((ulonglong)*(uint *)(param_1 + 0x68) + *(longlong *)(param_1 + 0x60)))) {
/* WARNING: Could not recover jumptable at 0x00018005e25f. Too many branches */

InterlockedPushEntrySList
((PSLIST_HEADER)(param_1 + 0x50),(PSLIST_ENTRY)((longlong)param_2 + -0x10));
return;
}
FUN_180022e40(param_1,param_2);
return;
}
=========================================
Function at address: 0x18005e280
Called functions addresses: 0x18000909c


void FUN_18005e280(longlong param_1,HLOCAL param_2)

{
HLOCAL pvVar1;

pvVar1 = *(HLOCAL *)(param_1 + 8);
if (((pvVar1 == (HLOCAL)0x0) || (param_2 < pvVar1)) ||
((HLOCAL)((ulonglong)*(ushort *)(param_1 + 0x10) + (longlong)pvVar1) < param_2)) {
FUN_18000909c(param_2);
}
return;
}
=========================================
Function at address: 0x18005e2c0
Called functions addresses: 0x180028d90


void FUN_18005e2c0(longlong param_1)

{
ushort *puVar1;

if (*(ushort *)(param_1 + 0x12) < *(ushort *)(param_1 + 0x14)) {
*(ushort *)(param_1 + 0x12) = *(ushort *)(param_1 + 0x14);
}
*(undefined2 *)(param_1 + 0x14) = 0;
puVar1 = *(ushort **)(param_1 + 8);
if (puVar1 != (ushort *)0x0) {
memset(puVar1 + 2,0,(ulonglong)*puVar1);
**(undefined2 **)(param_1 + 8) = 0;
*(short *)(param_1 + 0x14) =
(*(short *)(param_1 + 0x10) - *(short *)(*(longlong *)(param_1 + 8) + 2)) + -4;
}
return;
}
=========================================
Function at address: 0x18005e328
Called functions addresses: 0x18005e43c


byte FUN_18005e328(longlong param_1,uint param_2,uint param_3,uint param_4,uint param_5)

{
bool bVar1;
byte bVar2;
longlong lVar3;
byte bVar4;
byte bVar5;
uint *puVar6;
byte bVar7;

puVar6 = &DAT_18007c3a8;
bVar2 = 0;
bVar7 = 0;
bVar4 = 0xff;
lVar3 = 0xc;
do {
if ((((puVar6[1] == param_2) && ((*puVar6 & param_4) != 0)) && (bVar7 < 0xc)) &&
((*(ushort *)(param_1 + 0x22) >> (bVar7 & 0x1f) & 1) != 0)) {
bVar5 = *(byte *)(puVar6 + 8);
bVar1 = FUN_18005e43c(param_2,param_3,(uint)bVar5,puVar6[9]);
if (((bVar1) && ((((param_4 & 0x3000) == 0 || (puVar6[1] != 3)) || (puVar6[10] == param_5))))
&& (((bVar5 < bVar2 && (0x14 < bVar5)) || (bVar2 < 0x15)))) {
bVar2 = bVar5;
bVar4 = bVar7;
}
}
puVar6 = puVar6 + 0x12;
bVar7 = bVar7 + 1;
lVar3 = lVar3 + -1;
} while (lVar3 != 0);
return bVar4;
}
=========================================
Function at address: 0x18005e400
Called functions addresses: 0x18005e328


undefined2 FUN_18005e400(longlong param_1,uint param_2,uint param_3,uint param_4,uint param_5)

{
byte bVar1;
undefined2 uVar2;

uVar2 = 0;
bVar1 = FUN_18005e328(param_1,param_2,param_3,param_4,param_5);
if (bVar1 < 0xc) {
uVar2 = (&DAT_18007c390)[(ulonglong)bVar1 * 0x24];
}
return uVar2;
}
=========================================
Function at address: 0x18005e43c
Called functions addresses: None


bool FUN_18005e43c(int param_1,uint param_2,int param_3,int param_4)

{
if ((param_1 == 1) && (param_4 == 8)) {
return param_3 * 2 + 2U <= param_2 >> 3;
}
return true;
}
=========================================
Function at address: 0x18005e464
Called functions addresses: 0x18005e43c


ulonglong FUN_18005e464(longlong param_1,int param_2,uint param_3,uint param_4,uint param_5)

{
bool bVar1;
byte bVar2;
uint *puVar3;
undefined8 uVar4;

if (param_2 == 0x2200) {
uVar4 = 2;
}
else if (param_2 == 0x2203) {
uVar4 = 3;
}
else {
if ((param_2 != 0x2400) && (param_2 != 0xa400)) goto LAB_18005e52d;
uVar4 = 1;
}
bVar2 = 0;
puVar3 = &DAT_18007c3a8;
do {
if ((((puVar3[1] == (uint)uVar4) && ((*puVar3 & param_4) != 0)) &&
((param_3 == 0 ||
(bVar1 = FUN_18005e43c((uint)uVar4,param_3,(uint)*(byte *)(puVar3 + 8),puVar3[9]), bVar1)))
) && (((((param_4 & 0x3000) == 0 || (puVar3[1] != 3)) || (puVar3[10] == param_5)) &&
((bVar2 < 0xc && ((*(ushort *)(param_1 + 0x22) >> (bVar2 & 0x1f) & 1) != 0)))))) {
return CONCAT71((uint7)(byte)(*(ushort *)(param_1 + 0x22) >> 8),1);
}
bVar2 = bVar2 + 1;
register0x00000020 = (BADSPACEBASE *)(puVar3 + 0xc);
puVar3 = puVar3 + 0x12;
} while (register0x00000020 < &PTR_FUN_18007c6f0);
LAB_18005e52d:
return (ulonglong)register0x00000020 & 0xffffffffffffff00;
}
=========================================
Function at address: 0x18005e558
Called functions addresses: 0x1800052f0 0x180006da4


undefined8 FUN_18005e558(ushort *param_1,ushort *param_2,uint param_3,int *param_4)

{
ushort uVar1;
ushort uVar2;
undefined8 uVar3;
ulonglong uVar4;
ulonglong uVar5;
ushort *puVar6;

if ((param_2 != (ushort *)0x0) && (1 < param_3)) {
*param_1 = 0;
puVar6 = param_2 + 1;
param_1[0x11] = 0;
uVar1 = CONCAT11(*(undefined *)param_2,*(byte *)((longlong)param_2 + 1));
uVar5 = (ulonglong)(uint)uVar1;
uVar2 = uVar1 >> 1;
uVar4 = (ulonglong)uVar2;
if (((uint)uVar1 <= param_3 - 2) &&
(((*(byte *)((longlong)param_2 + 1) & 1) == 0 && (uVar2 - 1 < 0x50)))) {
if (uVar2 != 0) {
do {
uVar3 = FUN_1800052f0(*puVar6);
FUN_180006da4(param_1,(byte)uVar3);
puVar6 = puVar6 + 1;
uVar4 = uVar4 - 1;
} while (uVar4 != 0);
if (*param_1 != 0) {
*param_4 = (int)uVar5 + 2;
return 0;
}
}
return 0x80090331;
}
}
return 0x80090326;
}
=========================================
Function at address: 0x18005e624
Called functions addresses: 0x180006da4


void FUN_18005e624(ushort *param_1)

{
undefined **ppuVar1;
byte bVar2;

bVar2 = 0;
ppuVar1 = (undefined **)&DAT_18007c390;
*param_1 = 0;
param_1[0x11] = 0;
do {
if (*(int *)(ppuVar1 + 5) == 2) {
FUN_180006da4(param_1,bVar2);
}
ppuVar1 = ppuVar1 + 9;
bVar2 = bVar2 + 1;
} while (ppuVar1 < &PTR_FUN_18007c6f0);
return;
}
=========================================
Function at address: 0x18005e674
Called functions addresses: 0xEXTERNAL:0000016e


void FUN_18005e674(void)

{
int iVar1;
undefined8 *puVar2;
int iVar3;

iVar3 = 1;
if (1 < DAT_180092324) {
puVar2 = &DAT_180092cf8;
iVar1 = DAT_180092324;
do {
if ((BCRYPT_ALG_HANDLE)*puVar2 != (BCRYPT_ALG_HANDLE)0x0) {
BCryptCloseAlgorithmProvider((BCRYPT_ALG_HANDLE)*puVar2,0);
*puVar2 = 0;
iVar1 = DAT_180092324;
}
iVar3 = iVar3 + 1;
puVar2 = puVar2 + 1;
} while (iVar3 < iVar1);
}
return;
}
=========================================
Function at address: 0x18005e6d0
Called functions addresses: 0x18002a410 0x180028d90 0xEXTERNAL:000000b5


undefined8 *
FUN_18005e6d0(undefined8 *param_1,undefined param_2,undefined param_3,undefined param_4)

{
undefined8 *puVar1;

FUN_18002a410(param_1);
*param_1 = &PTR_FUN_18007fd20;
*(undefined *)((longlong)param_1 + 0x4d) = param_4;
*(undefined *)((longlong)param_1 + 0x4e) = param_3;
*(undefined *)((longlong)param_1 + 0x4f) = param_2;
*(undefined *)(param_1 + 10) = 0;
*(undefined4 *)((longlong)param_1 + 0x7c) = 1;
*(undefined4 *)(param_1 + 0x10) = 1;
*(undefined8 *)((longlong)param_1 + 0x202) = 0;
*(undefined8 *)((longlong)param_1 + 0x20a) = 0;
*(undefined8 *)((longlong)param_1 + 0x212) = 0;
*(undefined8 *)((longlong)param_1 + 0x21a) = 0;
*(undefined2 *)(param_1 + 0x40) = 0;
*(undefined2 *)((longlong)param_1 + 0x222) = 0;
*(undefined8 *)((longlong)param_1 + 0x28c) = 0;
memset((void *)((longlong)param_1 + 0x294),0,0x204);
RtlInitializeResource(param_1 + 0x45);
*(undefined *)(param_1 + 0x51) = 1;
puVar1 = param_1 + 0x3c;
param_1[0x3d] = puVar1;
*puVar1 = puVar1;
return param_1;
}
=========================================
Function at address: 0x18005e790
Called functions addresses: 0x18005f2e8


void FUN_18005e790(undefined8 *param_1,undefined8 param_2,uint param_3)

{
*param_1 = &PTR_FUN_18007fd20;
FUN_18005f2e8((longlong)param_1,param_2,param_3);
*param_1 = &PTR_FUN_18007c298;
return;
}
=========================================
Function at address: 0x18005e7c0
Called functions addresses: 0xEXTERNAL:0000011c 0x180023480


void FUN_18005e7c0(undefined8 *param_1)

{
longlong *plVar1;
longlong lVar2;

*param_1 = &PTR_FUN_18007d568;
lVar2 = param_1[1];
if (lVar2 != 0) {
SslFreeObject(lVar2,0);
param_1[1] = 0;
}
plVar1 = param_1 + 2;
if (*plVar1 != 0) {
FUN_180023480(lVar2,plVar1);
*plVar1 = 0;
}
*param_1 = &PTR_FUN_18007c298;
return;
}
=========================================
Function at address: 0x18005e830
Called functions addresses: 0x18005e790 0x18000909c


undefined8 * FUN_18005e830(undefined8 *param_1,ulonglong param_2,uint param_3)

{
FUN_18005e790(param_1,param_2,param_3);
if ((param_2 & 1) != 0) {
FUN_18000909c(param_1);
}
return param_1;
}
=========================================
Function at address: 0x18005e870
Called functions addresses: 0x18005e7c0 0x18000909c


undefined8 * FUN_18005e870(undefined8 *param_1,uint param_2)

{
FUN_18005e7c0(param_1);
if ((param_2 & 1) != 0) {
FUN_18000909c(param_1);
}
return param_1;
}
=========================================
Function at address: 0x18005e8a8
Called functions addresses: 0x180014db8 0x180004658 0x180054d10 0xEXTERNAL:00000164 0xEXTERNAL:00000130 0xEXTERNAL:00000041 0x18000f484 0x180028070 0x18002a763 0xEXTERNAL:0000013a 0x180044fac 0x180054b34 0xEXTERNAL:00000139 0x180041cdc 0x18005f9a0 0x180041cb0 0xEXTERNAL:00000145 0xEXTERNAL:0000014c 0x180013bc8 0x180010610 0x180043258 0x180054f60 0x180008310 0x1800450b8 0x18001050c 0x180028d90 0x180001604 0xEXTERNAL:00000047 0xEXTERNAL:0000012b 0xEXTERNAL:000000c7 0x18000909c 0x18005f4a4


void FUN_18005e8a8(ulonglong param_1,undefined4 param_2,longlong param_3,longlong param_4,
uint *param_5,uint param_6,undefined8 param_7,int param_8,uint *param_9,
uint param_10)

{
PCCERT_CHAIN_CONTEXT *ppChainContext;
wchar_t *pwVar1;
char cVar2;
DWORD DVar3;
int iVar4;
BOOL BVar5;
int extraout_EAX;
PCCERT_CONTEXT pCVar6;
ulonglong uVar7;
HCERT_SERVER_OCSP_RESPONSE pvVar8;
undefined8 uVar9;
PCCERT_CHAIN_CONTEXT pCVar10;
undefined2 uVar11;
undefined4 *pvReserved;
undefined8 uVar12;
PCERT_CHAIN_POLICY_PARA pPolicyPara;
uint uVar13;
HCERTSTORE hAdditionalStore;
PCERT_CHAIN_POLICY_STATUS pPolicyStatus;
char cVar14;
byte bVar15;
undefined auStackY_188 [32];
undefined4 uVar16;
longlong *plVar17;
int local_128 [2];
wchar_t *local_120;
uint *local_118;
_CERT_CHAIN_POLICY_PARA local_110;
undefined8 local_100;
undefined8 uStack_f8;
undefined8 local_f0;
_CERT_CHAIN_POLICY_STATUS local_e8;
undefined4 local_d0;
undefined4 local_cc;
undefined8 local_c8;
longlong local_c0;
undefined8 local_b8;
undefined8 uStack_b0;
_CERT_CHAIN_PARA local_a8 [3];
_EVENT_DATA_DESCRIPTOR local_48;
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_188;
local_118 = param_9;
hAdditionalStore = (HCERTSTORE)0x0;
memset(local_a8,0,0x60);
cVar14 = '\0';
*(undefined4 *)(param_1 + 0x28c) = param_2;
local_128[0] = 0;
local_120 = (wchar_t *)0x0;
local_f0 = 0;
local_e8.pvExtraPolicyStatus = (void *)0x0;
local_110.cbSize = 0;
local_110.dwFlags = 0;
local_110.pvExtraPolicyPara = (undefined8 *)0x0;
local_100 = 0;
uStack_f8 = 0;
local_e8.cbSize = 0;
local_e8.dwError = 0;
local_e8.lChainIndex = 0;
local_e8.lElementIndex = 0;
if (param_3 == 0) {
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 2) != 0)) {
FUN_180041cb0(DAT_180091000->rgpChain,10,&DAT_180082ba8);
cVar14 = '\0';
}
}
else {
cVar14 = '\0';
FUN_180010610((short *)(param_1 + 0x290),0x104,param_3);
}
if (*(char *)(param_1 + 0x288) == cVar14) goto LAB_18005ea98;
if (param_5 == (uint *)0x0) {
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
FUN_180041cb0(DAT_180091000->rgpChain,0xb,&DAT_180082ba8);
}
goto LAB_18005ea98;
}
if ((*(byte *)(param_5 + 0xc) & 1) != 0) {
*(uint *)(param_1 + 0x18) = *(uint *)(param_1 + 0x18) | 0x20;
}
pCVar6 = CertDuplicateCertificateContext(*(PCCERT_CONTEXT *)param_5);
*(PCCERT_CONTEXT *)(param_1 + 0x20) = pCVar6;
if (pCVar6 == (PCCERT_CONTEXT)0x0) {
*(undefined4 *)(param_1 + 0x48) = 0x2714;
DVar3 = GetLastError();
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
FUN_180041cdc(DAT_180091000->rgpChain,0xc,&DAT_180082ba8,DVar3);
}
LAB_18005ea4b:
if (DVar3 != 0) goto LAB_18005ea4f;
}
else {
uVar7 = FUN_180014db8((longlong)pCVar6,(undefined8 *)(param_1 + 0x1b0),(int *)(param_1 + 0x84));
DVar3 = (DWORD)uVar7;
if (DVar3 != 0) {
*(undefined4 *)(param_1 + 0x48) = 0x2715;
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
uVar11 = 0xd;
LAB_18005eb12:
FUN_180041cdc(DAT_180091000->rgpChain,uVar11,&DAT_180082ba8,DVar3);
}
goto LAB_18005ea4f;
}
uVar9 = *(undefined8 *)(*(longlong *)(param_1 + 0x20) + 8);
iVar4 = BCryptHash(0x31,0,0);
if (iVar4 < 0) {
*(undefined4 *)(param_1 + 0x48) = 0x2720;
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
FUN_180041cdc(DAT_180091000->rgpChain,0xe,&DAT_180082ba8,iVar4);
}
DVar3 = RtlNtStatusToDosError(iVar4);
goto LAB_18005ea4b;
}
iVar4 = FUN_18005f9a0(param_1,param_4,(longlong)param_5);
if (iVar4 == 0) {
if (*(char *)(param_1 + 0x4f) != '\0') {
param_5 = (uint *)(param_1 + 0x1d8);
DVar3 = FUN_18000f484(*(longlong *)(param_1 + 0x20),(undefined8 *)(param_1 + 0x1d0),param_5)
;
if (DVar3 != 0) {
*(undefined4 *)(param_1 + 0x48) = 0x271f;
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
uVar11 = 0x10;
goto LAB_18005eb12;
}
goto LAB_18005ea4f;
}
}
iVar4 = FUN_180001604(param_4,local_128);
if (iVar4 == 0) {
if (*(int *)(param_1 + 0x84) == 0x2203) {
DVar3 = CertGetPublicKeyLength
(1,(PCERT_PUBLIC_KEY_INFO)
(*(longlong *)(*(longlong *)(param_1 + 0x20) + 0x18) + 0x60));
*(DWORD *)(param_1 + 0x88) = DVar3;
if (DVar3 == 0) {
*(undefined4 *)(param_1 + 0x48) = 0x2716;
DVar3 = GetLastError();
goto LAB_18005ea4b;
}
DVar3 = FUN_180013bc8(*(longlong *)(param_1 + 0x20),(undefined4 *)(param_1 + 0x8c));
if (DVar3 != 0) {
*(undefined4 *)(param_1 + 0x48) = 0x2716;
goto LAB_18005ea4f;
}
}
if (((param_6 & 1) != 0) || (param_8 != 0)) {
hAdditionalStore = *(HCERTSTORE *)(*(longlong *)(param_1 + 0x20) + 0x20);
}
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(0,(PCEVENT_DESCRIPTOR)&DAT_180084c90,param_5,uVar9,&local_48);
}
ppChainContext = (PCCERT_CHAIN_CONTEXT *)(param_1 + 0x40);
uVar12 = 0;
uVar9 = 0;
BVar5 = CertGetCertificateChain
((HCERTCHAINENGINE)0x0,*(PCCERT_CONTEXT *)(param_1 + 0x20),(LPFILETIME)0x0
,hAdditionalStore,local_a8,param_6 & 4,(LPVOID)0x0,ppChainContext);
if (BVar5 == 0) {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar9,(PCEVENT_DESCRIPTOR)&DAT_180084c80,uVar12,hAdditionalStore,&local_48
);
}
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
DVar3 = GetLastError();
FUN_180043258(DAT_180091000->rgpChain,0x11,&DAT_180082ba8,DVar3,(byte)param_6 & 4);
}
*ppChainContext = (PCCERT_CHAIN_CONTEXT)0x0;
DVar3 = GetLastError();
pCVar10 = (PCCERT_CHAIN_CONTEXT)(ulonglong)*(uint *)(param_1 + 0x28c);
FUN_180044fac(*(uint *)(param_1 + 0x28c),param_1 + 0x290,*(char *)(param_1 + 0x4f),
(char)*(undefined8 *)(param_1 + 0x20),DVar3,param_6 & 4);
}
else {
bVar15 = (byte)DAT_180092f00;
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar9,(PCEVENT_DESCRIPTOR)&DAT_180084c80,uVar12,hAdditionalStore,&local_48
);
bVar15 = (byte)DAT_180092f00;
}
local_110.pvExtraPolicyPara = &local_100;
local_100 = 0x200000018;
uStack_f8 = CONCAT44(uStack_f8._4_4_,0x280);
local_110.cbSize = 0x10;
if ((bVar15 & 1) != 0) {
FUN_180054f60(local_110.pvExtraPolicyPara,(PCEVENT_DESCRIPTOR)&DAT_180084c70,uVar12,
hAdditionalStore,&local_48);
}
pPolicyStatus = &local_e8;
pPolicyPara = &local_110;
BVar5 = CertVerifyCertificateChainPolicy
((LPCSTR)0x4,*ppChainContext,pPolicyPara,pPolicyStatus);
if (((BVar5 == 0) && (DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000)) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
DVar3 = GetLastError();
pPolicyStatus = (PCERT_CHAIN_POLICY_STATUS)(ulonglong)DVar3;
pPolicyPara = (PCERT_CHAIN_POLICY_PARA)&DAT_180082ba8;
FUN_180041cdc(DAT_180091000->rgpChain,0x12,&DAT_180082ba8,DVar3);
}
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(DAT_180091000,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus
,&local_48);
}
pCVar10 = DAT_180091000;
if (local_e8.dwError != 0) {
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
FUN_180041cdc(DAT_180091000->rgpChain,0x13,&DAT_180082ba8,local_e8.dwError);
}
pCVar10 = (PCCERT_CHAIN_CONTEXT)0x800b010a;
if (local_e8.dwError == 0x800b010a) {
pCVar10 = (PCCERT_CHAIN_CONTEXT)(ulonglong)*(uint *)(param_1 + 0x28c);
FUN_1800450b8(*(uint *)(param_1 + 0x28c),param_1 + 0x290,*(char *)(param_1 + 0x4f),
(char)*(undefined8 *)(param_1 + 0x20),0x800b010a);
}
}
}
pvReserved = (undefined4 *)0x0;
if (local_128[0] != 0) {
RevertToSelf();
local_128[0] = 0;
}
if (((*(char *)(param_1 + 0x4f) != '\0') &&
(pCVar10 = *ppChainContext, pCVar10 != (PCCERT_CHAIN_CONTEXT)0x0)) &&
((param_6 & 0x10) == 0)) {
if (DAT_180092f48 != 0) {
local_c8 = 0;
local_b8 = 0;
uStack_b0 = 0;
local_d0 = 0x28;
pvReserved = &local_d0;
local_cc = 1;
local_c0 = DAT_180092f48;
}
pvVar8 = CertOpenServerOcspResponse(pCVar10,1,pvReserved);
*(HCERT_SERVER_OCSP_RESPONSE *)(param_1 + 0x1c8) = pvVar8;
if (((pvVar8 == (HCERT_SERVER_OCSP_RESPONSE)0x0) &&
(DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000)) &&
((DAT_180091000->field_0x1c & 2) != 0)) {
DVar3 = GetLastError();
pCVar10 = (PCCERT_CHAIN_CONTEXT)DAT_180091000->rgpChain;
FUN_180041cdc(pCVar10,0x14,&DAT_180082ba8,DVar3);
}
}
plVar17 = (longlong *)(param_1 + 0x1b8);
bVar15 = (byte)(param_6 >> 3) & 1;
uVar9 = FUN_180054b34(pCVar10,*(longlong *)(param_1 + 0x20),(longlong)*ppChainContext,bVar15
,plVar17,(uint *)(param_1 + 0x1c0));
uVar16 = SUB84(plVar17,0);
if ((int)uVar9 == 0) {
if (*(uint *)(param_1 + 0x1c0) < 0x4001) {
FUN_18005f4a4(param_1);
if (extraout_EAX == 0) {
FUN_180054d10((ushort *)(param_1 + 0x200),*(PCCERT_CONTEXT *)(param_1 + 0x20),
(longlong)*ppChainContext,bVar15);
pwVar1 = (wchar_t *)(param_1 + 0x110);
local_128[1] = 0x40;
DVar3 = FUN_18001050c(*(PCCERT_CONTEXT *)(param_1 + 0x20),pwVar1,
(uint *)(local_128 + 1),(wchar_t *)(param_1 + 0x90),uVar16);
pCVar10 = (PCCERT_CHAIN_CONTEXT)(param_1 + 0x90);
if (DVar3 == 0) {
iVar4 = wcscmp((wchar_t *)pCVar10,L"SHA1");
*(bool *)(param_1 + 0x50) = iVar4 == 0;
}
else {
*(wchar_t *)&pCVar10->cbSize = L'\0';
*pwVar1 = L'\0';
pCVar10 = DAT_180091000;
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 4) != 0)) {
pCVar10 = (PCCERT_CHAIN_CONTEXT)DAT_180091000->rgpChain;
FUN_180041cb0(pCVar10,0x18,&DAT_180082ba8);
}
}
if (param_10 == 0) goto LAB_18005ea4b;
if (*(int *)(param_1 + 0x84) == 0x2203) {
uVar7 = FUN_180004658(pCVar10,*(int *)(param_1 + 0x8c),(longlong *)&local_120);
DVar3 = (DWORD)uVar7;
if (DVar3 != 0) {
*(undefined4 *)(param_1 + 0x48) = 0x2722;
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
FUN_180041cb0(DAT_180091000->rgpChain,0x19,&DAT_180082ba8);
}
goto LAB_18005ea4f;
}
}
if ((*(char *)(param_1 + 0x4f) == '\0') ||
(iVar4 = 0xa400, *(int *)(param_1 + 0x84) != 0xa400)) {
iVar4 = *(int *)(param_1 + 0x84);
cVar2 = '\0';
cVar14 = '\0';
if (iVar4 != 0x2203) goto LAB_18005f273;
uVar13 = *(uint *)(param_1 + 0x88);
}
else {
cVar14 = '\x01';
LAB_18005f273:
cVar2 = cVar14;
uVar13 = *(uint *)(param_1 + 0x1ac);
}
uVar9 = FUN_180008310(local_118,param_10,iVar4,uVar13,local_120,cVar2,
*(char *)(param_1 + 0x4f),(wchar_t *)(param_1 + 0x90),pwVar1,0,
'\x01');
if ((char)uVar9 == '\0') goto LAB_18005ea4b;
*(undefined4 *)(param_1 + 0x48) = 0x2722;
}
else {
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
FUN_180041cdc(DAT_180091000->rgpChain,0x17,&DAT_180082ba8,extraout_EAX);
}
*(undefined4 *)(param_1 + 0x48) = 0x2719;
}
}
else {
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
FUN_180041cb0(DAT_180091000->rgpChain,0x16,&DAT_180082ba8);
}
*(undefined4 *)(param_1 + 0x48) = 0x2718;
}
}
else {
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
FUN_180041cdc(DAT_180091000->rgpChain,0x15,&DAT_180082ba8,(int)uVar9);
}
*(undefined4 *)(param_1 + 0x48) = 0x2717;
}
}
}
else {
if ((DAT_180091000 != (PCCERT_CHAIN_CONTEXT)&DAT_180091000) &&
((DAT_180091000->field_0x1c & 1) != 0)) {
FUN_180041cdc(DAT_180091000->rgpChain,0xf,&DAT_180082ba8,iVar4);
}
*(undefined *)(param_1 + 0x4c) = 1;
}
LAB_18005ea4f:
if (*(PCCERT_CONTEXT *)(param_1 + 0x20) != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(*(PCCERT_CONTEXT *)(param_1 + 0x20));
*(undefined8 *)(param_1 + 0x20) = 0;
}
if (*(HLOCAL *)(param_1 + 0x1b0) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x1b0));
*(undefined8 *)(param_1 + 0x1b0) = 0;
}
}
if (local_128[0] != 0) {
RevertToSelf();
}
LAB_18005ea98:
FUN_180028070(local_38 ^ (ulonglong)auStackY_188);
return;
}
=========================================
Function at address: 0x18005f2e8
Called functions addresses: 0xEXTERNAL:00000040 0x180016828 0xEXTERNAL:00000146 0xEXTERNAL:0000012b 0x1800600f8 0xEXTERNAL:000000b3 0x18005f458 0xEXTERNAL:00000131 0xEXTERNAL:00000108 0x18000909c


void FUN_18005f2e8(longlong param_1,undefined8 param_2,uint param_3)

{
PCCERT_CONTEXT pCVar1;
longlong lVar2;
NCRYPT_HANDLE hObject;
HLOCAL pvVar3;
code *pcVar4;
PCCERT_CONTEXT pCertContext;
PCCERT_CONTEXT hMem;
PCERT_INFO p_Var5;
undefined *puVar6;
undefined auStack_28 [8];
undefined auStack_20 [24];

puVar6 = auStack_28;
if (*(HLOCAL *)(param_1 + 0x1b0) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x1b0));
}
if (*(HCERT_SERVER_OCSP_RESPONSE *)(param_1 + 0x1c8) != (HCERT_SERVER_OCSP_RESPONSE)0x0) {
CertCloseServerOcspResponse(*(HCERT_SERVER_OCSP_RESPONSE *)(param_1 + 0x1c8),0);
}
if (*(PCCERT_CHAIN_CONTEXT *)(param_1 + 0x40) != (PCCERT_CHAIN_CONTEXT)0x0) {
CertFreeCertificateChain(*(PCCERT_CHAIN_CONTEXT *)(param_1 + 0x40));
}
pCertContext = *(PCCERT_CONTEXT *)(param_1 + 0x20);
if (pCertContext != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(pCertContext);
}
FUN_180016828(pCertContext,*(longlong **)(param_1 + 0x1f0));
p_Var5 = *(PCERT_INFO *)(param_1 + 0x1f8);
FUN_180016828(pCertContext,(longlong *)p_Var5);
pCVar1 = (PCCERT_CONTEXT)(param_1 + 0x1e0);
do {
hMem = *(PCCERT_CONTEXT *)pCVar1;
if (hMem == pCVar1) {
LAB_18005f3ad:
*(undefined8 *)(puVar6 + -8) = 0x18005f3b5;
FUN_18005f458(param_1);
if (*(char *)(param_1 + 0x78) == '\0') {
*(undefined8 *)(puVar6 + -8) = 0x18005f3c3;
FUN_1800600f8(param_1,p_Var5,param_3);
}
if ((*(char *)(param_1 + 0x4e) == '\0') &&
(hObject = *(NCRYPT_HANDLE *)(param_1 + 0x68), hObject != 0)) {
*(undefined8 *)(puVar6 + -8) = 0x18005f3d9;
NCryptFreeObject(hObject);
}
pvVar3 = *(HLOCAL *)(param_1 + 0x1b8);
if (pvVar3 != (HLOCAL)0x0) {
*(undefined8 *)(puVar6 + -8) = 0x18005f3ef;
FUN_18000909c(pvVar3);
}
pvVar3 = *(HLOCAL *)(param_1 + 0x1a0);
if (pvVar3 != (HLOCAL)0x0) {
*(undefined8 *)(puVar6 + -8) = 0x18005f400;
FUN_18000909c(pvVar3);
}
pvVar3 = *(HLOCAL *)(param_1 + 400);
if (pvVar3 != (HLOCAL)0x0) {
*(undefined8 *)(puVar6 + -8) = 0x18005f411;
FUN_18000909c(pvVar3);
}
pvVar3 = *(HLOCAL *)(param_1 + 0x1d0);
if (pvVar3 != (HLOCAL)0x0) {
*(undefined8 *)(puVar6 + -8) = 0x18005f422;
FUN_18000909c(pvVar3);
}
if (*(char *)(param_1 + 0x288) != '\0') {
*(undefined8 *)(puVar6 + -8) = 0x18005f439;
RtlDeleteResource(param_1 + 0x228);
}
return;
}
if (((PCCERT_CONTEXT)hMem->pbCertEncoded != pCVar1) ||
(lVar2 = *(longlong *)hMem, *(PCCERT_CONTEXT *)(lVar2 + 8) != hMem)) {
pcVar4 = (code *)swi(0x29);
(*pcVar4)(3);
puVar6 = auStack_20;
goto LAB_18005f3ad;
}
*(longlong *)pCVar1 = lVar2;
*(PCCERT_CONTEXT *)(lVar2 + 8) = pCVar1;
p_Var5 = hMem->pCertInfo;
FUN_180016828(pCertContext,(longlong *)p_Var5);
LocalFree(hMem);
pCertContext = hMem;
} while( true );
}
=========================================
Function at address: 0x18005f458
Called functions addresses: 0x1800209bc 0x18000909c


void FUN_18005f458(longlong param_1)

{
int *piVar1;
HLOCAL pvVar2;

pvVar2 = *(HLOCAL *)(param_1 + 0x58);
if (pvVar2 != (HLOCAL)0x0) {
if (*(int *)(param_1 + 0x60) != 0) {
do {
FUN_1800209bc(*(longlong **)
(*(longlong *)(param_1 + 0x58) +
(ulonglong)(*(int *)(param_1 + 0x60) - 1) * 8));
piVar1 = (int *)(param_1 + 0x60);
*piVar1 = *piVar1 + -1;
} while (*piVar1 != 0);
pvVar2 = *(HLOCAL *)(param_1 + 0x58);
}
FUN_18000909c(pvVar2);
*(undefined8 *)(param_1 + 0x58) = 0;
}
return;
}
=========================================
Function at address: 0x18005f4a4
Called functions addresses: 0x180041cdc 0xEXTERNAL:00000136 0xEXTERNAL:00000041 0x18000a1f4 0x18000909c 0xEXTERNAL:00000139


DWORD FUN_18005f4a4(longlong param_1)

{
DWORD *pDVar1;
DWORD DVar2;
LPWSTR pWVar3;
DWORD unaff_EBX;

pDVar1 = *(DWORD **)(param_1 + 0x20);
DVar2 = CertNameToStrW(*pDVar1,(PCERT_NAME_BLOB)(*(longlong *)(pDVar1 + 6) + 0x30),0x20000003,
(LPWSTR)0x0,0);
if (DVar2 != 0) {
*(DWORD *)(param_1 + 0x1a8) = DVar2 * 2;
pWVar3 = (LPWSTR)FUN_18000a1f4((ulonglong)(DVar2 * 2));
*(LPWSTR *)(param_1 + 0x1a0) = pWVar3;
if (pWVar3 == (LPWSTR)0x0) goto LAB_18005f620;
DVar2 = CertNameToStrW(*pDVar1,(PCERT_NAME_BLOB)(*(longlong *)(pDVar1 + 6) + 0x30),0x20000003,
pWVar3,DVar2);
if (DVar2 != 0) {
DVar2 = CertGetPublicKeyLength
(0x10001,(PCERT_PUBLIC_KEY_INFO)(*(longlong *)(pDVar1 + 6) + 0x60));
*(DWORD *)(param_1 + 0x1ac) = DVar2;
if (DVar2 == 0) {
DVar2 = GetLastError();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x27,&DAT_180082ba8,DVar2);
}
goto LAB_18005f620;
}
DVar2 = CertNameToStrW(*pDVar1,(PCERT_NAME_BLOB)(*(longlong *)(pDVar1 + 6) + 0x50),0x20000003,
(LPWSTR)0x0,0);
if (DVar2 != 0) {
*(DWORD *)(param_1 + 0x198) = DVar2 * 2;
pWVar3 = (LPWSTR)FUN_18000a1f4((ulonglong)(DVar2 * 2));
*(LPWSTR *)(param_1 + 400) = pWVar3;
if (pWVar3 == (LPWSTR)0x0) goto LAB_18005f620;
DVar2 = CertNameToStrW(*pDVar1,(PCERT_NAME_BLOB)(*(longlong *)(pDVar1 + 6) + 0x50),
0x20000003,pWVar3,DVar2);
if (DVar2 != 0) {
return unaff_EBX;
}
}
}
}
GetLastError();
LAB_18005f620:
if (*(HLOCAL *)(param_1 + 400) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 400));
*(undefined8 *)(param_1 + 400) = 0;
}
if (*(HLOCAL *)(param_1 + 0x1a0) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x1a0));
*(undefined8 *)(param_1 + 0x1a0) = 0;
}
return unaff_EBX;
}
=========================================
Function at address: 0x18005f670
Called functions addresses: 0x18001a690 0xEXTERNAL:0000003f 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc


ulonglong FUN_18005f670(longlong param_1,int param_2,_FILETIME *param_3)

{
longlong lVar1;
longlong *plVar2;
code *pcVar3;
longlong *plVar4;
ulonglong uVar5;
longlong lVar6;
undefined4 in_register_00000014;
undefined *puVar7;
undefined *puVar8;
_FILETIME *p_Var9;
undefined auStack_38 [8];
undefined auStack_30 [24];

uVar5 = CONCAT44(in_register_00000014,param_2);
puVar7 = auStack_38;
puVar8 = auStack_38;
if (param_2 == *(int *)(param_1 + 0x8c)) {
p_Var9 = (_FILETIME *)(param_1 + 0x1f8);
puVar8 = auStack_38;
}
else {
param_3->dwLowDateTime = 0;
param_3->dwHighDateTime = 0;
lVar1 = param_1 + 0x228;
RtlAcquireResourceExclusive(lVar1,CONCAT71((int7)(uVar5 >> 8),1));
plVar2 = (longlong *)(param_1 + 0x1e0);
for (plVar4 = (longlong *)*plVar2; plVar4 != plVar2; plVar4 = (longlong *)*plVar4) {
if (*(int *)(plVar4 + 2) == param_2) {
p_Var9 = (_FILETIME *)(plVar4 + 3);
if (p_Var9 != (_FILETIME *)0x0) goto LAB_18005f73f;
break;
}
}
plVar4 = (longlong *)LocalAlloc(0x40,0x20);
if (plVar4 == (longlong *)0x0) {
RtlReleaseResource(lVar1);
return 0xe;
}
*(int *)(plVar4 + 2) = param_2;
plVar4[1] = (longlong)plVar4;
*plVar4 = (longlong)plVar4;
lVar6 = *plVar2;
if (*(longlong **)(lVar6 + 8) != plVar2) {
lVar6 = 3;
pcVar3 = (code *)swi(0x29);
plVar4 = (longlong *)(*pcVar3)();
puVar7 = auStack_30;
}
*plVar4 = lVar6;
p_Var9 = (_FILETIME *)(plVar4 + 3);
plVar4[1] = (longlong)plVar2;
*(longlong **)(lVar6 + 8) = plVar4;
*plVar2 = (longlong)plVar4;
puVar8 = puVar7;
LAB_18005f73f:
*(undefined8 *)(puVar8 + -8) = 0x18005f749;
RtlReleaseResource(lVar1);
uVar5 = (ulonglong)(uint)param_2;
}
*(undefined8 *)(puVar8 + -8) = 0x18005f75e;
uVar5 = FUN_18001a690(param_1,(int)uVar5,p_Var9,param_3);
return uVar5;
}
=========================================
Function at address: 0x18005f780
Called functions addresses: 0x180041cdc 0x18005ca1c 0xEXTERNAL:00000047 0x180001604


ulonglong FUN_18005f780(longlong param_1,undefined8 *param_2,longlong param_3)

{
uint uVar1;
ulonglong uVar2;
int local_res20 [2];
undefined4 local_18 [4];

local_res20[0] = 0;
local_18[0] = 0;
uVar2 = FUN_180001604(param_3,local_res20);
if ((int)uVar2 == 0) {
uVar1 = FUN_18005ca1c((NCRYPT_KEY_HANDLE *)(param_1 + 0x68),(LPCWSTR)*param_2,
(LPCWSTR)param_2[1],*(DWORD *)(param_2 + 5),
*(uint *)((longlong)param_2 + 0x14),0,local_18);
if (uVar1 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1b,&DAT_180082ba8,uVar1);
}
*(undefined4 *)(param_1 + 0x48) = 0x2712;
}
if (local_res20[0] != 0) {
RevertToSelf();
}
uVar2 = (ulonglong)uVar1;
}
return uVar2;
}
=========================================
Function at address: 0x18005f83c
Called functions addresses: 0x180059ed0 0xEXTERNAL:0000011c 0xEXTERNAL:00000047 0x180001604 0x18000a1f4 0x180023480 0x18000909c


ulonglong FUN_18005f83c(longlong param_1,longlong param_2)

{
undefined8 uVar1;
HLOCAL pvVar2;
int iVar3;
longlong lVar4;
undefined8 *puVar5;
longlong *plVar6;
uint uVar7;
uint uVar8;
ulonglong uVar9;
ulonglong unaff_RDI;
int local_res18 [2];
uint local_res20 [2];
HLOCAL local_28 [2];

local_res18[0] = 0;
local_28[0] = (HLOCAL)0x0;
local_res20[0] = 0;
uVar9 = 0;
iVar3 = FUN_180001604(param_2,local_res18);
if (iVar3 != 0) {
return unaff_RDI;
}
iVar3 = FUN_180059ed0(param_2,*(undefined8 *)(param_1 + 0x20),(longlong *)local_28,local_res20);
if (local_res18[0] != 0) {
RevertToSelf();
}
uVar7 = local_res20[0];
if (iVar3 != 0) {
*(undefined4 *)(param_1 + 0x48) = 0x2711;
return unaff_RDI;
}
lVar4 = FUN_18000a1f4((ulonglong)(local_res20[0] * 8));
pvVar2 = local_28[0];
*(longlong *)(param_1 + 0x58) = lVar4;
if (lVar4 != 0) {
iVar3 = 0;
if (uVar7 != 0) {
do {
puVar5 = (undefined8 *)FUN_18000a1f4(0x20);
if (puVar5 == (undefined8 *)0x0) {
puVar5 = (undefined8 *)0x0;
}
else {
uVar1 = *(undefined8 *)((longlong)pvVar2 + uVar9 * 0x10);
puVar5[1] = *(undefined8 *)((longlong)pvVar2 + uVar9 * 0x10 + 8);
puVar5[2] = uVar1;
*puVar5 = &PTR_FUN_18007d568;
*(undefined4 *)(puVar5 + 3) = 1;
}
*(undefined8 **)(*(longlong *)(param_1 + 0x58) + uVar9 * 8) = puVar5;
if (*(longlong *)(*(longlong *)(param_1 + 0x58) + uVar9 * 8) == 0) {
iVar3 = 0xe;
break;
}
uVar8 = (int)uVar9 + 1;
uVar9 = (ulonglong)uVar8;
} while (uVar8 < uVar7);
}
*(int *)(param_1 + 0x60) = (int)uVar9;
if (iVar3 == 0) goto LAB_18005f975;
}
while ((uint)uVar9 < uVar7) {
uVar7 = uVar7 - 1;
plVar6 = (longlong *)((ulonglong)uVar7 * 0x10 + (longlong)pvVar2);
lVar4 = plVar6[1];
SslFreeObject(lVar4,0);
FUN_180023480(lVar4,plVar6);
}
LAB_18005f975:
if (pvVar2 != (HLOCAL)0x0) {
FUN_18000909c(pvVar2);
}
return unaff_RDI;
}
=========================================
Function at address: 0x18005f9a0
Called functions addresses: 0x18005f780 0x180044d6c 0x180044c38 0x18002a700 0xEXTERNAL:00000041 0x1800432ec 0x180028070 0xEXTERNAL:00000152 0x18005f83c 0x180041d70 0x180041e9c 0x180045164 0x180041cdc 0x180044ccc 0x180041cb0 0x18002a7c0 0x18000a418 0x180041460


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_18005f9a0(ulonglong param_1,longlong param_2,longlong param_3)

{
char cVar1;
undefined4 uVar2;
PCCERT_CONTEXT pCertContext;
wchar_t *pwVar3;
LPCWSTR pWVar4;
LPCWSTR pWVar5;
BOOL BVar6;
uint uVar7;
DWORD DVar8;
int extraout_EAX;
int extraout_EAX_00;
int extraout_EAX_01;
longlong lVar9;
undefined8 uVar10;
ulonglong uVar11;
undefined8 *pvData;
ulonglong uVar12;
int iVar13;
undefined *puVar14;
undefined *puVar15;
undefined auStack_58 [48];
DWORD local_28;
DWORD local_24;
ulonglong local_20;

local_20 = DAT_180091970 ^ (ulonglong)&local_28;
pvData = (undefined8 *)0x0;
local_24 = 0;
local_28 = 0;
if ((*(char *)(param_1 + 0x4f) == '\0') && (lVar9 = *(longlong *)(param_3 + 0x10), lVar9 != 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x1c,&DAT_180082ba8,lVar9);
lVar9 = *(longlong *)(param_3 + 0x10);
}
*(longlong *)(param_1 + 0x70) = lVar9;
*(undefined *)(param_1 + 0x78) = 1;
}
BVar6 = CertGetCertificateContextProperty
(*(PCCERT_CONTEXT *)(param_1 + 0x20),2,(void *)0x0,&local_28);
if (BVar6 == 0) {
BVar6 = CertGetCertificateContextProperty
(*(PCCERT_CONTEXT *)(param_1 + 0x20),5,(void *)0x0,&local_24);
puVar15 = auStack_58;
if (((BVar6 == 0) && (puVar15 = auStack_58, (undefined8 **)DAT_180091000 != &DAT_180091000)) &&
(puVar15 = auStack_58, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
DVar8 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x22,&DAT_180082ba8,DVar8);
puVar15 = auStack_58;
}
LAB_18005fc98:
if (*(char *)(param_1 + 0x78) == '\0') {
if (pvData == (undefined8 *)0x0) {
if (local_24 != 0) {
if (*(char *)(param_1 + 0x4f) != '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar10 = DAT_180091000[2];
*(undefined8 *)(puVar15 + -8) = 0x18005fdda;
FUN_180041cb0(uVar10,0x26,&DAT_180082ba8);
}
*(undefined8 *)(puVar15 + -8) = 0x18005fde5;
uVar11 = FUN_18005f83c(param_1,param_2);
if (extraout_EAX_01 != 0) {
cVar1 = *(char *)(uVar11 + 0x4f);
uVar7 = *(uint *)(uVar11 + 0x28c);
*(undefined4 *)(puVar15 + 0x20) = *(undefined4 *)(uVar11 + 0x48);
*(undefined8 *)(puVar15 + -8) = 0x18005fe0b;
FUN_180044ccc(uVar7,uVar11 + 0x290,cVar1,(char)extraout_EAX_01,
*(undefined4 *)(puVar15 + 0x20));
}
}
goto LAB_18005fe5b;
}
goto LAB_18005fe12;
}
if (*(char *)(param_1 + 0x4f) == '\0') {
if (*(char *)(param_1 + 0x4e) == '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar10 = DAT_180091000[2];
*(undefined8 *)(puVar15 + -8) = 0x18005fd19;
FUN_180041cb0(uVar10,0x24,&DAT_180082ba8);
}
*(undefined8 *)(puVar15 + -8) = 0x18005fd27;
uVar11 = FUN_18005f780(param_1,pvData,param_2);
iVar13 = (int)uVar11;
goto LAB_18005fd27;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar10 = DAT_180091000[2];
*(undefined8 *)(puVar15 + -8) = 0x18005fd53;
FUN_180041cb0(uVar10,0x25,&DAT_180082ba8);
}
iVar13 = *(int *)(pvData + 5);
pWVar4 = (LPCWSTR)pvData[1];
pWVar5 = (LPCWSTR)*pvData;
*(undefined4 *)(puVar15 + 0x28) = *(undefined4 *)((longlong)pvData + 0x14);
*(undefined4 *)(puVar15 + 0x20) = *(undefined4 *)(pvData + 2);
*(undefined8 *)(puVar15 + -8) = 0x18005fd75;
iVar13 = FUN_180041460(pWVar5,pWVar4,(undefined8 *)(param_1 + 0x28),iVar13,
*(int *)(puVar15 + 0x20),*(int *)(puVar15 + 0x28));
pvData = (undefined8 *)CONCAT44((int)((ulonglong)pvData >> 0x20),iVar13);
if (extraout_EAX_00 == 0) goto LAB_18005fe38;
*(undefined4 *)(param_1 + 0x48) = 0x2713;
iVar13 = extraout_EAX_00;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar10 = DAT_180091000[2];
*(undefined8 *)(puVar15 + -8) = 0x18005fcde;
FUN_180041cb0(uVar10,0x23,&DAT_180082ba8);
}
*(uint *)((longlong)pvData + 0x14) = *(uint *)((longlong)pvData + 0x14) & 0xfffffffe;
*(uint *)((longlong)pvData + 0x14) = *(uint *)((longlong)pvData + 0x14) | 0x40;
*(undefined8 *)(puVar15 + -8) = 0x18005fcf1;
param_1 = FUN_18005f83c(param_1,param_2);
iVar13 = extraout_EAX;
LAB_18005fd27:
if (iVar13 == 0) goto LAB_18005fe38;
}
cVar1 = *(char *)(param_1 + 0x4f);
uVar7 = *(uint *)(param_1 + 0x28c);
*(undefined4 *)(puVar15 + 0x20) = *(undefined4 *)(param_1 + 0x48);
*(undefined8 *)(puVar15 + -8) = 0x18005fda6;
FUN_180044ccc(uVar7,param_1 + 0x290,cVar1,(char)iVar13,*(undefined4 *)(puVar15 + 0x20));
}
else if (pvData == (undefined8 *)0x0) goto LAB_18005fe5b;
}
else {
uVar11 = (ulonglong)local_28;
puVar15 = auStack_58;
if (((local_28 != 0) && (puVar15 = auStack_58, uVar11 <= DAT_1800920e0)) &&
((uVar12 = DAT_1800920e8 + 8 + uVar11, puVar15 = auStack_58, uVar11 <= uVar12 &&
(uVar10 = FUN_18000a418(uVar12), puVar15 = auStack_58, (int)uVar10 != 0)))) {
uVar11 = (ulonglong)(local_28 + 8) + 0xf;
if (uVar11 <= local_28 + 8) {
uVar11 = 0xffffffffffffff0;
}
lVar9 = -(uVar11 & 0xfffffffffffffff0);
pvData = (undefined8 *)((longlong)&local_28 + lVar9);
puVar15 = auStack_58 + lVar9;
if (pvData == (undefined8 *)0x0) goto LAB_18005fabb;
*(undefined4 *)pvData = 0x6b637453;
pvData = (undefined8 *)((longlong)&local_20 + lVar9);
puVar15 = auStack_58 + lVar9;
puVar14 = auStack_58 + lVar9;
if (pvData == (undefined8 *)0x0) goto LAB_18005fabb;
LAB_18005fafc:
pCertContext = *(PCCERT_CONTEXT *)(param_1 + 0x20);
*(undefined8 *)(puVar14 + -8) = 0x18005fb11;
BVar6 = CertGetCertificateContextProperty(pCertContext,2,pvData,&local_28);
puVar15 = puVar14;
if (BVar6 == 0) {
if (*(int *)(pvData + -1) == 0x70616548) {
*(undefined8 *)(puVar14 + -8) = 0x18005fb3d;

}
pvData = (undefined8 *)0x0;
}
else {
*(undefined4 *)(param_1 + 0x7c) = *(undefined4 *)(pvData + 2);
*(undefined4 *)(param_1 + 0x80) = *(undefined4 *)(pvData + 5);
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar3 = (wchar_t *)*pvData;
uVar10 = DAT_180091000[2];
*(undefined8 *)(puVar14 + -8) = 0x18005fb84;
FUN_180041d70(uVar10,0x1d,&DAT_180082ba8,pwVar3);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
pwVar3 = (wchar_t *)pvData[1];
uVar10 = DAT_180091000[2];
*(undefined8 *)(puVar14 + -8) = 0x18005fbaf;
FUN_180041d70(uVar10,0x1e,&DAT_180082ba8,pwVar3);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
uVar2 = *(undefined4 *)(pvData + 2);
uVar10 = DAT_180091000[2];
*(undefined8 *)(puVar14 + -8) = 0x18005fbd6;
FUN_180041cdc(uVar10,0x1f,&DAT_180082ba8,uVar2);
}
if ((undefined8 **)DAT_180091000 != &DAT_180091000) {
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
uVar2 = *(undefined4 *)((longlong)pvData + 0x14);
uVar10 = DAT_180091000[2];
*(undefined8 *)(puVar14 + -8) = 0x18005fbfd;
FUN_180041cdc(uVar10,0x20,&DAT_180082ba8,uVar2);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar2 = *(undefined4 *)(pvData + 5);
uVar10 = DAT_180091000[2];
*(undefined8 *)(puVar14 + -8) = 0x18005fc24;
FUN_1800432ec(uVar10,0x21,&DAT_180082ba8,uVar2);
}
}
}
}
}
cVar1 = *(char *)(param_1 + 0x4f);
*(undefined8 *)(puVar14 + -8) = 0x18005fc33;
FUN_180044d6c(cVar1,pvData);
}
goto LAB_18005fc98;
}
LAB_18005fabb:
uVar7 = local_28 + 8;
if (uVar7 < local_28) {
LAB_18005faed:
puVar14 = puVar15;
if (pvData != (undefined8 *)0x0) goto LAB_18005fafc;
}
else {
*(undefined8 *)(puVar15 + -8) = 0x18005fadb;

if (pvData != (undefined8 *)0x0) {
*(undefined4 *)pvData = 0x70616548;
pvData = pvData + 1;
goto LAB_18005faed;
}
}
LAB_18005fe12:
cVar1 = *(char *)(param_1 + 0x4f);
uVar7 = *(uint *)(param_1 + 0x28c);
if (pvData == (undefined8 *)0x0) {
*(undefined8 *)(puVar15 + -8) = 0x18005fe2d;
FUN_180045164(uVar7,param_1 + 0x290,cVar1);
goto LAB_18005fe5b;
}
*(undefined8 *)(puVar15 + -8) = 0x18005fe38;
FUN_180044c38(uVar7,param_1 + 0x290,cVar1);
}
LAB_18005fe38:
if (*(int *)(pvData + -1) == 0x70616548) {
*(undefined8 *)(puVar15 + -8) = 0x18005fe5b;

}
LAB_18005fe5b:
uVar11 = local_20 ^ (ulonglong)&local_28;
*(undefined8 *)(puVar15 + -8) = 0x18005fe69;
FUN_180028070(uVar11);
return;
}
=========================================
Function at address: 0x18005fe8c
Called functions addresses: 0xEXTERNAL:000000c2 0xEXTERNAL:000000c0


undefined8 FUN_18005fe8c(longlong param_1,longlong param_2,undefined8 *param_3)

{
int *piVar1;
longlong lVar2;
uint uVar3;
ulonglong uVar4;
undefined8 uVar5;

uVar5 = 0x490;
RtlAcquireResourceShared(param_1 + 0x228,1);
uVar4 = 0;
if (*(int *)(param_1 + 0x60) != 0) {
do {
lVar2 = *(longlong *)(*(longlong *)(param_1 + 0x58) + uVar4 * 8);
if (*(longlong *)(lVar2 + 0x10) == param_2) {
LOCK();
piVar1 = (int *)(lVar2 + 0x18);
*piVar1 = *piVar1 + 1;
UNLOCK();
uVar5 = 0;
*param_3 = *(undefined8 *)(*(longlong *)(param_1 + 0x58) + uVar4 * 8);
break;
}
uVar3 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar3;
} while (uVar3 < *(uint *)(param_1 + 0x60));
}
RtlReleaseResource(param_1 + 0x228);
return uVar5;
}
=========================================
Function at address: 0x18005ff30
Called functions addresses: 0x180004658 0x18005e464 0x180015828 0x180008310 0x180041d70


ulonglong FUN_18005ff30(longlong param_1,int param_2,uint param_3,longlong param_4,uint *param_5,
uint param_6)

{
int iVar1;
ulonglong uVar2;
int *piVar3;
longlong lVar4;
undefined2 uVar5;
wchar_t *pwVar6;
uint uVar7;
wchar_t *local_res8;

local_res8 = (wchar_t *)0x0;
piVar3 = *(int **)(param_1 + 0x20);
if (((((piVar3 == (int *)0x0) || (*piVar3 != 1)) ||
((*(longlong *)(param_1 + 0x1b0) == 0 && (*(int *)(param_1 + 0x84) == 0)))) ||
(iVar1 = *(int *)(param_1 + 0x84), param_2 != iVar1)) ||
(((param_3 & 0xa2a80) == 0 && (iVar1 == 0x2203)))) goto LAB_18006003f;
lVar4 = param_1;
if (param_4 == 0) {
LAB_180060058:
pwVar6 = (wchar_t *)0x0;
if ((iVar1 != 0x2203) ||
(piVar3 = (int *)FUN_180004658(lVar4,*(int *)(param_1 + 0x8c),(longlong *)&local_res8),
pwVar6 = local_res8, (int)piVar3 == 0)) {
if (param_6 != 0) {
if (*(int *)(param_1 + 0x84) == 0x2203) {
uVar7 = *(uint *)(param_1 + 0x88);
}
else {
uVar7 = *(uint *)(param_1 + 0x1ac);
}
piVar3 = (int *)FUN_180008310(param_5,param_6,*(int *)(param_1 + 0x84),uVar7,pwVar6,'\0',
'\0',(wchar_t *)(param_1 + 0x90),(wchar_t *)(param_1 + 0x110),
0,'\x01');
if ((char)piVar3 != '\0') goto LAB_18006003f;
}
return CONCAT71((int7)((ulonglong)piVar3 >> 8),1);
}
}
else {
uVar2 = FUN_18005e464(param_4,iVar1,*(uint *)(param_1 + 0x1ac),param_3,*(uint *)(param_1 + 0x8c)
);
if ((char)uVar2 == '\0') {
piVar3 = (int *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18006003f;
uVar5 = 0x28;
}
else {
piVar3 = (int *)FUN_180015828(param_4,(short *)(param_1 + 0x200));
lVar4 = param_4;
if ((char)piVar3 != '\0') goto LAB_180060058;
piVar3 = (int *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0)) goto LAB_18006003f;
uVar5 = 0x29;
}
pwVar6 = L"";
if (*(wchar_t **)(param_1 + 400) != (wchar_t *)0x0) {
pwVar6 = *(wchar_t **)(param_1 + 400);
}
piVar3 = (int *)FUN_180041d70(DAT_180091000[2],uVar5,&DAT_180082ba8,pwVar6);
}
LAB_18006003f:
return (ulonglong)piVar3 & 0xffffffffffffff00;
}
=========================================
Function at address: 0x1800600f8
Called functions addresses: 0x180040ea4


void FUN_1800600f8(longlong param_1,undefined8 param_2,uint param_3)

{
int iVar1;
longlong lVar2;

if ((*(longlong *)(param_1 + 0x70) != 0) ||
((*(longlong *)(param_1 + 0x68) != 0 && (*(char *)(param_1 + 0x4e) != '\0')))) {
iVar1 = FUN_180040ea4(*(undefined8 *)(param_1 + 0x68),*(longlong *)(param_1 + 0x70),param_3);
lVar2 = CONCAT44((int)((ulonglong)param_1 >> 0x20),iVar1);
*(undefined8 *)(lVar2 + 0x68) = 0;
*(undefined8 *)(lVar2 + 0x70) = 0;
}
return;
}
=========================================
Function at address: 0x180060138
Called functions addresses: 0x180020df0


undefined8 * FUN_180060138(undefined8 *param_1,longlong param_2)

{
undefined8 uVar1;

FUN_180020df0(param_1,param_2);
*param_1 = &PTR_FUN_18007c000;
param_1[0x74] = *(undefined8 *)(param_2 + 0x3a0);
param_1[0x75] = *(undefined8 *)(param_2 + 0x3a8);
*(undefined4 *)(param_1 + 0x76) = *(undefined4 *)(param_2 + 0x3b0);
param_1[0x77] = *(undefined8 *)(param_2 + 0x3b8);
*(undefined4 *)(param_1 + 0x78) = *(undefined4 *)(param_2 + 0x3c0);
param_1[0x79] = *(undefined8 *)(param_2 + 0x3c8);
*(undefined4 *)(param_1 + 0x7a) = *(undefined4 *)(param_2 + 0x3d0);
*(undefined2 *)((longlong)param_1 + 0x3d4) = *(undefined2 *)(param_2 + 0x3d4);
param_1[0x7f] = *(undefined8 *)(param_2 + 0x3f8);
param_1[0x80] = *(undefined8 *)(param_2 + 0x400);
*(undefined *)(param_1 + 0x81) = *(undefined *)(param_2 + 0x408);
param_1[0x82] = *(undefined8 *)(param_2 + 0x410);
*(undefined4 *)(param_1 + 0x83) = *(undefined4 *)(param_2 + 0x418);
*(undefined4 *)((longlong)param_1 + 0x51c) = *(undefined4 *)(param_2 + 0x51c);
*(undefined *)(param_1 + 0xa4) = *(undefined *)(param_2 + 0x520);
*(undefined *)((longlong)param_1 + 0x521) = *(undefined *)(param_2 + 0x521);
*(undefined *)((longlong)param_1 + 0x522) = *(undefined *)(param_2 + 0x522);
*(undefined *)((longlong)param_1 + 0x523) = *(undefined *)(param_2 + 0x523);
param_1[0xa5] = *(undefined8 *)(param_2 + 0x528);
param_1[0xa6] = *(undefined8 *)(param_2 + 0x530);
param_1[0xa7] = *(undefined8 *)(param_2 + 0x538);
*(undefined *)(param_1 + 0xa8) = *(undefined *)(param_2 + 0x540);
*(undefined2 *)((longlong)param_1 + 0x542) = *(undefined2 *)(param_2 + 0x542);
uVar1 = *(undefined8 *)(param_2 + 0x424);
*(undefined8 *)((longlong)param_1 + 0x41c) = *(undefined8 *)(param_2 + 0x41c);
*(undefined8 *)((longlong)param_1 + 0x424) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x434);
*(undefined8 *)((longlong)param_1 + 0x42c) = *(undefined8 *)(param_2 + 0x42c);
*(undefined8 *)((longlong)param_1 + 0x434) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x444);
*(undefined8 *)((longlong)param_1 + 0x43c) = *(undefined8 *)(param_2 + 0x43c);
*(undefined8 *)((longlong)param_1 + 0x444) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x454);
*(undefined8 *)((longlong)param_1 + 0x44c) = *(undefined8 *)(param_2 + 0x44c);
*(undefined8 *)((longlong)param_1 + 0x454) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x464);
*(undefined8 *)((longlong)param_1 + 0x45c) = *(undefined8 *)(param_2 + 0x45c);
*(undefined8 *)((longlong)param_1 + 0x464) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x474);
*(undefined8 *)((longlong)param_1 + 0x46c) = *(undefined8 *)(param_2 + 0x46c);
*(undefined8 *)((longlong)param_1 + 0x474) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x484);
*(undefined8 *)((longlong)param_1 + 0x47c) = *(undefined8 *)(param_2 + 0x47c);
*(undefined8 *)((longlong)param_1 + 0x484) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x494);
*(undefined8 *)((longlong)param_1 + 0x48c) = *(undefined8 *)(param_2 + 0x48c);
*(undefined8 *)((longlong)param_1 + 0x494) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x4a4);
*(undefined8 *)((longlong)param_1 + 0x49c) = *(undefined8 *)(param_2 + 0x49c);
*(undefined8 *)((longlong)param_1 + 0x4a4) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x4b4);
*(undefined8 *)((longlong)param_1 + 0x4ac) = *(undefined8 *)(param_2 + 0x4ac);
*(undefined8 *)((longlong)param_1 + 0x4b4) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x4c4);
*(undefined8 *)((longlong)param_1 + 0x4bc) = *(undefined8 *)(param_2 + 0x4bc);
*(undefined8 *)((longlong)param_1 + 0x4c4) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x4d4);
*(undefined8 *)((longlong)param_1 + 0x4cc) = *(undefined8 *)(param_2 + 0x4cc);
*(undefined8 *)((longlong)param_1 + 0x4d4) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x4e4);
*(undefined8 *)((longlong)param_1 + 0x4dc) = *(undefined8 *)(param_2 + 0x4dc);
*(undefined8 *)((longlong)param_1 + 0x4e4) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x4f4);
*(undefined8 *)((longlong)param_1 + 0x4ec) = *(undefined8 *)(param_2 + 0x4ec);
*(undefined8 *)((longlong)param_1 + 0x4f4) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x504);
*(undefined8 *)((longlong)param_1 + 0x4fc) = *(undefined8 *)(param_2 + 0x4fc);
*(undefined8 *)((longlong)param_1 + 0x504) = uVar1;
*(undefined8 *)((longlong)param_1 + 0x50c) = *(undefined8 *)(param_2 + 0x50c);
*(undefined4 *)((longlong)param_1 + 0x514) = *(undefined4 *)(param_2 + 0x514);
*(undefined2 *)(param_1 + 0xa3) = *(undefined2 *)(param_2 + 0x518);
*(undefined *)((longlong)param_1 + 0x51a) = *(undefined *)(param_2 + 0x51a);
uVar1 = *(undefined8 *)(param_2 + 0x3de);
*(undefined8 *)((longlong)param_1 + 0x3d6) = *(undefined8 *)(param_2 + 0x3d6);
*(undefined8 *)((longlong)param_1 + 0x3de) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x3ee);
*(undefined8 *)((longlong)param_1 + 0x3e6) = *(undefined8 *)(param_2 + 0x3e6);
*(undefined8 *)((longlong)param_1 + 0x3ee) = uVar1;
uVar1 = *(undefined8 *)(param_2 + 0x54c);
*(undefined8 *)((longlong)param_1 + 0x544) = *(undefined8 *)(param_2 + 0x544);
*(undefined8 *)((longlong)param_1 + 0x54c) = uVar1;
*(undefined8 *)(param_2 + 0x528) = 0;
*(undefined8 *)(param_2 + 0x530) = 0;
*(undefined8 *)(param_2 + 0x3f8) = 0;
*(undefined8 *)(param_2 + 0x400) = 0;
*(undefined8 *)(param_2 + 0x538) = 0;
*(undefined8 *)(param_2 + 0x3a0) = 0;
*(undefined8 *)(param_2 + 0x3a8) = 0;
*(undefined4 *)(param_2 + 0x3b0) = 0;
*(undefined8 *)(param_2 + 0x3b8) = 0;
*(undefined4 *)(param_2 + 0x3c0) = 0;
*(undefined8 *)(param_2 + 0x3c8) = 0;
*(undefined4 *)(param_2 + 0x3d0) = 0;
*(undefined8 *)(param_2 + 0x410) = 0;
return param_1;
}
=========================================
Function at address: 0x1800603d0
Called functions addresses: 0x180028a7c 0x180008da0


undefined8 * FUN_1800603d0(undefined8 *param_1,uint param_2)

{
FUN_180008da0(param_1);
if ((param_2 & 1) != 0) {
_o_free(param_1);
}
return param_1;
}
=========================================
Function at address: 0x180060408
Called functions addresses: 0x180028070 0x18002a77b


void FUN_180060408(uint param_1,undefined *param_2)

{
uint uVar1;
uint uVar2;
int iVar3;
uint uVar4;
ulonglong uVar5;
ulonglong uVar6;
undefined auStack_38 [32];
longlong local_18;
ulonglong local_10;

local_10 = DAT_180091970 ^ (ulonglong)auStack_38;
local_18 = 0;
uVar5 = 7;
uVar6 = uVar5;
if (param_1 < 0x80) {
local_18 = (ulonglong)(byte)param_1 << 0x38;
iVar3 = 1;
}
else {
do {
uVar4 = (int)uVar6 - 1;
uVar5 = (ulonglong)uVar4;
*(char *)((longlong)&local_18 + uVar6) = (char)param_1;
uVar2 = param_1 >> 8;
uVar1 = param_1 >> 8;
uVar6 = uVar5;
param_1 = uVar2;
} while (uVar1 != 0);
iVar3 = (uVar2 + 8) - uVar4;
*(byte *)((longlong)&local_18 + uVar5) = (char)iVar3 - 1U | 0x80;
}
if (param_2 != (undefined *)0x0) {
*param_2 = 0x30;
memcpy(param_2 + 1,(void *)((longlong)&local_18 + uVar5),(longlong)iVar3);
}
FUN_180028070(local_10 ^ (ulonglong)auStack_38);
return;
}
=========================================
Function at address: 0x18006049c
Called functions addresses: 0x180061340 0x180041cdc 0x180011434 0x180041cb0 0x18002a7c0 0x18000404c 0x1800571a4 0x1800566dc


/* WARNING: Type propagation algorithm not settling */

uint FUN_18006049c(longlong *param_1)

{
DWORD DVar1;
undefined8 uVar2;
undefined2 uVar3;
ulonglong uVar4;
int *piVar5;
uint uVar6;
undefined8 local_res8;
undefined8 local_res10;
undefined8 local_res18;
undefined8 local_48;
longlong lStack_40;
ulonglong uVar7;

*(undefined *)((longlong)param_1 + 0x39b) = 0;
*(undefined *)((longlong)param_1 + 0x522) = 0;
if (*(int *)(param_1[10] + 0x1c) == 0) {
DVar1 = FUN_1800571a4(param_1,*(uint *)(param_1[10] + 0x9c) >> 3 & 1);
if ((DVar1 == 0) && (*(char *)((longlong)param_1 + 0x10a) != '\0')) {
local_48 = 0;
lStack_40 = 0;
local_res8._0_4_ = 0;
local_res10 = 0;
local_res18 = 0;

(&local_res8,&local_res18,&local_res10,&local_48,0);
if (uVar6 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar6;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return uVar6;
}
uVar3 = 0x38;
LAB_180060676:
FUN_180041cdc(DAT_180091000[2],uVar3,&DAT_180085810,uVar6);
return uVar6;
}
if ((int)local_res8 != 4) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar3 = 0x3b;
LAB_180060796:
FUN_180041cb0(DAT_180091000[2],uVar3,&DAT_180085810);
}
return 0;
}
if ((*(int *)((longlong)param_1 + 0x44) == 0x5b) ||
(*(int *)((longlong)param_1 + 0x44) == 0x65)) {
*(undefined *)((longlong)param_1 + 0x39b) = 1;
local_res18 = 1;
local_res10 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x39,&DAT_180085810);
}

((int)local_res8,local_res18,local_res10,&local_48,1);
if (uVar6 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar6;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return uVar6;
}
uVar3 = 0x3a;
goto LAB_180060676;
}
}
else {
FUN_180061340((longlong)param_1,0,'\0');
FUN_18000404c((longlong)param_1,0);
*(undefined *)((longlong)param_1 + 0x522) = 1;
FUN_180011434(lStack_40);
}
}
}
else {
uVar4 = 0;
if (*(short *)((longlong)param_1 + 0x542) != 0) {
do {
piVar5 = &DAT_18007d758;
uVar7 = 0;
do {
if ((*(int *)((longlong)param_1 + uVar4 * 4 + 0x544) == piVar5[1]) &&
(uVar2 = FUN_1800566dc(param_1[10],*piVar5,*(uint *)(param_1 + 8),
-(ulonglong)((*(uint *)(param_1 + 8) & 0x82800) != 0) &
(longlong)param_1 + 0x1feU,&local_res8), (int)uVar2 == 0)) {
FUN_180061340((longlong)param_1,CONCAT44(local_res8._4_4_,(int)local_res8),'\0');
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0;
}
uVar3 = 0x37;
goto LAB_180060796;
}
uVar6 = (int)uVar7 + 1;
uVar7 = (ulonglong)uVar6;
piVar5 = piVar5 + 4;
} while (uVar6 < 8);
uVar6 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar6;
} while (uVar6 < *(ushort *)((longlong)param_1 + 0x542));
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180085810);
}
return ~(*(int *)(param_1 + 0x11) << 0x15) & 0x80090320U | 0x90320;
}
=========================================
Function at address: 0x1800607b4
Called functions addresses: 0x18002a548 0x180041cb0 0x18005e558 0x18000eb08 0x18005b470 0x180061214 0x180028070 0x18005c948


void FUN_1800607b4(longlong *param_1,byte *param_2,int param_3)

{
byte bVar1;
uint uVar2;
bool bVar3;
int iVar4;
ulonglong uVar5;
undefined8 uVar6;
ushort uVar7;
undefined4 uVar8;
byte bVar9;
ulonglong uVar10;
uint uVar11;
undefined uVar12;
ushort *puVar13;
ulonglong uVar14;
undefined auStack_a8 [48];
uint local_78 [2];
ushort local_70 [20];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStack_a8;
if (param_3 == 0) {
LAB_180060997:
uVar12 = 0x32;
iVar4 = -0x7ff6fcda;
uVar8 = 400;
}
else {
bVar1 = *param_2;
if (param_3 - 1U < (uint)bVar1) goto LAB_180060997;
*(undefined2 *)((longlong)param_1 + 0x542) = 0;
uVar14 = 0;
if (bVar1 == 0) {
LAB_180060967:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x29,&DAT_180085810);
}
LAB_18006093a:
uVar12 = 0x28;
iVar4 = -0x7ff6fccf;
}
else {
do {
uVar10 = 0;
do {
uVar7 = *(ushort *)((longlong)param_1 + 0x542);
if (3 < uVar7) goto LAB_1800608a4;
uVar11 = (&DAT_1800858e8)[uVar10];
if (uVar11 == param_2[uVar14 + 1]) {
uVar2 = *(uint *)(param_1[10] + 0xc4);
if (uVar2 != 0) {
uVar5 = FUN_18005c948(*(uint **)(param_1[10] + 200),uVar2,uVar11,0);
if ((char)uVar5 != '\0') goto LAB_180060890;
uVar7 = *(ushort *)((longlong)param_1 + 0x542);
uVar11 = (&DAT_1800858e8)[uVar10];
}
*(uint *)((longlong)param_1 + (ulonglong)uVar7 * 4 + 0x544) = uVar11;
*(short *)((longlong)param_1 + 0x542) = *(short *)((longlong)param_1 + 0x542) + 1;
}
LAB_180060890:
bVar9 = (char)uVar10 + 1;
uVar10 = (ulonglong)bVar9;
} while (bVar9 < 3);
uVar7 = *(ushort *)((longlong)param_1 + 0x542);
LAB_1800608a4:
bVar9 = (char)uVar14 + 1;
uVar14 = (ulonglong)bVar9;
} while (bVar9 < bVar1);
if (uVar7 == 0) goto LAB_180060967;
puVar13 = (ushort *)(param_2 + (ulonglong)bVar1 + 1);
uVar11 = (param_3 - 1U) - (uint)bVar1;
if ((*(uint *)(param_1 + 8) & 0x80800) == 0) {
LAB_180060957:
FUN_180061214(param_1,(undefined *)puVar13,uVar11);
goto LAB_1800609ae;
}
local_70[0] = 0;
local_70[0x11] = 0;
local_78[0] = 0;
local_70[1] = 0;
local_70[2] = 0;
local_70[3] = 0;
local_70[4] = 0;
local_70[5] = 0;
local_70[6] = 0;
local_70[7] = 0;
local_70[8] = 0;
local_70[9] = 0;
local_70[10] = 0;
local_70[0xb] = 0;
local_70[0xc] = 0;
local_70[0xd] = 0;
local_70[0xe] = 0;
local_70[0xf] = 0;
local_70[0x10] = 0;
uVar6 = FUN_18005e558(local_70,puVar13,uVar11,(int *)local_78);
iVar4 = (int)uVar6;
if (iVar4 == 0) {
FUN_18000eb08((ushort *)((longlong)param_1 + 0x1fe),(ushort *)((longlong)param_1 + 0x1da));
bVar3 = FUN_18002a548((ushort *)((longlong)param_1 + 0x1fe),(longlong)local_70,
*(uint *)(param_1 + 8));
if (bVar3) {
puVar13 = (ushort *)((longlong)puVar13 + (ulonglong)local_78[0]);
uVar11 = uVar11 - local_78[0];
goto LAB_180060957;
}
goto LAB_18006093a;
}
uVar12 = 0x2f;
}
uVar8 = 0x192;
}
FUN_18005b470(param_1,uVar8,iVar4,uVar12);
LAB_1800609ae:
FUN_180028070(local_48 ^ (ulonglong)auStack_a8);
return;
}
=========================================
Function at address: 0x1800609dc
Called functions addresses: 0x180041cb0 0x18005b470 0x18002a77b


undefined8 FUN_1800609dc(longlong *param_1,char *param_2,uint param_3)

{
byte bVar1;
undefined uVar2;

if ((*(uint *)(param_1[10] + 0x98) & 0xa0000) == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x32,&DAT_180085810);
}
uVar2 = 10;
}
else {
if ((((2 < param_3) && (*param_2 == -2)) && (CONCAT11(*param_2,param_2[1]) < 0xff00)) &&
(bVar1 = param_2[2], bVar1 + 3 <= param_3)) {
*(byte *)(param_1 + 0xa4) = bVar1;
*(undefined4 *)((longlong)param_1 + 0x51c) = 1;
if (bVar1 != 0) {
memcpy((void *)((longlong)param_1 + 0x41c),param_2 + 3,(ulonglong)bVar1);
}
return 0;
}
uVar2 = 0x32;
}
FUN_18005b470(param_1,0x5a,0x80090326,uVar2);
return 0x80090326;
}
=========================================
Function at address: 0x180060aac
Called functions addresses: 0x180060408 0x18002a77b


undefined8 FUN_180060aac(char *param_1,uint param_2,char *param_3,int *param_4)

{
char cVar1;
uint uVar2;
int iVar3;
uint uVar4;
char *_Src;

iVar3 = 0;
if (param_2 != 0) {
do {
if (param_2 < 2) {
return 0x80090326;
}
cVar1 = *param_1;
_Src = param_1 + 2;
uVar4 = (uint)CONCAT11(cVar1,param_1[1]);
if (param_2 - 2 < uVar4) {
return 0x80090326;
}
if (param_3 != (char *)0x0) {
param_3[1] = param_1[1];
*param_3 = cVar1;
param_3 = param_3 + 2;
}
iVar3 = iVar3 + 2;
if (*_Src != '0') {
uVar2 = FUN_180060408(uVar4,param_3);
if (param_3 != (char *)0x0) {
param_3 = param_3 + uVar2;
}
iVar3 = iVar3 + uVar2;
}
if (param_3 != (char *)0x0) {
memcpy(param_3,_Src,(ulonglong)uVar4);
param_3 = param_3 + uVar4;
}
iVar3 = iVar3 + uVar4;
param_1 = _Src + uVar4;
param_2 = (param_2 - 2) - uVar4;
} while (param_2 != 0);
}
*param_4 = iVar3;
return 0;
}
=========================================
Function at address: 0x180060b8c
Called functions addresses: 0x18004ffb0 0x1800051c0 0x180061888 0x180028a7c 0x18005e624 0x180012184 0xEXTERNAL:0000011f 0x180028070 0x18002a77b 0x180041d70 0x18005b6e8 0x18005e400 0x18002a548 0x180041cb0 0x18002a7c0 0x180029f58 0xEXTERNAL:000000c2 0x18005b470 0xEXTERNAL:000000c0


void FUN_180060b8c(longlong *param_1,ushort *param_2,uint *param_3)

{
int iVar1;
ushort uVar2;
DWORD DVar3;
longlong lVar4;
ushort *puVar5;
ushort *puVar6;
longlong lVar7;
char cVar8;
uint uVar9;
longlong *plVar10;
undefined8 uVar11;
undefined4 uVar12;
ulonglong uVar13;
wchar_t *pwVar14;
uint *puVar15;
undefined uVar16;
wchar_t *pwVar17;
uint uVar18;
ulonglong uVar19;
undefined auStackY_138 [32];
uint local_c8;
DWORD local_c4;
uint local_c0;
undefined4 local_bc;
uint local_b8 [2];
wchar_t *local_b0;
LPCWSTR local_a8;
uint *local_a0;
longlong local_98;
BYTE local_88 [64];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_138;
pwVar17 = (wchar_t *)0x0;
local_c4 = 0;
local_c8 = 0;
local_98 = *(longlong *)(param_1[10] + 0x2f0);
local_bc = 0x8004;
local_b0 = (wchar_t *)0x0;
local_a8 = (LPCWSTR)0x0;
puVar15 = param_3;
local_a0 = param_3;

local_c0 = 0;
if (*(longlong *)(lVar4 + 0x1b0) == 0) {
if (*(longlong *)(lVar4 + 0x20) == 0) {
uVar13 = 0x44;
}
else {
uVar13 = (ulonglong)
(*(int *)(*(longlong *)(*(longlong *)(lVar4 + 0x20) + 0x18) + 0x78) + 0x34);
}
}
else {
uVar9 = *(int *)(*(longlong *)(lVar4 + 0x1b0) + 8) + 2;
uVar18 = 0x76;
if (0x76 < uVar9) {
uVar18 = uVar9;
}
uVar13 = (ulonglong)uVar18;
}
uVar19 = (ulonglong)((int)uVar13 + 2);
if ((*(uint *)(param_1 + 8) & 0x80800) == 0) {
uVar19 = uVar13;
}
uVar18 = (uint)uVar19;
if (param_2 == (ushort *)0x0) {
*param_3 = uVar18;
goto LAB_180061106;
}
if ((param_1[0x75] == 0) || (*(char *)(param_1 + 0x81) != '\0')) {
iVar1 = *(int *)(lVar4 + 0x84);
if (iVar1 == 0x2200) {
pwVar14 = L"DSA";
LAB_180060d2d:
local_c8 = 0x14;
local_b0 = pwVar14;
}
else {
if (iVar1 == 0x2203) {
pwVar14 = L"ECDSA";
goto LAB_180060d2d;
}
if ((iVar1 == 0x2400) || (pwVar14 = pwVar17, iVar1 == 0xa400)) {
pwVar14 = L"RSA";
local_bc = 0x8008;
local_c8 = 0x24;
local_c0 = 2;
local_b0 = pwVar14;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar15 = (uint *)&DAT_180085810;
uVar13 = 0x2f;
FUN_180041d70(DAT_180091000[2],0x2f,&DAT_180085810,pwVar14);
}
if ((*(uint *)(param_1 + 8) & 0x80800) == 0) {
lVar7 = param_1[0x4a];
LAB_180060ea1:
RtlAcquireResourceShared(param_1[0xa5] + 0x48,1);
uVar11 = 0;
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
uVar11 = *(undefined8 *)param_1[1];
}
DVar3 = SslComputeClientAuthHash(uVar11,*(undefined8 *)(param_1[0xa5] + 0x10),lVar7,local_b0);
RtlReleaseResource(param_1[0xa5] + 0x48);
if (DVar3 == 0) {
cVar8 = *(char *)(param_1 + 0x81);
local_c4 = (uVar18 - (int)pwVar17) - 2;
if (cVar8 != '\0') {
if (local_c4 < *(uint *)(param_1 + 0x76)) goto LAB_180060f5e;
memcpy((BYTE *)((longlong)(param_2 + 1) + (longlong)pwVar17),(void *)param_1[0x75],
(ulonglong)*(uint *)(param_1 + 0x76));
cVar8 = *(char *)(param_1 + 0x81);
}
uVar12 = local_bc;
DVar3 = FUN_180061888((ulonglong)param_1,lVar4,local_98,local_bc,local_c0,local_b0,local_a8,
local_88,local_c8,
(BYTE *)((longlong)(param_2 + 1) + (longlong)pwVar17),&local_c4,cVar8,
*(DWORD *)(param_1 + 0x76));
if ((DVar3 == 0xc0000290) || (DVar3 == 0x80090022)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x30,&DAT_180085810);
}
if ((*(uint *)(param_1 + 8) & 0x80800) == 0) {
*(undefined4 *)(param_2 + 2) = uVar12;
param_2[0] = 0x44;
param_2[1] = 0;
*(uint *)(param_2 + 4) = local_c8;
memcpy(param_2 + 6,local_88,(ulonglong)local_c8);
uVar11 = *(undefined8 *)(lVar4 + 0x30);
*(undefined8 *)(param_2 + 0x18) = *(undefined8 *)(lVar4 + 0x28);
*(undefined8 *)(param_2 + 0x1c) = uVar11;
*(undefined4 *)(param_2 + 0x20) = *(undefined4 *)(lVar4 + 0x38);
*local_a0 = 0x44;
}
else {
FUN_180012184((longlong)param_1,0x12f,-0x7ff6fcf3);
}
goto LAB_180061106;
}
if (DVar3 == 0x90312) {
if (*(char *)((longlong)param_1 + 0x10a) != '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x31,&DAT_180085810);
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4d;
goto LAB_180061106;
}
}
else {
uVar18 = local_c4;
if (DVar3 == 0) goto LAB_18006105a;
}
uVar16 = 0x50;
uVar12 = 0x12d;
}
else {
uVar16 = 0x50;
uVar12 = 300;
}
}
else {
local_b8[0] = FUN_18004ffb0(*(int *)(lVar4 + 0x84),uVar13,puVar15);
puVar6 = (ushort *)((longlong)param_1 + 0x1fe);
if (*(longlong *)(lVar4 + 0x70) != 0) {
puVar5 = (ushort *)FUN_180029f58(0x24);
puVar6 = (ushort *)0x0;
if (puVar5 != (ushort *)0x0) {
puVar5[1] = 0;
puVar5[2] = 0;
puVar5[3] = 0;
puVar5[4] = 0;
puVar5[5] = 0;
puVar5[6] = 0;
puVar5[7] = 0;
puVar5[8] = 0;
puVar5[9] = 0;
puVar5[10] = 0;
puVar5[0xb] = 0;
puVar5[0xc] = 0;
puVar5[0xd] = 0;
puVar5[0xe] = 0;
puVar5[0xf] = 0;
puVar5[0x10] = 0;
*puVar5 = 0;
puVar5[0x11] = 0;
puVar6 = puVar5;
}
FUN_18005e624(puVar6);
FUN_18002a548(puVar6,(longlong)param_1 + 0x1fe,*(uint *)(param_1 + 8));
}
uVar2 = FUN_18005e400((longlong)puVar6,local_b8[0],*(uint *)(lVar4 + 0x1ac),
*(uint *)(param_1 + 8),0);
uVar2 = uVar2 >> 8 | uVar2 << 8;
if ((*(longlong *)(lVar4 + 0x70) != 0) && (puVar6 != (ushort *)0x0)) {
_o_free(puVar6);
}
if (uVar2 == 0) {
uVar16 = 0x28;
DVar3 = 0x80090331;
uVar12 = 0x130;
}
else {
FUN_1800051c0(uVar2,(undefined4 *)0x0,local_b8,&local_bc,&local_a8,&local_c8,&local_c0);
plVar10 = param_1;
lVar7 = FUN_18005b6e8((longlong)param_1,local_b8[0]);
if ((lVar7 != 0) && (1 < uVar18)) {
*param_2 = uVar2;
pwVar17 = (wchar_t *)0x2;
goto LAB_180060ea1;
}
uVar16 = 0x50;
DVar3 = 0x54f;
uVar12 = 0x130;
param_1 = plVar10;
}
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2e,&DAT_180085810);
}
local_c4 = uVar18 - 2;
if (*(uint *)(param_1 + 0x76) <= local_c4) {
memcpy(param_2 + 1,(void *)param_1[0x75],(ulonglong)*(uint *)(param_1 + 0x76));
uVar18 = *(uint *)(param_1 + 0x76);
LAB_18006105a:
*(char *)((longlong)pwVar17 + (longlong)param_2) = (char)(uVar18 >> 8);
*(char *)((ulonglong)((int)pwVar17 + 1) + (longlong)param_2) = (char)uVar18;
*local_a0 = uVar18 + 2 + (int)pwVar17;
goto LAB_180061106;
}
LAB_180060f5e:
uVar16 = 0x50;
DVar3 = 0x80090326;
uVar12 = 0x12e;
}
FUN_18005b470(param_1,uVar12,DVar3,uVar16);
LAB_180061106:
FUN_180028070(local_48 ^ (ulonglong)auStackY_138);
return;
}
=========================================
Function at address: 0x180061134
Called functions addresses: 0x18005b470 0x180041d20 0xEXTERNAL:00000075


ulonglong FUN_180061134(longlong *param_1)

{
ulonglong in_RAX;
undefined8 *puVar1;
undefined1 in_DL;
char *pcVar2;

if ((*(uint *)(param_1 + 8) & 0x2000) == 0) {
pcVar2 = "DOWNGRD\x01S";
if ((*(uint *)(param_1 + 8) & 0x80800) == 0) {
pcVar2 = "DOWNGRD";
}
in_RAX = RtlCompareMemory(param_1 + 0x29,pcVar2,8);
if (in_RAX == 8) {
FUN_18005b470(param_1,0x69,0x80090308,0x2f);
puVar1 = &DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
puVar1 = (undefined8 *)
FUN_180041d20(DAT_180091000[2],0x4d,&DAT_180085810,
*(undefined4 *)((longlong)param_1 + 0x24),in_DL);
}
return CONCAT71((int7)((ulonglong)puVar1 >> 8),1);
}
}
return in_RAX & 0xffffffffffffff00;
}
=========================================
Function at address: 0x1800611f0
Called functions addresses: None


undefined8 FUN_1800611f0(longlong param_1)

{
uint uVar1;
ulonglong uVar2;
undefined uVar3;

uVar3 = 1;
uVar1 = *(int *)(param_1 + 0x44) - 0x2e;
uVar2 = (ulonglong)uVar1;
if ((1 < uVar1) && (uVar1 = *(int *)(param_1 + 0x44) - 0x32, uVar2 = (ulonglong)uVar1, 2 < uVar1))
{
uVar3 = 0;
}
return CONCAT71((int7)(uVar2 >> 8),uVar3);
}
=========================================
Function at address: 0x180061214
Called functions addresses: 0x18005b470 0x180060aac 0x18000a1f4 0x18000909c


ulonglong FUN_180061214(longlong *param_1,undefined *param_2,uint param_3)

{
int iVar1;
ulonglong uVar2;
undefined *puVar3;
uint uVar4;
int local_res18 [4];

if (1 < param_3) {
if (param_2 == (undefined *)0x0) {
return 0x80090304;
}
uVar4 = param_3 - 2;
if (CONCAT11(*param_2,param_2[1]) <= uVar4) {
local_res18[0] = 0;
uVar2 = FUN_180060aac(param_2 + 2,uVar4,(char *)0x0,local_res18);
iVar1 = local_res18[0];
if ((int)uVar2 != 0) {
FUN_18005b470(param_1,0x191,(int)uVar2,0x2f);
return uVar2 & 0xffffffff;
}
puVar3 = (undefined *)FUN_18000a1f4((ulonglong)(local_res18[0] + 2));
if (puVar3 == (undefined *)0x0) {
return 0x80090300;
}
puVar3[1] = (char)iVar1;
*puVar3 = (char)((uint)iVar1 >> 8);
uVar2 = FUN_180060aac(param_2 + 2,uVar4,puVar3 + 2,local_res18);
if ((int)uVar2 != 0) {
FUN_18000909c(puVar3);
return uVar2 & 0xffffffff;
}
if ((HLOCAL)param_1[0x70] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x70]);
}
param_1[0x70] = (longlong)puVar3;
*(int *)(param_1 + 0x6f) = local_res18[0] + 2;
return 0;
}
FUN_18005b470(param_1,400,0x80090326,0x32);
}
return 0x80090326;
}
=========================================
Function at address: 0x180061340
Called functions addresses: 0x18002a7c0


void FUN_180061340(longlong param_1,undefined8 param_2,char param_3)

{
ulonglong uVar1;

uVar1 = *(ulonglong *)(param_1 + 0x88);
if (((uVar1 >> 0x13 & 1) != 0) && (*(longlong *)(param_1 + 0x3a0) != 0)) {

uVar1 = *(ulonglong *)(param_1 + 0x88) & 0xfffffffffff7ffff;
*(ulonglong *)(param_1 + 0x88) = uVar1;
}
*(undefined8 *)(param_1 + 0x3a0) = param_2;
if (param_3 != '\0') {
*(ulonglong *)(param_1 + 0x88) = uVar1 | 0x80000;
}
return;
}
=========================================
Function at address: 0x1800613d0
Called functions addresses: 0x1800705d4 0x18006fa58 0x180041cb0 0x18002a7c0 0x180070c68 0x18002a77b 0xEXTERNAL:00000075


ulonglong FUN_1800613d0(longlong *param_1,short *param_2,ushort param_3,longlong param_4,
byte param_5)

{
ushort *puVar1;
byte *pbVar2;
short sVar3;
int iVar4;
undefined4 extraout_var;
ulonglong uVar5;
void *_Dst;
undefined2 uVar6;
byte bVar7;
uint uVar8;

_Dst = (void *)0x0;
bVar7 = 0;
iVar4 = FUN_180070c68(param_2,param_3,0);
if (iVar4 != 0) {
return CONCAT44(extraout_var,iVar4);
}
puVar1 = (ushort *)param_1[100];
if (puVar1 == (ushort *)0x0) {
return 0x57;
}
if (param_4 == 0) {
if (param_5 != 0) {
return 0x57;
}
}
else if (param_5 == 0) {
return 0x57;
}
sVar3 = FUN_18006fa58((short *)(puVar1 + 1),*puVar1,param_2,param_3);
if (sVar3 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar6 = 0x46;
}
else {
if (param_5 == 0) {
LAB_180061541:
uVar5 = FUN_1800705d4(param_1,sVar3,_Dst,bVar7);
if ((int)uVar5 == 0) {
return 0;
}
if (_Dst != (void *)0x0) {

return uVar5 & 0xffffffff;
}
return uVar5 & 0xffffffff;
}
pbVar2 = (byte *)param_1[0xa7];
if (pbVar2 == (byte *)0x0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar6 = 0x47;
}
else {
bVar7 = *pbVar2;
if (param_5 == bVar7) {
uVar8 = (uint)bVar7;
uVar5 = RtlCompareMemory(param_4,pbVar2 + 1,uVar8);
if (uVar5 == bVar7) {

if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,pbVar2 + 1,(ulonglong)uVar8);
goto LAB_180061541;
}
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar6 = 0x48;
}
}
FUN_180041cb0(DAT_180091000[2],uVar6,&DAT_180085810);
return 0x80090326;
}
=========================================
Function at address: 0x1800615c8
Called functions addresses: 0x180041cb0 0x18002a7c0 0x180070690 0x18002a77b


ulonglong FUN_1800615c8(longlong *param_1,undefined param_2,undefined param_3,char *param_4,
ushort param_5)

{
undefined *puVar1;
char *pcVar2;
void *_Dst;
ulonglong uVar3;
char *pcVar4;
undefined2 uVar5;
char *pcVar6;
char *pcVar7;

uVar3 = (ulonglong)param_5;
if ((param_5 == 0) || (param_4 == (char *)0x0)) {
return 0x57;
}
puVar1 = (undefined *)param_1[0x66];
if (puVar1 == (undefined *)0x0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar5 = 0x49;
}
else {
if (CONCAT11(param_2,param_3) <= CONCAT11(*puVar1,puVar1[1])) {
if (CONCAT11(param_2,param_3) < CONCAT11(*puVar1,puVar1[1])) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x4b,&DAT_180085810);
}
return 0;
}
pcVar4 = puVar1 + (ulonglong)*(ushort *)(puVar1 + 2) + 4;
if (param_4 < param_4 + uVar3) {
pcVar6 = puVar1 + 4;
pcVar7 = param_4;
do {
pcVar2 = pcVar6;
if (pcVar6 < pcVar4) {
do {
if (*pcVar7 == *pcVar2) goto LAB_1800616fa;
pcVar2 = pcVar2 + 1;
} while (pcVar2 < pcVar4);
}
if (pcVar2 == pcVar4) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar5 = 0x4c;
goto LAB_18006174d;
}
LAB_1800616fa:
pcVar7 = pcVar7 + 1;
} while (pcVar7 < param_4 + uVar3);
}

if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,param_4,uVar3);
uVar3 = FUN_180070690(param_1,param_2,param_3,_Dst,param_5);
if ((int)uVar3 != 0) {

return uVar3 & 0xffffffff;
}
return uVar3 & 0xffffffff;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar5 = 0x4a;
}
LAB_18006174d:
FUN_180041cb0(DAT_180091000[2],uVar5,&DAT_180085810);
return 0x80090326;
}
=========================================
Function at address: 0x1800617e0
Called functions addresses: 0x18002a7c0 0x18002a77b


undefined4 FUN_1800617e0(longlong *param_1,byte *param_2)

{
byte bVar1;
void *_Dst;

_Dst = (void *)0x0;
if (param_2 != (byte *)0x0) {
bVar1 = *param_2;

if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,param_2,(ulonglong)bVar1 + 1);
}
if (param_1[0xa7] != 0) {

}
param_1[0xa7] = (longlong)_Dst;
return 0;
}
=========================================
Function at address: 0x180061888
Called functions addresses: 0x180001e7c 0xEXTERNAL:0000003c 0xEXTERNAL:00000132 0x180041960 0xEXTERNAL:00000041 0x18002a77b 0x180041cdc 0xEXTERNAL:00000109 0x180041cb0 0x180001604 0xEXTERNAL:00000047 0x18000a1f4 0x18000909c


DWORD FUN_180061888(ulonglong param_1,longlong param_2,longlong param_3,undefined4 param_4,
uint param_5,wchar_t *param_6,LPCWSTR param_7,PBYTE param_8,uint param_9,
BYTE *param_10,DWORD *param_11,char param_12,DWORD param_13)

{
DWORD DVar1;
uint uVar2;
bool bVar3;
longlong lVar4;
int iVar5;
int iVar6;
DWORD DVar7;
BOOL BVar8;
LPCWSTR *_Dst;
uint uVar9;
LPCSTR lpszStructType;
LPCWSTR *ppWVar10;
uint uVar11;
bool bVar12;
ulonglong local_res8;
longlong local_res10;
longlong local_res18;
undefined4 local_res20;
LPCWSTR local_70;
LPCWSTR local_68;
LPCWSTR *ppWStack_60;
uint local_58;
undefined *local_50;

DVar7 = 0;
_Dst = (LPCWSTR *)0x0;
bVar12 = false;
DVar1 = *param_11;
local_res8 = param_1;
local_res10 = param_2;
local_res18 = param_3;
local_res20 = param_4;
iVar5 = wcsncmp(param_6,L"RSA",3);
if (iVar5 != 0) {
iVar6 = wcsncmp(param_6,L"DSA",3);
bVar12 = iVar6 == 0;
}
bVar3 = iVar5 == 0;
if (*(char *)(local_res8 + 0x10a) == '\0') {
local_70 = (LPCWSTR)0x0;
ppWVar10 = (LPCWSTR *)0x0;
local_res8 = local_res8 & 0xffffffff00000000;
local_68 = (LPCWSTR)0x0;
ppWStack_60 = (LPCWSTR *)0x0;
if (bVar3) {
if (param_5 == 8) {
ppWVar10 = &local_68;
local_68 = param_7;
ppWStack_60 = (LPCWSTR *)(ulonglong)param_9;
}
else {
if (param_5 != 2) {
return 0x54f;
}
ppWVar10 = &local_70;
local_70 = param_7;
}
}
iVar5 = FUN_180001604(local_res18,(undefined4 *)&local_res8);
if (iVar5 != 0) {
return 0x54f;
}
DVar7 = NCryptSignHash(*(NCRYPT_KEY_HANDLE *)(local_res10 + 0x68),ppWVar10,param_8,param_9,
param_10,*param_11,param_11,param_5 | 0x40);
if ((int)local_res8 != 0) {
RevertToSelf();
}
if (DVar7 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return DVar7;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cdc(DAT_180091000[2],0x2a,&DAT_180085810,DVar7);
return DVar7;
}
return DVar7;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2b,&DAT_180085810);
}
lVar4 = local_res10;
if (param_12 == '\0') {
DVar7 = FUN_180041960(*(longlong *)(local_res10 + 0x70),*(undefined8 *)(local_res8 + 0x68),
*(longlong *)(local_res10 + 0x68),*(undefined4 *)(local_res10 + 0x80),
local_res20,param_5,param_6,param_7,param_8,param_9);
if (DVar7 != 0) {
return DVar7;
}
}
else {
*param_11 = param_13;
}
if ((bVar3) && (*(longlong *)(lVar4 + 0x70) != 0)) {
FUN_180001e7c(param_10,*param_11);
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2c,&DAT_180085810,*param_11);
}
if (!bVar3) {
uVar2 = *param_11;
_Dst = (LPCWSTR *)FUN_18000a1f4((ulonglong)uVar2);
if (_Dst == (LPCWSTR *)0x0) {
return 0xe;
}
memcpy(_Dst,param_10,(ulonglong)uVar2);
uVar11 = uVar2 >> 1;
if (*(longlong *)(local_res10 + 0x70) == 0) {
uVar9 = uVar11;
FUN_180001e7c((undefined *)_Dst,uVar11);
FUN_180001e7c((undefined *)((ulonglong)(uVar2 >> 1) + (longlong)_Dst),uVar9);
}
*param_11 = DVar1;
if (bVar12) {
lpszStructType = (LPCSTR)0x28;
ppWVar10 = _Dst;
}
else {
local_50 = (undefined *)((ulonglong)(uVar2 >> 1) + (longlong)_Dst);
ppWVar10 = &local_68;
local_68 = (LPCWSTR)CONCAT44(local_68._4_4_,uVar11);
lpszStructType = (LPCSTR)0x2f;
ppWStack_60 = _Dst;
local_58 = uVar11;
}
BVar8 = CryptEncodeObject(1,lpszStructType,ppWVar10,param_10,param_11);
if (BVar8 == 0) {
DVar7 = GetLastError();
goto LAB_180061bfd;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2d,&DAT_180085810,*param_11);
}
if (_Dst == (LPCWSTR *)0x0) {
return DVar7;
}
LAB_180061bfd:
FUN_18000909c(_Dst);
return DVar7;
}
=========================================
Function at address: 0x180061c24
Called functions addresses: 0x18000a1f4 0x18000909c


undefined8
FUN_180061c24(undefined8 param_1,longlong *param_2,uint param_3,int *param_4,undefined8 *param_5)

{
undefined8 uVar1;
wchar_t *pwVar2;
undefined8 *puVar3;
HLOCAL pvVar4;
int *piVar5;
longlong lVar6;
wchar_t *pwVar7;
uint uVar8;
ulonglong uVar10;
int iVar11;
ulonglong uVar12;
uint uVar13;
undefined8 *puVar15;
ulonglong uVar16;
ulonglong uVar9;
ulonglong uVar14;

uVar10 = 0;
if ((param_4 == (int *)0x0) || (param_5 == (undefined8 *)0x0)) {
return 0xc000000d;
}
*param_5 = 0;
*param_4 = 0;
pvVar4 = (HLOCAL)FUN_18000a1f4(0x924);
if (pvVar4 == (HLOCAL)0x0) {
return 0xe;
}
uVar12 = uVar10;
uVar16 = uVar10;
if (param_3 != 0) {
LAB_180061c97:
piVar5 = &DAT_18008018c;
uVar14 = uVar10;
do {
if (*(int *)(*param_2 + 0x2a4) == *piVar5) {
uVar13 = (uint)uVar12;
if (uVar13 == 0) goto LAB_180061cf7;
uVar9 = uVar10;
goto LAB_180061cda;
}
uVar13 = (int)uVar14 + 1;
uVar14 = (ulonglong)uVar13;
piVar5 = piVar5 + 0xc6;
} while (uVar13 < 3);
goto LAB_180061d83;
}
LAB_180061da4:
FUN_18000909c(pvVar4);
return 0;
while (uVar8 = (int)uVar9 + 1, uVar9 = (ulonglong)uVar8, uVar8 < uVar13) {
LAB_180061cda:
if ((&DAT_18008018c)[uVar14 * 0xc6] == *(int *)(uVar9 * 0x30c + 0x304 + (longlong)pvVar4))
goto LAB_180061d83;
}
LAB_180061cf7:
lVar6 = 6;
pwVar2 = L"nistP256" + uVar14 * 0x18c;
puVar3 = (undefined8 *)(uVar12 * 0x30c + (longlong)pvVar4);
do {
puVar15 = puVar3;
pwVar7 = pwVar2;
uVar1 = *(undefined8 *)(pwVar7 + 4);
*puVar15 = *(undefined8 *)pwVar7;
puVar15[1] = uVar1;
uVar1 = *(undefined8 *)(pwVar7 + 0xc);
puVar15[2] = *(undefined8 *)(pwVar7 + 8);
puVar15[3] = uVar1;
uVar1 = *(undefined8 *)(pwVar7 + 0x14);
puVar15[4] = *(undefined8 *)(pwVar7 + 0x10);
puVar15[5] = uVar1;
uVar1 = *(undefined8 *)(pwVar7 + 0x1c);
puVar15[6] = *(undefined8 *)(pwVar7 + 0x18);
puVar15[7] = uVar1;
uVar1 = *(undefined8 *)(pwVar7 + 0x24);
puVar15[8] = *(undefined8 *)(pwVar7 + 0x20);
puVar15[9] = uVar1;
uVar1 = *(undefined8 *)(pwVar7 + 0x2c);
puVar15[10] = *(undefined8 *)(pwVar7 + 0x28);
puVar15[0xb] = uVar1;
uVar1 = *(undefined8 *)(pwVar7 + 0x34);
puVar15[0xc] = *(undefined8 *)(pwVar7 + 0x30);
puVar15[0xd] = uVar1;
uVar1 = *(undefined8 *)(pwVar7 + 0x3c);
puVar15[0xe] = *(undefined8 *)(pwVar7 + 0x38);
puVar15[0xf] = uVar1;
lVar6 = lVar6 + -1;
pwVar2 = pwVar7 + 0x40;
puVar3 = puVar15 + 0x10;
} while (lVar6 != 0);
uVar12 = (ulonglong)(uVar13 + 1);
puVar15[0x10] = *(undefined8 *)(pwVar7 + 0x40);
*(undefined4 *)(puVar15 + 0x11) = *(undefined4 *)(pwVar7 + 0x44);
LAB_180061d83:
iVar11 = (int)uVar12;
if (iVar11 == 3) goto LAB_180061d9c;
uVar13 = (int)uVar16 + 1;
param_2 = param_2 + 2;
uVar16 = (ulonglong)uVar13;
if (param_3 <= uVar13) goto code_r0x000180061d98;
goto LAB_180061c97;
code_r0x000180061d98:
if (iVar11 != 0) {
LAB_180061d9c:
*param_5 = pvVar4;
*param_4 = iVar11;
return 0;
}
goto LAB_180061da4;
}
=========================================
Function at address: 0x180061ddc
Called functions addresses: 0x180061e5c 0xEXTERNAL:000000c2 0xEXTERNAL:000000c0


ulonglong FUN_180061ddc(undefined8 param_1,int param_2,undefined4 *param_3)

{
ulonglong uVar1;
undefined4 in_register_00000014;

if ((param_2 == 0) || (param_3 == (undefined4 *)0x0)) {
uVar1 = 0x57;
}
else if (DAT_1800925c8 == (longlong *)0x0) {
uVar1 = 0x54f;
}
else {
RtlAcquireResourceShared
(&DAT_180092428,CONCAT71((int7)(CONCAT44(in_register_00000014,param_2) >> 8),1));
uVar1 = FUN_180061e5c(DAT_1800925c8,param_2,param_3);
uVar1 = uVar1 & 0xffffffff;
RtlReleaseResource(&DAT_180092428);
}
return uVar1;
}
=========================================
Function at address: 0x180061e5c
Called functions addresses: None


undefined8 FUN_180061e5c(longlong *param_1,int param_2,undefined4 *param_3)

{
ulonglong uVar1;
ulonglong uVar2;
ulonglong *puVar3;
ulonglong *puVar4;

puVar3 = (ulonglong *)*param_1;
puVar4 = puVar3 + (ulonglong)*(uint *)(param_1 + 1) * 4;
do {
if (puVar4 <= puVar3) {
return 0x490;
}
uVar1 = *puVar3;
uVar2 = (ulonglong)*(uint *)(puVar3 + 1) * 0x30c + uVar1;
for (; uVar1 < uVar2; uVar1 = uVar1 + 0x30c) {
if (*(int *)(uVar1 + 0x304) == param_2) {
*param_3 = *(undefined4 *)(uVar1 + 0x308);
return 0;
}
}
puVar3 = puVar3 + 4;
} while( true );
}
=========================================
Function at address: 0x180061ebc
Called functions addresses: None


undefined4 FUN_180061ebc(longlong param_1,uint *param_2)

{
int iVar1;
int *piVar2;
ulonglong uVar3;
undefined4 uVar4;
uint uVar5;
ulonglong uVar6;
uint uVar7;

uVar4 = 0;
uVar5 = 0;
if ((param_1 == 0) || (param_2 == (uint *)0x0)) {
uVar4 = 0xc000000d;
}
else {
uVar6 = 0;
if (*param_2 != 0) {
do {
uVar7 = 0;
iVar1 = *(int *)(param_1 + uVar6 * 4);
piVar2 = &DAT_180085820;
do {
if (iVar1 == *piVar2) {
uVar3 = (ulonglong)uVar5;
uVar5 = uVar5 + 1;
*(int *)(param_1 + uVar3 * 4) = iVar1;
break;
}
uVar7 = uVar7 + 1;
piVar2 = piVar2 + 1;
} while (uVar7 < 3);
} while ((uVar5 != 3) && (uVar7 = (int)uVar6 + 1, uVar6 = (ulonglong)uVar7, uVar7 < *param_2))
;
}
*param_2 = uVar5;
}
return uVar4;
}
=========================================
Function at address: 0x180061f30
Called functions addresses: 0x18000a1f4 0x180028d30


undefined4 FUN_180061f30(uint *param_1,longlong *param_2,uint *param_3)

{
longlong lVar1;
int iVar2;
longlong lVar3;
ulonglong uVar4;
undefined4 uVar5;
ulonglong uVar6;
uint uVar7;
ulonglong uVar8;
uint uVar9;
undefined **ppuVar10;

uVar5 = 0;
uVar9 = 0;
if ((param_2 == (longlong *)0x0) || (param_3 == (uint *)0x0)) {
uVar5 = 0xc000000d;
}
else {
lVar3 = FUN_18000a1f4(0xc);
if (lVar3 == 0) {
uVar5 = 0xc000009a;
}
else {
uVar6 = 0;
if (*param_1 != 0) {
LAB_180061f8e:
lVar1 = *(longlong *)(*(longlong *)(param_1 + 2) + uVar6 * 8);
uVar4 = 0xffffffffffffffff;
do {
uVar4 = uVar4 + 1;
} while (*(short *)(lVar1 + uVar4 * 2) != 0);
if (4 < (uint)uVar4) {
uVar8 = 0;
ppuVar10 = &PTR_u__P256_18007fe80;
do {
iVar2 = _o__wcsicmp(lVar1 + ((uVar4 & 0xffffffff) - 5) * 2,*ppuVar10);
if (iVar2 == 0) {
uVar7 = 0;
if (uVar9 == 0) goto LAB_18006202e;
goto LAB_180062020;
}
uVar7 = (int)uVar8 + 1;
uVar8 = (ulonglong)uVar7;
ppuVar10 = ppuVar10 + 99;
} while (uVar7 < 3);
goto LAB_180061fe7;
}
goto LAB_180061fec;
}
LAB_180061ff4:
*param_3 = uVar9;
*param_2 = lVar3;
}
}
return uVar5;
while (uVar7 = uVar7 + 1, uVar7 < uVar9) {
LAB_180062020:
if (*(int *)(lVar3 + (ulonglong)uVar7 * 4) == (&DAT_18008018c)[uVar8 * 0xc6])
goto LAB_180061fe7;
}
LAB_18006202e:
uVar4 = (ulonglong)uVar9;
uVar9 = uVar9 + 1;
*(undefined4 *)(lVar3 + uVar4 * 4) = (&DAT_18008018c)[uVar8 * 0xc6];
LAB_180061fe7:
if (uVar9 == 3) goto LAB_180061ff4;
LAB_180061fec:
uVar7 = (int)uVar6 + 1;
uVar6 = (ulonglong)uVar7;
if (*param_1 <= uVar7) goto LAB_180061ff4;
goto LAB_180061f8e;
}
=========================================
Function at address: 0x180062074
Called functions addresses: 0xEXTERNAL:0000004f 0xEXTERNAL:0000004b 0xEXTERNAL:0000004d


undefined8 FUN_180062074(void)

{
LSTATUS LVar1;
undefined8 uVar2;
DWORD local_res8 [2];
DWORD local_res10 [2];
HKEY local_res18 [2];

local_res18[0] = (HKEY)0x0;
uVar2 = 0;
LVar1 = RegOpenKeyExW((HKEY)0xffffffff80000002,
L"Software\\Policies\\Microsoft\\Cryptography\\Configuration\\SSL\\00010002"
,0,0x20119,local_res18);
if (LVar1 == 0) {
LVar1 = RegQueryValueExW(local_res18[0],L"EccCurves",(LPDWORD)0x0,local_res8,(LPBYTE)0x0,
local_res10);
if ((LVar1 != 0) || (local_res8[0] != 7)) goto LAB_1800620f2;
}
uVar2 = 1;
LAB_1800620f2:
if (local_res18[0] != (HKEY)0x0) {
RegCloseKey(local_res18[0]);
}
return uVar2;
}
=========================================
Function at address: 0x180062118
Called functions addresses: 0x18005bcb0 0x1800051c0 0x180005298 0x180041cb0 0xEXTERNAL:000000c2 0x18005b470 0xEXTERNAL:000000c0 0xEXTERNAL:00000139


undefined8 FUN_180062118(longlong *param_1,ushort *param_2,uint param_3)

{
ushort uVar1;
DWORD DVar2;
ulonglong uVar3;
undefined8 uVar4;
undefined8 uVar5;
undefined4 uVar6;
wchar_t *pwVar7;
uint uVar8;
int iVar9;
undefined uVar10;
undefined4 *puVar11;
ULONG UVar12;
ULONG local_res8 [2];
uint local_res20 [2];
undefined4 local_58;
uint local_54;
wchar_t *local_50;
undefined8 local_48 [2];

local_48[0] = 0;
UVar12 = 0;
local_58 = 0;
local_res8[0] = 0;
local_res20[0] = 0;
if ((param_1[0xb] == 0) || (*(longlong *)(param_1[0xb] + 0x30) == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1e,&DAT_180082bd8);
}
uVar10 = 0x28;
uVar6 = 0x514;
LAB_1800623fd:
FUN_18005b470(param_1,uVar6,0x80090326,uVar10);
uVar5 = 0x54f;
}
else {
uVar8 = 3;
if (*(longlong **)(param_1[0x7c] + 0x28) == (longlong *)0x0) {
iVar9 = 0x2203;
LAB_1800621d1:
local_50 = L"ECDSA";
}
else {
iVar9 = *(int *)(**(longlong **)(param_1[0x7c] + 0x28) + 4);
if (iVar9 == 0x2200) {
uVar8 = 2;
local_50 = L"DSA";
}
else {
if (iVar9 == 0x2203) goto LAB_1800621d1;
if ((iVar9 != 0x2400) && (iVar9 != 0xa400)) {
uVar10 = 0x2b;
uVar6 = 0x516;
goto LAB_1800623fd;
}
uVar8 = 1;
local_50 = L"RSA";
UVar12 = 2;
local_res8[0] = 2;
}
}
if ((*(uint *)(param_1 + 8) & 0x40400) == 0) {
LAB_1800622b2:
uVar5 = local_48[0];
if (1 < param_3) {
uVar8 = (uint)*(byte *)param_2 * 0x100 + (uint)*(byte *)((longlong)param_2 + 1);
if (uVar8 + 2 <= param_3) {
uVar4 = FUN_18005bcb0(param_1,local_50,local_48[0],local_58,local_res20[0],UVar12,
(BYTE *)(param_2 + 1),uVar8);
if ((int)uVar4 == 0) {
return uVar4;
}
if (iVar9 != 0x2203) {
return uVar4;
}
RtlAcquireResourceShared(param_1[0xb] + 0x48,1);
DVar2 = CertGetPublicKeyLength
(**(DWORD **)(param_1[0xb] + 0x30),
(PCERT_PUBLIC_KEY_INFO)
(*(longlong *)(*(DWORD **)(param_1[0xb] + 0x30) + 6) + 0x60));
RtlReleaseResource(param_1[0xb] + 0x48);
if (DVar2 == 0x100) {
pwVar7 = L"ECDSA_P256";
LAB_180062397:
uVar5 = FUN_18005bcb0(param_1,pwVar7,uVar5,local_58,local_res20[0],UVar12,
(BYTE *)(param_2 + 1),uVar8);
return uVar5;
}
if (DVar2 == 0x180) {
pwVar7 = L"ECDSA_P384";
goto LAB_180062397;
}
if (DVar2 == 0x209) {
pwVar7 = L"ECDSA_P521";
goto LAB_180062397;
}
uVar10 = 0x2b;
uVar6 = 0x515;
goto LAB_1800623fd;
}
}
uVar6 = 0x514;
}
else {
if (1 < param_3) {
uVar1 = *param_2;
puVar11 = (undefined4 *)0x0;
uVar3 = FUN_180005298((longlong)param_1 + 0x1da,uVar1,*(uint *)(param_1 + 8),0);
if ((char)uVar3 == '\0') {
uVar10 = 0x2f;
uVar6 = 0x80090308;
LAB_180062245:
FUN_18005b470(param_1,0x51b,uVar6,uVar10);
return 0x80090331;
}
local_54 = local_54 & (uint)puVar11;
FUN_1800051c0(uVar1,&local_54,&local_58,puVar11,local_48,local_res20,local_res8);
param_2 = param_2 + 1;
param_3 = param_3 - 2;
UVar12 = local_res8[0];
if (local_54 != uVar8) {
uVar10 = 0x28;
uVar6 = 0x80090331;
goto LAB_180062245;
}
goto LAB_1800622b2;
}
uVar6 = 0x51b;
}
FUN_18005b470(param_1,uVar6,0x80090326,0x32);
uVar5 = 0x80090326;
}
return uVar5;
}
=========================================
Function at address: 0x180062430
Called functions addresses: 0x1800592e8 0x18000629c 0x180028070 0x180006300 0x18002a77b 0x18001b0b0 0x180076ca8 0x180041cb0 0x180028d90 0x18002a7c0 0x18000a1d0 0x18005b470 0x18000eb9c 0x18000909c


void FUN_180062430(longlong *param_1,longlong param_2,undefined8 param_3)

{
HLOCAL pvVar1;
int iVar2;
undefined8 uVar3;
void *_Dst;
uint *puVar4;
longlong lVar5;
undefined4 uVar6;
uint uVar7;
undefined uVar8;
undefined auStackY_a8 [32];
int local_78 [2];
HLOCAL local_70;
uint local_68;
uint local_64;
longlong local_60;
uint local_58 [8];
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_a8;
local_70 = (HLOCAL)0x0;
local_78[0] = 0;
local_58[0] = 0;
local_58[1] = 0;
local_58[2] = 0;
local_58[3] = 0;
local_58[4] = 0;
local_58[5] = 0;
local_58[6] = 0;
local_58[7] = 0;
uVar7 = (uint)param_3;
if (uVar7 < 2) {
FUN_18005b470(param_1,0x4b3,0x80090326,0x32);
goto LAB_18006266d;
}
local_68 = uVar7;
local_64 = uVar7;
local_60 = param_2;
uVar3 = FUN_180076ca8((longlong)&local_68,&local_70,param_3,local_78);
pvVar1 = local_70;
iVar2 = (int)uVar3;
if (iVar2 == 0) {
if (local_78[0] == 0) {
if (DAT_1800919ac == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x31,&DAT_180082bd8);
}
FUN_18005b470(param_1,0x4b7,0x80090346,0x28);
*(undefined4 *)((longlong)param_1 + 0x44) = 0x60;
*(undefined2 *)(param_1 + 0xc) = 0x2802;
goto LAB_18006266d;
}
}
else {
*(undefined *)((longlong)param_1 + 0x229) = 1;
}
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(uint *)(param_1 + 0x6d) = local_64 - 2;
_Dst = (void *)FUN_18000a1d0((longlong)param_1,local_64 - 2);
param_1[0x6e] = (longlong)_Dst;
if (_Dst != (void *)0x0) {
memcpy(_Dst,(void *)(local_60 + 2),(ulonglong)*(uint *)(param_1 + 0x6d));
memset(param_1 + 0x22,0,(ulonglong)(0x20 - *(int *)((longlong)pvVar1 + 0xc)));
memcpy((void *)((longlong)param_1 + (0x130 - (ulonglong)*(uint *)((longlong)pvVar1 + 0xc))),
(void *)((longlong)pvVar1 + 0x30),(ulonglong)*(uint *)((longlong)pvVar1 + 0xc));
puVar4 = local_58;
uVar3 = FUN_18000eb9c((PUCHAR)puVar4,0x20);
if ((int)uVar3 == 0) {
FUN_18000629c(puVar4,(byte *)0x0,local_58);
lVar5 = DAT_1800927f0;
iVar2 = FUN_1800592e8(DAT_1800927f0,*(undefined4 *)(param_1 + 8),local_58,param_1 + 0x7c);
FUN_180006300(lVar5,(byte *)0x0,local_58);
if (iVar2 == 0) {
param_1[0xb] = param_1[0x7c];
iVar2 = FUN_18001b0b0(&DAT_180092420,param_1,(uint *)((longlong)pvVar1 + 0x50),
*(uint *)((longlong)pvVar1 + 4),*(uint *)(param_1 + 8),0);
if (iVar2 != 0) {
uVar8 = 0x28;
uVar6 = 0x4b4;
goto LAB_180062655;
}
}
}
}
}
else {
uVar8 = 10;
uVar6 = 0x4b3;
LAB_180062655:
FUN_18005b470(param_1,uVar6,iVar2,uVar8);
}
if (pvVar1 != (HLOCAL)0x0) {
FUN_18000909c(pvVar1);
}
LAB_18006266d:
FUN_180028070(local_38 ^ (ulonglong)auStackY_a8);
return;
}
=========================================
Function at address: 0x180062690
Called functions addresses: 0x18000adf4 0x18002a77b


undefined8
FUN_180062690(void *param_1,uint param_2,ushort *param_3,byte *param_4,byte param_5,byte *param_6,
uint *param_7)

{
byte bVar1;
ulonglong uVar2;
byte *pbVar3;
uint uVar4;
uint uVar5;

uVar4 = 0;
uVar2 = (ulonglong)param_5;
uVar5 = param_5 + 3 + param_2;
if (param_3 != (ushort *)0x0) {
uVar5 = uVar5 + (uint)*param_3 * 2 + 2;
uVar4 = (uint)*param_3 * 2 + 2;
}
if (param_6 == (byte *)0x0) {
*param_7 = uVar5;
}
else {
if (*param_7 < uVar5) {
return 0x54f;
}
*param_6 = param_5;
pbVar3 = param_6 + 1;
if (param_5 != 0) {
do {
bVar1 = *param_4;
param_4 = param_4 + 4;
*pbVar3 = bVar1;
pbVar3 = pbVar3 + 1;
uVar2 = uVar2 - 1;
} while (uVar2 != 0);
}
if (param_3 != (ushort *)0x0) {
FUN_18000adf4(param_3,pbVar3,uVar4);
pbVar3 = pbVar3 + uVar4;
}
pbVar3[1] = (byte)param_2;
*pbVar3 = (byte)(param_2 >> 8);
if (param_1 != (void *)0x0) {
memcpy(pbVar3 + 2,param_1,(ulonglong)param_2);
}
}
return 0;
}
=========================================
Function at address: 0x180062768
Called functions addresses: 0x180009470 0x18005b470 0x18000a534 0x180009e8c


ulonglong FUN_180062768(longlong *param_1,uint *param_2)

{
char cVar1;
ushort uVar2;
ulonglong uVar3;
ulonglong uVar4;
uint uVar5;
uint uVar6;
int iVar7;
uint uVar8;
int iVar9;

cVar1 = *(char *)((longlong)param_1 + 0xe9);
iVar7 = (-(uint)(cVar1 != '\0') & 8) + 4;
if ((*(byte *)(param_1 + 4) & 4) == 0) {
uVar6 = 0;
iVar9 = iVar7;
}
else {
uVar6 = *(uint *)((longlong)param_1 + 0x2c);
uVar8 = *(int *)(param_1 + 6) + iVar7;
uVar5 = *(uint *)((longlong)param_1 + 0x34);
if (uVar5 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar5 = uVar5 - uVar8 % uVar5;
}
uVar8 = uVar8 + uVar5;
}
iVar9 = uVar8 + uVar6;
}
uVar3 = FUN_180009e8c((longlong)param_1,param_2,iVar9 + *(int *)((longlong)param_1 + 0x3c));
if ((int)uVar3 == 0) {
uVar2 = *(ushort *)((longlong)param_1 + 0xdc);
*(ushort *)((longlong)param_1 + 0xdc) = uVar2 + 1;
FUN_18000a534((undefined *)
((ulonglong)(-(uint)(cVar1 != '\0') & 8) + 5 + *(longlong *)(param_2 + 2) +
(ulonglong)uVar6),0,(void *)0x0,0,(uint)uVar2,
(uint)*(byte *)((longlong)param_1 + 0xe9));
uVar4 = FUN_180009470(param_1,param_2,0x16,iVar7);
uVar3 = uVar4 & 0xffffffff;
if ((int)uVar4 == 0) {
*(undefined *)((longlong)param_1 + 0x22b) = 1;
}
else {
FUN_18005b470(param_1,0x3b9,(int)uVar4,0x50);
}
}
return uVar3;
}
=========================================
Function at address: 0x180062884
Called functions addresses: 0x18000a534 0x18002a77b


void FUN_180062884(longlong param_1,void *param_2,uint param_3,undefined *param_4,int *param_5)

{
byte bVar1;
ushort uVar2;
undefined uVar3;
undefined uVar4;
undefined *_Dst;
undefined uVar5;
uint uVar6;
int iVar7;

bVar1 = *(byte *)(param_1 + 0xe9);
iVar7 = (-(uint)(bVar1 != 0) & 8) + param_3 + 10;
uVar2 = *(ushort *)(param_1 + 0xdc);
uVar6 = DAT_1800919c8 / 1000;
*(ushort *)(param_1 + 0xdc) = uVar2 + 1;
FUN_18000a534(param_4,4,(void *)0x0,iVar7 - ((-(uint)(bVar1 != 0) & 8) + 4),(uint)uVar2,
(uint)bVar1);
uVar3 = (undefined)(param_3 >> 8);
uVar4 = (undefined)(uVar6 >> 0x10);
uVar5 = (undefined)(uVar6 >> 8);
if (*(char *)(param_1 + 0xe9) == '\0') {
param_4[5] = uVar4;
_Dst = param_4 + 10;
param_4[4] = 0;
param_4[6] = uVar5;
param_4[7] = (char)uVar6;
param_4[8] = uVar3;
param_4[9] = (char)param_3;
}
else {
param_4[0xd] = uVar4;
_Dst = param_4 + 0x12;
param_4[0xc] = 0;
param_4[0xe] = uVar5;
param_4[0xf] = (char)uVar6;
param_4[0x10] = uVar3;
param_4[0x11] = (char)param_3;
}
memcpy(_Dst,param_2,(ulonglong)param_3);
*param_5 = iVar7;
return;
}
=========================================
Function at address: 0x180062998
Called functions addresses: 0x18002a7c0 0x18005b470


ulonglong FUN_180062998(longlong *param_1)

{
uint uVar1;
ulonglong uVar2;


if ((int)uVar2 == 0) {
*(char *)((longlong)param_1 + 0x154) = (char)uVar2;

(param_1,param_1[0x6e],*(undefined4 *)(param_1 + 0x6d),0);
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(undefined4 *)(param_1 + 0x6d) = 0;
if (uVar1 != 0) {
FUN_18005b470(param_1,0x3ef,uVar1,0x50);
}
uVar2 = (ulonglong)uVar1;
}
return uVar2;
}
=========================================
Function at address: 0x180062a60
Called functions addresses: None


undefined8 FUN_180062a60(longlong param_1)

{
ulonglong uVar1;
bool bVar2;

if (*(int *)(param_1 + 0x44) == 0x3d) {
uVar1 = (ulonglong)*(uint *)(param_1 + 0x88);
if ((*(uint *)(param_1 + 0x88) >> 8 & 1) == 0) {
bVar2 = true;
}
else {
bVar2 = *(char *)(param_1 + 0x228) != '\0';
}
}
else {
bVar2 = (*(int *)(param_1 + 0x44) - 0x3eU & 0xfffffffd) == 0;
uVar1 = 0;
}
return CONCAT71((int7)(uVar1 >> 8),bVar2);
}
=========================================
Function at address: 0x180062aa8
Called functions addresses: 0x18006fa58 0x1800705d4 0x180041cb0 0x18002a7c0 0x180003ea4 0x18002a77b 0x180070c68


ulonglong FUN_180062aa8(longlong *param_1,short *param_2,ushort param_3,void *param_4,byte param_5)

{
ushort *puVar1;
short sVar2;
int iVar3;
undefined4 extraout_var;
void *_Dst;
ulonglong uVar4;
byte bVar5;

iVar3 = FUN_180070c68(param_2,param_3,1);
if (iVar3 != 0) {
return CONCAT44(extraout_var,iVar3);
}
puVar1 = (ushort *)param_1[100];
if (puVar1 != (ushort *)0x0) {
if (param_4 == (void *)0x0) {
if (param_5 == 0) {
LAB_180062b31:
sVar2 = FUN_18006fa58((short *)(puVar1 + 1),*puVar1,param_2,param_3);
if (sVar2 == 0) {
FUN_180003ea4(param_1);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3e,&DAT_180082bd8);
}
}
else {
_Dst = (void *)0x0;
bVar5 = 0;
if ((param_5 != 0) && (_Dst = (void *)0x0, *(char *)((longlong)param_1 + 0x3dc) != '\0'))
{

(param_1,(ulonglong)param_5);
if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,param_4,(ulonglong)param_5);
bVar5 = param_5;
}
uVar4 = FUN_1800705d4(param_1,sVar2,_Dst,bVar5);
if ((int)uVar4 != 0) {
if (_Dst == (void *)0x0) {
return uVar4 & 0xffffffff;
}

return uVar4 & 0xffffffff;
}
}
return 0;
}
}
else if (param_5 != 0) goto LAB_180062b31;
}
return 0x57;
}
=========================================
Function at address: 0x180062c20
Called functions addresses: 0x180041cb0 0x18002a7c0 0x180070690


ulonglong FUN_180062c20(longlong *param_1,char param_2,char param_3,char *param_4,ushort param_5)

{
char *pcVar1;
ulonglong uVar2;
char *pcVar3;
undefined2 uVar4;
char *pcVar5;

if ((param_5 == 0) || (param_4 == (char *)0x0)) {
return 0x57;
}
pcVar5 = (char *)param_1[0x66];
if (((pcVar5 == (char *)0x0) || (*pcVar5 != param_2)) || (pcVar5[1] != param_3)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) == 0) {
return 0;
}
uVar4 = 0x3f;
}
else {
pcVar1 = pcVar5 + 4;
pcVar3 = pcVar1 + *(ushort *)(pcVar5 + 2);
pcVar5 = param_4;
for (; pcVar1 < pcVar3; pcVar1 = pcVar1 + 1) {
pcVar5 = param_4;
if (param_4 < param_4 + param_5) {
do {
if (*pcVar1 == *pcVar5) goto LAB_180062cb8;
pcVar5 = pcVar5 + 1;
} while (pcVar5 < param_4 + param_5);
}
}
LAB_180062cb8:
if (pcVar1 != pcVar3) {

if (pcVar1 == (char *)0x0) {
return 0xe;
}
*pcVar1 = *pcVar5;
uVar2 = FUN_180070690(param_1,param_2,param_3,pcVar1,1);
if ((int)uVar2 != 0) {

return uVar2 & 0xffffffff;
}
return uVar2 & 0xffffffff;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) == 0) {
return 0;
}
uVar4 = 0x40;
}
FUN_180041cb0(DAT_180091000[2],uVar4,&DAT_180082bd8);
return 0;
}
=========================================
Function at address: 0x180062db4
Called functions addresses: 0x180041cdc 0x18002a7c0 0xEXTERNAL:00000040 0xEXTERNAL:00000047 0x180001604 0x180045258 0xEXTERNAL:000000c0 0xEXTERNAL:000000bc 0x180055ed0


ulonglong FUN_180062db4(longlong *param_1,longlong *param_2,short *param_3)

{
longlong lVar1;
int iVar2;
longlong lVar3;
ulonglong unaff_RSI;
undefined4 local_res10 [4];
uint local_res20 [2];
int local_58 [2];
HLOCAL local_50;
longlong local_48 [2];

if (param_2 == (longlong *)0x0) {
return unaff_RSI;
}
if (*param_2 != 0) {
return unaff_RSI;
}
if (param_3 == (short *)0x0) {
return unaff_RSI;
}
if (*param_3 != 0) {
return unaff_RSI;
}
local_res10[0] = 0;

if (iVar2 != 0) {
return unaff_RSI;
}

if (lVar3 == 0) {
return unaff_RSI;
}
local_50 = (HLOCAL)0x0;

(param_1[0x7c],param_1,lVar3,local_res10[0],local_res10);
if (iVar2 != 0) goto LAB_18006303b;
local_res20[0] = 0;
local_48[0] = 0;
iVar2 = FUN_180055ed0(param_1[10],local_48);
if (iVar2 == 0) {
local_58[0] = 0;
iVar2 = FUN_180001604(*(longlong *)(param_1[10] + 0x2f0),local_58);
if (iVar2 == 0) {
if (DAT_180092188 == 0) {
iVar2 = 0x485;
LAB_180062f1d:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x33,&DAT_180082bd8,iVar2);
}
}
else {

(lVar3,local_res10[0],local_48[0],&local_50,local_res20);
if (iVar2 != 0) goto LAB_180062f1d;
}
if (((0xffff < local_res20[0]) &&
(iVar2 = 0x54f, (undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x34,&DAT_180082bd8,local_res20[0]);
}
}
if (local_58[0] != 0) {
RevertToSelf();
}
}
if ((iVar2 - 2U < 2) && (lVar1 = param_1[10], *(int *)(lVar1 + 0x380) == 0)) {
FUN_180045258(*(uint *)(lVar1 + 0xd4),lVar1 + 0xd8,local_48[0]);
lVar1 = param_1[10];
RtlAcquireResourceExclusive(lVar1 + 0x30,1);
*(undefined4 *)(lVar1 + 0x380) = 1;
RtlReleaseResource(lVar1 + 0x30);
}
if (iVar2 == 0) {
lVar1 = param_1[10];
if (*(int *)(lVar1 + 0x380) != 0) {
RtlAcquireResourceExclusive(lVar1 + 0x30,1);
*(undefined4 *)(lVar1 + 0x380) = 0;
RtlReleaseResource(lVar1 + 0x30);
}
*param_2 = (longlong)local_50;
*param_3 = (short)local_res20[0];
local_50 = (HLOCAL)0x0;
}
LAB_18006303b:

if (local_50 != (HLOCAL)0x0) {
LocalFree(local_50);
}
return unaff_RSI;
}
=========================================
Function at address: 0x180063098
Called functions addresses: 0x18004492c 0x180041cb0 0x18000a1d0 0x18002a77b 0xEXTERNAL:00000075


undefined8 FUN_180063098(longlong param_1,void *param_2,ushort param_3)

{
ulonglong _Size;
ulonglong uVar1;
undefined8 uVar2;
void *_Dst;

_Size = (ulonglong)param_3;
if ((param_2 == (void *)0x0) || (param_3 == 0)) {
return 0x57;
}
if (*(longlong *)(param_1 + 0x3b0) == 0) {
_Dst = (void *)FUN_18000a1d0(param_1,(uint)param_3);
*(void **)(param_1 + 0x3b0) = _Dst;
if (_Dst == (void *)0x0) {
return 0x80090300;
}
memcpy(_Dst,param_2,_Size);
*(ushort *)(param_1 + 0x3b8) = param_3;
LAB_1800631a4:
uVar2 = 0;
}
else {
if (*(ushort *)(param_1 + 0x3b8) == param_3) {
uVar1 = RtlCompareMemory(*(longlong *)(param_1 + 0x3b0),param_2,_Size);
if (uVar1 == _Size) goto LAB_1800631a4;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3b,&DAT_180082bd8);
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_18004492c(DAT_180091000[2],0x3a,&DAT_180082bd8,(uint)param_3,
(char)*(ushort *)(param_1 + 0x3b8));
}
uVar2 = 0x80090326;
}
return uVar2;
}
=========================================
Function at address: 0x1800631d0
Called functions addresses: 0x180041cdc 0x1800592e8 0x18002a7c0 0xEXTERNAL:00000040 0xEXTERNAL:00000047 0x180001604 0x18000629c 0x180006300 0x18002a77b 0x180055ed0


bool FUN_1800631d0(longlong *param_1,undefined8 *param_2,int param_3,uint *param_4,uint param_5)

{
longlong *plVar1;
int iVar2;
undefined8 *puVar3;
longlong lVar4;
int local_res10 [2];
undefined4 local_48 [2];
HLOCAL local_40;
longlong local_38 [2];

if ((((param_2 == (undefined8 *)0x0) || (param_3 == 0)) || (param_4 == (uint *)0x0)) ||
((*(uint *)(param_1 + 0x11) >> 0xb & 1) == 0)) {
return false;
}
local_40 = (HLOCAL)0x0;
local_48[0] = 0;
local_38[0] = 0;
iVar2 = FUN_180055ed0(param_1[10],local_38);
if (iVar2 != 0) goto LAB_180063397;
local_res10[0] = 0;
puVar3 = *(undefined8 **)(param_1[10] + 0x2f0);
iVar2 = FUN_180001604((longlong)puVar3,local_res10);
if (iVar2 == 0) {
if (DAT_180092180 == 0) {
iVar2 = 0x485;
}
else {

(param_2,param_3,local_38[0],&local_40,local_48);
puVar3 = param_2;
if (iVar2 == 0) goto LAB_1800632d4;
}
puVar3 = DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
puVar3 = (undefined8 *)DAT_180091000[2];
FUN_180041cdc(puVar3,0x2e,&DAT_180082bd8,iVar2);
}
}
LAB_1800632d4:
if (local_res10[0] != 0) {
RevertToSelf();
}
lVar4 = DAT_1800927f0;
if (iVar2 == 0) {
FUN_18000629c(puVar3,(byte *)0x0,param_4);
plVar1 = param_1 + 0x7c;
iVar2 = FUN_1800592e8(lVar4,*(undefined4 *)(param_1 + 8),param_4,plVar1);
FUN_180006300(lVar4,(byte *)0x0,param_4);
if (iVar2 == 0) {

lVar4 = *plVar1;
if (iVar2 == 0) {
*(short *)(lVar4 + 0xee) = (short)param_5;
memcpy((void *)(lVar4 + 0xf0),param_4,(ulonglong)param_5);
}
else {
*(undefined *)(lVar4 + 0xec) = 0;

}
}
}
LAB_180063397:
if (local_40 != (HLOCAL)0x0) {
LocalFree(local_40);
}
if (((iVar2 != 0) && ((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2f,&DAT_180082bd8,iVar2);
}
return iVar2 == 0;
}
=========================================
Function at address: 0x180063404
Called functions addresses: 0x18002a7c0 0x18005b470 0x180009470


ulonglong FUN_180063404(longlong *param_1,undefined8 param_2,int param_3,uint *param_4,
undefined4 param_5,undefined4 param_6)

{
uint uVar1;
ulonglong uVar2;


uVar2 = (ulonglong)uVar1;
if (uVar1 == 0) {
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
return uVar2;
}
uVar2 = FUN_180009470(param_1,param_4,0x16,param_3);
uVar1 = (uint)uVar2;
uVar2 = uVar2 & 0xffffffff;
param_5 = param_6;
if (uVar1 == 0) {
return uVar2;
}
}
FUN_18005b470(param_1,param_5,uVar1,0x50);
return uVar2;
}
=========================================
Function at address: 0x1800634b0
Called functions addresses: 0x180028a7c


undefined8 * FUN_1800634b0(undefined8 *param_1,byte param_2)

{
*param_1 = &PTR_FUN_18007d3f0;
if ((param_2 & 1) != 0) {
_o_free();
}
return param_1;
}
=========================================
Function at address: 0x1800634e0
Called functions addresses: 0xEXTERNAL:000000f2


undefined8 FUN_1800634e0(longlong param_1,longlong param_2)

{
ulonglong uVar1;
ulonglong uVar2;
longlong lVar3;
undefined8 *puVar4;
undefined8 uVar5;
ushort uVar6;

uVar5 = 0;
if ((((((param_2 != 0) && (*(short *)(param_1 + 0x10) != 0)) &&
(*(longlong *)(param_1 + 0x18) != 0)) &&
((uVar1 = *(ulonglong *)(param_1 + 0x20), uVar1 != 0 &&
(uVar1 < *(longlong *)(param_1 + 0x18) + (ulonglong)*(ushort *)(param_1 + 0x10) * 0xc)))) &&
(((*(byte *)(uVar1 + 8) & 1) != 0 &&
((uVar1 = *(ulonglong *)(param_1 + 0x38), uVar1 != 0 &&
(uVar2 = *(ulonglong *)(param_1 + 0x40), uVar1 <= uVar2)))))) &&
(*(int *)(param_1 + 0x48) != 0)) {
if ((longlong)(uVar2 - uVar1) < (longlong)(ulonglong)*(uint *)(param_1 + 0x48)) {
uVar6 = (short)uVar2 - *(short *)(param_1 + 0x38);
}
else {
uVar6 = *(ushort *)(param_1 + 0x48);
}
if (*(char *)(uVar2 - uVar6) == '\x01') {
lVar3 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x58);
if (lVar3 == 0) {
return 0x80090304;
}
puVar4 = *(undefined8 **)(lVar3 + 0xb0);
if (puVar4 != (undefined8 *)0x0) {
uVar5 = *puVar4;
}
uVar5 = SslHashHandshake(uVar5,param_2,(char *)(uVar2 - uVar6),uVar6,0);
return uVar5;
}
}
return 0x57;
}
=========================================
Function at address: 0x1800635d4
Called functions addresses: None


undefined8 * FUN_1800635d4(ulonglong param_1,undefined8 *param_2,longlong param_3)

{
if ((param_2 != (undefined8 *)0x0) && (param_3 != 0)) {
param_2[4] = 0;
*(undefined4 *)(param_2 + 9) = 0;
param_2[1] = param_3;
*(undefined2 *)(param_2 + 2) = 0;
param_2[3] = 0;
*(undefined4 *)(param_2 + 5) = 0;
param_2[6] = 0;
param_2[7] = 0;
param_2[8] = 0;
if ((param_1 & 0x100000000) == 0) {
*(undefined4 *)((longlong)param_2 + 0x54) = 0x14;
*param_2 = &PTR_FUN_18007cf80;
*(undefined2 *)(param_2 + 10) = 0x4000;
*(undefined2 *)((longlong)param_2 + 0x5a) = 0x4000;
*(undefined *)(param_2 + 0xb) = 0;
}
else {
*param_2 = &PTR_FUN_18007d590;
}
return param_2;
}
return (undefined8 *)0x0;
}
=========================================
Function at address: 0x180063660
Called functions addresses: None


undefined8 FUN_180063660(longlong param_1,short param_2)

{
if ((*(longlong *)(param_1 + 0x30) == 0) && ((ushort)(param_2 - 1U) < 0x4000)) {
*(short *)(param_1 + 0x50) = param_2;
return 0;
}
return 0x57;
}
=========================================
Function at address: 0x18006368c
Called functions addresses: 0x180029f58


undefined8 * FUN_18006368c(undefined8 *param_1,longlong param_2,undefined8 param_3)

{
undefined8 *puVar1;
undefined8 *puVar2;

param_1[1] = param_2;

puVar1 = (undefined8 *)FUN_180029f58(0x48);
puVar2 = (undefined8 *)0x0;
if (puVar1 != (undefined8 *)0x0) {
puVar1[1] = param_2;
puVar1[2] = 0;
*(undefined4 *)(puVar1 + 3) = 0;
*puVar1 = &PTR_FUN_18007d048;
*(undefined *)(puVar1 + 4) = 0;
puVar1[5] = 0;
*(undefined4 *)(puVar1 + 6) = 0;
puVar1[7] = param_2;
*(undefined *)((longlong)puVar1 + 0x34) = *(undefined *)(param_2 + 0x39a);
*puVar1 = &PTR__scalar_deleting_destructor__18007d5c8;
puVar1[8] = param_2;
puVar2 = puVar1;
}
param_1[4] = param_3;
param_1[2] = puVar2;
param_1[3] = 0;
*(undefined4 *)(param_1 + 5) = 0;
*(undefined2 *)((longlong)param_1 + 0x2c) = 0;
*(undefined *)((longlong)param_1 + 0x2e) = 0;
*(undefined4 *)(param_1 + 6) = 0;
*(undefined2 *)((longlong)param_1 + 0x34) = 0;
*(undefined *)((longlong)param_1 + 0x36) = 0;
param_1[7] = 0;
*(undefined2 *)(param_1 + 8) = 0;
param_1[9] = 0;
*(undefined4 *)(param_1 + 10) = 0;
param_1[0xb] = 0;
param_1[0xc] = 0;
*(undefined4 *)(param_1 + 0xd) = 0;
param_1[0xe] = 0;
param_1[0xf] = 0;
param_1[0x10] = 0;
param_1[0x11] = 0;
param_1[0x12] = 0;
*(undefined4 *)(param_1 + 0x13) = 0;
*(undefined2 *)((longlong)param_1 + 0x9c) = 0;
return param_1;
}
=========================================
Function at address: 0x180063788
Called functions addresses: 0x18002a7c0 0x18000909c


void FUN_180063788(undefined8 *param_1)

{

if (param_1[2] != 0) {

}
if ((HLOCAL)param_1[7] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[7]);
}
if ((HLOCAL)param_1[0x12] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x12]);
}
return;
}
=========================================
Function at address: 0x1800637ec
Called functions addresses: 0x18002a7c0 0x18000909c


void FUN_1800637ec(undefined8 *param_1)

{

if (param_1[2] != 0) {

}
if ((HLOCAL)param_1[7] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[7]);
}
if ((HLOCAL)param_1[0x12] != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)param_1[0x12]);
}
return;
}
=========================================
Function at address: 0x180063860
Called functions addresses: 0x180028a7c 0x180063788


undefined8 * FUN_180063860(undefined8 *param_1,uint param_2)

{
FUN_180063788(param_1);
if ((param_2 & 1) != 0) {
_o_free(param_1);
}
return param_1;
}
=========================================
Function at address: 0x1800638a0
Called functions addresses: 0x180028a7c 0x1800637ec


undefined8 * FUN_1800638a0(undefined8 *param_1,uint param_2)

{
FUN_1800637ec(param_1);
if ((param_2 & 1) != 0) {
_o_free(param_1);
}
return param_1;
}
=========================================
Function at address: 0x1800638e0
Called functions addresses: 0x180028a7c 0x180008da0


/* Library Function - Single Match
public: virtual void * __ptr64 __cdecl std::bad_alloc::`scalar deleting destructor'(unsigned
int) __ptr64

Library: Visual Studio 2019 Release */



{
*(undefined ***)this = &PTR__scalar_deleting_destructor__18007d5c8;
FUN_180008da0((undefined8 *)this);
if ((param_1 & 1) != 0) {
_o_free(this);
}
return this;
}
=========================================
Function at address: 0x180063920
Called functions addresses: None


undefined8 FUN_180063920(longlong param_1)

{
ushort uVar1;
longlong lVar2;

*(undefined2 *)(param_1 + 0xa4) = 0;
lVar2 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x310);
if (lVar2 != 0) {
uVar1 = *(ushort *)(lVar2 + 4);
if (0xfffd < uVar1) {
return 0x57;
}
if ((lVar2 != -6) && (uVar1 != 0)) {
*(ushort *)(param_1 + 0xa4) = uVar1 + 2;
}
}
return 0;
}
=========================================
Function at address: 0x180063974
Called functions addresses: 0xEXTERNAL:00000132 0x180028d90 0xEXTERNAL:00000041 0x18000a1f4 0x180075b20 0x18000909c


DWORD FUN_180063974(longlong param_1)

{
BOOL BVar1;
DWORD DVar2;
void *_Dst;
ushort uVar3;
DWORD local_res8 [2];
DWORD local_res10 [2];
uint local_38 [2];
void *local_30;
uint local_28;
longlong local_20;

local_res8[0] = 0;
if ((*(char *)(*(longlong *)(param_1 + 0x48) + 0x4e) == '\0') ||
(*(char *)(*(longlong *)(param_1 + 0x48) + 0x4f) != '\0')) {
DVar2 = FUN_180075b20(*(longlong **)(param_1 + 8),*(int *)(param_1 + 0x68),
*(int *)(param_1 + 100),local_res8);
if (DVar2 != 0) {
return DVar2;
}
}
else {
local_res8[0] = *(uint *)(*(longlong *)(param_1 + 8) + 0x3b0);
if (local_res8[0] == 0) {
return 0x54f;
}
}
if (local_res8[0] < 0x10000) {
*(short *)(param_1 + 0x8c) = (short)local_res8[0];
if (*(int *)(param_1 + 0x68) == 1) {
*(short *)(param_1 + 0x8e) = (short)local_res8[0];
return 0;
}
if (*(int *)(param_1 + 0x68) == 3) {
_Dst = (void *)FUN_18000a1f4((ulonglong)(local_res8[0] & 0xffff));
if (_Dst == (void *)0x0) {
return 0xe;
}
memset(_Dst,0xff,(ulonglong)*(ushort *)(param_1 + 0x8c));
local_res10[0] = 0;
uVar3 = *(ushort *)(param_1 + 0x8c) >> 1;
local_38[0] = (uint)uVar3;
local_20 = (ulonglong)uVar3 + (longlong)_Dst;
local_30 = _Dst;
local_28 = local_38[0];
BVar1 = CryptEncodeObject(1,(LPCSTR)0x2f,local_38,(BYTE *)0x0,local_res10);
FUN_18000909c(_Dst);
if (BVar1 == 0) {
DVar2 = GetLastError();
return DVar2;
}
if (local_res10[0] < 0x10000) {
*(short *)(param_1 + 0x8e) = (short)local_res10[0];
return 0;
}
}
}
return 0x54f;
}
=========================================
Function at address: 0x180063ab8
Called functions addresses: 0x180041cb0


undefined8 FUN_180063ab8(longlong param_1)

{
undefined8 uVar1;

if ((*(longlong *)(param_1 + 0xb0) == 0) || (*(short *)(param_1 + 0xb8) == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x15,&DAT_180082c10);
}
uVar1 = 0x57;
}
else {
*(short *)(param_1 + 0xba) = *(short *)(param_1 + 0xb8) + 2;
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x180063b24
Called functions addresses: 0x180064928 0x18002a7c0


undefined8 FUN_180063b24(undefined8 *param_1)

{
ushort uVar1;
undefined8 uVar2;
undefined8 *puVar3;
uint uVar4;

puVar3 = param_1;
uVar2 = FUN_180064928((longlong)param_1,0xb);
if ((int)uVar2 == 0) {
uVar1 = *(ushort *)((longlong)puVar3 + 0x7a);
uVar4 = (uint)uVar1;
if ((*(uint *)(puVar3[1] + 0x40) & 0x40051555) != 0) {

if ((int)uVar2 != 0) {
return uVar2;
}
if (*(ushort *)(param_1 + 0x13) != 0) {
uVar4 = uVar1 + 4 + (uint)*(ushort *)(param_1 + 0x13);
}
}
if (uVar4 < 0x10000) {
*(short *)((longlong)param_1 + 0x9a) = (short)uVar4;
uVar2 = 0;
}
else {
uVar2 = 0x54f;
}
}
return uVar2;
}
=========================================
Function at address: 0x180063bb0
Called functions addresses: 0x18002a7c0 0x1800649cc


undefined8 FUN_180063bb0(undefined8 *param_1)

{
ushort uVar1;
undefined8 uVar2;
undefined8 *puVar3;
uint uVar4;

puVar3 = param_1;
uVar2 = FUN_1800649cc((longlong)param_1,0xb);
if ((int)uVar2 == 0) {
uVar1 = *(ushort *)((longlong)puVar3 + 0x7a);
uVar4 = (uint)uVar1;
if ((*(uint *)(puVar3[1] + 0x40) & 0x40051555) != 0) {

if ((int)uVar2 != 0) {
return uVar2;
}
if (*(ushort *)(param_1 + 0x13) != 0) {
uVar4 = uVar1 + 4 + (uint)*(ushort *)(param_1 + 0x13);
}
}
if (uVar4 < 0x10000) {
*(short *)((longlong)param_1 + 0x9a) = (short)uVar4;
uVar2 = 0;
}
else {
uVar2 = 0x54f;
}
}
return uVar2;
}
=========================================
Function at address: 0x180063c3c
Called functions addresses: 0x180063b24


undefined8 FUN_180063c3c(undefined8 *param_1,longlong param_2,char param_3,short *param_4)

{
undefined8 uVar1;
ushort uVar2;
ushort uVar3;

uVar2 = 0;
if (param_4 == (short *)0x0) {
LAB_180063ca8:
uVar1 = 0x57;
}
else {
uVar3 = 0;
if (param_2 != 0) {
if (0xfffa < *(uint *)(param_2 + 0x10)) goto LAB_180063ca8;
uVar3 = *(ushort *)(param_2 + 0x10);
}
if (param_3 != '\0') {
uVar1 = FUN_180063b24(param_1);
if ((int)uVar1 != 0) {
return uVar1;
}
uVar2 = *(ushort *)((longlong)param_1 + 0x9a);
if ((int)(0xfffa - (uint)uVar3) < (int)(uint)uVar2) goto LAB_180063ca8;
}
*param_4 = uVar2 + 5 + uVar3;
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x180063cd0
Called functions addresses: 0x180063bb0


undefined8 FUN_180063cd0(undefined8 *param_1,longlong param_2,char param_3,short *param_4)

{
undefined8 uVar1;
ushort uVar2;
ushort uVar3;

uVar2 = 0;
if (param_4 == (short *)0x0) {
LAB_180063d3c:
uVar1 = 0x57;
}
else {
uVar3 = 0;
if (param_2 != 0) {
if (0xfffa < *(uint *)(param_2 + 0x10)) goto LAB_180063d3c;
uVar3 = *(ushort *)(param_2 + 0x10);
}
if (param_3 != '\0') {
uVar1 = FUN_180063bb0(param_1);
if ((int)uVar1 != 0) {
return uVar1;
}
uVar2 = *(ushort *)((longlong)param_1 + 0x9a);
if ((int)(0xfffa - (uint)uVar3) < (int)(uint)uVar2) goto LAB_180063d3c;
}
*param_4 = uVar2 + 5 + uVar3;
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x180063d64
Called functions addresses: 0x180063c3c 0xEXTERNAL:00000147


ulonglong FUN_180063d64(undefined8 *param_1)

{
ushort *puVar1;
longlong lVar2;
longlong lVar3;
DWORD *pDVar4;
BOOL BVar5;
ulonglong uVar6;
int iVar7;
ushort local_res8 [4];

puVar1 = (ushort *)(param_1 + 8);
uVar6 = 0;
*puVar1 = 0;
lVar2 = param_1[9];
if (lVar2 == 0) {
return (ulonglong)(-(uint)((*(uint *)(param_1[1] + 0x40) & 0x40051555) != 0) & 0x54f);
}
lVar3 = *(longlong *)(lVar2 + 0x40);
if (((lVar3 == 0) || (*(longlong **)(lVar3 + 0x10) == (longlong *)0x0)) ||
(*(int *)(lVar3 + 0xc) == 0)) {
if (*(longlong *)(lVar2 + 0x20) == 0) {
return 0x57;
}
uVar6 = FUN_180063c3c(param_1,*(longlong *)(lVar2 + 0x20),'\x01',(short *)puVar1);
if ((int)uVar6 != 0) {
return uVar6;
}
}
else {
lVar2 = **(longlong **)(lVar3 + 0x10);
if (((lVar2 == 0) || (*(longlong *)(lVar2 + 0x10) == 0)) || (*(int *)(lVar2 + 0xc) == 0)) {
return 0x57;
}
do {
iVar7 = (int)uVar6;
pDVar4 = *(DWORD **)(*(longlong *)(*(longlong *)(lVar2 + 0x10) + uVar6 * 8) + 8);
if (pDVar4 == (DWORD *)0x0) {
return 0x57;
}
lVar3 = *(longlong *)(pDVar4 + 6);
if (lVar3 == 0) {
return 0x57;
}
if (((*(char *)(param_1 + 10) == '\0') && (iVar7 != 0)) &&
(BVar5 = CertCompareCertificateName
(*pDVar4,(PCERT_NAME_BLOB)(lVar3 + 0x30),(PCERT_NAME_BLOB)(lVar3 + 0x50)
), BVar5 != 0)) {
return 0;
}
local_res8[0] = 0;
uVar6 = FUN_180063c3c(param_1,(longlong)pDVar4,iVar7 == 0,(short *)local_res8);
if ((int)uVar6 != 0) {
return uVar6;
}
if ((int)(0xffff - (uint)*puVar1) < (int)(uint)local_res8[0]) {
return 0x57;
}
uVar6 = (ulonglong)(iVar7 + 1U);
*puVar1 = *puVar1 + local_res8[0];
} while (iVar7 + 1U < *(uint *)(lVar2 + 0xc));
}
return 0;
}
=========================================
Function at address: 0x180063ec8
Called functions addresses: 0x180063cd0 0xEXTERNAL:00000147


ulonglong FUN_180063ec8(undefined8 *param_1)

{
ushort *puVar1;
longlong lVar2;
longlong lVar3;
DWORD *pDVar4;
BOOL BVar5;
ulonglong uVar6;
int iVar7;
ushort local_res8 [4];

puVar1 = (ushort *)(param_1 + 8);
uVar6 = 0;
*puVar1 = 0;
lVar2 = param_1[9];
if (lVar2 == 0) {
return (ulonglong)(-(uint)((*(uint *)(param_1[1] + 0x40) & 0x40051555) != 0) & 0x54f);
}
lVar3 = *(longlong *)(lVar2 + 0x40);
if (((lVar3 == 0) || (*(longlong **)(lVar3 + 0x10) == (longlong *)0x0)) ||
(*(int *)(lVar3 + 0xc) == 0)) {
if (*(longlong *)(lVar2 + 0x20) == 0) {
return 0x57;
}
uVar6 = FUN_180063cd0(param_1,*(longlong *)(lVar2 + 0x20),'\x01',(short *)puVar1);
if ((int)uVar6 != 0) {
return uVar6;
}
}
else {
lVar2 = **(longlong **)(lVar3 + 0x10);
if (((lVar2 == 0) || (*(longlong *)(lVar2 + 0x10) == 0)) || (*(int *)(lVar2 + 0xc) == 0)) {
return 0x57;
}
do {
iVar7 = (int)uVar6;
pDVar4 = *(DWORD **)(*(longlong *)(*(longlong *)(lVar2 + 0x10) + uVar6 * 8) + 8);
if (pDVar4 == (DWORD *)0x0) {
return 0x57;
}
lVar3 = *(longlong *)(pDVar4 + 6);
if (lVar3 == 0) {
return 0x57;
}
if (((*(char *)(param_1 + 10) == '\0') && (iVar7 != 0)) &&
(BVar5 = CertCompareCertificateName
(*pDVar4,(PCERT_NAME_BLOB)(lVar3 + 0x30),(PCERT_NAME_BLOB)(lVar3 + 0x50)
), BVar5 != 0)) {
return 0;
}
local_res8[0] = 0;
uVar6 = FUN_180063cd0(param_1,(longlong)pDVar4,iVar7 == 0,(short *)local_res8);
if ((int)uVar6 != 0) {
return uVar6;
}
if ((int)(0xffff - (uint)*puVar1) < (int)(uint)local_res8[0]) {
return 0x57;
}
uVar6 = (ulonglong)(iVar7 + 1U);
*puVar1 = *puVar1 + local_res8[0];
} while (iVar7 + 1U < *(uint *)(lVar2 + 0xc));
}
return 0;
}
=========================================
Function at address: 0x18006402c
Called functions addresses: 0x180063d64


ulonglong FUN_18006402c(undefined8 *param_1,longlong param_2,undefined param_3,undefined2 *param_4)

{
ulonglong uVar1;
undefined2 uVar2;
uint uVar3;

uVar3 = 0;
if ((((*(uint *)(param_1[1] + 0x40) & 0x40051555) == 0) || (param_2 != 0)) &&
(param_4 != (undefined2 *)0x0)) {
param_1[9] = param_2;
*(undefined *)(param_1 + 10) = param_3;
uVar1 = FUN_180063d64(param_1);
if ((int)uVar1 == 0) {
if ((*(uint *)(param_1[1] + 0x40) & 0x40051555) == 0) {
uVar3 = (uint)*(byte *)(param_1[1] + 0x640);
}
uVar3 = *(ushort *)(param_1 + 8) + 8 + uVar3;
if (uVar3 < 0x10000) {
uVar2 = (undefined2)uVar3;
*(undefined2 *)(param_1 + 0x11) = uVar2;
uVar1 = 0;
*param_4 = uVar2;
}
else {
uVar1 = 0x54f;
}
}
}
else {
uVar1 = 0x57;
}
return uVar1;
}
=========================================
Function at address: 0x1800640c4
Called functions addresses: 0x180063ec8


ulonglong FUN_1800640c4(undefined8 *param_1,longlong param_2,undefined param_3,undefined2 *param_4)

{
ulonglong uVar1;
undefined2 uVar2;
uint uVar3;

uVar3 = 0;
if ((((*(uint *)(param_1[1] + 0x40) & 0x40051555) == 0) || (param_2 != 0)) &&
(param_4 != (undefined2 *)0x0)) {
param_1[9] = param_2;
*(undefined *)(param_1 + 10) = param_3;
uVar1 = FUN_180063ec8(param_1);
if ((int)uVar1 == 0) {
if ((*(uint *)(param_1[1] + 0x40) & 0x40051555) == 0) {
uVar3 = (uint)*(byte *)(param_1[1] + 0x4d0);
}
uVar3 = *(ushort *)(param_1 + 8) + 8 + uVar3;
if (uVar3 < 0x10000) {
uVar2 = (undefined2)uVar3;
*(undefined2 *)(param_1 + 0x11) = uVar2;
uVar1 = 0;
*param_4 = uVar2;
}
else {
uVar1 = 0x54f;
}
}
}
else {
uVar1 = 0x57;
}
return uVar1;
}
=========================================
Function at address: 0x18006415c
Called functions addresses: 0x180063ab8 0x1800649cc


undefined8 FUN_18006415c(longlong param_1)

{
ushort uVar1;
undefined8 uVar2;
uint uVar3;

*(undefined2 *)(param_1 + 0xa8) = 0;
if ((ushort)(*(short *)(param_1 + 0x7e) - 1U) < 0x10) {
uVar1 = (*(short *)(param_1 + 0x7e) + 1) * 2;
*(ushort *)(param_1 + 0x7c) = uVar1;
uVar3 = uVar1 + 4;
if ((((DAT_180092f08 != 0) && (*(longlong *)(param_1 + 0xb0) != 0)) &&
(*(short *)(param_1 + 0xb8) != 0)) && (uVar2 = FUN_180063ab8(param_1), (int)uVar2 != 0)) {
return uVar2;
}
if (*(ushort *)(param_1 + 0xba) != 0) {
uVar3 = uVar3 + *(ushort *)(param_1 + 0xba) + 4;
}
uVar2 = FUN_1800649cc(param_1,0xd);
if ((int)uVar2 != 0) {
return uVar2;
}
if (uVar3 <= 0xffff - *(ushort *)(param_1 + 0x7a)) {
*(ushort *)(param_1 + 0xa8) = *(ushort *)(param_1 + 0x7a) + (short)uVar3;
return 0;
}
}
return 0x54f;
}
=========================================
Function at address: 0x180064218
Called functions addresses: 0x180041cdc 0x180041cb0 0x180055c40 0x180012184 0x18006415c 0x180057104 0x18000909c


ulonglong FUN_180064218(longlong param_1,undefined2 *param_2)

{
undefined8 *puVar1;
longlong lVar2;
undefined8 *puVar3;
int iVar4;
ulonglong uVar5;
undefined2 uVar6;
uint uVar7;
uint local_res8 [2];

lVar2 = *(longlong *)(param_1 + 8);
if ((undefined2 *)(lVar2 + 0x1da) != (undefined2 *)0x0) {
*(longlong *)(param_1 + 0x80) = lVar2 + 0x1dc;
*(undefined2 *)(param_1 + 0x7e) = *(undefined2 *)(lVar2 + 0x1da);
puVar3 = *(undefined8 **)(lVar2 + 0x50);
if (puVar3 != (undefined8 *)0x0) {
uVar5 = FUN_180057104(puVar3);
iVar4 = (int)uVar5;
if (iVar4 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x22,&DAT_180082c10,iVar4);
}
FUN_180012184(*(longlong *)(param_1 + 8),0x4e3,iVar4);
return uVar5 & 0xffffffff;
}
if (DAT_180092f08 != 0) {
puVar1 = (undefined8 *)(param_1 + 0xb0);
if ((HLOCAL)*puVar1 != (HLOCAL)0x0) {
FUN_18000909c((HLOCAL)*puVar1);
*puVar1 = 0;
}
local_res8[0] = 0;
*(undefined2 *)(param_1 + 0xb8) = 0;
uVar5 = FUN_180055c40((longlong)puVar3,puVar1,local_res8);
if ((int)uVar5 != 0) {
return uVar5;
}
if (0xfffd < local_res8[0]) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x23,&DAT_180082c10);
}
return 0x57;
}
*(short *)(param_1 + 0xb8) = (short)local_res8[0];
}
uVar5 = FUN_18006415c(param_1);
if ((int)uVar5 != 0) {
return uVar5;
}
uVar7 = *(ushort *)(param_1 + 0xa8) + 7 + (uint)*(byte *)(*(longlong *)(param_1 + 8) + 0x4d0);
if (uVar7 < 0x10000) {
uVar6 = (undefined2)uVar7;
*(undefined2 *)(param_1 + 0xaa) = uVar6;
*param_2 = uVar6;
return 0;
}
}
}
return 0x54f;
}
=========================================
Function at address: 0x1800643a0
Called functions addresses: 0x1800652a0 0x180063974


ulonglong FUN_1800643a0(longlong param_1,undefined2 *param_2)

{
undefined2 uVar1;
DWORD DVar2;
uint uVar3;
ulonglong uVar4;
undefined4 extraout_var;

if (param_2 == (undefined2 *)0x0) {
uVar4 = 0x57;
}
else {
if (((*(char *)(*(longlong *)(param_1 + 0x48) + 0x4e) == '\0') ||
(*(char *)(*(longlong *)(param_1 + 0x48) + 0x4f) != '\0')) &&
(uVar4 = FUN_1800652a0(param_1), (int)uVar4 != 0)) {
return uVar4;
}
if (((*(int *)(param_1 + 0x68) == 0) || (*(short *)(param_1 + 0x78) == 0)) ||
((*(int *)(param_1 + 100) == 0 || (*(longlong *)(param_1 + 0x70) == 0)))) {
uVar4 = 0x80090304;
}
else {
DVar2 = FUN_180063974(param_1);
uVar4 = CONCAT44(extraout_var,DVar2);
if (DVar2 == 0) {
uVar3 = *(ushort *)(param_1 + 0x8e) + 8;
if (uVar3 < 0x10000) {
uVar1 = (undefined2)uVar3;
*(undefined2 *)(param_1 + 0x8a) = uVar1;
*param_2 = uVar1;
uVar4 = 0;
}
else {
uVar4 = 0x54f;
}
}
}
}
return uVar4;
}
=========================================
Function at address: 0x180064440
Called functions addresses: 0x180064928 0x180065144 0x18002a7c0 0x180063920 0x180065254 0x180064ebc 0x180064c60


ulonglong FUN_180064440(undefined8 *param_1)

{
ushort uVar1;
ushort uVar2;
int iVar3;
undefined4 extraout_var;
ulonglong uVar4;
undefined8 *puVar5;
int iVar6;
uint uVar7;

iVar6 = 0;
iVar3 = FUN_180065144((longlong)param_1);
uVar4 = CONCAT44(extraout_var,iVar3);
if (iVar3 == 0) {
if (*(ushort *)((longlong)param_1 + 0xa2) != 0) {
iVar6 = *(ushort *)((longlong)param_1 + 0xa2) + 4;
}
if (*(longlong *)(param_1[1] + 0x50) == 0) {
uVar4 = 0x80090304;
}
else {
if ((*(uint *)(*(longlong *)(param_1[1] + 0x50) + 0xa0) & 0x700) != 0) {

if ((int)uVar4 != 0) {
return uVar4;
}
if (*(ushort *)(param_1 + 0x13) != 0) {
iVar6 = iVar6 + *(ushort *)(param_1 + 0x13) + 4;
}
}
uVar4 = FUN_180065254((longlong)param_1);
if ((int)uVar4 == 0) {
if ((ushort)(*(short *)((longlong)param_1 + 0x7e) - 1U) < 0x10) {
uVar1 = (*(short *)((longlong)param_1 + 0x7e) + 1) * 2;
*(ushort *)((longlong)param_1 + 0x7c) = uVar1;
if ((ushort)(*(short *)(param_1[1] + 0x398) - 1U) < 0x7ffe) {
uVar2 = (*(short *)(param_1[1] + 0x398) + 1) * 2;
*(ushort *)((longlong)param_1 + 0x2a) = uVar2;
iVar3 = uVar2 + 0x10 + (uint)uVar1 + (uint)*(byte *)((longlong)param_1 + 0x36) + iVar6;
puVar5 = param_1;
uVar4 = FUN_180063920((longlong)param_1);
if ((int)uVar4 != 0) {
return uVar4;
}
if (*(ushort *)((longlong)param_1 + 0xa4) != 0) {
iVar3 = iVar3 + *(ushort *)((longlong)param_1 + 0xa4) + 4;
}
uVar4 = FUN_180064c60((longlong)puVar5);
if ((int)uVar4 != 0) {
return uVar4;
}
iVar3 = iVar3 + *(ushort *)((longlong)param_1 + 0x34) + 8;
if (DAT_1800927b8 == 0) {
iVar3 = iVar3 + 4;
*(undefined *)(param_1[1] + 0x540) = 1;
}
uVar1 = *(ushort *)(param_1 + 0xc);
iVar3 = iVar3 + 5;
if (uVar1 != 0) {
if (0xfffd < uVar1) {
return 0x57;
}
*(ushort *)((longlong)param_1 + 0x62) = uVar1 + 2;
}
if (*(short *)((longlong)param_1 + 0x62) != 0) {
iVar3 = iVar3 + *(ushort *)((longlong)param_1 + 0x62) + 4;
}
puVar5 = param_1;
uVar4 = FUN_180064928((longlong)param_1,1);
if ((int)uVar4 != 0) {
return uVar4;
}
*(undefined2 *)((longlong)param_1 + 0xa6) = 2;
uVar7 = iVar3 + *(ushort *)((longlong)param_1 + 0x7a) + 6;
uVar4 = FUN_180064ebc((longlong)puVar5);
if ((int)uVar4 != 0) {
return uVar4;
}
if (*(ushort *)((longlong)param_1 + 0x9c) != 0) {
uVar7 = uVar7 + *(ushort *)((longlong)param_1 + 0x9c) + 4;
}
if (uVar7 < 0x10000) {
*(short *)(param_1 + 5) = (short)uVar7;
return 0;
}
}
}
uVar4 = 0x54f;
}
}
}
return uVar4;
}
=========================================
Function at address: 0x18006463c
Called functions addresses: 0x180041cb0 0x180064440


ulonglong FUN_18006463c(undefined8 *param_1,longlong param_2,int param_3,short param_4,
undefined2 *param_5)

{
short sVar1;
ushort uVar2;
longlong lVar3;
ushort *puVar4;
ushort uVar5;
ulonglong uVar6;
ushort uVar7;
undefined2 uVar8;
uint uVar9;

lVar3 = param_1[1];
sVar1 = *(short *)(lVar3 + 0x398);
puVar4 = *(ushort **)(lVar3 + 0x390);
uVar2 = *(ushort *)(lVar3 + 0x72c);
*(undefined2 *)((longlong)param_1 + 0x2c) = 0;
if (((((param_2 == 0) || (0x7ffe < param_3 - 1U)) || (0xf < (ushort)(param_4 - 1U))) ||
((0x7ffd < (ushort)(sVar1 - 1U) || (puVar4 == (ushort *)0x0)))) ||
(param_5 == (undefined2 *)0x0)) {
uVar6 = 0x57;
}
else {
param_1[3] = param_2;
*(short *)(param_1 + 0x14) = (short)param_3;
*(short *)((longlong)param_1 + 0x7e) = param_4;
uVar5 = *puVar4;
if (*(int *)(lVar3 + 0x44) == 100) {
uVar7 = 0;
if (uVar5 != 0) {
do {
if (uVar2 == uVar5) {
*(ushort *)((longlong)param_1 + 0x2c) = uVar5;
break;
}
uVar7 = uVar7 + 1;
uVar5 = puVar4[uVar7];
} while (uVar7 < uVar5);
}
uVar5 = *(ushort *)((longlong)param_1 + 0x2c);
}
else {
*(ushort *)((longlong)param_1 + 0x2c) = uVar5;
}
if (uVar5 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1c,&DAT_180082c10);
}
uVar6 = 0x80090331;
}
else {
uVar6 = FUN_180064440(param_1);
if ((int)uVar6 == 0) {
uVar9 = *(ushort *)(param_1 + 5) + 0x2d +
(uint)*(byte *)(param_1[1] + 0x671) + (uint)*(ushort *)(param_1 + 0x14) * 2;
if (uVar9 < 0x10000) {
uVar8 = (undefined2)uVar9;
*(undefined2 *)(param_1 + 0x15) = uVar8;
uVar6 = 0;
*param_5 = uVar8;
}
else {
uVar6 = 0x54f;
}
}
}
}
return uVar6;
}
=========================================
Function at address: 0x1800647b0
Called functions addresses: 0x18006480c


undefined8 FUN_1800647b0(longlong param_1,undefined2 *param_2)

{
undefined2 uVar1;
uint uVar2;
undefined8 uVar3;

if (param_2 == (undefined2 *)0x0) {
uVar3 = 0x57;
}
else {
uVar3 = FUN_18006480c(param_1);
if ((int)uVar3 == 0) {
uVar2 = *(ushort *)(param_1 + 0xa4) + 6;
if (uVar2 < 0x10000) {
uVar1 = (undefined2)uVar2;
*(undefined2 *)(param_1 + 0xa2) = uVar1;
*param_2 = uVar1;
uVar3 = 0;
}
else {
uVar3 = 0x54f;
}
}
}
return uVar3;
}
=========================================
Function at address: 0x18006480c
Called functions addresses: 0x18002a7c0 0x1800649cc


undefined8 FUN_18006480c(longlong param_1)

{
int *piVar1;
undefined8 uVar2;
uint uVar3;

uVar3 = *(uint *)(*(longlong *)(param_1 + 8) + 0x88);
*(undefined2 *)(param_1 + 0xa6) = 0;
uVar3 = uVar3 >> 0x13 & 4;

if (((piVar1 != (int *)0x0) && (*piVar1 == 1)) && (piVar1[1] == 2)) {
*(ushort *)(param_1 + 0xa6) = *(byte *)(piVar1 + 2) + 3;
}
if (*(ushort *)(param_1 + 0xa6) != 0) {
uVar3 = uVar3 + *(ushort *)(param_1 + 0xa6) + 4;
}
uVar2 = FUN_1800649cc(param_1,8);
if ((int)uVar2 == 0) {
uVar3 = uVar3 + *(ushort *)(param_1 + 0x7a);
if (uVar3 < 0x10000) {
*(short *)(param_1 + 0xa4) = (short)uVar3;
uVar2 = 0;
}
else {
uVar2 = 0x54f;
}
}
return uVar2;
}
=========================================
Function at address: 0x1800648c8
Called functions addresses: 0x180059d04


undefined4 FUN_1800648c8(longlong param_1,short *param_2)

{
byte bVar1;
longlong lVar2;
short sVar3;
undefined4 uVar4;
undefined8 *puVar5;

if (param_2 == (short *)0x0) {
uVar4 = 0x57;
}
else {
lVar2 = *(longlong *)(*(longlong *)(param_1 + 8) + 8);
if (((lVar2 != 0) &&
(puVar5 = FUN_180059d04(*(int *)(lVar2 + 0x2c)), puVar5 != (undefined8 *)0x0)) &&
(*(uint *)((longlong)puVar5 + 0x1c) < 0x41)) {
bVar1 = *(byte *)((longlong)puVar5 + 0x1c);
*(byte *)(param_1 + 0x51) = bVar1;
sVar3 = bVar1 + 4;
*(short *)(param_1 + 0x52) = sVar3;
*param_2 = sVar3;
return 0;
}
uVar4 = 0x54f;
}
return uVar4;
}
=========================================
Function at address: 0x180064928
Called functions addresses: None


undefined8 FUN_180064928(longlong param_1,uint param_2)

{
longlong *plVar1;
byte bVar2;
longlong lVar3;
ushort uVar4;
longlong *plVar5;

*(undefined2 *)(param_1 + 0x7a) = 0;
plVar5 = (longlong *)(*(longlong *)(param_1 + 8) + 0x5c8);
if ((plVar5 != (longlong *)0x0) &&
(bVar2 = *(byte *)(*(longlong *)(param_1 + 8) + 0x5d0), bVar2 != 0)) {
plVar1 = plVar5 + bVar2;
for (; plVar5 < plVar1; plVar5 = plVar5 + 1) {
lVar3 = *plVar5;
if (lVar3 == 0) {
return 0x80090304;
}
if (*(ushort *)(lVar3 + 2) == param_2) {
if (0xfffb < *(ushort *)(param_1 + 0x7a)) {
return 0x8009035d;
}
uVar4 = *(ushort *)(param_1 + 0x7a) + 4;
*(ushort *)(param_1 + 0x7a) = uVar4;
if ((int)(0xffff - (uint)*(ushort *)(lVar3 + 8)) < (int)(uint)uVar4) {
return 0x8009035d;
}
*(ushort *)(param_1 + 0x7a) = uVar4 + *(ushort *)(lVar3 + 8);
}
}
}
return 0;
}
=========================================
Function at address: 0x1800649cc
Called functions addresses: None


undefined8 FUN_1800649cc(longlong param_1,uint param_2)

{
longlong *plVar1;
byte bVar2;
longlong lVar3;
ushort uVar4;
longlong *plVar5;

*(undefined2 *)(param_1 + 0x7a) = 0;
plVar5 = (longlong *)(*(longlong *)(param_1 + 8) + 0x458);
if ((plVar5 != (longlong *)0x0) &&
(bVar2 = *(byte *)(*(longlong *)(param_1 + 8) + 0x460), bVar2 != 0)) {
plVar1 = plVar5 + bVar2;
for (; plVar5 < plVar1; plVar5 = plVar5 + 1) {
lVar3 = *plVar5;
if (lVar3 == 0) {
return 0x80090304;
}
if (*(ushort *)(lVar3 + 2) == param_2) {
if (0xfffb < *(ushort *)(param_1 + 0x7a)) {
return 0x8009035d;
}
uVar4 = *(ushort *)(param_1 + 0x7a) + 4;
*(ushort *)(param_1 + 0x7a) = uVar4;
if ((int)(0xffff - (uint)*(ushort *)(lVar3 + 8)) < (int)(uint)uVar4) {
return 0x8009035d;
}
*(ushort *)(param_1 + 0x7a) = uVar4 + *(ushort *)(lVar3 + 8);
}
}
}
return 0;
}
=========================================
Function at address: 0x180064a70
Called functions addresses: 0x180041cdc 0xEXTERNAL:00000117 0x18006a430 0x180009ed4 0x180061ddc


ulonglong FUN_180064a70(longlong param_1,short *param_2)

{
longlong *plVar1;
uint uVar2;
ulonglong uVar3;
ulonglong uVar4;
longlong lVar5;
undefined2 uVar6;
uint uVar7;
short sVar8;
uint local_res10 [2];
longlong local_res18;

if (param_2 == (short *)0x0) {
return 0x57;
}
lVar5 = *(longlong *)(param_1 + 8);
if ((*(int *)(lVar5 + 0x44) == 0x28) && (DAT_1800927a0 != 0)) {
*param_2 = 0;
LAB_180064aac:
uVar3 = 0;
}
else {
local_res18 = *(longlong *)(lVar5 + 0x70);
if (local_res18 == 0) {
uVar2 = SslCreateEphemeralKey
(*(undefined8 *)(param_1 + 0x18),&local_res18,*(undefined2 *)(lVar5 + 0x22),
0x1302,*(undefined2 *)(param_1 + 0x2c),0,0,0,0);
uVar3 = (ulonglong)uVar2;
if (uVar2 == 0) {
lVar5 = *(longlong *)(param_1 + 8);
FUN_18006a430(lVar5,local_res18);
goto LAB_180064b5b;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar3;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return uVar3;
}
uVar6 = 10;
}
else {
LAB_180064b5b:
plVar1 = (longlong *)(param_1 + 0x38);
if (*plVar1 == 0) {
lVar5 = *(longlong *)(param_1 + 0x18);
local_res10[0] = 0;
uVar2 = FUN_180009ed4(lVar5,local_res18,L"ECCPUBLICBLOB",local_res10,plVar1);
uVar3 = (ulonglong)uVar2;
if (uVar2 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar3;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return uVar3;
}
uVar6 = 0xb;
goto LAB_180064b28;
}
}
local_res10[0] = 0;
uVar4 = FUN_180061ddc(lVar5,(uint)*(ushort *)(param_1 + 0x2c),local_res10);
uVar3 = uVar4 & 0xffffffff;
if ((int)uVar4 == 0) {
lVar5 = *plVar1;
if (lVar5 == 0) {
return 0x54f;
}
if ((local_res10[0] & 8) == 0) {
*(undefined *)(param_1 + 0x2e) = 1;
uVar7 = 0xfffa;
sVar8 = 5;
uVar2 = *(int *)(lVar5 + 4) * 2;
}
else {
*(undefined *)(param_1 + 0x2e) = 0;
uVar7 = 0xfffb;
uVar2 = *(uint *)(lVar5 + 4);
sVar8 = 4;
}
if (uVar7 < uVar2) {
return 0x54f;
}
*(uint *)(param_1 + 0x30) = uVar2 & 0xffff;
*param_2 = (short)uVar2 + sVar8;
goto LAB_180064aac;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar3;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return uVar3;
}
uVar6 = 0xc;
}
LAB_180064b28:
FUN_180041cdc(DAT_180091000[2],uVar6,&DAT_180082c10,(int)uVar3);
}
return uVar3;
}
=========================================
Function at address: 0x180064c60
Called functions addresses: 0x180041cdc 0x180064a70


ulonglong FUN_180064c60(longlong param_1)

{
ulonglong uVar1;
ulonglong uVar2;
ushort local_res10 [4];

local_res10[0] = 0;
uVar1 = FUN_180064a70(param_1,(short *)local_res10);
uVar2 = uVar1 & 0xffffffff;
if ((int)uVar1 == 0) {
if (local_res10[0] < 0xfffe) {
*(ushort *)(param_1 + 0x34) = local_res10[0] + 2;
uVar2 = 0;
}
else {
uVar2 = 0x54f;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x17,&DAT_180082c10,(int)uVar1);
}
return uVar2;
}
=========================================
Function at address: 0x180064cf4
Called functions addresses: 0x180041cdc 0x180062db4 0x18002a7c0 0x18000eb9c 0x18000a1f4 0xEXTERNAL:000000c0 0x18000909c 0xEXTERNAL:000000bc


ulonglong FUN_180064cf4(longlong param_1,undefined2 *param_2)

{
ushort *puVar1;
ulonglong *puVar2;
longlong lVar3;
int extraout_EAX;
uint uVar4;
PUCHAR pUVar5;
ulonglong uVar6;
ulonglong uVar7;
longlong local_res8;

if ((*(longlong *)(param_1 + 0xc0) == 0) && (puVar1 = (ushort *)(param_1 + 200), *puVar1 == 0)) {
pUVar5 = (PUCHAR)FUN_18000a1f4(0x20);
if (pUVar5 == (PUCHAR)0x0) {
return 0xe;
}
uVar6 = FUN_18000eb9c(pUVar5,0x20);
uVar7 = uVar6 & 0xffffffff;
if ((int)uVar6 == 0) {
local_res8 = 0;

if (local_res8 != 0) {
RtlAcquireResourceExclusive(local_res8 + 0x48,1);
lVar3 = local_res8;
if (*(HLOCAL *)(local_res8 + 200) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(local_res8 + 200));
}
*(undefined *)(lVar3 + 0xd0) = 0x20;
*(PUCHAR *)(lVar3 + 200) = pUVar5;
*(undefined2 *)(local_res8 + 0xee) = 0x20;
RtlReleaseResource(local_res8 + 0x48);
if ((*(uint *)(*(longlong **)(param_1 + 8) + 0x11) >> 0xb & 1) != 0) {
FUN_180062db4(*(longlong **)(param_1 + 8),(longlong *)(param_1 + 0xc0),(short *)puVar1);
if (extraout_EAX == 0) {
puVar2 = (ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
*puVar2 = *puVar2 | 0x400000;
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x24,&DAT_180082c10,extraout_EAX);
}
}
if (*puVar1 == 0) {
uVar4 = 0x51;
LAB_180064ea4:
*(short *)(param_1 + 0xac) = (short)uVar4;
*param_2 = (short)uVar4;
return 0;
}
uVar4 = *puVar1 + 0x31;
if (uVar4 < 0x10000) goto LAB_180064ea4;
goto LAB_180064e7c;
}
uVar7 = 0x54f;
}
FUN_18000909c(pUVar5);
}
else {
LAB_180064e7c:
uVar7 = 0x54f;
}
return uVar7;
}
=========================================
Function at address: 0x180064ebc
Called functions addresses: 0x18002a7c0 0xEXTERNAL:000000c2 0x18005d5d4 0xEXTERNAL:000000c0


undefined8 FUN_180064ebc(longlong param_1)

{
undefined8 uVar1;
uint uVar2;
byte local_res8 [8];
longlong local_res10;

*(undefined2 *)(param_1 + 0x9c) = 0;
local_res10 = 0;
local_res8[0] = 0;

if (local_res10 == 0) {
return 0x80090304;
}
RtlAcquireResourceShared(local_res10 + 0x48,1);
uVar2 = *(uint *)(local_res10 + 0x1b0);
uVar1 = FUN_18005d5d4(local_res10,local_res8,(undefined4 *)0x0);
RtlReleaseResource(local_res10 + 0x48);
if (uVar2 == 0) {
LAB_180064f5a:
uVar1 = 0;
}
else {
if (((int)uVar1 == 0) && ((byte)(local_res8[0] - 1) < 0x40)) {
if (0xffff < uVar2) {
return 0x80090308;
}
uVar2 = local_res8[0] + 0xb + uVar2;
if (uVar2 < 0xfffc) {
*(short *)(param_1 + 0x9c) = (short)uVar2;
goto LAB_180064f5a;
}
}
uVar1 = 0x54f;
}
return uVar1;
}
=========================================
Function at address: 0x180064fb0
Called functions addresses: 0x180041cdc 0x180064a70 0x1800649cc


ulonglong FUN_180064fb0(longlong param_1)

{
ulonglong uVar1;
ulonglong uVar2;
int iVar3;
uint uVar4;
ushort uVar5;
ushort local_res10 [4];

local_res10[0] = 0;
uVar1 = FUN_180064a70(param_1,(short *)local_res10);
uVar2 = uVar1 & 0xffffffff;
if ((int)uVar1 == 0) {
*(ushort *)(param_1 + 0x34) = local_res10[0];
*(undefined *)(param_1 + 0x36) = 2;
iVar3 = local_res10[0] + 10;
uVar1 = *(ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
uVar5 = ~-(ushort)((uVar1 & 0x8000) != 0) & 2;
*(ushort *)(param_1 + 0x9c) = uVar5;
if ((uVar1 & 0x8000) == 0) {
iVar3 = local_res10[0] + 0xe + (uint)uVar5;
}
uVar2 = FUN_1800649cc(param_1,2);
if ((int)uVar2 == 0) {
uVar4 = iVar3 + (uint)*(ushort *)(param_1 + 0x7a);
if (uVar4 < 0x10000) {
*(short *)(param_1 + 0x28) = (short)uVar4;
uVar2 = 0;
}
else {
uVar2 = 0x54f;
}
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x20,&DAT_180082c10,(int)uVar1);
}
return uVar2;
}
=========================================
Function at address: 0x180065098
Called functions addresses: 0x180064fb0 0x1800649cc


ulonglong FUN_180065098(longlong param_1,longlong param_2,char param_3,undefined2 *param_4)

{
ulonglong uVar1;
longlong lVar2;
undefined2 uVar3;
uint uVar4;

if ((param_2 == 0) || (param_4 == (undefined2 *)0x0)) {
return 0x57;
}
*(longlong *)(param_1 + 0x18) = param_2;
*(undefined2 *)(param_1 + 0x2c) = *(undefined2 *)(*(longlong *)(param_1 + 8) + 0x10);
if (param_3 == '\0') {
*(undefined2 *)(param_1 + 0x34) = 2;
*(undefined *)(param_1 + 0x36) = 2;
lVar2 = param_1;
uVar1 = FUN_1800649cc(param_1,2);
if ((int)uVar1 != 0) {
return uVar1;
}
uVar4 = *(ushort *)(lVar2 + 0x7a) + 0xc;
if (0xffff < uVar4) {
return 0x54f;
}
*(short *)(lVar2 + 0x28) = (short)uVar4;
}
else {
uVar1 = FUN_180064fb0(param_1);
if ((int)uVar1 != 0) {
return uVar1;
}
}
uVar4 = *(ushort *)(param_1 + 0x28) + 0x2c + (uint)*(byte *)(*(longlong *)(param_1 + 8) + 0x501);
if (0xffff < uVar4) {
return 0x54f;
}
uVar3 = (undefined2)uVar4;
*(undefined2 *)(param_1 + 0xa0) = uVar3;
*param_4 = uVar3;
return 0;
}
=========================================
Function at address: 0x180065144
Called functions addresses: 0x1800098e4 0x180041cb0 0x18002a7c0


int FUN_180065144(longlong param_1)

{
longlong lVar1;
int iVar2;
wchar_t *pwVar3;
longlong lVar4;

lVar1 = *(longlong *)(param_1 + 0x10);
*(undefined2 *)(param_1 + 0xa2) = 0;

iVar2 = FUN_1800098e4(lVar1,pwVar3);
if (iVar2 == 0) {
lVar1 = *(longlong *)(*(longlong *)(param_1 + 0x10) + 0x28);
if (lVar1 != 0) {
lVar4 = -1;
do {
lVar4 = lVar4 + 1;
} while (*(char *)(lVar1 + lVar4) != '\0');
if ((short)lVar4 != 0) {
*(short *)(param_1 + 0xa2) = (short)lVar4 + 5;
}
}
iVar2 = 0;
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x18,&DAT_180082c10);
}
return iVar2;
}
=========================================
Function at address: 0x180065210
Called functions addresses: None


undefined8 FUN_180065210(longlong param_1)

{
longlong lVar1;

*(undefined2 *)(param_1 + 0x98) = 0;
lVar1 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x5e8);
if (lVar1 != 0) {
if (0xfff7 < *(uint *)(lVar1 + 0x10)) {
return 0x57;
}
*(short *)(param_1 + 0x98) = *(short *)(lVar1 + 0x10) + 4;
}
return 0;
}
=========================================
Function at address: 0x180065254
Called functions addresses: None


undefined8 FUN_180065254(longlong param_1)

{
byte bVar1;
uint *puVar2;

puVar2 = &DAT_180082be8;
*(undefined *)(param_1 + 0x36) = 0;
do {
bVar1 = *(byte *)(param_1 + 0x36);
if ((*puVar2 & *(uint *)(*(longlong *)(param_1 + 8) + 0x40)) != 0) {
bVar1 = bVar1 + 2;
*(byte *)(param_1 + 0x36) = bVar1;
}
puVar2 = puVar2 + 2;
} while (puVar2 < &DAT_180082c10);
if (bVar1 < 2) {
return 0x57;
}
*(byte *)(param_1 + 0x36) = bVar1 + 1;
return 0;
}
=========================================
Function at address: 0x1800652a0
Called functions addresses: 0x18005e400 0x1800051c0 0x180065360


undefined8 FUN_1800652a0(longlong param_1)

{
ushort uVar1;
undefined8 uVar2;
longlong lVar3;

if (*(longlong *)(param_1 + 0x48) == 0) {
uVar2 = 0x57;
}
else {
lVar3 = *(longlong *)(param_1 + 8) + 0x1fe;
if (lVar3 == 0) {
uVar2 = 0x54f;
}
else {
uVar2 = FUN_180065360(param_1,*(longlong *)(*(longlong *)(param_1 + 0x48) + 0x20));
if ((int)uVar2 == 0) {
uVar1 = FUN_18005e400(lVar3,*(uint *)(param_1 + 0x68),
*(uint *)(*(longlong *)(param_1 + 0x48) + 0x1ac),
*(uint *)(*(longlong *)(param_1 + 8) + 0x40),
*(uint *)(*(longlong *)(param_1 + 0x48) + 0x8c));
uVar1 = uVar1 >> 8 | uVar1 << 8;
*(ushort *)(param_1 + 0x78) = uVar1;
if (uVar1 == 0) {
uVar2 = 0x80090331;
}
else {
FUN_1800051c0(uVar1,(undefined4 *)0x0,(undefined4 *)(param_1 + 100),(undefined4 *)0x0,
(undefined8 *)(param_1 + 0x70),(uint *)0x0,(undefined4 *)0x0);
uVar2 = 0;
}
}
}
}
return uVar2;
}
=========================================
Function at address: 0x180065360
Called functions addresses: 0x180054200


undefined8 FUN_180065360(longlong param_1,longlong param_2)

{
undefined4 uVar1;
undefined8 uVar2;
int local_res10 [6];

if (param_2 == 0) {
uVar2 = 0x57;
}
else {
local_res10[0] = 0;
uVar2 = FUN_180054200(param_2,local_res10);
if ((int)uVar2 == 0) {
if (local_res10[0] == 0x2203) {
uVar1 = 3;
}
else {
if (local_res10[0] != 0xa400) {
return 0x54f;
}
uVar1 = 1;
}
*(undefined4 *)(param_1 + 0x68) = uVar1;
uVar2 = 0;
}
}
return uVar2;
}
=========================================
Function at address: 0x1800653c8
Called functions addresses: 0x180041cdc 0x18002a7c0 0x18000ad34 0x180067098


undefined8 FUN_1800653c8(longlong param_1)

{
ulonglong *puVar1;
longlong lVar2;
undefined8 uVar3;
ushort uVar4;
ushort local_res8 [4];

if (((*(ushort *)(param_1 + 0xa4) != 0) &&
(lVar2 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x310), lVar2 != 0)) && (lVar2 + 6 != 0))
{
uVar3 = FUN_180067098(param_1,0x10,*(ushort *)(param_1 + 0xa4));
if ((int)uVar3 != 0) {
return uVar3;
}
uVar4 = *(short *)(param_1 + 0xa4) - 2;
if (uVar4 != *(ushort *)(lVar2 + 4)) {
return 0x57;
}
local_res8[0] = uVar4 >> 8 | uVar4 * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if ((int)uVar3 != 0) {
return uVar3;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x19,&DAT_180082c10,(uint)local_res8[0]);
}

(*(undefined8 *)(param_1 + 0x20),uVar4,lVar2 + 6);
if ((int)uVar3 != 0) {
return uVar3;
}
puVar1 = (ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
*puVar1 = *puVar1 | 0x4000000;
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0x10);
}
return 0;
}
=========================================
Function at address: 0x180065504
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000011c 0xEXTERNAL:00000119 0x1800634e0 0x18002a7c0 0x180028d90 0xEXTERNAL:000000c2 0x18006b1a8 0x18005d5d4 0xEXTERNAL:000000c0 0x180028070 0xEXTERNAL:000000f6


void FUN_180065504(longlong param_1)

{
longlong lVar1;
longlong lVar2;
longlong *plVar3;
uint uVar4;
ushort uVar5;
int iVar6;
int iVar7;
undefined8 uVar8;
longlong lVar9;
undefined auStackY_e8 [32];
undefined local_98 [4];
ushort local_94 [2];
uint local_90 [2];
longlong local_88 [2];
undefined local_78 [64];
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_e8;
local_88[0] = 0;
lVar1 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x58);
if (lVar1 == 0) goto LAB_1800655c4;
RtlAcquireResourceShared(lVar1 + 0x48);
memset(local_78,0,0x40);
local_90[0] = 0;
uVar8 = FUN_18005d5d4(lVar1,(undefined *)local_90,(undefined4 *)0x0);
uVar4 = local_90[0];
if (((int)uVar8 == 0) && (local_90[0] < 0x41)) {
lVar2 = *(longlong *)(param_1 + 8);
plVar3 = *(longlong **)(lVar1 + 0xb0);
uVar5 = *(ushort *)(lVar2 + 0x22);
if (plVar3 == (longlong *)0x0) {
iVar7 = 0;
lVar9 = 0;
}
else {
iVar7 = *(int *)((longlong)plVar3 + 0x1c);
lVar9 = *plVar3;
}
if (*(int *)(lVar2 + 0x44) == 100) {

iVar6 = SslDuplicateTranscriptHash(lVar9,uVar8,local_88,0);
}
else {
iVar6 = SslCreateHandshakeHash(lVar9,local_88,uVar5,iVar7);
}
if (iVar6 != 0) goto LAB_18006559d;
uVar8 = FUN_1800634e0(*(longlong *)(param_1 + 0x20),local_88[0]);
if ((int)uVar8 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1a,&DAT_180082c10,(int)uVar8);
}
goto LAB_18006559d;
}
iVar7 = FUN_18006b1a8(*(longlong *)(param_1 + 8) + 0x558,lVar9,*(longlong *)(lVar1 + 0x10),
local_88[0],uVar5,iVar7,*(undefined8 *)(lVar1 + 200),
(uint)*(byte *)(lVar1 + 0xd0),(longlong)local_78,uVar4);
RtlReleaseResource(lVar1 + 0x48);
if (iVar7 == 0) {
uVar5 = ((ushort)uVar4 & 0xff) + 1;
local_98[0] = (undefined)uVar4;
local_94[0] = uVar5 >> 8 | uVar5 * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_94);
if ((iVar7 == 0) &&

(*(undefined8 *)(param_1 + 0x20),1,local_98), iVar7 == 0)) {

(*(undefined8 *)(param_1 + 0x20),uVar4 & 0xffff,local_78);
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1b,&DAT_180082c10,iVar7);
}
}
else {
LAB_18006559d:
RtlReleaseResource(lVar1 + 0x48);
}
if (local_88[0] != 0) {
SslFreeObject(local_88[0],0);
}
LAB_1800655c4:
FUN_180028070(local_38 ^ (ulonglong)auStackY_e8);
return;
}
=========================================
Function at address: 0x18006581c
Called functions addresses: 0xEXTERNAL:00000169 0xEXTERNAL:00000165 0xEXTERNAL:00000167 0xEXTERNAL:00000114 0x180004510 0x18002a7c0 0xEXTERNAL:0000003b 0xEXTERNAL:00000166 0xEXTERNAL:00000171 0x18000a1f4 0x18002a77b 0x18000909c


NTSTATUS FUN_18006581c(longlong param_1,char param_2,int param_3,wchar_t *param_4,PUCHAR param_5,
uint param_6,uint *param_7)

{
undefined2 uVar1;
undefined8 *puVar2;
uint cbOutput;
uint *puVar3;
byte bVar4;
int iVar5;
NTSTATUS NVar6;
size_t sVar7;
undefined8 uVar8;
PUCHAR pbHashObject;
undefined8 uVar9;
char *pbInput;
uint local_res20 [2];
undefined8 in_stack_ffffffffffffff88;
undefined4 uVar10;
ULONG local_58 [2];
BCRYPT_HASH_HANDLE local_50;
BCRYPT_HANDLE local_48 [2];

uVar10 = (undefined4)((ulonglong)in_stack_ffffffffffffff88 >> 0x20);
if (param_4 == (wchar_t *)0x0) {
bVar4 = 0;
}
else {
sVar7 = wcsnlen(param_4,0x40);
bVar4 = (byte)sVar7;
if (0x3f < (byte)sVar7) {
return 0x57;
}
}
puVar3 = param_7;
if (param_7 == (uint *)0x0) {
return 0x57;
}
if (bVar4 != 0) {
bVar4 = (bVar4 + 1) * '\x02';
}
*param_7 = bVar4 + 0x40;
if ((param_5 == (PUCHAR)0x0) || (param_6 < bVar4 + 0x40)) {
return 0x7a;
}
*param_7 = 0;
if (param_4 != (wchar_t *)0x0) {
memcpy(param_5,param_4,(ulonglong)bVar4);
param_5 = param_5 + bVar4;
*puVar3 = (uint)bVar4;
}
local_58[0] = 0;
uVar1 = *(undefined2 *)(*(longlong *)(param_1 + 8) + 0x22);

uVar9 = 0;
puVar2 = *(undefined8 **)(*(longlong *)(param_1 + 8) + 8);
if (puVar2 != (undefined8 *)0x0) {
uVar9 = *puVar2;
}
iVar5 = SslComputeSessionHash(uVar9,uVar8,uVar1,param_5,CONCAT44(uVar10,0x40),local_58,0);
if (iVar5 != 0) {
return iVar5;
}
local_48[0] = (BCRYPT_HANDLE)0x0;
NVar6 = FUN_180004510(param_3,(longlong *)local_48,&param_6);
cbOutput = param_6;
if (NVar6 != 0) {
return NVar6;
}
if (param_6 < 0x41) {
local_res20[0] = 0;
local_58[1] = 0;
NVar6 = BCryptGetProperty(local_48[0],L"ObjectLength",(PUCHAR)local_res20,4,local_58 + 1,0);
if (NVar6 != 0) {
return NVar6;
}
pbHashObject = (PUCHAR)FUN_18000a1f4((ulonglong)local_res20[0]);
if (pbHashObject != (PUCHAR)0x0) {
local_50 = (BCRYPT_HASH_HANDLE)0x0;
NVar6 = BCryptCreateHash(local_48[0],&local_50,pbHashObject,local_res20[0],(PUCHAR)0x0,0,0);
if ((NVar6 == 0) &&
(NVar6 = BCryptHashData(local_50,(PUCHAR)
"                                                                TLS 1.3, "
,0x49,0), NVar6 == 0)) {
pbInput = "server";
if (param_2 == '\0') {
pbInput = "client";
}
NVar6 = BCryptHashData(local_50,(PUCHAR)pbInput,6,0);
if ((((NVar6 == 0) &&
(NVar6 = BCryptHashData(local_50,(PUCHAR)" CertificateVerify",0x13,0), NVar6 == 0)) &&
(NVar6 = BCryptHashData(local_50,param_5,local_58[0],0), NVar6 == 0)) &&
(NVar6 = BCryptFinishHash(local_50,param_5,cbOutput,0), NVar6 == 0)) {
*puVar3 = *puVar3 + cbOutput;
}
}
if (local_50 != (BCRYPT_HASH_HANDLE)0x0) {
BCryptDestroyHash(local_50);
}
FUN_18000909c(pbHashObject);
return NVar6;
}
return 0xe;
}
return 0x54f;
}
=========================================
Function at address: 0x180065af8
Called functions addresses: 0x180001e7c 0xEXTERNAL:00000116 0xEXTERNAL:00000132 0xEXTERNAL:00000041 0x18006581c 0x180028070 0x18002a77b 0xEXTERNAL:00000109 0x180028d90 0xEXTERNAL:00000047 0x180001604 0x18000a1f4 0x18000909c


void FUN_180065af8(longlong param_1)

{
ushort uVar1;
longlong lVar2;
longlong lVar3;
void *_Src;
NTSTATUS NVar4;
int iVar5;
BOOL BVar6;
wchar_t *pwVar7;
wchar_t *pbEncoded;
wchar_t *pwVar8;
uint uVar9;
wchar_t *pwVar10;
wchar_t *pwVar11;
uint uVar12;
undefined auStackY_168 [32];
uint local_128;
DWORD local_124;
int local_120 [2];
undefined8 local_118;
wchar_t *pwStack_110;
uint local_108;
PBYTE local_100;
UCHAR local_f8 [192];
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_168;
pwVar10 = (wchar_t *)0x0;
uVar9 = 0;
pwVar11 = (wchar_t *)0x0;
local_120[0] = 0;
pwVar8 = (wchar_t *)0x0;
pbEncoded = pwVar10;
pwVar7 = pwVar10;
if ((((*(short *)(param_1 + 0x8c) == 0) ||
(pbEncoded = pwVar8, pwVar7 = pwVar11, *(short *)(param_1 + 0x8e) == 0)) ||
(lVar2 = *(longlong *)(param_1 + 8), lVar2 == 0)) ||
(lVar3 = *(longlong *)(param_1 + 0x48), lVar3 == 0)) goto LAB_180065e76;
local_124 = 0;
if ((*(char *)(lVar3 + 0x4e) == '\0') || (*(char *)(lVar3 + 0x4f) != '\0')) {
memset(local_f8,0,0xc0);
local_128 = 0;
if ((*(int *)(param_1 + 0x68) == 1) &&
(uVar12 = *(uint *)(lVar2 + 0x40), (uVar12 & 0x40051555) != 0)) {
pwVar7 = *(wchar_t **)(param_1 + 0x70);
}
else {
uVar12 = *(uint *)(lVar2 + 0x40);
pwVar7 = pwVar10;
}
NVar4 = FUN_18006581c(param_1,(uVar12 & 0x40051555) != 0,*(int *)(param_1 + 100),pwVar7,local_f8
,0xc0,&local_128);
if ((NVar4 != 0) ||
(pwVar7 = (wchar_t *)FUN_18000a1f4((ulonglong)*(ushort *)(param_1 + 0x8c)),
pwVar7 == (wchar_t *)0x0)) goto LAB_180065ea3;
iVar5 = FUN_180001604(*(longlong *)(*(longlong *)(*(longlong *)(param_1 + 8) + 0x50) + 0x2f0),
local_120);
if (iVar5 == 0) {
lVar2 = *(longlong *)(param_1 + 8);
if ((*(uint *)(lVar2 + 0x40) & 0x40051555) == 0) {
local_118 = 0;
pwStack_110 = (wchar_t *)0x0;
pwVar8 = pwVar10;
if (*(int *)(param_1 + 0x68) == 1) {
local_118 = *(undefined8 *)(param_1 + 0x70);
pwVar8 = (wchar_t *)&local_118;
uVar9 = 8;
pwStack_110 = (wchar_t *)(ulonglong)local_128;
}
iVar5 = NCryptSignHash(*(NCRYPT_KEY_HANDLE *)(*(longlong *)(param_1 + 0x48) + 0x68),pwVar8,
local_f8,local_128,(PBYTE)pwVar7,(uint)*(ushort *)(param_1 + 0x8c),
&local_124,uVar9 | 0x40);
}
else {
if (*(longlong *)(lVar2 + 0x18) == 0) goto LAB_180065e76;
pwVar8 = pwVar10;
if (*(undefined8 **)(lVar2 + 8) != (undefined8 *)0x0) {
pwVar8 = (wchar_t *)**(undefined8 **)(lVar2 + 8);
}
iVar5 = SslSignHash(pwVar8,*(undefined8 *)(*(longlong *)(lVar2 + 0x18) + 8),local_f8,
local_128);
}
if (iVar5 == 0) goto LAB_180065d80;
}
}
else {
uVar1 = *(ushort *)(lVar2 + 0x3b0);
*(ushort *)(param_1 + 0x8c) = uVar1;
if (((uVar1 == 0) || (_Src = *(void **)(lVar2 + 0x3a8), _Src == (void *)0x0)) ||
(pwVar7 = (wchar_t *)FUN_18000a1f4((ulonglong)uVar1), pwVar7 == (wchar_t *)0x0))
goto LAB_180065ea3;
memcpy(pwVar7,_Src,(ulonglong)*(ushort *)(param_1 + 0x8c));
local_124 = (DWORD)*(ushort *)(param_1 + 0x8c);
LAB_180065d80:
if (*(int *)(param_1 + 0x68) == 1) {
if (local_124 < 0x10000) {
*(short *)(param_1 + 0x8e) = (short)local_124;
pbEncoded = pwVar7;
LAB_180065e65:
*(wchar_t **)(param_1 + 0x90) = pbEncoded;
pbEncoded = (wchar_t *)0x0;
pwVar7 = pwVar10;
}
}
else if (*(int *)(param_1 + 0x68) == 3) {
uVar12 = local_124 >> 1;
uVar9 = uVar12;
FUN_180001e7c((undefined *)pwVar7,uVar12);
FUN_180001e7c((PBYTE)((ulonglong)uVar12 + (longlong)pwVar7),uVar9);
local_118 = CONCAT44(local_118._4_4_,uVar12);
pwStack_110 = pwVar7;
local_108 = uVar12;
local_100 = (PBYTE)((ulonglong)uVar12 + (longlong)pwVar7);
pbEncoded = (wchar_t *)FUN_18000a1f4((ulonglong)*(ushort *)(param_1 + 0x8e));
if (pbEncoded != (wchar_t *)0x0) {
local_128 = (uint)*(ushort *)(param_1 + 0x8e);
BVar6 = CryptEncodeObject(1,(LPCSTR)0x2f,&local_118,(BYTE *)pbEncoded,&local_128);
if (BVar6 == 0) {
GetLastError();
}
else {
uVar1 = *(ushort *)(param_1 + 0x8e);
if (local_128 <= uVar1) {
*(short *)(param_1 + 0x8e) = (short)local_128;
*(short *)(param_1 + 0x8a) = *(short *)(param_1 + 0x8a) + ((short)local_128 - uVar1);
pwVar10 = pwVar7;
goto LAB_180065e65;
}
}
}
}
}
LAB_180065e76:
if (local_120[0] != 0) {
RevertToSelf();
}
if (pbEncoded != (wchar_t *)0x0) {
FUN_18000909c(pbEncoded);
}
if (pwVar7 != (wchar_t *)0x0) {
FUN_18000909c(pwVar7);
}
LAB_180065ea3:
if ((*(char *)(*(longlong *)(param_1 + 0x48) + 0x4e) != '\0') &&
(*(char *)(*(longlong *)(param_1 + 0x48) + 0x4f) == '\0')) {
lVar2 = *(longlong *)(param_1 + 8);
if (*(HLOCAL *)(lVar2 + 0x3a8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(lVar2 + 0x3a8));
*(undefined8 *)(lVar2 + 0x3a8) = 0;
}
*(undefined4 *)(lVar2 + 0x3b0) = 0;
}
FUN_180028070(local_38 ^ (ulonglong)auStackY_168);
return;
}
=========================================
Function at address: 0x180065f08
Called functions addresses: 0x180041cb0 0x18002a7c0 0x180067098


undefined8 FUN_180065f08(longlong param_1)

{
undefined8 uVar1;
ushort local_res8 [4];

if ((*(longlong *)(param_1 + 0xb0) == 0) || (*(short *)(param_1 + 0xb8) == 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180082c10);
}
uVar1 = 0x57;
}
else {
uVar1 = FUN_180067098(param_1,0x2f,*(ushort *)(param_1 + 0xba));
if ((int)uVar1 == 0) {
local_res8[0] = *(ushort *)(param_1 + 0xb8) >> 8 | *(ushort *)(param_1 + 0xb8) << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if ((int)uVar1 == 0) {

(*(undefined8 *)(param_1 + 0x20),*(undefined2 *)(param_1 + 0xb8),
*(undefined8 *)(param_1 + 0xb0));
}
}
}
return uVar1;
}
=========================================
Function at address: 0x180065fec
Called functions addresses: 0x18002a7c0 0x180066274


undefined8 FUN_180065fec(longlong *param_1,longlong param_2,char param_3)

{
undefined8 uVar1;
longlong lVar2;
ushort uVar3;
undefined local_res10 [8];
ushort local_res20 [4];
undefined2 local_28 [8];

lVar2 = 0;
uVar3 = 0;
if (param_2 != 0) {
if (0xfffa < *(uint *)(param_2 + 0x10)) {
return 0x57;
}
uVar3 = *(ushort *)(param_2 + 0x10);
lVar2 = *(longlong *)(param_2 + 8);
}
if ((param_3 != '\0') &&
((int)(0xfffa - (uint)uVar3) < (int)(uint)*(ushort *)((longlong)param_1 + 0x9a))) {
return 0x57;
}
local_res10[0] = 0;

if ((int)uVar1 != 0) {
return uVar1;
}
local_res20[0] = uVar3 >> 8 | uVar3 << 8;

if ((int)uVar1 == 0) {
if ((lVar2 != 0) &&

(int)uVar1 != 0)) {
return uVar1;
}
if (param_3 == '\0') {
local_28[0] = 0;

return uVar1;
}
uVar1 = FUN_180066274(param_1);
return uVar1;
}
return uVar1;
}
=========================================
Function at address: 0x180066130
Called functions addresses: 0x18002a7c0 0x180066318


undefined8 FUN_180066130(longlong *param_1,longlong param_2,char param_3)

{
undefined8 uVar1;
longlong lVar2;
ushort uVar3;
undefined local_res10 [8];
ushort local_res20 [4];
undefined2 local_28 [8];

lVar2 = 0;
uVar3 = 0;
if (param_2 != 0) {
if (0xfffa < *(uint *)(param_2 + 0x10)) {
return 0x57;
}
uVar3 = *(ushort *)(param_2 + 0x10);
lVar2 = *(longlong *)(param_2 + 8);
}
if ((param_3 != '\0') &&
((int)(0xfffa - (uint)uVar3) < (int)(uint)*(ushort *)((longlong)param_1 + 0x9a))) {
return 0x57;
}
local_res10[0] = 0;

if ((int)uVar1 != 0) {
return uVar1;
}
local_res20[0] = uVar3 >> 8 | uVar3 << 8;

if ((int)uVar1 == 0) {
if ((lVar2 != 0) &&

(int)uVar1 != 0)) {
return uVar1;
}
if (param_3 == '\0') {
local_28[0] = 0;

return uVar1;
}
uVar1 = FUN_180066318(param_1);
return uVar1;
}
return uVar1;
}
=========================================
Function at address: 0x180066274
Called functions addresses: 0x1800673fc 0x18002a7c0


void FUN_180066274(longlong *param_1)

{
int iVar1;
ushort local_res8 [4];

local_res8[0] =
*(ushort *)((longlong)param_1 + 0x9a) >> 8 | *(ushort *)((longlong)param_1 + 0x9a) << 8;

if ((iVar1 == 0) && (*(short *)((longlong)param_1 + 0x9a) != 0)) {
if (((*(uint *)(param_1[1] + 0x40) & 0x40051555) != 0) &&
((*(short *)(param_1 + 0x13) != 0 &&

return;
}
FUN_1800673fc((longlong)param_1,0xb);
}
return;
}
=========================================
Function at address: 0x180066318
Called functions addresses: 0x18002a7c0 0x1800674c0


void FUN_180066318(longlong *param_1)

{
int iVar1;
ushort local_res8 [4];

local_res8[0] =
*(ushort *)((longlong)param_1 + 0x9a) >> 8 | *(ushort *)((longlong)param_1 + 0x9a) << 8;

if ((iVar1 == 0) && (*(short *)((longlong)param_1 + 0x9a) != 0)) {
if (((*(uint *)(param_1[1] + 0x40) & 0x40051555) != 0) &&
((*(short *)(param_1 + 0x13) != 0 &&

return;
}
FUN_1800674c0((longlong)param_1,0xb);
}
return;
}
=========================================
Function at address: 0x1800663bc
Called functions addresses: 0x18002a7c0 0x180065fec 0xEXTERNAL:00000147


ulonglong FUN_1800663bc(longlong *param_1)

{
longlong lVar1;
longlong lVar2;
DWORD *pDVar3;
BOOL BVar4;
ulonglong uVar5;
int iVar6;
ulonglong uVar7;
undefined local_res8 [8];
ushort local_res10 [4];

uVar7 = 0;
local_res8[0] = 0;

if ((int)uVar5 != 0) {
return uVar5;
}
local_res10[0] = *(ushort *)(param_1 + 8) >> 8 | *(ushort *)(param_1 + 8) << 8;

if ((int)uVar5 != 0) {
return uVar5;
}
lVar1 = param_1[9];
if (lVar1 == 0) {
return (ulonglong)(-(uint)((*(uint *)(param_1[1] + 0x40) & 0x40051555) != 0) & 0x54f);
}
lVar2 = *(longlong *)(lVar1 + 0x40);
if (((lVar2 == 0) || (*(longlong **)(lVar2 + 0x10) == (longlong *)0x0)) ||
(*(int *)(lVar2 + 0xc) == 0)) {
if (*(longlong *)(lVar1 + 0x20) == 0) {
return 0x57;
}
uVar5 = FUN_180065fec(param_1,*(longlong *)(lVar1 + 0x20),'\x01');
if ((int)uVar5 != 0) {
return uVar5;
}
}
else {
lVar1 = **(longlong **)(lVar2 + 0x10);
if (((lVar1 == 0) || (*(longlong *)(lVar1 + 0x10) == 0)) || (*(int *)(lVar1 + 0xc) == 0)) {
return 0x57;
}
do {
iVar6 = (int)uVar7;
pDVar3 = *(DWORD **)(*(longlong *)(*(longlong *)(lVar1 + 0x10) + uVar7 * 8) + 8);
if (pDVar3 == (DWORD *)0x0) {
return 0x57;
}
lVar2 = *(longlong *)(pDVar3 + 6);
if (lVar2 == 0) {
return 0x57;
}
if (((*(char *)(param_1 + 10) == '\0') && (iVar6 != 0)) &&
(BVar4 = CertCompareCertificateName
(*pDVar3,(PCERT_NAME_BLOB)(lVar2 + 0x30),(PCERT_NAME_BLOB)(lVar2 + 0x50)
), BVar4 != 0)) {
return 0;
}
uVar5 = FUN_180065fec(param_1,(longlong)pDVar3,iVar6 == 0);
if ((int)uVar5 != 0) {
return uVar5;
}
uVar7 = (ulonglong)(iVar6 + 1U);
} while (iVar6 + 1U < *(uint *)(lVar1 + 0xc));
}
return 0;
}
=========================================
Function at address: 0x18006652c
Called functions addresses: 0x18002a7c0 0x180066130 0xEXTERNAL:00000147


ulonglong FUN_18006652c(longlong *param_1)

{
longlong lVar1;
longlong lVar2;
DWORD *pDVar3;
BOOL BVar4;
ulonglong uVar5;
int iVar6;
ulonglong uVar7;
undefined local_res8 [8];
ushort local_res10 [4];

uVar7 = 0;
local_res8[0] = 0;

if ((int)uVar5 != 0) {
return uVar5;
}
local_res10[0] = *(ushort *)(param_1 + 8) >> 8 | *(ushort *)(param_1 + 8) << 8;

if ((int)uVar5 != 0) {
return uVar5;
}
lVar1 = param_1[9];
if (lVar1 == 0) {
return (ulonglong)(-(uint)((*(uint *)(param_1[1] + 0x40) & 0x40051555) != 0) & 0x54f);
}
lVar2 = *(longlong *)(lVar1 + 0x40);
if (((lVar2 == 0) || (*(longlong **)(lVar2 + 0x10) == (longlong *)0x0)) ||
(*(int *)(lVar2 + 0xc) == 0)) {
if (*(longlong *)(lVar1 + 0x20) == 0) {
return 0x57;
}
uVar5 = FUN_180066130(param_1,*(longlong *)(lVar1 + 0x20),'\x01');
if ((int)uVar5 != 0) {
return uVar5;
}
}
else {
lVar1 = **(longlong **)(lVar2 + 0x10);
if (((lVar1 == 0) || (*(longlong *)(lVar1 + 0x10) == 0)) || (*(int *)(lVar1 + 0xc) == 0)) {
return 0x57;
}
do {
iVar6 = (int)uVar7;
pDVar3 = *(DWORD **)(*(longlong *)(*(longlong *)(lVar1 + 0x10) + uVar7 * 8) + 8);
if (pDVar3 == (DWORD *)0x0) {
return 0x57;
}
lVar2 = *(longlong *)(pDVar3 + 6);
if (lVar2 == 0) {
return 0x57;
}
if (((*(char *)(param_1 + 10) == '\0') && (iVar6 != 0)) &&
(BVar4 = CertCompareCertificateName
(*pDVar3,(PCERT_NAME_BLOB)(lVar2 + 0x30),(PCERT_NAME_BLOB)(lVar2 + 0x50)
), BVar4 != 0)) {
return 0;
}
uVar5 = FUN_180066130(param_1,(longlong)pDVar3,iVar6 == 0);
if ((int)uVar5 != 0) {
return uVar5;
}
uVar7 = (ulonglong)(iVar6 + 1U);
} while (iVar6 + 1U < *(uint *)(lVar1 + 0xc));
}
return 0;
}
=========================================
Function at address: 0x18006669c
Called functions addresses: 0x1800663bc 0x18002a7c0 0x1800675f4


ulonglong FUN_18006669c(longlong *param_1)

{
ulonglong uVar1;
char local_res8 [32];

uVar1 = FUN_1800675f4((longlong)param_1,0xb,*(ushort *)(param_1 + 0x11));
if ((int)uVar1 == 0) {
if ((*(uint *)(param_1[1] + 0x40) & 0x40051555) == 0) {
local_res8[0] = *(char *)(param_1[1] + 0x640);
}
else {
local_res8[0] = '\0';
}

if ((int)uVar1 == 0) {
if (local_res8[0] != '\0') {
if (*(longlong *)(param_1[1] + 0x638) == 0) {
return 0x80090304;
}

if ((int)uVar1 != 0) {
return uVar1;
}
}
uVar1 = FUN_1800663bc(param_1);
if ((int)uVar1 == 0) {

}
}
}
return uVar1;
}
=========================================
Function at address: 0x180066778
Called functions addresses: 0x18002a7c0 0x1800675f4 0x18006652c


ulonglong FUN_180066778(longlong *param_1)

{
ulonglong uVar1;
char local_res8 [32];

uVar1 = FUN_1800675f4((longlong)param_1,0xb,*(ushort *)(param_1 + 0x11));
if ((int)uVar1 == 0) {
if ((*(uint *)(param_1[1] + 0x40) & 0x40051555) == 0) {
local_res8[0] = *(char *)(param_1[1] + 0x4d0);
}
else {
local_res8[0] = '\0';
}

if ((int)uVar1 == 0) {
if (local_res8[0] != '\0') {
if (*(longlong *)(param_1[1] + 0x4c8) == 0) {
return 0x80090304;
}

if ((int)uVar1 != 0) {
return uVar1;
}
}
uVar1 = FUN_18006652c(param_1);
if ((int)uVar1 == 0) {

}
}
}
return uVar1;
}
=========================================
Function at address: 0x180066854
Called functions addresses: 0x180066920 0x18002a7c0 0x1800675f4


void FUN_180066854(longlong param_1)

{
int iVar1;
undefined8 uVar2;
char local_res8 [32];

uVar2 = FUN_1800675f4(param_1,0xd,*(ushort *)(param_1 + 0xaa));
if ((int)uVar2 == 0) {
local_res8[0] = *(char *)(*(longlong *)(param_1 + 8) + 0x4d0);

(*(undefined8 *)(param_1 + 0x20),1,local_res8);
if (iVar1 == 0) {
if ((local_res8[0] != '\0') &&

(*(undefined8 *)(param_1 + 0x20),local_res8[0],
*(undefined8 *)(*(longlong *)(param_1 + 8) + 0x4c8)), iVar1 != 0)) {
return;
}
iVar1 = FUN_180066920(param_1);
if (iVar1 == 0) {

}
}
}
return;
}
=========================================
Function at address: 0x180066920
Called functions addresses: 0x18002a7c0 0x180068414 0x180065f08 0x1800674c0


void FUN_180066920(longlong param_1)

{
int iVar1;
undefined8 uVar2;
ushort local_res8 [4];

local_res8[0] = *(ushort *)(param_1 + 0xa8) >> 8 | *(ushort *)(param_1 + 0xa8) << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if ((iVar1 == 0) && (iVar1 = FUN_180068414(param_1), iVar1 == 0)) {
if ((DAT_180092f08 != 0) &&
(((*(longlong *)(param_1 + 0xb0) != 0 && (*(short *)(param_1 + 0xb8) != 0)) &&
(uVar2 = FUN_180065f08(param_1), (int)uVar2 != 0)))) {
return;
}
FUN_1800674c0(param_1,0xd);
}
return;
}
=========================================
Function at address: 0x1800669bc
Called functions addresses: 0x18002a7c0 0x180065af8 0x1800675f4 0x18000909c


ulonglong FUN_1800669bc(longlong param_1)

{
uint uVar1;
ulonglong uVar2;
ulonglong uVar3;
ushort local_res8 [4];

uVar1 = FUN_180065af8(param_1);
uVar3 = (ulonglong)uVar1;
if (uVar1 == 0) {
uVar2 = FUN_1800675f4(param_1,0xf,*(ushort *)(param_1 + 0x8a));
uVar3 = uVar2 & 0xffffffff;
if ((int)uVar2 == 0) {
if (*(short *)(param_1 + 0x78) == 0) {
uVar3 = 0x54f;
}
else {

uVar3 = (ulonglong)uVar1;
if (uVar1 == 0) {
local_res8[0] = *(ushort *)(param_1 + 0x8e) >> 8 | *(ushort *)(param_1 + 0x8e) << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
uVar3 = (ulonglong)uVar1;
if (uVar1 == 0) {

(*(undefined8 *)(param_1 + 0x20),*(undefined2 *)(param_1 + 0x8e),
*(undefined8 *)(param_1 + 0x90));
uVar3 = (ulonglong)uVar1;
if (uVar1 == 0) {

uVar3 = (ulonglong)uVar1;
}
}
}
}
}
}
if (*(HLOCAL *)(param_1 + 0x90) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x90));
*(undefined8 *)(param_1 + 0x90) = 0;
}
return uVar3;
}
=========================================
Function at address: 0x180066af0
Called functions addresses: 0x18002a7c0 0x18000eb9c 0x1800675f4 0x180066db8


undefined8
FUN_180066af0(longlong *param_1,uint param_2,ushort *param_3,short param_4,longlong param_5,
PUCHAR param_6)

{
undefined8 uVar1;
ushort *puVar2;
undefined local_res8 [8];
char local_res10 [8];
undefined local_28 [4];
undefined2 local_24 [2];
ushort local_20 [2];
ushort local_1c [2];

if (((((param_2 == *(ushort *)(param_1 + 0x14)) && (param_3 != (ushort *)0x0)) &&
(param_4 == *(short *)((longlong)param_1 + 0x7e))) &&
((param_5 != 0 && (param_6 != (PUCHAR)0x0)))) &&
((*(short *)(param_1[1] + 0x398) != 0 && (*(longlong *)(param_1[1] + 0x390) != 0)))) {
param_1[0x10] = param_5;
uVar1 = FUN_1800675f4((longlong)param_1,1,*(ushort *)(param_1 + 0x15));
if ((int)uVar1 == 0) {
local_24[0] = 0x303;

if ((int)uVar1 == 0) {
if ((*(int *)(param_1[1] + 0x44) != 100) &&
(uVar1 = FUN_18000eb9c(param_6,0x20), (int)uVar1 != 0)) {
return uVar1;
}

if ((int)uVar1 == 0) {
local_res10[0] = *(char *)(param_1[1] + 0x671);

if ((int)uVar1 == 0) {
if ((local_res10[0] != '\0') &&

(param_1[4],local_res10[0],param_1[1] + 0x651), (int)uVar1 != 0))
{
return uVar1;
}
local_20[0] = (ushort)(*(short *)(param_1 + 0x14) * 2) >> 8 |
*(short *)(param_1 + 0x14) << 9;

if ((int)uVar1 == 0) {
puVar2 = param_3;
if (param_3 < param_3 + (ulonglong)*(ushort *)(param_1 + 0x14) * 2) {
do {
local_1c[0] = *puVar2 >> 8 | *puVar2 << 8;

if ((int)uVar1 != 0) {
return uVar1;
}
puVar2 = puVar2 + 2;
} while (puVar2 < param_3 + (ulonglong)*(ushort *)(param_1 + 0x14) * 2);
}
local_res8[0] = 1;

if ((int)uVar1 == 0) {
local_28[0] = 0;

if (((int)uVar1 == 0) && (uVar1 = FUN_180066db8(param_1), (int)uVar1 == 0)) {

}
}
}
}
}
}
}
}
else {
uVar1 = 0x57;
}
return uVar1;
}
=========================================
Function at address: 0x180066db8
Called functions addresses: 0x180067b70 0x180067e74 0x180067dd4 0x1800686f0 0x180068414 0x180066f08 0x1800673fc 0x18002a7c0 0x1800682e8 0x1800653c8 0x1800677c0 0x180067098 0x180068610


void FUN_180066db8(longlong *param_1)

{
int iVar1;
undefined8 uVar2;


if ((((((iVar1 == 0) && (uVar2 = FUN_1800682e8((longlong)param_1), (int)uVar2 == 0)) &&

(((uVar2 = FUN_1800686f0((longlong)param_1), (int)uVar2 == 0 &&
(iVar1 = FUN_180068414((longlong)param_1), iVar1 == 0)) &&
((iVar1 = FUN_180067098((longlong)param_1,0x23,0), iVar1 == 0 &&
((uVar2 = FUN_180068610((longlong)param_1), (int)uVar2 == 0 &&
(uVar2 = FUN_1800653c8((longlong)param_1), (int)uVar2 == 0)))))))) &&
(iVar1 = FUN_1800677c0((longlong)param_1), iVar1 == 0)) &&
(iVar1 = FUN_180067098((longlong)param_1,0x31,0), iVar1 == 0)) {
if ((*(char *)(param_1[1] + 0x540) != '\0') &&
(iVar1 = FUN_180067098((longlong)param_1,0x17,0), iVar1 != 0)) {
return;
}
iVar1 = FUN_180067e74((longlong)param_1);
if ((((iVar1 == 0) && (uVar2 = FUN_180066f08((longlong)param_1), (int)uVar2 == 0)) &&
(uVar2 = FUN_1800673fc((longlong)param_1,1), (int)uVar2 == 0)) &&
(uVar2 = FUN_180067dd4((longlong)param_1), (int)uVar2 == 0)) {
FUN_180067b70((longlong)param_1);
}
}
return;
}
=========================================
Function at address: 0x180066f08
Called functions addresses: 0x18002a7c0 0x180067098


undefined8 FUN_180066f08(longlong param_1)

{
undefined8 uVar1;
ushort local_res8 [4];

if (((*(longlong *)(param_1 + 0x58) == 0) || (*(short *)(param_1 + 0x60) == 0)) ||
(*(ushort *)(param_1 + 0x62) == 0)) {
uVar1 = 0;
}
else {
uVar1 = FUN_180067098(param_1,0x2c,*(ushort *)(param_1 + 0x62));
if ((int)uVar1 == 0) {
local_res8[0] = *(ushort *)(param_1 + 0x60) >> 8 | *(ushort *)(param_1 + 0x60) << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if ((int)uVar1 == 0) {
if (local_res8[0] == 0) {
uVar1 = 0x13b;
}
else {

(*(undefined8 *)(param_1 + 0x20),*(undefined2 *)(param_1 + 0x60),
*(undefined8 *)(param_1 + 0x58));
}
}
}
}
return uVar1;
}
=========================================
Function at address: 0x180066fbc
Called functions addresses: 0x18002a7c0 0x180067ec8 0x180067098 0x1800674c0


void FUN_180066fbc(longlong param_1)

{
int iVar1;
undefined8 uVar2;


if (iVar1 == 0) {
if (((*(uint *)(*(longlong *)(param_1 + 8) + 0x88) >> 0x15 & 1) != 0) &&
(iVar1 = FUN_180067098(param_1,0,0), iVar1 != 0)) {
return;
}
uVar2 = FUN_180067ec8(param_1);
if ((int)uVar2 == 0) {
FUN_1800674c0(param_1,8);
}
}
return;
}
=========================================
Function at address: 0x180067044
Called functions addresses: 0x18002a7c0 0x180066fbc 0x1800675f4


void FUN_180067044(longlong param_1)

{
int iVar1;
undefined8 uVar2;

uVar2 = FUN_1800675f4(param_1,8,*(ushort *)(param_1 + 0xa2));
if ((int)uVar2 == 0) {
iVar1 = FUN_180066fbc(param_1);
if (iVar1 == 0) {

}
}
return;
}
=========================================
Function at address: 0x180067098
Called functions addresses: 0x18002a7c0


void FUN_180067098(longlong param_1,ushort param_2,ushort param_3)

{
int iVar1;
ushort local_res8 [4];
ushort local_res20 [4];

local_res8[0] = param_2 >> 8 | param_2 << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if (iVar1 == 0) {
local_res20[0] = param_3 >> 8 | param_3 << 8;

}
return;
}
=========================================
Function at address: 0x18006711c
Called functions addresses: 0x180041cb0 0x18002a7c0 0x180012184 0x18006880c 0x1800675f4 0x180028070 0xEXTERNAL:00000115


void FUN_18006711c(longlong param_1)

{
byte bVar1;
int iVar2;
undefined8 uVar3;
longlong lVar4;
longlong *plVar5;
longlong lVar6;
undefined auStack_88 [32];
uint local_68;
undefined4 local_60;
undefined local_58 [64];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_88;
uVar3 = FUN_1800675f4(param_1,0x14,*(ushort *)(param_1 + 0x52));
if ((int)uVar3 == 0) {
lVar6 = *(longlong *)(param_1 + 8);
lVar4 = FUN_18006880c(lVar6 + 0x558,(*(uint *)(lVar6 + 0x40) & 0x800a2aaa) != 0);
if (lVar4 != 0) {
bVar1 = *(byte *)(param_1 + 0x51);

plVar5 = *(longlong **)(*(longlong *)(param_1 + 8) + 8);
if (plVar5 != (longlong *)0x0) {
plVar5 = (longlong *)*plVar5;
}
local_60 = 0;
local_68 = (uint)bVar1;
iVar2 = SslComputeFinishedHash(plVar5,lVar4,uVar3,local_58);
if (iVar2 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x12,&DAT_180082c10);
}

(*(undefined8 *)(param_1 + 0x20),*(undefined *)(param_1 + 0x51),local_58);
if (iVar2 == 0) {

}
}
else {
FUN_180012184(*(longlong *)(param_1 + 8),0x385,iVar2);
}
}
}
FUN_180028070(local_18 ^ (ulonglong)auStack_88);
return;
}
=========================================
Function at address: 0x18006728c
Called functions addresses: 0x180041cb0 0x18002a7c0 0x180012184 0x18006880c 0x180028070 0x1800675f4 0xEXTERNAL:00000115


void FUN_18006728c(longlong param_1)

{
byte bVar1;
int iVar2;
undefined8 uVar3;
longlong lVar4;
longlong *plVar5;
longlong lVar6;
undefined auStack_88 [32];
uint local_68;
undefined4 local_60;
undefined local_58 [64];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_88;
uVar3 = FUN_1800675f4(param_1,0x14,*(ushort *)(param_1 + 0x52));
if ((int)uVar3 == 0) {
lVar6 = *(longlong *)(param_1 + 8);
lVar4 = FUN_18006880c(lVar6 + 1000,(*(uint *)(lVar6 + 0x40) & 0x800a2aaa) != 0);
if (lVar4 != 0) {
bVar1 = *(byte *)(param_1 + 0x51);

plVar5 = *(longlong **)(*(longlong *)(param_1 + 8) + 8);
if (plVar5 != (longlong *)0x0) {
plVar5 = (longlong *)*plVar5;
}
local_60 = 0;
local_68 = (uint)bVar1;
iVar2 = SslComputeFinishedHash(plVar5,lVar4,uVar3,local_58);
if (iVar2 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x12,&DAT_180082c10);
}

(*(undefined8 *)(param_1 + 0x20),*(undefined *)(param_1 + 0x51),local_58);
if (iVar2 == 0) {

}
}
else {
FUN_180012184(*(longlong *)(param_1 + 8),0x385,iVar2);
}
}
}
FUN_180028070(local_18 ^ (ulonglong)auStack_88);
return;
}
=========================================
Function at address: 0x1800673fc
Called functions addresses: 0x18002a7c0 0x180067098


undefined8 FUN_1800673fc(longlong param_1,uint param_2)

{
undefined8 *puVar1;
byte bVar2;
ushort *puVar3;
undefined8 uVar4;
undefined8 *puVar5;

puVar5 = (undefined8 *)(*(longlong *)(param_1 + 8) + 0x5c8);
if ((puVar5 != (undefined8 *)0x0) &&
(bVar2 = *(byte *)(*(longlong *)(param_1 + 8) + 0x5d0), bVar2 != 0)) {
puVar1 = puVar5 + bVar2;
for (; puVar5 < puVar1; puVar5 = puVar5 + 1) {
puVar3 = (ushort *)*puVar5;
if (puVar3 == (ushort *)0x0) {
return 0x80090304;
}
if (puVar3[1] == param_2) {
uVar4 = FUN_180067098(param_1,*puVar3,puVar3[4]);
if ((int)uVar4 != 0) {
return uVar4;
}
if ((puVar3[4] != 0) &&

(*(undefined8 *)(param_1 + 0x20),puVar3[4],puVar3 + 5),
(int)uVar4 != 0)) {
return uVar4;
}
}
}
}
return 0;
}
=========================================
Function at address: 0x1800674c0
Called functions addresses: 0x18002a7c0 0x180067098


undefined8 FUN_1800674c0(longlong param_1,uint param_2)

{
undefined8 *puVar1;
byte bVar2;
ushort *puVar3;
undefined8 uVar4;
undefined8 *puVar5;

puVar5 = (undefined8 *)(*(longlong *)(param_1 + 8) + 0x458);
if ((puVar5 != (undefined8 *)0x0) &&
(bVar2 = *(byte *)(*(longlong *)(param_1 + 8) + 0x460), bVar2 != 0)) {
puVar1 = puVar5 + bVar2;
for (; puVar5 < puVar1; puVar5 = puVar5 + 1) {
puVar3 = (ushort *)*puVar5;
if (puVar3 == (ushort *)0x0) {
return 0x80090304;
}
if (puVar3[1] == param_2) {
uVar4 = FUN_180067098(param_1,*puVar3,puVar3[4]);
if ((int)uVar4 != 0) {
return uVar4;
}
if ((puVar3[4] != 0) &&

(*(undefined8 *)(param_1 + 0x20),puVar3[4],puVar3 + 5),
(int)uVar4 != 0)) {
return uVar4;
}
}
}
}
return 0;
}
=========================================
Function at address: 0x180067584
Called functions addresses: 0x18002a7c0 0x1800687b4 0x18006782c 0x1800674c0


void FUN_180067584(longlong param_1)

{
int iVar1;
ushort local_res8 [16];

local_res8[0] = *(ushort *)(param_1 + 0x28) >> 8 | *(ushort *)(param_1 + 0x28) << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if (iVar1 == 0) {
iVar1 = FUN_1800687b4(param_1);
if (iVar1 == 0) {
iVar1 = FUN_18006782c(param_1);
if (iVar1 == 0) {
FUN_1800674c0(param_1,2);
}
}
}
return;
}
=========================================
Function at address: 0x1800675f4
Called functions addresses: 0x18002a7c0


undefined8 FUN_1800675f4(longlong param_1,undefined param_2,ushort param_3)

{
undefined8 uVar1;
undefined local_res18 [8];
undefined local_res20 [8];
ushort local_18 [8];

if (param_3 < 4) {
uVar1 = 0x57;
}
else {
local_res18[0] = param_2;

(*(undefined8 *)(param_1 + 0x20),1,local_res18);
if ((int)uVar1 == 0) {
local_res20[0] = (undefined)uVar1;

(*(undefined8 *)(param_1 + 0x20),1,local_res20);
if ((int)uVar1 == 0) {
local_18[0] = (ushort)(param_3 - 4) >> 8 | (param_3 - 4) * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_18);
}
}
}
return uVar1;
}
=========================================
Function at address: 0x1800676b4
Called functions addresses: 0x18002a7c0


undefined8 FUN_1800676b4(longlong param_1)

{
ushort uVar1;
undefined8 uVar2;
ushort local_res8 [4];
ushort local_res10 [4];

if ((*(int *)(*(longlong *)(param_1 + 8) + 0x44) == 0x28) && (DAT_1800927a0 != 0)) {
*(undefined2 *)(param_1 + 0x2c) = 0;
uVar2 = 0;
}
else {
local_res8[0] = *(ushort *)(param_1 + 0x2c) >> 8 | *(ushort *)(param_1 + 0x2c) << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if ((int)uVar2 == 0) {
uVar1 = (ushort)*(byte *)(param_1 + 0x2e) + *(short *)(param_1 + 0x30);
local_res10[0] = uVar1 >> 8 | uVar1 * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_res10);
if ((int)uVar2 == 0) {
if ((*(char *)(param_1 + 0x2e) != '\0') &&

(*(undefined8 *)(param_1 + 0x20),1,&DAT_1800858aa), (int)uVar2 != 0))
{
return uVar2;
}

(*(undefined8 *)(param_1 + 0x20),*(undefined2 *)(param_1 + 0x30),
*(longlong *)(param_1 + 0x38) + 8);
}
}
}
return uVar2;
}
=========================================
Function at address: 0x1800677c0
Called functions addresses: 0x18002a7c0 0x1800676b4 0x180067098


void FUN_1800677c0(longlong param_1)

{
ushort uVar1;
int iVar2;
ushort local_res8 [16];

iVar2 = FUN_180067098(param_1,0x33,*(ushort *)(param_1 + 0x34));
if (iVar2 == 0) {
uVar1 = *(short *)(param_1 + 0x34) - 2;
local_res8[0] = uVar1 >> 8 | uVar1 * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if (iVar2 == 0) {
FUN_1800676b4(param_1);
}
}
return;
}
=========================================
Function at address: 0x18006782c
Called functions addresses: 0x18002a7c0 0x180067098


void FUN_18006782c(longlong param_1)

{
int iVar1;
ushort local_res8 [16];

iVar1 = FUN_180067098(param_1,0x33,*(ushort *)(param_1 + 0x34));
if (iVar1 == 0) {
local_res8[0] = *(ushort *)(param_1 + 0x2c) >> 8 | *(ushort *)(param_1 + 0x2c) << 8;

}
return;
}
=========================================
Function at address: 0x180067888
Called functions addresses: 0x18002a7c0 0xEXTERNAL:00000040 0xEXTERNAL:000000c2 0x18000eb9c 0x1800675f4 0xEXTERNAL:000000c0 0x180028070 0x18002a77b


void FUN_180067888(longlong param_1)

{
longlong lVar1;
int iVar2;
undefined8 uVar3;
undefined8 *puVar4;
uint uVar5;
undefined auStack_88 [32];
byte local_68 [4];
ushort local_64 [2];
undefined2 local_60 [2];
UCHAR local_5c [4];
longlong local_58;
uint local_50 [2];
undefined8 local_48;
undefined8 uStack_40;
undefined8 local_38;
undefined8 uStack_30;
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_88;
uVar3 = FUN_1800675f4(param_1,4,*(ushort *)(param_1 + 0xac));
if ((int)uVar3 == 0) {
uVar5 = DAT_1800919cc / 1000;
local_50[0] = (uVar5 & 0xff0000) >> 8 | (uVar5 & 0xff00) << 8 | uVar5 << 0x18;

(*(undefined8 *)(param_1 + 0x20),4,local_50);
if (iVar2 == 0) {
local_5c[0] = '\0';
local_5c[1] = '\0';
local_5c[2] = '\0';
local_5c[3] = '\0';
uVar3 = FUN_18000eb9c(local_5c,4);
if (((int)uVar3 == 0) &&

(*(undefined8 *)(param_1 + 0x20),4,local_5c), iVar2 == 0)) {
local_58 = 0;

if (local_58 != 0) {
RtlAcquireResourceShared(local_58 + 0x48,1);
uVar3 = *(undefined8 *)(local_58 + 200);
local_68[0] = *(byte *)(local_58 + 0xd0);
RtlReleaseResource(local_58 + 0x48);

(*(undefined8 *)(param_1 + 0x20),1,local_68);
if (iVar2 == 0) {

(*(undefined8 *)(param_1 + 0x20),local_68[0],uVar3);
if (iVar2 == 0) {
puVar4 = *(undefined8 **)(param_1 + 0xc0);
uVar5 = (uint)*(ushort *)(param_1 + 200);
local_48 = 0;
uStack_40 = 0;
local_38 = 0;
uStack_30 = 0;
if (puVar4 == (undefined8 *)0x0) {
uVar5 = 0x20;
RtlAcquireResourceShared(local_58 + 0x48,1);
lVar1 = local_58;
if (*(ushort *)(local_58 + 0xee) < 0x21) {
uVar5 = (uint)*(ushort *)(local_58 + 0xee);
memcpy(&local_48,(void *)(local_58 + 0xf0),(ulonglong)uVar5);
}
RtlReleaseResource(lVar1 + 0x48);
puVar4 = &local_48;
}
local_64[0] = (ushort)uVar5 >> 8 | (ushort)uVar5 << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_64);
if ((iVar2 == 0) &&

(*(undefined8 *)(param_1 + 0x20),uVar5,puVar4), iVar2 == 0)) {
if (*(HLOCAL *)(param_1 + 0xc0) != (HLOCAL)0x0) {
LocalFree(*(HLOCAL *)(param_1 + 0xc0));
*(undefined8 *)(param_1 + 0xc0) = 0;
*(undefined2 *)(param_1 + 200) = 0;
}
local_60[0] = 0;

(*(undefined8 *)(param_1 + 0x20),2,local_60);
if (iVar2 == 0) {

}
}
}
}
}
}
}
}
FUN_180028070(local_28 ^ (ulonglong)auStack_88);
return;
}
=========================================
Function at address: 0x180067b70
Called functions addresses: 0x180065504 0x18002a7c0 0xEXTERNAL:000000c2 0xEXTERNAL:000000c0 0x1800534ac 0x180067098


int FUN_180067b70(longlong param_1)

{
longlong lVar1;
ushort uVar2;
int iVar3;
uint uVar4;
ushort local_res8 [4];
uint local_res10 [2];
longlong local_res18;

if (*(ushort *)(param_1 + 0x9c) == 0) {
iVar3 = 0;
}
else {
local_res18 = 0;
iVar3 = FUN_180067098(param_1,0x29,*(ushort *)(param_1 + 0x9c));
if (iVar3 == 0) {

if (local_res18 == 0) {
return -0x7ff6fcfc;
}
RtlAcquireResourceShared(local_res18 + 0x48,1);
uVar4 = *(uint *)(local_res18 + 0x1b0);
lVar1 = *(longlong *)(local_res18 + 0x1a8);
if ((uVar4 - 1 < 0xfff9) && (lVar1 != 0)) {
uVar2 = (ushort)uVar4;
local_res8[0] = (ushort)(uVar2 + 6) >> 8 | (uVar2 + 6) * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if (iVar3 == 0) {
local_res8[0] = uVar2 >> 8 | uVar2 << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if ((iVar3 == 0) &&

(*(undefined8 *)(param_1 + 0x20),uVar4 & 0xffff,lVar1),
lVar1 = local_res18, iVar3 == 0)) {
iVar3 = FUN_1800534ac(*(uint *)(local_res18 + 0x1a0));
uVar4 = *(int *)(lVar1 + 0xd4) + iVar3;
local_res10[0] =
uVar4 >> 0x18 | (uVar4 & 0xff0000) >> 8 | (uVar4 & 0xff00) << 8 | uVar4 * 0x1000000
;

(*(undefined8 *)(param_1 + 0x20),4,local_res10);
if (iVar3 == 0) {
RtlReleaseResource(local_res18 + 0x48);
local_res18 = 0;
iVar3 = FUN_180065504(param_1);
}
}
}
}
else {
iVar3 = -0x7ff6fcfc;
}
}
if (local_res18 != 0) {
RtlReleaseResource(local_res18 + 0x48);
}
}
return iVar3;
}
=========================================
Function at address: 0x180067d60
Called functions addresses: 0x18002a7c0 0x180067098


undefined8 FUN_180067d60(longlong param_1)

{
undefined8 uVar1;
ushort local_res8 [4];

if (*(ushort *)(param_1 + 0x9c) == 0) {
uVar1 = 0;
}
else {
uVar1 = FUN_180067098(param_1,0x29,*(ushort *)(param_1 + 0x9c));
if ((int)uVar1 == 0) {
local_res8[0] = *(ushort *)(param_1 + 0xbc) >> 8 | *(ushort *)(param_1 + 0xbc) << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
}
}
return uVar1;
}
=========================================
Function at address: 0x180067dd4
Called functions addresses: 0x18002a7c0 0x18000ad34 0x180067098


undefined8 FUN_180067dd4(longlong param_1)

{
undefined8 uVar1;
undefined local_res8 [8];
undefined local_res10 [24];

uVar1 = FUN_180067098(param_1,0x2d,*(ushort *)(param_1 + 0xa6));
if ((int)uVar1 == 0) {
local_res8[0] = 1;

(*(undefined8 *)(param_1 + 0x20),1,local_res8);
if ((int)uVar1 == 0) {
local_res10[0] = 1;

(*(undefined8 *)(param_1 + 0x20),1,local_res10);
if ((int)uVar1 == 0) {
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0x2d);
uVar1 = 0;
}
}
}
return uVar1;
}
=========================================
Function at address: 0x180067e74
Called functions addresses: 0x18002a7c0 0x180067098


void FUN_180067e74(longlong param_1)

{
int iVar1;
undefined local_res10 [24];

iVar1 = FUN_180067098(param_1,0xff01,1);
if (iVar1 == 0) {
local_res10[0] = 0;

}
return;
}
=========================================
Function at address: 0x180067ec8
Called functions addresses: 0x180041cdc 0x18002a7c0 0x18000ad34 0x180067098


undefined8 FUN_180067ec8(longlong param_1)

{
int *piVar1;
undefined8 uVar2;
ushort uVar3;
byte local_res8 [8];
ushort local_res10 [4];

if ((((*(short *)(param_1 + 0xa6) != 0) &&

(*piVar1 == 1)) && (piVar1[1] == 2)) {
uVar2 = FUN_180067098(param_1,0x10,*(ushort *)(param_1 + 0xa6));
if ((int)uVar2 != 0) {
return uVar2;
}
uVar3 = *(short *)(param_1 + 0xa6) - 2;
local_res10[0] = uVar3 >> 8 | uVar3 * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_res10);
if ((int)uVar2 != 0) {
return uVar2;
}
local_res8[0] = *(byte *)(piVar1 + 2);
if (uVar3 != (ushort)(local_res8[0] + 1)) {
return 0x57;
}

(*(undefined8 *)(param_1 + 0x20),1,local_res8);
if ((int)uVar2 != 0) {
return uVar2;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x21,&DAT_180082c10,(uint)uVar3);
}

(*(undefined8 *)(param_1 + 0x20),local_res8[0],(longlong)piVar1 + 9);
if ((int)uVar2 != 0) {
return uVar2;
}
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0x10);
}
return 0;
}
=========================================
Function at address: 0x180068058
Called functions addresses: 0x18002a7c0 0x180067d60 0x1800687b4 0x1800676b4 0x180067098 0x1800674c0


void FUN_180068058(longlong param_1)

{
int iVar1;
undefined8 uVar2;
ushort local_res8 [16];

local_res8[0] = *(ushort *)(param_1 + 0x28) >> 8 | *(ushort *)(param_1 + 0x28) << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if (iVar1 == 0) {
iVar1 = FUN_1800687b4(param_1);
if (iVar1 == 0) {
iVar1 = FUN_180067098(param_1,0x33,*(ushort *)(param_1 + 0x34));
if (iVar1 == 0) {
uVar2 = FUN_1800676b4(param_1);
if ((int)uVar2 == 0) {
uVar2 = FUN_180067d60(param_1);
if ((int)uVar2 == 0) {
FUN_1800674c0(param_1,2);
}
}
}
}
}
return;
}
=========================================
Function at address: 0x1800680e8
Called functions addresses: 0x180067584 0x180068058 0x18002a7c0 0x18000eb9c 0x1800675f4


undefined8 FUN_1800680e8(longlong param_1,char param_2,PUCHAR param_3)

{
longlong lVar1;
ushort uVar2;
undefined8 uVar3;
char local_res18 [8];
undefined local_res20 [8];
undefined2 local_18 [2];
ushort local_14 [6];

if ((param_3 == (PUCHAR)0x0) && (param_2 != '\0')) {
uVar3 = 0x57;
}
else {
uVar3 = FUN_1800675f4(param_1,2,*(ushort *)(param_1 + 0xa0));
if ((int)uVar3 == 0) {
local_18[0] = 0x303;

(*(undefined8 *)(param_1 + 0x20),2,local_18);
if ((int)uVar3 == 0) {
if ((param_2 != '\0') && (uVar3 = FUN_18000eb9c(param_3,0x20), (int)uVar3 != 0)) {
return uVar3;
}
if (param_2 == '\0') {
param_3 = &DAT_1800858b0;
}

(*(undefined8 *)(param_1 + 0x20),0x20,param_3);
if ((int)uVar3 == 0) {
local_res18[0] = *(char *)(*(longlong *)(param_1 + 8) + 0x501);

(*(undefined8 *)(param_1 + 0x20),1,local_res18);
if ((int)uVar3 == 0) {
if ((local_res18[0] != '\0') &&

(*(undefined8 *)(param_1 + 0x20),local_res18[0],
*(longlong *)(param_1 + 8) + 0x4e1), (int)uVar3 != 0)) {
return uVar3;
}
if (((*(byte *)(*(longlong *)(param_1 + 8) + 0x20) & 1) == 0) ||
(lVar1 = *(longlong *)(*(longlong *)(param_1 + 8) + 8), lVar1 == 0)) {
uVar2 = 0;
}
else {
uVar2 = (ushort)*(undefined4 *)(lVar1 + 0x1c);
}
local_14[0] = uVar2 >> 8 | uVar2 << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_14);
if ((int)uVar3 == 0) {
local_res20[0] = (undefined)uVar3;

(*(undefined8 *)(param_1 + 0x20),1,local_res20);
if ((int)uVar3 == 0) {
if (param_2 == '\0') {
uVar3 = FUN_180067584(param_1);
}
else {
uVar3 = FUN_180068058(param_1);
}
if ((int)uVar3 == 0) {

}
}
}
}
}
}
}
}
return uVar3;
}
=========================================
Function at address: 0x1800682e8
Called functions addresses: 0x18002a7c0 0x18000ad34 0x180067098


undefined8 FUN_1800682e8(longlong param_1)

{
short sVar1;
undefined8 uVar2;
ushort uVar3;
undefined local_res8 [8];
ushort local_res10 [4];
ushort local_res18 [4];

if (*(longlong *)(*(longlong *)(param_1 + 0x10) + 0x28) != 0) {
uVar2 = FUN_180067098(param_1,0,*(ushort *)(param_1 + 0xa2));
if ((int)uVar2 != 0) {
return uVar2;
}
sVar1 = *(short *)(param_1 + 0xa2);
uVar3 = sVar1 - 2;
local_res10[0] = uVar3 >> 8 | uVar3 * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_res10);
if ((int)uVar2 != 0) {
return uVar2;
}
local_res8[0] = (undefined)uVar2;

(*(undefined8 *)(param_1 + 0x20),1,local_res8);
if ((int)uVar2 != 0) {
return uVar2;
}
uVar3 = sVar1 - 5;
local_res18[0] = uVar3 >> 8 | uVar3 * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_res18);
if ((int)uVar2 != 0) {
return uVar2;
}

if ((int)uVar2 != 0) {
return uVar2;
}
FUN_18000ad34(*(longlong *)(*(longlong *)(param_1 + 8) + 0x78),0,0);
}
return 0;
}
=========================================
Function at address: 0x180068414
Called functions addresses: 0x18002a7c0 0x180067098


void FUN_180068414(longlong param_1)

{
int iVar1;
ushort uVar2;
ushort local_res8 [4];

iVar1 = FUN_180067098(param_1,0xd,*(ushort *)(param_1 + 0x7c));
if (iVar1 == 0) {
uVar2 = *(short *)(param_1 + 0x7c) - 2;
local_res8[0] = uVar2 >> 8 | uVar2 * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if (iVar1 == 0) {

(*(undefined8 *)(param_1 + 0x20),uVar2,*(undefined8 *)(param_1 + 0x80));
}
}
return;
}
=========================================
Function at address: 0x1800684b0
Called functions addresses: 0x18002a7c0 0x180067098


undefined8 FUN_1800684b0(longlong param_1)

{
undefined8 uVar1;
undefined local_res8 [8];
undefined4 local_res10 [2];

if (*(ushort *)(param_1 + 0x98) == 0) {
uVar1 = 0;
}
else {
uVar1 = FUN_180067098(param_1,5,*(ushort *)(param_1 + 0x98));
if ((int)uVar1 == 0) {
local_res8[0] = 1;

(*(undefined8 *)(param_1 + 0x20),1,local_res8);
if ((int)uVar1 == 0) {
local_res10[0] = 0;

(*(undefined8 *)(param_1 + 0x20),4,local_res10);
}
}
}
return uVar1;
}
=========================================
Function at address: 0x180068550
Called functions addresses: 0x18002a7c0 0x180067098


undefined8 FUN_180068550(longlong param_1)

{
uint uVar1;
longlong lVar2;
undefined8 uVar3;
undefined local_res8;
undefined local_res9;
undefined local_resa;
undefined local_resb;

lVar2 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x5e8);
if (lVar2 == 0) {
uVar3 = 0;
}
else {
uVar3 = FUN_180067098(param_1,5,*(ushort *)(param_1 + 0x98));
if ((int)uVar3 == 0) {
uVar1 = *(uint *)(lVar2 + 0x10);
local_res9 = (undefined)(uVar1 >> 0x10);
local_resa = (undefined)(uVar1 >> 8);
local_res8 = 1;
local_resb = (undefined)uVar1;

(*(undefined8 *)(param_1 + 0x20),4,&local_res8);
if ((int)uVar3 == 0) {

(*(undefined8 *)(param_1 + 0x20),uVar1 & 0xffff,*(undefined8 *)(lVar2 + 8)
);
}
}
}
return uVar3;
}
=========================================
Function at address: 0x180068610
Called functions addresses: 0x18002a7c0 0x180067098


undefined8 FUN_180068610(longlong param_1)

{
ushort *puVar1;
ushort uVar2;
undefined8 uVar3;
ushort *puVar4;
ushort local_res8 [4];
ushort local_res10 [4];

uVar3 = FUN_180067098(param_1,10,*(ushort *)(param_1 + 0x2a));
if ((int)uVar3 == 0) {
uVar2 = *(short *)(param_1 + 0x2a) - 2;
local_res8[0] = uVar2 >> 8 | uVar2 * 0x100;

(*(undefined8 *)(param_1 + 0x20),2,local_res8);
if ((int)uVar3 == 0) {
puVar1 = *(ushort **)(*(longlong *)(param_1 + 8) + 0x390);
puVar4 = puVar1;
if (puVar1 < puVar1 + *(ushort *)(*(longlong *)(param_1 + 8) + 0x398)) {
do {
local_res10[0] = *puVar4 >> 8 | *puVar4 << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res10);
if ((int)uVar3 != 0) {
return uVar3;
}
puVar4 = puVar4 + 1;
} while (puVar4 < puVar1 + *(ushort *)(*(longlong *)(param_1 + 8) + 0x398));
}
uVar3 = 0;
}
}
return uVar3;
}
=========================================
Function at address: 0x1800686f0
Called functions addresses: 0x18002a7c0 0x180067098


undefined8 FUN_1800686f0(longlong param_1)

{
undefined8 uVar1;
uint *puVar2;
char local_res8 [8];
ushort local_res10 [4];

uVar1 = FUN_180067098(param_1,0x2b,(ushort)*(byte *)(param_1 + 0x36));
if ((int)uVar1 == 0) {
local_res8[0] = *(char *)(param_1 + 0x36) + -1;

(*(undefined8 *)(param_1 + 0x20),1,local_res8);
if ((int)uVar1 == 0) {
puVar2 = &DAT_180082be8;
do {
if ((*puVar2 & *(uint *)(*(longlong *)(param_1 + 8) + 0x40)) != 0) {
local_res10[0] = *(ushort *)(puVar2 + 1) >> 8 | *(ushort *)(puVar2 + 1) << 8;

(*(undefined8 *)(param_1 + 0x20),2,local_res10);
if ((int)uVar1 != 0) {
return uVar1;
}
}
puVar2 = puVar2 + 2;
} while (puVar2 < &DAT_180082c10);
uVar1 = 0;
}
}
return uVar1;
}
=========================================
Function at address: 0x1800687b4
Called functions addresses: 0x18002a7c0 0x180067098


void FUN_1800687b4(longlong param_1)

{
int iVar1;
undefined2 local_res8 [16];

iVar1 = FUN_180067098(param_1,0x2b,(ushort)*(byte *)(param_1 + 0x36));
if (iVar1 == 0) {
local_res8[0] = 0x403;

}
return;
}
=========================================
Function at address: 0x18006880c
Called functions addresses: None


undefined8 FUN_18006880c(longlong param_1,char param_2)

{
if (*(char *)(param_1 + 0xe9) != '\0') {
return *(undefined8 *)(param_1 + 0x50);
}
if (param_2 != '\0') {
return *(undefined8 *)(param_1 + 0x38);
}
return *(undefined8 *)(param_1 + 0x40);
}
=========================================
Function at address: 0x180068834
Called functions addresses: 0x180014db8 0x180007ef4 0x180041cb0 0x18002a7c0 0xEXTERNAL:00000137 0x18005b470 0xEXTERNAL:0000012b 0x1800102dc 0x18000909c 0xEXTERNAL:00000147


ulonglong FUN_180068834(longlong param_1,BYTE *param_2,DWORD param_3,int param_4,ushort *param_5,
longlong param_6)

{
PCERT_INFO p_Var1;
longlong lVar2;
longlong lVar3;
char cVar4;
BOOL BVar5;
uint uVar6;
PCCERT_CONTEXT pCertContext;
ulonglong uVar7;
int *piVar8;
longlong *plVar9;
undefined4 uVar10;
uint uVar11;
longlong *plVar12;
ulonglong uVar13;
undefined uVar14;
longlong *local_res10;

if ((param_2 == (BYTE *)0x0) || (param_3 == 0)) {
plVar9 = *(longlong **)(param_1 + 8);
LAB_180068a43:
FUN_18005b470(plVar9,0xfa,0x80090308,0x2a);
return 0x80090308;
}
pCertContext = CertCreateCertificateContext(1,param_2,param_3);
if (pCertContext == (PCCERT_CONTEXT)0x0) {
plVar9 = *(longlong **)(param_1 + 8);
goto LAB_180068a43;
}
p_Var1 = pCertContext->pCertInfo;
uVar13 = 0;
local_res10 = (longlong *)0x0;
if (p_Var1 == (PCERT_INFO)0x0) {
uVar14 = 0x2a;
uVar10 = 0xfa;
}
else {
if ((param_4 != 0) &&
(BVar5 = CertCompareCertificateName
(pCertContext->dwCertEncodingType,&p_Var1->Issuer,&p_Var1->Subject),
BVar5 != 0)) goto LAB_180068a2c;
cVar4 = FUN_180007ef4(param_5,pCertContext);
if (cVar4 != '\0') {
if (param_4 != 0) goto LAB_180068a2c;
uVar7 = FUN_180014db8((longlong)pCertContext,&local_res10,(int *)0x0);
plVar12 = local_res10;
plVar9 = *(longlong **)(param_1 + 8);
if ((int)uVar7 == 0) {
lVar2 = plVar9[10];
if (lVar2 == 0) {
uVar13 = 0x80090304;
}
else {
uVar6 = *(uint *)(plVar9 + 8);
uVar11 = *(uint *)(lVar2 + 0xc4);
if (uVar11 != 0) {
lVar3 = plVar9[1];
if ((uVar6 & 0x40051555) == 0) {
piVar8 = (int *)0x0;
}
else {

uVar11 = *(uint *)(lVar2 + 0xc4);
}
uVar6 = FUN_1800102dc(*(uint **)(lVar2 + 200),uVar11,pCertContext,plVar12,piVar8,lVar3,
(uVar6 & 0x40051555) != 0);
uVar13 = (ulonglong)uVar6;
if (uVar6 != 0) {
if (uVar6 == 0x80090331) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180082c10);
}
FUN_18005b470(*(longlong **)(param_1 + 8),0xfb,0x80090331,0x2b);
}
goto LAB_180068a1a;
}
}
*(longlong **)(param_6 + 0x28) = plVar12;
plVar12 = (longlong *)0x0;
*(PCCERT_CONTEXT *)(param_6 + 0x30) = pCertContext;
pCertContext = (PCCERT_CONTEXT)0x0;
uVar13 = uVar7 & 0xffffffff;
}
}
else {
FUN_18005b470(plVar9,0xfb,(int)uVar7,0x2b);
plVar12 = local_res10;
uVar13 = uVar7 & 0xffffffff;
}
LAB_180068a1a:
if (plVar12 != (longlong *)0x0) {
FUN_18000909c(plVar12);
}
if (pCertContext == (PCCERT_CONTEXT)0x0) {
return uVar13;
}
goto LAB_180068a2c;
}
uVar14 = 0x2b;
uVar10 = 0xfc;
}
uVar13 = 0x80090308;
FUN_18005b470(*(longlong **)(param_1 + 8),uVar10,0x80090308,uVar14);
LAB_180068a2c:
CertFreeCertificateContext(pCertContext);
return uVar13;
}
=========================================
Function at address: 0x180068a7c
Called functions addresses: 0x180006430 0x180015828 0x180028070 0x18002a77b 0x180041cb0 0xEXTERNAL:0000012b 0x18005b470 0xEXTERNAL:000000c0 0x18000a1f4 0xEXTERNAL:00000075 0x18000909c 0x180068834 0xEXTERNAL:000000bc


void FUN_180068a7c(longlong param_1,byte *param_2,int param_3)

{
byte bVar1;
byte bVar2;
longlong lVar3;
uint *puVar4;
int iVar5;
ulonglong uVar6;
ulonglong uVar7;
undefined8 uVar8;
uint *puVar9;
uint uVar10;
longlong *plVar11;
undefined4 uVar12;
byte *pbVar13;
uint uVar14;
undefined uVar15;
ushort uVar16;
uint uVar17;
byte *pbVar18;
undefined auStackY_a8 [32];
uint local_78;
uint local_74;
ushort local_68;
undefined8 local_66;
undefined8 uStack_5e;
undefined8 local_56;
undefined8 uStack_4e;
undefined2 local_46;
ulonglong local_40;

local_40 = DAT_180091970 ^ (ulonglong)auStackY_a8;
uVar7 = 0;
if (((param_2 == (byte *)0x0) || (param_3 == 0)) ||
(lVar3 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x58), lVar3 == 0)) goto LAB_180068e97;
RtlAcquireResourceExclusive(lVar3 + 0x48,1);
if (*(HLOCAL *)(lVar3 + 0x18) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(lVar3 + 0x18));
*(undefined4 *)(lVar3 + 0x20) = 0;
*(undefined8 *)(lVar3 + 0x18) = 0;
}
if (*(HLOCAL *)(lVar3 + 0x28) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(lVar3 + 0x28));
*(undefined8 *)(lVar3 + 0x28) = 0;
}
if (*(PCCERT_CONTEXT *)(lVar3 + 0x30) != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(*(PCCERT_CONTEXT *)(lVar3 + 0x30));
*(undefined8 *)(lVar3 + 0x30) = 0;
}
bVar1 = *param_2;
local_68 = 0;
local_46 = 0;
local_66 = 0;
uStack_5e = 0;
local_56 = 0;
uStack_4e = 0;
if (param_3 == 0) goto LAB_180068b54;
pbVar18 = param_2 + 1;
uVar14 = param_3 - 1;
if (bVar1 != 0) {
plVar11 = *(longlong **)(param_1 + 8);
if (((uVar14 < bVar1) || ((*(uint *)(plVar11 + 8) & 0x40051555) == 0)) ||
((*(int *)((longlong)plVar11 + 0x44) != 0x4e ||
(bVar2 = *(byte *)(plVar11 + 200), bVar1 != bVar2)))) {
iVar5 = -0x7ff6fcf8;
uVar15 = 0x32;
uVar12 = 0xfa;
goto LAB_180068b69;
}
if (plVar11[199] != 0) {
uVar6 = RtlCompareMemory(pbVar18,plVar11[199],(ulonglong)bVar2);
if (uVar6 != bVar2) goto LAB_180068b54;
pbVar18 = pbVar18 + bVar1;
uVar14 = uVar14 - bVar1;
goto LAB_180068bee;
}
goto LAB_180068e7d;
}
LAB_180068bee:
if (uVar14 < 3) {
LAB_180068b54:
iVar5 = -0x7ff6fcf8;
uVar15 = 0x32;
uVar12 = 0xfa;
LAB_180068b65:
plVar11 = *(longlong **)(param_1 + 8);
LAB_180068b69:
FUN_18005b470(plVar11,uVar12,iVar5,uVar15);
}
else {
uVar14 = uVar14 - 3;
uVar10 = (uint)pbVar18[1] * 0x100 + (uint)*pbVar18 * 0x10000 + (uint)pbVar18[2];
pbVar18 = pbVar18 + 3;
if (uVar14 != uVar10) goto LAB_180068b54;
if (uVar10 == 0) {
plVar11 = *(longlong **)(param_1 + 8);
if ((*(uint *)(plVar11 + 8) & 0x800a2aaa) == 0) {
*(undefined *)(plVar11 + 0x45) = 1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x11,&DAT_180082c10);
}
goto LAB_180068e7d;
}
iVar5 = -0x7ff6fcf8;
uVar15 = 0x2a;
uVar12 = 0xfa;
goto LAB_180068b69;
}
local_78 = 0;
local_74 = 0;
pbVar13 = pbVar18;
uVar6 = uVar7;
for (uVar10 = uVar14; uVar10 != 0; uVar10 = uVar10 - uVar16) {
if (uVar10 < 3) goto LAB_180068b54;
uVar17 = (uint)pbVar13[1] * 0x100 + (uint)*pbVar13 * 0x10000 + (uint)pbVar13[2];
if ((uVar10 - 3 < uVar17) || (~(uint)uVar6 < uVar17 + 4)) goto LAB_180068b54;
uVar7 = FUN_180068834(param_1,pbVar13 + 3,uVar17,(int)uVar7,&local_68,lVar3);
if ((int)uVar7 != 0) goto LAB_180068e7d;
local_74 = local_74 + 1;
uVar10 = (uVar10 - 3) - uVar17;
pbVar13 = pbVar13 + 3 + uVar17;
local_78 = local_78 + 4 + uVar17;
if (uVar10 < 2) goto LAB_180068b54;
uVar10 = uVar10 - 2;
uVar16 = CONCAT11(*pbVar13,pbVar13[1]);
if (uVar10 < uVar16) {
iVar5 = -0x7ff6fcf8;
uVar15 = 0x32;
LAB_180068dc0:
uVar12 = 0xfd;
goto LAB_180068b65;
}
uVar8 = FUN_180006430(*(longlong **)(param_1 + 0x10),pbVar13 + 2,(uint)uVar16,0xb);
iVar5 = (int)uVar8;
if (iVar5 != 0) {
uVar15 = 0x6e;
goto LAB_180068dc0;
}
uVar6 = (ulonglong)local_78;
uVar7 = (ulonglong)local_74;
pbVar13 = pbVar13 + 2 + uVar16;
}
plVar11 = *(longlong **)(param_1 + 8);
if ((longlong)plVar11 + 0x1da != 0) {
uVar7 = FUN_180015828((longlong)plVar11 + 0x1da,(short *)&local_68);
if ((char)uVar7 == '\0') {
iVar5 = -0x7ff6fcf8;
uVar15 = 0x28;
uVar12 = 0xfc;
goto LAB_180068b69;
}
puVar9 = (uint *)FUN_18000a1f4(uVar6 & 0xffffffff);
puVar4 = puVar9;
if (puVar9 != (uint *)0x0) {
for (; uVar14 != 0; uVar14 = uVar14 + ((-5 - (uint)CONCAT11(*pbVar13,pbVar13[1])) - uVar10))
{
uVar10 = (uint)pbVar18[1] * 0x100 + (uint)*pbVar18 * 0x10000 + (uint)pbVar18[2];
*puVar4 = uVar10;
memcpy(puVar4 + 1,pbVar18 + 3,(ulonglong)uVar10);
pbVar13 = pbVar18 + 3 + uVar10;
pbVar18 = pbVar13 + (ulonglong)CONCAT11(*pbVar13,pbVar13[1]) + 2;
puVar4 = (uint *)((longlong)(puVar4 + 1) + (ulonglong)uVar10);
}
*(uint *)(lVar3 + 0x20) = local_78;
*(uint **)(lVar3 + 0x18) = puVar9;
}
}
}
LAB_180068e7d:
RtlReleaseResource(lVar3 + 0x48);
LAB_180068e97:
FUN_180028070(local_40 ^ (ulonglong)auStackY_a8);
return;
}
=========================================
Function at address: 0x180068ec4
Called functions addresses: 0x18002a77b 0x180006430 0xEXTERNAL:0000012b 0x180015828 0x180028070 0xEXTERNAL:000000c0 0x18000909c 0xEXTERNAL:00000075 0x180041cb0 0x18000a1f4 0x18005b470 0xEXTERNAL:000000bc 0x180068834


void FUN_180068ec4(longlong param_1,byte *param_2,int param_3)

{
byte bVar1;
byte bVar2;
longlong lVar3;
uint *puVar4;
int iVar5;
ulonglong uVar6;
ulonglong uVar7;
undefined8 uVar8;
uint *puVar9;
uint uVar10;
longlong *plVar11;
undefined4 uVar12;
byte *pbVar13;
uint uVar14;
undefined uVar15;
ushort uVar16;
uint uVar17;
byte *pbVar18;
undefined auStackY_a8 [32];
uint local_78;
uint local_74;
ushort local_68;
undefined8 local_66;
undefined8 uStack_5e;
undefined8 local_56;
undefined8 uStack_4e;
undefined2 local_46;
ulonglong local_40;

local_40 = DAT_180091970 ^ (ulonglong)auStackY_a8;
uVar7 = 0;
if (((param_2 == (byte *)0x0) || (param_3 == 0)) ||
(lVar3 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x58), lVar3 == 0)) goto LAB_1800692df;
RtlAcquireResourceExclusive(lVar3 + 0x48,1);
if (*(HLOCAL *)(lVar3 + 0x18) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(lVar3 + 0x18));
*(undefined4 *)(lVar3 + 0x20) = 0;
*(undefined8 *)(lVar3 + 0x18) = 0;
}
if (*(HLOCAL *)(lVar3 + 0x28) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(lVar3 + 0x28));
*(undefined8 *)(lVar3 + 0x28) = 0;
}
if (*(PCCERT_CONTEXT *)(lVar3 + 0x30) != (PCCERT_CONTEXT)0x0) {
CertFreeCertificateContext(*(PCCERT_CONTEXT *)(lVar3 + 0x30));
*(undefined8 *)(lVar3 + 0x30) = 0;
}
bVar1 = *param_2;
local_68 = 0;
local_46 = 0;
local_66 = 0;
uStack_5e = 0;
local_56 = 0;
uStack_4e = 0;
if (param_3 == 0) goto LAB_180068f9c;
pbVar18 = param_2 + 1;
uVar14 = param_3 - 1;
if (bVar1 != 0) {
plVar11 = *(longlong **)(param_1 + 8);
if (((uVar14 < bVar1) || ((*(uint *)(plVar11 + 8) & 0x40051555) == 0)) ||
((*(int *)((longlong)plVar11 + 0x44) != 0x4e ||
(bVar2 = *(byte *)(plVar11 + 0x9a), bVar1 != bVar2)))) {
iVar5 = -0x7ff6fcf8;
uVar15 = 0x32;
uVar12 = 0xfa;
goto LAB_180068fb1;
}
if (plVar11[0x99] != 0) {
uVar6 = RtlCompareMemory(pbVar18,plVar11[0x99],(ulonglong)bVar2);
if (uVar6 != bVar2) goto LAB_180068f9c;
pbVar18 = pbVar18 + bVar1;
uVar14 = uVar14 - bVar1;
goto LAB_180069036;
}
goto LAB_1800692c5;
}
LAB_180069036:
if (uVar14 < 3) {
LAB_180068f9c:
iVar5 = -0x7ff6fcf8;
uVar15 = 0x32;
uVar12 = 0xfa;
LAB_180068fad:
plVar11 = *(longlong **)(param_1 + 8);
LAB_180068fb1:
FUN_18005b470(plVar11,uVar12,iVar5,uVar15);
}
else {
uVar14 = uVar14 - 3;
uVar10 = (uint)pbVar18[1] * 0x100 + (uint)*pbVar18 * 0x10000 + (uint)pbVar18[2];
pbVar18 = pbVar18 + 3;
if (uVar14 != uVar10) goto LAB_180068f9c;
if (uVar10 == 0) {
plVar11 = *(longlong **)(param_1 + 8);
if ((*(uint *)(plVar11 + 8) & 0x800a2aaa) == 0) {
*(undefined *)(plVar11 + 0x45) = 1;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x11,&DAT_180082c10);
}
goto LAB_1800692c5;
}
iVar5 = -0x7ff6fcf8;
uVar15 = 0x2a;
uVar12 = 0xfa;
goto LAB_180068fb1;
}
local_78 = 0;
local_74 = 0;
pbVar13 = pbVar18;
uVar6 = uVar7;
for (uVar10 = uVar14; uVar10 != 0; uVar10 = uVar10 - uVar16) {
if (uVar10 < 3) goto LAB_180068f9c;
uVar17 = (uint)pbVar13[1] * 0x100 + (uint)*pbVar13 * 0x10000 + (uint)pbVar13[2];
if ((uVar10 - 3 < uVar17) || (~(uint)uVar6 < uVar17 + 4)) goto LAB_180068f9c;
uVar7 = FUN_180068834(param_1,pbVar13 + 3,uVar17,(int)uVar7,&local_68,lVar3);
if ((int)uVar7 != 0) goto LAB_1800692c5;
local_74 = local_74 + 1;
uVar10 = (uVar10 - 3) - uVar17;
pbVar13 = pbVar13 + 3 + uVar17;
local_78 = local_78 + 4 + uVar17;
if (uVar10 < 2) goto LAB_180068f9c;
uVar10 = uVar10 - 2;
uVar16 = CONCAT11(*pbVar13,pbVar13[1]);
if (uVar10 < uVar16) {
iVar5 = -0x7ff6fcf8;
uVar15 = 0x32;
LAB_180069208:
uVar12 = 0xfd;
goto LAB_180068fad;
}
uVar8 = FUN_180006430(*(longlong **)(param_1 + 0x10),pbVar13 + 2,(uint)uVar16,0xb);
iVar5 = (int)uVar8;
if (iVar5 != 0) {
uVar15 = 0x6e;
goto LAB_180069208;
}
uVar6 = (ulonglong)local_78;
uVar7 = (ulonglong)local_74;
pbVar13 = pbVar13 + 2 + uVar16;
}
plVar11 = *(longlong **)(param_1 + 8);
if ((longlong)plVar11 + 0x1da != 0) {
uVar7 = FUN_180015828((longlong)plVar11 + 0x1da,(short *)&local_68);
if ((char)uVar7 == '\0') {
iVar5 = -0x7ff6fcf8;
uVar15 = 0x28;
uVar12 = 0xfc;
goto LAB_180068fb1;
}
puVar9 = (uint *)FUN_18000a1f4(uVar6 & 0xffffffff);
puVar4 = puVar9;
if (puVar9 != (uint *)0x0) {
for (; uVar14 != 0; uVar14 = uVar14 + ((-5 - (uint)CONCAT11(*pbVar13,pbVar13[1])) - uVar10))
{
uVar10 = (uint)pbVar18[1] * 0x100 + (uint)*pbVar18 * 0x10000 + (uint)pbVar18[2];
*puVar4 = uVar10;
memcpy(puVar4 + 1,pbVar18 + 3,(ulonglong)uVar10);
pbVar13 = pbVar18 + 3 + uVar10;
pbVar18 = pbVar13 + (ulonglong)CONCAT11(*pbVar13,pbVar13[1]) + 2;
puVar4 = (uint *)((longlong)(puVar4 + 1) + (ulonglong)uVar10);
}
*(uint *)(lVar3 + 0x20) = local_78;
*(uint **)(lVar3 + 0x18) = puVar9;
}
}
}
LAB_1800692c5:
RtlReleaseResource(lVar3 + 0x48);
LAB_1800692df:
FUN_180028070(local_40 ^ (ulonglong)auStackY_a8);
return;
}
=========================================
Function at address: 0x18006930c
Called functions addresses: 0x180006430 0x18006ec64 0x18005b470


ulonglong FUN_18006930c(longlong param_1,byte *param_2,int param_3)

{
byte bVar1;
ulonglong uVar2;
undefined8 uVar3;
longlong *plVar4;
undefined4 uVar5;
uint uVar6;
byte *pbVar7;
undefined uVar8;

if ((param_2 == (byte *)0x0) || (param_3 == 0)) {
return 0x57;
}
plVar4 = *(longlong **)(param_1 + 8);
if (param_3 != 0) {
bVar1 = *param_2;
pbVar7 = param_2 + 1;
uVar6 = param_3 - 1;
if (bVar1 == 0) {
if ((*(int *)((longlong)plVar4 + 0x44) == 0x4e) &&
(uVar2 = FUN_18006ec64((longlong)plVar4,(void *)0x0,0), (int)uVar2 != 0)) {
return uVar2;
}
}
else {
if ((*(int *)((longlong)plVar4 + 0x44) != 0x4e) || (uVar6 < bVar1)) goto LAB_18006934a;
uVar2 = FUN_18006ec64((longlong)plVar4,pbVar7,bVar1);
if ((int)uVar2 != 0) {
return uVar2;
}
pbVar7 = pbVar7 + bVar1;
uVar6 = uVar6 - bVar1;
}
if (1 < uVar6) {
if ((CONCAT11(*pbVar7,pbVar7[1]) != 0) && ((uint)CONCAT11(*pbVar7,pbVar7[1]) <= uVar6 - 2)) {
uVar3 = FUN_180006430(*(longlong **)(param_1 + 0x10),pbVar7 + 2,uVar6 - 2,0xd);
plVar4 = *(longlong **)(param_1 + 8);
uVar6 = (uint)uVar3;
if (uVar6 != 0) {
uVar8 = 0x6e;
uVar5 = 0x193;
goto LAB_180069357;
}
if ((short *)((longlong)plVar4 + 0x1fe) == (short *)0x0) {
return 0x80090304;
}
if (*(short *)((longlong)plVar4 + 0x1fe) != 0) {
return 0;
}
goto LAB_18006934a;
}
}
plVar4 = *(longlong **)(param_1 + 8);
}
LAB_18006934a:
uVar6 = 0x80090308;
uVar5 = 400;
uVar8 = 0x28;
LAB_180069357:
FUN_18005b470(plVar4,uVar5,uVar6,uVar8);
return (ulonglong)uVar6;
}
=========================================
Function at address: 0x180069444
Called functions addresses: 0x1800051c0 0x180005298 0xEXTERNAL:000000c2 0x18005b470 0x180065360 0x180013bc8 0xEXTERNAL:000000c0 0x18006a4e0


ulonglong FUN_180069444(longlong param_1,ushort *param_2,uint param_3)

{
longlong lVar1;
longlong lVar2;
longlong lVar3;
ushort uVar4;
int iVar5;
DWORD DVar6;
longlong *plVar7;
undefined4 uVar8;
ulonglong uVar9;
undefined uVar10;
int local_res10 [2];

if ((param_2 == (ushort *)0x0) || (param_3 == 0)) {
return 0x57;
}
if (param_3 < 2) {
plVar7 = *(longlong **)(param_1 + 8);
uVar10 = 0x32;
uVar8 = 0x519;
LAB_18006948d:
uVar9 = 0x80090308;
FUN_18005b470(plVar7,uVar8,0x80090308,uVar10);
}
else {
uVar4 = *param_2;
lVar2 = *(longlong *)(param_1 + 8) + 0x1da;
if ((lVar2 == 0) || (lVar3 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x58), lVar3 == 0)) {
return 0x54f;
}
lVar1 = lVar3 + 0x48;
RtlAcquireResourceShared(lVar1,1);
lVar3 = *(longlong *)(lVar3 + 0x30);
if (lVar3 == 0) {
uVar9 = 0x54f;
}
else {
uVar9 = FUN_180065360(param_1,lVar3);
iVar5 = (int)uVar9;
uVar9 = uVar9 & 0xffffffff;
if (iVar5 == 0) {
local_res10[0] = iVar5;
if (*(int *)(param_1 + 0x68) == 3) {
DVar6 = FUN_180013bc8(lVar3,local_res10);
uVar9 = (ulonglong)DVar6;
if (DVar6 != 0) goto LAB_18006952c;
}
iVar5 = local_res10[0];
RtlReleaseResource(lVar1);
plVar7 = *(longlong **)(param_1 + 8);
uVar9 = FUN_180005298(lVar2,uVar4,*(uint *)(plVar7 + 8),iVar5);
if ((char)uVar9 == '\0') {
uVar10 = 0x2f;
uVar8 = 0x51b;
}
else {
local_res10[0] = 0;
FUN_1800051c0(uVar4,local_res10,(undefined4 *)(param_1 + 100),(undefined4 *)0x0,
(longlong *)(param_1 + 0x70),(uint *)0x0,(undefined4 *)0x0);
if ((((local_res10[0] != 0) && (local_res10[0] == *(int *)(param_1 + 0x68))) &&
(*(int *)(param_1 + 100) != 0)) && (*(longlong *)(param_1 + 0x70) != 0)) {
uVar9 = FUN_18006a4e0(param_1,(undefined *)(param_2 + 1),param_3 - 2);
return uVar9;
}
plVar7 = *(longlong **)(param_1 + 8);
uVar10 = 0x28;
uVar8 = 0x51b;
}
goto LAB_18006948d;
}
}
LAB_18006952c:
RtlReleaseResource(lVar1);
}
return uVar9;
}
=========================================
Function at address: 0x18006961c
Called functions addresses: 0x180006430 0x18005b470


int FUN_18006961c(longlong param_1,undefined *param_2,uint param_3)

{
int iVar1;
undefined8 uVar2;
longlong *plVar3;

if ((param_2 == (undefined *)0x0) || (param_3 == 0)) {
iVar1 = 0x57;
}
else {
if (param_3 < 2) {
plVar3 = *(longlong **)(param_1 + 8);
iVar1 = -0x7ff6fcf8;
}
else {
if (param_3 - 2 == (uint)CONCAT11(*param_2,param_2[1])) {
uVar2 = FUN_180006430(*(longlong **)(param_1 + 0x10),param_2 + 2,param_3 - 2,8);
iVar1 = (int)uVar2;
if (iVar1 == 0) {
return 0;
}
}
else {
iVar1 = -0x7ff6fcf8;
}
plVar3 = *(longlong **)(param_1 + 8);
}
FUN_18005b470(plVar3,0x78,iVar1,0x32);
}
return iVar1;
}
=========================================
Function at address: 0x1800696a8
Called functions addresses: 0x180059d04 0x18002a76f 0x180041cb0 0x180012184 0x18005b470 0x18006880c 0x180028070 0xEXTERNAL:00000115 0x18002a7c0


void FUN_1800696a8(longlong param_1,void *param_2,uint param_3)

{
uint uVar1;
int iVar2;
undefined8 *puVar3;
longlong lVar4;
undefined8 uVar5;
longlong *plVar6;
undefined4 uVar7;
undefined uVar8;
undefined auStack_98 [32];
uint local_78;
undefined4 local_70;
undefined local_68 [64];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_98;
if ((param_2 != (void *)0x0) && (param_3 != 0)) {
plVar6 = *(longlong **)(param_1 + 8);
if ((plVar6[1] != 0) &&
(puVar3 = FUN_180059d04(*(int *)(plVar6[1] + 0x2c)), puVar3 != (undefined8 *)0x0)) {
uVar1 = *(uint *)((longlong)puVar3 + 0x1c);
if (uVar1 < 0x41) {
if (param_3 == uVar1) {
lVar4 = FUN_18006880c((longlong)(plVar6 + 0xab),(*(uint *)(plVar6 + 8) & 0x800a2aaa) == 0)
;
if (lVar4 == 0) goto LAB_18006984e;

plVar6 = *(longlong **)(*(longlong *)(param_1 + 8) + 8);
if (plVar6 != (longlong *)0x0) {
plVar6 = (longlong *)*plVar6;
}
local_70 = 0;
local_78 = uVar1;
iVar2 = SslComputeFinishedHash(plVar6,lVar4,uVar5,local_68);
if (iVar2 != 0) {
FUN_180012184(*(longlong *)(param_1 + 8),0x386,iVar2);
goto LAB_18006984e;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180082c10);
}
puVar3 = DAT_180091000;
iVar2 = memcmp(local_68,param_2,(ulonglong)uVar1);
if (iVar2 == 0) goto LAB_18006984e;
if (((undefined8 **)puVar3 != &DAT_180091000) &&
((*(byte *)((longlong)puVar3 + 0x1c) & 1) != 0)) {
FUN_180041cb0(puVar3[2],0x14,&DAT_180082c10);
}
plVar6 = *(longlong **)(param_1 + 8);
uVar8 = 0x33;
uVar7 = 900;
}
else {
uVar8 = 0x32;
uVar7 = 0x387;
}
FUN_18005b470(plVar6,uVar7,0x80090308,uVar8);
}
}
}
LAB_18006984e:
FUN_180028070(local_28 ^ (ulonglong)auStack_98);
return;
}
=========================================
Function at address: 0x18006987c
Called functions addresses: 0x180059d04 0x18002a76f 0x180041cb0 0x180012184 0x18005b470 0x18006880c 0x180028070 0xEXTERNAL:00000115 0x18002a7c0


void FUN_18006987c(longlong param_1,void *param_2,uint param_3)

{
uint uVar1;
int iVar2;
undefined8 *puVar3;
longlong lVar4;
undefined8 uVar5;
longlong *plVar6;
undefined4 uVar7;
undefined uVar8;
undefined auStack_98 [32];
uint local_78;
undefined4 local_70;
undefined local_68 [64];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_98;
if ((param_2 != (void *)0x0) && (param_3 != 0)) {
plVar6 = *(longlong **)(param_1 + 8);
if ((plVar6[1] != 0) &&
(puVar3 = FUN_180059d04(*(int *)(plVar6[1] + 0x2c)), puVar3 != (undefined8 *)0x0)) {
uVar1 = *(uint *)((longlong)puVar3 + 0x1c);
if (uVar1 < 0x41) {
if (param_3 == uVar1) {
lVar4 = FUN_18006880c((longlong)(plVar6 + 0x7d),(*(uint *)(plVar6 + 8) & 0x800a2aaa) == 0)
;
if (lVar4 == 0) goto LAB_180069a22;

plVar6 = *(longlong **)(*(longlong *)(param_1 + 8) + 8);
if (plVar6 != (longlong *)0x0) {
plVar6 = (longlong *)*plVar6;
}
local_70 = 0;
local_78 = uVar1;
iVar2 = SslComputeFinishedHash(plVar6,lVar4,uVar5,local_68);
if (iVar2 != 0) {
FUN_180012184(*(longlong *)(param_1 + 8),0x386,iVar2);
goto LAB_180069a22;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180082c10);
}
puVar3 = DAT_180091000;
iVar2 = memcmp(local_68,param_2,(ulonglong)uVar1);
if (iVar2 == 0) goto LAB_180069a22;
if (((undefined8 **)puVar3 != &DAT_180091000) &&
((*(byte *)((longlong)puVar3 + 0x1c) & 1) != 0)) {
FUN_180041cb0(puVar3[2],0x14,&DAT_180082c10);
}
plVar6 = *(longlong **)(param_1 + 8);
uVar8 = 0x33;
uVar7 = 900;
}
else {
uVar8 = 0x32;
uVar7 = 0x387;
}
FUN_18005b470(plVar6,uVar7,0x80090308,uVar8);
}
}
}
LAB_180069a22:
FUN_180028070(local_28 ^ (ulonglong)auStack_98);
return;
}
=========================================
Function at address: 0x180069a50
Called functions addresses: 0x180041cb0 0x18005b470 0x18002a7c0


undefined8 FUN_180069a50(longlong param_1,char *param_2,int param_3)

{
undefined8 uVar1;
longlong *plVar2;
undefined4 uVar3;
undefined uVar4;

if ((param_2 == (char *)0x0) || (param_3 == 0)) {
return 0x57;
}
if (param_3 == 1) {
if (*param_2 != '\0') {
plVar2 = *(longlong **)(param_1 + 8);
if (*param_2 != '\x01') {
uVar4 = 0x2f;
uVar3 = 0x643;
goto LAB_180069a7d;
}
if ((*(uint *)(plVar2 + 0x11) >> 0xc & 1) == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180082c10);
plVar2 = *(longlong **)(param_1 + 8);
}

}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x10,&DAT_180082c10);
}
}
uVar1 = 0;
}
else {
plVar2 = *(longlong **)(param_1 + 8);
uVar4 = 0x32;
uVar3 = 0x642;
LAB_180069a7d:
FUN_18005b470(plVar2,uVar3,0x80090308,uVar4);
uVar1 = 0x80090308;
}
return uVar1;
}
=========================================
Function at address: 0x180069b50
Called functions addresses: 0x180002bf0 0x180041cdc 0x18002a77b 0x18000909c 0x180006430 0x18000a1f4 0x18005b470 0xEXTERNAL:000000bc 0xEXTERNAL:000000c0 0x18002a7c0


int FUN_180069b50(longlong param_1,uint *param_2,uint param_3)

{
byte bVar1;
uint uVar2;
longlong lVar3;
uint uVar4;
void *_Dst;
void *_Dst_00;
undefined8 uVar5;
longlong *plVar6;
undefined4 uVar7;
ushort uVar8;
int iVar9;
undefined *puVar10;
uint uVar11;
ulonglong _Size;
uint uVar12;
longlong local_48 [2];

_Dst = (HLOCAL)0x0;
_Dst_00 = (void *)0x0;
if ((param_2 == (uint *)0x0) || (param_3 == 0)) {
return 0x57;
}
if (param_3 < 4) {
uVar7 = 0x578;
}
else {
uVar4 = *param_2;
uVar4 = uVar4 >> 0x18 | (uVar4 & 0xff0000) >> 8 | (uVar4 & 0xff00) << 8 | uVar4 << 0x18;
if (uVar4 < 0x93a81) {
if ((3 < param_3 - 4) && (uVar2 = param_2[1], param_3 != 8)) {
bVar1 = *(byte *)(param_2 + 2);
_Size = (ulonglong)bVar1;
if ((uint)bVar1 <= param_3 - 9) {
if (bVar1 != 0) {
_Dst = (void *)FUN_18000a1f4(_Size);
if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,(void *)((longlong)param_2 + 9),_Size);
}
puVar10 = (undefined *)((longlong)param_2 + 9 + _Size);
uVar11 = (param_3 - 9) - (uint)bVar1;
if (uVar11 < 2) {
LAB_180069dba:
plVar6 = *(longlong **)(param_1 + 8);
iVar9 = -0x7ff6fcf8;
uVar7 = 0x578;
}
else {
uVar11 = uVar11 - 2;
uVar8 = CONCAT11(*puVar10,puVar10[1]);
if ((uVar8 == 0) || (uVar11 < uVar8)) goto LAB_180069dba;
_Dst_00 = (void *)FUN_18000a1f4((ulonglong)(uint)uVar8);
if (_Dst_00 == (void *)0x0) {
iVar9 = 0xe;
goto LAB_180069dd3;
}
memcpy(_Dst_00,puVar10 + 2,(ulonglong)uVar8);
uVar12 = (uint)uVar8;
uVar11 = uVar11 - uVar12;
if ((uVar11 < 2) ||
(uVar11 = uVar11 - 2,
uVar11 != CONCAT11(puVar10[(ulonglong)uVar8 + 2],puVar10[(ulonglong)uVar8 + 3])))
goto LAB_180069dba;
uVar5 = FUN_180006430(*(longlong **)(param_1 + 0x10),puVar10 + (ulonglong)uVar8 + 4,
uVar11,4);
plVar6 = *(longlong **)(param_1 + 8);
iVar9 = (int)uVar5;
if (iVar9 == 0) {
lVar3 = plVar6[10];
if (lVar3 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1e,&DAT_180082c10,uVar12);
plVar6 = *(longlong **)(param_1 + 8);
}
local_48[0] = 0;

RtlAcquireResourceExclusive(local_48[0] + 0x48,1);
FUN_180002bf0(local_48[0],_Dst_00,uVar12,_Dst,bVar1,uVar2,uVar4,
*(uint *)(lVar3 + 0xd0),*(uint *)(*(longlong *)(param_1 + 8) + 0x40));
RtlReleaseResource(local_48[0] + 0x48);
return 0;
}
iVar9 = -0x7ff6fcfc;
goto LAB_180069dd3;
}
uVar7 = 0x57b;
}
FUN_18005b470(plVar6,uVar7,iVar9,0x32);
LAB_180069dd3:
if (_Dst != (HLOCAL)0x0) {
FUN_18000909c(_Dst);
}
if (_Dst_00 == (HLOCAL)0x0) {
return iVar9;
}
FUN_18000909c(_Dst_00);
return iVar9;
}
}
plVar6 = *(longlong **)(param_1 + 8);
uVar7 = 0x578;
goto LAB_180069b97;
}
uVar7 = 0x57b;
}
plVar6 = *(longlong **)(param_1 + 8);
LAB_180069b97:
FUN_18005b470(plVar6,uVar7,0x80090308,0x32);
return -0x7ff6fcf8;
}
=========================================
Function at address: 0x180069e18
Called functions addresses: 0x180006430 0x180059d04 0x18000d31c 0x18000629c 0xEXTERNAL:000000c2 0x18005d5d4 0x18006a430 0xEXTERNAL:000000c0 0x180006300 0x18006ba8c 0x18000909c 0xEXTERNAL:00000075 0x1800087d0 0x180041cb0 0x18006a470 0x18005b470 0xEXTERNAL:000000bc 0x180005fc4 0x18002a7c0


ulonglong FUN_180069e18(longlong param_1,undefined *param_2,uint param_3)

{
byte bVar1;
undefined uVar2;
int iVar3;
undefined4 uVar4;
undefined4 uVar5;
bool bVar6;
longlong lVar7;
ulonglong uVar8;
undefined8 uVar9;
undefined8 *puVar10;
longlong *plVar11;
longlong lVar12;
undefined4 uVar13;
uint uVar14;
char cVar15;
undefined uVar16;
undefined *puVar17;
uint uVar18;
uint local_res10 [4];
longlong local_res20;

if ((param_2 == (undefined *)0x0) || (param_3 == 0)) {
return 0x57;
}
lVar7 = *(longlong *)(param_1 + 8);
*(undefined2 *)(lVar7 + 0x72e) = 0;
*(undefined8 *)(lVar7 + 0x730) = 0;
*(undefined2 *)(lVar7 + 0x738) = 0;
plVar11 = *(longlong **)(param_1 + 8);
iVar3 = *(int *)((longlong)plVar11 + 0x44);
if (param_3 < 2) {
LAB_18006a402:
uVar16 = 0x32;
LAB_180069eaa:
uVar13 = 100;
LAB_180069eaf:
uVar14 = 0x80090308;
}
else {
uVar18 = (uint)CONCAT11(*param_2,param_2[1]);
if (uVar18 < 0x300) {
LAB_180069ea7:
uVar16 = 0x46;
goto LAB_180069eaa;
}
bVar6 = false;
if (*(char *)((longlong)plVar11 + 0xe9) == '\0') {
if (0x303 < uVar18) goto LAB_180069ea7;
}
else if (uVar18 < 0xfefd) goto LAB_180069ea7;
if (param_3 - 2 < 0x20) goto LAB_18006a402;
uVar13 = *(undefined4 *)(param_2 + 6);
uVar4 = *(undefined4 *)(param_2 + 10);
uVar5 = *(undefined4 *)(param_2 + 0xe);
*(undefined4 *)(plVar11 + 0x26) = *(undefined4 *)(param_2 + 2);
*(undefined4 *)((longlong)plVar11 + 0x134) = uVar13;
*(undefined4 *)(plVar11 + 0x27) = uVar4;
*(undefined4 *)((longlong)plVar11 + 0x13c) = uVar5;
uVar13 = *(undefined4 *)(param_2 + 0x16);
uVar4 = *(undefined4 *)(param_2 + 0x1a);
uVar5 = *(undefined4 *)(param_2 + 0x1e);
*(undefined4 *)(plVar11 + 0x28) = *(undefined4 *)(param_2 + 0x12);
*(undefined4 *)((longlong)plVar11 + 0x144) = uVar13;
*(undefined4 *)(plVar11 + 0x29) = uVar4;
*(undefined4 *)((longlong)plVar11 + 0x14c) = uVar5;
lVar7 = RtlCompareMemory(*(longlong *)(param_1 + 8) + 0x130,&DAT_1800858b0,0x20);
local_res20 = CONCAT71(local_res20._1_7_,lVar7 == 0x20);
uVar13 = 100;
if (lVar7 == 0x20) {
*(undefined4 *)(*(longlong *)(param_1 + 8) + 0x44) = 100;
FUN_18006a430(*(longlong *)(param_1 + 8),0);
if (*(HLOCAL *)(param_1 + 0x38) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x38));
*(undefined8 *)(param_1 + 0x38) = 0;
}
}
else {
*(undefined4 *)(*(longlong *)(param_1 + 8) + 0x44) = 0x46;
}
if (param_3 == 0x22) {
LAB_180069f5f:
uVar13 = 100;
LAB_180069f61:
plVar11 = *(longlong **)(param_1 + 8);
uVar16 = 0x32;
goto LAB_180069eaf;
}
bVar1 = param_2[0x22];
if ((param_3 - 0x23 < (uint)bVar1) || (0x20 < bVar1)) goto LAB_180069f5f;
if (bVar1 == *(byte *)(*(longlong *)(param_1 + 8) + 0x671)) {
uVar8 = RtlCompareMemory(*(longlong *)(param_1 + 8) + 0x651,param_2 + 0x23,(uint)bVar1);
local_res10[0] = CONCAT31(local_res10[0]._1_3_,1);
if (uVar8 != bVar1) goto LAB_180069fb4;
}
else {
LAB_180069fb4:
local_res10[0] = local_res10[0] & 0xffffff00;
}
puVar17 = param_2 + 0x23 + bVar1;
uVar14 = (param_3 - 0x23) - (uint)bVar1;
if ((uVar14 < 2) || (uVar16 = puVar17[1], uVar2 = *puVar17, uVar14 == 2)) goto LAB_180069f5f;
cVar15 = puVar17[2];
if (1 < uVar14 - 3) {
bVar6 = true;
if (uVar14 - 5 == (uint)CONCAT11(puVar17[3],puVar17[4])) {
uVar9 = FUN_180006430(*(longlong **)(param_1 + 0x10),puVar17 + 5,uVar14 - 5,2);
uVar14 = (uint)uVar9;
if (uVar14 == 0) goto LAB_18006a05c;
if (uVar14 == 0x80090331) goto LAB_180069ebc;
plVar11 = *(longlong **)(param_1 + 8);
uVar16 = 0x32;
uVar13 = 0x6a;
goto LAB_180069eb7;
}
uVar13 = 0x6a;
goto LAB_180069f61;
}
LAB_18006a05c:
if (*(char *)(*(longlong *)(param_1 + 0x10) + 0x1b) == '\0') {
plVar11 = *(longlong **)(param_1 + 8);
lVar7 = plVar11[10];
if (lVar7 == 0) {
return 0x80090304;
}
uVar9 = FUN_180005fc4(uVar18);
uVar18 = (uint)uVar9 & *(uint *)(lVar7 + 0x98) & 0xa2aa0;
if (uVar18 == 0) {
FUN_18005b470(plVar11,0x69,0x80090331,0x46);
return 0x80090331;
}
*(uint *)(plVar11 + 8) = uVar18;
uVar9 = FUN_18000d31c(uVar18);
*(short *)((longlong)plVar11 + 0x22) = (short)uVar9;
}
plVar11 = *(longlong **)(param_1 + 8);
if (*(int *)(plVar11 + 8) != 0x2000) {
if (iVar3 == 0x47) {
FUN_18005b470(plVar11,0xb,0x80090331,0x46);
return 0x80090331;
}
return 0;
}
uVar18 = 0;
lVar7 = 0;
if (!bVar6) {
uVar16 = 0x32;
uVar13 = 0x6a;
goto LAB_180069eaf;
}
if (cVar15 == '\0') {
if ((char)local_res10[0] == '\0') {
uVar16 = 0x2f;
uVar14 = 0x80090326;
uVar13 = 0x67;
}
else {
cVar15 = (char)local_res20;
if (iVar3 == 0x47) {
if ((char)local_res20 != '\0') {
uVar16 = 10;
uVar14 = 0x80090326;
uVar13 = 0x6d;
goto LAB_180069eb7;
}
if (((*(byte *)(plVar11 + 4) & 1) != 0) && (plVar11[1] != 0)) {
uVar18 = *(uint *)(plVar11[1] + 0x1c);
}
if (uVar18 != CONCAT11(uVar2,uVar16)) goto LAB_18006a181;
LAB_18006a3db:
uVar14 = FUN_18006a470(*(longlong *)(param_1 + 8));
if (uVar14 == 0) goto LAB_180069ebc;
plVar11 = *(longlong **)(param_1 + 8);
uVar16 = 0x32;
uVar13 = 0x6a;
}
else if (((char)local_res20 == '\0') ||
(*(short *)((longlong)plVar11 + 0x72c) != *(short *)(param_1 + 0x2c))) {
uVar14 = FUN_1800087d0(plVar11,plVar11,(uint)CONCAT11(uVar2,uVar16));
plVar11 = *(longlong **)(param_1 + 8);
if (uVar14 == 0) {
if ((*(uint *)(plVar11 + 0x11) >> 0xf & 1) == 0) {
lVar12 = plVar11[0xb];
if (lVar12 == 0) {
return 0x80090304;
}
RtlAcquireResourceShared(lVar12 + 0x48);
local_res10[0] = 0;
uVar8 = FUN_18005d5d4(lVar12,(undefined *)0x0,local_res10);
RtlReleaseResource(lVar12 + 0x48);
if ((int)uVar8 != 0) {
return uVar8 & 0xffffffff;
}
if (local_res10[0] == 0) {
return 0x80090304;
}
plVar11 = *(longlong **)(param_1 + 8);
if (plVar11[1] == 0) {
return 0x80090304;
}
uVar14 = local_res10[0];
puVar10 = FUN_180059d04(*(int *)(plVar11[1] + 0x2c));
if (puVar10 == (undefined8 *)0x0) {
return 0x80090304;
}
if (uVar14 != *(uint *)(puVar10 + 4)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180082c10);
plVar11 = *(longlong **)(param_1 + 8);
}
uVar16 = 0x2f;
uVar14 = 0x80090326;
goto LAB_180069eb7;
}
}
local_res20 = 0;

FUN_18000629c(plVar11,*(byte **)(local_res20 + 0x170),(uint *)0x0);
RtlAcquireResourceExclusive(local_res20 + 0x48,1);
*(undefined4 *)(local_res20 + 0xa8) = *(undefined4 *)(*(longlong *)(param_1 + 8) + 0x40)
;
lVar12 = local_res20 + 0x48;
RtlReleaseResource();
FUN_180006300(lVar12,*(byte **)(local_res20 + 0x170),(uint *)0x0);
*(undefined *)(*(longlong *)(param_1 + 8) + 0x154) = 0;
if (cVar15 != '\0') {
lVar12 = *(longlong *)(param_1 + 8);
if (((*(byte *)(lVar12 + 0x20) & 1) == 0) ||
(plVar11 = *(longlong **)(lVar12 + 8), plVar11 == (longlong *)0x0)) {
plVar11 = *(longlong **)(lVar12 + 8);
if (plVar11 != (longlong *)0x0) goto LAB_18006a388;
}
else {
uVar18 = *(uint *)((longlong)plVar11 + 0x1c);
LAB_18006a388:
lVar7 = *plVar11;
}
uVar8 = FUN_18006ba8c(lVar12,lVar7,uVar18,*(void **)(lVar12 + 0x370),
(uint *)(lVar12 + 0x368));
if ((int)uVar8 != 0) {
return uVar8;
}
}

if ((int)uVar8 != 0) {
return uVar8;
}
uVar14 = 0;
if (cVar15 != '\0') goto LAB_180069ebc;
goto LAB_18006a3db;
}
uVar16 = 0x28;
uVar13 = 0x6b;
}
else {
LAB_18006a181:
uVar16 = 0x2f;
uVar14 = 0x80090326;
}
}
}
else {
uVar16 = 0x1e;
uVar14 = 0x80090326;
uVar13 = 0x68;
}
}
LAB_180069eb7:
FUN_18005b470(plVar11,uVar13,uVar14,uVar16);
LAB_180069ebc:
return (ulonglong)uVar14;
}
=========================================
Function at address: 0x18006a430
Called functions addresses: 0xEXTERNAL:0000011c


void FUN_18006a430(longlong param_1,undefined8 param_2)

{
if (*(longlong *)(param_1 + 0x70) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x70),0);
}
*(undefined8 *)(param_1 + 0x70) = param_2;
return;
}
=========================================
Function at address: 0x18006a470
Called functions addresses: 0x18006edf0 0x180005324


int FUN_18006a470(longlong param_1)

{
int iVar1;
undefined8 uVar2;

if (*(undefined8 **)(param_1 + 8) == (undefined8 *)0x0) {
uVar2 = 0;
}
else {
uVar2 = **(undefined8 **)(param_1 + 8);
}
iVar1 = FUN_18006edf0(param_1 + 0x558,*(ushort *)(param_1 + 0x72e),*(char **)(param_1 + 0x730),
*(ushort *)(param_1 + 0x738),uVar2);
if (iVar1 == 0) {
FUN_180005324(param_1,(uint)*(ushort *)(param_1 + 0x72e));
}
return iVar1;
}
=========================================
Function at address: 0x18006a4e0
Called functions addresses: 0x180001e7c 0x18002a77b 0xEXTERNAL:00000123 0x18006581c 0xEXTERNAL:000000c2 0x180028070 0xEXTERNAL:000000c0 0xEXTERNAL:00000168 0xEXTERNAL:0000014e 0xEXTERNAL:00000170 0x18000909c 0xEXTERNAL:00000041 0x180028d90 0x18000a1f4 0x18005b470 0xEXTERNAL:00000169 0x18006a8f8


void FUN_18006a4e0(longlong param_1,undefined *param_2,uint param_3)

{
PCERT_PUBLIC_KEY_INFO pInfo;
longlong lVar1;
DWORD *pDVar2;
NTSTATUS NVar3;
BOOL BVar4;
uint *puVar5;
longlong *plVar6;
undefined4 uVar7;
undefined8 uVar8;
undefined7 uVar9;
undefined8 *pPaddingInfo;
ulonglong uVar10;
uint *puVar11;
undefined uVar12;
DWORD DVar13;
uint uVar14;
PUCHAR pbEncoded;
undefined auStackY_f8 [32];
ULONG dwFlags;
DWORD local_b8;
uint local_b4;
uint local_b0 [2];
BCRYPT_KEY_HANDLE local_a8;
ULONG local_a0 [2];
undefined8 local_98;
ULONG local_90;
UCHAR local_88 [64];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_f8;
local_a8 = (BCRYPT_HANDLE)0x0;
puVar11 = (uint *)0x0;
puVar5 = (uint *)0x0;
if ((param_2 == (undefined *)0x0) || (param_3 == 0)) goto LAB_18006a8ae;
if (param_3 < 2) {
plVar6 = *(longlong **)(param_1 + 8);
DVar13 = 0x80090308;
uVar12 = 0x32;
uVar7 = 0x519;
}
else {
pbEncoded = param_2 + 2;
DVar13 = param_3 - 2;
puVar5 = puVar11;
if (DVar13 == CONCAT11(*param_2,param_2[1])) {
uVar8 = 0;
memset(local_88,0,0x40);
local_b4 = 0;
uVar9 = (undefined7)((ulonglong)uVar8 >> 8);
NVar3 = FUN_18006581c(param_1,(*(uint *)(*(longlong *)(param_1 + 8) + 0x40) & 0x40051555) == 0
,*(int *)(param_1 + 100),(wchar_t *)0x0,local_88,0x40,&local_b4);
if ((NVar3 != 0) || (lVar1 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x58), lVar1 == 0))
goto LAB_18006a8ae;
RtlAcquireResourceShared(lVar1 + 0x48,CONCAT71(uVar9,1));
pDVar2 = *(DWORD **)(lVar1 + 0x30);
if ((pDVar2 != (DWORD *)0x0) &&
((*(longlong *)(pDVar2 + 6) != 0 &&
(pInfo = (PCERT_PUBLIC_KEY_INFO)(*(longlong *)(pDVar2 + 6) + 0x60),
pInfo != (PCERT_PUBLIC_KEY_INFO)0x0)))) {
BVar4 = CryptImportPublicKeyInfoEx2(*pDVar2,pInfo,0x80000000,(void *)0x0,&local_a8);
if (BVar4 != 0) {
RtlReleaseResource(lVar1 + 0x48);
if (*(int *)(param_1 + 0x68) != 1) {
if (*(int *)(param_1 + 0x68) != 3) goto LAB_18006a8ae;
local_b8 = 0;
BVar4 = CryptDecodeObject(1,(LPCSTR)0x2f,pbEncoded,DVar13,0,(void *)0x0,&local_b8);
if (BVar4 == 0) {
LAB_18006a6c6:
DVar13 = GetLastError();
}
else {
puVar5 = (uint *)FUN_18000a1f4((ulonglong)local_b8);
if (puVar5 == (uint *)0x0) goto LAB_18006a8ae;
BVar4 = CryptDecodeObject(1,(LPCSTR)0x2f,pbEncoded,DVar13,0,puVar5,&local_b8);
if (BVar4 == 0) goto LAB_18006a6c6;
local_b0[0] = 0;
local_a0[0] = 0;
DVar13 = BCryptGetProperty(local_a8,L"KeyLength",(PUCHAR)local_b0,4,local_a0,0);
if (DVar13 != 0) {
uVar7 = 0x453;
goto LAB_18006a573;
}
uVar14 = (uint)((local_b0[0] & 7) != 0) + (local_b0[0] >> 3);
local_b8 = uVar14 * 2;
pbEncoded = (PUCHAR)FUN_18000a1f4((ulonglong)local_b8);
if (pbEncoded == (PUCHAR)0x0) goto LAB_18006a8ae;
if ((*puVar5 <= uVar14) && (puVar5[4] <= uVar14)) {
memcpy(pbEncoded,*(void **)(puVar5 + 2),(ulonglong)*puVar5);
uVar10 = (ulonglong)uVar14;
memcpy(pbEncoded + uVar10,*(void **)(puVar5 + 6),(ulonglong)puVar5[4]);
FUN_180001e7c(pbEncoded,uVar14);
FUN_180001e7c(pbEncoded + uVar10,uVar14);
dwFlags = 0;
pPaddingInfo = (undefined8 *)0x0;
puVar11 = puVar5;
DVar13 = local_b8;
goto LAB_18006a863;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_18006a8f8(DAT_180091000[2],0xe,&DAT_180082c10,*puVar5,(char)puVar5[4],
(char)uVar14);
}
DVar13 = 0xd;
}
uVar7 = 0x454;
goto LAB_18006a573;
}
local_98 = *(undefined8 *)(param_1 + 0x70);
pPaddingInfo = &local_98;
dwFlags = 8;
local_90 = local_b4;
LAB_18006a863:
DVar13 = BCryptVerifySignature
(local_a8,pPaddingInfo,local_88,local_b4,pbEncoded,DVar13,dwFlags);
puVar5 = puVar11;
if (DVar13 == 0) goto LAB_18006a8ae;
uVar12 = 0x33;
uVar7 = 0x51a;
goto LAB_18006a576;
}
DVar13 = GetLastError();
FUN_18005b470(*(longlong **)(param_1 + 8),0x51a,DVar13,0x2b);
}
RtlReleaseResource(lVar1 + 0x48);
goto LAB_18006a8ae;
}
DVar13 = 0x80090308;
uVar7 = 0x519;
LAB_18006a573:
uVar12 = 0x32;
puVar11 = puVar5;
LAB_18006a576:
plVar6 = *(longlong **)(param_1 + 8);
}
FUN_18005b470(plVar6,uVar7,DVar13,uVar12);
puVar5 = puVar11;
LAB_18006a8ae:
if (local_a8 != (BCRYPT_KEY_HANDLE)0x0) {
BCryptDestroyKey(local_a8);
}
if (puVar5 != (uint *)0x0) {
FUN_18000909c(puVar5);
}
FUN_180028070(local_48 ^ (ulonglong)auStackY_f8);
return;
}
=========================================
Function at address: 0x18006a8f8
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_18006a8f8(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5,undefined param_6)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,param_3,param_2,local_res20,4,&param_5,4,&param_6,4,0);
return;
}
=========================================
Function at address: 0x18006a960
Called functions addresses: 0x180003ed0 0x18006a988


void FUN_18006a960(longlong *param_1,undefined8 param_2,uint param_3)

{
FUN_18006a988((longlong)(param_1 + 0xab));
FUN_180003ed0(param_1,param_2,param_3);
return;
}
=========================================
Function at address: 0x18006a988
Called functions addresses: 0xEXTERNAL:0000011c 0x18006b000 0x18006afc8


void FUN_18006a988(longlong param_1)

{
FUN_18006b000(param_1);
FUN_18006afc8(param_1);
if (*(longlong *)(param_1 + 0x28) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x28),0);
*(undefined8 *)(param_1 + 0x28) = 0;
}
if (*(longlong *)(param_1 + 0x30) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x30),0);
*(undefined8 *)(param_1 + 0x30) = 0;
}
if (*(longlong *)(param_1 + 0x38) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x38),0);
*(undefined8 *)(param_1 + 0x38) = 0;
}
if (*(longlong *)(param_1 + 0x40) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x40),0);
*(undefined8 *)(param_1 + 0x40) = 0;
}
if (*(longlong *)(param_1 + 0xf0) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0xf0),0);
*(undefined8 *)(param_1 + 0xf0) = 0;
}
return;
}
=========================================
Function at address: 0x18006aa40
Called functions addresses: 0x18006049c


uint FUN_18006aa40(longlong *param_1)

{
uint uVar1;

uVar1 = 0;
*(undefined *)((longlong)param_1 + 0x39c) = 0;
if (*(char *)((longlong)param_1 + 0x522) != '\0') {
uVar1 = FUN_18006049c(param_1);
*(undefined *)((longlong)param_1 + 0x522) = 0;
}
if (*(char *)((longlong)param_1 + 0x521) != '\0') {
uVar1 = 0x90320;
}
return uVar1;
}
=========================================
Function at address: 0x18006aa84
Called functions addresses: 0x18000a1f4 0x180060138


undefined8 FUN_18006aa84(longlong param_1)

{
longlong lVar1;
undefined8 *puVar2;
undefined8 uVar3;

puVar2 = (undefined8 *)FUN_18000a1f4(0x558);
if (puVar2 == (undefined8 *)0x0) {
uVar3 = 0xe;
}
else {
puVar2 = FUN_180060138(puVar2,param_1);
lVar1 = puVar2[0x10];
*(longlong *)(param_1 + 0x80) = lVar1;
*(undefined8 **)(lVar1 + 0x10) = puVar2;
uVar3 = 0x54f;
*(ulonglong *)(param_1 + 0x88) = *(ulonglong *)(param_1 + 0x88) | 0x40000;
}
return uVar3;
}
=========================================
Function at address: 0x18006aadc
Called functions addresses: 0xEXTERNAL:00000106 0xEXTERNAL:00000112


undefined8
FUN_18006aadc(longlong param_1,longlong param_2,longlong param_3,longlong param_4,longlong *param_5,
longlong *param_6,longlong *param_7,longlong *param_8,undefined4 *param_9)

{
undefined8 uVar1;
longlong *plVar2;
ulonglong uVar3;

if (((((param_2 == 0) || (param_3 == 0)) || (param_4 == 0)) ||
((((param_5 == (longlong *)0x0 || (param_6 == (longlong *)0x0)) ||
((*param_5 != 0 || ((*param_6 != 0 || (param_7 == (longlong *)0x0)))))) ||
(param_8 == (longlong *)0x0)))) ||
(((*param_7 != 0 || (*param_8 != 0)) || (param_9 == (undefined4 *)0x0)))) {
uVar1 = 0x57;
}
else {
plVar2 = param_6;
uVar1 = SslExpandTrafficKeys(param_2,param_3,param_4,param_5,param_6,0,0);
if ((int)uVar1 == 0) {
if (*(char *)(param_1 + 0xc9) != '\0') {
uVar3 = (ulonglong)plVar2 & 0xffffffff00000000;
uVar1 = SslExpandWriteKey(param_2,*param_5,param_7,0,uVar3);
if ((int)uVar1 != 0) {
*param_9 = 0x25e;
return uVar1;
}
uVar1 = SslExpandWriteKey(param_2,*param_6,param_8,0,uVar3 & 0xffffffff00000000);
if ((int)uVar1 != 0) {
*param_9 = 0x25f;
return uVar1;
}
}
uVar1 = 0;
}
else {
*param_9 = 0x25d;
}
}
return uVar1;
}
=========================================
Function at address: 0x18006ac5c
Called functions addresses: 0x18002a77b 0x180028d90 0x180028070 0xEXTERNAL:00000113


void FUN_18006ac5c(undefined8 param_1,longlong param_2,longlong param_3,void *param_4,uint param_5)

{
int iVar1;
undefined auStack_278 [32];
undefined4 local_258;
uint *local_250;
undefined4 local_248;
uint local_238 [4];
undefined local_228 [512];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_278;
if ((((param_2 != 0) && (param_3 != 0)) && (param_4 != (void *)0x0)) && (param_5 - 0x20 < 0x11)) {
memset(local_228,0,0x200);
local_248 = 0;
local_250 = local_238;
local_238[0] = 0;
local_258 = 0x200;
iVar1 = SslExportKey(param_2,param_3,L"OpaqueKeyBlob",local_228);
if ((iVar1 == 0) && (param_5 <= local_238[0])) {
memcpy(param_4,local_228 + ((ulonglong)local_238[0] - (ulonglong)param_5),(ulonglong)param_5);
}
}
FUN_180028070(local_28 ^ (ulonglong)auStack_278);
return;
}
=========================================
Function at address: 0x18006ad5c
Called functions addresses: 0xEXTERNAL:0000016d 0x18006ac5c 0xEXTERNAL:0000016e 0xEXTERNAL:00000169


NTSTATUS FUN_18006ad5c(longlong param_1,longlong param_2,int param_3,char param_4,byte param_5,
longlong param_6,uint param_7)

{
NTSTATUS NVar1;
uint uVar2;
longlong lVar3;
ULONG local_res10 [2];
BCRYPT_ALG_HANDLE local_28 [2];

if ((((param_2 == 0) || (param_3 == 0)) || (param_7 == 0)) || ((param_5 == 0 || (param_6 == 0))))
{
NVar1 = -0x7ff6fca3;
}
else {
local_res10[0] = 0;
local_28[0] = (BCRYPT_HANDLE)0x0;
NVar1 = BCryptOpenAlgorithmProvider(local_28,(LPCWSTR)(param_6 + 0x100),(LPCWSTR)0x0,0);
if ((NVar1 == 0) &&
(NVar1 = BCryptGetProperty(local_28[0],L"HashDigestLength",(PUCHAR)local_res10,4,local_res10,
0), NVar1 == 0)) {
if (param_7 < local_res10[0]) {
NVar1 = -0x7ff6fcfc;
}
else {
lVar3 = 0;
uVar2 = param_5 - 2;
if (uVar2 == 0) {
if (param_4 == '\0') {
lVar3 = *(longlong *)(param_1 + 0x38);
}
else {
lVar3 = *(longlong *)(param_1 + 0x40);
}
}
else if (uVar2 == 1) {
if (param_4 == '\0') {
lVar3 = *(longlong *)(param_1 + 0x50);
}
else {
lVar3 = *(longlong *)(param_1 + 0x58);
}
}
NVar1 = FUN_18006ac5c((ulonglong)uVar2,param_2,lVar3,(void *)(param_6 + 0x18e),
local_res10[0]);
if (NVar1 == 0) {
*(undefined2 *)(param_6 + 0x18c) = (undefined2)local_res10[0];
}
}
}
if (local_28[0] != (BCRYPT_ALG_HANDLE)0x0) {
BCryptCloseAlgorithmProvider(local_28[0],0);
}
}
return NVar1;
}
=========================================
Function at address: 0x18006aec8
Called functions addresses: 0x18005b470


undefined8 FUN_18006aec8(longlong *param_1,short param_2,undefined8 *param_3,ushort *param_4)

{
undefined8 uVar1;
ushort uVar2;
ushort uVar3;
undefined *puVar4;

if (param_3 != (undefined8 *)0x0) {
*param_3 = 0;
}
if (param_4 != (ushort *)0x0) {
*param_4 = 0;
}
if ((param_3 == (undefined8 *)0x0) == (param_4 == (ushort *)0x0)) {
puVar4 = (undefined *)param_1[0xbb];
for (uVar2 = *(ushort *)(param_1 + 0xbc); uVar2 != 0; uVar2 = (uVar2 - 4) - uVar3) {
if (uVar2 < 4) {
LAB_18006afa4:
FUN_18005b470(param_1,0x4b2,0x80090308,0x32);
return 0x80090308;
}
uVar3 = CONCAT11(puVar4[2],puVar4[3]);
if ((uVar3 == 0) || ((ushort)(uVar2 - 4) < uVar3)) goto LAB_18006afa4;
if (param_2 == CONCAT11(*puVar4,puVar4[1])) {
if ((param_3 != (undefined8 *)0x0) && (param_4 != (ushort *)0x0)) {
*param_3 = puVar4 + 4;
*param_4 = uVar3;
}
return 0;
}
puVar4 = puVar4 + 4 + uVar3;
}
uVar1 = 0x490;
}
else {
uVar1 = 0x57;
}
return uVar1;
}
=========================================
Function at address: 0x18006afc8
Called functions addresses: 0x18000909c


void FUN_18006afc8(longlong param_1)

{
if (*(HLOCAL *)(param_1 + 0xe0) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0xe0));
*(undefined8 *)(param_1 + 0xe0) = 0;
}
*(undefined *)(param_1 + 0xe8) = 0;
return;
}
=========================================
Function at address: 0x18006b000
Called functions addresses: 0xEXTERNAL:0000011c


void FUN_18006b000(longlong param_1)

{
if (*(longlong *)(param_1 + 0x68) != 0) {
SslFreeObject(*(longlong *)(param_1 + 0x68),0);
*(undefined8 *)(param_1 + 0x68) = 0;
}
return;
}
=========================================
Function at address: 0x18006b034
Called functions addresses: 0xEXTERNAL:0000011c 0x18006aadc 0xEXTERNAL:00000101 0xEXTERNAL:000000ff


ulonglong FUN_18006b034(longlong param_1,longlong param_2,longlong param_3,longlong *param_4,
longlong *param_5,undefined4 *param_6)

{
longlong *plVar1;
uint uVar2;
ulonglong uVar3;
ulonglong in_stack_ffffffffffffffa8;
undefined8 in_stack_ffffffffffffffb0;
uint uVar4;

uVar4 = (uint)((ulonglong)in_stack_ffffffffffffffb0 >> 0x20);
if ((((((param_2 == 0) || (param_3 == 0)) || (param_4 == (longlong *)0x0)) ||
((param_5 == (longlong *)0x0 || (*param_4 != 0)))) ||
((*param_5 != 0 || ((param_6 == (undefined4 *)0x0 || (*(longlong *)(param_1 + 0x30) == 0))))))
|| ((plVar1 = (longlong *)(param_1 + 0x48), *plVar1 != 0 ||
(*(longlong *)(param_1 + 0x60) != 0)))) {
uVar3 = 0x57;
}
else {
uVar2 = SslExtractMasterKey(param_2,*(longlong *)(param_1 + 0x30),plVar1,0,
in_stack_ffffffffffffffa8 & 0xffffffff00000000);
SslFreeObject(*(undefined8 *)(param_1 + 0x30),0);
uVar3 = (ulonglong)uVar2;
*(undefined8 *)(param_1 + 0x30) = 0;
if (uVar2 == 0) {
uVar3 = SslExpandExporterMasterKey
(param_2,*plVar1,param_3,param_1 + 0x60,0,(ulonglong)uVar4 << 0x20);
if ((int)uVar3 == 0) {
uVar3 = FUN_18006aadc(param_1,param_2,*plVar1,param_3,(longlong *)(param_1 + 0x50),
(longlong *)(param_1 + 0x58),param_4,param_5,param_6);
}
else {
*param_6 = 0x260;
}
}
else {
*param_6 = 0x2c7;
}
}
return uVar3;
}
=========================================
Function at address: 0x18006b1a8
Called functions addresses: 0x180041cdc 0xEXTERNAL:000000fc 0xEXTERNAL:0000011c 0xEXTERNAL:000000fa 0x18006b000 0xEXTERNAL:00000105 0xEXTERNAL:00000115


int FUN_18006b1a8(longlong param_1,longlong param_2,longlong param_3,longlong param_4,ushort param_5
,int param_6,undefined8 param_7,undefined4 param_8,longlong param_9,int param_10)

{
longlong *plVar1;
int iVar2;
undefined2 uVar3;
longlong local_res10;
ulonglong in_stack_ffffffffffffffc0;
longlong local_28 [2];

local_28[0] = 0;
local_res10 = 0;
if (((((param_2 == 0) || (param_3 == 0)) || (param_4 == 0)) ||
((param_5 < 0x304 || (param_6 == 0)))) || ((param_9 == 0 || (0x3f < param_10 - 1U)))) {
iVar2 = 0x57;
goto LAB_18006b38c;
}
plVar1 = (longlong *)(param_1 + 0x68);
if (*plVar1 == 0) {
SslExpandPreSharedKey(param_2,param_3,param_7,param_8,&local_res10,0,0);
in_stack_ffffffffffffffc0 = 0;
iVar2 = SslExtractEarlyKey(param_2,local_res10,plVar1,param_5,param_6,0,0);
if (iVar2 == 0) goto LAB_18006b2ed;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18006b38c;
uVar3 = 0xf;
}
else {
LAB_18006b2ed:
iVar2 = SslExpandBinderKey(param_2,*plVar1,local_28,0,2);
if (iVar2 == 0) {
iVar2 = SslComputeFinishedHash
(param_2,local_28[0],param_4,param_9,param_10,
in_stack_ffffffffffffffc0 & 0xffffffff00000000);
if (((iVar2 == 0) || ((undefined8 **)DAT_180091000 == &DAT_180091000)) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18006b38c;
uVar3 = 0x11;
}
else {
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0)) goto LAB_18006b38c;
uVar3 = 0x10;
}
}
FUN_180041cdc(DAT_180091000[2],uVar3,&DAT_180082c30,iVar2);
LAB_18006b38c:
if (local_res10 != 0) {
SslFreeObject(local_res10,0);
}
if (local_28[0] != 0) {
SslFreeObject(local_28[0],0);
}
if (iVar2 != 0) {
FUN_18006b000(param_1);
}
return iVar2;
}
=========================================
Function at address: 0x18006b3ec
Called functions addresses: 0x180078830


undefined8 FUN_18006b3ec(longlong param_1)

{
undefined8 uVar1;

if ((*(char *)(param_1 + 0x20) == '\0') && (*(char *)(param_1 + 0xc9) != '\0')) {
uVar1 = FUN_180078830(param_1 + 0x10);
if ((int)uVar1 != 0) {
return uVar1;
}
*(undefined *)(param_1 + 0x20) = 1;
}
return 0;
}
=========================================
Function at address: 0x18006b424
Called functions addresses: 0x18000909c 0x1800652a0 0x18006669c 0x1800051c0 0x180041960 0x180028d90 0x18000a1f4 0x18006581c 0x180012184 0x18006402c 0x180028070 0x18002a7c0


void FUN_18006b424(longlong param_1)

{
longlong *plVar1;
longlong lVar2;
int iVar3;
NTSTATUS NVar4;
ulonglong uVar5;
undefined8 uVar6;
wchar_t *pwVar7;
undefined auStackY_118 [32];
uint local_b8;
uint local_b4;
int local_b0;
undefined4 local_ac;
undefined4 local_a8 [2];
LPCWSTR local_a0;
undefined8 local_98;
HLOCAL pvStack_90;
undefined2 local_88 [2];
undefined4 local_84;
undefined4 local_80;
UCHAR local_78 [64];
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_118;
lVar2 = *(longlong *)(param_1 + 0x3a0);
local_88[0] = 0;
local_84 = 0x16;
local_80 = 1;
local_98 = 0;
pvStack_90 = (HLOCAL)0x0;
if ((((lVar2 != 0) && (*(longlong *)(param_1 + 0x50) != 0)) && (*(char *)(lVar2 + 0x4e) != '\0'))
&& (*(char *)(lVar2 + 0x4f) == '\0')) {
plVar1 = (longlong *)(param_1 + 0x678);
uVar5 = FUN_18006402c(plVar1,lVar2,
(byte)*(undefined4 *)(*(longlong *)(param_1 + 0x50) + 0x9c) & 0x80,
local_88);
iVar3 = (int)uVar5;
if (iVar3 == 0) {
local_b4 = 0;

(*(undefined8 *)(param_1 + 0x628),1,local_88,&local_b4);
if (iVar3 == 0) {
local_98 = CONCAT44(local_98._4_4_,local_b4);
pvStack_90 = (HLOCAL)FUN_18000a1f4((ulonglong)local_b4);
if (pvStack_90 == (HLOCAL)0x0) {
iVar3 = -0x7ff6fd00;
}
else {

(*(undefined8 *)(param_1 + 0x628),&local_98);
if (iVar3 == 0) {
uVar5 = FUN_18006669c(plVar1);
iVar3 = (int)uVar5;
if (iVar3 == 0) {
uVar6 = FUN_1800652a0((longlong)plVar1);
iVar3 = (int)uVar6;
if (iVar3 == 0) {
local_b0 = 0;
local_b8 = 0;
local_a8[0] = 0;
local_a0 = (LPCWSTR)0x0;
local_ac = 0;
FUN_1800051c0(*(ushort *)(param_1 + 0x6f0),&local_b8,&local_b0,local_a8,&local_a0,
(uint *)0x0,&local_ac);
if (local_b8 == 1) {
pwVar7 = L"RSA";
}
else {
if (local_b8 != 3) goto LAB_18006b675;
pwVar7 = L"ECDSA";
}
memset(local_78,0,0x40);
local_b8 = 0;
NVar4 = FUN_18006581c((longlong)plVar1,'\0',local_b0,(wchar_t *)0x0,local_78,0x40,
&local_b8);
if (NVar4 == 0) {
FUN_180041960(0,*(undefined8 *)(param_1 + 0x68),*(longlong *)(lVar2 + 0x68),
*(undefined4 *)(lVar2 + 0x80),local_a8[0],local_ac,pwVar7,local_a0,
local_78,local_b8);
}
goto LAB_18006b675;
}
}
}
}
}
}
FUN_180012184(param_1,0x9b,iVar3);
}
LAB_18006b675:
if (pvStack_90 != (HLOCAL)0x0) {
FUN_18000909c(pvStack_90);
}
FUN_180028070(local_38 ^ (ulonglong)auStackY_118);
return;
}
=========================================
Function at address: 0x18006b6b4
Called functions addresses: 0x18000a1f4 0x18000eb9c 0x18006afc8


undefined8 FUN_18006b6b4(longlong param_1)

{
PUCHAR pUVar1;
undefined8 uVar2;

FUN_18006afc8(param_1 + 1000);
pUVar1 = (PUCHAR)FUN_18000a1f4(0x20);
*(PUCHAR *)(param_1 + 0x4c8) = pUVar1;
if (pUVar1 == (PUCHAR)0x0) {
return 0x80090300;
}
*(undefined *)(param_1 + 0x4d0) = 0x20;
uVar2 = FUN_18000eb9c(pUVar1,0x20);
return uVar2;
}
=========================================
Function at address: 0x18006b70c
Called functions addresses: 0x18006ec1c 0x1800648c8 0x18006d958 0x180012184 0x180028070 0x180009e8c 0x18006669c 0x18006b3ec 0x18006711c 0x18006402c 0x1800643a0 0x1800669bc 0x18002a7c0


void FUN_18006b70c(longlong *param_1,uint *param_2)

{
longlong *plVar1;
longlong *plVar2;
byte bVar3;
char cVar4;
int iVar5;
undefined8 uVar6;
ulonglong uVar7;
undefined4 uVar8;
longlong lVar9;
longlong lVar10;
byte bVar11;
undefined auStackY_b8 [32];
byte local_78 [4];
uint local_74;
short local_70 [4];
undefined4 local_68;
undefined2 local_64;
undefined4 local_60;
undefined4 local_5c;
undefined2 local_58;
undefined4 local_54;
undefined4 local_50;
undefined2 local_4c;
undefined4 local_48;
undefined4 local_44;
ulonglong local_40;

local_40 = DAT_180091970 ^ (ulonglong)auStackY_b8;
lVar9 = param_1[0x74];
cVar4 = '\0';
local_78[0] = 0;
local_70[0] = 0;
local_64 = 0;
local_58 = 0;
local_70[2] = 0x16;
local_70[3] = 0;
local_68 = 3;
plVar1 = param_1 + 0xab;
local_5c = 3;
local_50 = 3;
local_44 = 3;
local_60 = 0x16;
local_54 = 0x16;
local_4c = 0;
local_48 = 0x16;
uVar6 = FUN_18006ec1c((longlong)plVar1,local_70,(char *)local_78);
bVar3 = local_78[0];
iVar5 = (int)uVar6;
if (iVar5 != 0) {
uVar8 = 0x99;
goto LAB_18006b7a0;
}
bVar11 = local_78[0];
if (*(char *)((longlong)param_1 + 0x523) == cVar4) goto LAB_18006b868;
lVar10 = param_1[10];
if (lVar10 == 0) goto LAB_18006ba5e;
if (((lVar9 != 0) && (*(char *)(lVar9 + 0x4e) != cVar4)) && (*(char *)(lVar9 + 0x4f) == cVar4)) {
(&local_68)[(ulonglong)local_78[0] * 3] = 2;
}
bVar11 = local_78[0] + 1;
uVar7 = FUN_18006402c(param_1 + 0xcf,lVar9,*(byte *)(lVar10 + 0x9c) & 0x80,
local_70 + (ulonglong)local_78[0] * 6);
iVar5 = (int)uVar7;
if (iVar5 == 0) {
if (lVar9 != 0) {
uVar7 = FUN_1800643a0((longlong)(param_1 + 0xcf),local_70 + (ulonglong)bVar11 * 6);
iVar5 = (int)uVar7;
bVar11 = bVar3 + 2;
if (iVar5 != 0) goto LAB_18006b823;
}
LAB_18006b868:
plVar2 = param_1 + 0xcf;
iVar5 = FUN_1800648c8((longlong)plVar2,local_70 + (ulonglong)bVar11 * 6);
if (iVar5 == 0) {
lVar10 = 0;
local_74 = 0;

(param_1[0xc5],bVar11 + 1,local_70,&local_74);
if (iVar5 != 0) {
uVar8 = 0x38a;
goto LAB_18006b7a0;
}
uVar6 = FUN_180009e8c((longlong)param_1,param_2,local_74);
iVar5 = (int)uVar6;
if ((iVar5 == 0) &&

) {
uVar6 = FUN_18006b3ec((longlong)plVar1);
iVar5 = (int)uVar6;
if (iVar5 == 0) {
if (*(char *)((longlong)param_1 + 0x523) != '\0') {
uVar7 = FUN_18006669c(plVar2);
iVar5 = (int)uVar7;
if (iVar5 != 0) goto LAB_18006b92d;
if (lVar9 != 0) {
uVar7 = FUN_1800669bc((longlong)plVar2);
iVar5 = (int)uVar7;
if (iVar5 != 0) goto LAB_18006b92d;
}
}
iVar5 = FUN_18006711c((longlong)plVar2);
if (iVar5 != 0) goto LAB_18006b8ee;

if (cVar4 != '\0') goto LAB_18006ba5e;
plVar2 = (longlong *)param_1[1];
lVar9 = lVar10;
if (plVar2 != (longlong *)0x0) {
lVar9 = *plVar2;
}
iVar5 = FUN_18006d958((longlong)plVar1,lVar9,'\0',2,(longlong)plVar2,0,
*(short *)(param_2 + 1));
if (iVar5 == 0) {
plVar2 = (longlong *)param_1[1];
lVar9 = lVar10;
if (plVar2 != (longlong *)0x0) {
lVar9 = *plVar2;
}
iVar5 = FUN_18006d958((longlong)plVar1,lVar9,'\x01',3,(longlong)plVar2,0,0);
if (iVar5 == 0) {
plVar2 = (longlong *)param_1[1];
if (plVar2 != (longlong *)0x0) {
lVar10 = *plVar2;
}
iVar5 = FUN_18006d958((longlong)plVar1,lVar10,'\0',3,(longlong)plVar2,0,0);
if (iVar5 == 0) goto LAB_18006ba5e;
uVar8 = 0x263;
}
else {
uVar8 = 0x264;
}
}
else {
uVar8 = 0x261;
}
}
else {
LAB_18006b92d:
uVar8 = 0x9a;
}
}
else {
LAB_18006b8ee:
uVar8 = 0x38b;
}
LAB_18006b7a0:
FUN_180012184((longlong)param_1,uVar8,iVar5);
goto LAB_18006ba5e;
}
uVar8 = 0x389;
}
else {
LAB_18006b823:
uVar8 = 0x99;
}
FUN_180012184((longlong)param_1,uVar8,iVar5);
LAB_18006ba5e:
FUN_180028070(local_40 ^ (ulonglong)auStackY_b8);
return;
}
=========================================
Function at address: 0x18006ba8c
Called functions addresses: 0x18002a77b 0xEXTERNAL:00000164 0x180028d90 0x180004510 0xEXTERNAL:000000f5 0x180028070 0x180014d38


void FUN_18006ba8c(undefined8 param_1,longlong param_2,int param_3,void *param_4,uint *param_5)

{
int iVar1;
NTSTATUS NVar2;
int iVar3;
longlong lVar4;
uint uVar5;
undefined auStack_148 [32];
undefined *local_128;
undefined8 local_120;
int local_118;
int local_108 [2];
longlong local_100;
undefined2 local_f8;
undefined local_f6;
undefined local_f5;
undefined local_f4 [60];
undefined local_b8 [128];
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStack_148;
if ((((param_2 != 0) && (param_3 != 0)) && (param_4 != (void *)0x0)) &&
((param_5 != (uint *)0x0 && (*param_5 != 0)))) {
memset(local_b8,0,0x80);
memset(&local_f8,0,0x40);
local_120 = (undefined *)((ulonglong)local_120._4_4_ << 0x20);
local_128 = local_b8;
local_108[0] = 0;
local_100 = 0;
iVar1 = SslGetCipherSuitePRFHashAlgorithm(param_2,0x304,param_3,0);
if ((iVar1 == 0) &&
((lVar4 = FUN_180014d38(local_b8), lVar4 != 0 &&
(NVar2 = FUN_180004510(*(int *)(lVar4 + 0x14),&local_100,local_108), iVar1 = local_108[0],
NVar2 == 0)))) {
local_f6 = 0;
local_120 = local_f4;
local_118 = local_108[0];
local_128 = (undefined *)CONCAT44(local_128._4_4_,*param_5);
local_f8 = 0xfe;
local_f5 = (undefined)local_108[0];
iVar3 = BCryptHash(local_100,0,0,param_4);
if ((iVar3 == 0) && (uVar5 = iVar1 + 4, uVar5 <= *param_5)) {
*param_5 = uVar5;
memcpy(param_4,&local_f8,(ulonglong)uVar5);
}
}
}
FUN_180028070(local_38 ^ (ulonglong)auStack_148);
return;
}
=========================================
Function at address: 0x18006bc00
Called functions addresses: 0x18006ec1c 0x1800647b0 0x180066778 0x180064218 0x1800648c8 0x1800640c4 0xEXTERNAL:000000c2 0x180028070 0x180009e8c 0x180067044 0x18006c430 0x180041cdc 0x180041cb0 0xEXTERNAL:00000135 0x1800669bc 0x180062998 0xEXTERNAL:0000011c 0x1800680e8 0x18006728c 0x18006d958 0x180012184 0xEXTERNAL:000000c0 0x18006b3ec 0x180065098 0xEXTERNAL:00000041 0x1800643a0 0x18002a7c0 0x180066854 0x18006b034


void FUN_18006bc00(longlong *param_1,uint *param_2)

{
longlong *plVar1;
longlong *plVar2;
longlong *plVar3;
int iVar4;
longlong lVar5;
byte bVar6;
char cVar7;
DWORD DVar8;
int iVar9;
ulonglong uVar10;
undefined8 uVar11;
PCCERT_SERVER_OCSP_RESPONSE_CONTEXT pCVar12;
byte bVar13;
undefined4 uVar14;
longlong lVar15;
undefined auStackY_128 [32];
byte local_d8 [8];
longlong local_d0;
uint local_c8 [2];
longlong local_c0;
uint *local_b8;
short local_a8 [8];
undefined4 local_98;
undefined4 local_94;
undefined2 local_90;
undefined4 local_8c;
undefined4 local_88;
undefined2 local_84;
undefined4 local_80;
undefined4 local_7c;
undefined2 local_78;
undefined4 local_74;
undefined4 local_70;
undefined2 local_6c;
undefined4 local_68;
undefined4 local_64;
undefined2 local_60;
undefined4 local_5c;
undefined4 local_58;
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_128;
lVar15 = 0;
if ((longlong *)param_1[1] != (longlong *)0x0) {
lVar15 = *(longlong *)param_1[1];
}
plVar1 = param_1 + 0xa1;
local_a8[0] = 0;
local_a8[2] = 0x16;
local_a8[3] = 0;
local_a8[4] = 1;
local_a8[5] = 0;
local_a8[6] = 0;
local_94 = 3;
local_88 = 3;
local_7c = 3;
local_70 = 3;
local_64 = 3;
local_58 = 3;
local_98 = 0x16;
local_90 = 0;
local_8c = 0x16;
local_84 = 0;
local_80 = 0x16;
local_78 = 0;
local_74 = 0x16;
local_6c = 0;
local_68 = 0x16;
local_60 = 0;
local_5c = 0x16;
local_d8[0] = 1;
local_c0 = lVar15;
local_b8 = param_2;
uVar10 = FUN_180065098((longlong)plVar1,lVar15,'\x01',local_a8);
iVar9 = (int)uVar10;
if (iVar9 == 0) {
uVar11 = FUN_18006ec1c((longlong)(param_1 + 0x7d),local_a8 + 6,(char *)local_d8);
bVar6 = local_d8[0];
iVar9 = (int)uVar11;
if (iVar9 != 0) goto LAB_18006bcc8;
bVar13 = local_d8[0] + 1;
uVar11 = FUN_1800647b0((longlong)plVar1,local_a8 + (ulonglong)local_d8[0] * 6);
iVar9 = (int)uVar11;
if (iVar9 != 0) {
LAB_18006bd1a:
uVar14 = 0x4e5;
LAB_18006bd1f:
FUN_180012184((longlong)param_1,uVar14,iVar9);
goto LAB_18006bdfd;
}
if (((ulonglong)param_1[0x11] >> 0xf & 1) != 0) {
local_d8[0] = 0;
if (param_1[1] == 0) goto LAB_18006bdfd;
iVar4 = *(int *)(param_1[1] + 0x30);
if ((((ulonglong)param_1[0x11] >> 8 & 1) != 0) && (iVar4 != 4)) {
uVar10 = (ulonglong)bVar13;
bVar13 = bVar6 + 2;
uVar10 = FUN_180064218((longlong)plVar1,local_a8 + uVar10 * 6);
iVar9 = (int)uVar10;
if (iVar9 != 0) goto LAB_18006bd1a;
}
lVar15 = param_1[10];
if (lVar15 == 0) goto LAB_18006bdfd;
local_d0 = 0;

if (local_d0 == 0) goto LAB_18006bdfd;
RtlAcquireResourceShared(local_d0 + 0x48,1);
lVar5 = *(longlong *)(local_d0 + 0x150);
if (lVar5 == 0) {
RtlReleaseResource(local_d0 + 0x48);
goto LAB_18006bdfd;
}
if ((((*(uint *)(param_1 + 0x11) >> 0x11 & 1) != 0) &&
(*(HCERT_SERVER_OCSP_RESPONSE *)(lVar5 + 0x1c8) != (HCERT_SERVER_OCSP_RESPONSE)0x0)) &&
(iVar4 != 4)) {
pCVar12 = CertGetServerOcspResponseContext
(*(HCERT_SERVER_OCSP_RESPONSE *)(lVar5 + 0x1c8),0,(LPVOID)0x0);
param_1[0xbd] = (longlong)pCVar12;
if (((pCVar12 == (PCCERT_SERVER_OCSP_RESPONSE_CONTEXT)0x0) &&
((undefined8 **)DAT_180091000 != &DAT_180091000)) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
DVar8 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0x3b,&DAT_180082c30,DVar8);
}
}
uVar10 = FUN_1800640c4(plVar1,lVar5,*(byte *)(lVar15 + 0x9c) & 0x80,
local_a8 + (ulonglong)bVar13 * 6);
iVar9 = (int)uVar10;
RtlReleaseResource(local_d0 + 0x48);
if (iVar9 == 0) {
uVar10 = FUN_1800643a0((longlong)plVar1,local_a8 + (ulonglong)(byte)(bVar13 + 1) * 6);
bVar13 = bVar13 + 2;
iVar9 = (int)uVar10;
lVar15 = local_c0;
param_2 = local_b8;
if (iVar9 == 0) goto LAB_18006bf21;
}
goto LAB_18006bd1a;
}
local_d8[0] = 1;
LAB_18006bf21:
iVar9 = FUN_1800648c8((longlong)plVar1,local_a8 + (ulonglong)bVar13 * 6);
if (iVar9 != 0) goto LAB_18006bd1a;
uVar14 = 0;
local_c8[0] = 0;

(param_1[0x97],bVar13 + 1,local_a8,local_c8);
if (iVar9 == 0) {
uVar11 = FUN_180009e8c((longlong)param_1,param_2,local_c8[0]);
iVar9 = (int)uVar11;
if ((iVar9 == 0) &&

) {
if (*(int *)((longlong)param_1 + 0x44) == 0x5d) {
uVar10 = FUN_180062998(param_1);
iVar9 = (int)uVar10;
}
else {

(param_1,param_1[0x6e],*(undefined4 *)(param_1 + 0x6d),0);
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(undefined4 *)(param_1 + 0x6d) = 0;
}
if (iVar9 != 0) {
uVar14 = 0x3ef;
goto LAB_18006bcd0;
}
if (param_1 + 0x26 == (longlong *)0x0) {
FUN_180012184((longlong)param_1,0x4e7,0x54f);
goto LAB_18006bdfd;
}
uVar11 = FUN_1800680e8((longlong)plVar1,'\x01',(PUCHAR)(param_1 + 0x26));
iVar9 = (int)uVar11;
if (iVar9 != 0) goto LAB_18006bf99;
local_d0 = CONCAT44(local_d0._4_4_,0x4e7);
if (((*(byte *)(param_1 + 4) & 1) != 0) && (param_1[1] != 0)) {
uVar14 = *(undefined4 *)(param_1[1] + 0x1c);
}
plVar2 = param_1 + 0x15;
plVar3 = param_1 + 0x14;
uVar10 = FUN_18006c430((longlong)(param_1 + 0x7d),lVar15,param_1[0xe],param_1[0x4a],
*(undefined2 *)((longlong)param_1 + 0x22),uVar14,local_d8[0],plVar3,
plVar2,(undefined4 *)&local_d0);
iVar9 = (int)uVar10;
if (iVar9 == 0) {
cVar7 = *(char *)((longlong)param_1 + 0xe9);
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 0xc;
if ((cVar7 == '\0') && (param_1[0x13] != 0)) {
SslFreeObject(param_1[0x13],0);
cVar7 = *(char *)((longlong)param_1 + 0xe9);
}
lVar5 = *plVar2;
*plVar2 = 0;
param_1[0x13] = lVar5;
if (cVar7 == '\0') {
param_1[0x17] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3b,&DAT_180082c58);
}
*(undefined *)(param_1 + 0x98) = 2;
uVar11 = FUN_18006b3ec((longlong)(param_1 + 0x7d));
iVar9 = (int)uVar11;
if ((iVar9 == 0) && (iVar9 = FUN_180067044((longlong)plVar1), iVar9 == 0)) {
if (local_d8[0] == 0) {
if ((((*(uint *)(param_1 + 0x11) >> 8 & 1) == 0) || (*(int *)(param_1[1] + 0x30) == 4)
) || (iVar9 = FUN_180066854((longlong)plVar1), iVar9 == 0)) {
uVar10 = FUN_180066778(plVar1);
iVar9 = (int)uVar10;
if (iVar9 == 0) {
uVar10 = FUN_1800669bc((longlong)plVar1);
iVar9 = (int)uVar10;
if (iVar9 == 0) goto LAB_18006c205;
}
}
}
else {
LAB_18006c205:
iVar9 = FUN_18006728c((longlong)plVar1);
if (iVar9 == 0) {
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 10;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
param_1[0x12] = *plVar3;
*plVar3 = 0;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
param_1[0x16] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180082c58);
}
plVar1 = param_1 + 0x7d;
uVar10 = FUN_18006b034((longlong)plVar1,lVar15,param_1[0x4a],plVar3,plVar2,
(undefined4 *)&local_d0);
iVar9 = (int)uVar10;
if (iVar9 == 0) {

if (cVar7 != '\0') {
LAB_18006c38d:
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 0xc;
cVar7 = *(char *)((longlong)param_1 + 0xe9);
if ((*(char *)((longlong)param_1 + 0xe9) == '\0') &&
(cVar7 = '\0', param_1[0x13] != 0)) {
SslFreeObject(param_1[0x13],0);
cVar7 = *(char *)((longlong)param_1 + 0xe9);
}
param_1[0x13] = *plVar2;
*plVar2 = 0;
if (cVar7 == '\0') {
param_1[0x17] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3b,&DAT_180082c58);
}
*(undefined *)(param_1 + 0x98) = 3;
goto LAB_18006bdfd;
}
iVar9 = FUN_18006d958((longlong)plVar1,lVar15,'\x01',2,param_1[1],local_a8[0],
*(short *)(local_b8 + 1));
if (iVar9 == 0) {
iVar9 = FUN_18006d958((longlong)plVar1,lVar15,'\0',2,param_1[1],0,0);
if (iVar9 == 0) {
iVar9 = FUN_18006d958((longlong)plVar1,lVar15,'\x01',3,param_1[1],0,0);
if (iVar9 == 0) goto LAB_18006c38d;
uVar14 = 0x264;
}
else {
uVar14 = 0x261;
}
}
else {
uVar14 = 0x262;
}
}
else {
uVar14 = (undefined4)local_d0;
}
goto LAB_18006bcd0;
}
}
}
uVar14 = 0x4e7;
}
else {
uVar14 = (undefined4)local_d0;
}
}
else {
LAB_18006bf99:
uVar14 = 0x4e7;
}
goto LAB_18006bd1f;
}
uVar14 = 0x4e6;
}
else {
LAB_18006bcc8:
uVar14 = 0x4e5;
}
LAB_18006bcd0:
FUN_180012184((longlong)param_1,uVar14,iVar9);
LAB_18006bdfd:
FUN_180028070(local_48 ^ (ulonglong)auStackY_128);
return;
}
=========================================
Function at address: 0x18006c430
Called functions addresses: 0xEXTERNAL:0000011c 0x18006aadc 0x18006b000 0xEXTERNAL:00000105 0xEXTERNAL:00000104


ulonglong FUN_18006c430(longlong param_1,longlong param_2,longlong param_3,longlong param_4,
undefined2 param_5,undefined4 param_6,char param_7,longlong *param_8,
longlong *param_9,undefined4 *param_10)

{
longlong *plVar1;
uint uVar2;
ulonglong uVar3;
undefined8 in_stack_ffffffffffffffa8;
undefined4 uVar4;
ulonglong in_stack_ffffffffffffffb8;

uVar4 = (undefined4)((ulonglong)in_stack_ffffffffffffffa8 >> 0x20);
uVar2 = (uint)(in_stack_ffffffffffffffb8 >> 0x20);
if ((((((param_2 == 0) || (param_3 == 0)) || (param_4 == 0)) ||
((param_8 == (longlong *)0x0 || (param_9 == (longlong *)0x0)))) ||
((*param_8 != 0 || ((*param_9 != 0 || (param_10 == (undefined4 *)0x0)))))) ||
((*(longlong *)(param_1 + 0x28) == 0 || (plVar1 = (longlong *)(param_1 + 0x30), *plVar1 != 0)))
) {
uVar3 = 0x57;
}
else {
if (param_7 == '\0') {
FUN_18006b000(param_1);
in_stack_ffffffffffffffb8 = (ulonglong)uVar2 << 0x20;
uVar3 = SslExtractEarlyKey(param_2,0,param_1 + 0x68,param_5,CONCAT44(uVar4,param_6),0,
in_stack_ffffffffffffffb8);
if ((int)uVar3 != 0) {
*param_10 = 0x2c5;
return uVar3;
}
}
uVar2 = SslExtractHandshakeKey
(param_2,param_3,*(undefined8 *)(param_1 + 0x28),
*(undefined8 *)(param_1 + 0x68),plVar1,0,
in_stack_ffffffffffffffb8 & 0xffffffff00000000);
uVar3 = (ulonglong)uVar2;
FUN_18006b000(param_1);
SslFreeObject(*(undefined8 *)(param_1 + 0x28),0);
*(undefined8 *)(param_1 + 0x28) = 0;
if (uVar2 == 0) {
uVar3 = FUN_18006aadc(param_1,param_2,*plVar1,param_4,(longlong *)(param_1 + 0x38),
(longlong *)(param_1 + 0x40),param_8,param_9,param_10);
}
else {
*param_10 = 0x2c6;
}
}
return uVar3;
}
=========================================
Function at address: 0x18006c5e0
Called functions addresses: 0x18006463c 0x18006ec1c 0x18000eabc 0x180066af0 0x180012184 0x180018e50 0x180028070 0x18000eb9c 0x180009e8c 0x180023480 0x18006b3ec 0x180028d90 0x180041cb0 0x18000a1d0 0x180006f5c 0x18000706c 0x18002a7c0


void FUN_18006c5e0(ushort *param_1,uint *param_2)

{
ushort *puVar1;
char cVar2;
int iVar3;
longlong lVar4;
undefined8 uVar5;
ulonglong uVar6;
longlong lVar7;
ushort *_Dst;
undefined4 uVar8;
uint uVar9;
ulonglong uVar10;
ushort uVar11;
undefined auStackY_1e8 [32];
byte local_198 [4];
uint local_194;
uint local_190 [2];
ushort *local_188;
longlong local_180;
ushort local_178 [8];
undefined4 local_168;
undefined4 local_164;
ushort local_158 [136];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_1e8;
lVar4 = FUN_180018e50();
_Dst = local_158;
local_180 = lVar4;
memset(_Dst,0,0x110);
lVar7 = *(longlong *)(param_1 + 0x28);
local_194 = 0x44;
if (lVar7 == 0) goto LAB_18006c980;
_Dst = param_1 + 0x1c8;
uVar5 = FUN_18000706c(_Dst,*(int **)(lVar7 + 0xb8),*(uint *)(lVar7 + 0xb0),*(uint *)(lVar7 + 0xc0)
,lVar7,*(uint *)(param_1 + 0x20),(longlong)local_158,&local_194,
(longlong *)_Dst,param_1 + 0x1cc);
if ((int)uVar5 != 0) goto LAB_18006c980;
puVar1 = param_1 + 0xed;
FUN_18000eabc(_Dst,puVar1);
uVar9 = *(uint *)(*(longlong *)(param_1 + 0x28) + 0xc4);
if (uVar9 == 0) {
uVar11 = *puVar1;
}
else {
_Dst = puVar1;
uVar5 = FUN_180006f5c(puVar1,*(uint **)(*(longlong *)(param_1 + 0x28) + 200),uVar9);
if ((int)uVar5 != 0) goto LAB_18006c980;
uVar11 = *puVar1;
if (uVar11 == 0) {
_Dst = DAT_180091000;
if (((ushort **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)(DAT_180091000 + 0xe) & 1) != 0)) {
_Dst = *(ushort **)(DAT_180091000 + 8);
FUN_180041cb0(_Dst,0x1a,&DAT_180082c30);
}
goto LAB_18006c980;
}
}
local_188 = param_1 + 0xee;

local_178[4] = 1;
local_178[5] = 0;
local_164 = 1;
local_198[0] = 0;
uVar10 = 0;
*(byte *)((longlong)param_1 + 0x671) = -(cVar2 != '\0') & 0x20;
local_178[0] = 0;
local_178[2] = 0x16;
local_178[3] = 0;
local_168 = 0x16;
local_178[6] = 0;
if (*(int *)(param_1 + 0x22) == 100) {
uVar5 = FUN_18006ec1c((longlong)(param_1 + 0x2ac),local_178,(char *)local_198);
iVar3 = (int)uVar5;
if (iVar3 == 0) {
uVar10 = (ulonglong)local_198[0];
goto LAB_18006c796;
}
LAB_18006c77f:
uVar8 = 0x32;
}
else {
LAB_18006c796:
uVar6 = FUN_18006463c((undefined8 *)(param_1 + 0x33c),lVar4,local_194,uVar11,
local_178 + uVar10 * 6);
iVar3 = (int)uVar6;
if (iVar3 != 0) goto LAB_18006c77f;
local_190[0] = 0;

(*(undefined8 *)(param_1 + 0x314),(char)uVar10 + '\x01',local_178,local_190);
if (iVar3 == 0) {
uVar5 = FUN_180009e8c((longlong)param_1,param_2,local_190[0]);
iVar3 = (int)uVar5;
if ((iVar3 == 0) &&

(*(undefined8 *)(param_1 + 0x314),param_2), iVar3 == 0)) {
if (*(longlong *)(param_1 + 0x1b8) != 0) {

param_1[0x1b8] = 0;
param_1[0x1b9] = 0;
param_1[0x1ba] = 0;
param_1[0x1bb] = 0;
}
param_1[0x1b4] = 0;
param_1[0x1b5] = 0;
if (*(int *)(param_1 + 0x22) == 0x28) {
uVar9 = (uint)local_178[uVar10 * 6];
*(uint *)(param_1 + 0x1b4) = uVar9;
lVar7 = FUN_18000a1d0((longlong)param_1,uVar9);
*(longlong *)(param_1 + 0x1b8) = lVar7;
if (lVar7 == 0) {
iVar3 = 0xe;
}
else {
if (*(byte *)((longlong)param_1 + 0x671) != 0) {
_Dst = (ushort *)((longlong)param_1 + 0x651);
uVar5 = FUN_18000eb9c((PUCHAR)_Dst,(uint)*(byte *)((longlong)param_1 + 0x671));
if ((int)uVar5 != 0) goto LAB_18006c980;
}
LAB_18006c902:
if (param_1 + 0x88 == (ushort *)0x0) {
iVar3 = 0x54f;
}
else {
_Dst = param_1 + 0x33c;
uVar5 = FUN_180066af0((longlong *)_Dst,local_194,local_158,uVar11,(longlong)local_188,
(PUCHAR)(param_1 + 0x88));
iVar3 = (int)uVar5;
if (iVar3 == 0) goto LAB_18006c980;
}
}
}
else {
uVar5 = FUN_18006b3ec((longlong)(param_1 + 0x2ac));
iVar3 = (int)uVar5;
if (iVar3 == 0) goto LAB_18006c902;
}
}
uVar8 = 0x34;
}
else {
uVar8 = 0x33;
}
}
FUN_180012184((longlong)param_1,uVar8,iVar3);
_Dst = param_1;
LAB_18006c980:
if (lVar4 != 0) {
FUN_180023480(_Dst,&local_180);
}
FUN_180028070(local_48 ^ (ulonglong)auStackY_1e8);
return;
}
=========================================
Function at address: 0x18006c9c4
Called functions addresses: 0x18006ec1c 0x18006b3ec 0x180065098 0x1800680e8 0x180012184 0x180028070 0x180009e8c 0x18002a7c0 0x18006ba8c 0x180062998


void FUN_18006c9c4(longlong *param_1,uint *param_2)

{
int iVar1;
ulonglong uVar2;
undefined8 uVar3;
longlong *plVar4;
longlong lVar5;
undefined4 uVar6;
longlong lVar7;
int iVar8;
undefined auStackY_88 [32];
char local_58 [4];
uint local_54;
undefined2 local_50 [2];
undefined4 local_4c;
undefined4 local_48;
undefined2 local_44 [2];
undefined4 local_40;
undefined4 local_3c;
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_88;
lVar7 = 0;
iVar8 = 0;
lVar5 = lVar7;
if ((longlong *)param_1[1] != (longlong *)0x0) {
lVar5 = *(longlong *)param_1[1];
}
local_50[0] = 0;
local_4c = 0x16;
local_48 = 1;
local_44[0] = 0;
local_40 = 0x16;
local_3c = 1;
local_58[0] = '\x01';
uVar2 = FUN_180065098((longlong)(param_1 + 0xa1),lVar5,'\0',local_50);
iVar1 = (int)uVar2;
if (iVar1 == 0) {
uVar3 = FUN_18006ec1c((longlong)(param_1 + 0x7d),local_44,local_58);
iVar1 = (int)uVar3;
if (iVar1 != 0) goto LAB_18006ca48;
local_54 = 0;

(param_1[0x97],local_58[0],local_50,&local_54);
if (iVar1 != 0) {
uVar6 = 0x4e9;
goto LAB_18006ca50;
}
uVar3 = FUN_180009e8c((longlong)param_1,param_2,local_54);
iVar1 = (int)uVar3;
if (iVar1 == 0) {
lVar5 = param_1[0x97];

if (iVar1 != 0) goto LAB_18006cacc;
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(plVar4 = (longlong *)param_1[1], plVar4 == (longlong *)0x0)) {
plVar4 = (longlong *)param_1[1];
iVar1 = 0;
if (plVar4 != (longlong *)0x0) goto LAB_18006cb1e;
}
else {
iVar1 = *(int *)((longlong)plVar4 + 0x1c);
LAB_18006cb1e:
iVar8 = iVar1;
lVar7 = *plVar4;
}
iVar1 = FUN_18006ba8c(lVar5,lVar7,iVar8,(void *)param_1[0x6e],(uint *)(param_1 + 0x6d));
if (iVar1 == 0) {
uVar2 = FUN_180062998(param_1);
iVar1 = (int)uVar2;
if (iVar1 == 0) {
uVar3 = FUN_1800680e8((longlong)(param_1 + 0xa1),'\0',(PUCHAR)0x0);
iVar1 = (int)uVar3;
if (iVar1 == 0) {
uVar3 = FUN_18006b3ec((longlong)(param_1 + 0x7d));
iVar1 = (int)uVar3;
if (iVar1 == 0) goto LAB_18006cb91;
}
goto LAB_18006cacc;
}
uVar6 = 0x3f4;
}
else {
uVar6 = 0x3f4;
}
}
else {
LAB_18006cacc:
uVar6 = 0x4ea;
}
}
else {
LAB_18006ca48:
uVar6 = 0x4e8;
}
LAB_18006ca50:
FUN_180012184((longlong)param_1,uVar6,iVar1);
LAB_18006cb91:
FUN_180028070(local_38 ^ (ulonglong)auStackY_88);
return;
}
=========================================
Function at address: 0x18006cbc0
Called functions addresses: 0x180067888 0x180064cf4 0x18006d958 0x180012184 0x180028070 0x180009e8c 0x18002a7c0


void FUN_18006cbc0(longlong *param_1,uint *param_2)

{
longlong *plVar1;
char cVar2;
int iVar3;
ulonglong uVar4;
undefined8 uVar5;
undefined4 uVar6;
longlong lVar7;
undefined auStackY_78 [32];
uint local_38 [2];
undefined2 local_30 [2];
undefined4 local_2c;
undefined4 local_28;
ulonglong local_20;

local_20 = DAT_180091970 ^ (ulonglong)auStackY_78;
lVar7 = 0;
local_30[0] = 0;
local_2c = 0x16;
local_28 = 2;
uVar4 = FUN_180064cf4((longlong)(param_1 + 0xa1),local_30);
iVar3 = (int)uVar4;
if (iVar3 == 0) {
local_38[0] = 0;

if (iVar3 == 0) {
uVar5 = FUN_180009e8c((longlong)param_1,param_2,local_38[0]);
iVar3 = (int)uVar5;
if (((iVar3 == 0) &&

)) && (iVar3 = FUN_180067888((longlong)(param_1 + 0xa1)), iVar3 == 0)) {

if (cVar2 != '\0') goto LAB_18006cd2d;
plVar1 = (longlong *)param_1[1];
if (plVar1 != (longlong *)0x0) {
lVar7 = *plVar1;
}
iVar3 = FUN_18006d958((longlong)(param_1 + 0x7d),lVar7,'\x01',3,(longlong)plVar1,0,
*(short *)(param_2 + 1));
if (iVar3 == 0) goto LAB_18006cd2d;
uVar6 = 0x264;
}
else {
uVar6 = 0x5de;
}
}
else {
uVar6 = 0x5dd;
}
}
else {
uVar6 = 0x5dc;
}
FUN_180012184((longlong)param_1,uVar6,iVar3);
LAB_18006cd2d:
FUN_180028070(local_20 ^ (ulonglong)auStackY_78);
return;
}
=========================================
Function at address: 0x18006cd58
Called functions addresses: 0x180064218 0x180012184 0x18006b6b4 0x180028070 0x180009e8c 0x180066854 0x18002a7c0


void FUN_18006cd58(longlong param_1,uint *param_2)

{
int iVar1;
undefined8 uVar2;
ulonglong uVar3;
undefined4 uVar4;
undefined auStack_68 [48];
uint local_38 [2];
undefined2 local_30 [2];
undefined4 local_2c;
undefined4 local_28;
ulonglong local_20;

local_20 = DAT_180091970 ^ (ulonglong)auStack_68;
local_2c = 0x16;
local_30[0] = 0;
local_28 = 3;
if ((((*(char *)(param_1 + 0x5e2) != '\0') && (*(char *)(param_1 + 0x4d1) != '\0')) &&
(*(int *)(*(longlong *)(param_1 + 8) + 0x30) != 4)) &&
((*(uint *)(param_1 + 0x88) >> 8 & 1) != 0)) {
uVar2 = FUN_18006b6b4(param_1);
iVar1 = (int)uVar2;
if (iVar1 == 0) {
uVar3 = FUN_180064218(param_1 + 0x508,local_30);
iVar1 = (int)uVar3;
if (iVar1 == 0) {
local_38[0] = 0;

(*(undefined8 *)(param_1 + 0x4b8),1,local_30,local_38);
if (iVar1 == 0) {
uVar2 = FUN_180009e8c(param_1,param_2,local_38[0]);
iVar1 = (int)uVar2;
if (((iVar1 == 0) &&

(*(undefined8 *)(param_1 + 0x4b8),param_2), iVar1 == 0)) &&
(iVar1 = FUN_180066854(param_1 + 0x508), iVar1 == 0)) goto LAB_18006ceaf;
uVar4 = 0x4ee;
}
else {
uVar4 = 0x4ed;
}
}
else {
uVar4 = 0x4ec;
}
}
else {
uVar4 = 0x4eb;
}
FUN_180012184(param_1,uVar4,iVar1);
}
LAB_18006ceaf:
FUN_180028070(local_20 ^ (ulonglong)auStack_68);
return;
}
=========================================
Function at address: 0x18006cee0
Called functions addresses: 0x180002488 0x180041cb0 0xEXTERNAL:0000011c 0x18006b70c 0x18006b424 0x18002a7c0


uint FUN_18006cee0(longlong *param_1,uint *param_2)

{
longlong lVar1;
uint uVar2;
char cVar3;
char local_res8 [8];

uVar2 = 0;
if (*(int *)((longlong)param_1 + 0x44) == 100) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x16,&DAT_180082c30);
}
*(undefined4 *)(param_1 + 8) = *(undefined4 *)((longlong)param_1 + 0x73c);

if (uVar2 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x47;
}
}
else if (*(int *)((longlong)param_1 + 0x44) == 0x65) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x17,&DAT_180082c30);
}
local_res8[0] = '\0';
uVar2 = FUN_180002488(param_1,local_res8);
if (local_res8[0] == '\0') {
if ((((*(char *)((longlong)param_1 + 0x523) == '\0') ||
(*(char *)((longlong)param_1 + 0x10a) == '\0')) || (param_1[0x74] == 0)) ||
((param_1[0x75] != 0 || (*(int *)(param_1 + 0x76) != 0)))) {
uVar2 = FUN_18006b70c(param_1,param_2);
if (uVar2 == 0) {
if (*(char *)((longlong)param_1 + 0x641) == '\0') {
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 0xc;
cVar3 = *(char *)((longlong)param_1 + 0xe9);
if ((cVar3 == '\0') && (param_1[0x13] != 0)) {
SslFreeObject(param_1[0x13],0);
cVar3 = *(char *)((longlong)param_1 + 0xe9);
}
lVar1 = param_1[0x15];
param_1[0x15] = 0;
param_1[0x13] = lVar1;
if (cVar3 == '\0') {
param_1[0x17] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3b,&DAT_180082c58);
}
}
*(undefined *)(param_1 + 0xc6) = 3;

uVar2 = 0;
*(undefined *)((longlong)param_1 + 0x641) = 1;
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x18,&DAT_180082c30);
}
uVar2 = FUN_18006b424((longlong)param_1);
if (uVar2 == 0x90312) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x19,&DAT_180082c30);
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4d;
}
}
}
}
return uVar2;
}
=========================================
Function at address: 0x18006d160
Called functions addresses: 0x18006bc00 0x18006cbc0 0x180041cb0 0x180004214 0x18006c9c4 0x18006cd58 0x18002a7c0


int FUN_18006d160(longlong *param_1,uint *param_2)

{
int iVar1;

iVar1 = *(int *)((longlong)param_1 + 0x44);
if (iVar1 == 4) {
if ((*(char *)((longlong)param_1 + 0x5e2) == '\0') ||
((*(uint *)(param_1 + 0x11) >> 8 & 1) == 0)) {
return 0x90360;
}
if (*(char *)((longlong)param_1 + 0x4d1) == '\0') {
return 0;
}
if (*(char *)(param_1 + 0x9a) != '\0') {
return 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3f,&DAT_180082c30);
}
iVar1 = FUN_18006cd58((longlong)param_1,param_2);
return iVar1;
}
if (iVar1 != 0x5d) {
if (iVar1 == 0x62) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3d,&DAT_180082c30);
}
iVar1 = FUN_18006c9c4(param_1,param_2);
if (iVar1 != 0) {
return iVar1;
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x47;
return 0;
}
if (iVar1 != 99) {
if (iVar1 != 0x66) {
return 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3e,&DAT_180082c30);
}
iVar1 = FUN_18006cbc0(param_1,param_2);
if (iVar1 != 0) {
return iVar1;
}
*(undefined *)(param_1 + 0x98) = 3;

if ((*(uint *)(param_1 + 0x11) >> 0x16 & 1) != 0) {
return 0;
}
FUN_180004214(DAT_1800927f0,(longlong)param_1);
return 0;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180082c30);
}
iVar1 = FUN_18006bc00(param_1,param_2);
if (iVar1 == 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x46;
}
return iVar1;
}
=========================================
Function at address: 0x18006d350
Called functions addresses: 0x18006d3b0


void FUN_18006d350(longlong param_1,uint *param_2,undefined param_3,undefined param_4)

{
char cVar1;

cVar1 = '\0';
if ((((*(byte *)(param_1 + 0x20) & 4) != 0) && (*(longlong *)(param_1 + 8) != 0)) &&
(cVar1 = '\0', *(int *)(*(longlong *)(param_1 + 8) + 0x1c) != 0)) {
cVar1 = '\x01';
}
FUN_18006d3b0(param_1 + 0x558,param_3,param_4,'\0',cVar1,param_1,param_2);
return;
}
=========================================
Function at address: 0x18006d3b0
Called functions addresses: 0x18006d958 0x180012184 0x180028070 0x180009e8c 0x18002a7c0


void FUN_18006d3b0(longlong param_1,undefined param_2,undefined param_3,char param_4,char param_5,
longlong param_6,uint *param_7)

{
longlong *plVar1;
int iVar2;
undefined8 uVar3;
longlong lVar4;
undefined auStackY_98 [32];
undefined local_58 [8];
undefined local_50 [8];
uint local_48 [2];
undefined2 local_40 [2];
undefined4 local_3c;
uint local_38;
ulonglong local_30;

local_30 = DAT_180091970 ^ (ulonglong)auStackY_98;
lVar4 = 0;
local_58[0] = param_2;
local_50[0] = param_3;
if ((param_6 != 0) && (param_7 != (uint *)0x0)) {
local_40[0] = 2;
local_3c = 0x15;
local_48[0] = 0;
local_38 = -(uint)(param_5 != '\0') & 2;

(*(undefined8 *)(param_1 + 0xd0),1,local_40,local_48);
if (((iVar2 == 0) &&
(((uVar3 = FUN_180009e8c(param_6,param_7,local_48[0]), (int)uVar3 == 0 &&

(*(undefined8 *)(param_1 + 0xd0),param_7), iVar2 == 0)) &&

(*(undefined8 *)(param_1 + 0xd0),1,local_58), iVar2 == 0)))) &&

(*(undefined8 *)(param_1 + 0xd0),1,local_50), iVar2 == 0)) {
if ((*(char *)(param_1 + 0xc9) == '\0') && (param_5 != '\0')) {
plVar1 = *(longlong **)(param_6 + 8);
if (plVar1 != (longlong *)0x0) {
lVar4 = *plVar1;
}
iVar2 = FUN_18006d958(param_1,lVar4,param_4,*(byte *)(param_1 + 0xd8),(longlong)plVar1,0,
*(short *)(param_7 + 1));
if (iVar2 != 0) {
FUN_180012184(param_6,0x261,iVar2);
goto LAB_18006d571;
}
}

}
}
LAB_18006d571:
FUN_180028070(local_30 ^ (ulonglong)auStackY_98);
return;
}
=========================================
Function at address: 0x18006d5a0
Called functions addresses: 0x18006d3b0


void FUN_18006d5a0(longlong param_1,uint *param_2,undefined param_3,undefined param_4)

{
char cVar1;

cVar1 = '\0';
if ((((*(byte *)(param_1 + 0x20) & 4) != 0) && (*(longlong *)(param_1 + 8) != 0)) &&
(cVar1 = '\0', *(int *)(*(longlong *)(param_1 + 8) + 0x1c) != 0)) {
cVar1 = '\x01';
}
FUN_18006d3b0(param_1 + 1000,param_3,param_4,'\x01',cVar1,param_1,param_2);
return;
}
=========================================
Function at address: 0x18006d600
Called functions addresses: 0xEXTERNAL:000000f2 0xEXTERNAL:00000119


undefined8
FUN_18006d600(longlong param_1,longlong param_2,longlong param_3,char *param_4,int param_5)

{
longlong *plVar1;
undefined8 uVar2;

if ((((*(char *)(param_1 + 0xe9) == '\0') || (param_2 == 0)) || (param_5 == 0)) ||
((param_4 == (char *)0x0 || (param_3 == 0)))) {
uVar2 = 0x54f;
}
else if (((*param_4 - 0xbU & 0xf9) == 0) && (*param_4 != '\x11')) {
plVar1 = (longlong *)(param_1 + 0xf0);
if ((*plVar1 == 0) &&
(uVar2 = SslDuplicateTranscriptHash(param_2,param_3,plVar1,0), (int)uVar2 != 0)) {
return uVar2;
}
uVar2 = SslHashHandshake(param_2,*plVar1,param_4,param_5,0);
}
else {
uVar2 = 0;
}
return uVar2;
}
=========================================
Function at address: 0x18006d6b0
Called functions addresses: 0xEXTERNAL:00000122


undefined8
FUN_18006d6b0(undefined8 param_1,longlong param_2,longlong param_3,longlong param_4,int param_5)

{
undefined8 uVar1;

if ((((param_2 == 0) || (param_3 == 0)) || (param_4 == 0)) || (param_5 == 0)) {
uVar1 = 0x57;
}
else {
uVar1 = SslImportKey(param_2,param_3,L"OpaqueKeyBlob",param_4,param_5,0);
}
return uVar1;
}
=========================================
Function at address: 0x18006d710
Called functions addresses: 0x180008600 0x18002a7c0


ulonglong FUN_18006d710(longlong *param_1,char param_2)

{
uint uVar1;
ulonglong uVar2;
ulonglong uVar3;

uVar2 = FUN_180008600((longlong)param_1,param_2);
uVar3 = uVar2;
if ((((int)uVar2 == 0) && (uVar3 = uVar2 & 0xffffffff, param_1[0x6e] != 0)) &&
(*(int *)(param_1 + 0x6d) != 0)) {

(param_1,param_1[0x6e],*(int *)(param_1 + 0x6d),1);
uVar3 = (ulonglong)uVar1;
if (param_1[0x6e] != 0) {

param_1[0x6e] = 0;
}
*(undefined4 *)(param_1 + 0x6d) = 0;
}
return uVar3;
}
=========================================
Function at address: 0x18006d7ac
Called functions addresses: None


undefined8 FUN_18006d7ac(short param_1)

{
if ((param_1 != 0x39) && (param_1 != -0x5b)) {
return 0;
}
return 1;
}
=========================================
Function at address: 0x18006d7d0
Called functions addresses: 0x1800228d0 0x18006aec8


undefined8 FUN_18006d7d0(longlong *param_1,uint param_2)

{
undefined8 uVar1;

if (param_2 < 0x10000) {
uVar1 = FUN_1800228d0((longlong)param_1,param_2);
if (((int)uVar1 == 0) && (*(int *)(param_1 + 8) == 0x1000)) {
uVar1 = FUN_18006aec8(param_1,(short)param_2,(undefined8 *)0x0,(ushort *)0x0);
}
}
else {
uVar1 = 0x57;
}
return uVar1;
}
=========================================
Function at address: 0x18006d824
Called functions addresses: 0x180041cb0 0x1800432ec


undefined8 FUN_18006d824(longlong param_1,longlong param_2,uint param_3,int param_4,uint param_5)

{
byte bVar1;

if ((param_2 != 0) && (param_3 != 0)) {
bVar1 = *(byte *)(param_1 + 0x11a);
if (bVar1 != 0xff) {
if ((((char *)((ulonglong)param_3 + param_2) != (char *)0x0) && (param_4 == 1)) &&
(*(char *)((ulonglong)param_3 + param_2) == '\x01')) {
if (((param_5 & 0xfffffffb) != 0) && (*(char *)(param_1 + 0xe9) == '\0')) {
*(byte *)(param_1 + 0x11a) = bVar1 + 1;
if (5 < (byte)(bVar1 + 1)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
*(byte *)(param_1 + 0x11a) = bVar1;
FUN_1800432ec(DAT_180091000[2],0x15,&DAT_180082c30,(uint)bVar1);
}
return 0x80090317;
}
return 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180082c30);
}
return 0x80090326;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180082c30);
}
return 0x80090308;
}
}
return 0x8009035d;
}
=========================================
Function at address: 0x18006d958
Called functions addresses: 0x180010610 0x18000909c 0x18006ad5c 0xEXTERNAL:000000f5 0x18000a1f4


int FUN_18006d958(longlong param_1,longlong param_2,char param_3,byte param_4,longlong param_5,
short param_6,short param_7)

{
int iVar1;
uint *puVar2;
bool bVar3;
uint uVar4;
int iVar5;
short *psVar6;
longlong lVar7;
undefined *puVar8;
ulonglong in_stack_ffffffffffffffb0;

bVar3 = false;
if ((((param_2 == 0) || (param_4 == 0)) || (param_5 == 0)) || (3 < *(byte *)(param_1 + 200))) {
return -0x7ff6fca3;
}
puVar2 = *(uint **)(param_1 + 0xa8 + (ulonglong)*(byte *)(param_1 + 200) * 8);
if (puVar2 == (uint *)0x0) {
return -0x7ff6fcfc;
}
if (*(undefined **)(puVar2 + 2) == (undefined *)0x0) {
bVar3 = true;
psVar6 = (short *)FUN_18000a1f4(0x1c0);
*(short **)(puVar2 + 2) = psVar6;
if (psVar6 == (short *)0x0) {
iVar5 = -0x7ff6fd00;
goto LAB_18006da32;
}
*puVar2 = 0x1c0;
}
else {
if (*puVar2 < 0x1c0) {
return -0x7ff6fcfc;
}
puVar8 = *(undefined **)(puVar2 + 2);
for (lVar7 = 0x1c0; lVar7 != 0; lVar7 = lVar7 + -1) {
*puVar8 = 0;
puVar8 = puVar8 + 1;
}
psVar6 = *(short **)(puVar2 + 2);
}
uVar4 = FUN_180010610(psVar6,0x40,param_5 + 0xca);
if ((uVar4 == 0) && (uVar4 = FUN_180010610(psVar6 + 0x40,0x40,param_5 + 0x2ca), uVar4 == 0)) {
iVar1 = *(int *)(param_5 + 0x1c);
iVar5 = SslGetCipherSuitePRFHashAlgorithm
(param_2,0x304,iVar1,0,psVar6 + 0x80,
in_stack_ffffffffffffffb0 & 0xffffffff00000000);
if (iVar5 == 0) {
psVar6[0xc0] = (short)(*(uint *)(param_5 + 0x14) >> 3);
psVar6[0xc1] = 0xc;
psVar6[0xc2] = param_6;
psVar6[0xc3] = param_7;
*(uint *)(psVar6 + 0xc4) = (param_3 != '\0') + 1;
iVar5 = FUN_18006ad5c(param_1,param_2,iVar1,param_3,param_4,(longlong)psVar6,*puVar2 - 400);
if (iVar5 == 0) {
*(char *)(param_1 + 200) = *(char *)(param_1 + 200) + '\x01';
return 0;
}
}
}
else {
iVar5 = -0x7ff6fcfc;
}
if (!bVar3) {
return iVar5;
}
LAB_18006da32:
if (*(HLOCAL *)(puVar2 + 2) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(puVar2 + 2));
puVar2[2] = 0;
puVar2[3] = 0;
}
*puVar2 = 0;
return iVar5;
}
=========================================
Function at address: 0x18006db5c
Called functions addresses: 0x180043384


undefined8 FUN_18006db5c(undefined8 param_1,longlong param_2,longlong param_3,char param_4)

{
undefined8 uVar1;
char *pcVar2;

if ((param_2 == 0) || (param_3 == 0)) {
uVar1 = 0x8009035d;
}
else {
if ((*(int *)(param_3 + 0x44) == 4) && (*(int *)(param_2 + 4) != 0)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
pcVar2 = "server";
if (param_4 == '\0') {
pcVar2 = "client";
}
FUN_180043384(DAT_180091000[2],0x12,&DAT_180082c30,pcVar2);
}
*(undefined4 *)(param_3 + 0x44) = 0x4e;
}
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x18006dbe0
Called functions addresses: 0x180069b50 0x18000629c 0x18004f728 0x18006c430 0x180068a7c 0x180041cb0 0x180004214 0x18006961c 0x18006aa40 0x18006930c 0x18005c948 0x1800696a8 0x180069e18 0xEXTERNAL:0000011c 0x180069a50 0x18006049c 0x180069444 0x18006d958 0x18005dabc 0x180012184 0xEXTERNAL:000000c0 0x180041d20 0x180006300 0x180004850 0x18006aa84 0xEXTERNAL:000000f8 0x18005b470 0xEXTERNAL:000000bc 0x180043384 0x180004750 0x18002a7c0 0x180002858 0x18006b034


ulonglong FUN_18006dbe0(longlong *param_1,byte *param_2,uint param_3,undefined4 *param_4)

{
uint *puVar1;
byte *pbVar2;
ulonglong *puVar3;
undefined4 *puVar4;
char cVar5;
ushort uVar6;
uint uVar7;
DWORD DVar8;
uint extraout_EAX;
ulonglong uVar9;
ulonglong uVar10;
undefined8 uVar11;
longlong *plVar12;
int iVar13;
longlong *plVar14;
longlong lVar15;
undefined4 *puVar16;
undefined2 uVar17;
byte bVar18;
undefined uVar19;
char *pcVar20;
uint uVar21;
undefined4 uVar22;
uint local_res18 [2];
undefined4 *local_res20;
undefined8 in_stack_ffffffffffffffa0;

uVar7 = (uint)((ulonglong)in_stack_ffffffffffffffa0 >> 0x20);
*param_4 = 0;
*(undefined *)((longlong)param_1 + 0x672) = 0;
if ((param_3 == 0) || (param_2 == (byte *)0x0)) {
return 0x57;
}
bVar18 = *param_2;
puVar1 = (uint *)(param_2 + 4);
uVar21 = param_3 - 4;
uVar6 = CONCAT11(bVar18,*(undefined *)((longlong)param_1 + 0x44));
local_res18[0] = param_3;
local_res20 = param_4;
if (uVar6 < 0xd36) {
if (uVar6 != 0xd35) {
if ((uVar6 != 0x228) && (uVar6 != 0x247)) {
if (uVar6 != 0x404) {
if (uVar6 < 0x44e) {
LAB_18006e60a:
*(undefined2 *)(param_1 + 0xc) = 0xa02;
*(undefined4 *)((longlong)param_1 + 0x44) = 0x60;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041d20(DAT_180091000[2],0x2a,&DAT_180082c30,(uint)bVar18 << 8,0x60);
}
return 0x80090326;
}
if (0x44f < uVar6) {
if (uVar6 == 0x846) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1e,&DAT_180082c30);
}
uVar7 = FUN_18006961c((longlong)(param_1 + 0xcf),(undefined *)puVar1,uVar21);
if (uVar7 != 0) {
return (ulonglong)uVar7;
}
*(uint *)((longlong)param_1 + 0x44) = ~(*(uint *)(param_1 + 0x11) >> 0xe) & 2 | 0x35;
return (ulonglong)uVar7;
}
if ((uVar6 == 0xb2c) || (uVar6 == 0xb35)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x24,&DAT_180082c30);
}
uVar7 = FUN_180068a7c((longlong)(param_1 + 0xcf),(byte *)puVar1,uVar21);
if (uVar7 != 0) {
return (ulonglong)uVar7;
}
if ((*(uint *)(param_1 + 0x11) >> 0x1d & 1) != 0) {
RtlAcquireResourceExclusive(param_1[0xa5] + 0x48,1);
DVar8 = FUN_18005dabc(param_1[0xa5]);
RtlReleaseResource(param_1[0xa5] + 0x48);
if (DVar8 != 0) {
return (ulonglong)DVar8;
}
}
FUN_180004750(param_1);
uVar9 = FUN_180004850(param_1);
if ((int)uVar9 != 0) {
return uVar9 & 0xffffffff;
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x29;
return uVar9 & 0xffffffff;
}
goto LAB_18006e60a;
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x27,&DAT_180082c30);
}
uVar21 = FUN_180069b50((longlong)(param_1 + 0xcf),puVar1,uVar21);
uVar11 = 0;
uVar9 = (ulonglong)uVar21;
if (uVar21 != 0) {
return uVar9;
}
if (*(char *)((longlong)param_1 + 0x73a) == '\0') {
LAB_18006df0e:
if (*(int *)((longlong)param_1 + 0x44) == 0x4f) {
return uVar9;
}
*(undefined4 *)((longlong)param_1 + 0x44) = 4;
return uVar9;
}
if (param_1[0xb] == 0) {
return 0x54f;
}
local_res20 = (undefined4 *)0x0;
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
uVar11 = *(undefined8 *)param_1[1];
}
uVar7 = SslExpandResumptionMasterKey
(uVar11,param_1[0xb4],param_1[0x4a],&local_res20,0,
(ulonglong)uVar7 << 0x20);
uVar9 = (ulonglong)uVar7;
if (uVar7 == 0) {
RtlAcquireResourceExclusive(param_1[0xb] + 0x48,1);
lVar15 = param_1[0xb];
if (*(longlong *)(lVar15 + 0x10) != 0) {
SslFreeObject(*(longlong *)(lVar15 + 0x10),0);
lVar15 = param_1[0xb];
}
*(undefined4 **)(lVar15 + 0x10) = local_res20;
RtlReleaseResource(param_1[0xb] + 0x48);
if ((*(uint *)(param_1 + 0x11) >> 0xf & 1) != 0) {
FUN_180004214(DAT_1800927f0,(longlong)param_1);
}
*(undefined *)((longlong)param_1 + 0x73a) = 0;
goto LAB_18006df0e;
}
uVar21 = 0x265;
goto LAB_18006e356;
}
if (*(int *)((longlong)param_1 + 0x44) == 0x28) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar17 = 0x1b;
LAB_18006df67:
FUN_180041cb0(DAT_180091000[2],uVar17,&DAT_180082c30);
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
uVar17 = 0x1c;
goto LAB_18006df67;
}
param_1[0x11] = param_1[0x11] | 0x8000;
uVar22 = *(undefined4 *)((longlong)param_1 + 0x44);
uVar10 = FUN_180069e18((longlong)(param_1 + 0xcf),(undefined *)puVar1,uVar21);
uVar9 = uVar10 & 0xffffffff;
if ((int)uVar10 != 0) {
*(undefined4 *)((longlong)param_1 + 0x44) = uVar22;
return uVar9;
}
if ((*(uint *)(param_1 + 8) & 0x2000) == 0) {
param_1[0x11] = param_1[0x11] & 0xffffffffffff7fff;
*(undefined4 *)((longlong)param_1 + 0x44) = uVar22;
uVar11 = FUN_18006aa84((longlong)param_1);
uVar7 = (uint)uVar11;
goto LAB_18006e8bf;
}
if (*(int *)((longlong)param_1 + 0x44) != 0x46) {
LAB_18006e3a2:
*(undefined *)((longlong)param_1 + 0x523) = 0;
return uVar9;
}
plVar14 = param_1;

if (uVar7 != 0) {
return (ulonglong)uVar7;
}
*local_res20 = 1;
cVar5 = '\x01';
if ((*(uint *)(param_1 + 0x11) >> 0xf & 1) == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180082c30);
}
lVar15 = param_1[0xf];
if ((lVar15 != 0) && (DAT_1800927ac != '\0')) {
*(ushort *)(lVar15 + 0x40) = *(ushort *)(lVar15 + 0x40) | 4;
*(undefined4 *)(lVar15 + 0x18) = 1;
}
}
else {
lVar15 = param_1[0xa5];
local_res18[0] = local_res18[0] & 0xffffff00;
cVar5 = '\0';
if ((lVar15 != 0) && (cVar5 = '\0', *(int *)(lVar15 + 0x1b0) != 0)) {
pbVar2 = *(byte **)(lVar15 + 0x170);
local_res20 = (undefined4 *)0x0;
FUN_18000629c(plVar14,pbVar2,(uint *)0x0);
RtlAcquireResourceExclusive(param_1[0xa5] + 0x48,1);
lVar15 = DAT_1800927f0;
*(undefined *)(param_1[0xa5] + 0xec) = 0;
uVar7 = FUN_180002858(param_1[0xa5],lVar15,(longlong *)&local_res20);
lVar15 = param_1[0xa5] + 0x48;
RtlReleaseResource();
puVar4 = local_res20;
if (uVar7 != 0) {
FUN_180006300(lVar15,pbVar2,(uint *)0x0);
return (ulonglong)uVar7;
}
if (local_res20 == (undefined4 *)0x0) {
return 0x80090304;
}
RtlAcquireResourceExclusive(local_res20 + 0x12,1);
puVar16 = puVar4 + 0x12;
param_1[0xa5] = (longlong)puVar4;
param_1[0xb] = (longlong)puVar4;
RtlReleaseResource();
FUN_180006300(puVar16,pbVar2,(uint *)0x0);
cVar5 = (char)local_res18[0];
}
}
lVar15 = 0;
plVar14 = param_1 + 1;
local_res18[0] = 100;
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(plVar12 = (longlong *)*plVar14, plVar12 == (longlong *)0x0)) {
plVar12 = (longlong *)*plVar14;
uVar22 = 0;
}
else {
uVar22 = *(undefined4 *)((longlong)plVar12 + 0x1c);
}
if (plVar12 != (longlong *)0x0) {
lVar15 = *plVar12;
}
plVar12 = param_1 + 0x14;
uVar9 = FUN_18006c430((longlong)(param_1 + 0xab),lVar15,param_1[0xe],param_1[0x4a],
*(undefined2 *)((longlong)param_1 + 0x22),uVar22,cVar5,param_1 + 0x15,
plVar12,local_res18);
if ((int)uVar9 == 0) {
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 10;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
cVar5 = *(char *)((longlong)param_1 + 0xe9);
param_1[0x12] = *plVar12;
*plVar12 = 0;
uVar9 = 0;
if (cVar5 == '\0') {
param_1[0x16] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180082c58);
cVar5 = *(char *)((longlong)param_1 + 0xe9);
}
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 0xc;
if (cVar5 == '\0') {
cVar5 = '\0';
if (param_1[0x13] != 0) {
SslFreeObject(param_1[0x13],0);
cVar5 = *(char *)((longlong)param_1 + 0xe9);
}
}
param_1[0x13] = param_1[0x15];
param_1[0x15] = 0;
if (cVar5 == '\0') {
param_1[0x17] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3b,&DAT_180082c58);
}
*(undefined *)(param_1 + 0xc6) = 2;

if (cVar5 != '\0') goto LAB_18006e3a2;
puVar3 = (ulonglong *)*plVar14;
uVar10 = uVar9;
if (puVar3 != (ulonglong *)0x0) {
uVar10 = *puVar3;
}
uVar7 = FUN_18006d958((longlong)(param_1 + 0xab),uVar10,'\x01',2,(longlong)puVar3,0,0);
if (uVar7 == 0) {
puVar3 = (ulonglong *)*plVar14;
if (puVar3 != (ulonglong *)0x0) {
uVar9 = *puVar3;
}
uVar7 = FUN_18006d958((longlong)(param_1 + 0xab),uVar9,'\0',2,(longlong)puVar3,0,0);
uVar9 = (ulonglong)uVar7;
if (uVar7 == 0) goto LAB_18006e3a2;
uVar21 = 0x261;
}
else {
uVar21 = 0x262;
uVar9 = (ulonglong)uVar7;
}
uVar7 = (uint)uVar9;
goto LAB_18006e356;
}
LAB_18006e1ed:
uVar7 = (uint)uVar9;
uVar9 = uVar9 & 0xffffffff;
uVar21 = local_res18[0];
LAB_18006e356:
FUN_180012184((longlong)param_1,uVar21,uVar7);
return uVar9;
}
LAB_18006e714:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x21,&DAT_180082c30);
}
if (*(int *)(param_1[1] + 0x30) == 4) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x22,&DAT_180082c30);
}
uVar19 = 10;
uVar9 = 0x80090326;
uVar22 = 400;
LAB_18006e862:
FUN_18005b470(param_1,uVar22,(int)uVar9,uVar19);
return uVar9;
}
uVar9 = FUN_18006930c((longlong)(param_1 + 0xcf),(byte *)puVar1,uVar21);
if ((int)uVar9 != 0) {
return uVar9 & 0xffffffff;
}
*(undefined2 *)((longlong)param_1 + 0x542) = 0;
bVar18 = 0;
do {
uVar6 = *(ushort *)((longlong)param_1 + 0x542);
if (3 < uVar6) goto LAB_18006e829;
iVar13 = (&DAT_1800858e8)[bVar18];
if (iVar13 != 2) {
uVar7 = *(uint *)(param_1[10] + 0xc4);
if (uVar7 != 0) {
uVar9 = FUN_18005c948(*(uint **)(param_1[10] + 200),uVar7,iVar13,0);
if ((char)uVar9 != '\0') goto LAB_18006e81a;
uVar6 = *(ushort *)((longlong)param_1 + 0x542);
iVar13 = (&DAT_1800858e8)[bVar18];
}
*(int *)((longlong)param_1 + (ulonglong)uVar6 * 4 + 0x544) = iVar13;
*(short *)((longlong)param_1 + 0x542) = *(short *)((longlong)param_1 + 0x542) + 1;
}
LAB_18006e81a:
bVar18 = bVar18 + 1;
} while (bVar18 < 3);
uVar6 = *(ushort *)((longlong)param_1 + 0x542);
LAB_18006e829:
if (uVar6 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x23,&DAT_180082c30);
}
uVar19 = 0x28;
uVar9 = 0x80090331;
uVar22 = 0x192;
goto LAB_18006e862;
}
uVar7 = FUN_18006049c(param_1);
uVar9 = (ulonglong)uVar7;
if (uVar7 == 0x80090320) {
*(undefined *)((longlong)param_1 + 0x521) = 1;
LAB_18006e893:
uVar9 = 0;
}
else {
if (uVar7 == 0x90320) goto LAB_18006e893;
if (uVar7 != 0) {
return uVar9;
}
}
*(undefined *)((longlong)param_1 + 0x523) = 1;
if (*(char *)((longlong)param_1 + 0x641) == '\0') {
*(undefined4 *)((longlong)param_1 + 0x44) = 0x2c;
return uVar9;
}
}
else {
if (uVar6 == 0xd4e) goto LAB_18006e714;
if (uVar6 == 0xd4f) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180082c30);
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0;
}
FUN_180041cb0(DAT_180091000[2],0x20,&DAT_180082c30);
return 0;
}
if (uVar6 == 0xf29) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x25,&DAT_180082c30);
}
uVar9 = FUN_180069444((longlong)(param_1 + 0xcf),(ushort *)puVar1,uVar21);
if ((int)uVar9 != 0) {
return uVar9 & 0xffffffff;
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x36;
return uVar9 & 0xffffffff;
}
if (uVar6 < 0x1436) goto LAB_18006e60a;
if (0x1437 < uVar6) {
if ((uVar6 != 0x1804) && (uVar6 != 0x184e && uVar6 != 0x184f)) goto LAB_18006e60a;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x28,&DAT_180082c30);
}
uVar9 = FUN_180069a50((longlong)(param_1 + 0xcf),(char *)puVar1,uVar21);
lVar15 = 0;
if ((int)uVar9 != 0) {
return uVar9 & 0xffffffff;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],(short)uVar9 + 0x29,&DAT_180082c30);
}
if ((longlong *)param_1[1] != (longlong *)0x0) {
lVar15 = *(longlong *)param_1[1];
}
FUN_18004f728(lVar15,param_1 + 0xb6,param_1 + 0x12,param_1 + 0x16);
uVar9 = (ulonglong)extraout_EAX;
if (extraout_EAX != 0) {
return uVar9;
}
goto LAB_18006df0e;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
pcVar20 = "full";
if (*(int *)((longlong)param_1 + 0x44) != 0x36) {
pcVar20 = "resumption";
}
FUN_180043384(DAT_180091000[2],0x26,&DAT_180082c30,pcVar20);
}
uVar7 = FUN_1800696a8((longlong)(param_1 + 0xcf),puVar1,uVar21);
lVar15 = 0;
if (uVar7 != 0) {
return (ulonglong)uVar7;
}

if (uVar7 != 0) {
return (ulonglong)uVar7;
}
local_res18[0] = 0x387;
*local_res20 = 1;
if ((longlong *)param_1[1] != (longlong *)0x0) {
lVar15 = *(longlong *)param_1[1];
}
plVar14 = param_1 + 0x14;
uVar9 = FUN_18006b034((longlong)(param_1 + 0xab),lVar15,param_1[0x4a],param_1 + 0x15,plVar14,
local_res18);
if ((int)uVar9 != 0) goto LAB_18006e1ed;
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 10;
if (param_1[0x12] != 0) {
SslFreeObject(param_1[0x12],0);
}
param_1[0x12] = *plVar14;
*plVar14 = 0;
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
param_1[0x16] = 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3c,&DAT_180082c58);
}
}
*(undefined4 *)((longlong)param_1 + 0x44) = 0x65;
uVar7 = FUN_18006aa40(param_1);
LAB_18006e8bf:
return (ulonglong)uVar7;
}
=========================================
Function at address: 0x18006e900
Called functions addresses: 0x180046a38


void FUN_18006e900(longlong param_1,longlong param_2)

{
longlong lVar1;

if (*(longlong **)(param_1 + 8) == (longlong *)0x0) {
lVar1 = 0;
}
else {
lVar1 = **(longlong **)(param_1 + 8);
}
FUN_180046a38(param_1,lVar1,*(longlong *)(param_1 + 0x5b8),0,0,param_2);
return;
}
=========================================
Function at address: 0x18006e940
Called functions addresses: 0x180046a38


void FUN_18006e940(longlong param_1,longlong param_2)

{
longlong lVar1;

if (*(longlong **)(param_1 + 8) == (longlong *)0x0) {
lVar1 = 0;
}
else {
lVar1 = **(longlong **)(param_1 + 8);
}
FUN_180046a38(param_1,lVar1,*(longlong *)(param_1 + 0x448),0,0,param_2);
return;
}
=========================================
Function at address: 0x18006e97c
Called functions addresses: 0x18000909c 0x18002a77b 0x18000a1f4


undefined8
FUN_18006e97c(longlong param_1,short param_2,uint param_3,longlong param_4,ushort param_5)

{
longlong lVar1;
uint uVar2;
HLOCAL _Dst;
short *psVar3;
uint uVar4;
undefined8 uVar5;
ushort uVar6;
void *pvStack_20;

lVar1 = *(longlong *)(param_1 + 0x80);
pvStack_20 = (void *)0x0;
uVar5 = 0;
if ((lVar1 != 0) && (*(char *)(param_1 + 0x88) != '\x02')) {
for (psVar3 = (short *)(lVar1 + 8); uVar5 = 0,
psVar3 < (short *)(lVar1 + ((ulonglong)*(uint *)(lVar1 + 4) + 2) * 4); psVar3 = psVar3 + 2)
{
if (((ushort)psVar3[1] == param_3) && (*psVar3 == param_2)) {
if ((int)(0xffff - (uint)param_5) < 4) {
_Dst = *(HLOCAL *)(param_1 + 0xa0);
LAB_18006eae9:
uVar5 = 0x80090304;
}
else {
uVar6 = param_5 + 4;
uVar5 = 0;
if (~*(uint *)(param_1 + 0x98) < (uint)uVar6) break;
uVar4 = (uint)uVar6;
if (*(longlong *)(param_1 + 0xa0) == 0) {
_Dst = (HLOCAL)FUN_18000a1f4((ulonglong)uVar4);
*(HLOCAL *)(param_1 + 0xa0) = _Dst;
if (_Dst != (void *)0x0) {
*(uint *)(param_1 + 0x98) = uVar4;
LAB_18006eacc:
memcpy(_Dst,(void *)(param_4 + -4),(ulonglong)uVar6);
*(char *)(param_1 + 0x88) = *(char *)(param_1 + 0x88) + '\x01';
*(undefined *)(param_1 + 8) = 0;
break;
}
}
else {
uVar2 = *(uint *)(param_1 + 0x98);
pvStack_20 = *(void **)(param_1 + 0xa0);
*(undefined8 *)(param_1 + 0xa0) = 0;
*(undefined4 *)(param_1 + 0x98) = 0;
if ((uVar2 == 0) || (pvStack_20 == (void *)0x0)) {
_Dst = (HLOCAL)0x0;
goto LAB_18006eae9;
}
_Dst = (HLOCAL)FUN_18000a1f4((ulonglong)(uVar4 + uVar2));
*(HLOCAL *)(param_1 + 0xa0) = _Dst;
if (_Dst != (void *)0x0) {
*(uint *)(param_1 + 0x98) = uVar4 + uVar2;
memcpy(_Dst,pvStack_20,(ulonglong)uVar2);
_Dst = (HLOCAL)((longlong)_Dst + (ulonglong)uVar2);
goto LAB_18006eacc;
}
}
uVar5 = 0x80090300;
}
if (_Dst != (HLOCAL)0x0) {
FUN_18000909c(_Dst);
*(undefined8 *)(param_1 + 0xa0) = 0;
}
*(undefined4 *)(param_1 + 0x98) = 0;
break;
}
}
}
if (pvStack_20 != (HLOCAL)0x0) {
FUN_18000909c(pvStack_20);
}
return uVar5;
}
=========================================
Function at address: 0x18006eb44
Called functions addresses: 0x18002a77b 0x18000909c


undefined8 FUN_18006eb44(longlong param_1)

{
uint uVar1;
void *_Src;
uint *puVar2;
longlong lVar3;
undefined8 uVar4;
undefined *puVar5;
bool bVar6;

_Src = *(void **)(param_1 + 0xa0);
if (_Src == (void *)0x0) {
return 0;
}
uVar1 = *(uint *)(param_1 + 0x98);
if (uVar1 == 0) {
return 0;
}
puVar2 = *(uint **)(param_1 + 0x90);
if (puVar2 == (uint *)0x0) {
return 0;
}
bVar6 = *puVar2 == 0;
if (!bVar6) {
if (*puVar2 < uVar1) {
*puVar2 = uVar1;
uVar4 = 0x8009036a;
*(undefined *)(param_1 + 8) = 1;
goto LAB_18006ebe5;
}
bVar6 = *puVar2 == 0;
}
if (bVar6) {
*(void **)(puVar2 + 2) = _Src;
**(uint **)(param_1 + 0x90) = uVar1;
}
else {
memcpy(*(void **)(puVar2 + 2),_Src,(ulonglong)uVar1);
**(uint **)(param_1 + 0x90) = uVar1;
FUN_18000909c(*(HLOCAL *)(param_1 + 0xa0));
}
*(undefined8 *)(param_1 + 0xa0) = 0;
uVar4 = 0x90316;
*(undefined4 *)(param_1 + 0x98) = 0;
*(undefined *)(param_1 + 0x88) = 0;
LAB_18006ebe5:
*(undefined8 *)(param_1 + 0x90) = 0;
*(undefined8 *)(param_1 + 0x80) = 0;
puVar5 = (undefined *)(param_1 + 0x70);
for (lVar3 = 8; lVar3 != 0; lVar3 = lVar3 + -1) {
*puVar5 = 0;
puVar5 = puVar5 + 1;
}
*(undefined *)(param_1 + 0x78) = 0;
return uVar4;
}
=========================================
Function at address: 0x18006ec1c
Called functions addresses: None


undefined8 FUN_18006ec1c(longlong param_1,undefined2 *param_2,char *param_3)

{
char cVar1;

if ((*(char *)(param_1 + 0x20) == '\0') && (*(char *)(param_1 + 0xc9) != '\0')) {
if ((param_2 == (undefined2 *)0x0) ||
((param_3 == (char *)0x0 || (cVar1 = *param_3, cVar1 == -1)))) {
return 0x57;
}
*param_2 = 1;
*param_3 = cVar1 + '\x01';
*(undefined8 *)(param_2 + 2) = 0x14;
}
return 0;
}
=========================================
Function at address: 0x18006ec64
Called functions addresses: 0x18002a77b 0x18000a1f4 0x18006afc8


undefined8 FUN_18006ec64(longlong param_1,void *param_2,byte param_3)

{
void *_Dst;

FUN_18006afc8(param_1 + 0x558);
if ((param_2 != (void *)0x0) && (param_3 != 0)) {
_Dst = (void *)FUN_18000a1f4((ulonglong)param_3);
*(void **)(param_1 + 0x638) = _Dst;
if (_Dst == (void *)0x0) {
return 0x80090300;
}
*(byte *)(param_1 + 0x640) = param_3;
memcpy(_Dst,param_2,(ulonglong)param_3);
}
return 0;
}
=========================================
Function at address: 0x18006ece0
Called functions addresses: 0x180041cdc 0x18006edf0 0x18006aec8 0x18005b470 0x180041d20


ulonglong FUN_18006ece0(longlong *param_1,uint param_2,undefined8 param_3)

{
int iVar1;
ulonglong uVar2;
ulonglong uVar3;
ushort local_res10 [8];
char *local_res20;

if (param_2 < 0x10000) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x42,&DAT_180082c30,param_2);
}
local_res20 = (char *)0x0;
local_res10[0] = 0;
uVar3 = FUN_18006aec8(param_1,(ushort)param_2,&local_res20,local_res10);
uVar2 = uVar3 & 0xffffffff;
if ((int)uVar3 == 0) {
iVar1 = FUN_18006edf0((longlong)(param_1 + 0x7d),(ushort)param_2,local_res20,local_res10[0],
param_3);
if (iVar1 == 0) {
uVar2 = 0;
}
else {
FUN_18005b470(param_1,0x4b2,0x80090308,0x32);
uVar2 = 0x80090308;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041d20(DAT_180091000[2],0x43,&DAT_180082c30,param_2,(char)uVar3);
}
}
else {
uVar2 = 0x57;
}
return uVar2;
}
=========================================
Function at address: 0x18006edf0
Called functions addresses: 0x18002a77b 0x180041cdc 0x180041cb0 0x18002a700 0xEXTERNAL:0000011c 0x180028d90 0x18000a418 0x180028070 0x18002a7c0 0xEXTERNAL:00000122 0x180061ddc


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_18006edf0(longlong param_1,ushort param_2,char *param_3,ushort param_4,undefined8 param_5)

{
uint uVar1;
longlong lVar2;
longlong lVar3;
int iVar4;
ulonglong uVar5;
undefined8 uVar6;
undefined4 *puVar7;
ulonglong uVar8;
ulonglong uVar9;
undefined2 uVar10;
uint *_Dst;
undefined *puVar11;
undefined *puVar12;
ushort uVar13;
uint uVar14;
undefined auStack_78 [48];
uint local_48 [2];
undefined8 local_40;
longlong local_38;
ulonglong local_30;

local_30 = DAT_180091970 ^ (ulonglong)local_48;
uVar8 = (ulonglong)param_4;
puVar11 = auStack_78;
local_38 = param_1;
if ((param_3 == (char *)0x0) || (puVar11 = auStack_78, param_4 == 0)) goto LAB_18006ef17;
local_48[1] = (uint)param_2;
local_48[0] = 0;
uVar5 = FUN_180061ddc(param_1,local_48[1],local_48);
if ((int)uVar5 != 0) {
puVar11 = auStack_78;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(puVar11 = auStack_78, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180082c30,(int)uVar5);
puVar11 = auStack_78;
}
goto LAB_18006ef17;
}
if ((local_48[0] & 8) == 0) {
if ((param_4 == 0) || (*param_3 != '\x04')) {
puVar11 = auStack_78;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
(puVar11 = auStack_78, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0))
goto LAB_18006ef17;
uVar10 = 0xb;
}
else {
param_3 = param_3 + 1;
uVar13 = param_4 - 1;
uVar8 = (ulonglong)uVar13;
if ((uVar13 & 1) == 0) {
uVar14 = (uint)(uVar13 >> 1);
goto LAB_18006ef41;
}
puVar11 = auStack_78;
if (((undefined8 **)DAT_180091000 == &DAT_180091000) ||
(puVar11 = auStack_78, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0))
goto LAB_18006ef17;
uVar10 = 0xc;
}
FUN_180041cb0(DAT_180091000[2],uVar10,&DAT_180082c30);
puVar11 = auStack_78;
goto LAB_18006ef17;
}
uVar14 = (uint)param_4;
LAB_18006ef41:
iVar4 = uVar14 * 2;
uVar1 = iVar4 + 8;
uVar5 = (ulonglong)uVar1;
_Dst = (uint *)0x0;
puVar11 = auStack_78;
if (((DAT_1800920e0 < uVar5) ||
(uVar9 = DAT_1800920e8 + 8 + uVar5, puVar11 = auStack_78, uVar9 < uVar5)) ||
(uVar6 = FUN_18000a418(uVar9), _Dst = (uint *)0x0, puVar11 = auStack_78, (int)uVar6 == 0)) {
LAB_18006efaf:
if (uVar1 <= iVar4 + 0x10U) {
*(undefined8 *)(puVar11 + -8) = 0x18006efd1;

if (puVar7 == (undefined4 *)0x0) goto LAB_18006ef17;
*puVar7 = 0x70616548;
_Dst = puVar7 + 2;
}
puVar12 = puVar11;
if (_Dst == (uint *)0x0) goto LAB_18006ef17;
}
else {
uVar9 = (ulonglong)(iVar4 + 0x10U) + 0xf;
if (uVar9 <= iVar4 + 0x10U) {
uVar9 = 0xffffffffffffff0;
}
lVar3 = -(uVar9 & 0xfffffffffffffff0);
_Dst = (uint *)((longlong)local_48 + lVar3);
puVar11 = auStack_78 + lVar3;
if (_Dst == (uint *)0x0) goto LAB_18006efaf;
*_Dst = 0x6b637453;
_Dst = (uint *)((longlong)&local_40 + lVar3);
puVar11 = auStack_78 + lVar3;
puVar12 = auStack_78 + lVar3;
if (_Dst == (uint *)0x0) goto LAB_18006efaf;
}
*(undefined8 *)(puVar12 + -8) = 0x18006efff;
memset(_Dst,0,uVar5);
*_Dst = local_48[1];
_Dst[1] = uVar14;
*(undefined8 *)(puVar12 + -8) = 0x18006f018;
memcpy(_Dst + 2,param_3,uVar8);
*(undefined4 *)(puVar12 + 0x28) = 0;
local_40 = 0;
*(uint *)(puVar12 + 0x20) = uVar1;
*(undefined8 *)(puVar12 + -8) = 0x18006f040;
iVar4 = SslImportKey(param_5,&local_40,L"SSLECCPUBLICBLOB",_Dst);
if (_Dst[-2] == 0x70616548) {
*(undefined8 *)(puVar12 + -8) = 0x18006f06a;

}
lVar3 = local_38;
puVar11 = puVar12;
if (iVar4 == 0) {
lVar2 = *(longlong *)(local_38 + 0x28);
if (lVar2 != 0) {
*(undefined8 *)(puVar12 + -8) = 0x18006f0bc;
SslFreeObject(lVar2,0);
}
*(undefined8 *)(lVar3 + 0x28) = local_40;
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar6 = DAT_180091000[2];
*(undefined8 *)(puVar12 + -8) = 0x18006f09f;
FUN_180041cdc(uVar6,0xd,&DAT_180082c30,iVar4);
}
LAB_18006ef17:
uVar8 = local_30 ^ (ulonglong)local_48;
*(undefined8 *)(puVar11 + -8) = 0x18006ef23;
FUN_180028070(uVar8);
return;
}
=========================================
Function at address: 0x18006f0d8
Called functions addresses: None


undefined8 FUN_18006f0d8(longlong param_1,longlong param_2,char param_3,char param_4)

{
undefined8 uVar1;
ulonglong uVar2;
longlong lVar3;
uint *puVar4;
byte bVar5;
undefined *puVar6;

if (param_3 == '\0') {
if (param_2 == 0) {
uVar1 = 0x8009035d;
}
else {
puVar6 = (undefined *)(param_1 + 0xa8);
for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
*puVar6 = 0;
puVar6 = puVar6 + 1;
}
*(undefined *)(param_1 + 200) = 0;
bVar5 = 0;
puVar4 = *(uint **)(param_2 + 8);
if (puVar4 < puVar4 + (ulonglong)*(uint *)(param_2 + 4) * 4) {
do {
if (3 < bVar5) goto LAB_18006f177;
if ((puVar4[1] & 0xfffffff) == 0x1c) {
if (param_4 == '\0') {
if (*(longlong *)(puVar4 + 2) == 0) {
uVar1 = 0xe;
goto LAB_18006f1a2;
}
if (*puVar4 < 0x1c0) {
*puVar4 = 0x1c0;
goto LAB_18006f15c;
}
}
else {
puVar4[2] = 0;
puVar4[3] = 0;
*puVar4 = 0;
}
uVar2 = (ulonglong)bVar5;
bVar5 = bVar5 + 1;
*(uint **)(param_1 + 0xa8 + uVar2 * 8) = puVar4;
}
LAB_18006f15c:
puVar4 = puVar4 + 4;
} while (puVar4 < (uint *)((ulonglong)*(uint *)(param_2 + 4) * 0x10 +
*(longlong *)(param_2 + 8)));
if (3 < bVar5) {
LAB_18006f177:
*(undefined *)(param_1 + 0xc9) = 0;
return 0;
}
}
uVar1 = 0x8009036b;
LAB_18006f1a2:
puVar6 = (undefined *)(param_1 + 0xa8);
for (lVar3 = 0x20; lVar3 != 0; lVar3 = lVar3 + -1) {
*puVar6 = 0;
puVar6 = puVar6 + 1;
}
*(undefined *)(param_1 + 200) = 0;
}
}
else {
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x18006f1c4
Called functions addresses: 0x18002a77b 0x18000909c 0x18000a1f4


undefined4 FUN_18006f1c4(longlong param_1,undefined *param_2,ushort param_3)

{
void *_Dst;

if ((param_3 != 0) && (param_2 == (undefined *)0x0)) {
return 0x57;
}
if (*(HLOCAL *)(param_1 + 0x5d8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x5d8));
*(undefined8 *)(param_1 + 0x5d8) = 0;
*(undefined2 *)(param_1 + 0x5e0) = 0;
}
if (param_3 != 0) {
if ((*(int *)(param_1 + 0x44) == 0x47) &&
((param_3 < 4 || (*(uint *)(param_1 + 0x10) != (uint)CONCAT11(*param_2,param_2[1]))))) {
return 0x80090326;
}
_Dst = (void *)FUN_18000a1f4((ulonglong)param_3);
*(void **)(param_1 + 0x5d8) = _Dst;
if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,param_2,(ulonglong)param_3);
*(ushort *)(param_1 + 0x5e0) = param_3;
}
return 0;
}
=========================================
Function at address: 0x18006f290
Called functions addresses: 0x18002a77b 0x18006d600 0x180014300


ulonglong FUN_18006f290(longlong param_1,char *param_2,uint param_3)

{
int iVar1;
longlong lVar2;
ulonglong uVar3;
undefined4 extraout_var;

lVar2 = 0;
if (*(char *)(param_1 + 0x641) != '\0') {
if (*(longlong **)(param_1 + 8) != (longlong *)0x0) {
lVar2 = **(longlong **)(param_1 + 8);
}
uVar3 = FUN_18006d600(param_1 + 0x558,lVar2,*(longlong *)(param_1 + 0x250),param_2,param_3);
return uVar3;
}
if (*(int *)(param_1 + 0x224) != 0) {
iVar1 = FUN_180014300(param_1,param_2,param_3);
return CONCAT44(extraout_var,iVar1);
}
if ((*(longlong *)(param_1 + 0x370) == 0) || (*(int *)(param_1 + 0x368) == 0)) {
return 0x54f;
}
if (param_2 == (char *)0x0) {
if (param_3 != 0) {
return 0x57;
}
}
else if (param_3 == 0) {
return 0x57;
}
if (*(int *)(param_1 + 0x368) - *(uint *)(param_1 + 0x728) < param_3) {
return 0x57;
}
memcpy((void *)(*(longlong *)(param_1 + 0x370) + (ulonglong)*(uint *)(param_1 + 0x728)),param_2,
(ulonglong)param_3);
*(int *)(param_1 + 0x728) = *(int *)(param_1 + 0x728) + param_3;
return 0;
}
=========================================
Function at address: 0x18006f350
Called functions addresses: 0x18006d600 0x180014300


void FUN_18006f350(longlong param_1,char *param_2,int param_3)

{
longlong lVar1;

lVar1 = 0;
if (*(char *)(param_1 + 0x4d1) != '\0') {
if (*(longlong **)(param_1 + 8) != (longlong *)0x0) {
lVar1 = **(longlong **)(param_1 + 8);
}
FUN_18006d600(param_1 + 1000,lVar1,*(longlong *)(param_1 + 0x250),param_2,param_3);
return;
}
FUN_180014300(param_1,param_2,param_3);
return;
}
=========================================
Function at address: 0x18006f3a0
Called functions addresses: 0xEXTERNAL:0000011c 0xEXTERNAL:000000c2 0x18006b1a8 0x18005d5d4 0x180028070 0xEXTERNAL:000000c0 0xEXTERNAL:00000119 0xEXTERNAL:000000f6 0x180041cdc 0xEXTERNAL:00000075 0x18004492c 0x180028d90 0x180041cb0 0x18005b470 0xEXTERNAL:000000f2 0x18002a7c0


void FUN_18006f3a0(longlong *param_1,longlong param_2,ushort param_3,ushort param_4,
undefined2 param_5)

{
ushort uVar1;
longlong *plVar2;
uint uVar3;
int iVar4;
int iVar5;
undefined8 uVar6;
longlong lVar7;
ulonglong uVar8;
ulonglong uVar9;
longlong lVar10;
undefined auStackY_f8 [32];
uint local_a4;
longlong local_a0;
undefined local_98 [64];
ulonglong local_58;

local_58 = DAT_180091970 ^ (ulonglong)auStackY_f8;
if (((((param_2 != 0) && (param_3 != 0)) && (param_4 != 0)) &&
((lVar10 = param_1[0x7c], lVar10 != 0 && (param_1[0x6e] != 0)))) &&
((uint)param_4 <= *(uint *)(param_1 + 0x6d))) {
uVar1 = *(ushort *)((longlong)param_1 + 0x22);
local_a0 = 0;
memset(local_98,0,0x40);
local_a4 = 0;
RtlAcquireResourceShared(lVar10 + 0x48,1);
uVar6 = FUN_18005d5d4(param_1[0x7c],(undefined *)&local_a4,(undefined4 *)0x0);
uVar3 = local_a4;
if (((int)uVar6 == 0) && (uVar9 = (ulonglong)local_a4, local_a4 < 0x41)) {
if (local_a4 == param_3) {
plVar2 = *(longlong **)(param_1[0x7c] + 0xb0);
if (plVar2 == (longlong *)0x0) {
iVar5 = 0;
lVar10 = 0;
}
else {
iVar5 = *(int *)((longlong)plVar2 + 0x1c);
lVar10 = *plVar2;
}

if (lVar7 == 0) {
iVar4 = SslCreateHandshakeHash(lVar10,&local_a0,uVar1,iVar5);
}
else {
iVar4 = SslDuplicateTranscriptHash(lVar10,lVar7,&local_a0,0);
}
if ((iVar4 == 0) &&
(iVar4 = SslHashHandshake(lVar10,local_a0,param_1[0x6e],
*(int *)(param_1 + 0x6d) - (uint)param_4), iVar4 == 0)) {
lVar7 = param_1[0x7c];
iVar5 = FUN_18006b1a8((longlong)(param_1 + 0x7d),lVar10,*(longlong *)(lVar7 + 0x10),
local_a0,uVar1,iVar5,*(undefined8 *)(lVar7 + 200),
(uint)*(byte *)(lVar7 + 0xd0),(longlong)local_98,uVar3);
if (iVar5 == 0) {
uVar8 = RtlCompareMemory(local_98,param_2,uVar9);
if (uVar8 == uVar9) {
*(undefined2 *)((longlong)param_1 + 0x5c4) = param_5;
param_1[0x11] = param_1[0x11] & 0xffffffffffff7fff;
}
else {
FUN_18005b470(param_1,0x4ba,0x80090308,0x2f);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x46,&DAT_180082c30);
}
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x45,&DAT_180082c30,iVar5);
}
}
}
else {
FUN_18005b470(param_1,0x4ba,0x80090308,0x2f);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_18004492c(DAT_180091000[2],0x44,&DAT_180082c30,(uint)param_3,(char)uVar3);
}
}
}
RtlReleaseResource(param_1[0x7c] + 0x48);
if (local_a0 != 0) {
SslFreeObject(local_a0,0);
}
}
FUN_180028070(local_58 ^ (ulonglong)auStackY_f8);
return;
}
=========================================
Function at address: 0x18006f700
Called functions addresses: 0x180028a7c


void FUN_18006f700(longlong param_1)

{
if (*(longlong *)(param_1 + 0x28) != 0) {
_o_free();
}
if (*(longlong *)(param_1 + 0x38) != 0) {
_o_free();
}
return;
}
=========================================
Function at address: 0x18006f734
Called functions addresses: 0x18000909c 0x18006f700


HLOCAL FUN_18006f734(HLOCAL param_1)

{
FUN_18006f700((longlong)param_1);
if (param_1 != (HLOCAL)0x0) {
FUN_18000909c(param_1);
}
return param_1;
}
=========================================
Function at address: 0x18006f760
Called functions addresses: None


longlong FUN_18006f760(longlong param_1)

{
int iVar1;
uint7 uVar2;

iVar1 = *(int *)(param_1 + 0x44);
uVar2 = (uint7)(uint3)((uint)iVar1 >> 8);
if ((iVar1 != 2) &&
((iVar1 < 4 ||
((((5 < iVar1 && (iVar1 != 0x5b)) && (iVar1 != 0x5d)) &&
((iVar1 < 0x5f || ((0x60 < iVar1 && ((iVar1 < 0x62 || (0x66 < iVar1)))))))))))) {
return CONCAT71(uVar2,1);
}
return (ulonglong)uVar2 << 8;
}
=========================================
Function at address: 0x18006f7a0
Called functions addresses: None


undefined8 FUN_18006f7a0(longlong param_1,ulonglong param_2)

{
ulonglong uVar1;
undefined uVar2;
ulonglong uVar3;
ulonglong uVar4;

uVar4 = param_2 & 0xffffffffffff;
uVar3 = *(longlong *)(param_1 + 0xd0) + 0x3f;
uVar1 = (ulonglong)*(int *)(param_1 + 0xc0);
if (*(int *)(param_1 + 0xc0) == -1) {
LAB_18006f864:
uVar2 = 1;
}
else {
if (uVar1 <= param_2 >> 0x30) {
if (uVar3 < uVar4) {
if (uVar4 - uVar3 < 0x40) {
uVar1 = *(longlong *)(param_1 + 200) << ((byte)(uVar4 - uVar3) & 0x3f) | 1;
}
else {
uVar1 = 1;
}
uVar2 = 1;
*(ulonglong *)(param_1 + 200) = uVar1;
uVar1 = uVar4 - 0x3f;
*(ulonglong *)(param_1 + 0xd0) = uVar1;
goto LAB_18006f869;
}
uVar3 = uVar3 - uVar4;
if (uVar3 < 0x40) {
uVar1 = *(ulonglong *)(param_1 + 200);
if ((uVar1 >> (uVar3 & 0x3f) & 1) != 0) {
if (*(char *)(param_1 + 0xe8) == '\0') goto LAB_18006f7d7;
**(int **)(param_1 + 0x240) = **(int **)(param_1 + 0x240) + -1;
uVar1 = *(ulonglong *)(param_1 + 200);
*(undefined *)(param_1 + 0xe8) = 0;
}
uVar1 = uVar1 | 1L << (uVar3 & 0x3f);
*(ulonglong *)(param_1 + 200) = uVar1;
goto LAB_18006f864;
}
}
LAB_18006f7d7:
uVar2 = 0;
}
LAB_18006f869:
return CONCAT71((int7)(uVar1 >> 8),uVar2);
}
=========================================
Function at address: 0x18006f874
Called functions addresses: 0x18006ffcc 0x18006fcd4 0x18002a7c0


int FUN_18006f874(longlong *param_1,undefined4 *param_2,uint *param_3)

{
int iVar1;
ulonglong uVar2;

if ((((*(char *)((longlong)param_1 + 0xe9) == '\0') || (param_2 == (undefined4 *)0x0)) ||
(*(longlong *)(param_2 + 2) == 0)) || (param_3 == (uint *)0x0)) {
iVar1 = 0x57;
}
else {
iVar1 = FUN_18006fcd4((longlong)param_1,(longlong)param_2);

*(undefined8 *)(param_2 + 2) = 0;
*param_2 = 0;
param_2[1] = 0;
if (iVar1 == 0) {
uVar2 = FUN_18006ffcc(param_1,param_3);
iVar1 = (int)uVar2;
}
}
return iVar1;
}
=========================================
Function at address: 0x18006f914
Called functions addresses: 0x180014b9c 0x180041cb0 0x18000172c 0x180012184 0x1800451f4


int FUN_18006f914(longlong *param_1,int param_2,byte *param_3,uint param_4)

{
undefined8 uVar1;
int iVar2;
char local_res10 [8];

if (param_2 == 0x15) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x38,&DAT_180082c58);
}
uVar1 = FUN_18000172c(param_3,param_4,(byte *)((longlong)param_1 + 0x1d9),local_res10);
iVar2 = (int)uVar1;
if (iVar2 == 0) {
if (local_res10[0] != (char)uVar1) {
*(undefined *)(param_1 + 0x45) = 1;
*(undefined4 *)((longlong)param_1 + 0x44) = 0x4b;
}
}
else if ((*(uint *)((longlong)param_1 + 0x24) < 0x302) ||
((*(uint *)(param_1 + 8) & 0x800a00aa) == 0)) {
if (param_4 == 2) {
FUN_1800451f4(*(uint *)(param_1[10] + 0xd4),param_1[10] + 0xd8,*param_3);
}
}
else {
FUN_180012184((longlong)param_1,0xe,iVar2);
iVar2 = -0x7ff6fcda;
}
}
else if (param_2 == 0x16) {
if ((param_4 < 0xc) ||
(iVar2 = (uint)param_3[2] * 0x100 + (uint)param_3[1] * 0x10000 + (uint)param_3[3],
param_4 < iVar2 + 0xcU)) {
iVar2 = -0x7ff6fcf8;
}
else {
iVar2 = FUN_180014b9c(param_1,param_3,iVar2 + 0xc);
}
}
else {
iVar2 = 0;
}
return iVar2;
}
=========================================
Function at address: 0x18006fa58
Called functions addresses: None


short FUN_18006fa58(short *param_1,ushort param_2,short *param_3,ushort param_4)

{
short *psVar1;
short *psVar2;
short *psVar3;

if ((((param_1 != (short *)0x0) && (param_2 != 0)) && (param_3 != (short *)0x0)) &&
((param_4 != 0 &&
(psVar3 = (short *)(((ulonglong)param_2 & 0xfffffffffffffffe) + (longlong)param_1),
param_1 < psVar3)))) {
psVar2 = (short *)(((ulonglong)param_4 & 0xfffffffffffffffe) + (longlong)param_3);
do {
if (param_3 < psVar2) {
psVar1 = param_3;
do {
if (*param_1 == *psVar1) {
return *param_1;
}
psVar1 = psVar1 + 1;
} while (psVar1 < psVar2);
}
param_1 = param_1 + 1;
} while (param_1 < psVar3);
}
return 0;
}
=========================================
Function at address: 0x18006fac0
Called functions addresses: 0x18002a77b 0x1800729c0


undefined4 FUN_18006fac0(longlong param_1,undefined *param_2,undefined param_3)

{
undefined uVar1;
uint uVar2;
longlong lVar3;
ulonglong uVar4;
uint uVar5;
undefined8 *puVar6;
ulonglong uVar7;
uint uVar8;
uint uVar9;
undefined4 uVar10;
uint uVar11;
ulonglong uVar12;
uint uVar13;
int iVar14;
uint uVar15;
int iVar16;
ulonglong _Size;
uint local_res20;

uVar15 = 0;
uVar2 = *(uint *)(param_1 + 0x3c);
uVar7 = (ulonglong)uVar2;
uVar9 = (-(uint)(*(char *)(param_1 + 0xe9) != '\0') & 8) + 4;
uVar11 = *(ushort *)(param_1 + 0xda) - uVar9;
if (param_2 == (undefined *)0x0) {
uVar10 = 0x57;
}
else {
uVar13 = ((uint)(byte)param_2[1] * 0x100 + (uint)(byte)param_2[2]) * 0x100 +
(uint)(byte)param_2[3];
iVar14 = (uint)(byte)param_2[4] * 0x100 + (uint)(byte)param_2[5];
uVar1 = *param_2;
uVar4 = (ulonglong)uVar13 % (ulonglong)uVar11;
uVar5 = ((uVar13 - 1) + uVar11) / uVar11;
uVar8 = uVar5;
if (uVar5 < 2) {
uVar8 = 1;
}
uVar12 = (ulonglong)uVar11;
if (uVar5 < 2) {
uVar12 = uVar4;
}
local_res20 = 0;
_Size = uVar12;
if (uVar8 != 0) {
do {
iVar16 = (int)uVar12;
if ((1 < uVar8) && (local_res20 == uVar8 - 1)) {
iVar16 = (int)uVar4;
_Size = uVar4;
}
uVar11 = iVar16 + uVar2 + uVar9;
uVar12 = (ulonglong)uVar11;
puVar6 = FUN_1800729c0(*(longlong *)(param_1 + 0x240),uVar11);
if (puVar6 == (undefined8 *)0x0) {
return 8;
}
iVar16 = (int)_Size;
if (iVar16 != 0) {
memcpy((void *)(puVar6[1] + uVar7 + (ulonglong)uVar9),
param_2 + (ulonglong)uVar15 + (ulonglong)uVar9,_Size);
}
*(undefined *)puVar6[1] = param_3;
local_res20 = local_res20 + 1;
lVar3 = puVar6[1];
*(char *)(lVar3 + 0xc) = (char)(iVar16 + uVar9);
*(char *)(lVar3 + 0xb) = (char)(iVar16 + uVar9 >> 8);
lVar3 = puVar6[1];
*(char *)(uVar7 + 2 + lVar3) = (char)(uVar13 >> 8);
*(char *)(uVar7 + 1 + lVar3) = (char)(uVar13 >> 0x10);
*(char *)(uVar7 + 7 + lVar3) = (char)(uVar15 >> 8);
*(char *)(uVar7 + 6 + lVar3) = (char)(uVar15 >> 0x10);
*(char *)(uVar7 + 10 + lVar3) = (char)(_Size >> 8);
*(char *)(uVar7 + 9 + lVar3) = (char)(_Size >> 0x10);
*(char *)(uVar7 + 5 + lVar3) = (char)iVar14;
*(char *)(uVar7 + 4 + lVar3) = (char)((uint)iVar14 >> 8);
*(undefined *)(uVar7 + lVar3) = uVar1;
*(char *)(uVar7 + 8 + lVar3) = (char)uVar15;
*(char *)(uVar7 + 3 + lVar3) = (char)uVar13;
uVar15 = uVar15 + iVar16;
*(char *)(uVar7 + 0xb + lVar3) = (char)_Size;
*(uint *)((longlong)puVar6 + 4) = iVar16 + uVar2 + uVar9;
} while (local_res20 < uVar8);
}
uVar10 = 0;
}
return uVar10;
}
=========================================
Function at address: 0x18006fcd4
Called functions addresses: 0x18002a77b 0x1800729c0 0x18006fac0


int FUN_18006fcd4(longlong param_1,longlong param_2)

{
undefined uVar1;
uint uVar2;
int iVar3;
undefined8 *puVar4;
uint uVar5;
ulonglong uVar6;
undefined *puVar7;
undefined *_Src;
uint uVar8;
uint uVar9;
uint uVar10;
undefined *puVar11;

_Src = *(undefined **)(param_2 + 8);
uVar2 = *(uint *)(param_1 + 0x3c);
if (_Src != (undefined *)0x0) {
uVar6 = (ulonglong)*(uint *)(param_2 + 4);
uVar10 = 0;
do {
uVar8 = (uint)(byte)_Src[0xb] * 0x100 + (uint)(byte)_Src[0xc];
uVar10 = uVar10 + uVar8 + uVar2;
if ((uint)uVar6 < uVar10) {
return 0x57;
}
uVar1 = *_Src;
uVar5 = uVar8;
if ((*(byte *)(param_1 + 0x20) & 4) != 0) {
uVar9 = *(uint *)(param_1 + 0x34);
uVar5 = *(int *)(param_1 + 0x30) + uVar8;
if (uVar9 != 0) {
if ((*(byte *)(param_1 + 0x38) & 1) != 0) {
uVar9 = uVar9 - uVar5 % uVar9;
}
uVar5 = uVar5 + uVar9;
}
uVar5 = uVar5 + *(int *)(param_1 + 0x2c);
}
if ((uint)*(ushort *)(param_1 + 0xd8) < uVar5 + *(int *)(param_1 + 0x3c)) {
puVar7 = _Src + uVar2;
do {
puVar11 = puVar7 + (ulonglong)(byte)puVar7[3] +
(ulonglong)CONCAT11(puVar7[1],puVar7[2]) * 0x100 + 0xc;
if (_Src + (ulonglong)uVar8 + (ulonglong)uVar2 < puVar11) {
return 0x57;
}
iVar3 = FUN_18006fac0(param_1,puVar7,uVar1);
if (iVar3 != 0) {
return iVar3;
}
puVar7 = puVar11;
} while ((longlong)puVar11 - (longlong)(_Src + uVar2) < (longlong)(ulonglong)uVar8);
}
else {
uVar5 = uVar8 + uVar2;
puVar4 = FUN_1800729c0(*(longlong *)(param_1 + 0x240),uVar5);
if (puVar4 == (undefined8 *)0x0) {
return 8;
}
memcpy((void *)puVar4[1],_Src,(ulonglong)uVar5);
*(uint *)((longlong)puVar4 + 4) = uVar5;
}
uVar6 = (ulonglong)*(uint *)(param_2 + 4);
_Src = _Src + (uVar8 + uVar2);
} while ((longlong)_Src - *(longlong *)(param_2 + 8) < (longlong)uVar6);
}
return 0;
}
=========================================
Function at address: 0x18006fe4c
Called functions addresses: 0xEXTERNAL:0000011c


void FUN_18006fe4c(longlong param_1)

{
if ((*(char *)(param_1 + 0xe9) != '\0') && (*(char *)(param_1 + 0x108) != '\0')) {
if (*(longlong *)(param_1 + 0xf0) == 0) {
SslFreeObject(0,0);
}
*(undefined2 *)(param_1 + 0xea) = 0;
*(undefined8 *)(param_1 + 0xf0) = 0;
*(undefined8 *)(param_1 + 0xf8) = 0;
*(undefined8 *)(param_1 + 0x100) = 0;
*(undefined *)(param_1 + 0x108) = 0;
}
return;
}
=========================================
Function at address: 0x18006febc
Called functions addresses: 0x180007eb0


ulonglong FUN_18006febc(longlong param_1,int param_2,int param_3,undefined4 *param_4)

{
undefined8 *puVar1;
uint uVar2;
uint uVar3;
undefined8 *puVar4;
ulonglong uVar5;

uVar2 = DAT_180092324;
uVar5 = 0;
if (param_4 == (undefined4 *)0x0) {
uVar5 = 0x57;
}
else if ((*(uint *)(param_1 + 0x40) & 0x43c00) == 0) {
if (param_2 == 1) {
*param_4 = 0x24;
}
else if (param_2 - 2U < 2) {
*param_4 = 0x14;
}
else {
*param_4 = 0;
uVar5 = 0x57;
}
}
else {
*param_4 = 0;
if (uVar2 != 0) {
puVar4 = &DAT_180092330;
do {
puVar1 = (undefined8 *)*puVar4;
if ((puVar1 != (undefined8 *)0x0) && (*(int *)((longlong)puVar1 + 0x14) == param_3)) {
uVar5 = FUN_180007eb0(puVar1,(undefined8 *)0x0,param_4,param_4,(undefined4 *)0x0,
(undefined4 *)0x0);
return uVar5 & 0xffffffff;
}
uVar3 = (int)uVar5 + 1;
uVar5 = (ulonglong)uVar3;
puVar4 = puVar4 + 1;
} while (uVar3 < uVar2);
}
uVar5 = 0x490;
}
return uVar5;
}
=========================================
Function at address: 0x18006ff64
Called functions addresses: None


void FUN_18006ff64(longlong *param_1,longlong param_2)

{
uint uVar1;
undefined4 uVar2;

*param_1 = param_2;
if ((*(uint *)(param_2 + 0x40) & 0x40051555) == 0) {
*(undefined4 *)(param_1 + 1) = DAT_1800919f0;
}
else {
uVar2 = 0x100;
if ((*(uint *)(param_2 + 0x88) & 0x100) == 0) {
*(uint *)(param_1 + 1) = DAT_1800919ec;
goto LAB_18006ffb1;
}
uVar1 = DAT_1800919e8;
if (DAT_1800919e8 < DAT_1800919ec) {
uVar1 = DAT_1800919ec;
}
*(uint *)(param_1 + 1) = uVar1;
}
uVar2 = 0x600;
LAB_18006ffb1:
*(undefined4 *)((longlong)param_1 + 0xc) = uVar2;
uVar1 = *(uint *)(param_1 + 1);
if (0xffffff < uVar1) {
uVar1 = 0xffffff;
}
*(uint *)(param_1 + 1) = uVar1;
return;
}
=========================================
Function at address: 0x18006ffcc
Called functions addresses: 0x18002a77b 0xEXTERNAL:0000011c 0x180070568 0x180041cb0 0x180009470 0x180041e58 0x180009e8c 0xEXTERNAL:00000086


ulonglong FUN_18006ffcc(longlong *param_1,uint *param_2)

{
byte bVar1;
uint uVar2;
longlong *plVar3;
longlong lVar4;
code *pcVar5;
ulonglong uVar6;
ULONGLONG UVar7;
char cVar8;
uint uVar9;
longlong *plVar10;
uint uVar11;
int iVar12;
uint uVar13;

if ((*(byte *)(param_1 + 4) & 4) == 0) {
uVar11 = 0;
}
else {
uVar11 = *(uint *)((longlong)param_1 + 0x2c);
}
uVar2 = *(uint *)((longlong)param_1 + 0x3c);
plVar10 = (longlong *)(param_1[0x48] + 0x38);
plVar3 = (longlong *)*plVar10;
if (plVar3 != plVar10) {
if (((longlong *)plVar3[1] == plVar10) &&
(lVar4 = *plVar3, (longlong *)*(longlong *)(lVar4 + 8) == plVar3)) {
*plVar10 = lVar4;
*(longlong **)(lVar4 + 8) = plVar10;
if (plVar3 == (longlong *)0x28) goto LAB_180070219;
iVar12 = *(int *)((longlong)plVar3 + -0x24) - uVar2;
bVar1 = *(byte *)plVar3[-4];
if ((*(byte *)(param_1 + 4) & 4) != 0) {
uVar13 = iVar12 + *(int *)(param_1 + 6);
uVar9 = *(uint *)((longlong)param_1 + 0x34);
if (uVar9 != 0) {
if ((*(byte *)(param_1 + 7) & 1) != 0) {
uVar9 = uVar9 - uVar13 % uVar9;
}
uVar13 = uVar13 + uVar9;
}
iVar12 = uVar13 + *(int *)((longlong)param_1 + 0x2c);
}
uVar6 = FUN_180009e8c((longlong)param_1,param_2,iVar12 + *(int *)((longlong)param_1 + 0x3c));
if ((int)uVar6 != 0) {
return uVar6;
}
memcpy((void *)(*(longlong *)(param_2 + 2) + (ulonglong)uVar11 + (ulonglong)uVar2),
(void *)(plVar3[-4] + (ulonglong)uVar2),
(ulonglong)(*(int *)((longlong)plVar3 + -0x24) - uVar2));
param_2[1] = 0;
uVar6 = FUN_180009470(param_1,param_2,(uint)bVar1,*(int *)((longlong)plVar3 + -0x24) - uVar2);
if ((int)uVar6 != 0) {
return uVar6;
}
if (bVar1 == 0x14) {
uVar6 = FUN_180070568((longlong)param_1);
if ((int)uVar6 != 0) {
return uVar6;
}
*(ushort *)(param_1 + 4) = *(ushort *)(param_1 + 4) | 0xc;
cVar8 = *(char *)((longlong)param_1 + 0xe9);
if ((cVar8 == '\0') && (param_1[0x13] != 0)) {
SslFreeObject(param_1[0x13],0);
cVar8 = *(char *)((longlong)param_1 + 0xe9);
}
lVar4 = param_1[0x15];
param_1[0x15] = 0;
param_1[0x13] = lVar4;
if (cVar8 == '\0') {
param_1[0x17] = 0;
}
param_2 = (uint *)&DAT_180091000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x3b,&DAT_180082c58);
}
lVar4 = param_1[0x17];
param_1[0x17] = lVar4 + 0x1000000000000U & 0xffff000000000000;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x49,&DAT_180082c58,lVar4 + 0x1000000000000U >> 0x30);
}
}
*(undefined4 *)(plVar3 + -1) = 1;
lVar4 = param_1[0x48];
plVar10 = *(longlong **)(lVar4 + 0x50);
if (*plVar10 == lVar4 + 0x48) {
*plVar3 = lVar4 + 0x48;
plVar3[1] = (longlong)plVar10;
*plVar10 = (longlong)plVar3;
*(longlong **)(lVar4 + 0x50) = plVar3;
if (*(longlong **)(param_1[0x48] + 0x38) == (longlong *)(param_1[0x48] + 0x38)) {
UVar7 = GetTickCount64();
param_1[0x71] = UVar7;
return 0;
}
return 0x90364;
}
}
pcVar5 = (code *)swi(0x29);
(*pcVar5)(3);
}
LAB_180070219:
*param_2 = 0;
param_2[1] = 0;
return 0;
}
=========================================
Function at address: 0x180070244
Called functions addresses: 0x18002a77b 0x18000a1d0 0x1800432ec 0x18002a7c0


undefined8 FUN_180070244(longlong *param_1,uint param_2)

{
void *_Dst;
undefined8 uVar1;

if (param_2 <= *(uint *)((longlong)param_1 + 0xc)) {
param_2 = *(uint *)((longlong)param_1 + 0xc);
}
_Dst = (void *)FUN_18000a1d0(*param_1,param_2);
if (_Dst == (void *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],0x46,&DAT_180082c58,param_2);
}
uVar1 = 0xe;
}
else {
if (*(int *)((longlong)param_1 + 0x24) != 0) {
memcpy(_Dst,(void *)param_1[3],(ulonglong)*(uint *)((longlong)param_1 + 0x24));
}
if (param_1[3] != 0) {

}
*(uint *)(param_1 + 2) = param_2;
uVar1 = 0;
param_1[3] = (longlong)_Dst;
}
return uVar1;
}
=========================================
Function at address: 0x180070304
Called functions addresses: None


undefined8 FUN_180070304(longlong param_1)

{
if ((*(char *)(param_1 + 0xe9) != '\0') && (*(char *)(param_1 + 0x108) != '\0')) {
*(ushort *)(param_1 + 0x20) = *(ushort *)(param_1 + 0x20) & 2;
*(ushort *)(param_1 + 0x20) = *(ushort *)(param_1 + 0x20) | *(ushort *)(param_1 + 0xea);
*(undefined8 *)(param_1 + 0x98) = *(undefined8 *)(param_1 + 0xf0);
*(undefined8 *)(param_1 + 0xa8) = *(undefined8 *)(param_1 + 0xf8);
*(undefined8 *)(param_1 + 0xb8) = *(undefined8 *)(param_1 + 0x100);
*(undefined2 *)(param_1 + 0xea) = 0;
*(undefined8 *)(param_1 + 0xf0) = 0;
*(undefined8 *)(param_1 + 0xf8) = 0;
*(undefined8 *)(param_1 + 0x100) = 0;
*(undefined *)(param_1 + 0x108) = 0;
}
return 0;
}
=========================================
Function at address: 0x18007037c
Called functions addresses: 0x18002a77b 0x180070244 0x18004492c 0x180041cb0 0x18005b470


undefined8 FUN_18007037c(longlong *param_1,void *param_2,uint param_3,int param_4,uint *param_5)

{
int iVar1;
longlong lVar2;
uint uVar3;
undefined8 uVar4;
uint uVar5;
uint uVar6;

iVar1 = *(int *)(param_1 + 5);
*param_5 = 0;
uVar6 = (-(uint)(iVar1 != 0) & 8) + 4;
if (param_4 != 0) {
*(undefined4 *)((longlong)param_1 + 0x24) = 0;
*(uint *)(param_1 + 4) = uVar6;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x47,&DAT_180082c58);
}
}
if (*(uint *)((longlong)param_1 + 0x24) < uVar6) {
if ((*(uint *)(param_1 + 2) < uVar6) && (uVar4 = FUN_180070244(param_1,uVar6), (int)uVar4 != 0))
{
return uVar4;
}
uVar5 = *(uint *)((longlong)param_1 + 0x24);
uVar3 = uVar6 - uVar5;
if (param_3 < uVar3) {
uVar3 = param_3;
}
lVar2 = param_1[3];
*param_5 = uVar3;
memcpy((void *)((ulonglong)uVar5 + lVar2),param_2,(ulonglong)uVar3);
param_2 = (void *)((longlong)param_2 + (ulonglong)uVar3);
uVar5 = *(int *)((longlong)param_1 + 0x24) + uVar3;
*(uint *)((longlong)param_1 + 0x24) = uVar5;
param_3 = param_3 - uVar3;
if (param_3 == 0) {
return 0;
}
uVar3 = (-(uint)(*(int *)(param_1 + 5) != 0) & 8) + 4;
if ((uVar3 < *(uint *)(param_1 + 4)) && (*(uint *)(param_1 + 4) <= uVar5)) {
return 0;
}
if ((uVar3 <= uVar5) &&
(lVar2 = param_1[3],
(uint)*(byte *)(lVar2 + 2) * 0x100 + (uint)*(byte *)(lVar2 + 1) * 0x10000 +
(uint)*(byte *)(lVar2 + 3) == 0)) {
return 0;
}
}
if (*(uint *)(param_1 + 4) <= uVar6) {
lVar2 = param_1[3];
uVar6 = (uint)*(byte *)(lVar2 + 2) * 0x100 + (uint)*(byte *)(lVar2 + 1) * 0x10000 +
(uint)*(byte *)(lVar2 + 3);
if (*(uint *)(param_1 + 1) < uVar6) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_18004492c(DAT_180091000[2],0x48,&DAT_180082c58,uVar6,(char)*(uint *)(param_1 + 1));
}
FUN_18005b470((longlong *)*param_1,0xc,0x80090326,10);
return 0x80090326;
}
uVar6 = *(uint *)(param_1 + 4) + uVar6;
*(uint *)(param_1 + 4) = uVar6;
if ((*(uint *)(param_1 + 2) < uVar6) && (uVar4 = FUN_180070244(param_1,uVar6), (int)uVar4 != 0))
{
return uVar4;
}
}
uVar6 = *(int *)(param_1 + 4) - *(int *)((longlong)param_1 + 0x24);
if (param_3 <= uVar6) {
uVar6 = param_3;
}
if (uVar6 != 0) {
memcpy((void *)((ulonglong)*(uint *)((longlong)param_1 + 0x24) + param_1[3]),param_2,
(ulonglong)uVar6);
*(int *)((longlong)param_1 + 0x24) = *(int *)((longlong)param_1 + 0x24) + uVar6;
*param_5 = *param_5 + uVar6;
}
return 0;
}
=========================================
Function at address: 0x180070568
Called functions addresses: 0x18006fe4c


undefined8 FUN_180070568(longlong param_1)

{
if (*(char *)(param_1 + 0xe9) != '\0') {
if (*(char *)(param_1 + 0x108) != '\0') {
FUN_18006fe4c(param_1);
}
*(undefined2 *)(param_1 + 0xea) = *(undefined2 *)(param_1 + 0x20);
*(undefined8 *)(param_1 + 0xf0) = *(undefined8 *)(param_1 + 0x98);
*(undefined8 *)(param_1 + 0xf8) = *(undefined8 *)(param_1 + 0xa8);
*(undefined8 *)(param_1 + 0x100) = *(undefined8 *)(param_1 + 0xb8);
*(undefined *)(param_1 + 0x108) = 1;
}
return 0;
}
=========================================
Function at address: 0x1800705d4
Called functions addresses: 0x18002a7c0


undefined8 FUN_1800705d4(longlong *param_1,undefined2 param_2,undefined8 param_3,undefined param_4)

{
undefined2 *puVar1;

puVar1 = (undefined2 *)param_1[0x65];
if (puVar1 == (undefined2 *)0x0) {

param_1[0x65] = (longlong)puVar1;
if (puVar1 == (undefined2 *)0x0) {
return 0xe;
}
}
else if (*(longlong *)(puVar1 + 4) != 0) {

puVar1 = (undefined2 *)param_1[0x65];
}
*puVar1 = param_2;
*(undefined *)(param_1[0x65] + 2) = param_4;
*(undefined8 *)(param_1[0x65] + 8) = param_3;
return 0;
}
=========================================
Function at address: 0x180070690
Called functions addresses: 0x18002a7c0


undefined8
FUN_180070690(longlong *param_1,undefined param_2,undefined param_3,undefined8 param_4,
undefined2 param_5)

{
undefined *puVar1;

puVar1 = (undefined *)param_1[0x67];
if (puVar1 == (undefined *)0x0) {

param_1[0x67] = (longlong)puVar1;
if (puVar1 == (undefined *)0x0) {
return 0xe;
}
}
else if (*(longlong *)(puVar1 + 8) != 0) {

puVar1 = (undefined *)param_1[0x67];
}
*puVar1 = param_2;
*(undefined *)(param_1[0x67] + 1) = param_3;
*(undefined2 *)(param_1[0x67] + 2) = param_5;
*(undefined8 *)(param_1[0x67] + 8) = param_4;
return 0;
}
=========================================
Function at address: 0x18007075c
Called functions addresses: 0x18002a77b 0x18002a7c0


undefined4 FUN_18007075c(longlong *param_1,ushort *param_2)

{
ushort uVar1;
void *_Dst;

_Dst = (void *)0x0;
if (param_2 != (ushort *)0x0) {
uVar1 = *param_2;

if (_Dst == (void *)0x0) {
return 0xe;
}
memcpy(_Dst,param_2,(ulonglong)uVar1 + 2);
}
if (param_1[100] != 0) {

}
param_1[100] = (longlong)_Dst;
return 0;
}
=========================================
Function at address: 0x180070804
Called functions addresses: 0x180014b9c 0x18006ff64 0x18007037c 0x180041cb0 0x18000a1d0 0x18005b470 0x18002a7c0 0x18006f760 0x180011f40


ulonglong FUN_180070804(longlong *param_1,longlong param_2,longlong param_3)

{
longlong lVar1;
bool bVar2;
char cVar3;
int iVar4;
uint uVar5;
ulonglong uVar6;
longlong lVar7;
undefined4 extraout_var;
longlong *plVar8;
uint uVar9;
uint uVar10;
uint uVar11;
void *pvVar12;
uint local_res8 [2];


if (((cVar3 == '\0') && (param_2 != 0)) && (param_3 != 0)) {

if ((int)uVar6 == 0) {
lVar7 = FUN_18006f760((longlong)param_1);
if ((char)lVar7 == '\0') {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x2c,&DAT_180082c58);
}
LAB_1800708c1:
uVar6 = FUN_180011f40(param_1,param_3);
}
else {
pvVar12 = *(void **)(param_2 + 8);
if ((pvVar12 != (void *)0x0) && (uVar11 = *(uint *)(param_2 + 4), uVar11 != 0)) {
*(undefined4 *)(param_2 + 4) = 0;
if (((*(byte *)(param_1 + 4) & 2) == 0) ||
((param_1[1] == 0 || (bVar2 = true, *(int *)(param_1[1] + 0x1c) == 0)))) {
bVar2 = false;
}
while ((plVar8 = (longlong *)param_1[0x3a], plVar8 != (longlong *)0x0 &&
(*(int *)((longlong)plVar8 + 0x24) != 0))) {
local_res8[0] = 0;
uVar6 = FUN_18007037c(plVar8,pvVar12,uVar11,0,local_res8);
uVar10 = local_res8[0];
if ((int)uVar6 != 0) {
return uVar6;
}
if (uVar11 < local_res8[0]) {
return 0x80090304;
}
*(int *)(param_2 + 4) = *(int *)(param_2 + 4) + local_res8[0];
lVar7 = param_1[0x3a];
uVar5 = *(uint *)(lVar7 + 0x20);
uVar9 = (-(uint)(*(int *)(lVar7 + 0x28) != 0) & 8) + 4;
if (((uVar5 <= uVar9) || (*(uint *)(lVar7 + 0x24) < uVar5)) &&
((*(uint *)(lVar7 + 0x24) < uVar9 ||
(lVar1 = *(longlong *)(lVar7 + 0x18),
(uint)*(byte *)(lVar1 + 2) * 0x100 + (uint)*(byte *)(lVar1 + 1) * 0x10000 +
(uint)*(byte *)(lVar1 + 3) != 0)))) {
return 0;
}
iVar4 = FUN_180014b9c(param_1,*(undefined8 *)(lVar7 + 0x18),uVar5);
lVar7 = param_1[0x3a];
*(undefined4 *)(lVar7 + 0x24) = 0;
*(undefined4 *)(lVar7 + 0x20) = 0;
if (iVar4 != 0) {
return CONCAT44(extraout_var,iVar4);
}
uVar5 = 0;
LAB_180070a1e:
uVar11 = uVar11 - uVar10;
pvVar12 = (void *)((longlong)pvVar12 + (ulonglong)uVar10);
if (*(int *)((longlong)param_1 + 0x44) - 0x5bU < 0xc) goto LAB_1800708c1;
if (((*(int *)((longlong)param_1 + 0x44) == 4) ||
((((!bVar2 && ((*(byte *)(param_1 + 4) & 2) != 0)) && (param_1[1] != 0)) &&
(*(int *)(param_1[1] + 0x1c) != 0)))) || (uVar11 == 0)) goto LAB_180070a5a;
}
if (uVar11 < 4) {
*(int *)(param_2 + 4) = *(int *)(param_2 + 4) + uVar11;
plVar8 = (longlong *)param_1[0x3a];
if (plVar8 != (longlong *)0x0) goto LAB_180070c0f;
uVar10 = DAT_1800919f0;
if (((*(uint *)(param_1 + 8) & 0x40051555) != 0) &&
(uVar10 = DAT_1800919ec, (*(uint *)(param_1 + 0x11) & 0x100) != 0)) {
uVar5 = DAT_1800919e8;
if (DAT_1800919e8 < DAT_1800919ec) {
uVar5 = DAT_1800919ec;
}
if (uVar5 == 0) goto LAB_180070b63;
}
if (uVar10 == 0) {
LAB_180070b63:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x43,&DAT_180082c58);
}
FUN_18005b470(param_1,0xc,0x80090326,10);
return 0x80090326;
}
plVar8 = (longlong *)FUN_18000a1d0((longlong)param_1,0x30);
}
else {
iVar4 = (uint)*(byte *)((longlong)pvVar12 + 2) * 0x100 +
(uint)*(byte *)((longlong)pvVar12 + 1) * 0x10000 +
(uint)*(byte *)((longlong)pvVar12 + 3);
if (iVar4 + 4U <= uVar11) {
uVar10 = iVar4 + 4;
uVar5 = FUN_180014b9c(param_1,pvVar12,uVar10);
if (uVar5 == 0) {
*(int *)(param_2 + 4) = *(int *)(param_2 + 4) + uVar10;
goto LAB_180070a1e;
}
LAB_180070a5a:
return (ulonglong)uVar5;
}
*(int *)(param_2 + 4) = *(int *)(param_2 + 4) + uVar11;
plVar8 = (longlong *)param_1[0x3a];
if (plVar8 != (longlong *)0x0) goto LAB_180070c0f;
uVar10 = DAT_1800919f0;
if (((*(uint *)(param_1 + 8) & 0x40051555) != 0) &&
(uVar10 = DAT_1800919ec, (*(uint *)(param_1 + 0x11) & 0x100) != 0)) {
uVar5 = DAT_1800919e8;
if (DAT_1800919e8 < DAT_1800919ec) {
uVar5 = DAT_1800919ec;
}
if (uVar5 == 0) goto LAB_180070b63;
}
if (uVar10 == 0) goto LAB_180070b63;
plVar8 = (longlong *)FUN_18000a1d0((longlong)param_1,0x30);
}
if (plVar8 == (longlong *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x44,&DAT_180082c58);
}
return 0xe;
}
*plVar8 = 0;
*(undefined8 *)((longlong)plVar8 + 0xc) = 0x100;
plVar8[3] = 0;
plVar8[4] = 0;
param_1[0x3a] = (longlong)plVar8;
FUN_18006ff64(plVar8,(longlong)param_1);
plVar8 = (longlong *)param_1[0x3a];
LAB_180070c0f:
local_res8[0] = 0;
uVar6 = FUN_18007037c(plVar8,pvVar12,uVar11,1,local_res8);
return uVar6 & 0xffffffff;
}
uVar6 = 0x80090308;
}
}
}
else {
uVar6 = 0x8009035d;
}
return uVar6;
}
=========================================
Function at address: 0x180070c68
Called functions addresses: 0x180041cb0


undefined4 FUN_180070c68(short *param_1,ushort param_2,int param_3)

{
undefined2 uVar1;
short *psVar2;

if (param_1 == (short *)0x0) {
return 0x57;
}
if (((param_2 < 2) || ((param_2 & 1) != 0)) || (0xfffd < param_2)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar1 = 0x51;
}
else if ((param_3 == 0) && (param_2 != 2)) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar1 = 0x52;
}
else {
psVar2 = (short *)(((ulonglong)param_2 & 0xfffffffffffffffe) + (longlong)param_1);
while( true ) {
if (psVar2 <= param_1) {
return 0;
}
if (*param_1 == 0) break;
param_1 = param_1 + 1;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0x80090326;
}
uVar1 = 0x53;
}
FUN_180041cb0(DAT_180091000[2],uVar1,&DAT_180082c58);
return 0x80090326;
}
=========================================
Function at address: 0x180070d50
Called functions addresses: 0x180041cdc 0x180071fc4 0xEXTERNAL:00000108


int FUN_180070d50(longlong *param_1,longlong param_2,undefined8 param_3,undefined8 param_4,
uint *param_5,NCRYPT_KEY_HANDLE *param_6)

{
uint uVar1;
undefined4 *puVar2;
int iVar3;
ulonglong uVar4;
uint uVar5;
NCRYPT_KEY_HANDLE local_res10;

local_res10 = 0;
uVar5 = 0;
if (((param_2 == 0) || (param_5 == (uint *)0x0)) || (param_6 == (NCRYPT_KEY_HANDLE *)0x0)) {
return 0x57;
}
puVar2 = *(undefined4 **)(param_2 + 8);
uVar1 = *(uint *)(param_2 + 4);
if ((*(uint *)(param_1 + 0x7a) != 0) && ((PUCHAR)param_1[0x79] != (PUCHAR)0x0)) {
iVar3 = FUN_180071fc4(param_1,(PUCHAR)param_1[0x79],*(uint *)(param_1 + 0x7a),*param_6,
&local_res10);
if (iVar3 != 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return iVar3;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180085918,iVar3);
return iVar3;
}
return iVar3;
}
NCryptFreeObject(*param_6);
*param_6 = local_res10;
}
if ((*(uint *)(param_1 + 0x11) >> 0x1b & 1) == 0) {
uVar5 = 2;
if (uVar1 < 2) {
return 0x57;
}
puVar2[1] = 0x14;
*(longlong **)(puVar2 + 2) = param_1 + 0x22;
*puVar2 = 0x20;
*(longlong **)(puVar2 + 6) = param_1 + 0x26;
puVar2[5] = 0x15;
puVar2[4] = 0x20;
}
if (uVar1 < uVar5 + 1) {
return 0x57;
}
if (*(char *)((longlong)param_1 + 0xe9) == '\0') {
if (*param_5 < 0x304) goto LAB_180070e9e;
}
else if (0xfefc < *param_5) goto LAB_180070e9e;
*param_5 = (-(uint)(*(char *)((longlong)param_1 + 0xe9) != '\0') & 0xfbfa) + 0x303;
LAB_180070e9e:
uVar4 = (ulonglong)uVar5;
puVar2[uVar4 * 4 + 1] = 0x16;
puVar2[uVar4 * 4] = 4;
*(uint **)(puVar2 + uVar4 * 4 + 2) = param_5;
*(uint *)(param_2 + 4) = uVar5 + 1;
return 0;
}
=========================================
Function at address: 0x180070ee8
Called functions addresses: 0xEXTERNAL:00000118 0xEXTERNAL:000000fe


undefined8 FUN_180070ee8(undefined8 param_1,undefined4 *param_2)

{
undefined8 uVar1;
undefined local_res18 [8];
undefined4 *local_res20;

local_res20 = (undefined4 *)0x0;
uVar1 = SslGetKeyProperty(param_1,L"Block Length",&local_res20,local_res18,0);
if ((int)uVar1 == 0) {
*param_2 = *local_res20;
SslFreeBuffer();
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x180071978
Called functions addresses: 0xEXTERNAL:000000f0 0x18005b354 0xEXTERNAL:0000011c 0x180028070 0xEXTERNAL:000000c0 0xEXTERNAL:0000018b 0x180041cdc 0xEXTERNAL:00000047 0x180001060 0x180028d90 0x180041cb0 0x18005b470 0xEXTERNAL:000000bc 0x18002a7c0


void FUN_180071978(longlong *param_1,undefined *param_2,uint param_3)

{
int iVar1;
undefined8 uVar2;
undefined8 *puVar3;
undefined4 uVar4;
longlong lVar5;
undefined auStack_158 [32];
undefined *local_138;
int *local_130;
undefined *local_128;
uint local_120;
undefined4 local_118;
int local_108 [4];
undefined8 local_f8;
longlong local_f0;
int local_e8 [2];
undefined *local_e0;
undefined local_d8 [80];
undefined local_88 [64];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStack_158;
local_f8 = 0;
local_108[0] = 0;
memset(local_88,0,0x40);
local_108[2] = 0;
local_108[1] = 0x40;

lVar5 = param_1[0xe];
if (lVar5 == 0) {
uVar2 = FUN_18005b354((longlong)param_1,local_108);
if (((int)uVar2 != 0) || (param_1[3] == 0)) goto LAB_180071c0f;
lVar5 = *(longlong *)(param_1[3] + 8);
}
if (1 < param_3) {
if (((*(uint *)(param_1 + 8) & 0x51550) != 0) && (CONCAT11(*param_2,param_2[1]) + 2 == param_3))
{
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180085918);
}
param_2 = param_2 + 2;
param_3 = param_3 - 2;
}
local_e8[0] = 0;
local_e0 = local_d8;
local_e8[1] = 5;
local_130 = local_108 + 1;
local_138 = local_88;

if (iVar1 == 0) {
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(puVar3 = (undefined8 *)param_1[1], puVar3 == (undefined8 *)0x0)) {
puVar3 = (undefined8 *)param_1[1];
uVar4 = 0;
}
else {
uVar4 = *(undefined4 *)((longlong)puVar3 + 0x1c);
}
if (puVar3 == (undefined8 *)0x0) {
uVar2 = 0;
}
else {
uVar2 = *puVar3;
}
local_118 = 2;
local_130 = local_e8;
local_138 = (undefined *)CONCAT44(local_138._4_4_,uVar4);
local_128 = param_2;
local_120 = param_3;
iVar1 = SslImportMasterKey(uVar2,lVar5,&local_f8,*(undefined2 *)((longlong)param_1 + 0x22));
if (iVar1 == 0) {
RtlAcquireResourceExclusive(local_f0 + 0x48,1);
*(undefined8 *)(local_f0 + 0x10) = local_f8;
if (param_1[0xe] != 0) {
SslFreeObject(param_1[0xe],0);
param_1[0xe] = 0;
}
iVar1 = FUN_180001060(param_1,local_f8);
RtlReleaseResource(local_f0 + 0x48);
if (iVar1 == 0) {
LsaIModifyPerformanceCounter(8,0,0);
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_180085918,iVar1);
}
goto LAB_180071c0f;
}
uVar4 = 0x2bd;
}
else {
uVar4 = 0x2c3;
}
FUN_18005b470(param_1,uVar4,iVar1,0x33);
}
LAB_180071c0f:
if (local_108[0] != 0) {
RevertToSelf();
}
FUN_180028070(local_48 ^ (ulonglong)auStack_158);
return;
}
=========================================
Function at address: 0x180071c4c
Called functions addresses: 0xEXTERNAL:000000f0 0x18005b354 0xEXTERNAL:0000011c 0x180070ee8 0x180028070 0xEXTERNAL:000000c0 0xEXTERNAL:0000018b 0x180041cdc 0xEXTERNAL:00000047 0x180001060 0x180028d90 0x180041cb0 0x18005b470 0xEXTERNAL:000000bc 0x18002a7c0


void FUN_180071c4c(longlong *param_1,undefined *param_2,uint param_3)

{
int iVar1;
undefined8 uVar2;
undefined8 *puVar3;
undefined4 uVar4;
uint uVar5;
undefined uVar6;
longlong lVar7;
undefined auStack_158 [32];
undefined *local_138;
int *local_130;
undefined *local_128;
uint local_120;
undefined4 local_118;
longlong local_108;
int local_100;
int local_fc [3];
undefined8 local_f0;
int local_e8 [2];
undefined *local_e0;
undefined local_d8 [80];
undefined local_88 [64];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStack_158;
local_f0 = 0;
local_100 = 0;
memset(local_88,0,0x40);
local_fc[2] = 0;
local_fc[1] = 0x40;

lVar7 = param_1[0xe];
if (lVar7 == 0) {
uVar2 = FUN_18005b354((longlong)param_1,&local_100);
if (((int)uVar2 != 0) || (param_1[3] == 0)) goto LAB_180071f87;
lVar7 = *(longlong *)(param_1[3] + 8);
}
uVar2 = FUN_180070ee8(lVar7,local_fc);
if ((int)uVar2 == 0) {
RtlAcquireResourceExclusive(local_108 + 0x48,1);
*(int *)(local_108 + 8) = local_fc[0] * 8;
uVar5 = local_fc[0] * 8 + 7U >> 3;
if (param_3 < 2) {
RtlReleaseResource(local_108 + 0x48);
}
else {
if ((((*(uint *)(param_1 + 8) & 0x51550) != 0) && (CONCAT11(*param_2,param_2[1]) == uVar5)) &&
(CONCAT11(*param_2,param_2[1]) + 2 == param_3)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xe,&DAT_180085918);
}
param_2 = param_2 + 2;
param_3 = param_3 - 2;
}
if (param_3 < uVar5) {
RtlReleaseResource(local_108 + 0x48);
uVar6 = 0x32;
uVar4 = 700;
iVar1 = -0x7ff6fcf8;
}
else {
local_e8[0] = 0;
local_e0 = local_d8;
local_e8[1] = 5;
local_130 = local_fc + 1;
local_138 = local_88;

if (iVar1 == 0) {
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(puVar3 = (undefined8 *)param_1[1], puVar3 == (undefined8 *)0x0)) {
puVar3 = (undefined8 *)param_1[1];
uVar4 = 0;
}
else {
uVar4 = *(undefined4 *)((longlong)puVar3 + 0x1c);
}
if (puVar3 == (undefined8 *)0x0) {
uVar2 = 0;
}
else {
uVar2 = *puVar3;
}
local_118 = 2;
local_130 = local_e8;
local_138 = (undefined *)CONCAT44(local_138._4_4_,uVar4);
local_128 = param_2;
local_120 = param_3;
iVar1 = SslImportMasterKey(uVar2,lVar7,&local_f0,*(undefined2 *)((longlong)param_1 + 0x22)
);
if (iVar1 == 0) {
*(undefined8 *)(local_108 + 0x10) = local_f0;
if (param_1[0xe] != 0) {
SslFreeObject(param_1[0xe],0);
param_1[0xe] = 0;
}
iVar1 = FUN_180001060(param_1,local_f0);
RtlReleaseResource(local_108 + 0x48);
if (iVar1 == 0) {
LsaIModifyPerformanceCounter(8,0,0);
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xf,&DAT_180085918,iVar1);
}
goto LAB_180071f87;
}
RtlReleaseResource(local_108 + 0x48);
uVar6 = 0x33;
uVar4 = 0x2bd;
}
else {
RtlReleaseResource(local_108 + 0x48);
uVar6 = 0x33;
uVar4 = 0x2c3;
}
}
FUN_18005b470(param_1,uVar4,iVar1,uVar6);
}
}
LAB_180071f87:
if (local_100 != 0) {
RevertToSelf();
}
FUN_180028070(local_48 ^ (ulonglong)auStack_158);
return;
}
=========================================
Function at address: 0x180071fc4
Called functions addresses: 0x18005b660 0x180053714 0xEXTERNAL:000000f1 0x180041cb0 0x18002a700 0x18000a418 0xEXTERNAL:00000121 0x18005b470 0x180028070 0x18002a7c0


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_180071fc4(longlong *param_1,PUCHAR param_2,uint param_3,NCRYPT_KEY_HANDLE param_4,
undefined8 *param_5)

{
PUCHAR pUVar1;
UCHAR UVar2;
longlong lVar3;
undefined8 *puVar4;
uint uVar5;
uint uVar6;
int iVar7;
SECURITY_STATUS SVar8;
undefined8 uVar9;
undefined4 *puVar10;
uint uVar11;
ulonglong uVar12;
ulonglong uVar13;
undefined4 uVar14;
PUCHAR pUVar15;
uint uVar16;
undefined *puVar17;
undefined *puVar18;
ulonglong uVar19;
undefined uVar20;
DWORD cbSignature;
undefined auStackY_d8 [32];
uint local_98 [2];
undefined8 local_90;
NCRYPT_KEY_HANDLE local_88;
PUCHAR local_80;
undefined8 *local_78;
UCHAR local_70 [40];
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)local_98;
uVar13 = 0;
uVar5 = 0;
local_78 = param_5;
local_90 = 0;
local_88 = param_4;
if (param_2 == (PUCHAR)0x0) {
*param_5 = 0;
puVar18 = auStackY_d8;
goto LAB_18007234b;
}
if (param_3 < 3) {
uVar20 = 0x32;
}
else {
UVar2 = param_2[2];
local_98[0] = CONCAT11(*param_2,param_2[1]) - 1;
if (UVar2 != '\0') {
local_98[0] = (uint)CONCAT11(*param_2,param_2[1]);
}
local_80 = param_2 + 3;
if (UVar2 != '\0') {
local_80 = param_2 + 2;
}
uVar16 = (3 - (uint)(UVar2 != '\0')) + local_98[0];
if ((local_98[0] - 0x40 < 0x41) && (uVar16 <= param_3)) {
uVar16 = uVar16 + 2;
pUVar15 = local_80 + local_98[0];
if (uVar16 <= param_3) {
uVar11 = (uint)CONCAT11(*pUVar15,pUVar15[1]);
uVar16 = uVar16 + uVar11;
if ((uVar11 - 1 < 4) && (uVar16 <= param_3)) {
uVar19 = (ulonglong)uVar11;
pUVar1 = pUVar15 + uVar11;
uVar6 = 0;
uVar12 = uVar13;
if (uVar11 == 0) {
LAB_18007211c:
uVar6 = local_98[0] * 8;
}
else {
do {
lVar3 = uVar13 + 2;
uVar13 = uVar13 + 1;
uVar5 = (uint)pUVar15[lVar3] | (int)uVar12 << 8;
uVar19 = uVar19 - 1;
uVar12 = (ulonglong)uVar5;
} while (uVar19 != 0);
if (uVar5 != 1) goto LAB_18007211c;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x10,&DAT_180085918);
}
puVar18 = auStackY_d8;
if (DAT_180092f1c == 0) goto LAB_18007234b;
}
if (uVar6 < *(uint *)(param_1[0xa5] + 8)) {
*(uint *)(param_1[0xa5] + 8) = uVar6;
}
uVar16 = uVar16 + 2;
if ((uVar16 <= param_3) &&
(cbSignature = (uint)pUVar1[2] * 0x100 + (uint)pUVar1[3],
cbSignature + uVar16 <= param_3)) {
iVar7 = FUN_18005b660((longlong)param_1,param_2,((int)pUVar1 + 2) - (int)param_2,
local_70);
if (iVar7 == 0) {
iVar7 = NCryptVerifySignature
(local_88,&local_90,local_70,0x24,pUVar1 + 4,cbSignature,2);
uVar16 = local_98[0];
if (iVar7 == 0) {
uVar11 = local_98[0] + 0x14;
puVar10 = (undefined4 *)0x0;
puVar17 = auStackY_d8;
if ((((uVar11 == 0) ||
(uVar13 = (ulonglong)uVar11, puVar17 = auStackY_d8, DAT_1800920e0 < uVar13)) ||
(uVar12 = DAT_1800920e8 + 8 + uVar13, puVar10 = (undefined4 *)0x0,
puVar17 = auStackY_d8, uVar12 < uVar13)) ||
(uVar9 = FUN_18000a418(uVar12), puVar17 = auStackY_d8, (int)uVar9 == 0)) {
LAB_18007224c:
puVar18 = puVar17;
if (uVar11 <= uVar16 + 0x1c) {
*(undefined8 *)(puVar17 + -8) = 0x18007226c;
puVar10 = (undefined4 *)

if (puVar10 == (undefined4 *)0x0) goto LAB_18007234b;
*puVar10 = 0x70616548;
puVar10 = puVar10 + 2;
}
if (puVar10 == (undefined4 *)0x0) goto LAB_18007234b;
}
else {
uVar13 = (ulonglong)(uVar16 + 0x1c) + 0xf;
if (uVar13 <= uVar16 + 0x1c) {
uVar13 = 0xffffffffffffff0;
}
lVar3 = -(uVar13 & 0xfffffffffffffff0);
puVar10 = (undefined4 *)((longlong)local_98 + lVar3);
puVar17 = auStackY_d8 + lVar3;
if (puVar10 == (undefined4 *)0x0) goto LAB_18007224c;
*puVar10 = 0x6b637453;
puVar10 = (undefined4 *)((longlong)&local_90 + lVar3);
puVar17 = auStackY_d8 + lVar3;
puVar18 = auStackY_d8 + lVar3;
if (puVar10 == (undefined4 *)0x0) goto LAB_18007224c;
}
pUVar15 = local_80;
puVar10[3] = uVar16 * 8;
*puVar10 = 0x206;
puVar10[1] = 0xa400;
puVar10[2] = 0x31415352;
puVar10[4] = uVar5;
*(undefined8 *)(puVar18 + -8) = 0x1800722bd;
FUN_180053714((undefined *)(puVar10 + 5),pUVar15,(ulonglong)uVar16);
puVar4 = local_78;
*(undefined4 *)(puVar18 + 0x38) = 0;
*(uint *)(puVar18 + 0x30) = uVar11;
*(undefined4 **)(puVar18 + 0x28) = puVar10;
*(undefined8 **)(puVar18 + 0x20) = puVar4;
*(undefined8 *)(puVar18 + -8) = 0x1800722ee;
SVar8 = NCryptImportKey(DAT_1800925a8,0,L"CAPIPUBLICBLOB",(NCryptBufferDesc *)0x0,
*(NCRYPT_KEY_HANDLE **)(puVar18 + 0x20),
*(PBYTE *)(puVar18 + 0x28),*(DWORD *)(puVar18 + 0x30),
*(DWORD *)(puVar18 + 0x38));
if (SVar8 != 0) {
*(undefined8 *)(puVar18 + -8) = 0x18007230c;
FUN_18005b470(param_1,0x331,SVar8,0x33);
}
if (puVar10[-2] == 0x70616548) {
*(undefined8 *)(puVar18 + -8) = 0x18007232d;

}
goto LAB_18007234b;
}
uVar20 = 0x33;
uVar14 = 0x330;
}
else {
uVar20 = 0x50;
uVar14 = 0x32f;
}
FUN_18005b470(param_1,uVar14,iVar7,uVar20);
puVar18 = auStackY_d8;
goto LAB_18007234b;
}
}
}
}
uVar20 = 0x2f;
}
FUN_18005b470(param_1,0x32b,0x80090308,uVar20);
puVar18 = auStackY_d8;
LAB_18007234b:
uVar13 = local_48 ^ (ulonglong)local_98;
*(undefined8 *)(puVar18 + -8) = 0x180072357;
FUN_180028070(uVar13);
return;
}
=========================================
Function at address: 0x180072378
Called functions addresses: 0xEXTERNAL:00000103 0xEXTERNAL:00000102 0x180054f60 0xEXTERNAL:0000011c 0x1800432ec 0x180028070 0xEXTERNAL:000000c0 0xEXTERNAL:00000108 0xEXTERNAL:0000018b 0x180001060 0x180059d38 0x180028d90 0xEXTERNAL:00000121 0x18005b470 0xEXTERNAL:000000bc 0x18002a7c0


undefined8 FUN_180072378(longlong *param_1,undefined *param_2,uint *param_3)

{
PBYTE pbData;
int iVar1;
undefined4 *puVar2;
undefined8 *puVar3;
ulonglong uVar4;
undefined8 uVar5;
uint uVar6;
undefined4 uVar7;
NCRYPT_KEY_HANDLE NVar8;
undefined uVar9;
DWORD cbData;
undefined8 uVar10;
longlong *plVar11;
_EVENT_DATA_DESCRIPTOR **pp_Var12;
uint uVar13;
bool bVar14;
undefined auStackY_138 [8];
undefined8 uStackY_130;
undefined auStackY_128 [16];
uint local_d8;
longlong local_d0;
NCRYPT_KEY_HANDLE local_c8;
longlong local_c0;
NCRYPT_KEY_HANDLE local_b8;
longlong local_b0;
undefined8 local_a8;
_EVENT_DATA_DESCRIPTOR *p_Stack_a0;
undefined local_98 [8];
undefined *puStack_90;
_EVENT_DATA_DESCRIPTOR local_88;
undefined local_78 [48];
ulonglong local_48;

if (*(int *)(param_1[1] + 0x34) == 2) {
local_48 = DAT_180091970 ^ (ulonglong)auStackY_138;
local_b8 = CONCAT44(local_b8._4_4_,*(undefined4 *)((longlong)param_1 + 0x24));
local_c8 = 0;
local_b0 = 0;
local_c0 = 0;
local_d0 = 0;
local_a8 = 0;
p_Stack_a0 = (_EVENT_DATA_DESCRIPTOR *)0x0;
memset(&local_88,0,0x40);
uVar13 = *(uint *)(param_1 + 8) & 0xa2a80;

RtlAcquireResourceExclusive(local_d0 + 0x48,1);
puVar3 = *(undefined8 **)(local_d0 + 0x28);
if ((puVar3 == (undefined8 *)0x0) || (pbData = (PBYTE)*puVar3, pbData == (PBYTE)0x0)) {
RtlReleaseResource(local_d0 + 0x48);
uVar7 = 0x32c;
iVar1 = 0x54f;
LAB_18007145a:
uVar9 = 0x50;
goto LAB_180071460;
}
cbData = *(DWORD *)(puVar3 + 1);
local_d8 = cbData;
if (uVar13 != 0) {
local_d8 = cbData + 2;
}
if (param_2 == (undefined *)0x0) {
RtlReleaseResource(local_d0 + 0x48);
*param_3 = local_d8;
goto LAB_180071468;
}
if (*param_3 < local_d8) {
RtlReleaseResource(local_d0 + 0x48);
*param_3 = local_d8;
goto LAB_180071468;
}
if (*(int *)(pbData + 0x10) == 1) {
bVar14 = DAT_180092f1c == 0;
*(undefined4 *)(local_d0 + 8) = 0;
if (bVar14) {
RtlReleaseResource(local_d0 + 0x48);
goto LAB_180071468;
}
LAB_1800710c8:
iVar1 = NCryptImportKey(DAT_1800925a8,0,L"CAPIPUBLICBLOB",(NCryptBufferDesc *)0x0,&local_c8,
pbData,cbData,0);
if (iVar1 != 0) {
RtlReleaseResource(local_d0 + 0x48);
uVar7 = 0x32d;
goto LAB_18007145a;
}
p_Stack_a0 = &local_88;
local_a8 = CONCAT44(4,(undefined4)local_a8);
uVar10 = 0;
uVar5 = 0;

if (iVar1 == 0) {
if (*(longlong *)(local_d0 + 0x10) != 0) {
SslFreeObject(*(longlong *)(local_d0 + 0x10));
*(undefined8 *)(local_d0 + 0x10) = 0;
}
if ((uVar13 == 0) || ((*(uint *)(param_1 + 0x11) >> 0x1b & 1) == 0)) {
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(local_d0,(PCEVENT_DESCRIPTOR)&DAT_180084bf0,uVar5,uVar10,
(PEVENT_DATA_DESCRIPTOR)local_98);
}
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(puVar3 = (undefined8 *)param_1[1], puVar3 == (undefined8 *)0x0)) {
puVar3 = (undefined8 *)param_1[1];
}
if (puVar3 == (undefined8 *)0x0) {
uVar5 = 0;
}
else {
uVar5 = *puVar3;
}
plVar11 = &local_b0;
NVar8 = local_c8;
iVar1 = SslGenerateMasterKey(uVar5,0);
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084be0,NVar8,plVar11,
(PEVENT_DATA_DESCRIPTOR)local_98);
}
if (iVar1 == 0) {
*(longlong *)(local_d0 + 0x10) = local_b0;
iVar1 = FUN_180001060(param_1,local_b0);
RtlReleaseResource(local_d0 + 0x48);
if (iVar1 != 0) goto LAB_180071468;
if (uVar13 != 0) goto LAB_1800713b7;
goto LAB_1800713cf;
}
RtlReleaseResource(local_d0 + 0x48);
uVar9 = 0x33;
uVar7 = 0x2c2;
}
else {
RtlReleaseResource(local_d0 + 0x48);
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(puVar3 = (undefined8 *)param_1[1], puVar3 == (undefined8 *)0x0)) {
puVar3 = (undefined8 *)param_1[1];
}
if (puVar3 == (undefined8 *)0x0) {
uVar5 = 0;
}
else {
uVar5 = *puVar3;
}
iVar1 = SslGeneratePreMasterKey
(uVar5,local_c8,&local_c0,*(undefined2 *)((longlong)param_1 + 0x22));
if (iVar1 == 0) {

local_c0 = 0;
LAB_1800713b7:
*param_2 = (char)(local_d8 >> 8);
param_2[1] = (char)local_d8;
LAB_1800713cf:
*param_3 = (-(uint)(uVar13 != 0) & 2) + local_d8;
LsaIModifyPerformanceCounter(6,0,0);
goto LAB_180071468;
}
uVar9 = 0x33;
uVar7 = 0x2c4;
}
}
else {
RtlReleaseResource(local_d0 + 0x48);
uVar9 = 0x33;
uVar7 = 0x32e;
}
}
else {
*(undefined4 *)(local_d0 + 8) = *(undefined4 *)(pbData + 0xc);
puVar2 = FUN_180059d38(0xa400);
if (((uint)puVar2[8] <= *(uint *)(pbData + 0xc)) &&
(*(uint *)(pbData + 0xc) <= (uint)puVar2[10])) goto LAB_1800710c8;
RtlReleaseResource(local_d0 + 0x48);
iVar1 = 0x57;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],0xb,&DAT_180085918,*(undefined4 *)(pbData + 0xc));
}
uVar9 = 0x28;
uVar7 = 0x32d;
}
LAB_180071460:
FUN_18005b470(param_1,uVar7,iVar1,uVar9);
LAB_180071468:
if (local_c8 != 0) {
NCryptFreeObject(local_c8);
}
if (local_c0 != 0) {
SslFreeObject(local_c0,0);
}
uVar5 = FUN_180028070(local_48 ^ (ulonglong)auStackY_138);
return uVar5;
}
if (*(int *)(param_1[1] + 0x34) != 4) {
return 0x80090308;
}
uVar4 = DAT_180091970 ^ (ulonglong)auStackY_128;
local_b8 = 0;
p_Stack_a0 = (_EVENT_DATA_DESCRIPTOR *)0x0;
local_b0 = 0;
local_c0 = 0;
local_c8 = local_c8 & 0xffffffff00000000;
local_a8 = CONCAT44(local_a8._4_4_,*(undefined4 *)((longlong)param_1 + 0x24));
local_98 = (undefined  [8])0x0;
puStack_90 = (undefined *)0x0;
uStackY_130 = 0x180071527;
memset(local_78,0,0x40);
uVar13 = *(uint *)(param_1 + 8) & 0xa2a80;
uStackY_130 = 0x180071553;

uStackY_130 = 0x180071564;
RtlAcquireResourceExclusive(local_c0 + 0x48,1);
plVar11 = *(longlong **)(local_c0 + 0x28);
if ((plVar11 == (longlong *)0x0) || (*plVar11 == 0)) {
uStackY_130 = 0x180071903;
RtlReleaseResource(local_c0 + 0x48);
uVar7 = 0x339;
iVar1 = 0x54f;
LAB_180071912:
uVar9 = 0x50;
}
else {
uStackY_130 = 0x1800715c2;
iVar1 = NCryptImportKey(*(NCRYPT_PROV_HANDLE *)(param_1[1] + 0x40),0,L"ECCPUBLICBLOB",
(NCryptBufferDesc *)0x0,&local_b8,(PBYTE)(*plVar11 + 8),
*(int *)(plVar11 + 1) - 8,0);
if (iVar1 != 0) {
uStackY_130 = 0x1800715dc;
RtlReleaseResource(local_c0 + 0x48);
uVar7 = 0x32d;
goto LAB_180071912;
}
puStack_90 = local_78;
local_98._4_4_ = 4;
uVar10 = 0;
uVar5 = 0;
uStackY_130 = 0x180071633;

if (iVar1 == 0) {
if (*(longlong *)(local_c0 + 0x10) != 0) {
uStackY_130 = 0x18007166f;
SslFreeObject(*(longlong *)(local_c0 + 0x10));
*(undefined8 *)(local_c0 + 0x10) = 0;
}
if ((uVar13 == 0) || ((*(uint *)(param_1 + 0x11) >> 0x1b & 1) == 0)) {
if (((byte)DAT_180092f00 & 1) != 0) {
uStackY_130 = 0x18007179a;
FUN_180054f60(local_c0,(PCEVENT_DESCRIPTOR)&DAT_180084bf0,uVar5,uVar10,&local_88);
}
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(puVar3 = (undefined8 *)param_1[1], puVar3 == (undefined8 *)0x0)) {
puVar3 = (undefined8 *)param_1[1];
}
if (puVar3 == (undefined8 *)0x0) {
uVar5 = 0;
}
else {
uVar5 = *puVar3;
}
pp_Var12 = &p_Stack_a0;
uStackY_130 = 0x18007181e;
NVar8 = local_b8;
iVar1 = SslGenerateMasterKey(uVar5,0);
if (((byte)DAT_180092f00 & 1) != 0) {
uStackY_130 = 0x180071843;
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084be0,NVar8,pp_Var12,&local_88);
}
if (iVar1 == 0) {
*(_EVENT_DATA_DESCRIPTOR **)(local_c0 + 0x10) = p_Stack_a0;
uStackY_130 = 0x180071880;
iVar1 = FUN_180001060(param_1,p_Stack_a0);
uStackY_130 = 0x180071891;
RtlReleaseResource(local_c0 + 0x48);
if (iVar1 != 0) goto LAB_180071920;
if (uVar13 != 0) goto LAB_1800718a3;
uVar6 = (uint)local_c8;
goto LAB_1800718b1;
}
uStackY_130 = 0x180071856;
RtlReleaseResource(local_c0 + 0x48);
uVar9 = 0x33;
uVar7 = 0x2c2;
}
else {
uStackY_130 = 0x1800716b2;
RtlReleaseResource();
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(puVar3 = (undefined8 *)param_1[1], puVar3 == (undefined8 *)0x0)) {
puVar3 = (undefined8 *)param_1[1];
}
if (puVar3 == (undefined8 *)0x0) {
uVar5 = 0;
}
else {
uVar5 = *puVar3;
}
uStackY_130 = 0x180071734;
iVar1 = SslGeneratePreMasterKey
(uVar5,local_b8,&local_b0,*(undefined2 *)((longlong)param_1 + 0x22));
if (iVar1 == 0) {
uStackY_130 = 0x180071770;

local_b0 = 0;
LAB_1800718a3:
uVar6 = (uint)local_c8 + 2;
local_c8 = CONCAT44(local_c8._4_4_,uVar6);
LAB_1800718b1:
if (param_2 == (undefined *)0x0) {
*param_3 = uVar6;
}
else if (*param_3 < uVar6) {
*param_3 = uVar6;
}
else {
if (uVar13 != 0) {
*param_2 = (char)(uVar6 - 2 >> 8);
param_2[1] = (char)uVar6 + -2;
}
*param_3 = uVar6;
uStackY_130 = 0x1800718f1;
LsaIModifyPerformanceCounter(6,0,0);
}
goto LAB_180071920;
}
uVar9 = 0x33;
uVar7 = 0x2c4;
}
}
else {
uStackY_130 = 0x180071648;
RtlReleaseResource(local_c0 + 0x48);
uVar9 = 0x33;
uVar7 = 0x33a;
}
}
uStackY_130 = 0x180071920;
FUN_18005b470(param_1,uVar7,iVar1,uVar9);
LAB_180071920:
if (local_b8 != 0) {
uStackY_130 = 0x180071930;
NCryptFreeObject(local_b8);
}
if (local_b0 != 0) {
uStackY_130 = 0x180071947;
SslFreeObject(local_b0,0);
}
uStackY_130 = 0x18007195a;
uVar5 = FUN_180028070(uVar4 ^ (ulonglong)auStackY_128);
return uVar5;
}
=========================================
Function at address: 0x1800723a4
Called functions addresses: 0x18002a77b 0x18000909c 0x18005b660 0xEXTERNAL:00000047 0x180001604 0xEXTERNAL:00000117 0x180070ee8 0x18005b470 0x180028070 0xEXTERNAL:00000116 0x180009ed4


void FUN_1800723a4(longlong *param_1,PUCHAR param_2,int *param_3)

{
PUCHAR pUVar1;
HLOCAL pvVar2;
int iVar3;
int iVar4;
undefined8 uVar5;
ulonglong *puVar6;
ulonglong uVar7;
ulonglong uVar8;
undefined4 uVar9;
uint uVar10;
ulonglong uVar11;
undefined auStackY_d8 [32];
int local_80;
uint local_7c [3];
HLOCAL local_70;
UCHAR local_68 [40];
ulonglong local_40;

local_40 = DAT_180091970 ^ (ulonglong)auStackY_d8;
uVar8 = 0;
local_80 = 0;
local_7c[1] = 0;
local_70 = (HLOCAL)0x0;
if (param_1[3] == 0) goto LAB_18007242b;
if (((*(byte *)(param_1 + 4) & 1) != 0) && (param_1[1] != 0)) {
uVar10 = *(uint *)(param_1[1] + 0x1c);
if (uVar10 == 3) {
LAB_18007245a:
uVar10 = 0x40;
LAB_18007245f:
uVar5 = FUN_180070ee8(*(undefined8 *)(param_1[3] + 8),local_7c);
if ((int)uVar5 != 0) goto LAB_18007242b;
if (uVar10 < local_7c[0]) {
if (param_2 == (PUCHAR)0x0) {
*param_3 = local_7c[0] + 10 + uVar10;
goto LAB_18007242b;
}
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(puVar6 = (ulonglong *)param_1[1], puVar6 == (ulonglong *)0x0)) {
puVar6 = (ulonglong *)param_1[1];
uVar11 = uVar8;
}
else {
uVar11 = (ulonglong)*(uint *)((longlong)puVar6 + 0x1c);
}
uVar7 = uVar8;
if (puVar6 != (ulonglong *)0x0) {
uVar7 = *puVar6;
}
iVar3 = SslCreateEphemeralKey
(uVar7,param_1 + 0xe,*(undefined2 *)((longlong)param_1 + 0x22),uVar11);
if (iVar3 != 0) {
FUN_18005b470(param_1,0x332,iVar3,0x33);
goto LAB_18007242b;
}
if ((ulonglong *)param_1[1] != (ulonglong *)0x0) {
uVar8 = *(ulonglong *)param_1[1];
}
iVar3 = FUN_180009ed4(uVar8,param_1[0xe],L"RSAPUBLICBLOB",local_7c + 1,(longlong *)&local_70
);
pvVar2 = local_70;
if (iVar3 == 0) {
*param_2 = (UCHAR)((uint)*(undefined4 *)((longlong)local_70 + 0xc) >> 8);
param_2[1] = *(UCHAR *)((longlong)local_70 + 0xc);
memcpy(param_2 + 2,
(void *)((longlong)local_70 + (ulonglong)*(uint *)((longlong)local_70 + 8) + 0x18),
(ulonglong)*(uint *)((longlong)local_70 + 0xc));
pUVar1 = param_2 + 2 + *(uint *)((longlong)pvVar2 + 0xc);
*pUVar1 = (UCHAR)((uint)*(undefined4 *)((longlong)pvVar2 + 8) >> 8);
pUVar1[1] = *(UCHAR *)((longlong)pvVar2 + 8);
memcpy(pUVar1 + 2,(void *)((longlong)pvVar2 + 0x18),
(ulonglong)*(uint *)((longlong)pvVar2 + 8));
uVar10 = *(uint *)((longlong)pvVar2 + 8);
iVar3 = *(int *)((longlong)pvVar2 + 0xc);
pUVar1 = pUVar1 + 2 + uVar10;
iVar4 = FUN_180001604(*(longlong *)(param_1[10] + 0x2f0),&local_80);
if (iVar4 == 0) {
iVar3 = FUN_18005b660((longlong)param_1,param_2,iVar3 + uVar10 + 4,local_68);
uVar5 = 0;
if (iVar3 == 0) {
if ((undefined8 *)param_1[1] != (undefined8 *)0x0) {
uVar5 = *(undefined8 *)param_1[1];
}
iVar3 = SslSignHash(uVar5,*(undefined8 *)(param_1[3] + 8),local_68,0x24);
if (iVar3 == 0) {
*pUVar1 = '\0';
pUVar1[1] = '\0';
*param_3 = ((int)pUVar1 - (int)param_2) + 2;
goto LAB_18007268d;
}
uVar9 = 0x334;
}
else {
uVar9 = 0x32f;
}
FUN_18005b470(param_1,uVar9,iVar3,0x50);
}
LAB_18007268d:
if (local_80 != 0) {
RevertToSelf();
}
}
else {
FUN_18005b470(param_1,0x333,iVar3,0x33);
}
if (pvVar2 != (HLOCAL)0x0) {
FUN_18000909c(pvVar2);
}
goto LAB_18007242b;
}
}
else if (0x61 < uVar10) {
if (uVar10 < 0x65) {
uVar10 = 0x80;
goto LAB_18007245f;
}
if (uVar10 == 0x20080) goto LAB_18007245a;
}
}
*param_3 = 0;
LAB_18007242b:
FUN_180028070(local_40 ^ (ulonglong)auStackY_d8);
return;
}
=========================================
Function at address: 0x1800726b8
Called functions addresses: 0x18006f734


void FUN_1800726b8(longlong param_1)

{
if (*(HLOCAL *)(param_1 + 0x10) != (HLOCAL)0x0) {
FUN_18006f734(*(HLOCAL *)(param_1 + 0x10));
*(undefined8 *)(param_1 + 0x10) = 0;
}
if (*(HLOCAL *)(param_1 + 0x18) != (HLOCAL)0x0) {
FUN_18006f734(*(HLOCAL *)(param_1 + 0x18));
*(undefined8 *)(param_1 + 0x18) = 0;
}
return;
}
=========================================
Function at address: 0x1800726f4
Called functions addresses: 0x18006f734 0x1800727cc


void FUN_1800726f4(longlong param_1)

{
undefined8 *puVar1;
undefined8 *puVar2;

puVar2 = *(undefined8 **)(param_1 + 0x18);
while (puVar2 != (undefined8 *)(param_1 + 0x18)) {
puVar1 = (undefined8 *)*puVar2;
FUN_18006f734(puVar2);
puVar2 = puVar1;
}
puVar2 = *(undefined8 **)(param_1 + 0x28);
while (puVar2 != (undefined8 *)(param_1 + 0x28)) {
puVar1 = (undefined8 *)*puVar2;
FUN_18006f734(puVar2);
puVar2 = puVar1;
}
puVar2 = *(undefined8 **)(param_1 + 0x38);
while (puVar2 != (undefined8 *)(param_1 + 0x38)) {
puVar1 = puVar2 + -5;
puVar2 = (undefined8 *)*puVar2;
if (puVar1 != (undefined8 *)0x0) {
FUN_1800727cc(puVar1);
}
}
puVar2 = *(undefined8 **)(param_1 + 0x48);
while (puVar2 != (undefined8 *)(param_1 + 0x48)) {
puVar1 = puVar2 + -5;
puVar2 = (undefined8 *)*puVar2;
if (puVar1 != (undefined8 *)0x0) {
FUN_1800727cc(puVar1);
}
}
return;
}
=========================================
Function at address: 0x180072790
Called functions addresses: 0x18002a7c0


void FUN_180072790(longlong param_1)

{
if (*(longlong *)(param_1 + 8) != 0) {

(*(undefined8 *)(param_1 + 0x10),*(undefined8 *)(param_1 + 0x18));
}
return;
}
=========================================
Function at address: 0x1800727cc
Called functions addresses: 0x18000909c 0x180072790


HLOCAL FUN_1800727cc(HLOCAL param_1)

{
FUN_180072790((longlong)param_1);
if (param_1 != (HLOCAL)0x0) {
FUN_18000909c(param_1);
}
return param_1;
}
=========================================
Function at address: 0x1800727f8
Called functions addresses: 0x1800739d4 0x18006f734 0x180041cdc 0x180044e9c 0x180041cb0 0x180073880 0x18000a1f4 0x180073b6c 0x180073a80


longlong * FUN_1800727f8(uint *param_1,ulonglong param_2,undefined *param_3,int param_4)

{
undefined8 uVar1;
uint uVar2;
longlong *plVar3;
uint uVar5;
undefined *puVar6;
longlong *plVar4;

uVar5 = (uint)param_3;
puVar6 = (undefined *)(param_2 & 0xffffffff);
plVar4 = (longlong *)0x0;
plVar3 = (longlong *)0x0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180073a80(DAT_180091000[2],param_2,param_3,(int)param_2,(char)param_3,(char)param_4);
}
uVar2 = 0;
if ((uVar5 < *param_1) || (*param_1 + param_1[2] <= uVar5)) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_3 = &DAT_180085928;
FUN_180041cdc(DAT_180091000[2],0xc,&DAT_180085928,uVar5);
}
if (*(longlong *)(*(longlong *)(param_1 + 0x16) + 0x50) != 0) {
uVar2 = *(uint *)(*(longlong *)(*(longlong *)(param_1 + 0x16) + 0x50) + 0xd4);
}
FUN_180044e9c(uVar2);
}
else {
plVar3 = (longlong *)FUN_18000a1f4(0x48);
if (plVar3 == (longlong *)0x0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return (longlong *)0x0;
}
plVar3 = plVar4;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0) {
param_3 = &DAT_180085928;
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180085928);
}
}
else {
*(undefined4 *)(plVar3 + 2) = 0;
*(undefined8 *)((longlong)plVar3 + 0x1c) = 0;
plVar3[5] = 0;
plVar3[6] = 0;
plVar3[7] = 0;
*(undefined4 *)((longlong)plVar3 + 0x44) = 0;
uVar1 = FUN_180073880((longlong)plVar3,uVar5,(int)param_2,param_4,0xc);
if ((int)uVar1 == 0) {
FUN_1800739d4((longlong)param_1,plVar3);
param_1[1] = param_1[1] + 1;
param_3 = puVar6;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
puVar6 = &DAT_180085928;
FUN_180041cb0(DAT_180091000[2],0xe,&DAT_180085928);
}
FUN_18006f734(plVar3);
plVar3 = plVar4;
param_3 = puVar6;
}
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180073b6c(DAT_180091000[2],0xf,param_3,plVar3);
}
return plVar3;
}
=========================================
Function at address: 0x1800729c0
Called functions addresses: 0x18007395c 0x18000a1f4 0x1800727cc


undefined8 * FUN_1800729c0(longlong param_1,undefined4 param_2)

{
longlong *plVar1;
longlong *plVar2;
code *pcVar3;
int iVar4;
undefined8 *puVar5;
longlong *plVar6;
undefined8 *puVar7;
longlong *plVar8;

plVar1 = (longlong *)(param_1 + 0x38);
if ((longlong *)*plVar1 == plVar1) {
plVar6 = (longlong *)(param_1 + 0x48);
plVar8 = (longlong *)*plVar6;
if (plVar8 != plVar6) {
do {
plVar2 = plVar8 + -5;
plVar8 = (longlong *)*plVar8;
if (plVar2 != (longlong *)0x0) {
FUN_1800727cc(plVar2);
}
} while (plVar8 != plVar6);
*(longlong **)(param_1 + 0x50) = plVar6;
*plVar6 = (longlong)plVar6;
}
}
puVar5 = (undefined8 *)FUN_18000a1f4(0x38);
puVar7 = (undefined8 *)0x0;
if (puVar5 != (undefined8 *)0x0) {
puVar5[1] = 0;
*puVar5 = 0;
iVar4 = FUN_18007395c((undefined4 *)puVar5,param_2,*(longlong **)(param_1 + 0x58));
if (iVar4 == 0) {
puVar7 = *(undefined8 **)(param_1 + 0x40);
plVar6 = puVar5 + 5;
if ((longlong *)*puVar7 != plVar1) {
puVar7 = (undefined8 *)0x3;
pcVar3 = (code *)swi(0x29);
plVar6 = (longlong *)(*pcVar3)();
}
*plVar6 = (longlong)plVar1;
plVar6[1] = (longlong)puVar7;
*puVar7 = plVar6;
*(longlong **)(param_1 + 0x40) = plVar6;
puVar7 = puVar5;
}
else {
FUN_1800727cc(puVar5);
}
}
return puVar7;
}
=========================================
Function at address: 0x180072a90
Called functions addresses: 0x18006f734


void FUN_180072a90(longlong param_1)

{
*(undefined4 *)(param_1 + 8) = 0;
if (*(HLOCAL *)(param_1 + 0x10) != (HLOCAL)0x0) {
FUN_18006f734(*(HLOCAL *)(param_1 + 0x10));
*(undefined8 *)(param_1 + 0x10) = 0;
}
*(undefined4 *)(param_1 + 0xc) = 0;
if (*(HLOCAL *)(param_1 + 0x18) != (HLOCAL)0x0) {
FUN_18006f734(*(HLOCAL *)(param_1 + 0x18));
*(undefined8 *)(param_1 + 0x18) = 0;
}
*(undefined4 *)(param_1 + 0x20) = 4;
return;
}
=========================================
Function at address: 0x180072adc
Called functions addresses: 0x180073b00 0x180073660 0x180041cdc 0x180072ef8 0x180044e9c 0x1800727f8 0x180041cb0 0x180073190 0x180073410 0x18006f7a0


int FUN_180072adc(longlong *param_1,undefined8 param_2,undefined *param_3,uint param_4,
ulonglong param_5)

{
byte bVar1;
byte bVar2;
byte bVar3;
longlong lVar4;
undefined *puVar5;
undefined uVar6;
int iVar7;
undefined8 uVar8;
longlong *plVar9;
ulonglong uVar10;
undefined2 uVar11;
uint uVar12;
undefined8 *puVar13;
uint *puVar14;
uint uVar15;
undefined *puVar16;
uint uVar17;
int iVar18;

iVar18 = (int)param_2;
iVar7 = 0x90312;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180073b00(DAT_180091000[2],param_2,param_3,iVar18,(char)param_4,(char)param_5);
}
puVar13 = &DAT_180091000;
lVar4 = *(longlong *)(param_1[5] + 0x50);
if (lVar4 == 0) {
puVar16 = &DAT_18008233c;
uVar17 = 0;
}
else {
uVar17 = *(uint *)(lVar4 + 0xd4);
puVar16 = (undefined *)(lVar4 + 0xd8);
}
if (iVar18 == 0x14) {
iVar7 = FUN_180073190((longlong)param_1,param_3,param_4,param_5);
}
else if (iVar18 == 0x16) {
if ((*(int *)((longlong)param_1 + 0x24) == -1) ||
(*(uint *)((longlong)param_1 + 0x24) < (uint)(ushort)(param_5 >> 0x30))) {
uVar10 = FUN_180073410((longlong)param_1,param_3,param_4,param_5);
iVar7 = (int)uVar10;
}
else {
uVar8 = FUN_18006f7a0(param_1[5],param_5);
if ((char)uVar8 == '\0') {
if ((DAT_180091000 != puVar13) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],(short)param_2 + 0xd,&DAT_180085928);
}
FUN_180044e9c(uVar17);
iVar7 = 0x90312;
}
else {
while( true ) {
if ((DAT_180091000 != puVar13) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0))
{
FUN_180041cb0(DAT_180091000[2],0x24,&DAT_180085928);
puVar13 = &DAT_180091000;
}
if (param_4 < 0xc) break;
bVar1 = param_3[6];
iVar18 = ((uint)(byte)param_3[1] * 0x100 + (uint)(byte)param_3[2]) * 0x100 +
(uint)(byte)param_3[3];
bVar2 = param_3[7];
bVar3 = param_3[8];
uVar15 = ((uint)(byte)param_3[9] * 0x100 + (uint)(byte)param_3[10]) * 0x100 +
(uint)(byte)param_3[0xb];
if (param_4 < uVar15 + 0xc) {
if ((DAT_180091000 != puVar13) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)
) {
uVar11 = 0x26;
goto LAB_180072e4f;
}
goto LAB_180072e66;
}
puVar14 = (uint *)*param_1;
uVar12 = (uint)(byte)param_3[4] * 0x100 + (uint)(byte)param_3[5];
puVar13 = DAT_180091000;
plVar9 = FUN_180072ef8((longlong)puVar14,uVar12);
if (plVar9 == (longlong *)0x0) {
if (((undefined8 **)puVar13 != &DAT_180091000) &&
((*(byte *)((longlong)puVar13 + 0x1c) & 4) != 0)) {
FUN_180041cb0(puVar13[2],0x27,&DAT_180085928);
puVar14 = (uint *)*param_1;
}
plVar9 = FUN_1800727f8(puVar14,0x16,(undefined *)(ulonglong)uVar12,iVar18);
if (plVar9 != (longlong *)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x28,&DAT_180085928);
}
puVar5 = (undefined *)plVar9[5];
*puVar5 = *param_3;
puVar5[5] = (char)uVar12;
*(undefined2 *)(puVar5 + 7) = 0;
uVar6 = (undefined)((uint)iVar18 >> 0x10);
puVar5[1] = uVar6;
puVar5[9] = uVar6;
puVar5[4] = (char)(uVar12 >> 8);
puVar5[3] = (char)iVar18;
uVar6 = (undefined)((uint)iVar18 >> 8);
puVar5[2] = uVar6;
puVar5[0xb] = (char)iVar18;
puVar5[10] = uVar6;
puVar5[6] = 0;
puVar13 = DAT_180091000;
goto LAB_180072d8c;
}
}
else {
LAB_180072d8c:
if (((undefined8 **)puVar13 != &DAT_180091000) &&
((*(byte *)((longlong)puVar13 + 0x1c) & 4) != 0)) {
FUN_180041cb0(puVar13[2],0x29,&DAT_180085928);
}
iVar7 = FUN_180073660((longlong)plVar9,uVar17,puVar16,param_3 + 0xc,
((uint)bVar1 * 0x100 + (uint)bVar2) * 0x100 + (uint)bVar3,uVar15);
if (iVar7 != 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2a,&DAT_180085928,iVar7);
}
goto LAB_180072e66;
}
}
param_3 = param_3 + (ulonglong)uVar15 + 0xc;
param_4 = param_4 + (-0xc - uVar15);
if (param_4 == 0) goto LAB_180072eab;
puVar13 = &DAT_180091000;
}
if ((DAT_180091000 != puVar13) && ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar11 = 0x25;
LAB_180072e4f:
FUN_180041cb0(DAT_180091000[2],uVar11,&DAT_180085928);
}
LAB_180072e66:
iVar7 = -0x7ff6fcda;
}
}
}
else {
iVar7 = 0x90312;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x22,&DAT_180085928);
iVar7 = 0x90312;
}
}
LAB_180072eab:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x2b,&DAT_180085928,iVar7);
}
return iVar7;
}
=========================================
Function at address: 0x180072ef8
Called functions addresses: None


undefined8 * FUN_180072ef8(longlong param_1,int param_2)

{
undefined8 *puVar1;
undefined8 *puVar2;

for (puVar1 = *(undefined8 **)(param_1 + 0x18);
((puVar2 = (undefined8 *)0x0, puVar1 != (undefined8 *)(param_1 + 0x18) &&
(puVar1 != (undefined8 *)0x0)) && (puVar2 = puVar1, *(int *)(puVar1 + 3) != param_2));
puVar1 = (undefined8 *)*puVar1) {
}
return puVar2;
}
=========================================
Function at address: 0x180072f28
Called functions addresses: 0x180041cb0 0x180073028 0x18002a7c0


longlong FUN_180072f28(undefined8 *param_1,undefined8 param_2,undefined *param_3)

{
char cVar1;
longlong lVar2;
undefined2 uVar3;

lVar2 = FUN_180073028((int *)*param_1,param_2,param_3);
if (lVar2 != 0) {
*(undefined4 *)(param_1 + 4) = 1;
return lVar2;
}
if ((*(int *)(param_1 + 4) == 1) || (*(int *)(param_1 + 4) == 4)) {
if (*(int *)(param_1 + 1) == 0) {
return 0;
}

if (cVar1 == '\0') {
return 0;
}
lVar2 = param_1[2];
param_1[2] = 0;
*(undefined4 *)(param_1 + 1) = 0;
*(undefined4 *)(param_1 + 4) = 2;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return lVar2;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return lVar2;
}
uVar3 = 0x2c;
}
else {
if (*(int *)(param_1 + 4) != 2) {
return 0;
}
if (*(int *)((longlong)param_1 + 0xc) == 0) {
return 0;
}
lVar2 = param_1[3];
param_1[3] = 0;
*(undefined4 *)((longlong)param_1 + 0xc) = 0;
*(undefined4 *)(param_1 + 4) = 3;
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return lVar2;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return lVar2;
}
uVar3 = 0x2d;
}
FUN_180041cb0(DAT_180091000[2],uVar3,&DAT_180085928);
return lVar2;
}
=========================================
Function at address: 0x180073028
Called functions addresses: 0x180072ef8 0x18004492c 0x180041cb0 0x180073b6c


longlong FUN_180073028(int *param_1,undefined8 param_2,undefined *param_3)

{
int *piVar1;
int iVar2;
longlong *plVar3;
undefined2 uVar4;
longlong lVar5;
longlong lVar6;
undefined8 *puVar7;

plVar3 = (longlong *)(param_1 + 6);
lVar6 = *plVar3;
lVar5 = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
param_3 = &DAT_180085928;
FUN_180041cb0(DAT_180091000[2],0x10,&DAT_180085928);
}
puVar7 = DAT_180091000;
if ((longlong *)*plVar3 == plVar3) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
lVar6 = lVar5;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) goto LAB_18007314d;
uVar4 = 0x11;
}
else {
piVar1 = (int *)(lVar6 + 0x18);
iVar2 = *param_1;
if (*piVar1 != iVar2) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
lVar6 = lVar5;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
param_3 = &DAT_180085928;
FUN_18004492c(DAT_180091000[2],0x12,&DAT_180085928,*piVar1,(char)iVar2);
puVar7 = DAT_180091000;
}
goto LAB_18007314d;
}
if (*(int *)(lVar6 + 0x1c) == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
lVar6 = lVar5;
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) goto LAB_18007314d;
uVar4 = 0x13;
}
else {
plVar3 = FUN_180072ef8((longlong)param_1,iVar2);
if (plVar3 != (longlong *)0x0) {
*(longlong *)plVar3[1] = *plVar3;
*(longlong *)(*plVar3 + 8) = plVar3[1];
param_1[1] = param_1[1] + -1;
*param_1 = *param_1 + 1;
puVar7 = DAT_180091000;
goto LAB_18007314d;
}
if ((undefined8 **)puVar7 == &DAT_180091000) {
return 0;
}
lVar6 = 0;
if ((*(byte *)((longlong)puVar7 + 0x1c) & 1) == 0) goto LAB_18007314d;
uVar4 = 0x14;
}
}
param_3 = &DAT_180085928;
FUN_180041cb0(puVar7[2],uVar4,&DAT_180085928);
lVar6 = lVar5;
puVar7 = DAT_180091000;
LAB_18007314d:
if (((undefined8 **)puVar7 != &DAT_180091000) && ((*(byte *)((longlong)puVar7 + 0x1c) & 4) != 0))
{
FUN_180073b6c(puVar7[2],0x15,param_3,lVar6);
}
return lVar6;
}
=========================================
Function at address: 0x180073190
Called functions addresses: 0x18002a77b 0x18006f734 0x180041cdc 0x180041cb0 0x180073880 0x18000a1f4 0x180041e58 0x18006f7a0


int FUN_180073190(longlong param_1,void *param_2,uint param_3,ulonglong param_4)

{
undefined *puVar1;
undefined8 uVar2;
HLOCAL pvVar3;
undefined2 uVar4;
ulonglong uVar5;
int iVar6;
undefined8 *puVar7;

iVar6 = 0x90312;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x16,&DAT_180085928,param_4);
}
puVar7 = &DAT_180091000;
if (*(int *)(param_1 + 8) == 0) {
uVar2 = FUN_18006f7a0(*(longlong *)(param_1 + 0x28),param_4);
if ((char)uVar2 != '\0') {
pvVar3 = (HLOCAL)FUN_18000a1f4(0x48);
if (pvVar3 == (HLOCAL)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x19,&DAT_180085928);
}
iVar6 = 0xe;
}
else {
*(undefined4 *)((longlong)pvVar3 + 0x10) = 0;
*(undefined4 *)((longlong)pvVar3 + 0x1c) = 0;
*(undefined4 *)((longlong)pvVar3 + 0x20) = 0;
*(undefined8 *)((longlong)pvVar3 + 0x28) = 0;
*(undefined8 *)((longlong)pvVar3 + 0x30) = 0;
*(undefined8 *)((longlong)pvVar3 + 0x38) = 0;
*(undefined4 *)((longlong)pvVar3 + 0x44) = 0;
uVar2 = FUN_180073880((longlong)pvVar3,0,0x14,param_3,0xd);
if ((int)uVar2 == 0) {
puVar1 = *(undefined **)((longlong)pvVar3 + 0x28);
*puVar1 = 0x14;
uVar4 = *(undefined2 *)(*(longlong *)(param_1 + 0x28) + 0x22);
puVar1[2] = (char)uVar4;
puVar1[1] = (char)((ushort)uVar4 >> 8);
puVar1[4] = (char)(param_4 >> 0x30);
puVar1[3] = (char)(param_4 >> 0x38);
uVar5 = param_4 & 0xffffffffffff;
puVar1[0xc] = (char)param_3;
puVar1[10] = (char)uVar5;
puVar1[9] = (char)(uVar5 >> 8);
puVar1[8] = (char)(uVar5 >> 0x10);
puVar1[7] = (char)(uVar5 >> 0x18);
puVar1[6] = (char)(uVar5 >> 0x20);
puVar1[5] = (char)(uVar5 >> 0x28);
puVar1[0xb] = (char)(param_3 >> 8);
memcpy(puVar1 + 0xd,param_2,(ulonglong)param_3);
*(HLOCAL *)(param_1 + 0x10) = pvVar3;
*(undefined4 *)(param_1 + 8) = 1;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1a,&DAT_180085928);
}
FUN_18006f734(pvVar3);
iVar6 = (int)uVar2;
}
}
goto LAB_18007322e;
}
if ((DAT_180091000 == puVar7) || ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0))
goto LAB_18007322e;
uVar4 = 0x18;
}
else {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x90312;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) goto LAB_18007322e;
uVar4 = 0x17;
}
FUN_180041cb0(DAT_180091000[2],uVar4,&DAT_180085928);
LAB_18007322e:
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x1b,&DAT_180085928,iVar6);
}
return iVar6;
}
=========================================
Function at address: 0x180073410
Called functions addresses: 0x18002a77b 0x180041cdc 0x18006f734 0x180041cb0 0x180073880 0x18000a1f4 0x180041e58


ulonglong FUN_180073410(longlong param_1,void *param_2,uint param_3,ulonglong param_4)

{
undefined2 uVar1;
undefined *puVar2;
HLOCAL pvVar3;
ulonglong uVar4;
ulonglong uVar5;

uVar5 = 0x90312;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e58(DAT_180091000[2],0x1c,&DAT_180085928,param_4);
}
if (*(int *)(param_1 + 0xc) == 0) {
pvVar3 = (HLOCAL)FUN_18000a1f4(0x48);
if (pvVar3 == (HLOCAL)0x0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1e,&DAT_180085928);
}
uVar5 = 0xe;
}
else {
*(undefined4 *)((longlong)pvVar3 + 0x10) = 0;
*(undefined4 *)((longlong)pvVar3 + 0x1c) = 0;
*(undefined4 *)((longlong)pvVar3 + 0x20) = 0;
*(undefined8 *)((longlong)pvVar3 + 0x28) = 0;
*(undefined8 *)((longlong)pvVar3 + 0x30) = 0;
*(undefined8 *)((longlong)pvVar3 + 0x38) = 0;
*(undefined4 *)((longlong)pvVar3 + 0x44) = 0;
uVar4 = FUN_180073880((longlong)pvVar3,0,0x16,param_3,0xd);
if ((int)uVar4 == 0) {
puVar2 = *(undefined **)((longlong)pvVar3 + 0x28);
*puVar2 = 0x16;
uVar1 = *(undefined2 *)(*(longlong *)(param_1 + 0x28) + 0x22);
puVar2[2] = (char)uVar1;
puVar2[1] = (char)((ushort)uVar1 >> 8);
puVar2[4] = (char)(param_4 >> 0x30);
puVar2[3] = (char)(param_4 >> 0x38);
uVar4 = param_4 & 0xffffffffffff;
puVar2[0xc] = (char)param_3;
puVar2[10] = (char)uVar4;
puVar2[9] = (char)(uVar4 >> 8);
puVar2[8] = (char)(uVar4 >> 0x10);
puVar2[7] = (char)(uVar4 >> 0x18);
puVar2[6] = (char)(uVar4 >> 0x20);
puVar2[5] = (char)(uVar4 >> 0x28);
puVar2[0xb] = (char)(param_3 >> 8);
memcpy(puVar2 + 0xd,param_2,(ulonglong)param_3);
*(undefined4 *)((longlong)pvVar3 + 0x44) = 1;
*(HLOCAL *)(param_1 + 0x18) = pvVar3;
*(undefined4 *)(param_1 + 0xc) = 1;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x1f,&DAT_180085928);
}
uVar5 = uVar4 & 0xffffffff;
FUN_18006f734(pvVar3);
}
}
}
else {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x90312;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x1d,&DAT_180085928);
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x20,&DAT_180085928,(int)uVar5);
}
return uVar5;
}
=========================================
Function at address: 0x180073660
Called functions addresses: 0x18002a77b 0x180045408 0xEXTERNAL:000000c8 0x180041d20 0x180073828 0x1800737bc


undefined4
FUN_180073660(longlong param_1,uint param_2,undefined8 param_3,void *param_4,uint param_5,
uint param_6)

{
int iVar1;
undefined4 uVar2;
uint uVar3;
ulonglong uVar4;
ulonglong uVar5;
ulonglong _Size;
undefined local_28 [16];

if (param_4 != (void *)0x0) {
uVar4 = (ulonglong)param_5;
_Size = (ulonglong)param_6;
if (param_5 + param_6 <= *(uint *)(param_1 + 0x10)) {
if (param_6 == 0) {
return 0;
}
if (*(int *)(param_1 + 0x1c) != 0) {
return 0;
}
iVar1 = FUN_180073828(param_1,param_5,(param_5 + param_6) - 1);
if (iVar1 == 0) {
memcpy((void *)(uVar4 + *(longlong *)(param_1 + 0x30)),param_4,_Size);
if (param_6 != 0) {
do {
uVar3 = (uint)uVar4;
uVar5 = uVar4 >> 3;
uVar4 = (ulonglong)(uVar3 + 1);
*(byte *)(uVar5 + *(longlong *)(param_1 + 0x38)) =
*(byte *)(uVar5 + *(longlong *)(param_1 + 0x38)) |
(byte)(1 << (7 - (uVar3 & 7) & 0x1f));
_Size = _Size - 1;
} while (_Size != 0);
}
uVar2 = FUN_1800737bc(param_1);
*(undefined4 *)(param_1 + 0x1c) = uVar2;
return 0;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],10,&DAT_180085928,param_5,(char)param_6);
}
if ((DAT_1800919b0 & 4) == 0) {
return 0;
}
RtlInitUnicodeString(local_28,param_3);
FUN_180045408((ushort *)&DAT_180084f60,0x180084eb4,(ulonglong)param_2,local_28);
return 0;
}
}
return 0x57;
}
=========================================
Function at address: 0x1800737bc
Called functions addresses: None


undefined4 FUN_1800737bc(longlong param_1)

{
uint uVar1;
uint uVar2;
ulonglong uVar3;
int *piVar4;

uVar1 = *(uint *)(param_1 + 0x10);
piVar4 = *(int **)(param_1 + 0x38);
uVar2 = 0;
if (uVar1 >> 5 != 0) {
do {
if (*piVar4 != -1) {
return 0;
}
piVar4 = piVar4 + 1;
uVar2 = uVar2 + 1;
} while (uVar2 < uVar1 >> 5);
}
uVar3 = 0;
if ((uVar1 & 0x1f) != 0) {
do {
if ((*(byte *)((uVar3 >> 3) + (longlong)piVar4) >> (7 - ((byte)uVar3 & 7) & 0x1f) & 1) == 0) {
return 0;
}
uVar2 = (int)uVar3 + 1;
uVar3 = (ulonglong)uVar2;
} while (uVar2 < (uVar1 & 0x1f));
}
return 1;
}
=========================================
Function at address: 0x180073828
Called functions addresses: None


int FUN_180073828(longlong param_1,uint param_2,uint param_3)

{
int iVar1;

iVar1 = 0;
if (param_2 <= param_3) {
do {
if (iVar1 != 0) {
return iVar1;
}
if ((*(byte *)((ulonglong)(param_2 >> 3) + *(longlong *)(param_1 + 0x38)) >>
(7 - ((byte)param_2 & 7) & 0x1f) & 1) != 0) {
iVar1 = 1;
}
param_2 = param_2 + 1;
} while (param_2 <= param_3);
}
return iVar1;
}
=========================================
Function at address: 0x180073880
Called functions addresses: 0x180028d90 0x180029f58 0x180028a7c


undefined8
FUN_180073880(longlong param_1,undefined4 param_2,undefined4 param_3,int param_4,uint param_5)

{
longlong lVar1;
void *_Dst;
longlong lVar2;
undefined8 uVar3;
uint uVar4;
ulonglong _Size;

lVar2 = 0;
uVar4 = param_4 + param_5;
if (uVar4 == 0) {
uVar3 = 0x57;
}
else {
lVar1 = FUN_180029f58((ulonglong)uVar4);
*(longlong *)(param_1 + 0x28) = lVar1;
if (lVar1 != 0) {
_Size = (ulonglong)(param_4 + 7U >> 3);
_Dst = (void *)FUN_180029f58(_Size);
*(void **)(param_1 + 0x38) = _Dst;
if (_Dst != (void *)0x0) {
*(uint *)(param_1 + 0x14) = uVar4;
*(int *)(param_1 + 0x10) = param_4;
*(uint *)(param_1 + 0x1c) = (uint)(param_4 == 0);
memset(_Dst,0,_Size);
if (param_4 != 0) {
lVar2 = (ulonglong)param_5 + *(longlong *)(param_1 + 0x28);
}
*(longlong *)(param_1 + 0x30) = lVar2;
*(undefined4 *)(param_1 + 0x18) = param_2;
*(undefined4 *)(param_1 + 0x40) = param_3;
return 0;
}
_o_free(*(undefined8 *)(param_1 + 0x28));
*(undefined8 *)(param_1 + 0x28) = 0;
}
uVar3 = 8;
}
return uVar3;
}
=========================================
Function at address: 0x18007395c
Called functions addresses: 0x18002a7c0


undefined4 FUN_18007395c(undefined4 *param_1,undefined4 param_2,longlong *param_3)

{
longlong lVar1;
undefined4 uVar2;

uVar2 = 0;
if (param_3 == (longlong *)0x0) {
uVar2 = 0x57;
}
else {
*(longlong **)(param_1 + 4) = param_3;

*(longlong *)(param_1 + 6) = lVar1;
if (lVar1 == 0) {
uVar2 = 8;
}
else {
*(longlong *)(param_1 + 2) = lVar1;
*param_1 = param_2;
param_1[1] = 0;
param_1[8] = 0;
}
}
return uVar2;
}
=========================================
Function at address: 0x1800739d4
Called functions addresses: None


ulonglong FUN_1800739d4(longlong param_1,longlong *param_2)

{
undefined8 *puVar1;
code *pcVar2;
undefined8 *puVar3;
ulonglong uVar4;

puVar1 = (undefined8 *)(param_1 + 0x18);
uVar4 = 0;
puVar3 = (undefined8 *)*puVar1;
do {
if (puVar3 == puVar1) {
puVar3 = *(undefined8 **)(param_1 + 0x20);
if ((undefined8 *)*puVar3 == puVar1) {
*param_2 = (longlong)puVar1;
param_2[1] = (longlong)puVar3;
*puVar3 = param_2;
*(longlong **)(param_1 + 0x20) = param_2;
}
else {
puVar3 = (undefined8 *)0x3;
pcVar2 = (code *)swi(0x29);
(*pcVar2)();
LAB_180073a05:
*(longlong **)puVar3[1] = param_2;
*param_2 = (longlong)puVar3;
param_2[1] = puVar3[1];
puVar3[1] = param_2;
}
LAB_180073a33:
return uVar4 & 0xffffffff;
}
if (puVar3 == (undefined8 *)0x0) {
uVar4 = 0x54f;
goto LAB_180073a33;
}
if (*(uint *)(param_2 + 3) < *(uint *)(puVar3 + 3)) goto LAB_180073a05;
puVar3 = (undefined8 *)*puVar3;
} while( true );
}
=========================================
Function at address: 0x180073a40
Called functions addresses: None


undefined8 FUN_180073a40(longlong param_1)

{
longlong *plVar1;
longlong *plVar2;
longlong *plVar3;

plVar1 = (longlong *)(param_1 + 0x38);
if ((longlong *)*plVar1 == plVar1) {
plVar2 = (longlong *)(param_1 + 0x48);
plVar3 = (longlong *)*plVar2;
if (plVar3 != plVar2) {
*plVar1 = (longlong)plVar3;
plVar3[1] = (longlong)plVar1;
*(longlong **)(param_1 + 0x40) = *(longlong **)(param_1 + 0x50);
**(longlong **)(param_1 + 0x50) = (longlong)plVar1;
*(longlong **)(param_1 + 0x50) = plVar2;
*plVar2 = (longlong)plVar2;
return 0;
}
}
return 0x80090304;
}
=========================================
Function at address: 0x180073a80
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180073a80(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5,undefined param_6)

{
undefined4 local_res20 [2];
undefined4 local_18 [6];

local_18[0] = 0xc;
local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,&DAT_180085928,0xb,local_res20,4,&param_5,4,&param_6,4,local_18,4,0);
return;
}
=========================================
Function at address: 0x180073b00
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180073b00(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5,undefined param_6)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,&DAT_180085928,0x21,local_res20,4,&param_5,4,&param_6,8,0);
return;
}
=========================================
Function at address: 0x180073b6c
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_180073b6c(undefined8 param_1,undefined2 param_2,undefined8 param_3,undefined8 param_4)

{
undefined8 local_res20;

local_res20 = param_4;
EtwTraceMessage(param_1,0x2b,&DAT_180085928,param_2,&local_res20,8,0);
return;
}
=========================================
Function at address: 0x180073bb4
Called functions addresses: 0x180041cdc 0x180028d90 0xEXTERNAL:00000041 0xEXTERNAL:0000013d


undefined8 FUN_180073bb4(longlong param_1)

{
BOOL BVar1;
DWORD DVar2;
HCERTCHAINENGINE local_res10 [3];
_CERT_CHAIN_ENGINE_CONFIG local_68;
undefined8 local_28;
uint local_18;

memset(&local_68,0,0x58);
local_res10[0] = (HCERTCHAINENGINE)0x0;
local_68.cbSize = 0x58;
local_68.dwFlags = 0x38;
if (DAT_180092788 == 0) {
return 1;
}
if (DAT_180092788 != 1) {
if (DAT_180092788 != 2) goto LAB_180073c0d;
local_18 = local_18 | 1;
}
local_28 = *(undefined8 *)(param_1 + 0x330);
LAB_180073c0d:
BVar1 = CertCreateCertificateChainEngine(&local_68,local_res10);
if (BVar1 == 0) {
DVar2 = GetLastError();
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],10,&DAT_180085948,DVar2);
}
return 1;
}
return local_res10[0];
}
=========================================
Function at address: 0x180073c88
Called functions addresses: 0x180074430 0x180041cdc 0xEXTERNAL:0000012b 0x180041cb0 0xEXTERNAL:000000bc 0xEXTERNAL:000000c0 0x180073fe8 0x180041d20 0x18000f5c0 0x18002a7c0 0x180041e9c


undefined8 FUN_180073c88(longlong *param_1,undefined8 param_2,undefined8 param_3,undefined8 param_4)

{
uint uVar1;
longlong lVar2;
longlong lVar3;
uint uVar4;
PCCERT_CONTEXT pCertContext;
DWORD DVar5;
int iVar6;
uint uVar7;
undefined *puVar8;
int local_res8;
undefined4 uStackX_c;
longlong local_res10;
PCCERT_CONTEXT local_res18;
undefined8 in_stack_ffffffffffffffb8;

local_res18 = (PCCERT_CONTEXT)0x0;
local_res8 = -0x7ff6fcdb;
lVar2 = *(longlong *)(param_1[10] + 0x2f0);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 0x20) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x11,&DAT_180085948);
}

lVar3 = param_1[10];
if (((*(uint *)(param_1 + 0x11) >> 0x10 & 1) == 0) ||
((lVar3 != 0 && (*(longlong *)(lVar3 + 0x350) != 0)))) {
RtlAcquireResourceExclusive(local_res10 + 0x48,1);
DVar5 = FUN_18000f5c0(*(uint **)(local_res10 + 0x18),*(DWORD *)(local_res10 + 0x20),&local_res18
);
pCertContext = local_res18;
if (DVar5 == 0) {
if ((lVar3 != 0) && (*(longlong *)(lVar3 + 0x350) != 0)) {
FUN_180073fe8(lVar3,local_res18,&local_res8,param_4);
*(undefined4 *)(local_res10 + 0xdc) = 0;
*(int *)(local_res10 + 0xd8) = local_res8;
}
if ((*(uint *)(param_1 + 0x11) >> 0x10 & 1) == 0) {
uVar1 = *(uint *)(lVar3 + 0xa0);
uVar7 = (uVar1 & 0x100) << 0x10;
uVar4 = uVar7 | 0x2000000;
if ((uVar1 & 0x200) == 0) {
uVar4 = uVar7;
}
uVar7 = uVar4 | 0x4000000;
if ((uVar1 & 0x400) == 0) {
uVar7 = uVar4;
}
uVar4 = uVar7 | 0x8000000;
if ((uVar1 & 0x800) == 0) {
uVar4 = uVar7;
}
uVar7 = uVar4 | 0x10000000;
if ((uVar1 & 0x1000) == 0) {
uVar7 = uVar4;
}
uVar4 = uVar7 | 0x200000;
if ((uVar1 & 0x2000) == 0) {
uVar4 = uVar7;
}
puVar8 = (undefined *)(ulonglong)(uVar1 & 0x4000);
uVar7 = uVar4 | 0x400000;
if ((uVar1 & 0x4000) == 0) {
uVar7 = uVar4;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
puVar8 = &DAT_180085948;
FUN_180041cb0(DAT_180091000[2],0x14,&DAT_180085948);
}
iVar6 = FUN_180074430(lVar3,param_1[0x74],puVar8,lVar2,uVar7,pCertContext,
in_stack_ffffffffffffffb8,(wchar_t *)param_1[0x74],
(wchar_t *)param_1[0x75],(undefined8 *)&local_res8);
if (iVar6 < 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0x16,&DAT_180085948,iVar6);
}
*(int *)(local_res10 + 0x160) = iVar6;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041e9c(DAT_180091000[2],0x15,&DAT_180085948,*(undefined8 *)(local_res10 + 0x158))
;
}
*(ulonglong *)(local_res10 + 0x158) = CONCAT44(uStackX_c,local_res8);
*(undefined4 *)(local_res10 + 0x160) = 0;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0x13,&DAT_180085948);
}
CertFreeCertificateContext(pCertContext);
}
RtlReleaseResource(local_res10 + 0x48);
}
else {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_180041cb0(DAT_180091000[2],0x12,&DAT_180085948);
}
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041d20(DAT_180091000[2],0x17,&DAT_180085948,0,0);
}
return 0;
}
=========================================
Function at address: 0x180073fe8
Called functions addresses: 0x180054f60 0xEXTERNAL:00000146 0xEXTERNAL:0000014c 0x1800555a0 0xEXTERNAL:00000145 0x180028070 0x180073bb4 0xEXTERNAL:0000014b 0x180041cdc 0x180041cb0 0xEXTERNAL:00000041 0x180028d90 0x180043384 0x1800744c0


void FUN_180073fe8(longlong param_1,PCCERT_CONTEXT param_2,int *param_3,undefined8 param_4)

{
longlong lVar1;
BOOL BVar2;
DWORD DVar3;
HCERTCHAINENGINE hChainEngine;
ulonglong uVar4;
longlong lVar5;
HCERTCHAINENGINE pvVar6;
undefined8 uVar7;
int iVar8;
PCERT_CHAIN_POLICY_PARA pPolicyPara;
HCERTSTORE hAdditionalStore;
PCERT_CHAIN_POLICY_STATUS pPolicyStatus;
char *pcVar9;
bool bVar10;
undefined auStackY_148 [32];
PCCERT_CHAIN_CONTEXT local_108;
_CERT_CHAIN_POLICY_STATUS local_100;
char *local_e8;
_CERT_CHAIN_POLICY_PARA local_e0;
undefined4 local_d0;
undefined4 local_cc;
undefined8 local_c8;
undefined8 local_c0;
_CERT_CHAIN_PARA local_b8;
undefined4 local_80;
undefined4 local_7c;
undefined4 local_78;
_EVENT_DATA_DESCRIPTOR local_58;
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStackY_148;
lVar1 = *(longlong *)(param_1 + 0x350);
local_e8 = "1.3.6.1.5.5.7.3.2";
local_108 = (PCCERT_CHAIN_CONTEXT)0x0;
if (lVar1 == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xb,&DAT_180085948);
}
goto LAB_180074406;
}
uVar7 = 0x60;
memset(&local_b8,0,0x60);
local_b8.cbSize = 0x60;
local_80 = *(undefined4 *)(lVar1 + 0x14);
local_7c = *(undefined4 *)(lVar1 + 0x18);
local_78 = *(undefined4 *)(lVar1 + 0x1c);
bVar10 = *(int *)(lVar1 + 0x20) != 1;
local_b8.RequestedUsage.dwType = 0;
if (bVar10) {
local_b8.RequestedUsage.Usage.rgpszUsageIdentifier = &local_e8;
}
else {
local_b8.RequestedUsage.Usage.rgpszUsageIdentifier = (char **)0x0;
}
local_b8.RequestedUsage.Usage.cUsageIdentifier = (DWORD)bVar10;
DVar3 = *(DWORD *)(lVar1 + 0x10);
lVar5 = param_1;
hChainEngine = (HCERTCHAINENGINE)FUN_180073bb4(param_1);
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(lVar5,(PCEVENT_DESCRIPTOR)&DAT_180084c90,uVar7,param_4,&local_58);
}
hAdditionalStore = param_2->hCertStore;
uVar7 = 0;
pvVar6 = hChainEngine;
BVar2 = CertGetCertificateChain
(hChainEngine,param_2,(LPFILETIME)0x0,hAdditionalStore,&local_b8,DVar3,
(LPVOID)0x0,&local_108);
if (BVar2 == 0) {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(pvVar6,(PCEVENT_DESCRIPTOR)&DAT_180084c80,uVar7,hAdditionalStore,&local_58);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
DVar3 = GetLastError();
FUN_180041cdc(DAT_180091000[2],0xc,&DAT_180085948,DVar3);
}
local_108 = (PCCERT_CHAIN_CONTEXT)0x0;
}
else {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(pvVar6,(PCEVENT_DESCRIPTOR)&DAT_180084c80,uVar7,hAdditionalStore,&local_58);
}
local_e0.pvExtraPolicyPara = &local_d0;
local_c8 = 0;
local_d0 = 0x18;
local_cc = 1;
local_c0 = 0;
local_e0.cbSize = 0x10;
local_e0.dwFlags = 0;
local_100.pvExtraPolicyStatus = (void *)0x0;
local_100.lChainIndex = 0;
local_100.lElementIndex = 0;
local_100.cbSize = 0x18;
local_100.dwError = 0;
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(0,(PCEVENT_DESCRIPTOR)&DAT_180084c70,uVar7,hAdditionalStore,&local_58);
}
pPolicyStatus = &local_100;
pPolicyPara = &local_e0;
uVar7 = 4;
BVar2 = CertVerifyCertificateChainPolicy((LPCSTR)0x4,local_108,pPolicyPara,pPolicyStatus);
if (BVar2 == 0) {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar7,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,&local_58);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xd,&DAT_180085948,local_100.dwError);
}
}
else {
if ((DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar7,(PCEVENT_DESCRIPTOR)&DAT_180084c60,pPolicyPara,pPolicyStatus,&local_58);
}
uVar4 = (ulonglong)local_100.dwError;
if (local_100.dwError == 0x80092012) {
uVar4 = 0;
}
iVar8 = (int)uVar4;
local_100.dwError = iVar8;
if (iVar8 == 0) {
if (local_108->cChain == 0) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xf,&DAT_180085948);
}
}
else if (-1 < DAT_180092788) {
if (DAT_180092788 < 2) {
uVar4 = FUN_1800555a0(param_1,(longlong)local_108);
if ((char)uVar4 != '\0') goto LAB_18007439c;
}
else if (DAT_180092788 == 2) {
LAB_18007439c:
*param_3 = 0;
}
}
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800744c0(DAT_180091000[2],uVar4,pPolicyPara,iVar8,(char)param_1,
(char)*(undefined4 *)(lVar1 + 0x20));
uVar4 = (ulonglong)local_100._0_8_ >> 0x20;
}
*param_3 = (int)uVar4;
}
}
if (local_108 != (PCCERT_CHAIN_CONTEXT)0x0) {
CertFreeCertificateChain(local_108);
}
}
if (hChainEngine != (HCERTCHAINENGINE)0x1) {
CertFreeCertificateChainEngine(hChainEngine);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
pcVar9 = "FOUND";
if (*param_3 != 0) {
pcVar9 = "DID NOT FIND";
}
FUN_180043384(DAT_180091000[2],0x10,&DAT_180085948,pcVar9);
}
LAB_180074406:
FUN_180028070(local_48 ^ (ulonglong)auStackY_148);
return;
}
=========================================
Function at address: 0x180074430
Called functions addresses: 0x18004a534 0x180001674 0x180048dd8


void FUN_180074430(longlong param_1,ulonglong param_2,undefined8 param_3,longlong param_4,
uint param_5,PCCERT_CONTEXT param_6,undefined8 param_7,wchar_t *param_8,
wchar_t *param_9,undefined8 *param_10)

{
uint uVar1;
HANDLE in_stack_ffffffffffffffd8;
ulonglong uVar2;

if (DAT_1800919a0 == 0) {
uVar2 = FUN_18004a534(param_1,param_2,1,param_4,param_5,param_6,in_stack_ffffffffffffffd8,
param_8,param_9,param_10);
uVar1 = (uint)uVar2;
}
else {
uVar2 = FUN_180048dd8(param_1,0,1,param_4,param_5,param_6,0,param_8,param_9,param_10);
uVar1 = (uint)uVar2;
}
FUN_180001674(uVar1,0x8009030b,0,(undefined *)0x0);
return;
}
=========================================
Function at address: 0x1800744c0
Called functions addresses: 0xEXTERNAL:000000cc


void FUN_1800744c0(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 param_4,
undefined param_5,undefined param_6)

{
undefined4 local_res20 [2];

local_res20[0] = param_4;
EtwTraceMessage(param_1,0x2b,&DAT_180085948,0xe,local_res20,4,&param_5,8,&param_6,4,0);
return;
}
=========================================
Function at address: 0x18007452c
Called functions addresses: 0x18000909c 0xEXTERNAL:00000121 0x18005c384


int FUN_18007452c(DWORD *param_1,NCRYPT_KEY_HANDLE *param_2)

{
PBYTE pBVar1;
int iVar2;
DWORD local_res18 [2];
PBYTE local_res20;

local_res20 = (PBYTE)0x0;
iVar2 = FUN_18005c384(param_1,&local_res20,local_res18);
pBVar1 = local_res20;
if ((iVar2 == 0) &&
(iVar2 = NCryptImportKey(DAT_1800925a8,0,L"CAPIDSAPUBLICBLOB",(NCryptBufferDesc *)0x0,param_2,
local_res20,local_res18[0],8), pBVar1 != (PBYTE)0x0)) {
FUN_18000909c(pBVar1);
}
return iVar2;
}
=========================================
Function at address: 0x1800745b4
Called functions addresses: 0x18002a77b 0x18005c734 0x1800051c0 0x180075660 0x180005298 0xEXTERNAL:0000011c 0x18002a700 0x180028070 0x180004308 0xEXTERNAL:00000122 0x1800024d0 0x18000909c 0x180028d90 0x18000a418 0x18005b470 0x1800751b8 0x180009ed4 0x18002a7c0


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_1800745b4(longlong *param_1,PUCHAR param_2,uint param_3,undefined *param_4,uint *param_5)

{
ushort *puVar1;
longlong lVar2;
uint uVar3;
void *_Src;
int iVar4;
undefined8 *puVar5;
undefined8 uVar6;
undefined4 *puVar7;
undefined4 *puVar8;
ulonglong uVar9;
longlong *plVar10;
undefined *puVar11;
ulonglong uVar12;
uint uVar13;
undefined4 uVar14;
undefined *puVar15;
undefined *puVar16;
PUCHAR pUVar17;
undefined uVar18;
uint uVar19;
ushort *puVar20;
int iVar21;
longlong lVar22;
ushort *puVar23;
undefined auStackY_e8 [32];
uint local_98;
ushort local_94;
int local_90 [6];
longlong local_78;
longlong local_70;
uint local_68;
uint local_64;
undefined8 local_60;
void *local_58;
undefined *local_50;
ushort *local_48;
ushort *local_40;
PUCHAR local_38;
ulonglong local_30;

puVar16 = auStackY_e8;
puVar15 = auStackY_e8;
puVar11 = auStackY_e8;
local_30 = DAT_180091970 ^ (ulonglong)&local_98;
puVar8 = (undefined4 *)0x0;
local_78 = 0;
local_90[4] = 0;
local_70 = 0;
local_58 = (void *)0x0;
local_60 = 0;
local_90[1] = 0;
local_90[3] = 0;
local_50 = param_4;
if (*(int *)(param_1[1] + 0x34) == 2) {
iVar21 = 1;
}
else {
if (*(int *)(param_1[1] + 0x34) != 3) goto LAB_180074c0a;
iVar21 = 2;
}
puVar16 = auStackY_e8;
if (param_2 == (PUCHAR)0x0) goto LAB_180074c0a;
local_40 = (ushort *)(param_2 + 2);
puVar23 = (ushort *)(param_2 + param_3);
if (puVar23 < local_40) {
LAB_180074be9:
uVar14 = 0x327;
LAB_180074bee:
uVar18 = 0x32;
LAB_180074bf1:
iVar21 = -0x7ff6fcf8;
}
else {
uVar19 = (uint)CONCAT11(*param_2,param_2[1]);
uVar13 = uVar19 + 2;
pUVar17 = param_2 + uVar13;
local_48 = (ushort *)(pUVar17 + 2);
if (puVar23 < local_48) goto LAB_180074be9;
local_68 = (uint)CONCAT11(*pUVar17,pUVar17[1]);
pUVar17 = pUVar17 + (local_68 + 2);
if (puVar23 < pUVar17 + 2) goto LAB_180074be9;
local_64 = (uint)CONCAT11(*pUVar17,pUVar17[1]);
local_38 = pUVar17 + 2;
puVar20 = (ushort *)(pUVar17 + (local_64 + 2));
puVar1 = puVar20 + 1;
if ((puVar23 < puVar1) || (local_64 + 2 < local_64)) goto LAB_180074be9;
if (param_4 == (undefined *)0x0) {
*param_5 = uVar13;
puVar16 = auStackY_e8;
goto LAB_180074c0a;
}
puVar16 = auStackY_e8;
if (*param_5 < uVar13) goto LAB_180074c0a;
local_90[2] = (int)puVar20 - (int)param_2;
if ((*(uint *)(param_1 + 8) & 0x80800) != 0) {
if (puVar23 < puVar20 + 2) {
uVar14 = 0x336;
goto LAB_180074bee;
}
local_94 = *puVar20;
puVar7 = (undefined4 *)0x0;
uVar12 = FUN_180005298((longlong)param_1 + 0x1da,local_94,*(uint *)(param_1 + 8),0);
if ((char)uVar12 == '\0') {
uVar18 = 0x2f;
}
else {
local_90[0] = 0;
FUN_1800051c0(local_94,local_90,local_90 + 1,puVar7,&local_60,(uint *)0x0,local_90 + 3);
if ((local_90[0] == iVar21) && ((puVar20 = puVar1, local_90[0] != 2 || (local_90[1] == 2))))
goto LAB_1800747b4;
uVar18 = 0x28;
}
uVar14 = 0x336;
goto LAB_180074bf1;
}
LAB_1800747b4:
uVar13 = (uint)CONCAT11(*(undefined *)puVar20,*(undefined *)((longlong)puVar20 + 1));
if ((ushort *)((longlong)puVar20 + (ulonglong)uVar13 + 2) != puVar23) goto LAB_180074be9;
if (iVar21 != 1) {
puVar16 = auStackY_e8;
if (iVar21 != 2) goto LAB_180074c0a;
iVar21 = FUN_180075660(param_1,param_2,local_90[2],(BYTE *)(puVar20 + 1),uVar13);
if (iVar21 != 0) {
uVar18 = 0x33;
uVar14 = 0x337;
goto LAB_180074bf6;
}
LAB_180074851:
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(puVar5 = (undefined8 *)param_1[1], puVar5 == (undefined8 *)0x0)) {
puVar5 = (undefined8 *)param_1[1];
uVar14 = 0;
if (puVar5 != (undefined8 *)0x0) goto LAB_180074875;
uVar6 = 0;
}
else {
uVar14 = *(undefined4 *)((longlong)puVar5 + 0x1c);
LAB_180074875:
uVar6 = *puVar5;
}
iVar4 = FUN_1800751b8(uVar6,uVar14,(uint)*(ushort *)((longlong)param_1 + 0x22),uVar19,
(undefined *)local_40,local_68,(undefined *)local_48,&local_70,
(uint *)(local_90 + 4));
iVar21 = local_90[4];
if (iVar4 == 0) {
uVar13 = *(uint *)(param_1[10] + 0xc4);
if ((uVar13 == 0) ||
(uVar6 = FUN_18005c734(*(uint **)(param_1[10] + 200),uVar13,local_90[4],0,'\x01'),
(char)uVar6 == '\0')) {
lVar22 = local_70;
*(int *)(param_1[0xa5] + 8) = iVar21;
if ((undefined8 *)param_1[1] == (undefined8 *)0x0) {
uVar6 = 0;
}
else {
uVar6 = *(undefined8 *)param_1[1];
}
iVar21 = FUN_180009ed4(uVar6,local_70,L"DHPUBLICBLOB",&local_98,(longlong *)&local_58);
_Src = local_58;
puVar7 = puVar8;
if (iVar21 == 0) {
uVar12 = (ulonglong)local_98;
puVar15 = auStackY_e8;
if ((((local_98 == 0) ||
(puVar15 = auStackY_e8, puVar7 = (undefined4 *)0x0, DAT_1800920e0 < uVar12)) ||
(uVar9 = DAT_1800920e8 + 8 + uVar12, puVar15 = auStackY_e8, uVar9 < uVar12)) ||
(uVar6 = FUN_18000a418(uVar9), puVar15 = auStackY_e8, puVar7 = puVar8,
(int)uVar6 == 0)) {
LAB_180074a17:
uVar13 = local_98 + 8;
if (uVar13 < local_98) {
LAB_180074a4c:
puVar11 = puVar15;
if (puVar7 != (undefined4 *)0x0) goto LAB_1800749f6;
}
else {
*(undefined8 *)(puVar15 + -8) = 0x180074a37;

if (puVar7 != (undefined4 *)0x0) {
*puVar7 = 0x70616548;
puVar7 = puVar7 + 2;
goto LAB_180074a4c;
}
}
}
else {
uVar12 = (ulonglong)(local_98 + 8) + 0xf;
if (uVar12 <= local_98 + 8) {
uVar12 = 0xffffffffffffff0;
}
lVar2 = -(uVar12 & 0xfffffffffffffff0);
puVar7 = (undefined4 *)((longlong)&local_98 + lVar2);
puVar15 = auStackY_e8 + lVar2;
if (puVar7 == (undefined4 *)0x0) goto LAB_180074a17;
*puVar7 = 0x6b637453;
puVar7 = (undefined4 *)((longlong)local_90 + lVar2);
puVar15 = auStackY_e8 + lVar2;
puVar11 = auStackY_e8 + lVar2;
if (puVar7 == (undefined4 *)0x0) goto LAB_180074a17;
LAB_1800749f6:
puVar15 = puVar11;
uVar3 = local_64;
uVar12 = (ulonglong)local_64;
uVar13 = uVar19 * 2 + 8;
if (uVar13 + local_64 <= local_98) {
*(undefined8 *)(puVar15 + -8) = 0x180074a6b;
memcpy(puVar7,_Src,(ulonglong)uVar13);
uVar19 = uVar19 - uVar3;
if (uVar19 != 0) {
*(undefined8 *)(puVar15 + -8) = 0x180074a7e;
memset((void *)((ulonglong)uVar13 + (longlong)puVar7),0,(ulonglong)uVar19);
}
pUVar17 = local_38;
*(undefined8 *)(puVar15 + -8) = 0x180074a93;
memcpy((void *)((ulonglong)uVar19 + (ulonglong)uVar13 + (longlong)puVar7),pUVar17,
uVar12);
plVar10 = (longlong *)param_1[1];
if (plVar10 != (longlong *)0x0) {
plVar10 = (longlong *)*plVar10;
}
*(undefined4 *)(puVar15 + 0x28) = 0;
*(uint *)(puVar15 + 0x20) = local_98;
*(undefined8 *)(puVar15 + -8) = 0x180074ac0;
iVar21 = SslImportKey(plVar10,&local_78,L"DHPUBLICBLOB");
if (iVar21 != 0) {
uVar14 = 0x32a;
goto LAB_180074970;
}
uVar13 = *(uint *)((longlong)_Src + 4);
uVar19 = *param_5;
*param_5 = uVar13 + 2;
if (uVar13 + 2 <= uVar19) {
local_50[1] = (char)uVar13;
*local_50 = (char)(uVar13 >> 8);
puVar11 = local_50 + 2;
*(undefined8 *)(puVar15 + -8) = 0x180074b19;
memcpy(puVar11,(void *)((longlong)_Src + (ulonglong)uVar13 * 2 + 8),
(ulonglong)uVar13);
lVar2 = local_78;
if ((*(uint *)(param_1 + 0x11) >> 0x1b & 1) == 0) {
*(undefined8 *)(puVar15 + -8) = 0x180074b83;
FUN_1800024d0(param_1,lVar22,lVar2,(ushort *)0x0);
}
else {
*(undefined8 *)(puVar15 + -8) = 0x180074b47;

*(undefined8 *)(puVar15 + -8) = 0x180074b67;

local_78 = 0;
lVar22 = 0;
}
}
}
}
}
else {
uVar14 = 0x329;
LAB_180074970:
*(undefined8 *)(puVar15 + -8) = 0x180074981;
FUN_18005b470(param_1,uVar14,iVar21,0x33);
}
if (_Src != (void *)0x0) {
*(undefined8 *)(puVar15 + -8) = 0x180074b92;
FUN_18000909c(_Src);
}
puVar11 = puVar15;
if ((puVar7 != (undefined4 *)0x0) && (puVar7[-2] == 0x70616548)) {
*(undefined8 *)(puVar15 + -8) = 0x180074bba;

}
}
else {
FUN_18005b470(param_1,0x328,0,0x28);
lVar22 = local_70;
}
}
else {
uVar18 = 0x33;
if (iVar4 == 0x57) {
uVar18 = 0x28;
}
FUN_18005b470(param_1,0x328,iVar4,uVar18);
puVar11 = auStackY_e8;
lVar22 = local_70;
}
if (lVar22 != 0) {
*(undefined8 *)(puVar11 + -8) = 0x180074bcb;
SslFreeObject(lVar22,0);
}
lVar22 = local_78;
puVar16 = puVar11;
if (local_78 != 0) {
*(undefined8 *)(puVar11 + -8) = 0x180074be2;
SslFreeObject(lVar22,0);
}
goto LAB_180074c0a;
}
iVar21 = FUN_180004308(param_1,param_2,local_90[2],local_60,local_90[1],local_90[3],
(PUCHAR)(puVar20 + 1),uVar13);
if (iVar21 == 0) goto LAB_180074851;
uVar18 = 0x33;
uVar14 = 0x322;
}
LAB_180074bf6:
FUN_18005b470(param_1,uVar14,iVar21,uVar18);
puVar16 = auStackY_e8;
LAB_180074c0a:
uVar12 = local_30 ^ (ulonglong)&local_98;
*(undefined8 *)(puVar16 + -8) = 0x180074c16;
FUN_180028070(uVar12);
return;
}
=========================================
Function at address: 0x180074c40
Called functions addresses: 0x1800754f8 0x18002a77b 0x18005e400 0x180001604 0xEXTERNAL:00000047 0x1800051c0 0x180075800 0x18005b470 0x18001a450 0x180075b20 0x18002a7c0


int FUN_180074c40(longlong *param_1,PUCHAR param_2,uint *param_3)

{
_FILETIME *p_Var1;
longlong lVar2;
ushort uVar3;
int iVar4;
int iVar5;
longlong lVar6;
int unaff_EBX;
UCHAR *pUVar7;
ulonglong uVar8;
uint uVar9;
uint uVar10;
ushort *puVar11;
uint uVar12;
UCHAR UVar13;
ULONG UVar14;
void *pvVar15;
ushort local_res8;
DWORD local_res20 [2];
int local_68;
uint local_64;
uint local_60;
int local_5c;
int local_58;
int local_54;
void *local_50 [2];

local_res20[0] = 0;
local_58 = 0;
local_50[0] = (void *)0x0;
local_68 = 0;
local_res8 = 0;
local_5c = 0;
if (*(int *)(param_1[1] + 0x34) == 2) {
uVar9 = 1;
}
else {
if (*(int *)(param_1[1] + 0x34) != 3) goto LAB_180074f3c;
uVar9 = 2;
}
p_Var1 = (_FILETIME *)(param_1 + 0x78);
local_60 = uVar9;
if ((*p_Var1 == (_FILETIME)0x0) && (iVar4 = FUN_180075800(param_1,p_Var1), iVar4 != 0)) {
return unaff_EBX;
}
lVar2 = *(longlong *)((longlong)*p_Var1 + 0x10);
uVar10 = *(uint *)(lVar2 + 4);
local_54 = uVar10 * 3;
iVar4 = local_54 + 0xc;
local_64 = uVar10;
if ((*(uint *)(param_1 + 8) & 0x40400) != 0) {
iVar4 = local_54 + 0xe;

if (lVar6 == 0) {
return unaff_EBX;
}
uVar3 = FUN_18005e400((longlong)param_1 + 0x1fe,uVar9,*(uint *)(lVar6 + 0x1ac),
*(uint *)(param_1 + 8),0);
local_res8 = uVar3 >> 8 | uVar3 << 8;
if (local_res8 == 0) {
return unaff_EBX;
}
FUN_1800051c0(local_res8,(undefined4 *)0x0,&local_68,(undefined4 *)0x0,local_50,(uint *)0x0,
&local_5c);
}
iVar5 = FUN_180075b20(param_1,uVar9,local_68,local_res20);
uVar9 = local_64;
if (iVar5 < 0) {
FUN_18005b470(param_1,0x41b,iVar5,0x50);
return unaff_EBX;
}
uVar12 = 0x8c;
if (0x8c < local_res20[0]) {
uVar12 = local_res20[0];
}
uVar12 = iVar4 + uVar12;
if (param_2 == (PUCHAR)0x0) {
*param_3 = uVar12;
return unaff_EBX;
}
if (*param_3 < uVar12) {
*param_3 = uVar12;
return unaff_EBX;
}
pvVar15 = (void *)(lVar2 + 8);
UVar13 = (UCHAR)(uVar10 >> 8);
*param_2 = UVar13;
param_2[1] = (UCHAR)local_64;
uVar8 = (ulonglong)local_64;
memcpy(param_2 + 2,pvVar15,(ulonglong)local_64);
uVar10 = uVar9 + 2;
pUVar7 = param_2 + uVar10;
pvVar15 = (void *)((longlong)pvVar15 + uVar8);
*pUVar7 = UVar13;
pUVar7[1] = (UCHAR)local_64;
memcpy(pUVar7 + 2,pvVar15,(ulonglong)uVar9);
pUVar7 = pUVar7 + uVar10;
*pUVar7 = UVar13;
pUVar7[1] = (UCHAR)local_64;
memcpy(pUVar7 + 2,(void *)(uVar8 + (longlong)pvVar15),(ulonglong)uVar9);
uVar9 = local_60;
puVar11 = (ushort *)(pUVar7 + uVar10);
UVar14 = (int)puVar11 - (int)param_2;
local_res20[0] = (uVar12 - local_54) - 6;
if ((*(uint *)(param_1 + 8) & 0x40400) != 0) {
if ((local_60 == 2) && (local_68 != 2)) {
return unaff_EBX;
}
if (local_res20[0] < 2) {
return unaff_EBX;
}
*puVar11 = local_res8;
puVar11 = puVar11 + 1;
local_res20[0] = (uVar12 - local_54) - 8;
}
local_res20[0] = local_res20[0] - 2;
iVar4 = FUN_180001604(*(longlong *)(param_1[10] + 0x2f0),&local_58);
if (iVar4 == 0) {
if (uVar9 == 1) {
iVar4 = FUN_18001a450(param_1,param_2,UVar14,local_50[0],local_68,local_5c,puVar11 + 1,
local_res20);
}
else {
if (uVar9 != 2) goto LAB_180074f3c;
iVar4 = FUN_1800754f8(param_1,param_2,UVar14,(BYTE *)(puVar11 + 1),local_res20);
}
if (iVar4 == 0) {
*(UCHAR *)puVar11 = (UCHAR)(local_res20[0] >> 8);
*(UCHAR *)((longlong)puVar11 + 1) = (UCHAR)local_res20[0];
*param_3 = local_res20[0] + 2 + ((int)puVar11 - (int)param_2);
}
}
LAB_180074f3c:
if (local_58 != 0) {
RevertToSelf();
}
return unaff_EBX;
}
=========================================
Function at address: 0x180074f68
Called functions addresses: 0x18002a77b 0xEXTERNAL:0000011c 0x18002a700 0x18000a418 0x18005b470 0x180028070 0x18002a7c0 0x1800024d0 0xEXTERNAL:00000122


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_180074f68(longlong *param_1,undefined *param_2,uint param_3)

{
uint uVar1;
void *_Src;
longlong lVar2;
int iVar3;
undefined8 uVar4;
ulonglong uVar5;
undefined4 *puVar6;
ulonglong uVar7;
longlong *plVar8;
uint uVar9;
undefined4 uVar10;
undefined *puVar11;
undefined *puVar12;
undefined uVar13;
undefined4 *puVar14;
undefined auStack_58 [48];
longlong local_28;
ulonglong local_20;

local_20 = DAT_180091970 ^ (ulonglong)&local_28;
local_28 = 0;
puVar6 = (undefined4 *)0x0;
uVar1 = *(uint *)(param_1[0x78] + 0x18);
uVar5 = (ulonglong)uVar1;
puVar11 = auStack_58;
if ((((uVar1 == 0) || (puVar11 = auStack_58, DAT_1800920e0 < uVar5)) ||
(uVar7 = DAT_1800920e8 + 8 + uVar5, puVar11 = auStack_58, uVar7 < uVar5)) ||
(uVar4 = FUN_18000a418(uVar7), puVar6 = (undefined4 *)0x0, puVar11 = auStack_58,
(int)uVar4 == 0)) {
LAB_180075015:
if (uVar1 <= uVar1 + 8) {
*(undefined8 *)(puVar11 + -8) = 0x180075035;

if (puVar6 == (undefined4 *)0x0) goto LAB_18007516f;
*puVar6 = 0x70616548;
puVar6 = puVar6 + 2;
}
puVar12 = puVar11;
if (puVar6 == (undefined4 *)0x0) goto LAB_18007516f;
}
else {
uVar5 = (ulonglong)(uVar1 + 8) + 0xf;
if (uVar5 <= uVar1 + 8) {
uVar5 = 0xffffffffffffff0;
}
lVar2 = -(uVar5 & 0xfffffffffffffff0);
puVar6 = (undefined4 *)((longlong)&local_28 + lVar2);
puVar11 = auStack_58 + lVar2;
if (puVar6 == (undefined4 *)0x0) goto LAB_180075015;
*puVar6 = 0x6b637453;
puVar6 = (undefined4 *)((longlong)&local_20 + lVar2);
puVar11 = auStack_58 + lVar2;
puVar12 = auStack_58 + lVar2;
if (puVar6 == (undefined4 *)0x0) goto LAB_180075015;
}
_Src = *(void **)(param_1[0x78] + 0x10);
*(undefined8 *)(puVar12 + -8) = 0x18007506f;
memcpy(puVar6,_Src,(ulonglong)uVar1);
if (((param_2 == (undefined *)0x0) || (param_3 < 3)) ||
((uVar9 = (uint)CONCAT11(*param_2,param_2[1]), uVar9 + 2 != param_3 || (uVar9 == 0)))) {
iVar3 = -0x7ff6fcf8;
uVar10 = 0x2c0;
uVar13 = 0x32;
LAB_180075142:
*(undefined8 *)(puVar12 + -8) = 0x180075147;
FUN_18005b470(param_1,uVar10,iVar3,uVar13);
}
else if ((ulonglong)(uVar9 * 3) + 8 <= (ulonglong)uVar1) {
*(undefined8 *)(puVar12 + -8) = 0x1800750ce;
memcpy((void *)((longlong)puVar6 + ((ulonglong)uVar9 + 4) * 2),param_2 + 2,(ulonglong)uVar9);
plVar8 = (longlong *)param_1[1];
if (plVar8 != (longlong *)0x0) {
plVar8 = (longlong *)*plVar8;
}
*(undefined4 *)(puVar12 + 0x28) = 0;
*(uint *)(puVar12 + 0x20) = uVar1;
*(undefined8 *)(puVar12 + -8) = 0x1800750f8;
puVar14 = puVar6;
iVar3 = SslImportKey(plVar8,&local_28,L"DHPUBLICBLOB",puVar6);
lVar2 = local_28;
if (iVar3 != 0) {
uVar13 = 0x33;
uVar10 = 0x2c1;
goto LAB_180075142;
}
uVar4 = *(undefined8 *)(param_1[0x78] + 8);
*(undefined8 *)(puVar12 + -8) = 0x18007512a;
FUN_1800024d0(param_1,uVar4,lVar2,(ushort *)CONCAT71((int7)((ulonglong)puVar14 >> 8),1));
}
puVar11 = puVar12;
if ((puVar6 != (undefined4 *)0x0) && (puVar6[-2] == 0x70616548)) {
*(undefined8 *)(puVar12 + -8) = 0x18007516f;

}
LAB_18007516f:
lVar2 = local_28;
if (local_28 != 0) {
*(undefined8 *)(puVar11 + -8) = 0x180075181;
SslFreeObject(lVar2,0);
}
uVar5 = local_20 ^ (ulonglong)&local_28;
*(undefined8 *)(puVar11 + -8) = 0x180075194;
FUN_180028070(uVar5);
return;
}
=========================================
Function at address: 0x1800751b8
Called functions addresses: 0x18002a77b 0x180041cdc 0x180059d38 0xEXTERNAL:00000117 0x18002a700 0x180028d90 0x18000a418 0x1800432ec 0x180028070 0x18002a7c0


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_1800751b8(undefined8 param_1,undefined4 param_2,undefined4 param_3,uint param_4,
undefined *param_5,uint param_6,undefined *param_7,undefined8 *param_8,
uint *param_9)

{
longlong lVar1;
uint uVar2;
int iVar3;
undefined4 *puVar4;
undefined8 uVar5;
ulonglong uVar6;
ulonglong uVar7;
undefined *puVar8;
undefined *puVar9;
uint uVar10;
int *piVar11;
uint uVar12;
void *_Dst;
undefined auStack_a8 [80];
uint local_58 [4];
undefined8 local_48;
undefined8 local_40;
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)local_58;
uVar12 = param_4;
local_58[1] = param_2;
local_58[2] = param_3;
local_48 = param_1;
puVar4 = FUN_180059d38(0xaa02);
if ((param_5 == (undefined *)0x0) || (param_7 == (undefined *)0x0)) {
uVar10 = puVar4[0xc];
}
else {
uVar10 = uVar12 * 8;
puVar8 = auStack_a8;
if (uVar12 < param_6) goto LAB_1800754cb;
if ((uVar10 < (uint)puVar4[8]) || ((uint)puVar4[10] < uVar10)) {
puVar8 = auStack_a8;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
(puVar8 = auStack_a8, (*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_1800432ec(DAT_180091000[2],10,&DAT_180086360,uVar10);
puVar8 = auStack_a8;
}
goto LAB_1800754cb;
}
}
piVar11 = (int *)0x0;
uVar12 = uVar10 >> 3;
local_58[0] = uVar12 * 2 + 0xc;
uVar7 = (ulonglong)local_58[0];
puVar8 = auStack_a8;
if (((DAT_1800920e0 < uVar7) ||
(uVar6 = DAT_1800920e8 + 8 + uVar7, puVar8 = auStack_a8, uVar6 < uVar7)) ||
(uVar5 = FUN_18000a418(uVar6), puVar8 = auStack_a8, (int)uVar5 == 0)) {
LAB_1800752ef:
uVar2 = uVar12 * 2 + 0x14;
if (uVar12 * 2 + 0xc <= uVar2) {
*(undefined8 *)(puVar8 + -8) = 0x180075317;

if (puVar4 == (undefined4 *)0x0) goto LAB_1800754cb;
*puVar4 = 0x70616548;
piVar11 = puVar4 + 2;
}
puVar9 = puVar8;
if (piVar11 == (int *)0x0) goto LAB_1800754cb;
}
else {
uVar2 = uVar12 * 2 + 0x14;
uVar7 = (ulonglong)uVar2 + 0xf;
if (uVar7 <= uVar2) {
uVar7 = 0xffffffffffffff0;
}
lVar1 = -(uVar7 & 0xfffffffffffffff0);
piVar11 = (int *)((longlong)local_58 + lVar1);
puVar8 = auStack_a8 + lVar1;
if (piVar11 == (int *)0x0) goto LAB_1800752ef;
*piVar11 = 0x6b637453;
piVar11 = (int *)((longlong)local_58 + lVar1 + 8);
puVar8 = auStack_a8 + lVar1;
puVar9 = auStack_a8 + lVar1;
if (piVar11 == (int *)0x0) goto LAB_1800752ef;
}
if (param_5 == (undefined *)0x0) {
param_4 = uVar12;
if (uVar10 == 0x400) {
param_5 = &DAT_1800862e0;
}
else if (uVar10 == 0x800) {
param_5 = &DAT_180086160;
}
else if (uVar10 == 0xc00) {
param_5 = &DAT_180085ee0;
}
else {
param_5 = &DAT_180085b60;
}
}
if (param_7 == (undefined *)0x0) {
param_6 = uVar12;
if (uVar10 == 0x400) {
param_7 = &DAT_180086260;
}
else if (uVar10 == 0x800) {
param_7 = &DAT_180086060;
}
else if (uVar10 == 0xc00) {
param_7 = &DAT_180085d60;
}
else {
param_7 = &DAT_180085960;
}
}
*piVar11 = uVar12 * 2 + 0xc;
piVar11[2] = param_4;
piVar11[1] = 0x4d504844;
*(undefined8 *)(puVar9 + -8) = 0x1800753dd;
memcpy(piVar11 + 3,param_5,(ulonglong)param_4);
_Dst = (void *)((longlong)(piVar11 + 3) + (ulonglong)(uint)piVar11[2]);
if (param_6 < param_4) {
*(undefined8 *)(puVar9 + -8) = 0x1800753fd;
memset(_Dst,0,(ulonglong)(param_4 - param_6));
_Dst = (void *)((longlong)_Dst + (ulonglong)(param_4 - param_6));
}
*(undefined8 *)(puVar9 + -8) = 0x18007540e;
memcpy(_Dst,param_7,(ulonglong)param_6);
*(undefined4 *)(puVar9 + 0x40) = 0;
uVar2 = local_58[2];
uVar12 = local_58[1];
*(uint *)(puVar9 + 0x38) = local_58[0];
uVar5 = local_48;
*(int **)(puVar9 + 0x30) = piVar11;
*(uint *)(puVar9 + 0x28) = param_4 * 8;
*(undefined4 *)(puVar9 + 0x20) = 0;
*(undefined8 *)(puVar9 + -8) = 0x180075447;
iVar3 = SslCreateEphemeralKey(uVar5,&local_40,uVar2,uVar12);
if (iVar3 == 0) {
*param_8 = local_40;
if (param_9 != (uint *)0x0) {
*param_9 = uVar10;
}
}
else if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
uVar5 = DAT_180091000[2];
*(undefined8 *)(puVar9 + -8) = 0x180075483;
FUN_180041cdc(uVar5,0xb,&DAT_180086360,iVar3);
}
puVar8 = puVar9;
if ((piVar11 != (int *)0x0) && (piVar11[-2] == 0x70616548)) {
*(undefined8 *)(puVar9 + -8) = 0x1800754c9;

}
LAB_1800754cb:
uVar7 = local_38 ^ (ulonglong)local_58;
*(undefined8 *)(puVar8 + -8) = 0x1800754d7;
FUN_180028070(uVar7);
return;
}
=========================================
Function at address: 0x1800754f8
Called functions addresses: 0x180001e7c 0xEXTERNAL:00000041 0xEXTERNAL:00000132 0x18005b470 0xEXTERNAL:00000116 0x180028070 0x18000a230


void FUN_1800754f8(longlong *param_1,PUCHAR param_2,ULONG param_3,BYTE *param_4,DWORD *param_5)

{
DWORD DVar1;
BOOL BVar2;
undefined8 uVar3;
uint uVar4;
undefined4 uVar5;
undefined auStackY_b8 [32];
UCHAR local_70 [24];
undefined local_58 [20];
undefined local_44 [20];
ulonglong local_30;

local_30 = DAT_180091970 ^ (ulonglong)auStackY_b8;
if (param_1[3] != 0) {
DVar1 = FUN_18000a230(DAT_180092a50,(longlong)param_1,param_2,param_3,local_70,0x14);
if (DVar1 == 0) {
if ((undefined8 *)param_1[1] == (undefined8 *)0x0) {
uVar3 = 0;
}
else {
uVar3 = *(undefined8 *)param_1[1];
}
DVar1 = SslSignHash(uVar3,*(undefined8 *)(param_1[3] + 8),local_70,0x14);
if (DVar1 == 0) {
uVar4 = 0x14;
FUN_180001e7c(local_58,0x14);
FUN_180001e7c(local_44,uVar4);
BVar2 = CryptEncodeObject(1,(LPCSTR)0x28,local_58,param_4,param_5);
if (BVar2 != 0) goto LAB_18007563c;
DVar1 = GetLastError();
uVar5 = 0x459;
}
else {
uVar5 = 0x458;
}
}
else {
uVar5 = 0x457;
}
FUN_18005b470(param_1,uVar5,DVar1,0x50);
}
LAB_18007563c:
FUN_180028070(local_30 ^ (ulonglong)auStackY_b8);
return;
}
=========================================
Function at address: 0x180075660
Called functions addresses: 0x180001e7c 0xEXTERNAL:000000f1 0x18007452c 0xEXTERNAL:00000041 0xEXTERNAL:000000c2 0x18005b470 0x180028070 0xEXTERNAL:000000c0 0xEXTERNAL:0000014e 0xEXTERNAL:00000108 0x18000a230


void FUN_180075660(longlong *param_1,PUCHAR param_2,ULONG param_3,BYTE *param_4,DWORD param_5)

{
BOOL BVar1;
DWORD DVar2;
ULONG UVar3;
undefined4 uVar4;
undefined uVar5;
undefined auStackY_c8 [32];
DWORD local_88 [2];
NCRYPT_KEY_HANDLE local_80;
UCHAR local_78 [24];
BYTE local_60 [20];
undefined local_4c [20];
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_c8;
local_80 = 0;
local_88[0] = 0x28;
BVar1 = CryptDecodeObject(1,(LPCSTR)0x28,param_4,param_5,0,local_60,local_88);
if (BVar1 == 0) {
DVar2 = GetLastError();
uVar5 = 0x32;
uVar4 = 0x45a;
}
else {
UVar3 = 0x14;
FUN_180001e7c(local_60,0x14);
FUN_180001e7c(local_4c,UVar3);
DVar2 = FUN_18000a230(DAT_180092a50,(longlong)param_1,param_2,param_3,local_78,UVar3);
if (DVar2 == 0) {
RtlAcquireResourceShared(param_1[0xb] + 0x48,1);
DVar2 = FUN_18007452c(*(DWORD **)(param_1[0xb] + 0x30),&local_80);
RtlReleaseResource(param_1[0xb] + 0x48);
if (DVar2 == 0) {
DVar2 = NCryptVerifySignature(local_80,(void *)0x0,local_78,0x14,local_60,local_88[0],0);
if (DVar2 == 0) goto LAB_1800757c8;
uVar5 = 0x33;
uVar4 = 0x45c;
}
else {
uVar5 = 0x2b;
uVar4 = 0x45d;
}
}
else {
uVar5 = 0x50;
uVar4 = 0x45b;
}
}
FUN_18005b470(param_1,uVar4,DVar2,uVar5);
LAB_1800757c8:
if (local_80 != 0) {
NCryptFreeObject(local_80);
}
FUN_180028070(local_38 ^ (ulonglong)auStackY_c8);
return;
}
=========================================
Function at address: 0x180075800
Called functions addresses: 0x18001a690 0x18005b470 0x18002a7c0 0x18005f670


int FUN_180075800(longlong *param_1,_FILETIME *param_2)

{
char cVar1;
int iVar2;
longlong lVar3;
ulonglong uVar4;

iVar2 = *(int *)(param_1 + 2);

cVar1 = '\0';
if (iVar2 == 0) {
uVar4 = FUN_18001a690(lVar3,0,(_FILETIME *)(lVar3 + 0x1f0),param_2);
iVar2 = (int)uVar4;
if (iVar2 == 0x57) {
cVar1 = '\x01';
goto LAB_180075851;
}
}
else {
uVar4 = FUN_18005f670(lVar3,iVar2,param_2);
iVar2 = (int)uVar4;
}
if (iVar2 == 0) {
*(undefined4 *)(param_1[0xb] + 8) = *(undefined4 *)((longlong)*param_2 + 0x28);
return 0;
}
LAB_180075851:
FUN_18005b470(param_1,0x25b,iVar2,(-cVar1 & 0xd8U) + 0x50);
return iVar2;
}
=========================================
Function at address: 0x1800758bc
Called functions addresses: 0xEXTERNAL:0000018b 0xEXTERNAL:00000102 0x180054f60 0x180001060 0x180028d90 0x18005b470 0xEXTERNAL:00000114 0xEXTERNAL:000000bc 0x180028070 0xEXTERNAL:000000c0 0x18002a7c0


void FUN_1800758bc(longlong *param_1,undefined8 param_2)

{
ushort uVar1;
int iVar2;
undefined8 *puVar3;
longlong *plVar4;
undefined8 uVar5;
undefined4 uVar6;
ulonglong uVar7;
undefined8 uVar8;
undefined *puVar9;
undefined auStackY_108 [32];
undefined8 local_a0;
undefined4 local_98;
undefined4 local_94;
undefined8 uStack_90;
undefined4 local_88;
undefined4 local_84;
undefined4 *local_80;
_EVENT_DATA_DESCRIPTOR local_78;
undefined local_68 [64];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStackY_108;
local_a0 = 0;
local_94 = 0;
uStack_90._0_4_ = 0;
uStack_90._4_4_ = 0;
memset(local_68,0,0x40);
if (((param_1 != (longlong *)0x0) &&
(uStack_90 = (undefined *)CONCAT44(uStack_90._4_4_,(undefined4)uStack_90),
(*(uint *)(param_1 + 8) & 0xa2a80) != 0)) && ((*(uint *)(param_1 + 0x11) >> 0x1b & 1) != 0)) {
uVar1 = *(ushort *)((longlong)param_1 + 0x22);

plVar4 = (longlong *)param_1[1];
if (plVar4 != (longlong *)0x0) {
plVar4 = (longlong *)*plVar4;
}
puVar9 = local_68;
uVar7 = (ulonglong)uVar1;
iVar2 = SslComputeSessionHash();
if (iVar2 == 0) {
local_88 = 0;
local_80 = &local_98;
local_98 = 0;
uStack_90 = local_68;
local_84 = 1;
local_94 = 0x19;
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(plVar4,(PCEVENT_DESCRIPTOR)&DAT_180084bf0,uVar7,puVar9,&local_78);
}
if (((*(byte *)(param_1 + 4) & 1) == 0) ||
(puVar3 = (undefined8 *)param_1[1], puVar3 == (undefined8 *)0x0)) {
puVar3 = (undefined8 *)param_1[1];
}
if (puVar3 == (undefined8 *)0x0) {
uVar5 = 0;
}
else {
uVar5 = *puVar3;
}
puVar3 = &local_a0;
uVar8 = 0;
iVar2 = SslGenerateMasterKey(uVar5,param_2);
if (((byte)DAT_180092f00 & 1) != 0) {
FUN_180054f60(uVar5,(PCEVENT_DESCRIPTOR)&DAT_180084be0,uVar8,puVar3,&local_78);
}
if (iVar2 == 0) {
RtlAcquireResourceExclusive(param_1[0xb] + 0x48,1);
*(undefined8 *)(param_1[0xb] + 0x10) = local_a0;
iVar2 = FUN_180001060(param_1,local_a0);
RtlReleaseResource(param_1[0xb] + 0x48);
if (iVar2 == 0) {
LsaIModifyPerformanceCounter(6,0,0);
}
goto LAB_180075af7;
}
uVar6 = 0x2c2;
}
else {
uVar6 = 0x25c;
}
FUN_18005b470(param_1,uVar6,iVar2,0x33);
}
LAB_180075af7:
FUN_180028070(local_28 ^ (ulonglong)auStackY_108);
return;
}
=========================================
Function at address: 0x180075b20
Called functions addresses: 0x180028d90 0xEXTERNAL:00000116 0x180028070 0x18006febc 0xEXTERNAL:00000109 0x18002a7c0


void FUN_180075b20(longlong *param_1,int param_2,int param_3,DWORD *param_4)

{
uint cbHashValue;
ulonglong uVar1;
longlong lVar2;
undefined8 uVar3;
undefined auStackY_b8 [32];
uint local_78 [4];
BYTE local_68 [64];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStackY_b8;
memset(local_68,0,0x40);
local_78[0] = 0;
if ((param_1 != (longlong *)0x0) && (param_4 != (DWORD *)0x0)) {
*param_4 = 0;
uVar1 = FUN_18006febc((longlong)param_1,param_2,param_3,local_78);
cbHashValue = local_78[0];
if (((int)uVar1 == 0) && (local_78[0] < 0x41)) {
if ((*(uint *)(param_1 + 8) & 0x40051555) == 0) {

if (lVar2 != 0) {
NCryptSignHash(*(NCRYPT_KEY_HANDLE *)(lVar2 + 0x68),(void *)0x0,local_68,cbHashValue,
(PBYTE)0x0,*param_4,param_4,0x40);
}
}
else if (param_1[3] != 0) {
if ((undefined8 *)param_1[1] == (undefined8 *)0x0) {
uVar3 = 0;
}
else {
uVar3 = *(undefined8 *)param_1[1];
}
SslSignHash(uVar3,*(undefined8 *)(param_1[3] + 8),local_68,local_78[0]);
}
}
}
FUN_180028070(local_28 ^ (ulonglong)auStackY_b8);
return;
}
=========================================
Function at address: 0x180075c88
Called functions addresses: 0x180001e7c 0x180004494 0xEXTERNAL:00000041 0x18002a700 0x18000a418 0xEXTERNAL:00000132 0x18005b470 0xEXTERNAL:00000116 0x180028070 0x18002a7c0


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */

void FUN_180075c88(longlong *param_1,PUCHAR param_2,ULONG param_3,int param_4,BYTE *param_5,
uint *param_6)

{
longlong lVar1;
ULONG UVar2;
int iVar3;
DWORD DVar4;
BOOL BVar5;
undefined8 uVar6;
undefined4 *puVar7;
ulonglong uVar8;
undefined8 uVar9;
ulonglong uVar10;
undefined4 uVar11;
uint uVar12;
uint uVar13;
undefined *puVar14;
undefined *puVar15;
undefined auStackY_e8 [32];
uint local_a8;
ULONG UStack_a4;
uint local_a0 [2];
undefined4 *local_98;
uint local_90;
longlong local_88;
UCHAR local_78 [64];
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)&local_a8;
UStack_a4 = 0;
puVar14 = auStackY_e8;
if (param_1[3] == 0) goto LAB_180075ece;
iVar3 = 2;
if (param_4 != 0) {
iVar3 = param_4;
}
iVar3 = FUN_180004494(iVar3,(longlong)param_1,param_2,param_3,local_78,&UStack_a4);
if (iVar3 != 0) {
FUN_18005b470(param_1,0x44e,iVar3,0x50);
puVar14 = auStackY_e8;
goto LAB_180075ece;
}
puVar7 = (undefined4 *)0x0;
puVar14 = auStackY_e8;
if ((((*param_6 == 0) ||
(uVar10 = (ulonglong)*param_6, puVar14 = auStackY_e8, DAT_1800920e0 < uVar10)) ||
(uVar8 = DAT_1800920e8 + 8 + uVar10, puVar14 = auStackY_e8, uVar8 < uVar10)) ||
(uVar6 = FUN_18000a418(uVar8), puVar7 = (undefined4 *)0x0, puVar14 = auStackY_e8,
(int)uVar6 == 0)) {
LAB_180075d8d:
if (*param_6 <= *param_6 + 8) {
*(undefined8 *)(puVar14 + -8) = 0x180075dae;

if (puVar7 == (undefined4 *)0x0) goto LAB_180075ece;
*puVar7 = 0x70616548;
puVar7 = puVar7 + 2;
}
puVar15 = puVar14;
if (puVar7 == (undefined4 *)0x0) goto LAB_180075ece;
}
else {
uVar10 = (ulonglong)(*param_6 + 8) + 0xf;
if (uVar10 <= *param_6 + 8) {
uVar10 = 0xffffffffffffff0;
}
lVar1 = -(uVar10 & 0xfffffffffffffff0);
puVar7 = (undefined4 *)((longlong)&local_a8 + lVar1);
puVar14 = auStackY_e8 + lVar1;
if (puVar7 == (undefined4 *)0x0) goto LAB_180075d8d;
*puVar7 = 0x6b637453;
puVar7 = (undefined4 *)((longlong)local_a0 + lVar1);
puVar14 = auStackY_e8 + lVar1;
puVar15 = auStackY_e8 + lVar1;
if (puVar7 == (undefined4 *)0x0) goto LAB_180075d8d;
}
uVar12 = *param_6;
uVar6 = *(undefined8 *)(param_1[3] + 8);
if ((undefined8 *)param_1[1] == (undefined8 *)0x0) {
uVar9 = 0;
}
else {
uVar9 = *(undefined8 *)param_1[1];
}
local_a8 = uVar12;
*(undefined4 *)(puVar15 + 0x38) = 0;
UVar2 = UStack_a4;
*(uint **)(puVar15 + 0x30) = &local_a8;
*(uint *)(puVar15 + 0x28) = uVar12;
*(undefined4 **)(puVar15 + 0x20) = puVar7;
*(undefined8 *)(puVar15 + -8) = 0x180075e16;
DVar4 = SslSignHash(uVar9,uVar6,local_78,UVar2);
if (DVar4 == 0) {
uVar12 = local_a8 >> 1;
*(undefined8 *)(puVar15 + -8) = 0x180075e35;
FUN_180001e7c((undefined *)puVar7,uVar12);
uVar12 = local_a8 >> 1;
uVar13 = local_a8 >> 1;
*(undefined8 *)(puVar15 + -8) = 0x180075e48;
FUN_180001e7c((undefined *)((ulonglong)uVar12 + (longlong)puVar7),uVar13);
local_a0[0] = local_a8 >> 1;
local_90 = local_a8 >> 1;
local_88 = (ulonglong)(local_a8 >> 1) + (longlong)puVar7;
local_98 = puVar7;
*(uint **)(puVar15 + 0x20) = param_6;
*(undefined8 *)(puVar15 + -8) = 0x180075e7f;
BVar5 = CryptEncodeObject(1,(LPCSTR)0x2f,local_a0,param_5,*(DWORD **)(puVar15 + 0x20));
if (BVar5 == 0) {
*(undefined8 *)(puVar15 + -8) = 0x180075e8f;
DVar4 = GetLastError();
uVar11 = 0x450;
goto LAB_180075e9b;
}
}
else {
uVar11 = 0x44f;
LAB_180075e9b:
*(undefined8 *)(puVar15 + -8) = 0x180075ea9;
FUN_18005b470(param_1,uVar11,DVar4,0x50);
}
puVar14 = puVar15;
if (puVar7[-2] == 0x70616548) {
*(undefined8 *)(puVar15 + -8) = 0x180075ecc;

}
LAB_180075ece:
uVar10 = local_38 ^ (ulonglong)&local_a8;
*(undefined8 *)(puVar14 + -8) = 0x180075eda;
FUN_180028070(uVar10);
return;
}
=========================================
Function at address: 0x180075ef8
Called functions addresses: 0x18000629c 0x180006300 0x18002a7c0 0x180002858


ulonglong FUN_180075ef8(longlong *param_1,undefined8 param_2)

{
longlong *plVar1;
uint uVar2;
ulonglong uVar3;
longlong lVar4;

plVar1 = param_1 + 0xa5;
FUN_18000629c(param_1,*(byte **)(*plVar1 + 0x170),(uint *)0x0);
lVar4 = *plVar1;
uVar2 = FUN_180002858(lVar4,DAT_1800927f0,plVar1);
FUN_180006300(lVar4,*(byte **)(*plVar1 + 0x170),(uint *)0x0);
if (uVar2 == 0) {
param_1[0xb] = *plVar1;
if (*(char *)((longlong)param_1 + 0xe9) != '\0') {
*(undefined4 *)((longlong)param_1 + 0x51c) = 0;
}

}
else {
uVar3 = (ulonglong)uVar2;
}
return uVar3;
}
=========================================
Function at address: 0x180075fac
Called functions addresses: 0x180063098


undefined8 FUN_180075fac(longlong param_1,undefined *param_2,uint param_3)

{
undefined8 uVar1;
char *pcVar2;
ushort uVar3;
int iVar4;

if ((param_3 < 2) || (CONCAT11(*param_2,param_2[1]) < 3)) {
LAB_18007604e:
uVar1 = 0x80090326;
}
else {
pcVar2 = param_2 + 2;
for (iVar4 = param_3 - 2; iVar4 != 0; iVar4 = (iVar4 - 3U) - (uint)uVar3) {
if ((iVar4 - 1U < 2) || (uVar3 = CONCAT11(pcVar2[1],pcVar2[2]), uVar3 == 0))
goto LAB_18007604e;
if (iVar4 - 3U < (uint)uVar3) goto LAB_18007604e;
if ((*pcVar2 == '\0') &&
(uVar1 = FUN_180063098(*(longlong *)(param_1 + 0x20),pcVar2 + 3,uVar3), (int)uVar1 != 0)) {
return uVar1;
}
pcVar2 = pcVar2 + 3 + uVar3;
}
uVar1 = 0;
}
return uVar1;
}
=========================================
Function at address: 0x180076074
Called functions addresses: 0x180041cdc 0xEXTERNAL:0000009b 0x18004492c 0xEXTERNAL:00000041 0x1800432ec


uint FUN_180076074(undefined *param_1,uint param_2,LPCWSTR param_3,LPCWSTR param_4)

{
int cchWideChar;
uint cchWideChar_00;
uint uVar1;
int iVar2;
DWORD DVar3;
undefined2 uVar4;
LPSTR lpMultiByteStr;
int iVar5;
ulonglong uVar6;
ulonglong uVar7;
ulonglong uVar8;
uint uVar9;

uVar7 = 0xffffffffffffffff;
uVar6 = 0;
if (param_3 != (LPCWSTR)0x0) {
uVar6 = 0xffffffffffffffff;
do {
uVar6 = uVar6 + 1;
} while (param_3[uVar6] != L'\0');
}
uVar8 = 0;
if (param_4 != (LPCWSTR)0x0) {
do {
uVar7 = uVar7 + 1;
uVar8 = uVar7;
} while (param_4[uVar7] != L'\0');
}
cchWideChar = (int)uVar8;
cchWideChar_00 = (uint)uVar6;
uVar1 = cchWideChar + cchWideChar_00;
iVar2 = uVar1 + 0xd;
uVar9 = uVar1 + 0x10;
if (uVar1 < cchWideChar_00) {
return 0;
}
if (uVar1 + 0xd < uVar1) {
return 0;
}
if (0xffff < uVar1 + 0xd) {
return 0;
}
if (param_1 == (undefined *)0x0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return uVar9;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0) {
FUN_1800432ec(DAT_180091000[2],10,&DAT_1800863a0,uVar9);
return uVar9;
}
return uVar9;
}
if (param_2 < uVar9) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0;
}
uVar4 = 0xb;
}
else {
param_1[2] = (char)iVar2;
iVar5 = 0xe;
*param_1 = (char)((uint)iVar2 >> 0x10);
param_1[1] = (char)((uint)iVar2 >> 8);
param_1[5] = (char)(uVar1 + 9 >> 8);
param_1[7] = (char)(uVar1 + 7 >> 8);
param_1[10] = (char)(uVar1 + 4 >> 8);
param_1[0xc] = (char)(uVar6 >> 8);
*(undefined2 *)(param_1 + 3) = 0;
param_1[6] = (char)(uVar1 + 9);
param_1[8] = (char)(uVar1 + 7);
param_1[9] = 0x40;
param_1[0xb] = (char)(uVar1 + 4);
param_1[0xd] = (char)uVar6;
lpMultiByteStr = param_1 + 0xe;
if (cchWideChar_00 != 0) {
iVar2 = WideCharToMultiByte(0xfde9,0,param_3,cchWideChar_00,lpMultiByteStr,cchWideChar_00,
(LPCSTR)0x0,(LPBOOL)0x0);
if (iVar2 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0;
}
DVar3 = GetLastError();
uVar4 = 0xc;
goto LAB_1800762d0;
}
iVar5 = cchWideChar_00 + 0xe;
lpMultiByteStr = lpMultiByteStr + (uVar6 & 0xffffffff);
}
lpMultiByteStr[1] = (CHAR)uVar8;
param_2 = iVar5 + 2;
*lpMultiByteStr = (CHAR)(uVar8 >> 8);
if (cchWideChar != 0) {
iVar2 = WideCharToMultiByte(0xfde9,0,param_4,cchWideChar,lpMultiByteStr + 2,cchWideChar,
(LPCSTR)0x0,(LPBOOL)0x0);
if (iVar2 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0;
}
DVar3 = GetLastError();
uVar4 = 0xd;
LAB_1800762d0:
FUN_180041cdc(DAT_180091000[2],uVar4,&DAT_1800863a0,DVar3);
return 0;
}
param_2 = param_2 + cchWideChar;
}
if (param_2 == uVar9) {
return param_2;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) == 0) {
return 0;
}
uVar4 = 0xe;
}
FUN_18004492c(DAT_180091000[2],uVar4,&DAT_1800863a0,param_2,(char)uVar9);
return 0;
}
=========================================
Function at address: 0x180076330
Called functions addresses: 0x18000909c 0x180041cdc 0x18004492c 0x180041cb0 0xEXTERNAL:0000009c 0x18000a1f4 0x1800432ec 0x180041d20


undefined8 FUN_180076330(longlong param_1,byte *param_2,uint param_3)

{
uint cbMultiByte;
int iVar1;
LPWSTR pWVar2;
undefined8 *puVar3;
undefined2 uVar4;
byte *pbVar5;
byte *lpMultiByteStr;
uint uVar6;
uint uVar7;
uint uVar8;
uint uVar9;
byte *pbVar10;

if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_1800432ec(DAT_180091000[2],0xf,&DAT_1800863a0,param_3);
}
if (((*(uint *)(param_1 + 0x88) >> 8 & 1) == 0) || (*(char *)(param_1 + 0x39a) == '\0')) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x10;
puVar3 = DAT_180091000;
}
else {
if (*(HLOCAL *)(param_1 + 0x3a0) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x3a0));
*(undefined8 *)(param_1 + 0x3a0) = 0;
}
if (*(HLOCAL *)(param_1 + 0x3a8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x3a8));
*(undefined8 *)(param_1 + 0x3a8) = 0;
}
puVar3 = DAT_180091000;
if (param_3 < 3) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x11;
}
else {
uVar6 = (uint)param_2[1] * 0x100 + (uint)*param_2 * 0x10000 + (uint)param_2[2];
if (uVar6 <= param_3 - 3) {
pbVar10 = param_2 + 3;
if (uVar6 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) == 0) {
return 0;
}
uVar4 = 0x13;
}
else {
do {
if (uVar6 < 4) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x14;
goto LAB_180076a45;
}
uVar8 = (uint)pbVar10[2] * 0x100 + (uint)pbVar10[3];
if (uVar6 - 4 < uVar8) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x15;
goto LAB_180076a45;
}
uVar6 = (uVar6 - 4) - uVar8;
if ((uint)*pbVar10 * 0x100 + (uint)pbVar10[1] == 0) {
if (uVar8 < 2) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 1) != 0) {
FUN_1800432ec(puVar3[2],0x16,&DAT_1800863a0,uVar8);
puVar3 = DAT_180091000;
}
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x17;
goto LAB_180076a45;
}
uVar9 = uVar8 - 2;
pbVar5 = pbVar10 + 6;
uVar7 = (uint)pbVar10[4] * 0x100 + (uint)pbVar10[5];
if (uVar9 < uVar7) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 1) != 0) {
FUN_18004492c(puVar3[2],0x18,&DAT_1800863a0,uVar7,(char)uVar9);
puVar3 = DAT_180091000;
}
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x19;
goto LAB_180076a45;
}
do {
if (uVar9 < 3) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 1) != 0) {
FUN_180041cb0(puVar3[2],0x1a,&DAT_1800863a0);
puVar3 = DAT_180091000;
}
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x1b;
goto LAB_180076a45;
}
uVar7 = (uint)pbVar5[1] * 0x100 + (uint)pbVar5[2];
if (uVar9 - 3 < uVar7) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x1c;
goto LAB_180076a45;
}
if (*pbVar5 == 0x40) {
if (uVar7 < 4) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x1e;
goto LAB_180076a45;
}
uVar7 = uVar7 - 2;
lpMultiByteStr = pbVar5 + 5;
uVar9 = (uint)pbVar5[3] * 0x100 + (uint)pbVar5[4];
if (uVar7 < uVar9) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x1f;
goto LAB_180076a45;
}
if (uVar9 != 0) {
cbMultiByte = MultiByteToWideChar(0xfde9,0,(LPCSTR)lpMultiByteStr,uVar9,
(LPWSTR)0x0,0);
if (cbMultiByte == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090304;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090304;
}
uVar4 = 0x20;
goto LAB_180076855;
}
if (cbMultiByte != uVar9) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x21;
puVar3 = DAT_180091000;
goto LAB_180076a45;
}
if (*(HLOCAL *)(param_1 + 0x3a0) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x3a0));
*(undefined8 *)(param_1 + 0x3a0) = 0;
}
pWVar2 = (LPWSTR)FUN_18000a1f4((ulonglong)(cbMultiByte * 2 + 2));
*(LPWSTR *)(param_1 + 0x3a0) = pWVar2;
if (pWVar2 == (LPWSTR)0x0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090304;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090304;
}
uVar4 = 0x22;
goto LAB_180076855;
}
iVar1 = MultiByteToWideChar(0xfde9,0,(LPCSTR)lpMultiByteStr,cbMultiByte,pWVar2,
cbMultiByte);
if (iVar1 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090304;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090304;
}
uVar4 = 0x23;
goto LAB_180076855;
}
lpMultiByteStr = lpMultiByteStr + cbMultiByte;
uVar7 = uVar7 - cbMultiByte;
*(undefined2 *)(*(longlong *)(param_1 + 0x3a0) + (ulonglong)cbMultiByte * 2) = 0
;
puVar3 = DAT_180091000;
}
if (uVar7 < 2) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x24;
goto LAB_180076a45;
}
uVar9 = (uint)*lpMultiByteStr * 0x100 + (uint)lpMultiByteStr[1];
if (uVar7 - 2 < uVar9) {
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x25;
goto LAB_180076a45;
}
if (uVar9 == 0) break;
uVar7 = MultiByteToWideChar(0xfde9,0,(LPCSTR)(lpMultiByteStr + 2),uVar9,
(LPWSTR)0x0,0);
if (uVar7 == 0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090304;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090304;
}
uVar4 = 0x26;
}
else {
if (uVar7 != uVar9) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x27;
puVar3 = DAT_180091000;
goto LAB_180076a45;
}
if (*(HLOCAL *)(param_1 + 0x3a8) != (HLOCAL)0x0) {
FUN_18000909c(*(HLOCAL *)(param_1 + 0x3a8));
*(undefined8 *)(param_1 + 0x3a8) = 0;
}
pWVar2 = (LPWSTR)FUN_18000a1f4((ulonglong)(uVar7 * 2 + 2));
*(LPWSTR *)(param_1 + 0x3a8) = pWVar2;
if (pWVar2 == (LPWSTR)0x0) {
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090304;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090304;
}
uVar4 = 0x28;
}
else {
iVar1 = MultiByteToWideChar(0xfde9,0,(LPCSTR)(lpMultiByteStr + 2),uVar7,pWVar2
,uVar7);
if (iVar1 != 0) {
*(undefined2 *)(*(longlong *)(param_1 + 0x3a8) + (ulonglong)uVar7 * 2) = 0;
puVar3 = DAT_180091000;
break;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090304;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090304;
}
uVar4 = 0x29;
}
}
LAB_180076855:
FUN_180041d20(DAT_180091000[2],uVar4,&DAT_1800863a0,0x80090304,4);
return 0x80090304;
}
if (((undefined8 **)puVar3 != &DAT_180091000) &&
((*(byte *)((longlong)puVar3 + 0x1c) & 4) != 0)) {
FUN_180041cdc(puVar3[2],0x1d,&DAT_1800863a0,(uint)*pbVar5);
puVar3 = DAT_180091000;
}
pbVar5 = pbVar5 + 3 + uVar7;
uVar9 = (uVar9 - 3) - uVar7;
} while (uVar9 != 0);
}
pbVar10 = pbVar10 + 4 + uVar8;
} while (uVar6 != 0);
if ((undefined8 **)puVar3 == &DAT_180091000) {
return 0;
}
if ((*(byte *)((longlong)puVar3 + 0x1c) & 4) == 0) {
return 0;
}
uVar4 = 0x2a;
}
FUN_180041d20(puVar3[2],uVar4,&DAT_1800863a0,0,0);
return 0;
}
if ((undefined8 **)DAT_180091000 == &DAT_180091000) {
return 0x80090326;
}
if ((*(byte *)((longlong)DAT_180091000 + 0x1c) & 5) == 0) {
return 0x80090326;
}
uVar4 = 0x12;
}
}
LAB_180076a45:
FUN_180041d20(puVar3[2],uVar4,&DAT_1800863a0,0x80090326,0x26);
return 0x80090326;
}
=========================================
Function at address: 0x180076a84
Called functions addresses: 0x180076ba0 0x180076ac8


void FUN_180076a84(longlong *param_1,undefined *param_2,uint param_3,undefined *param_4,
uint *param_5)

{
int iVar1;

iVar1 = FUN_180076ba0(param_1,param_2,param_3,1);
if (iVar1 == 0) {
FUN_180076ac8((longlong)param_1,1,param_4,param_5);
}
return;
}
=========================================
Function at address: 0x180076ac8
Called functions addresses: 0x18002a77b


undefined4 FUN_180076ac8(longlong param_1,int param_2,undefined *param_3,uint *param_4)

{
ushort *puVar1;
uint uVar2;
undefined *_Dst;
undefined4 uVar3;
uint uVar4;

uVar3 = 0;
if (*(int *)(*(longlong *)(param_1 + 8) + 0x30) == 4) {
puVar1 = *(ushort **)(param_1 + 0x358);
if (puVar1 == (ushort *)0x0) {
uVar2 = 0;
uVar4 = 0;
if (param_2 != 0) {
uVar2 = 2;
uVar4 = 0;
}
}
else {
uVar2 = *puVar1 + 2;
uVar4 = (uint)*puVar1;
}
if (param_3 == (undefined *)0x0) {
*param_4 = uVar2;
uVar3 = 0;
}
else if (*param_4 < uVar2) {
*param_4 = uVar2;
uVar3 = 0x80090321;
}
else {
_Dst = param_3;
if (uVar2 != 0) {
param_3[1] = (char)uVar4;
_Dst = param_3 + 2;
*param_3 = (char)(uVar4 >> 8);
if ((short)uVar4 != 0) {
memcpy(_Dst,puVar1 + 1,(ulonglong)uVar4);
_Dst = _Dst + uVar4;
}
}
*param_4 = (int)_Dst - (int)param_3;
}
}
else {
uVar3 = 0x54f;
}
return uVar3;
}
=========================================
Function at address: 0x180076ba0
Called functions addresses: 0x18002a77b 0x18005b470 0x18002a7c0


undefined4 FUN_180076ba0(longlong *param_1,undefined *param_2,uint param_3,int param_4)

{
ushort *puVar1;
ushort uVar2;

if (((param_4 != 0) || (1 < param_3)) && (param_3 != 1)) {
if (param_3 < 2) {
return 0;
}
uVar2 = CONCAT11(*param_2,param_2[1]);
if ((uint)uVar2 == param_3 - 2) {
if (uVar2 == 0) {
return 0;
}
if (param_1[0x6c] != 0) {

}

param_1[0x6c] = (longlong)puVar1;
if (puVar1 == (ushort *)0x0) {
return 0xe;
}
*puVar1 = uVar2;
memcpy((void *)(param_1[0x6c] + 2),param_2 + 2,(ulonglong)uVar2);
return 0;
}
}
FUN_18005b470(param_1,0x33b,0x80090308,0x32);
return 0x80090308;
}
=========================================
Function at address: 0x180076ca8
Called functions addresses: 0x18002a77b 0x18000909c 0x18000a1f4


undefined8
FUN_180076ca8(longlong param_1,undefined8 *param_2,undefined8 param_3,undefined4 *param_4)

{
uint uVar1;
char *pcVar2;
char *pcVar3;
char cVar4;
char cVar5;
uint *puVar6;
uint uVar7;
uint *puVar8;
ulonglong uVar9;
char *pcVar10;
ulonglong uVar11;
uint uVar12;
uint uVar13;

pcVar10 = *(char **)(param_1 + 8);
uVar11 = 0;
if (*(uint *)(param_1 + 4) < 2) {
*(undefined4 *)(param_1 + 4) = 2;
}
else {
uVar7 = (uint)CONCAT11(*pcVar10,pcVar10[1]) & ((int)*pcVar10 >> 0x1f & 0x4000U) + 0x3fff;
uVar1 = uVar7 + 2;
if (uVar1 <= *(uint *)(param_1 + 4)) {
if (((10 < uVar7) && (pcVar10[2] == '\x01')) && (1 < CONCAT11(pcVar10[3],pcVar10[4]))) {
*param_2 = 0;
uVar13 = (uint)CONCAT11(pcVar10[7],pcVar10[8]);
uVar12 = (uint)CONCAT11(pcVar10[9],pcVar10[10]);
if ((ulonglong)CONCAT11(pcVar10[5],pcVar10[6]) + 9 + (ulonglong)uVar13 + (ulonglong)uVar12
<= (ulonglong)uVar7) {
uVar9 = (ulonglong)CONCAT11(pcVar10[5],pcVar10[6]) / 3;
uVar7 = (uint)uVar9;
if ((0x44 < uVar7) && (uVar11 = (ulonglong)(uVar7 - 0x44) << 2, 0xffffffff < uVar11)) {
return 0x216;
}
puVar6 = (uint *)FUN_18000a1f4((ulonglong)((int)uVar11 + 0x160));
if (puVar6 == (uint *)0x0) {
return 0x80090304;
}
cVar4 = pcVar10[3];
cVar5 = pcVar10[4];
pcVar10 = pcVar10 + 0xb;
puVar6[1] = uVar7;
*puVar6 = (uint)CONCAT11(cVar4,cVar5);
if (uVar7 != 0) {
puVar8 = puVar6 + 0x14;
do {
pcVar2 = pcVar10 + 1;
cVar4 = *pcVar10;
pcVar3 = pcVar10 + 2;
pcVar10 = pcVar10 + 3;
uVar7 = (uint)CONCAT21(CONCAT11(cVar4,*pcVar2),*pcVar3);
*puVar8 = uVar7;
if ((uVar7 == 0xff) && (param_4 != (undefined4 *)0x0)) {
*param_4 = 1;
}
puVar8 = puVar8 + 1;
uVar9 = uVar9 - 1;
} while (uVar9 != 0);
}
if (uVar13 < 0x11) {
memcpy(puVar6 + 4,pcVar10,(ulonglong)uVar13);
puVar6[2] = uVar13;
if (uVar12 - 1 < 0x20) {
memcpy(puVar6 + 0xc,pcVar10 + uVar13,(ulonglong)uVar12);
puVar6[3] = uVar12;
*(uint *)(param_1 + 4) = uVar1;
*param_2 = puVar6;
return 0;
}
}
FUN_18000909c(puVar6);
}
}
return 0x80090326;
}
*(uint *)(param_1 + 4) = uVar1;
}
return 0x80090318;
}
=========================================
Function at address: 0x180076ebc
Called functions addresses: 0x180041cdc 0x18005b81c 0xEXTERNAL:0000010f 0x18002a7c0


/* WARNING: Type propagation algorithm not settling */

undefined8 FUN_180076ebc(longlong param_1)

{
int *piVar1;
uint *puVar2;
undefined *puVar3;
undefined *puVar4;
int iVar5;
undefined8 uVar6;
longlong *plVar7;
uint uVar8;
ushort uVar9;
uint local_res8 [2];
longlong local_res10 [3];

if ((((*(char *)(param_1 + 0x58) == '\0') ||
(puVar2 = *(uint **)(param_1 + 0x30), puVar2 == (uint *)0x0)) ||
(*(longlong *)(puVar2 + 2) == 0)) ||
(((puVar3 = *(undefined **)(param_1 + 0x38), puVar3 == (undefined *)0x0 ||
(puVar4 = *(undefined **)(param_1 + 0x40), puVar4 < puVar3)) ||
(((longlong)((ulonglong)*(ushort *)(param_1 + 0x5a) + 5) < (longlong)puVar4 - (longlong)puVar3
|| (((longlong)puVar4 - (longlong)puVar3 < 6 || (*puVar2 < puVar2[1] + 0x10)))))))) {
uVar6 = 0x57;
}
else {
*puVar4 = *(undefined *)(param_1 + 0x54);
*(longlong *)(param_1 + 0x40) = *(longlong *)(param_1 + 0x40) + 1;
piVar1 = (int *)(*(longlong *)(param_1 + 0x30) + 4);
*piVar1 = *piVar1 + 1;
local_res10[1] = 0;
local_res10[0] = 0;

(*(undefined8 *)(param_1 + 8),local_res10 + 1,local_res10);
if (local_res10[0] == 0) {
uVar6 = 0x54f;
}
else {
uVar9 = *(short *)(param_1 + 0x40) - *(short *)(param_1 + 0x38);
local_res8[0] = 0;
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_18005b81c(DAT_180091000[2],10,&DAT_1800863b0,(uint)(ushort)(uVar9 - 5),
(char)*(undefined8 *)(*(longlong *)(param_1 + 8) + 0xb8));
}
plVar7 = *(longlong **)(*(longlong *)(param_1 + 8) + 8);
if (plVar7 != (longlong *)0x0) {
plVar7 = (longlong *)*plVar7;
}
uVar8 = uVar9 + 0x10 & 0xffff;
iVar5 = SslEncryptPacket(plVar7,local_res10[0],*(longlong *)(param_1 + 0x38) + 5,uVar9 - 5,
*(longlong *)(param_1 + 0x38),uVar8,local_res8,
*(undefined8 *)(*(longlong *)(param_1 + 8) + 0xb8),0x17,0);
if (((iVar5 == 0) && (local_res8[0] <= uVar8)) && (uVar9 <= local_res8[0])) {
uVar9 = (short)local_res8[0] - uVar9;
*(longlong *)(param_1 + 0x40) = *(longlong *)(param_1 + 0x40) + (ulonglong)uVar9;
*(undefined8 *)(param_1 + 0x38) = *(undefined8 *)(param_1 + 0x40);
piVar1 = (int *)(*(longlong *)(param_1 + 0x30) + 4);
*piVar1 = *piVar1 + (uint)uVar9;
plVar7 = (longlong *)(*(longlong *)(param_1 + 8) + 0xb8);
*plVar7 = *plVar7 + 1;
uVar6 = 0;
}
else {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_1800863b0,iVar5);
}
uVar6 = 0x80090329;
}
}
}
return uVar6;
}
=========================================
Function at address: 0x1800770e0
Called functions addresses: 0x180077204 0x18002a7c0


undefined8 FUN_1800770e0(longlong *param_1)

{
ulonglong uVar1;
ulonglong uVar2;
ulonglong uVar3;
undefined8 uVar4;
longlong lVar5;

if ((((((*(short *)(param_1 + 2) == 0) || (param_1[3] == 0)) || (uVar2 = param_1[4], uVar2 == 0))
|| ((uVar1 = param_1[3] + (ulonglong)*(ushort *)(param_1 + 2) * 0xc, uVar1 <= uVar2 ||
(param_1[6] == 0)))) ||
((*(longlong *)(param_1[6] + 8) == 0 ||
((uVar3 = param_1[7], uVar3 == 0 || ((ulonglong)param_1[8] < uVar3)))))) ||
((lVar5 = param_1[8] - uVar3,
(longlong)((ulonglong)*(ushort *)((longlong)param_1 + 0x5a) + 5) < lVar5 ||
((lVar5 < 6 || (*(int *)(param_1 + 9) == 0)))))) {
uVar4 = 0x57;
}
else {
if (uVar2 < uVar1 - 0xc) {
if (((*(byte *)(uVar2 + 8) & 1) != 0) &&

return uVar4;
}
param_1[4] = param_1[4] + 0xc;
}
else {
uVar4 = FUN_180077204(param_1);
if ((int)uVar4 != 0) {
return uVar4;
}
*(undefined2 *)((longlong)param_1 + 0x5a) = *(undefined2 *)(param_1 + 10);
*(undefined2 *)(param_1 + 2) = 0;
param_1[3] = 0;
param_1[4] = 0;
*(undefined4 *)(param_1 + 5) = 0;
param_1[6] = 0;
param_1[7] = 0;
param_1[8] = 0;
*(undefined4 *)((longlong)param_1 + 0x54) = 0x14;
*(undefined *)(param_1 + 0xb) = 0;
}
*(undefined4 *)(param_1 + 9) = 0;
uVar4 = 0;
}
return uVar4;
}
=========================================
Function at address: 0x180077204
Called functions addresses: 0x180076ebc 0x18002a7c0


undefined8 FUN_180077204(longlong *param_1)

{
ulonglong uVar1;
ulonglong uVar2;
undefined *puVar3;
undefined8 uVar4;
undefined uVar5;
short sVar6;
longlong lVar7;

if ((((*(short *)(param_1 + 2) == 0) || (param_1[3] == 0)) || (uVar1 = param_1[4], uVar1 == 0)) ||
(((param_1[3] + (ulonglong)*(ushort *)(param_1 + 2) * 0xc <= uVar1 ||
(uVar2 = param_1[7], uVar2 == 0)) ||
(((ulonglong)param_1[8] < uVar2 ||
((lVar7 = param_1[8] - uVar2,
(longlong)((ulonglong)*(ushort *)((longlong)param_1 + 0x5a) + 5) < lVar7 || (lVar7 < 6))))))
)) {
uVar4 = 0x57;
}
else {
if (((*(int *)(param_1 + 9) != 0) && ((*(byte *)(uVar1 + 8) & 1) != 0)) &&

return uVar4;
}
if (*(char *)(param_1 + 0xb) == '\0') {
puVar3 = (undefined *)param_1[7];
*puVar3 = *(undefined *)((longlong)param_1 + 0x54);
uVar5 = 1;
puVar3[1] = 3;
if (*(int *)(param_1[1] + 0x44) != 0x28) {
uVar5 = 3;
}
puVar3[2] = uVar5;
sVar6 = (*(short *)(param_1 + 8) - *(short *)(param_1 + 7)) + -5;
puVar3[4] = (char)sVar6;
puVar3[3] = (char)((ushort)sVar6 >> 8);
param_1[7] = param_1[8];
uVar4 = 0;
}
else {
uVar4 = FUN_180076ebc((longlong)param_1);
}
}
return uVar4;
}
=========================================
Function at address: 0x180077330
Called functions addresses: 0x18002a7c0


undefined8 FUN_180077330(longlong param_1)

{
ulonglong uVar1;
ulonglong uVar2;
undefined8 uVar3;
longlong lVar4;
ushort uVar5;

if ((((((*(short *)(param_1 + 0x10) == 0) || (*(longlong *)(param_1 + 0x18) == 0)) ||
(uVar1 = *(ulonglong *)(param_1 + 0x20), uVar1 == 0)) ||
((*(longlong *)(param_1 + 0x18) + (ulonglong)*(ushort *)(param_1 + 0x10) * 0xc <= uVar1 ||
((*(byte *)(uVar1 + 8) & 1) == 0)))) ||
((uVar1 = *(ulonglong *)(param_1 + 0x38), uVar1 == 0 ||
((uVar2 = *(ulonglong *)(param_1 + 0x40), uVar2 < uVar1 ||
(lVar4 = uVar2 - uVar1, (longlong)((ulonglong)*(ushort *)(param_1 + 0x5a) + 5) < lVar4))))))
|| ((lVar4 < 6 || (*(int *)(param_1 + 0x48) == 0)))) {
uVar3 = 0x57;
}
else {
if (lVar4 + -5 < (longlong)(ulonglong)*(uint *)(param_1 + 0x48)) {
uVar5 = ((short)uVar2 - *(short *)(param_1 + 0x38)) - 5;
}
else {
uVar5 = *(ushort *)(param_1 + 0x48);
}

(*(undefined8 *)(param_1 + 8),uVar2 - uVar5,(ulonglong)uVar5,
CONCAT71((uint7)(byte)(uVar5 >> 8),1));
}
return uVar3;
}
=========================================
Function at address: 0x180077414
Called functions addresses: None


undefined8 FUN_180077414(longlong param_1)

{
uint *puVar1;
ulonglong uVar2;
short sVar3;
uint uVar4;

if ((((*(longlong *)(param_1 + 0x20) != 0) &&
(*(ulonglong *)(param_1 + 0x20) <
*(longlong *)(param_1 + 0x18) + (ulonglong)*(ushort *)(param_1 + 0x10) * 0xc)) &&
(puVar1 = *(uint **)(param_1 + 0x30), puVar1 != (uint *)0x0)) &&
(((*(longlong *)(puVar1 + 2) != 0 && (uVar2 = *(ulonglong *)(param_1 + 0x38), uVar2 != 0)) &&
((uVar2 <= *(ulonglong *)(param_1 + 0x40) && (puVar1[1] + 5 < *puVar1)))))) {
*(ulonglong *)(param_1 + 0x40) = uVar2 + 5;
puVar1[1] = puVar1[1] + 5;
*(undefined4 *)(param_1 + 0x54) = *(undefined4 *)(*(longlong *)(param_1 + 0x20) + 4);
uVar4 = *(uint *)(*(longlong *)(param_1 + 0x20) + 8) & 2;
*(bool *)(param_1 + 0x58) = uVar4 != 0;
sVar3 = *(short *)(param_1 + 0x50) + -1;
if (uVar4 == 0) {
sVar3 = *(short *)(param_1 + 0x50);
}
*(short *)(param_1 + 0x5a) = sVar3;
return 0;
}
return 0x57;
}
=========================================
Function at address: 0x1800774b0
Called functions addresses: None


undefined8 FUN_1800774b0(longlong param_1,ushort param_2,ushort *param_3,int *param_4)

{
ushort uVar1;
undefined8 uVar2;
int iVar3;
ushort uVar4;
ushort uVar5;
int iVar6;
int iVar7;
uint uVar8;
ushort uVar9;
ushort *puVar10;
bool bVar11;
bool bVar12;
int local_38;

if ((((*(longlong *)(param_1 + 0x30) == 0) && (param_2 != 0)) && (param_3 != (ushort *)0x0)) &&
(param_4 != (int *)0x0)) {
bVar11 = (*(byte *)(param_3 + 4) & 2) != 0;
iVar7 = 0;
local_38 = *(int *)(param_3 + 2);
uVar1 = *(ushort *)(param_1 + 0x50);
uVar9 = uVar1;
if (bVar11) {
uVar9 = uVar1 - 1;
}
puVar10 = param_3;
iVar6 = 0;
uVar4 = uVar9;
if (param_3 < param_3 + (ulonglong)param_2 * 6) {
do {
uVar5 = *puVar10;
uVar8 = *(uint *)(puVar10 + 4) & 2;
bVar12 = uVar8 != 0;
if (uVar5 == 0) {
iVar7 = iVar6;
if (*(int *)(puVar10 + 2) != 0x17) goto LAB_18007768a;
}
else {
if ((*(int *)(puVar10 + 2) == 0x15) && (uVar1 < uVar5)) goto LAB_18007768a;
if (((*(int *)(puVar10 + 2) != local_38) ||
((*(int *)(puVar10 + 2) == 0x15 && (uVar4 < uVar5)))) || (bVar12 != bVar11)) {
local_38 = *(int *)(puVar10 + 2);
iVar6 = iVar6 + (((-(uint)(bVar11 != false) & 0x10) + 5) - (uint)uVar4) + (uint)uVar1;
uVar4 = uVar1 - 1;
bVar11 = bVar12;
uVar9 = uVar1 - 1;
if (uVar8 == 0) {
uVar4 = uVar1;
uVar9 = uVar1;
}
}
if (uVar4 <= uVar5) {
uVar4 = uVar5 - uVar4;
uVar5 = uVar4 % uVar9;
iVar3 = (-(uint)(bVar11 != false) & 0x10) + 5 + (uint)uVar1;
iVar7 = iVar6 + ((uint)uVar4 / (uint)uVar9) * iVar3;
uVar4 = 0;
if (uVar5 == 0) goto LAB_180077645;
local_38 = *(int *)(puVar10 + 2);
iVar6 = iVar7 + iVar3;
uVar4 = uVar1 - 1;
bVar11 = bVar12;
uVar9 = uVar1 - 1;
if (uVar8 == 0) {
uVar4 = uVar1;
uVar9 = uVar1;
}
}
uVar4 = uVar4 - uVar5;
iVar7 = iVar6;
}
LAB_180077645:
puVar10 = puVar10 + 6;
iVar6 = iVar7;
} while (puVar10 < param_3 + (ulonglong)param_2 * 6);
if (uVar4 < uVar9) {
iVar7 = iVar7 + (((-(uint)(bVar11 != false) & 0x10) + 5) - (uint)uVar4) + (uint)uVar1;
}
}
*(ushort *)(param_1 + 0x10) = param_2;
*(ushort **)(param_1 + 0x18) = param_3;
*(ushort **)(param_1 + 0x20) = param_3;
*(int *)(param_1 + 0x28) = iVar7;
*param_4 = iVar7;
uVar2 = 0;
}
else {
LAB_18007768a:
uVar2 = 0x57;
}
return uVar2;
}
=========================================
Function at address: 0x1800776b0
Called functions addresses: 0x180077414


undefined8 FUN_1800776b0(longlong param_1,uint *param_2)

{
short *psVar1;
undefined8 uVar2;
short *psVar3;

if (((((*(short *)(param_1 + 0x10) != 0) &&
(psVar3 = *(short **)(param_1 + 0x18), psVar3 != (short *)0x0)) &&
(*(longlong *)(param_1 + 0x30) == 0)) &&
((param_2 != (uint *)0x0 && (*(uint *)(param_1 + 0x28) <= *param_2)))) &&
((param_2[1] == 0 && (*(longlong *)(param_2 + 2) != 0)))) {
*(uint **)(param_1 + 0x30) = param_2;
uVar2 = *(undefined8 *)(param_2 + 2);
*(undefined8 *)(param_1 + 0x38) = uVar2;
*(undefined8 *)(param_1 + 0x40) = uVar2;
*(undefined4 *)(param_1 + 0x48) = 0;
*(short **)(param_1 + 0x20) = psVar3;
psVar1 = psVar3 + (ulonglong)*(ushort *)(param_1 + 0x10) * 6;
while ((psVar3 < psVar1 && (*psVar3 == 0))) {
psVar3 = psVar3 + 6;
*(short **)(param_1 + 0x20) = psVar3;
}
uVar2 = FUN_180077414(param_1);
return uVar2;
}
return 0x57;
}
=========================================
Function at address: 0x180077740
Called functions addresses: 0x180077414 0x180077204 0x1800778d4


undefined8 FUN_180077740(longlong *param_1,ushort param_2,void *param_3)

{
ushort *puVar1;
uint *puVar2;
ulonglong uVar3;
undefined8 uVar4;
longlong lVar5;
ushort uVar6;

if ((((*(short *)(param_1 + 2) != 0) && (param_1[3] != 0)) &&
(puVar1 = (ushort *)param_1[4], puVar1 != (ushort *)0x0)) &&
(((puVar1 < (ushort *)(param_1[3] + (ulonglong)*(ushort *)(param_1 + 2) * 0xc) &&
(puVar2 = (uint *)param_1[6], puVar2 != (uint *)0x0)) &&
((*(longlong *)(puVar2 + 2) != 0 &&
((uVar3 = param_1[7], uVar3 != 0 && (uVar3 <= (ulonglong)param_1[8])))))))) {
lVar5 = param_1[8] - uVar3;
if ((lVar5 <= (longlong)((ulonglong)*(ushort *)((longlong)param_1 + 0x5a) + 5)) && (4 < lVar5))
{
if (param_2 == 0) {
if (param_3 != (void *)0x0) {
return 0x57;
}
}
else if (param_3 == (void *)0x0) {
return 0x57;
}
if ((*(int *)(param_1 + 9) + (uint)param_2 <= (uint)*puVar1) &&
(puVar2[1] + (uint)param_2 <= *puVar2)) {
if (param_2 != 0) {
uVar6 = (*(ushort *)((longlong)param_1 + 0x5a) - *(short *)(param_1 + 8)) +
*(short *)(param_1 + 7) + 5;
if ((*(int *)(puVar1 + 2) != *(int *)((longlong)param_1 + 0x54)) ||
(((*(int *)(puVar1 + 2) == 0x15 && (uVar6 < param_2)) ||
(((byte)(*(uint *)(puVar1 + 4) >> 1) & 1) != *(byte *)(param_1 + 0xb))))) {
uVar4 = FUN_180077204(param_1);
if ((int)uVar4 != 0) {
return uVar4;
}
uVar4 = FUN_180077414((longlong)param_1);
if ((int)uVar4 != 0) {
return uVar4;
}
uVar6 = *(ushort *)((longlong)param_1 + 0x5a);
}
if (param_2 < uVar6) {
uVar4 = FUN_1800778d4((longlong)param_1,param_2,param_3);
return uVar4;
}
while( true ) {
uVar4 = FUN_1800778d4((longlong)param_1,uVar6,param_3);
if ((int)uVar4 != 0) {
return uVar4;
}
param_3 = (void *)((longlong)param_3 + (ulonglong)uVar6);
param_2 = param_2 - uVar6;
if (param_2 == 0) break;
uVar4 = FUN_180077204(param_1);
if ((int)uVar4 != 0) {
return uVar4;
}
uVar4 = FUN_180077414((longlong)param_1);
if ((int)uVar4 != 0) {
return uVar4;
}
uVar6 = *(ushort *)((longlong)param_1 + 0x5a);
if (param_2 <= *(ushort *)((longlong)param_1 + 0x5a)) {
uVar6 = param_2;
}
}
}
return 0;
}
}
}
return 0x57;
}
=========================================
Function at address: 0x1800778d4
Called functions addresses: 0x18002a77b


undefined8 FUN_1800778d4(longlong param_1,ushort param_2,void *param_3)

{
int *piVar1;
ushort *puVar2;
uint *puVar3;
ulonglong uVar4;
longlong lVar5;
ulonglong _Size;

_Size = (ulonglong)param_2;
if (((((*(short *)(param_1 + 0x10) != 0) && (*(longlong *)(param_1 + 0x18) != 0)) &&
(puVar2 = *(ushort **)(param_1 + 0x20), puVar2 != (ushort *)0x0)) &&
((puVar2 < (ushort *)
(*(longlong *)(param_1 + 0x18) + (ulonglong)*(ushort *)(param_1 + 0x10) * 0xc) &&
(puVar3 = *(uint **)(param_1 + 0x30), puVar3 != (uint *)0x0)))) &&
((*(longlong *)(puVar3 + 2) != 0 &&
((uVar4 = *(ulonglong *)(param_1 + 0x38), uVar4 != 0 &&
(uVar4 <= *(ulonglong *)(param_1 + 0x40))))))) {
lVar5 = *(longlong *)(param_1 + 0x40) - uVar4;
if (((longlong)(lVar5 + _Size) <= (longlong)((ulonglong)*(ushort *)(param_1 + 0x5a) + 5)) &&
(4 < lVar5)) {
if (param_2 == 0) {
if (param_3 != (void *)0x0) {
return 0x57;
}
}
else if (param_3 == (void *)0x0) {
return 0x57;
}
if ((*(int *)(param_1 + 0x48) + (uint)param_2 <= (uint)*puVar2) &&
(puVar3[1] + (uint)param_2 <= *puVar3)) {
if (param_2 != 0) {
memcpy(*(void **)(param_1 + 0x40),param_3,_Size);
*(longlong *)(param_1 + 0x40) = *(longlong *)(param_1 + 0x40) + _Size;
*(int *)(param_1 + 0x48) = *(int *)(param_1 + 0x48) + (uint)param_2;
piVar1 = (int *)(*(longlong *)(param_1 + 0x30) + 4);
*piVar1 = *piVar1 + (uint)param_2;
}
return 0;
}
}
}
return 0x57;
}
=========================================
Function at address: 0x1800779e0
Called functions addresses: 0x18002a7c0


undefined8 FUN_1800779e0(longlong *param_1)

{
ulonglong uVar1;
undefined8 uVar2;
longlong lVar3;

lVar3 = 0;
if ((((((*(short *)(param_1 + 2) == 0) || (param_1[3] == 0)) || (uVar1 = param_1[4], uVar1 == 0))
|| ((param_1[3] + (ulonglong)*(ushort *)(param_1 + 2) * 0xc <= uVar1 || (param_1[6] == 0))))
|| ((*(longlong *)(param_1[6] + 8) == 0 ||
((param_1[7] == 0 || ((ulonglong)param_1[8] < (ulonglong)param_1[7])))))) ||
(*(int *)(param_1 + 9) == 0)) {
uVar2 = 0x57;
}
else {
if (((*(byte *)(uVar1 + 8) & 1) != 0) &&

return uVar2;
}
if ((ulonglong)param_1[4] < param_1[3] + ((ulonglong)*(ushort *)(param_1 + 2) * 3 + -3) * 4) {
lVar3 = param_1[4] + 0xc;
}
else {
*(undefined2 *)(param_1 + 2) = 0;
param_1[3] = 0;
*(undefined4 *)(param_1 + 5) = 0;
param_1[6] = 0;
param_1[7] = 0;
param_1[8] = 0;
}
param_1[4] = lVar3;
uVar2 = 0;
*(undefined4 *)(param_1 + 9) = 0;
}
return uVar2;
}
=========================================
Function at address: 0x180077ae0
Called functions addresses: 0x18002a7c0


undefined8 FUN_180077ae0(longlong param_1)

{
ulonglong uVar1;
ulonglong uVar2;
undefined8 uVar3;
ushort uVar4;

if (((((*(short *)(param_1 + 0x10) == 0) || (*(longlong *)(param_1 + 0x18) == 0)) ||
(uVar1 = *(ulonglong *)(param_1 + 0x20), uVar1 == 0)) ||
((*(longlong *)(param_1 + 0x18) + (ulonglong)*(ushort *)(param_1 + 0x10) * 0xc <= uVar1 ||
((*(byte *)(uVar1 + 8) & 1) == 0)))) ||
((uVar1 = *(ulonglong *)(param_1 + 0x38), uVar1 == 0 ||
((uVar2 = *(ulonglong *)(param_1 + 0x40), uVar2 < uVar1 || (*(int *)(param_1 + 0x48) == 0)))))
) {
uVar3 = 0x57;
}
else {
if ((longlong)(uVar2 - uVar1) < (longlong)(ulonglong)*(uint *)(param_1 + 0x48)) {
uVar4 = (short)uVar2 - *(short *)(param_1 + 0x38);
}
else {
uVar4 = *(ushort *)(param_1 + 0x48);
}

(*(undefined8 *)(param_1 + 8),uVar2 - uVar4,(ulonglong)uVar4,
CONCAT71((uint7)(byte)(uVar4 >> 8),1));
}
return uVar3;
}
=========================================
Function at address: 0x180077ba0
Called functions addresses: None


undefined8 FUN_180077ba0(longlong param_1,ushort param_2,ushort *param_3,int *param_4)

{
ushort uVar1;
undefined8 uVar2;
ushort *puVar3;
int iVar4;
int iVar5;

iVar5 = 0;
if ((((*(longlong *)(param_1 + 0x30) == 0) && (param_2 != 0)) && (param_3 != (ushort *)0x0)) &&
(param_4 != (int *)0x0)) {
puVar3 = param_3;
iVar4 = 0;
if (param_3 < param_3 + (ulonglong)param_2 * 6) {
do {
uVar1 = *puVar3;
puVar3 = puVar3 + 6;
iVar5 = iVar4 + (uint)uVar1;
iVar4 = iVar5;
} while (puVar3 < param_3 + (ulonglong)param_2 * 6);
}
*(ushort *)(param_1 + 0x10) = param_2;
uVar2 = 0;
*(ushort **)(param_1 + 0x18) = param_3;
*(ushort **)(param_1 + 0x20) = param_3;
*(int *)(param_1 + 0x28) = iVar5;
*param_4 = iVar5;
}
else {
uVar2 = 0x57;
}
return uVar2;
}
=========================================
Function at address: 0x180077c10
Called functions addresses: None


undefined8 FUN_180077c10(longlong param_1,uint *param_2)

{
short *psVar1;
undefined8 uVar2;
short *psVar3;

if (((((*(short *)(param_1 + 0x10) != 0) &&
(psVar3 = *(short **)(param_1 + 0x18), psVar3 != (short *)0x0)) &&
(*(longlong *)(param_1 + 0x30) == 0)) &&
((param_2 != (uint *)0x0 && (*(uint *)(param_1 + 0x28) <= *param_2)))) &&
((param_2[1] == 0 && (*(longlong *)(param_2 + 2) != 0)))) {
*(uint **)(param_1 + 0x30) = param_2;
uVar2 = *(undefined8 *)(param_2 + 2);
*(undefined8 *)(param_1 + 0x38) = uVar2;
*(undefined8 *)(param_1 + 0x40) = uVar2;
*(undefined4 *)(param_1 + 0x48) = 0;
*(short **)(param_1 + 0x20) = psVar3;
psVar1 = psVar3 + (ulonglong)*(ushort *)(param_1 + 0x10) * 6;
while ((psVar3 < psVar1 && (*psVar3 == 0))) {
psVar3 = psVar3 + 6;
*(short **)(param_1 + 0x20) = psVar3;
}
return 0;
}
return 0x57;
}
=========================================
Function at address: 0x180077c90
Called functions addresses: 0x18002a77b


undefined4 FUN_180077c90(longlong param_1,ushort param_2,void *param_3)

{
int *piVar1;

if (param_2 != 0) {
if (param_3 == (void *)0x0) {
return 0x57;
}
memcpy(*(void **)(param_1 + 0x40),param_3,(ulonglong)param_2);
*(longlong *)(param_1 + 0x40) = *(longlong *)(param_1 + 0x40) + (ulonglong)param_2;
*(int *)(param_1 + 0x48) = *(int *)(param_1 + 0x48) + (uint)param_2;
piVar1 = (int *)(*(longlong *)(param_1 + 0x30) + 4);
*piVar1 = *piVar1 + (uint)param_2;
}
return 0;
}
=========================================
Function at address: 0x180077cf0
Called functions addresses: 0x18002a548 0x18005e558 0x18005b470 0x18000eb08 0x180028070


void FUN_180077cf0(longlong param_1,ushort *param_2,ushort param_3)

{
bool bVar1;
int iVar2;
undefined8 uVar3;
longlong *plVar4;
undefined uVar5;
undefined auStack_78 [32];
int local_58 [2];
ushort local_50 [20];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_78;
local_50[0] = 0;
local_50[0x11] = 0;
local_58[0] = 0;
local_50[1] = 0;
local_50[2] = 0;
local_50[3] = 0;
local_50[4] = 0;
local_50[5] = 0;
local_50[6] = 0;
local_50[7] = 0;
local_50[8] = 0;
local_50[9] = 0;
local_50[10] = 0;
local_50[0xb] = 0;
local_50[0xc] = 0;
local_50[0xd] = 0;
local_50[0xe] = 0;
local_50[0xf] = 0;
local_50[0x10] = 0;
uVar3 = FUN_18005e558(local_50,param_2,(uint)param_3,local_58);
plVar4 = *(longlong **)(param_1 + 8);
iVar2 = (int)uVar3;
if (iVar2 == 0) {
if ((ushort *)((longlong)plVar4 + 0x1da) == (ushort *)0x0) goto LAB_180077da5;
FUN_18000eb08((ushort *)((longlong)plVar4 + 0x1fe),(ushort *)((longlong)plVar4 + 0x1da));
bVar1 = FUN_18002a548((ushort *)(*(longlong *)(param_1 + 8) + 0x1fe),(longlong)local_50,
*(uint *)(*(longlong *)(param_1 + 8) + 0x40));
if (bVar1) goto LAB_180077da5;
plVar4 = *(longlong **)(param_1 + 8);
iVar2 = -0x7ff6fccf;
uVar5 = 0x28;
}
else {
uVar5 = 0x2f;
}
FUN_18005b470(plVar4,0x192,iVar2,uVar5);
LAB_180077da5:
FUN_180028070(local_28 ^ (ulonglong)auStack_78);
return;
}
=========================================
Function at address: 0x180077dc4
Called functions addresses: None


undefined8 FUN_180077dc4(longlong param_1,longlong param_2,ushort param_3)

{
longlong lVar1;
undefined8 uVar2;

uVar2 = 0;
if ((((param_2 != 0) && (1 < param_3)) && (*(int *)(*(longlong *)(param_1 + 8) + 0x44) == 100)) &&
((ushort)(param_3 - 2) != 0)) {
lVar1 = *(longlong *)(param_1 + 0x40);
if ((*(longlong *)(lVar1 + 0x6d0) == 0) && (*(short *)(lVar1 + 0x6d8) == 0)) {
*(ushort *)(lVar1 + 0x6d8) = param_3 - 2;
*(longlong *)(lVar1 + 0x6d0) = param_2 + 2;
}
else {
uVar2 = 0x13b;
}
return uVar2;
}
return 0x80090308;
}
=========================================
Function at address: 0x180077e40
Called functions addresses: 0x18000a590 0x180078520 0x1800785bc 0x180077cf0 0x18006e97c 0x180077dc4 0x180061214 0x180077f68 0x18006d7ac 0x1800780dc


void FUN_180077e40(longlong param_1,ulonglong param_2,ushort *param_3,ushort param_4)

{
char cVar1;
uint uVar2;
undefined8 uVar3;
int iVar4;
uint uVar5;

iVar4 = (int)param_2;
uVar5 = *(uint *)(param_1 + 0x10) & 0xff;
uVar2 = iVar4 << 8 | uVar5;
if (uVar2 == 0x50b) {
FUN_180078520(param_1,(char *)param_3,param_4);
}
else if (uVar2 == 0xd0d) {
FUN_180077cf0(param_1,param_3,param_4);
}
else if (uVar2 == 0x2902) {
FUN_1800780dc(param_1,(undefined *)param_3,param_4);
}
else if (uVar2 == 0x2b02) {
FUN_1800785bc(param_1,(undefined *)param_3,param_4);
}
else if (uVar2 == 0x2c02) {
FUN_180077dc4(param_1,(longlong)param_3,param_4);
}
else if (uVar2 == 0x2f0d) {
FUN_180061214(*(longlong **)(param_1 + 0x40),(undefined *)param_3,(uint)param_4);
}
else if (uVar2 == 0x3302) {
FUN_180077f68(param_1,(undefined *)param_3,param_4);
}
else {
cVar1 = FUN_18006d7ac(param_2 & 0xffff);
if ((cVar1 != '\0') &&
(uVar3 = FUN_18006e97c(*(longlong *)(param_1 + 0x40) + 0x558,(short)param_2,uVar5,
(longlong)param_3,param_4), (int)uVar3 != 0)) {
return;
}
FUN_18000a590(param_1,iVar4,(byte *)param_3,param_4);
}
return;
}
=========================================
Function at address: 0x180077f68
Called functions addresses: 0x18005b470


undefined8 FUN_180077f68(longlong param_1,undefined *param_2,ushort param_3)

{
longlong lVar1;
longlong *plVar2;
short sVar3;

if (1 < param_3) {
sVar3 = CONCAT11(*param_2,param_2[1]);
if (param_3 == 2) {
plVar2 = *(longlong **)(param_1 + 8);
if (*(int *)((longlong)plVar2 + 0x44) == 100) {
*(short *)(*(longlong *)(param_1 + 0x40) + 0x72c) = sVar3;
return 0;
}
goto LAB_18007802f;
}
if (1 < (ushort)(param_3 - 2)) {
if ((CONCAT11(param_2[2],param_2[3]) != 0) &&
(CONCAT11(param_2[2],param_2[3]) == (ushort)(param_3 - 4))) {
lVar1 = *(longlong *)(param_1 + 0x40);
if (*(short *)(lVar1 + 0x72c) == 0) {
plVar2 = *(longlong **)(param_1 + 8);
if (*(short *)plVar2[0x72] != sVar3) goto LAB_18007802f;
LAB_180078012:
*(short *)(lVar1 + 0x72e) = sVar3;
*(undefined **)(lVar1 + 0x730) = param_2 + 4;
*(ushort *)(lVar1 + 0x738) = param_3 - 4;
return 0;
}
if (*(short *)(lVar1 + 0x72c) == sVar3) goto LAB_180078012;
}
}
}
plVar2 = *(longlong **)(param_1 + 8);
LAB_18007802f:
FUN_18005b470(plVar2,0x6a,0x80090308,0x32);
return 0x80090308;
}
=========================================
Function at address: 0x180078054
Called functions addresses: 0x18006f1c4 0x18005b470


undefined4 FUN_180078054(longlong param_1,undefined *param_2,ushort param_3)

{
undefined4 uVar1;
ushort uVar2;

if ((param_2 != (undefined *)0x0) && (1 < param_3)) {
uVar2 = CONCAT11(*param_2,param_2[1]);
if (uVar2 == 0) {
if (*(int *)(*(longlong *)(param_1 + 8) + 0x44) != 0x47) {
return 0;
}
}
else if ((1 < uVar2) && (uVar2 == (ushort)(param_3 - 2))) {
uVar1 = FUN_18006f1c4(*(longlong *)(param_1 + 0x28),param_2 + 2,param_3 - 2);
return uVar1;
}
}
FUN_18005b470(*(longlong **)(param_1 + 8),0x4b2,0x80090308,0x32);
return 0x80090308;
}
=========================================
Function at address: 0x1800780dc
Called functions addresses: 0x18005b470


undefined8 FUN_1800780dc(longlong param_1,undefined *param_2,ushort param_3)

{
ulonglong *puVar1;
undefined8 uVar2;

if ((param_2 == (undefined *)0x0) || (param_3 < 2)) {
uVar2 = 0x80090308;
}
else if (CONCAT11(*param_2,param_2[1]) == 0) {
puVar1 = (ulonglong *)(*(longlong *)(param_1 + 0x40) + 0x88);
*puVar1 = *puVar1 & 0xffffffffffff7fff;
uVar2 = 0;
}
else {
FUN_18005b470(*(longlong **)(param_1 + 8),0x6a,0x80090326,0x2f);
uVar2 = 0x80090326;
}
return uVar2;
}
=========================================
Function at address: 0x180078140
Called functions addresses: 0x180059568 0x18005b470 0x1800631d0 0x18002a7c0 0x18006f3a0


int FUN_180078140(longlong param_1,undefined *param_2,ushort param_3)

{
byte bVar1;
longlong lVar2;
char cVar3;
int iVar4;
undefined8 uVar5;
longlong *plVar6;
ushort uVar7;
undefined *puVar8;
undefined *puVar9;
short sVar10;
ushort uVar11;
ushort uVar12;
ushort uVar13;
short sVar14;
uint *puVar15;
byte *pbVar16;
byte *pbVar17;

if ((param_2 != (undefined *)0x0) && (1 < param_3)) {
lVar2 = *(longlong *)(param_1 + 8);
if (*(longlong *)(lVar2 + 0x50) == 0) {
iVar4 = 0x54f;
goto LAB_1800783ac;
}
if ((*(uint *)(lVar2 + 0x88) >> 0x19 & 1) == 0) {
return 0;
}
if ((*(byte *)(*(longlong *)(lVar2 + 0x50) + 0x9c) & 0x20) != 0) {
return 0;
}
if (*(char *)(param_1 + 0x1b) == '\0') {
return 0;
}
if ((*(uint *)(lVar2 + 0x40) & 0x1000) == 0) {
return 0;
}
puVar8 = param_2 + 2;
uVar12 = CONCAT11(*param_2,param_2[1]);
if (uVar12 <= (ushort)(param_3 - 2)) {
puVar9 = puVar8 + uVar12;
uVar13 = (param_3 - 2) - uVar12;
if ((1 < uVar13) && (sVar10 = CONCAT11(*puVar9,puVar9[1]), sVar10 == (ushort)(uVar13 - 2))) {
uVar13 = sVar10 + 2;
sVar14 = 0;
pbVar17 = puVar9 + 2;
while( true ) {
if (uVar12 == 0) {
return 0;
}
if (sVar10 == 0) {
return 0;
}
if (uVar12 < 0x26) goto LAB_1800783a7;
puVar15 = (uint *)(puVar8 + 2);
uVar7 = CONCAT11(*puVar8,puVar8[1]);
if (((ushort)(uVar12 - 2) < uVar7) || (uVar12 = (uVar12 - 2) - uVar7, uVar12 < 4))
goto LAB_1800783a7;
puVar8 = puVar8 + (ulonglong)uVar7 + 6;
uVar11 = sVar10 - 1;
uVar12 = uVar12 - 4;
bVar1 = *pbVar17;
pbVar16 = pbVar17 + 1;
if (uVar11 <= bVar1 && bVar1 != uVar11) goto LAB_1800783a7;
plVar6 = *(longlong **)(param_1 + 0x28);
sVar10 = uVar11 - bVar1;
pbVar17 = pbVar16 + bVar1;
lVar2 = plVar6[0xf];
if (uVar7 == 0x20) {
if ((lVar2 != 0) && (DAT_1800927ac != '\0')) {
*(ushort *)(lVar2 + 0x40) = *(ushort *)(lVar2 + 0x40) | 1;
*(undefined4 *)(lVar2 + 0x18) = 1;
plVar6 = *(longlong **)(param_1 + 0x28);
}
if (puVar15 == (uint *)0x0) {
cVar3 = '\0';
}
else {
uVar5 = FUN_180059568(DAT_1800927f0,(longlong)plVar6,puVar15,0x20,plVar6 + 0x7c);
cVar3 = (char)uVar5;
}
}
else {
if ((lVar2 != 0) && (DAT_1800927ac != '\0')) {
*(undefined4 *)(lVar2 + 0x18) = 1;
*(ushort *)(lVar2 + 0x40) = *(ushort *)(lVar2 + 0x40) | 2;
plVar6 = *(longlong **)(param_1 + 0x28);
}
cVar3 = FUN_1800631d0(plVar6,(undefined8 *)puVar15,(uint)uVar7,
(uint *)((longlong)plVar6 + 0x4e1),
(uint)*(byte *)((longlong)plVar6 + 0x501));
}
if (cVar3 != '\0') break;
sVar14 = sVar14 + 1;
}
iVar4 = FUN_18006f3a0(*(longlong **)(param_1 + 0x28),(longlong)pbVar16,(ushort)bVar1,uVar13,
sVar14);
if (iVar4 == 0) {
return 0;
}
goto LAB_1800783ac;
}
}
}
LAB_1800783a7:
iVar4 = 0x13b;
LAB_1800783ac:
lVar2 = *(longlong *)(param_1 + 0x28);
if (*(longlong *)(lVar2 + 0x3e0) != 0) {
*(undefined *)(*(longlong *)(lVar2 + 0x3e0) + 0xec) = 0;

}
*(undefined8 *)(lVar2 + 0x58) = 0;
if (iVar4 == 0x13b) {
iVar4 = -0x7ff6fcf8;
FUN_18005b470(*(longlong **)(param_1 + 8),0x4b2,0x80090308,0x32);
}
return iVar4;
}
=========================================
Function at address: 0x180078428
Called functions addresses: 0x180041cb0 0x18005b470


undefined8 FUN_180078428(longlong param_1,byte *param_2,short param_3)

{
ulonglong *puVar1;
byte bVar2;
byte *pbVar3;
longlong *plVar4;
byte *pbVar5;

if ((param_2 == (byte *)0x0) || (param_3 == 0)) {
plVar4 = *(longlong **)(param_1 + 8);
}
else {
pbVar5 = param_2 + 1;
if ((*param_2 != 0) && ((ushort)*param_2 == (ushort)(param_3 - 1U))) {
pbVar3 = pbVar5 + (ushort)(param_3 - 1U);
if (pbVar5 < pbVar3) {
bVar2 = *pbVar5;
do {
if (bVar2 == 1) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xd,&DAT_180082c78);
}
puVar1 = (ulonglong *)(*(longlong *)(param_1 + 8) + 0x88);
*puVar1 = *puVar1 | 0x2000000;
return 0;
}
pbVar5 = pbVar5 + 1;
} while (pbVar5 < pbVar3);
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 2) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xe,&DAT_180082c78);
}
return 0;
}
plVar4 = *(longlong **)(param_1 + 8);
}
FUN_18005b470(plVar4,0x4b2,0x80090308,0x32);
return 0x80090308;
}
=========================================
Function at address: 0x180078520
Called functions addresses: 0x1800040c8 0x180041cb0 0x18005b470


undefined8 FUN_180078520(longlong param_1,char *param_2,ushort param_3)

{
longlong *plVar1;
undefined8 uVar2;

plVar1 = *(longlong **)(param_1 + 8);
if (plVar1[1] == 0) {
return 0x80090304;
}
if (*(int *)(plVar1[1] + 0x30) == 4) {
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],10,&DAT_180082c78);
plVar1 = *(longlong **)(param_1 + 8);
}
FUN_18005b470(plVar1,200,0x80090326,10);
return 0x80090326;
}
plVar1[0x11] = plVar1[0x11] | 0x20000;
uVar2 = FUN_1800040c8(*(longlong **)(param_1 + 0x40),param_2,(uint)param_3);
return uVar2;
}
=========================================
Function at address: 0x1800785bc
Called functions addresses: 0x18000d31c 0x18005b470 0x180005fc4


undefined8 FUN_1800785bc(longlong param_1,undefined *param_2,short param_3)

{
uint uVar1;
undefined8 uVar2;
longlong lVar3;
longlong *plVar4;

if ((param_2 != (undefined *)0x0) && (param_3 == 2)) {
plVar4 = *(longlong **)(param_1 + 0x40);
if (0x303 < CONCAT11(*param_2,param_2[1])) {
lVar3 = plVar4[10];
if (lVar3 == 0) {
return 0x80090304;
}
uVar2 = FUN_180005fc4((uint)CONCAT11(*param_2,param_2[1]));
uVar1 = (uint)uVar2 & *(uint *)(lVar3 + 0x98) & 0xa2aa0;
if (uVar1 == 0) {
FUN_18005b470(plVar4,0x4b1,0x80090331,0x46);
return 0x80090331;
}
*(uint *)(plVar4 + 8) = uVar1;
uVar2 = FUN_18000d31c(uVar1);
*(short *)((longlong)plVar4 + 0x22) = (short)uVar2;
*(undefined *)(param_1 + 0x1b) = 1;
return 0;
}
FUN_18005b470(plVar4,100,0x80090308,0x2f);
}
return 0x80090308;
}
=========================================
Function at address: 0x180078668
Called functions addresses: 0x180041cdc 0x18000d31c 0x180041cb0 0x180012184 0x18005b470


undefined4 FUN_180078668(longlong param_1,byte *param_2,short param_3)

{
byte bVar1;
ushort uVar2;
undefined8 uVar3;
uint *puVar4;
longlong *plVar5;
byte *pbVar6;
undefined4 uVar7;
byte *pbVar8;
undefined uVar9;
uint uVar10;
uint uVar11;
longlong lVar12;

if ((param_2 == (byte *)0x0) || (param_3 == 0)) {
plVar5 = *(longlong **)(param_1 + 8);
}
else {
bVar1 = *param_2;
pbVar6 = param_2 + 1;
if (((1 < bVar1) && ((bVar1 & 1) == 0)) && ((ushort)bVar1 == (ushort)(param_3 - 1U))) {
lVar12 = *(longlong *)(param_1 + 8);
if (*(longlong *)(lVar12 + 0x50) == 0) {
FUN_180012184(lVar12,0x4b2,0x54f);
return 0x54f;
}
puVar4 = &DAT_180082be8;
do {
uVar10 = *puVar4 & *(uint *)(*(longlong *)(lVar12 + 0x50) + 0x98) & 0x40051555;
if ((uVar10 != 0) && (pbVar6 < pbVar6 + (ushort)(param_3 - 1U))) {
uVar2 = *(ushort *)(puVar4 + 1);
pbVar8 = pbVar6;
do {
uVar11 = (uint)CONCAT11(*pbVar8,pbVar8[1]);
if (uVar11 == uVar2) {
*(uint *)(lVar12 + 0x40) = uVar10;
uVar3 = FUN_18000d31c(uVar10);
*(short *)(lVar12 + 0x22) = (short)uVar3;
*(uint *)(*(longlong *)(param_1 + 8) + 0x24) = uVar11;
lVar12 = *(longlong *)(*(longlong *)(param_1 + 8) + 0x78);
if ((lVar12 != 0) && (DAT_1800927ac != '\0')) {
*(uint *)(lVar12 + 0x2c) = uVar11;
}
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 4) != 0)) {
FUN_180041cdc(DAT_180091000[2],0xb,&DAT_180082c78,(uint)uVar2);
}
*(undefined *)(param_1 + 0x1b) = 1;
return 0;
}
pbVar8 = pbVar8 + 2;
} while (pbVar8 < pbVar6 + (ushort)(param_3 - 1U));
}
puVar4 = puVar4 + 2;
} while (puVar4 < &DAT_180082c10);
if (((undefined8 **)DAT_180091000 != &DAT_180091000) &&
((*(byte *)((longlong)DAT_180091000 + 0x1c) & 1) != 0)) {
FUN_180041cb0(DAT_180091000[2],0xc,&DAT_180082c78);
}
plVar5 = *(longlong **)(param_1 + 8);
uVar9 = 0x46;
uVar7 = 0x80090331;
goto LAB_180078800;
}
plVar5 = *(longlong **)(param_1 + 8);
}
uVar7 = 0x80090308;
uVar9 = 0x32;
LAB_180078800:
FUN_18005b470(plVar5,0x4b2,uVar7,uVar9);
return uVar7;
}
=========================================
Function at address: 0x180078830
Called functions addresses: 0x18002a7c0


void FUN_180078830(longlong param_1)

{
int iVar1;


(*(undefined8 *)(param_1 + 8),1,&DAT_1800863c0);
if (iVar1 == 0) {

}
return;
}
=========================================
Function at address: 0x18007888c
Called functions addresses: 0xEXTERNAL:000000d5


void FUN_18007888c(void)

{
uint uVar1;
longlong *plVar2;

uVar1 = 7;
if (7 < DAT_180092218) {
do {
plVar2 = (longlong *)(&DAT_180092220)[uVar1];
if ((plVar2 != (longlong *)0x0) && (*plVar2 != 0)) {
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,*plVar2);
plVar2 = (longlong *)(&DAT_180092220)[uVar1];
}
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,plVar2);
(&DAT_180092220)[uVar1] = 0;
uVar1 = uVar1 + 1;
} while (uVar1 < DAT_180092218);
}
DAT_180092218 = 7;
return;
}
=========================================
Function at address: 0x180078934
Called functions addresses: 0x18004538c 0xEXTERNAL:000000a6 0x180016034 0x180079924 0x180016064 0x180028070 0x180028d30 0x180028d78 0xEXTERNAL:000000d9 0x18001610c 0x180028d90 0x18007888c 0xEXTERNAL:000000d5


void FUN_180078934(void)

{
int iVar1;
uint uVar2;
ulonglong uVar3;
longlong *plVar4;
longlong lVar5;
int iVar6;
undefined auStack_408 [32];
undefined4 local_3e8;
undefined4 *local_3e0;
longlong local_3d8;
undefined4 local_3d0;
undefined4 local_3cc;
longlong local_3c8 [2];
undefined local_3b8 [16];
short local_3a8 [264];
short local_198 [64];
short local_118 [64];
short local_98 [64];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_408;
iVar6 = 0;
local_3c8[0] = 0;
local_3d8 = 0;
memset(local_118,0,0x80);
memset(local_98,0,0x80);
memset(local_198,0,0x80);
local_3d0 = 0;
FUN_18007888c();
if ((DAT_180092218 < 0x10) && (uVar3 = FUN_18001610c(0x1800863d0,0,local_3c8), -1 < (int)uVar3)) {
while (DAT_180092218 < 0x10) {
memset(local_3b8,0,0x218);
local_3e0 = &local_3cc;
local_3e8 = 0x218;
local_3cc = 0;
iVar1 = NtEnumerateKey(local_3c8[0],iVar6,0);
if (iVar1 < 0) break;
uVar3 = 0xffffffffffffffff;
do {
uVar3 = uVar3 + 1;
} while (local_3a8[uVar3] != 0);
uVar2 = FUN_18004538c(local_118,0x40,(longlong)local_3a8,uVar3);
if ((int)uVar2 < 0) break;
uVar3 = FUN_18001610c(0x1800863d0,(longlong)local_118,&local_3d8);
if (-1 < (int)uVar3) {
iVar1 = FUN_180079924(local_3d8,L"CngAlgorithm",local_98);
if (((iVar1 < 0) || (iVar1 = FUN_180016064(local_3d8,L"TlsCodePoint",&local_3d0), iVar1 < 0)
) || (iVar1 = FUN_180079924(local_3d8,L"SignatureStyle",local_198), iVar1 < 0)) {
FUN_180016034(&local_3d8);
}
else {
FUN_180016034(&local_3d8);
plVar4 = (longlong *)
RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,0x18)
;
if (plVar4 != (longlong *)0x0) {
*plVar4 = 0;
plVar4[1] = 0;
plVar4[2] = 0;
lVar5 = RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,0x80
);
*plVar4 = lVar5;
if (lVar5 == 0) {
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,plVar4);
}
else {
_o_wcscpy_s(lVar5,0x40,local_98);
uVar2 = DAT_180092218;
*(uint *)((longlong)plVar4 + 0xc) = DAT_180092218 + 0x2ff9;
*(uint *)(plVar4 + 1) = uVar2 + 0xdffffffa;
*(undefined4 *)(plVar4 + 2) = local_3d0;
iVar1 = _o__wcsicmp(local_198);
if (iVar1 == 0) {
*(undefined4 *)((longlong)plVar4 + 0x14) = 2;
}
else {
iVar1 = _o__wcsicmp(local_198);
if (iVar1 == 0) {
*(undefined4 *)((longlong)plVar4 + 0x14) = 3;
}
else {
iVar1 = _o__wcsicmp();
*(uint *)((longlong)plVar4 + 0x14) = ~-(uint)(iVar1 != 0) & 4;
}
}
uVar3 = (ulonglong)DAT_180092218;
DAT_180092218 = DAT_180092218 + 1;
(&DAT_180092220)[uVar3] = plVar4;
}
}
}
}
iVar6 = iVar6 + 1;
}
FUN_180016034(local_3c8);
}
FUN_180028070(local_18 ^ (ulonglong)auStack_408);
return;
}
=========================================
Function at address: 0x180078c6c
Called functions addresses: 0xEXTERNAL:000000d5


void FUN_180078c6c(void)

{
uint uVar1;
longlong *plVar2;

uVar1 = 7;
if (7 < DAT_180092320) {
do {
plVar2 = (longlong *)(&DAT_1800922a0)[uVar1];
if ((plVar2 != (longlong *)0x0) && (*plVar2 != 0)) {
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,*plVar2);
plVar2 = (longlong *)(&DAT_1800922a0)[uVar1];
}
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,plVar2);
(&DAT_1800922a0)[uVar1] = 0;
uVar1 = uVar1 + 1;
} while (uVar1 < DAT_180092320);
}
DAT_180092320 = 7;
return;
}
=========================================
Function at address: 0x180078d14
Called functions addresses: 0x180079924


int FUN_180078d14(undefined8 param_1,short *param_2)

{
int iVar1;

iVar1 = FUN_180079924(param_1,L"CngAlgorithm",param_2);
if (-1 < iVar1) {
FUN_180079924(param_1,L"CipherMode",param_2 + 0x40);
}
return iVar1;
}
=========================================
Function at address: 0x180078d70
Called functions addresses: 0xEXTERNAL:0000016d 0xEXTERNAL:0000016e 0x18004538c 0xEXTERNAL:000000a6 0x180016034 0x180028070 0x180078c6c 0x180028d78 0xEXTERNAL:000000d9 0x18001610c 0x180028d90 0xEXTERNAL:000000d5 0xEXTERNAL:00000169 0x180078d14


void FUN_180078d70(void)

{
int iVar1;
uint uVar2;
NTSTATUS NVar3;
ulonglong uVar4;
longlong *plVar5;
longlong lVar6;
undefined8 uVar7;
int iVar8;
undefined auStackY_428 [32];
undefined4 local_3f8 [2];
longlong local_3f0;
BCRYPT_ALG_HANDLE local_3e8;
ULONG local_3e0 [2];
longlong local_3d8 [2];
WCHAR local_3c8 [64];
undefined local_348 [128];
undefined local_2c8 [16];
short local_2b8 [264];
short local_a8 [64];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStackY_428;
iVar8 = 0;
local_3d8[0] = 0;
local_3f0 = 0;
memset(local_a8,0,0x80);
local_3f8[0] = 0;
local_3e8 = (BCRYPT_HANDLE)0x0;
local_3e0[0] = 0;
FUN_180078c6c();
if ((DAT_180092320 < 0x10) && (uVar4 = FUN_18001610c(0x180086530,0,local_3d8), -1 < (int)uVar4)) {
while (DAT_180092320 < 0x10) {
memset(local_2c8,0,0x218);
iVar1 = NtEnumerateKey(local_3d8[0],iVar8,0);
if (iVar1 < 0) break;
uVar4 = 0xffffffffffffffff;
do {
uVar4 = uVar4 + 1;
} while (local_2b8[uVar4] != 0);
uVar2 = FUN_18004538c(local_a8,0x40,(longlong)local_2b8,uVar4);
if ((-1 < (int)uVar2) &&
(uVar4 = FUN_18001610c(0x180086530,(longlong)local_a8,&local_3f0), -1 < (int)uVar4)) {
memset(local_3c8,0,0x100);
iVar1 = FUN_180078d14(local_3f0,local_3c8);
if (iVar1 < 0) {
FUN_180016034(&local_3f0);
}
else {
FUN_180016034(&local_3f0);
NVar3 = BCryptOpenAlgorithmProvider(&local_3e8,local_3c8,(LPCWSTR)0x0,0);
if (-1 < NVar3) {
NVar3 = BCryptGetProperty(local_3e8,L"BlockLength",(PUCHAR)local_3f8,4,local_3e0,0);
if (NVar3 < 0) {
BCryptCloseAlgorithmProvider(local_3e8,0);
}
else {
BCryptCloseAlgorithmProvider(local_3e8,0);
plVar5 = (longlong *)
RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,
0x20);
if (plVar5 != (longlong *)0x0) {
*plVar5 = 0;
plVar5[1] = 0;
plVar5[2] = 0;
plVar5[3] = 0;
lVar6 = RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,
0x80);
*plVar5 = lVar6;
uVar7 = *(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30);
if (lVar6 != 0) {
lVar6 = RtlAllocateHeap(uVar7,0,0x80);
plVar5[3] = lVar6;
if (lVar6 != 0) {
_o_wcscpy_s(*plVar5,0x40,local_3c8);
_o_wcscpy_s(plVar5[3],0x40,local_348);
uVar2 = DAT_180092320;
DAT_180092320 = DAT_180092320 + 1;
*(uint *)((longlong)plVar5 + 0xc) = uVar2 + 0xbffffffa;
*(uint *)(plVar5 + 2) = uVar2 + 0x6ff9;
*(undefined4 *)(plVar5 + 1) = local_3f8[0];
(&DAT_1800922a0)[uVar2] = plVar5;
goto LAB_180079075;
}
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,*plVar5);
uVar7 = *(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30);
}
RtlFreeHeap(uVar7,0,plVar5);
}
}
}
}
}
LAB_180079075:
iVar8 = iVar8 + 1;
}
FUN_180016034(local_3d8);
}
FUN_180028070(local_28 ^ (ulonglong)auStackY_428);
return;
}
=========================================
Function at address: 0x1800790c4
Called functions addresses: 0x180028d3c


undefined8
FUN_1800790c4(undefined8 param_1,undefined8 param_2,undefined8 param_3,undefined4 *param_4)

{
longlong *plVar1;
uint uVar2;
int iVar3;
ulonglong uVar4;
uint uVar5;

uVar4 = 0;
if (param_4 != (undefined4 *)0x0) {
*param_4 = 0;
}
uVar2 = DAT_180092320;
if (DAT_180092320 != 0) {
do {
plVar1 = (longlong *)(&DAT_1800922a0)[uVar4];
if (((plVar1 != (longlong *)0x0) && (*plVar1 != 0)) &&
(iVar3 = _o__wcsnicmp(param_1,*plVar1,0x40), uVar2 = DAT_180092320, iVar3 == 0)) {
if ((&DAT_1800922a0)[uVar4] == 0) {
return 0x490;
}
if (param_4 != (undefined4 *)0x0) {
*param_4 = *(undefined4 *)((&DAT_1800922a0)[uVar4] + 0x10);
return 0;
}
return 0;
}
uVar5 = (int)uVar4 + 1;
uVar4 = (ulonglong)uVar5;
} while (uVar5 < uVar2);
}
return 0x490;
}
=========================================
Function at address: 0x18007916c
Called functions addresses: 0xEXTERNAL:000000d5


void FUN_18007916c(void)

{
uint uVar1;
longlong *plVar2;

uVar1 = 7;
if (7 < DAT_180092324) {
do {
plVar2 = (longlong *)(&DAT_180092330)[uVar1];
if ((plVar2 != (longlong *)0x0) && (*plVar2 != 0)) {
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,*plVar2);
plVar2 = (longlong *)(&DAT_180092330)[uVar1];
}
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,plVar2);
(&DAT_180092330)[uVar1] = 0;
uVar1 = uVar1 + 1;
} while (uVar1 < DAT_180092324);
}
DAT_180092324 = 7;
return;
}
=========================================
Function at address: 0x180079214
Called functions addresses: 0xEXTERNAL:0000016d 0xEXTERNAL:0000016e 0x18004538c 0xEXTERNAL:000000a6 0x180016034 0x180079924 0x180016064 0x180028070 0x180028d78 0xEXTERNAL:000000d9 0x18007916c 0x18001610c 0x180028d90 0xEXTERNAL:000000d5 0xEXTERNAL:00000169


void FUN_180079214(void)

{
int iVar1;
uint uVar2;
NTSTATUS NVar3;
ulonglong uVar4;
longlong *plVar5;
longlong lVar6;
int iVar7;
undefined auStackY_398 [32];
undefined4 local_368;
undefined4 local_364;
longlong local_360;
BCRYPT_ALG_HANDLE local_358;
undefined4 local_350;
ULONG local_34c;
longlong local_348 [2];
undefined local_338 [16];
short local_328 [264];
WCHAR local_118 [64];
short local_98 [64];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_398;
iVar7 = 0;
local_348[0] = 0;
local_360 = 0;
memset(local_98,0,0x80);
memset(local_118,0,0x80);
local_368 = 0;
local_358 = (BCRYPT_HANDLE)0x0;
local_34c = 0;
local_364 = 0;
FUN_18007916c();
if ((DAT_180092324 < 0x10) && (uVar4 = FUN_18001610c(0x180086630,0,local_348), -1 < (int)uVar4)) {
while (DAT_180092324 < 0x10) {
memset(local_338,0,0x218);
local_350 = 0;
iVar1 = NtEnumerateKey(local_348[0],iVar7,0);
if (iVar1 < 0) break;
uVar4 = 0xffffffffffffffff;
do {
uVar4 = uVar4 + 1;
} while (local_328[uVar4] != 0);
uVar2 = FUN_18004538c(local_98,0x40,(longlong)local_328,uVar4);
if ((-1 < (int)uVar2) &&
(uVar4 = FUN_18001610c(0x180086630,(longlong)local_98,&local_360), -1 < (int)uVar4)) {
iVar1 = FUN_180079924(local_360,L"CngAlgorithm",local_118);
if ((iVar1 < 0) || (iVar1 = FUN_180016064(local_360,L"TlsCodePoint",&local_364), iVar1 < 0))
{
FUN_180016034(&local_360);
}
else {
FUN_180016034(&local_360);
NVar3 = BCryptOpenAlgorithmProvider(&local_358,local_118,(LPCWSTR)0x0,0);
if (-1 < NVar3) {
NVar3 = BCryptGetProperty(local_358,L"HashDigestLength",(PUCHAR)&local_368,4,&local_34c,
0);
if (NVar3 < 0) {
BCryptCloseAlgorithmProvider(local_358,0);
}
else {
BCryptCloseAlgorithmProvider(local_358,0);
plVar5 = (longlong *)
RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,
0x18);
if (plVar5 != (longlong *)0x0) {
*plVar5 = 0;
plVar5[1] = 0;
plVar5[2] = 0;
lVar6 = RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,
0x80);
*plVar5 = lVar6;
if (lVar6 == 0) {
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,plVar5);
}
else {
_o_wcscpy_s(lVar6,0x40,local_118);
*(undefined4 *)(plVar5 + 1) = local_368;
(&DAT_180092330)[DAT_180092324] = plVar5;
*(uint *)(plVar5 + 2) = DAT_180092324 + 0x8ff9;
*(uint *)((longlong)plVar5 + 0xc) = DAT_180092324 + 0xeffffffa;
DAT_180092324 = DAT_180092324 + 1;
*(undefined4 *)((longlong)plVar5 + 0x14) = local_364;
}
}
}
}
}
}
iVar7 = iVar7 + 1;
}
FUN_180016034(local_348);
}
FUN_180028070(local_18 ^ (ulonglong)auStackY_398);
return;
}
=========================================
Function at address: 0x180079550
Called functions addresses: 0xEXTERNAL:000000d5


void FUN_180079550(void)

{
uint uVar1;
longlong *plVar2;

uVar1 = 7;
if (7 < DAT_1800923b0) {
do {
plVar2 = (longlong *)(&DAT_1800923c0)[uVar1];
if ((plVar2 != (longlong *)0x0) && (*plVar2 != 0)) {
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,*plVar2);
plVar2 = (longlong *)(&DAT_1800923c0)[uVar1];
}
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,plVar2);
(&DAT_1800923c0)[uVar1] = 0;
uVar1 = uVar1 + 1;
} while (uVar1 < DAT_1800923b0);
}
DAT_1800923b0 = 7;
return;
}
=========================================
Function at address: 0x1800795f8
Called functions addresses: 0xEXTERNAL:000000d9 0x18001610c 0x180028d90 0x18004538c 0xEXTERNAL:000000a6 0xEXTERNAL:000000d5 0x180079924 0x180016034 0x180028070 0x180028d30 0x180079550 0x180028d78


void FUN_1800795f8(void)

{
int iVar1;
uint uVar2;
ulonglong uVar3;
longlong *plVar4;
longlong lVar5;
int iVar6;
undefined auStack_408 [32];
undefined4 local_3e8;
undefined4 *local_3e0;
longlong local_3d8;
undefined4 local_3d0 [2];
longlong local_3c8 [2];
undefined local_3b8 [16];
short local_3a8 [264];
short local_198 [64];
short local_118 [64];
short local_98 [64];
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStack_408;
iVar6 = 0;
local_3c8[0] = 0;
local_3d8 = 0;
memset(local_118,0,0x80);
memset(local_98,0,0x80);
memset(local_198,0,0x80);
FUN_180079550();
if ((DAT_1800923b0 < 0xc) && (uVar3 = FUN_18001610c(0x180086710,0,local_3c8), -1 < (int)uVar3)) {
while (DAT_1800923b0 < 0xc) {
memset(local_3b8,0,0x218);
local_3e0 = local_3d0;
local_3e8 = 0x218;
local_3d0[0] = 0;
iVar1 = NtEnumerateKey(local_3c8[0],iVar6,0);
if (iVar1 < 0) break;
uVar3 = 0xffffffffffffffff;
do {
uVar3 = uVar3 + 1;
} while (local_3a8[uVar3] != 0);
uVar2 = FUN_18004538c(local_118,0x40,(longlong)local_3a8,uVar3);
if ((int)uVar2 < 0) break;
uVar3 = FUN_18001610c(0x180086710,(longlong)local_118,&local_3d8);
if (-1 < (int)uVar3) {
iVar1 = FUN_180079924(local_3d8,L"CngAlgorithm",local_98);
if ((iVar1 < 0) || (iVar1 = FUN_180079924(local_3d8,L"MessageFlow",local_198), iVar1 < 0)) {
FUN_180016034(&local_3d8);
}
else {
FUN_180016034(&local_3d8);
plVar4 = (longlong *)
RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,0x18)
;
if (plVar4 != (longlong *)0x0) {
*plVar4 = 0;
plVar4[1] = 0;
plVar4[2] = 0;
lVar5 = RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,0x80
);
*plVar4 = lVar5;
if (lVar5 == 0) {
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,plVar4);
}
else {
_o_wcscpy_s(lVar5,0x40,local_98);
uVar2 = DAT_1800923b0;
*(uint *)((longlong)plVar4 + 0xc) = DAT_1800923b0 + 0xaff9;
*(uint *)(plVar4 + 1) = uVar2 + 0xcffffffa;
iVar1 = _o__wcsicmp(local_198);
if (iVar1 == 0) {
*(undefined4 *)(plVar4 + 2) = 1;
}
else {
iVar1 = _o__wcsicmp(local_198);
if (iVar1 == 0) {
*(undefined4 *)(plVar4 + 2) = 2;
}
else {
iVar1 = _o__wcsicmp(local_198);
if (iVar1 == 0) {
*(undefined4 *)(plVar4 + 2) = 3;
}
else {
iVar1 = _o__wcsicmp();
*(uint *)(plVar4 + 2) = ~-(uint)(iVar1 != 0) & 4;
}
}
}
uVar3 = (ulonglong)DAT_1800923b0;
DAT_1800923b0 = DAT_1800923b0 + 1;
(&DAT_1800923c0)[uVar3] = plVar4;
}
}
}
}
iVar6 = iVar6 + 1;
}
FUN_180016034(local_3c8);
}
FUN_180028070(local_18 ^ (ulonglong)auStack_408);
return;
}
=========================================
Function at address: 0x180079924
Called functions addresses: 0x180028d90 0x18004538c 0xEXTERNAL:000000c8 0xEXTERNAL:000000d4 0x180028070


void FUN_180079924(undefined8 param_1,undefined8 param_2,short *param_3)

{
int iVar1;
undefined auStack_108 [32];
undefined4 local_e8;
undefined4 *local_e0;
undefined4 local_d8 [2];
undefined8 local_d0;
undefined8 uStack_c8;
undefined local_b8 [4];
int local_b4;
uint local_b0;
undefined local_ac [132];
ulonglong local_28;

local_28 = DAT_180091970 ^ (ulonglong)auStack_108;
local_d8[0] = 0;
local_d0 = 0;
uStack_c8 = 0;
memset(local_b8,0,0x90);
RtlInitUnicodeString(&local_d0,param_2);
local_e0 = local_d8;
local_e8 = 0x90;
iVar1 = NtQueryValueKey(param_1,&local_d0,2,local_b8);
if (((-1 < iVar1) && (local_b4 == 1)) && (local_b0 - 1 < 0x7d)) {
FUN_18004538c(param_3,0x40,(longlong)local_ac,(ulonglong)(local_b0 >> 1));
}
FUN_180028070(local_28 ^ (ulonglong)auStack_108);
return;
}
=========================================
Function at address: 0x180079a10
Called functions addresses: 0x18002a77b 0xEXTERNAL:0000008a 0x18007a540 0x18002a700 0xEXTERNAL:00000198 0x18007a240 0x180028070 0x18007a4a8 0xEXTERNAL:00000096 0xEXTERNAL:00000087 0xEXTERNAL:00000098 0x180028d6c 0xEXTERNAL:000000d9 0xEXTERNAL:00000085 0xEXTERNAL:00000041 0xEXTERNAL:00000197 0x180028d90 0x18002a2c4 0xEXTERNAL:00000099 0xEXTERNAL:000000e5 0xEXTERNAL:00000196 0x180028d84


/* WARNING: Function: _alloca_probe replaced with injection: alloca_probe */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_180079a10(longlong param_1,uint param_2,int param_3)

{
uint *puVar1;
bool bVar2;
BOOL BVar3;
DWORD DVar4;
int iVar5;
longlong lVar6;
ulonglong uVar7;
void *_Dst;
undefined8 uVar8;
uint uVar9;
wchar_t *_DstBuf;
ulonglong uVar10;
uint uVar11;
undefined auStack_1088 [32];
WCHAR *local_1068;
wchar_t *local_1060;
uint local_1058;
undefined8 *local_1050;
DWORD local_1048;
DWORD local_1040;
uint local_1038;
uint local_1030;
WCHAR *local_1028;
uint local_1020;
ushort *local_1018;
uint local_1008;
UINT local_1004;
uint local_1000;
undefined8 local_ff8;
undefined8 uStack_ff0;
undefined8 local_fe8;
undefined8 uStack_fe0;
undefined8 local_fd8;
undefined8 uStack_fd0;
_OSVERSIONINFOW local_fc8;
ushort local_eb4;
ushort local_eb2;
ushort local_eb0;
byte local_eae;
wchar_t local_ea8 [259];
undefined2 local_ca2;
WCHAR local_c98 [259];
undefined2 local_a92;
WCHAR local_a88 [264];
WCHAR local_878 [259];
undefined2 local_672;
WCHAR local_668 [264];
WCHAR local_458 [4];
undefined2 auStack_450 [260];
ushort local_248 [264];
ulonglong local_38;
undefined8 uStack_30;

uStack_30 = 0x180079a39;
local_38 = DAT_180091970 ^ (ulonglong)auStack_1088;
memset(&local_fc8,0,0x11c);
uVar10 = 10;
uVar11 = (*(ushort *)(param_1 + 0x38) >> 1) + 10;
memset(local_a88,0,0x208);
local_ff8 = 0;
uStack_ff0 = 0;
local_fe8 = 0;
uStack_fe0 = 0;
local_fd8 = 0;
uStack_fd0 = 0;
if ((*(longlong *)(param_1 + 0x48) == 0) || (*(longlong *)(param_1 + 0x58) == 0)) {
bVar2 = false;
}
else {
bVar2 = true;
}
uVar9 = param_2 & 0xfffffff;
local_1008 = param_2;
local_1000 = param_2;
if (param_3 == 0) {
if (uVar9 != *(uint *)(param_1 + 0x6c)) {
LAB_180079b95:
*(uint *)(param_1 + 0x6c) = uVar9;
if (uVar9 != 0) goto LAB_180079bad;
if (bVar2) {
FUN_18007a540(param_1);
goto LAB_180079ad7;
}
goto LAB_180079bb5;
}
if (!bVar2) goto LAB_180079ad7;
lVar6 = *(longlong *)(param_1 + 0x58);
if ((((byte)~(byte)(param_2 >> 0x18) >> 7 != (~(byte)(*(uint *)(lVar6 + 0x40) >> 0x13) & 1)) &&
(*(char *)(DAT_180092810 + 0x38) != '\0')) ||
((uint)((param_2 & 0x40000000) == 0) != (~(*(uint *)(lVar6 + 0x40) >> 8) & 1)))
goto LAB_180079b95;
if ((param_2 & 0x40000000) == 0) {
if (*(int *)(lVar6 + 0x44) != 0) goto LAB_180079b95;
}
else if (*(int *)(param_1 + 0x20) != *(int *)(lVar6 + 0x44)) goto LAB_180079b95;
goto LAB_180079ad7;
}
*(uint *)(param_1 + 0x6c) = uVar9;
if (uVar9 == 0) goto LAB_180079ad7;
LAB_180079bad:
if (bVar2) {
LAB_180079efc:
local_ea8[0] = L'\0';
LAB_180079f04:
if (!bVar2) {
*(undefined4 *)(param_1 + 0x50) = 0x488;
_Dst = (void *)RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30));
*(void **)(param_1 + 0x58) = _Dst;
if (_Dst == (void *)0x0) goto LAB_180079ad7;
memset(_Dst,0,(ulonglong)*(uint *)(param_1 + 0x50));
**(undefined4 **)(param_1 + 0x58) = *(undefined4 *)(param_1 + 0x50);
*(undefined4 *)(*(longlong *)(param_1 + 0x58) + 0x2c) = 0x20000;
*(undefined4 *)(*(longlong *)(param_1 + 0x58) + 0x74) = 0x78;
lVar6 = (ulonglong)*(uint *)(*(longlong *)(param_1 + 0x58) + 0x74) +
*(longlong *)(param_1 + 0x58);
_o_wcsncpy_s(lVar6,0x104,*(undefined8 *)(param_1 + 0x40),0x103);
*(undefined2 *)(lVar6 + 0x206) = 0;
if (local_ea8[0] == L'\0') {
puVar1 = (uint *)(*(longlong *)(param_1 + 0x58) + 0x40);
*puVar1 = *puVar1 | 0x8400;
}
else {
*(undefined4 *)(*(longlong *)(param_1 + 0x58) + 0x3c) = 1;
*(undefined4 *)(*(longlong *)(param_1 + 0x58) + 0x70) = 0x280;
_DstBuf = (wchar_t *)
((ulonglong)*(uint *)(*(longlong *)(param_1 + 0x58) + 0x70) +
*(longlong *)(param_1 + 0x58));
local_1060 = local_ea8;
local_1068 = local_c98;
FID_conflict__snprintf_s(_DstBuf,0x103,0x103,L"%s\\%s");
_DstBuf[0x103] = L'\0';
puVar1 = (uint *)(*(longlong *)(param_1 + 0x58) + 0x40);
*puVar1 = *puVar1 | 0x4002;
}
}
if (((int)local_1000 < 0) && (*(char *)(DAT_180092810 + 0x38) != '\0')) {
puVar1 = (uint *)(*(longlong *)(param_1 + 0x58) + 0x40);
*puVar1 = *puVar1 | 0x80000;
}
else {
puVar1 = (uint *)(*(longlong *)(param_1 + 0x58) + 0x40);
*puVar1 = *puVar1 & 0xfff7ffff;
}
lVar6 = *(longlong *)(param_1 + 0x58);
if ((local_1008 & 0x40000000) == 0) {
*(uint *)(lVar6 + 0x40) = *(uint *)(lVar6 + 0x40) & 0xfffffeff;
*(undefined4 *)(*(longlong *)(param_1 + 0x58) + 0x44) = 0;
}
else {
*(uint *)(lVar6 + 0x40) = *(uint *)(lVar6 + 0x40) | 0x100;
*(undefined4 *)(*(longlong *)(param_1 + 0x58) + 0x44) = *(undefined4 *)(param_1 + 0x20);
}
if (bVar2) {
LAB_18007a0d5:
local_1068 = (WCHAR *)(ulonglong)*(uint *)(param_1 + 0x6c);
local_1050 = &local_ff8;
local_1058 = 0;
local_1060 = (wchar_t *)0x0;
local_ff8 = CONCAT44(local_ff8._4_4_,1);
iVar5 = EnableTraceEx2(*(undefined8 *)(param_1 + 0x48),param_1 + 0x70,1,
*(undefined *)(param_1 + 0x68));
if ((iVar5 == 0) || (bVar2)) goto LAB_180079ad7;
}
else {
iVar5 = ControlTraceW(0,*(undefined8 *)(param_1 + 0x40),*(undefined8 *)(param_1 + 0x58),0);
if ((iVar5 != 0) && (iVar5 == 0x1069)) {
*(undefined4 *)(*(longlong *)(param_1 + 0x58) + 0x48) = *(undefined4 *)(param_1 + 0x6c);
iVar5 = StartTraceW(param_1 + 0x48,*(undefined8 *)(param_1 + 0x40),
*(undefined8 *)(param_1 + 0x58));
if ((iVar5 != 0xb7) && (iVar5 == 0)) goto LAB_18007a0d5;
}
}
FUN_18007a540(param_1);
}
else {
LAB_180079bb5:
if ((param_2 >> 0x1d & 1) != 0) goto LAB_180079efc;
local_1004 = GetWindowsDirectoryW(local_c98,0x104 - uVar11);
if (local_1004 == 0) goto LAB_180079be3;
if ((ulonglong)local_1004 <= 0x104 - (ulonglong)uVar11) {
_o_wcscat_s(local_c98,0x104,L"\\tracing");
BVar3 = CreateDirectoryW(local_c98,(LPSECURITY_ATTRIBUTES)0x0);
if ((BVar3 == 0) && (DVar4 = GetLastError(), DVar4 != 0xb7)) goto LAB_180079ad7;
_o_wcscat_s(local_c98,0x103,&DAT_1800820b4);
_o_wcscat_s(local_c98,0x103,*(undefined8 *)(param_1 + 0x40));
uVar8 = 0;
local_a92 = 0;
BVar3 = CreateDirectoryW(local_c98,(LPSECURITY_ATTRIBUTES)0x0);
if ((BVar3 == 0) && (DVar4 = GetLastError(), DVar4 != 0xb7)) goto LAB_180079ad7;
local_fc8.dwOSVersionInfoSize = 0x11c;
BVar3 = GetVersionExW(&local_fc8);
if (BVar3 == 0) {
LAB_180079be3:
GetLastError();
goto LAB_180079ad7;
}
FUN_18007a240(*(LPCWSTR *)(param_1 + 0x30),uVar8,local_248);
local_1004 = 0x103;
local_672 = 0;
BVar3 = GetComputerNameExW(ComputerNameNetBIOS,local_878,&local_1004);
if (BVar3 == 0) goto LAB_180079be3;
local_1018 = local_248;
local_1020 = (uint)local_eb0;
local_1028 = local_fc8.szCSDVersion;
local_1030 = (uint)local_eb2;
local_1038 = (uint)local_eb4;
local_1040 = local_fc8.dwBuildNumber;
local_1048 = local_fc8.dwMinorVersion;
local_1050 = (undefined8 *)CONCAT44(local_1050._4_4_,local_fc8.dwMajorVersion);
local_1060 = (wchar_t *)(param_1 + 0x38);
local_1058 = (uint)local_eae;
local_1068 = local_878;
local_ca2 = 0;
FID_conflict__snprintf_s(local_ea8,0x103,0xff,L"%s_%wZ_%d_%d_%d_%d_%d_%d_%s_%x_%s");
_o_wcscat_s(local_ea8,0x103,&DAT_180086908);
lVar6 = -1;
do {
lVar6 = lVar6 + 1;
} while (local_ea8[lVar6] != L'\0');
uVar7 = (ulonglong)((int)lVar6 - 4);
DVar4 = GetCurrentDirectoryW(0x103,local_a88);
if (DVar4 == 0) {
GetLastError();
goto LAB_180079af4;
}
if (0x102 < DVar4) goto LAB_180079af4;
BVar3 = SetCurrentDirectoryW(local_c98);
if (BVar3 == 0) goto LAB_180079be3;
memcpy(local_458,local_ea8,uVar7 * 2);
memcpy(local_668,local_ea8,uVar7 * 2);
do {
iVar5 = (int)uVar10;
FUN_18007a4a8(uVar10,local_668 + uVar7);
if (iVar5 == 1) {
*(undefined8 *)(local_458 + uVar7) = _DAT_180086908;
auStack_450[uVar7] = DAT_180086910;
}
else {
FUN_18007a4a8((ulonglong)(iVar5 - 1),local_458 + uVar7);
}
BVar3 = MoveFileExW(local_458,local_668,1);
if ((BVar3 == 0) && (DVar4 = GetLastError(), DVar4 != 2)) goto LAB_180079ad7;
uVar10 = (ulonglong)(iVar5 - 1U);
} while (iVar5 - 1U != 0);
goto LAB_180079f04;
}
}
LAB_180079ad7:
if (local_a88[0] != L'\0') {
SetCurrentDirectoryW(local_a88);
}
LAB_180079af4:
FUN_180028070(local_38 ^ (ulonglong)auStack_1088);
return;
}
=========================================
Function at address: 0x18007a134
Called functions addresses: 0xEXTERNAL:0000006a 0x18007a540 0xEXTERNAL:00000062 0x180028d90 0xEXTERNAL:000000dd 0xEXTERNAL:000000d5 0xEXTERNAL:0000009f 0xEXTERNAL:0000004b 0xEXTERNAL:000000ab


void FUN_18007a134(void *param_1)

{
if (param_1 != (void *)0x0) {
if (*(HANDLE *)((longlong)param_1 + 0xa0) != (HANDLE)0x0) {
UnregisterWaitEx(*(HANDLE *)((longlong)param_1 + 0xa0),(HANDLE)0x0);
*(undefined8 *)((longlong)param_1 + 0xa0) = 0;
}
if (*(HANDLE *)((longlong)param_1 + 0x98) != (HANDLE)0x0) {
CloseHandle(*(HANDLE *)((longlong)param_1 + 0x98));
*(undefined8 *)((longlong)param_1 + 0x98) = 0;
}
if (*(HKEY *)((longlong)param_1 + 0xa8) != (HKEY)0x0) {
RegCloseKey(*(HKEY *)((longlong)param_1 + 0xa8));
*(undefined8 *)((longlong)param_1 + 0xa8) = 0;
}
FUN_18007a540((longlong)param_1);
if (*(longlong *)((longlong)param_1 + 0x80) != 0) {
EtwUnregisterTraceGuids();
*(undefined8 *)((longlong)param_1 + 0x80) = 0;
}
RtlFreeUnicodeString((longlong)param_1 + 0x38);
RtlFreeUnicodeString((longlong)param_1 + 0x28);
DeleteCriticalSection((LPCRITICAL_SECTION)((longlong)param_1 + 0xc0));
memset(param_1,0,0xf0);
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,param_1);
}
return;
}
=========================================
Function at address: 0x18007a240
Called functions addresses: 0x18002a77b 0xEXTERNAL:000000d9 0xEXTERNAL:000000e2 0xEXTERNAL:00000044 0xEXTERNAL:000000e3 0xEXTERNAL:000000e4 0x18002a2c4 0xEXTERNAL:000000d5 0x180028070


void FUN_18007a240(LPCWSTR param_1,undefined8 param_2,ushort *param_3)

{
DWORD DVar1;
BOOL BVar2;
LPCVOID lpData;
ulonglong uVar3;
undefined auStackY_188 [32];
uint local_158 [2];
LPVOID local_150;
void *local_148 [2];
wchar_t local_138 [127];
undefined2 local_3a;
ulonglong local_38;

local_38 = DAT_180091970 ^ (ulonglong)auStackY_188;
lpData = (LPCVOID)0x0;
DVar1 = GetFileVersionInfoSizeExW(1,param_1,local_158);
if (DVar1 == 0) {
LAB_18007a2cf:
*param_3 = 0;
if (lpData == (LPCVOID)0x0) goto LAB_18007a2f9;
}
else {
lpData = (LPCVOID)RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,
DVar1);
if (lpData == (LPCVOID)0x0) {
DVar1 = 0xe;
LAB_18007a2c3:
SetLastError(DVar1);
goto LAB_18007a2cf;
}
BVar2 = GetFileVersionInfoExW(3,param_1,0,DVar1,lpData);
if ((BVar2 == 0) ||
(BVar2 = VerQueryValueW(lpData,L"\\VarFileInfo\\Translation",&local_150,local_158),
BVar2 == 0)) goto LAB_18007a2cf;
if (local_158[0] < 2) {
DVar1 = 0x490;
goto LAB_18007a2c3;
}
local_3a = 0;
FID_conflict__snprintf_s(local_138,0x80,0x7f,L"\\StringFileInfo\\%04x%04x\\FileVersion");
BVar2 = VerQueryValueW(lpData,local_138,local_148,local_158);
if (BVar2 == 0) goto LAB_18007a2cf;
if (0x103 < local_158[0]) {
DVar1 = 0x7a;
goto LAB_18007a2c3;
}
uVar3 = (ulonglong)local_158[0];
memcpy(param_3,local_148[0],uVar3 * 2);
param_3[uVar3] = 0;
if (local_158[0] != 0) {
uVar3 = (ulonglong)local_158[0];
do {
if (*param_3 < 0x2f) {
if ((0x2a < *param_3) ||
((8 < *param_3 &&
(((*param_3 < 0xb || (*param_3 == 0xd)) ||
((0x1f < *param_3 &&
((*param_3 < 0x22 ||
((0x23 < *param_3 &&
((*param_3 < 0x27 || ((0x27 < *param_3 && (*param_3 < 0x2a)))))))))))))))) {
LAB_18007a48a:
*param_3 = 0x5f;
}
}
else if ((0x39 < *param_3) &&
(((*param_3 < 0x3c || (*param_3 == 0x3f)) ||
((0x5a < *param_3 &&
((*param_3 < 0x5f || ((0x7a < *param_3 && (*param_3 < 0x7e))))))))))
goto LAB_18007a48a;
param_3 = param_3 + 1;
uVar3 = uVar3 - 1;
} while (uVar3 != 0);
}
}
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,lpData);
LAB_18007a2f9:
FUN_180028070(local_38 ^ (ulonglong)auStackY_188);
return;
}
=========================================
Function at address: 0x18007a4a8
Called functions addresses: None


void FUN_18007a4a8(ulonglong param_1,undefined2 *param_2)

{
ulonglong uVar1;
short sVar2;
short sVar3;

*param_2 = 0x2e;
param_2[4] = 0;
uVar1 = (param_1 & 0xffffffff) / 10;
sVar3 = (short)uVar1;
uVar1 = uVar1 / 10;
param_2[3] = (short)param_1 + sVar3 * -10 + 0x30;
sVar2 = (short)uVar1;
param_2[1] = sVar2 + (short)(uVar1 / 10) * -10 + 0x30;
param_2[2] = sVar3 + sVar2 * -10 + 0x30;
return;
}
=========================================
Function at address: 0x18007a540
Called functions addresses: 0xEXTERNAL:00000197 0xEXTERNAL:000000d5


void FUN_18007a540(longlong param_1)

{
if ((*(longlong *)(param_1 + 0x48) != 0) && (*(longlong *)(param_1 + 0x58) != 0)) {
ControlTraceW(*(longlong *)(param_1 + 0x48),*(undefined8 *)(param_1 + 0x40),
*(longlong *)(param_1 + 0x58),1);
}
*(undefined8 *)(param_1 + 0x48) = 0;
if (*(longlong *)(param_1 + 0x58) != 0) {
RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0);
*(undefined8 *)(param_1 + 0x58) = 0;
}
*(undefined4 *)(param_1 + 0x50) = 0;
*(undefined4 *)(param_1 + 0x68) = 0;
*(undefined4 *)(param_1 + 0x6c) = 0;
return;
}
=========================================
Function at address: 0x18007a5c0
Called functions addresses: 0xEXTERNAL:00000064 0xEXTERNAL:00000068 0x18002a7c0


void FUN_18007a5c0(longlong param_1,undefined param_2)

{
undefined8 *puVar1;

EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x50));
for (puVar1 = *(undefined8 **)(param_1 + 0x28); puVar1 != (undefined8 *)(param_1 + 0x28);
puVar1 = (undefined8 *)*puVar1) {
EnterCriticalSection((LPCRITICAL_SECTION)(puVar1 + 0x18));
if (puVar1[0x11] != 0) {

}
LeaveCriticalSection((LPCRITICAL_SECTION)(puVar1 + 0x18));
}
/* WARNING: Could not recover jumptable at 0x00018007a664. Too many branches */

LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x50));
return;
}
=========================================
Function at address: 0x18007a678
Called functions addresses: 0xEXTERNAL:00000193 0xEXTERNAL:00000192 0x1800188d0 0xEXTERNAL:00000195


undefined8 FUN_18007a678(undefined8 param_1,undefined4 param_2,undefined8 param_3)

{
int iVar1;
undefined8 uVar2;
longlong local_res20;
undefined8 local_18;
undefined8 uStack_10;

uVar2 = 0;
local_res20 = 0;
local_18 = 0;
uStack_10 = 0;
iVar1 = MesDecodeIncrementalHandleCreate(&local_18,FUN_1800188d0,&local_res20);
if (iVar1 == 0) {
uStack_10 = CONCAT44(uStack_10._4_4_,param_2);
local_18 = param_1;
NdrMesTypeDecode3(local_res20,&DAT_180082c88,&PTR_PTR_DAT_18007d5d8,&PTR_DAT_180091470,1,param_3
);
}
else {
uVar2 = 0xc000009a;
}
if (local_res20 != 0) {
MesHandleFree();
}
return uVar2;
}
=========================================
Function at address: 0x18007a740
Called functions addresses: 0xEXTERNAL:00000194 0xEXTERNAL:0000018f 0xEXTERNAL:00000190 0xEXTERNAL:00000193 0x18004cec0 0x1800188f0 0xEXTERNAL:00000191 0xEXTERNAL:0000018e 0x18002a7c0 0x1800188d0


long FUN_18007a740(undefined8 param_1,longlong *param_2,uint *param_3)

{
int iVar1;
uint uVar2;
long lVar3;
longlong lVar4;
undefined8 local_res8;
longlong local_res20;
undefined8 in_stack_ffffffffffffffb8;
undefined4 uVar5;
undefined8 *puVar6;
uint uVar7;
longlong local_28;
undefined8 uStack_20;

uVar5 = (undefined4)((ulonglong)in_stack_ffffffffffffffb8 >> 0x20);
lVar3 = 0;
local_res20 = 0;
local_28 = 0;
uStack_20 = 0;
lVar4 = 0;
local_res8 = param_1;
iVar1 = MesEncodeIncrementalHandleCreate(&local_28,FUN_1800188d0,FUN_1800188f0,&local_res20);
if (iVar1 == 0) {
puVar6 = &local_res8;
uVar2 = NdrMesTypeAlignSize3
(local_res20,&DAT_180082c88,&PTR_PTR_DAT_18007d5d8,&PTR_DAT_180091470,
CONCAT44(uVar5,1),puVar6);
uVar7 = uVar2;
lVar4 = FUN_18004cec0((ulonglong)uVar2);
if (lVar4 != 0) {
uStack_20 = CONCAT44(uStack_20._4_4_,uVar2);
uVar5 = 0;
local_28 = lVar4;
iVar1 = MesIncrementalHandleReset
(local_res20,0,0,0,0,(ulonglong)puVar6 & 0xffffffff00000000,uVar7,lVar4);
if (iVar1 == 0) {
NdrMesTypeEncode3(local_res20,&DAT_180082c88,&PTR_PTR_DAT_18007d5d8,&PTR_DAT_180091470,
CONCAT44(uVar5,1),&local_res8);
*param_2 = lVar4;
*param_3 = uVar2;
lVar4 = 0;
}
else {
lVar3 = I_RpcMapWin32Status(iVar1);
}
goto LAB_18007a89a;
}
}
lVar3 = -0x3fffff66;
LAB_18007a89a:
if (lVar4 != 0) {

}
if (local_res20 != 0) {
MesHandleFree();
}
return lVar3;
}
=========================================
Function at address: 0x18007a8f8
Called functions addresses: 0x18004cec0 0x18002a77b 0x180028d90 0x18002a7c0 0x18007aad8


int FUN_18007a8f8(undefined8 *param_1,uint *param_2,ulonglong param_3,uint *param_4,
undefined8 *param_5)

{
int iVar1;
uint *puVar2;
uint uVar3;
ulonglong uVar4;
ulonglong _Size;
void *pvVar5;
uint uVar6;
uint uVar7;
uint uVar8;
uint uVar9;
ulonglong uVar10;
ulonglong local_res18 [2];
void *local_38 [2];

local_38[0] = (void *)0x0;
*param_5 = 0;
local_res18[0] = param_3;
iVar1 = FUN_18007aad8(param_1,param_2,param_3,(longlong *)local_38,(uint *)local_res18);
if (-1 < iVar1) {
uVar7 = (uint)local_res18[0];
uVar4 = local_res18[0] & 0xffffffff;
if ((uint)local_res18[0] < 0xffff) {
uVar3 = (uint)local_res18[0] + 7 & 0xfffffff8;
uVar8 = 0;
uVar10 = 1;
uVar6 = 1;
if (*param_4 != 0) {
puVar2 = param_4 + 3;
do {
if (puVar2[-1] != 1) {
if (0xfffe < *puVar2) goto LAB_18007a956;
uVar9 = (*puVar2 + 7 & 0xfffffff8) + uVar3;
if (uVar9 < uVar3) {
iVar1 = -0x3fffff6b;
goto LAB_18007aa8f;
}
uVar6 = uVar6 + 1;
uVar3 = uVar9;
}
uVar8 = uVar8 + 1;
puVar2 = puVar2 + 4;
} while (uVar8 < *param_4);
}
uVar3 = uVar6 * 0x10 + 8 + uVar3;
if (uVar3 < 0xffff) {
_Size = (ulonglong)(uVar3 + 7) & 0xfffffff8;
puVar2 = (uint *)FUN_18004cec0(_Size);
if (puVar2 == (uint *)0x0) {
iVar1 = -0x3fffff66;
}
else {
memset(puVar2,0,_Size);
*puVar2 = uVar6;
puVar2[2] = 1;
puVar2[3] = uVar7;
pvVar5 = (void *)((ulonglong)uVar6 * 0x10 + 0xf + (longlong)puVar2 & 0xfffffffffffffff8);
*(void **)(puVar2 + 4) = pvVar5;
memcpy(pvVar5,local_38[0],uVar4);
uVar7 = 0;
pvVar5 = (void *)((ulonglong)puVar2[3] + 7 + (longlong)pvVar5 & 0xfffffffffffffff8);
if (*param_4 != 0) {
do {
uVar4 = (ulonglong)uVar7;
if (param_4[uVar4 * 4 + 2] != 1) {
puVar2[uVar10 * 4 + 2] = param_4[uVar4 * 4 + 2];
puVar2[uVar10 * 4 + 3] = param_4[uVar4 * 4 + 3];
*(void **)(puVar2 + uVar10 * 4 + 4) = pvVar5;
memcpy(pvVar5,*(void **)(param_4 + uVar4 * 4 + 4),(ulonglong)param_4[uVar4 * 4 + 3])
;
pvVar5 = (void *)((longlong)pvVar5 + (ulonglong)puVar2[uVar10 * 4 + 3] + 7 &
0xfffffffffffffff8);
uVar10 = (ulonglong)((int)uVar10 + 1);
}
uVar7 = uVar7 + 1;
} while (uVar7 < *param_4);
}
*param_5 = puVar2;
iVar1 = 0;
}
goto LAB_18007aa8f;
}
}
LAB_18007a956:
iVar1 = -0x3fffff45;
}
LAB_18007aa8f:
if (local_38[0] != (void *)0x0) {

}
return iVar1;
}
=========================================
Function at address: 0x18007aad8
Called functions addresses: 0x18004cec0 0x180028d90 0x180028070 0x18002a7c0 0x18007a740


void FUN_18007aad8(undefined8 *param_1,uint *param_2,undefined8 param_3,longlong *param_4,
uint *param_5)

{
undefined8 *puVar1;
undefined8 *puVar2;
undefined8 uVar3;
undefined8 uVar4;
undefined8 uVar5;
undefined8 uVar6;
undefined8 uVar7;
undefined8 *puVar8;
void *_Dst;
uint uVar9;
longlong lVar10;
ulonglong uVar11;
ulonglong uVar12;
undefined8 *puVar13;
ulonglong uVar14;
ulonglong uVar15;
undefined auStack_1a8 [32];
undefined8 local_188 [21];
uint uStack_e0;
uint local_78;
void *local_70;
undefined8 local_68;
undefined4 local_60;
undefined8 local_58;
ulonglong local_48;

local_48 = DAT_180091970 ^ (ulonglong)auStack_1a8;
lVar10 = 2;
puVar1 = param_1;
puVar2 = local_188;
do {
puVar13 = puVar2;
puVar8 = puVar1;
uVar3 = puVar8[1];
uVar4 = puVar8[2];
uVar5 = puVar8[3];
*puVar13 = *puVar8;
puVar13[1] = uVar3;
uVar3 = puVar8[4];
uVar6 = puVar8[5];
puVar13[2] = uVar4;
puVar13[3] = uVar5;
uVar4 = puVar8[6];
uVar5 = puVar8[7];
puVar13[4] = uVar3;
puVar13[5] = uVar6;
uVar3 = puVar8[8];
uVar6 = puVar8[9];
puVar13[6] = uVar4;
puVar13[7] = uVar5;
uVar4 = puVar8[10];
uVar5 = puVar8[0xb];
puVar13[8] = uVar3;
puVar13[9] = uVar6;
uVar3 = puVar8[0xc];
uVar6 = puVar8[0xd];
puVar13[10] = uVar4;
puVar13[0xb] = uVar5;
uVar4 = puVar8[0xe];
uVar5 = puVar8[0xf];
puVar13[0xc] = uVar3;
puVar13[0xd] = uVar6;
puVar13[0xe] = uVar4;
puVar13[0xf] = uVar5;
lVar10 = lVar10 + -1;
puVar1 = puVar8 + 0x10;
puVar2 = puVar13 + 0x10;
} while (lVar10 != 0);
uVar3 = puVar8[0x11];
uVar9 = *param_2;
uVar11 = 0;
uVar4 = puVar8[0x12];
uVar5 = puVar8[0x13];
puVar13[0x10] = puVar8[0x10];
puVar13[0x11] = uVar3;
uVar6 = puVar8[0x14];
uVar7 = puVar8[0x15];
uVar3 = puVar8[0x16];
puVar13[0x12] = uVar4;
puVar13[0x13] = uVar5;
puVar13[0x14] = uVar6;
puVar13[0x15] = uVar7;
puVar13[0x16] = uVar3;
uStack_e0 = uStack_e0 & 0xfffffdff;
local_68 = 0;
local_58 = 0;
local_60 = 0;
if (local_78 <= uVar9 + local_78) {
uVar12 = (ulonglong)(uVar9 + local_78) << 4;
_Dst = (void *)FUN_18004cec0(uVar12);
if (_Dst != (void *)0x0) {
memset(_Dst,0,uVar12);
uVar9 = *param_2;
if (uVar9 != 0) {
uStack_e0 = uStack_e0 | 0x20;
uVar12 = uVar11;
uVar14 = uVar11;
uVar15 = uVar11;
if (*(int *)(param_1 + 0x22) != 0) {
do {
uVar15 = uVar14;
if ((*(uint *)(param_1[0x23] + 8 + uVar12 * 0x10) & 0x20000000) == 0) {
puVar1 = (undefined8 *)(param_1[0x23] + uVar12 * 0x10);
uVar3 = puVar1[1];
uVar15 = (ulonglong)((int)uVar14 + 1);
puVar2 = (undefined8 *)((longlong)_Dst + uVar14 * 0x10);
*puVar2 = *puVar1;
puVar2[1] = uVar3;
}
uVar9 = (int)uVar12 + 1;
uVar12 = (ulonglong)uVar9;
uVar14 = uVar15;
} while (uVar9 < *(uint *)(param_1 + 0x22));
uVar9 = *param_2;
}
local_78 = (uint)uVar15;
local_70 = _Dst;
if (uVar9 != 0) {
do {
local_78 = (int)uVar15 + 1;
uVar9 = (int)uVar11 + 1;
*(undefined8 *)((longlong)_Dst + uVar15 * 0x10) =
*(undefined8 *)(*(longlong *)(param_2 + 2) + uVar11 * 8);
*(undefined4 *)((longlong)_Dst + uVar15 * 0x10 + 8) = 0x20000007;
uVar11 = (ulonglong)uVar9;
uVar15 = (ulonglong)local_78;
} while (uVar9 < *param_2);
}
}
FUN_18007a740(local_188,param_4,param_5);

}
}
FUN_180028070(local_48 ^ (ulonglong)auStack_1a8);
return;
}
=========================================
Function at address: 0x18007acd0
Called functions addresses: None


uint FUN_18007acd0(uint *param_1,uint param_2)

{
uint uVar1;
uint uVar2;
ulonglong uVar3;
uint *puVar4;
uint uVar5;
uint uVar6;
uint uVar7;
uint *puVar8;

uVar6 = 0;
if (0x17 < param_2) {
uVar2 = *param_1;
if (((((ulonglong)uVar2 << 4 < 0x100000000) &&
(uVar5 = (uint)((ulonglong)uVar2 << 4), uVar7 = uVar5 + 0x18, uVar5 <= uVar7)) &&
(uVar7 <= param_2)) && (param_1[1] == 0)) {
uVar5 = 0;
if (uVar2 == 0) {
return 0;
}
puVar4 = param_1 + 3;
uVar7 = 0;
while (((puVar8 = (uint *)(*(longlong *)(puVar4 + 1) + (longlong)param_1),
puVar8 <= (uint *)((ulonglong)param_2 + (longlong)param_1) && (param_1 <= puVar8)) &&
((*puVar4 <=
(uint)((int)(uint *)((ulonglong)param_2 + (longlong)param_1) - (int)puVar8) &&
(uVar1 = *puVar4 + uVar7, uVar7 <= uVar1))))) {
uVar5 = uVar5 + 1;
puVar4 = puVar4 + 4;
uVar7 = uVar1;
if (uVar2 <= uVar5) {
do {
uVar3 = (ulonglong)uVar6;
uVar6 = uVar6 + 1;
*(longlong *)(param_1 + (uVar3 + 1) * 4) =
*(longlong *)(param_1 + (uVar3 + 1) * 4) + (longlong)param_1;
} while (uVar6 < *param_1);
return uVar1;
}
}
}
}
return 0;
}
=========================================
Function at address: 0x18007ad88
Called functions addresses: 0x18007a678 0x18007adf4 0x18002a7c0


ulonglong FUN_18007ad88(longlong *param_1,undefined8 param_2,undefined4 param_3)

{
ulonglong uVar1;
ulonglong uVar2;

*param_1 = 0;
uVar1 = FUN_18007a678(param_2,param_3,param_1);
if (-1 < (int)uVar1) {
uVar2 = FUN_18007adf4(*param_1);
uVar1 = uVar2 & 0xffffffff;
if ((int)uVar2 < 0) {

*param_1 = 0;
}
}
return uVar1;
}
=========================================
Function at address: 0x18007adf4
Called functions addresses: 0xEXTERNAL:000000d0 0xEXTERNAL:000000c1


undefined8 FUN_18007adf4(longlong param_1)

{
char cVar1;
char *pcVar2;
uint uVar3;

if ((((0x4000 < *(uint *)(param_1 + 0x9c)) || (0x4000 < *(uint *)(param_1 + 0x128))) ||
(0x4000 < *(uint *)(param_1 + 0x110))) ||
(0x4000 < *(uint *)(param_1 + 0x128) + *(uint *)(param_1 + 0x110) + *(uint *)(param_1 + 0x9c)))
{
return 0xc000015a;
}
cVar1 = RtlValidSid(*(undefined8 *)(param_1 + 0xe0));
if (((cVar1 != '\0') &&
(pcVar2 = (char *)RtlSubAuthorityCountSid(*(undefined8 *)(param_1 + 0xe0)), *pcVar2 != '\x0f')
) && ((((*(uint *)(param_1 + 0xa8) & 0x200) == 0 || (*(int *)(param_1 + 0x128) == 0)) ||
((cVar1 = RtlValidSid(*(undefined8 *)(param_1 + 0x120)), cVar1 != '\0' &&
(pcVar2 = (char *)RtlSubAuthorityCountSid(*(undefined8 *)(param_1 + 0x120)),
*pcVar2 != '\x0f')))))) {
uVar3 = 0;
if (*(int *)(param_1 + 0x110) != 0) {
do {
cVar1 = RtlValidSid(*(undefined8 *)
(*(longlong *)(param_1 + 0x118) + (ulonglong)uVar3 * 0x10));
if (cVar1 == '\0') {
return 0xc0000078;
}
uVar3 = uVar3 + 1;
} while (uVar3 < *(uint *)(param_1 + 0x110));
}
return 0;
}
return 0xc0000078;
}
=========================================
Function at address: 0x18007af10
Called functions addresses: 0xEXTERNAL:000000d9


void FUN_18007af10(undefined8 param_1)

{
/* WARNING: Could not recover jumptable at 0x00018007af22. Too many branches */

RtlAllocateHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,param_1);
return;
}
=========================================
Function at address: 0x18007af40
Called functions addresses: 0xEXTERNAL:000000d5


void FUN_18007af40(undefined8 param_1)

{
/* WARNING: Could not recover jumptable at 0x00018007af52. Too many branches */

RtlFreeHeap(*(undefined8 *)((longlong)ProcessEnvironmentBlock + 0x30),0,param_1);
return;
}
=========================================
Function at address: 0x18007b0bc
Called functions addresses: 0x180028070 0x1800533ac


void FUN_18007b0bc(undefined8 param_1,byte *param_2,undefined8 param_3,undefined8 param_4,
undefined8 *param_5,undefined8 param_6,undefined8 param_7,undefined8 param_8,
undefined8 param_9,undefined8 param_10,undefined8 param_11,undefined8 param_12,
undefined8 param_13)

{
undefined auStackY_f8 [32];
_EVENT_DATA_DESCRIPTOR local_c8 [2];
undefined8 local_a8;
undefined8 local_a0;
undefined8 local_98;
undefined8 local_90;
undefined8 local_88;
undefined8 local_80;
undefined8 local_78;
undefined8 local_70;
undefined8 local_68;
undefined8 local_60;
undefined8 local_58;
undefined8 local_50;
undefined8 local_48;
undefined8 local_40;
undefined8 local_38;
undefined8 local_30;
undefined8 local_28;
undefined8 local_20;
ulonglong local_18;

local_18 = DAT_180091970 ^ (ulonglong)auStackY_f8;
local_28 = param_13;
local_38 = param_12;
local_48 = param_11;
local_58 = param_10;
local_68 = param_9;
local_78 = param_8;
local_88 = param_7;
local_98 = param_6;
local_20 = 4;
local_30 = 4;
local_40 = 4;
local_a8 = *param_5;
local_50 = 4;
local_60 = 4;
local_70 = 8;
local_80 = 8;
local_90 = 8;
local_a0 = 0x10;
_tlgWriteTransfer_EtwWriteTransfer(0x180091870,param_2,(LPCGUID)0x0,(LPCGUID)0x0,0xb,local_c8);
FUN_180028070(local_18 ^ (ulonglong)auStackY_f8);
return;
}
=========================================
Function at address: 0x18007b1b0
Called functions addresses: 0xEXTERNAL:000000ec 0xEXTERNAL:000000ea 0xEXTERNAL:000000e9


void FUN_18007b1b0(longlong param_1)

{
if (*(PTP_TIMER *)(param_1 + 0x158) != (PTP_TIMER)0x0) {
SetThreadpoolTimer(*(PTP_TIMER *)(param_1 + 0x158),(PFILETIME)0x0,0,0);
WaitForThreadpoolTimerCallbacks(*(PTP_TIMER *)(param_1 + 0x158),1);
CloseThreadpoolTimer(*(PTP_TIMER *)(param_1 + 0x158));
*(undefined8 *)(param_1 + 0x158) = 0;
}
return;
}
=========================================
Function at address: 0x18007b21c
Called functions addresses: 0xEXTERNAL:000000e8 0xEXTERNAL:000000e6 0x18007b1b0


void FUN_18007b21c(LPVOID param_1)

{
HANDLE hHeap;

if (param_1 != (LPVOID)0x0) {
FUN_18007b1b0((longlong)param_1);
hHeap = GetProcessHeap();
HeapFree(hHeap,0,param_1);
}
return;
}
=========================================
Function at address: 0x18007b25c
Called functions addresses: 0xEXTERNAL:0000006e 0x18007b1b0 0xEXTERNAL:0000006f 0x18007b21c 0xEXTERNAL:00000091 0x180027b44 0x180027af0


void FUN_18007b25c(void)

{
longlong *plVar1;
REGHANDLE RVar2;
LPVOID pvVar3;
longlong *plVar4;
LPVOID pvVar5;
undefined8 in_R9;

RVar2 = DAT_1800914a0;
if (DAT_1800914a8 != FUN_180027af0) {
DAT_1800914a0 = 0;
DAT_180091480 = 0;
/* WARNING: Could not recover jumptable at 0x00018007b36b. Too many branches */

EventUnregister(RVar2);
return;
}
pvVar5 = (LPVOID)0x0;
AcquireSRWLockExclusive((PSRWLOCK)&DAT_180092d70);
pvVar3 = DAT_180092ee8;
plVar4 = (longlong *)&DAT_180092ee8;
do {
if (pvVar3 == (LPVOID)0x0) {
LAB_18007b2f9:
ReleaseSRWLockExclusive((PSRWLOCK)&DAT_180092d70);
if (pvVar5 != (LPVOID)0x0) {
FUN_18007b1b0((longlong)pvVar5);
}
RVar2 = DAT_1800914a0;
DAT_1800914a0 = 0;
DAT_180091480 = 0;
EventUnregister(RVar2);
DAT_1800914a8 = (code *)0x0;
FUN_18007b21c(pvVar5);
return;
}
plVar1 = (longlong *)((longlong)pvVar3 + 0x150);
if (*(undefined4 **)((longlong)pvVar3 + 0x148) == &DAT_180091480) {
*plVar4 = *plVar1;
FUN_180027b44((longlong)pvVar3,plVar4,&DAT_180091480,in_R9);
RVar2 = DAT_180091890;
pvVar5 = pvVar3;
if (DAT_180092ee8 == (LPVOID)0x0) {
DAT_180091890 = 0;
DAT_180091870 = 0;
EventUnregister(RVar2);
}
goto LAB_18007b2f9;
}
pvVar3 = (LPVOID)*plVar1;
plVar4 = plVar1;
} while( true );
}
=========================================
